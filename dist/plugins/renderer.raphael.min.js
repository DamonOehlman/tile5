T5.registerRenderer("raphael",function(k,m,y,A){function B(a,b,c){n[b]=c}function s(a,b,c,d,e){return{draw:e||C,viewport:b,state:d,hit:t[a.id],vpX:h,vpY:i}}function o(a,b){a.scale(b.scaling,b.scaling);a.rotate(b.rotation*z,true);a.mouseover(function(){t[b.id]=true});a.mouseout(function(){delete t[b.id]});u[b.id]=b}function C(){if(this.rObject){var a=COG.extend({},n[p]||n.basic),b=h-this.translateX,c=i-this.translateY;switch(this.rObject.type){case "circle":a.cx=this.xy.x-b;a.cy=this.xy.y-c;break;
case "path":for(var d=this.rawPath||[],e=[],f=d.length;f--;)e[f]=[d[f][0],d[f][1]-b,d[f][2]-c];a.path=e;break;default:a.x=this.xy.x-(this.size>>1)-b;a.y=this.xy.y-(this.size>>1)-c}a.fill&&!this.fill&&delete a.fill;a.stroke&&!this.stroke&&delete a.stroke;this.rObject.attr(a);q[this.id]=this}}function r(a,b,c){var d=[];for(var e in a){var f=a[e];if(c?f[c]:!b[e]){f.rObject.remove();f.rObject=null;d[d.length]=e}}for(b=d.length;b--;)delete a[d[b]]}y=COG.extend({},y);var z=180/Math.PI,v,w,h,i,u={},x={},
q={},l={},p,t={},n={},j;v=k.width=m.offsetWidth;w=k.height=m.offsetHeight;j=Raphael(m,v,w);k=COG.extend(A,{interactTarget:m,preventPartialScale:true,applyStyle:function(a){var b;if(p!==a){b=p;p=a}return b||"basic"},applyTransform:function(a){if(a.rObject){a.rObject.scale(a.scaling,a.scaling);a.rObject.rotate(a.rotation*z,true)}},drawTiles:function(a,b){for(var c,d=b.length;d--;){c=b[d];if(c.rObject)c.rObject.attr({x:c.x-h,y:c.y-i});else{x[c.id]=c;c.rObject=j.image(c.url,c.x-h,c.y-i,c.w,c.h);c.rObject.toBack()}l[c.id]=
c}},prepare:function(a,b){h=b.x;i=b.y;return j},prepArc:function(a,b,c,d){if(!a.rObject)o(a.rObject=j.circle(a.xy.x-h,a.xy.y-i,a.size),a);return s(a,b,c,d)},prepMarker:function(a,b,c,d){if(a.reset&&a.rObject){a.rObject.remove();a.rObject=null;a.reset=false}if(!a.rObject){var e=a.xy.x-h,f=a.xy.y-i,g=a.size;switch(a.markerStyle.toLowerCase()){case "image":o(a.rObject=j.image(a.imageUrl,e-(g>>1),f-(g>>1),g,g),a);break;default:o(a.rObject=j.circle(e,f,g),a)}}return s(a,b,c,d)},prepPoly:function(a,b,c,
d,e){if(!a.rObject){var f=[];e=e.points||a.points;for(var g=e.length;g--;)f[g]=[g===0?"M":"L",e[g].x,e[g].y];a.rawPath=f;a.removeOnReset=true;o(a.rObject=j.path("M0 0L0 0"),a)}return s(a,b,c,d)},reset:function(){l={};r(x,l);r(u,q,"removeOnReset")},getDimensions:function(){return{width:v,height:w}},getOffset:function(){return new XY(h,i)}});k.bind("predraw",function(){r(u,q);q={};r(x,l);l={}});(function(){for(var a in T5.styles)n[a]=T5.styles[a];T5.bind("styleDefined",B)})();return k});
