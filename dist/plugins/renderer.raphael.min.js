T5.Registry.register("renderer","raphael",function(h,k,B,u,x){function y(a,b,c){l[b]=c}function q(a,b,c,d){return{draw:d||z,viewport:b,hit:r[a.id],vpX:i,vpY:j}}function m(a,b){a.scale(b.scaling,b.scaling);a.rotate(b.rotation*v,true);a.mouseover(function(){r[b.id]=true});a.mouseout(function(){delete r[b.id]});s[b.id]=b}function z(){if(this.rObject){var a=_extend({},l[n]||l.basic),b=i-this.translateX,c=j-this.translateY;switch(this.rObject.type){case "circle":a.cx=this.xy.x-b;a.cy=this.xy.y-c;break;
case "path":a.path=this.path(b,c);break;default:a.x=this.xy.x-(this.size>>1)-b;a.y=this.xy.y-(this.size>>1)-c}a.fill&&!this.fill&&delete a.fill;a.stroke&&!this.stroke&&delete a.stroke;this.rObject.attr(a);o[this.id]=this}}function w(a,b,c){var d=[],e;for(e in a){var f=a[e];if(c?f[c]:!b[e]){f.rObject.remove();f.rObject=null;d[d.length]=e}}for(b=d.length;b--;)delete a[d[b]]}u=_extend({},u);var v=180/Math.PI,i,j,s={},o={},n,r={},l={},g;g=Raphael(k,k.offsetWidth,k.offsetHeight);g.canvas.style.position=
"absolute";h.attachFrame(g.canvas);h=_extend(x,{applyStyle:function(a){var b;if(n!==a){b=n;n=a}return b||"basic"},applyTransform:function(a){if(a.rObject){a.rObject.scale(a.scaling,a.scaling);a.rObject.rotate(a.rotation*v,true)}},prepare:function(a,b){i=b.x;j=b.y;return g},prepArc:function(a,b,c){if(!a.rObject)m(a.rObject=g.circle(a.xy.x-i,a.xy.y-j,a.size),a);return q(a,b,c)},prepMarker:function(a,b,c){if(a.reset&&a.rObject){a.rObject.remove();a.rObject=null;a.reset=false}if(!a.rObject){var d=a.xy.x-
i,e=a.xy.y-j,f=a.size;switch(a.markerStyle.toLowerCase()){case "image":m(a.rObject=g.image(a.imageUrl,d-(f>>1),e-(f>>1),f,f),a);break;default:m(a.rObject=g.circle(d,e,f),a)}}return q(a,b,c)},prepPoly:function(a,b,c,d){if(!a.rObject){var e=d.points||a.points;a.path=function(f,A){for(var t="",p=e.length;p--;)t=(p>0?"L":"M")+(e[p].x-f)+" "+(e[p].y-A)+t;return t};a.removeOnReset=true;m(a.rObject=g.path("M0 0L0 0"),a)}return q(a,b,c)}});h.bind("predraw",function(){w(s,o);o={}});h.bind("detach",function(){k.removeChild(g.canvas)});
h.bind("reset",function(){w(s,o,"removeOnReset")});(function(){for(var a in T5.styles)l[a]=T5.styles[a];T5.bind("styleDefined",y)})();return h});
