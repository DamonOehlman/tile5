T5.registerRenderer("three:webgl",function(o,k,l,t){function u(c){c.loading=true;T5.getImage(c.url,function(b){b=new THREE.Texture(b);var a=c.mesh=new THREE.Mesh(p,new THREE.MeshBasicMaterial({map:b}));c.loading=false;b.needsUpdate=true;a.position.x=c.x;a.position.y=-c.y;d.addObject(a)})}l=COG.extend({},l);var e,d,h,m=[],f,p,i,j,q=0,r=0;(function(){var c,b;if(k){i=o.w=k.offsetWidth;j=o.h=k.offsetHeight;c=(i/256|0)+2;b=(j/256|0)+2;d=new THREE.Scene;var a;a=new THREE.DirectionalLight(43775,2);a.position.z=
1;d.addLight(a);a=new THREE.DirectionalLight(64,0.5);a.position.z=-1;d.addLight(a);f=new THREE.Mesh(new Plane(c*256,b*256,16,16),new THREE.MeshBasicMaterial({color:16777215,wireframe:true}));d.addObject(f);e=new THREE.Camera(45,i/j,1,2E3,f);e.position.z=500;p=new Plane(256,256,4,4);h=new THREE.WebGLRenderer;h.setSize(i,j);k.appendChild(h.domElement)}})();l=COG.extend(t,{interactTarget:h.domElement,preventPartialScale:true,applyStyle:function(){},applyTransform:function(){},drawTiles:function(c,b){var a,
s,g,n=[];COG.info("drawing tiles, viewport: x = "+c.x+", y = "+c.y);for(g=b.length;g--;){a=b[g];n[n.length]=a.id;s=a.mesh;!s&&!a.loading&&u(a)}for(g=m.length;g--;){a=m[g];if(a.mesh&&n.indexOf(a.id)<0){d.removeObject(a.mesh);a.mesh=null}}m=[].concat(b)},prepare:function(c,b){q=b.x;r=b.y;e.position.x=f.position.x=q;f.position.y=-r;e.position.y=f.position.y-500;return true},render:function(){h.render(d,e)},getCamera:function(){return e},getContext:function(){},getDimensions:function(){return{width:i,
height:j}}});COG.info("created three:webgl renderer");return l});
