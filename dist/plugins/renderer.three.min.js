T5.registerRenderer("three:webgl",function(o,j,k,s){function t(b){b.loading=true;T5.getImage(b.url,function(a){a=new THREE.Texture(a);var c=b.mesh=new THREE.Mesh(p,new THREE.MeshBasicMaterial({map:a}));b.loading=false;a.needsUpdate=true;c.position.x=b.x+(d>>1);c.position.y=-b.y;e.addObject(c)})}k=COG.extend({},k);var f,e,i,g,p,d,h,m=0,n=0;(function(){var b,a;if(j){d=o.w=j.offsetWidth;h=o.h=j.offsetHeight;b=(d/256|0)+2;a=(h/256|0)+2;e=new THREE.Scene;var c;c=new THREE.DirectionalLight(43775,2);c.position.z=
1;e.addLight(c);c=new THREE.DirectionalLight(64,0.5);c.position.z=-1;e.addLight(c);g=new THREE.Mesh(new Plane(b*256,a*256,16,16),new THREE.MeshBasicMaterial({color:16777215,wireframe:true}));e.addObject(g);f=new THREE.Camera(45,d/h,1,2E3,g);f.position.z=500;p=new Plane(256,256,4,4);i=new THREE.WebGLRenderer;i.setSize(d,h);j.appendChild(i.domElement)}})();k=COG.extend(s,{interactTarget:i.domElement,applyStyle:function(){},applyTransform:function(){},drawTiles:function(b){var a,c,l=m;a=n;var u=l-256,
v=a-256;l=l+d;for(var w=a+h,q,r=b.length;r--;){a=b[r];q=a.mesh;(c=a.x>=u&&a.x<=l&&a.y>=v&&a.y<=w)&&!q&&!a.loading&&t(a)}},prepare:function(b,a){m=a.x;n=a.y;f.position.x=g.position.x=m+d;g.position.y=-n;f.position.y=g.position.y-500;return true},render:function(){i.render(e,f)},getCamera:function(){return f},getContext:function(){},getDimensions:function(){return{width:d,height:h}}});COG.info("created three:webgl renderer");return k});
