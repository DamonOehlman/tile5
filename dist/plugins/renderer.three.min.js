T5.registerRenderer("three:webgl",function(l,m,n,t){function u(b){b.loading=true;T5.getImage(b.url,function(a){a=new THREE.Texture(a);var c=b.mesh=new THREE.Mesh(q,new THREE.MeshBasicMaterial({map:a}));b.loading=false;a.needsUpdate=true;c.position.x=b.x+(d>>1);c.position.y=-b.y;f.addObject(c)})}n=COG.extend({},n);var g,f,i,h,q,d,e,p,j=0,k=0;(function(){var b,a;if(m){d=l.width=m.offsetWidth;e=l.height=m.offsetHeight;b=(d/256|0)+2;a=(e/256|0)+2;f=new THREE.Scene;var c;c=new THREE.DirectionalLight(43775,
2);c.position.z=1;f.addLight(c);c=new THREE.DirectionalLight(64,0.5);c.position.z=-1;f.addLight(c);h=new THREE.Mesh(new Plane(b*256,a*256,16,16),new THREE.MeshBasicMaterial({color:16777215,wireframe:true}));f.addObject(h);g=new THREE.Camera(45,d/e,1,2E3,h);g.position.z=500;q=new Plane(256,256,4,4);i=new THREE.WebGLRenderer;i.setSize(d,e);m.appendChild(i.domElement)}})();n=COG.extend(t,{interactTarget:i.domElement,applyStyle:function(){},applyTransform:function(){},drawTiles:function(b){var a,c,o=
j;a=k;var v=o-256,w=a-256;o=o+d;for(var x=a+e,r,s=b.length;s--;){a=b[s];r=a.mesh;(c=a.x>=v&&a.x<=o&&a.y>=w&&a.y<=x)&&!r&&!a.loading&&u(a)}},prepare:function(){var b=l.getOffset(),a=l.getScaleFactor();j=b.x;k=b.y;p=T5.XYRect.init(j,k,j+d,k-e);p.scaleFactor=a;g.position.x=h.position.x=j+d;h.position.y=-k;g.position.y=h.position.y-500;return true},render:function(){i.render(f,g)},getCamera:function(){return g},getContext:function(){},getDimensions:function(){return{width:d,height:e}},getViewport:function(){return p}});
COG.info("created three:webgl renderer");return n});
