T5.RouteTools=function(){function e(b,d){var a=new T5.ShapeLayer;d.geometry&&Position.vectorize(d.geometry,{callback:function(c){a.add(new T5.Line(c,{style:"waypoints",simplify:true}));b.setLayer("route",a)}})}var f={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",
UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},h={calculate:function(b){b=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},b);var d=getEngine("route");d&&d.route(b,function(a){if(b.generalize)a.geometry=Position.generalize(a.geometry,a.getInstructionPositions());if(b.map){e(b.map,a);b.autoFit&&b.map.gotoBounds(a.boundingBox)}b.success&&b.success(a)})},createMapOverlay:e,parseTurnType:function(b){for(var d=
f.Unknown,a=TurnTypeRules,c=0;c<a.length;c++){a[c].regex.lastIndex=-1;var g=a[c].regex.exec(b);if(g){d=a[c].customCheck?a[c].customCheck(b,g):a[c].turnType;break}}return d},TurnType:f};COG.observable(h);return h}();
