glMatrixArrayType=typeof Float32Array!="undefined"?Float32Array:typeof WebGLFloatArray!="undefined"?WebGLFloatArray:Array;var vec3={};vec3.create=function(a){var b=new glMatrixArrayType(3);if(a){b[0]=a[0];b[1]=a[1];b[2]=a[2]}return b};vec3.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};vec3.add=function(a,b,c){if(!c||a==c){a[0]+=b[0];a[1]+=b[1];a[2]+=b[2];return a}c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};
vec3.subtract=function(a,b,c){if(!c||a==c){a[0]-=b[0];a[1]-=b[1];a[2]-=b[2];return a}c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};vec3.negate=function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};vec3.scale=function(a,b,c){if(!c||a==c){a[0]*=b;a[1]*=b;a[2]*=b;return a}c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};
vec3.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],h=Math.sqrt(c*c+d*d+e*e);if(h){if(h==1){b[0]=c;b[1]=d;b[2]=e;return b}}else{b[0]=0;b[1]=0;b[2]=0;return b}h=1/h;b[0]=c*h;b[1]=d*h;b[2]=e*h;return b};vec3.cross=function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var h=b[0],f=b[1];b=b[2];c[0]=e*b-a*f;c[1]=a*h-d*b;c[2]=d*f-e*h;return c};vec3.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};vec3.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};
vec3.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+e*e+a*a);if(!b){c[0]=0;c[1]=0;c[2]=0;return c}b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c};vec3.lerp=function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d};vec3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var mat3={};
mat3.create=function(a){var b=new glMatrixArrayType(9);if(a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9]}return b};mat3.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};mat3.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};
mat3.transpose=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b};mat3.toMat4=function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};var mat4={};mat4.create=function(a){var b=new glMatrixArrayType(16);if(a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15]}return b};
mat4.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};mat4.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
mat4.transpose=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[3],h=a[6],f=a[7],i=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=h;a[11]=a[14];a[12]=e;a[13]=f;a[14]=i;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b};
mat4.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],h=a[4],f=a[5],i=a[6],k=a[7],j=a[8],m=a[9],n=a[10],g=a[11],l=a[12],o=a[13],s=a[14];a=a[15];return l*m*i*e-j*o*i*e-l*f*n*e+h*o*n*e+j*f*s*e-h*m*s*e-l*m*d*k+j*o*d*k+l*c*n*k-b*o*n*k-j*c*s*k+b*m*s*k+l*f*d*g-h*o*d*g-l*c*i*g+b*o*i*g+h*c*s*g-b*f*s*g-j*f*d*a+h*m*d*a+j*c*i*a-b*m*i*a-h*c*n*a+b*f*n*a};
mat4.inverse=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],h=a[3],f=a[4],i=a[5],k=a[6],j=a[7],m=a[8],n=a[9],g=a[10],l=a[11],o=a[12],s=a[13],u=a[14],z=a[15],B=c*i-d*f,w=c*k-e*f,p=c*j-h*f,q=d*k-e*i,r=d*j-h*i,t=e*j-h*k,x=m*s-n*o,v=m*u-g*o,A=m*z-l*o,C=n*u-g*s,D=n*z-l*s,E=g*z-l*u,y=1/(B*E-w*D+p*C+q*A-r*v+t*x);b[0]=(i*E-k*D+j*C)*y;b[1]=(-d*E+e*D-h*C)*y;b[2]=(s*t-u*r+z*q)*y;b[3]=(-n*t+g*r-l*q)*y;b[4]=(-f*E+k*A-j*v)*y;b[5]=(c*E-e*A+h*v)*y;b[6]=(-o*t+u*p-z*w)*y;b[7]=(m*t-g*p+l*w)*y;b[8]=(f*D-i*A+j*x)*y;
b[9]=(-c*D+d*A-h*x)*y;b[10]=(o*r-s*p+z*B)*y;b[11]=(-m*r+n*p-l*B)*y;b[12]=(-f*C+i*v-k*x)*y;b[13]=(c*C-d*v+e*x)*y;b[14]=(-o*q+s*w-u*B)*y;b[15]=(m*q-n*w+g*B)*y;return b};mat4.toRotationMat=function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat4.toMat3=function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};mat4.toInverseMat3=function(a,b){var c=a[0],d=a[1],e=a[2],h=a[4],f=a[5],i=a[6],k=a[8],j=a[9],m=a[10],n=m*f-i*j,g=-m*h+i*k,l=j*h-f*k,o=c*n+d*g+e*l;if(!o)return null;o=1/o;b||(b=mat3.create());b[0]=n*o;b[1]=(-m*d+e*j)*o;b[2]=(i*d-e*f)*o;b[3]=g*o;b[4]=(m*c-e*k)*o;b[5]=(-i*c+e*h)*o;b[6]=l*o;b[7]=(-j*c+d*k)*o;b[8]=(f*c-d*h)*o;return b};
mat4.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],h=a[2],f=a[3],i=a[4],k=a[5],j=a[6],m=a[7],n=a[8],g=a[9],l=a[10],o=a[11],s=a[12],u=a[13],z=a[14];a=a[15];var B=b[0],w=b[1],p=b[2],q=b[3],r=b[4],t=b[5],x=b[6],v=b[7],A=b[8],C=b[9],D=b[10],E=b[11],y=b[12],F=b[13],G=b[14];b=b[15];c[0]=B*d+w*i+p*n+q*s;c[1]=B*e+w*k+p*g+q*u;c[2]=B*h+w*j+p*l+q*z;c[3]=B*f+w*m+p*o+q*a;c[4]=r*d+t*i+x*n+v*s;c[5]=r*e+t*k+x*g+v*u;c[6]=r*h+t*j+x*l+v*z;c[7]=r*f+t*m+x*o+v*a;c[8]=A*d+C*i+D*n+E*s;c[9]=A*e+C*k+D*g+E*u;c[10]=A*
h+C*j+D*l+E*z;c[11]=A*f+C*m+D*o+E*a;c[12]=y*d+F*i+G*n+b*s;c[13]=y*e+F*k+G*g+b*u;c[14]=y*h+F*j+G*l+b*z;c[15]=y*f+F*m+G*o+b*a;return c};mat4.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c};
mat4.multiplyVec4=function(a,b,c){c||(c=b);var d=b[0],e=b[1],h=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*h+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*h+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*h+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*h+a[15]*b;return c};
mat4.translate=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c){a[12]=a[0]*d+a[4]*e+a[8]*b+a[12];a[13]=a[1]*d+a[5]*e+a[9]*b+a[13];a[14]=a[2]*d+a[6]*e+a[10]*b+a[14];a[15]=a[3]*d+a[7]*e+a[11]*b+a[15];return a}var h=a[0],f=a[1],i=a[2],k=a[3],j=a[4],m=a[5],n=a[6],g=a[7],l=a[8],o=a[9],s=a[10],u=a[11];c[0]=h;c[1]=f;c[2]=i;c[3]=k;c[4]=j;c[5]=m;c[6]=n;c[7]=g;c[8]=l;c[9]=o;c[10]=s;c[11]=u;c[12]=h*d+j*e+l*b+a[12];c[13]=f*d+m*e+o*b+a[13];c[14]=i*d+n*e+s*b+a[14];c[15]=k*d+g*e+u*b+a[15];return c};
mat4.scale=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c){a[0]*=d;a[1]*=d;a[2]*=d;a[3]*=d;a[4]*=e;a[5]*=e;a[6]*=e;a[7]*=e;a[8]*=b;a[9]*=b;a[10]*=b;a[11]*=b;return a}c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};
mat4.rotate=function(a,b,c,d){var e=c[0],h=c[1];c=c[2];var f=Math.sqrt(e*e+h*h+c*c);if(!f)return null;if(f!=1){f=1/f;e*=f;h*=f;c*=f}var i=Math.sin(b),k=Math.cos(b),j=1-k;b=a[0];f=a[1];var m=a[2],n=a[3],g=a[4],l=a[5],o=a[6],s=a[7],u=a[8],z=a[9],B=a[10],w=a[11],p=e*e*j+k,q=h*e*j+c*i,r=c*e*j-h*i,t=e*h*j-c*i,x=h*h*j+k,v=c*h*j+e*i,A=e*c*j+h*i;e=h*c*j-e*i;h=c*c*j+k;if(d){if(a!=d){d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15]}}else d=a;d[0]=b*p+g*q+u*r;d[1]=f*p+l*q+z*r;d[2]=m*p+o*q+B*r;d[3]=n*p+s*q+w*
r;d[4]=b*t+g*x+u*v;d[5]=f*t+l*x+z*v;d[6]=m*t+o*x+B*v;d[7]=n*t+s*x+w*v;d[8]=b*A+g*e+u*h;d[9]=f*A+l*e+z*h;d[10]=m*A+o*e+B*h;d[11]=n*A+s*e+w*h;return d};mat4.rotateX=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],h=a[5],f=a[6],i=a[7],k=a[8],j=a[9],m=a[10],n=a[11];if(c){if(a!=c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15]}}else c=a;c[4]=e*b+k*d;c[5]=h*b+j*d;c[6]=f*b+m*d;c[7]=i*b+n*d;c[8]=e*-d+k*b;c[9]=h*-d+j*b;c[10]=f*-d+m*b;c[11]=i*-d+n*b;return c};
mat4.rotateY=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],h=a[1],f=a[2],i=a[3],k=a[8],j=a[9],m=a[10],n=a[11];if(c){if(a!=c){c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15]}}else c=a;c[0]=e*b+k*-d;c[1]=h*b+j*-d;c[2]=f*b+m*-d;c[3]=i*b+n*-d;c[8]=e*d+k*b;c[9]=h*d+j*b;c[10]=f*d+m*b;c[11]=i*d+n*b;return c};
mat4.rotateZ=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],h=a[1],f=a[2],i=a[3],k=a[4],j=a[5],m=a[6],n=a[7];if(c){if(a!=c){c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15]}}else c=a;c[0]=e*b+k*d;c[1]=h*b+j*d;c[2]=f*b+m*d;c[3]=i*b+n*d;c[4]=e*-d+k*b;c[5]=h*-d+j*b;c[6]=f*-d+m*b;c[7]=i*-d+n*b;return c};
mat4.frustum=function(a,b,c,d,e,h,f){f||(f=mat4.create());var i=b-a,k=d-c,j=h-e;f[0]=e*2/i;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=e*2/k;f[6]=0;f[7]=0;f[8]=(b+a)/i;f[9]=(d+c)/k;f[10]=-(h+e)/j;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(h*e*2)/j;f[15]=0;return f};mat4.perspective=function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b=a*b;return mat4.frustum(-b,b,-a,a,c,d,e)};
mat4.ortho=function(a,b,c,d,e,h,f){f||(f=mat4.create());var i=b-a,k=d-c,j=h-e;f[0]=2/i;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2/k;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=-2/j;f[11]=0;f[12]=-(a+b)/i;f[13]=-(d+c)/k;f[14]=-(h+e)/j;f[15]=1;return f};
mat4.lookAt=function(a,b,c,d){d||(d=mat4.create());var e=a[0],h=a[1];a=a[2];var f=c[0],i=c[1],k=c[2];c=b[1];var j=b[2];if(e==b[0]&&h==c&&a==j)return mat4.identity(d);var m,n,g,l;c=e-b[0];j=h-b[1];b=a-b[2];l=1/Math.sqrt(c*c+j*j+b*b);c*=l;j*=l;b*=l;m=i*b-k*j;k=k*c-f*b;f=f*j-i*c;if(l=Math.sqrt(m*m+k*k+f*f)){l=1/l;m*=l;k*=l;f*=l}else f=k=m=0;i=j*f-b*k;n=b*m-c*f;g=c*k-j*m;if(l=Math.sqrt(i*i+n*n+g*g)){l=1/l;i*=l;n*=l;g*=l}else g=n=i=0;d[0]=m;d[1]=i;d[2]=c;d[3]=0;d[4]=k;d[5]=n;d[6]=j;d[7]=0;d[8]=f;d[9]=
g;d[10]=b;d[11]=0;d[12]=-(m*e+k*h+f*a);d[13]=-(i*e+n*h+g*a);d[14]=-(c*e+j*h+b*a);d[15]=1;return d};mat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};quat4={};quat4.create=function(a){var b=new glMatrixArrayType(4);if(a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]}return b};quat4.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};
quat4.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a==b){a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return a}b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};quat4.inverse=function(a,b){if(!b||a==b){a[0]*=1;a[1]*=1;a[2]*=1;return a}b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};quat4.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};
quat4.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],h=a[3],f=Math.sqrt(c*c+d*d+e*e+h*h);if(f==0){b[0]=0;b[1]=0;b[2]=0;b[3]=0;return b}f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;b[3]=h*f;return b};quat4.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],h=a[2];a=a[3];var f=b[0],i=b[1],k=b[2];b=b[3];c[0]=d*b+a*f+e*k-h*i;c[1]=e*b+a*i+h*f-d*k;c[2]=h*b+a*k+d*i-e*f;c[3]=a*b-d*f-e*i-h*k;return c};
quat4.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],h=b[2];b=a[0];var f=a[1],i=a[2];a=a[3];var k=a*d+f*h-i*e,j=a*e+i*d-b*h,m=a*h+b*e-f*d;d=-b*d-f*e-i*h;c[0]=k*a+d*-b+j*-i-m*-f;c[1]=j*a+d*-f+m*-b-k*-i;c[2]=m*a+d*-i+k*-f-j*-b;return c};quat4.toMat3=function(a,b){b||(b=mat3.create());var c=a[0],d=a[1],e=a[2],h=a[3],f=c+c,i=d+d,k=e+e,j=c*f,m=c*i;c=c*k;var n=d*i;d=d*k;e=e*k;f=h*f;i=h*i;h=h*k;b[0]=1-(n+e);b[1]=m-h;b[2]=c+i;b[3]=m+h;b[4]=1-(j+e);b[5]=d-f;b[6]=c-i;b[7]=d+f;b[8]=1-(j+n);return b};
quat4.toMat4=function(a,b){b||(b=mat4.create());var c=a[0],d=a[1],e=a[2],h=a[3],f=c+c,i=d+d,k=e+e,j=c*f,m=c*i;c=c*k;var n=d*i;d=d*k;e=e*k;f=h*f;i=h*i;h=h*k;b[0]=1-(n+e);b[1]=m-h;b[2]=c+i;b[3]=0;b[4]=m+h;b[5]=1-(j+e);b[6]=d-f;b[7]=0;b[8]=c-i;b[9]=d+f;b[10]=1-(j+n);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};quat4.slerp=function(a,b,c,d){d||(d=a);var e=c;if(a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]<0)e=-1*c;d[0]=1-c*a[0]+e*b[0];d[1]=1-c*a[1]+e*b[1];d[2]=1-c*a[2]+e*b[2];d[3]=1-c*a[3]+e*b[3];return d};
quat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};
T5.registerRenderer("webgl",function(a,b,c,d,e){function h(p){var q,r,t,x,v,A,C;p.loading=true;T5.getImage(p.url,function(D){q=p.texture=g.createTexture();q.image=D;p.loading=false;g.bindTexture(g.TEXTURE_2D,q);g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,true);g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,q.image);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST);g.bindTexture(g.TEXTURE_2D,null);t=p.x;v=-p.y;x=t+p.w;A=v+p.h;
C=[x,A,0,t,A,0,x,v,0,t,v,0];r=p.buffer=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,r);g.bufferData(g.ARRAY_BUFFER,new Float32Array(C),g.STATIC_DRAW);r.itemSize=3;r.numItems=4;a.invalidate()})}function f(){function p(q,r){var t=g.createShader(q);g.shaderSource(t,r);g.compileShader(t);return t}l=g.createProgram();g.attachShader(l,p(g.FRAGMENT_SHADER,i));g.attachShader(l,p(g.VERTEX_SHADER,k));g.linkProgram(l);g.getProgramParameter(l,g.LINK_STATUS)||COG.warn("Could not initialise shaders");g.useProgram(l);
l.vertexPositionAttribute=g.getAttribLocation(l,"aVertexPosition");g.enableVertexAttribArray(l.vertexPositionAttribute);l.textureCoordAttribute=g.getAttribLocation(l,"aTextureCoord");g.enableVertexAttribArray(l.textureCoordAttribute);l.pMatrixUniform=g.getUniformLocation(l,"uPMatrix");l.mvMatrixUniform=g.getUniformLocation(l,"uMVMatrix");l.samplerUniform=g.getUniformLocation(l,"uSampler")}d=COG.extend({},d);var i="#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nvoid main(void) {\ngl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n}",
k="attribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nvarying vec2 vTextureCoord;\nvoid main(void) {\ngl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\nvTextureCoord = aTextureCoord;\n}",j,m,n,g,l,o=mat4.create(),s=mat4.create(),u=[],z=0,B=0,w;if(b){j=a.width=b.offsetWidth;m=a.height=b.offsetHeight;n=T5.newCanvas(j,m);n.style.cssText="position: absolute; z-index: 1;";g=n.getContext("experimental-webgl");g.viewportWidth=
j;g.viewportHeight=m;b.appendChild(n);f();w=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,w);g.bufferData(g.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),g.STATIC_DRAW);w.itemSize=2;w.numItems=4;g.clearColor(0,0,0,1);g.enable(g.DEPTH_TEST)}c=COG.extend(e,{interactTarget:n,applyStyle:function(p){getStyle(p)},applyTransform:function(){},arc:function(){},drawTiles:function(p,q){for(var r,t=z,x=B,v=q.length;v--;){r=q[v];r.screenX=r.x-t;r.screenY=r.y-x;!r.buffer&&!r.loading&&h(r);if(r.buffer)u[u.length]=
r}},image:function(){},prepare:function(p,q){z=q.x;B=q.y;u=[];g.viewport(0,0,j,m);g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);mat4.perspective(45,j/m,0.1,1E3,s);mat4.identity(o);mat4.rotate(o,-Math.PI/4,[1,0,0]);mat4.translate(o,[-z-j/2,B+200/q.scaleFactor,-200/q.scaleFactor]);return true},render:function(){for(var p=u.length;p--;){var q=u[p];g.bindBuffer(g.ARRAY_BUFFER,q.buffer);g.vertexAttribPointer(l.vertexPositionAttribute,q.buffer.itemSize,g.FLOAT,false,0,0);g.bindBuffer(g.ARRAY_BUFFER,w);
g.vertexAttribPointer(l.textureCoordAttribute,w.itemSize,g.FLOAT,false,0,0);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,q.texture);g.uniform1i(l.samplerUniform,0);g.drawArrays(g.TRIANGLE_STRIP,0,q.buffer.numItems)}g.uniformMatrix4fv(l.pMatrixUniform,false,s);g.uniformMatrix4fv(l.mvMatrixUniform,false,o)},path:function(){},getContext:function(){return context},getDimensions:function(){return{width:j,height:m}},getViewport:function(){}});COG.info("created webgl renderer");c.bind("detach",
function(){b.removeChild(n)});return c});
