T5.Registry.register("control","zoombar",function(d,v,g,b,m){function w(a,c){var f=n[a]=T5.DOM.create("div","t5-zoombar-button",{position:"absolute",background:x(a),"z-index":51,width:b.width+"px",height:b.buttonHeight+"px","margin-top":(c||0)+"px"});e.appendChild(f)}function x(a,c){return"url("+b.images+") 0 -"+(y+k*3+(a||0)*o*3+(c||0)*o)+"px"}function z(a){return"url("+b.images+") 0 -"+(y+(a||0)*k)+"px"}function s(a,c){var f;if(a===p){p.style.background=z(c);f="thumb"}else for(var h=0;h<n.length;h++)if(a===
n[h]){f="button"+h;n[h].style.background=x(h,c);break}return f}function t(a){if(a!==q){q=a;l=r-q/u*(r-i)|0;T5.DOM.move(p,0,l-i);clearTimeout(A);A=setTimeout(function(){d.zoom(q)},500)}}b=_extend({width:24,height:200,images:"/img/zoom.png",align:"right",marginTop:10,spacing:10,thumbHeight:16,buttonHeight:16},b.zoombar);var o=b.buttonHeight,j,y=b.height,p,k=b.thumbHeight,i=b.spacing+o-(k>>1),r=b.height-o-(k>>1),l=i,q=-1;v=d.minZoom();var u=d.maxZoom()-v+1,n=[],e,A=0,B={button0:function(){d.zoom(d.zoom()+
1)},button1:function(){d.zoom(d.zoom()-1)}};e=T5.DOM.create("div","t5-zoombar",{position:"absolute",background:"url("+b.images+")","z-index":50,overflow:"hidden",width:b.width+"px",height:b.height+"px",margin:function(){var a=b.spacing,c=_formatter("{0}px 0 0 {1}px");if(b.align==="right")a=g.offsetWidth-b.width-b.spacing;return c(b.marginTop,a)}()});g.childNodes[0]?g.insertBefore(e,g.childNodes[0]):g.appendChild(e);e.appendChild(p=T5.DOM.create("div","t5-zoombar-thumb",{position:"absolute",background:z(),
"z-index":51,width:b.width+"px",height:b.thumbHeight+"px",margin:"10px 0 0 0",top:l-i+"px"}));w(0);w(1,b.height-b.buttonHeight);j=INTERACT.watch(e,{bindTarget:e});j.bind("pointerMove",function(a,c,f){l=Math.min(Math.max(i,f.y-(k>>1)),r);t(u-(l-i)/r*u|0)});j.bind("pointerDown",function(a){s(a.target,2)});j.bind("pointerUp",function(a){s(a.target,0)});j.bind("tap",function(a){(a=B[s(a.target,2)])&&a()});m=_extend(m,{});m.bind("detach",function(){j.unbind();g.removeChild(e)});d.bind("zoom",function(a,
c){t(c)});t(d.zoom());return m});
