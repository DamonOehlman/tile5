COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var P=arguments[0]||{},ga,M=1,C=arguments.length;M<C;M++)if((ga=arguments[M])!==null)for(var j in ga){var k=ga[j];if(P!==k)if(k!==undefined)P[j]=k}return P};
(function(){var P=Object.prototype.hasOwnProperty,ga=0,M={};M.toID=function(C){return C.replace(/\s/g,"-")};M.objId=function(C){return(C?C:"obj")+ga++};M.isFunction=function(C){return toString.call(C)==="[object Function]"};M.isArray=function(C){return toString.call(C)==="[object Array]"};M.isPlainObject=function(C){if(!C||toString.call(C)!=="[object Object]"||C.nodeType||C.setInterval)return false;if(C.constructor&&!P.call(C,"constructor")&&!P.call(C.constructor.prototype,"isPrototypeOf"))return false;
var j;for(j in C);return j===undefined||P.call(C,j)};M.isEmptyObject=function(C){for(var j in C)return false;return true};M.isXmlDocument=function(C){return toString.call(C)==="[object Document]"};M.contains=function(C,j){var k=C,x=arguments,D=1;if(j&&module.isArray(j)){x=j;D=0}for(D=D;D<x;D++)k=k&&typeof foo[x[D]]!=="undefined";return k};M.formatStr=function(C){if(arguments.length<=1)return C;for(var j=arguments.length-2,k=0;k<=j;k++)C=C.replace(RegExp("\\{"+k+"\\}","gi"),arguments[k+1]);return C};
M.wordExists=function(C,j){var k="";if(j.toString)j=j.toString();for(var x=0;x<j.length;x++)k+=!/\w/.test(j[x])?"\\"+j[x]:j[x];return RegExp("(^|\\s|\\,)"+k+"(\\,|\\s|$)","i").test(C)};COG.extend(COG,M)})();
(function(){function P(k){return typeof console!=="undefined"?function(){console[k](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ga=window.console&&window.console.markTimeline,M=P("error"),C=P("info"),j=function(){return ga?function(k,x){console.markTimeline(k+(x?": "+((new Date).getTime()-x)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:P("debug"),info:C,warn:P("warn"),error:M,exception:function(k){if(M)for(var x in k)C("ERROR DETAIL: "+
x+": "+k[x])}})})();
(function(){function P(M,C){var j=M.obsHandlers;j[C]||(j[C]=[]);return j[C]}var ga=0;COG.observable=function(M){if(!M)return null;if(!M.obsHandlers)M.obsHandlers={};if(!(M.bind||M.trigger||M.unbind)){M.bind=function(C,j){var k="callback"+ga++;P(M,C).unshift({fn:j,id:k});return k};M.triggerCustom=function(C,j){var k=P(M,C),x={cancel:false,name:C,source:this},D;j&&COG.extend(x,j);if(!k)return null;D=Array.prototype.slice.call(arguments,2);M.eventInterceptor&&M.eventInterceptor(C,x,D);D.unshift(x);for(var V=
k.length;V--&&!x.cancel;)k[V].fn.apply(this,D);return x};M.trigger=function(C){var j=Array.prototype.slice.call(arguments,1);j.splice(0,0,C,null);return M.triggerCustom.apply(this,j)};M.unbind=function(C,j){if(typeof C==="undefined")M.obsHandlers={};else for(var k=P(M,C),x=0;k&&x<k.length;x++)if(k[x].id===j){k.splice(x,1);break}return M}}return M}})();
(function(){function P(j,k){j[k]||(j[k]=function(x){return j.configure(k,x)})}function ga(j){j.gtConfId="configurable"+C++;j.gtConfig={};j.gtConfigFns=[];return j.gtConfig}var M={},C=0;COG.paramTweaker=function(j,k,x){return function(D,V){if(typeof V!=="undefined"){if(D in j)j[D]=V;x&&D in x&&x[D](D,V)}else return k&&D in k?k[D](D):j[D]}};COG.configurable=function(j,k,x,D){if(j){j.gtConfId||ga(j);var V=j.gtConfId,m=j.gtConfig,K=j.gtConfigFns;M[V]=j;K.push(x);for(x=k.length;x--;){m[k[x]]=true;D&&P(j,
k[x])}if(!j.configure)j.configure=function(H,N){if(m[H]){for(var y=K.length;y--;){var A=K[y](H,N);if(typeof A!=="undefined")return A}return M[V]}return null}}}})();
(function(){function P(j){var k=document.createElement("script"),x=false;k.src=j;k.async=true;k.onload=k.onreadystatechange=function(){if(!x&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){x=true;k.onload=k.onreadystatechange=null;k&&k.parentNode&&k.parentNode.removeChild(k)}};M||(M=document.getElementsByTagName("head")[0]);M.appendChild(k)}var ga=0,M,C=this;COG.jsonp=function(j,k,x){j+=j.indexOf("?")>=0?"&":"?";var D="json"+ ++ga;C[D]=function(V){k(V);C[D]=null;try{delete C[D]}catch(m){}};
P(j+(x?x:"callback")+"="+D);return D}})();
(function(){var P=1.70158,ga=Math.PI/2,M=1E3/60|0,C=Math.abs,j=Math.pow,k=Math.sin,x=Math.asin,D=Math.cos,V={linear:function(m,K,H,N){return H*m/N+K},backin:function(m,K,H,N){return H*(m/=N)*m*((P+1)*m-P)+K},backout:function(m,K,H,N){return H*((m=m/N-1)*m*((P+1)*m+P)+1)+K},backinout:function(m,K,H,N){return(m/=N/2)<1?H/2*m*m*(((P*=1.525)+1)*m-P)+K:H/2*((m-=2)*m*(((P*=1.525)+1)*m+P)+2)+K},bouncein:function(m,K,H,N){return H-V.bounceout(N-m,0,H,N)+K},bounceout:function(m,K,H,N){return(m/=N)<1/2.75?
H*7.5625*m*m+K:m<2/2.75?H*(7.5625*(m-=1.5/2.75)*m+0.75)+K:m<2.5/2.75?H*(7.5625*(m-=2.25/2.75)*m+0.9375)+K:H*(7.5625*(m-=2.625/2.75)*m+0.984375)+K},bounceinout:function(m,K,H,N){return m<N/2?V.bouncein(m*2,0,H,N)/2+K:V.bounceout(m*2-N,0,H,N)/2+H/2+K},cubicin:function(m,K,H,N){return H*(m/=N)*m*m+K},cubicout:function(m,K,H,N){return H*((m=m/N-1)*m*m+1)+K},cubicinout:function(m,K,H,N){if((m/=N/2)<1)return H/2*m*m*m+K;return H/2*((m-=2)*m*m+2)+K},elasticin:function(m,K,H,N,y,A){if(m==0)return K;if((m/=
N)==1)return K+H;A||(A=N*0.3);if(!y||y<C(H)){y=H;H=A/4}else H=A/TWO_PI*x(H/y);return-(y*j(2,10*(m-=1))*k((m*N-H)*TWO_PI/A))+K},elasticout:function(m,K,H,N,y,A){var I;if(m==0)return K;if((m/=N)==1)return K+H;A||(A=N*0.3);if(!y||y<C(H)){y=H;I=A/4}else I=A/TWO_PI*x(H/y);return y*j(2,-10*m)*k((m*N-I)*TWO_PI/A)+H+K},elasticinout:function(m,K,H,N,y,A){var I;if(m==0)return K;if((m/=N/2)==2)return K+H;A||(A=N*0.3*1.5);if(!y||y<C(H)){y=H;I=A/4}else I=A/TWO_PI*x(H/y);if(m<1)return-0.5*y*j(2,10*(m-=1))*k((m*
N-I)*TWO_PI/A)+K;return y*j(2,-10*(m-=1))*k((m*N-I)*TWO_PI/A)*0.5+H+K},quadin:function(m,K,H,N){return H*(m/=N)*m+K},quadout:function(m,K,H,N){return-H*(m/=N)*(m-2)+K},quadinout:function(m,K,H,N){if((m/=N/2)<1)return H/2*m*m+K;return-H/2*(--m*(m-2)-1)+K},sinein:function(m,K,H,N){return-H*D(m/N*ga)+H+K},sineout:function(m,K,H,N){return H*k(m/N*ga)+K},sineinout:function(m,K,H,N){return-H/2*(D(Math.PI*m/N)-1)+K}};COG.tweenValue=function(m,K,H,N,y){function A(la){if(sa+M<la){var va=la-I,ba=H(va,m,ha,
N),ta=I+N<=la;la=!ta;if(y){va=y(ba,ta,va);la=typeof va!="undefined"?va&&la:la}la&&animFrame(A)}}var I=(new Date).getTime(),sa=0,ha=K-m;animFrame(A);return{}};COG.easing=function(m){return V[m.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(m,K){V[m.replace(/[\-\_\s\.]/g,"").toLowerCase()]=K}})();
(function(){var P=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ga=/^(\d+H)?(\d+M)?(\d+S)?$/,M={8601:function(j){j=j.split("T");var k=null;k=null;var x=0,D=0;P.lastIndex=-1;k=P.exec(j[0]);x+=k[3]?parseInt(k[3].slice(0,-1),10):0;ga.lastIndex=-1;k=ga.exec(j[1]);D+=k[1]?parseInt(k[1].slice(0,-1),10)*3600:0;D+=k[2]?parseInt(k[2].slice(0,-1),10)*60:0;D+=k[3]?parseInt(k[3].slice(0,-1),10):0;return new C(x,D)}},C=COG.Duration=function(j,k){return{days:j?j:0,seconds:k?k:0}};COG.addDuration=function(){for(var j=new C,k=arguments.length;k--;){j.days+=
arguments[k].days;j.seconds+=arguments[k].seconds}if(j.seconds>=86400){j.days+=~~(j.seconds/86400);j.seconds%=86400}return j};COG.formatDuration=function(j){var k,x,D="";if(j.days)D=j.days+" days ";if(j.seconds){j=j.seconds;if(j>=3600){k=~~(j/3600);j-=k*3600}if(j>=60){x=Math.round(j/60);j-=x*60}if(k)D=D+k+(k>1?" hrs ":" hr ")+(x?(x>10?x:"0"+x)+" min ":"");else if(x)D=D+x+" min";else if(j>0)D=D+(j>10?j:"0"+j)+" sec"}return D};COG.parseDuration=function(j,k){var x=k?M[k]:null;if(x)return x(j);COG.Log.warn("Could not find duration parser for specified format: "+
k);return new C}})();COG.ObjectStore=function(){var P={},ga={},M="obj_"+(new Date).getTime(),C=0,j=Object.prototype.hasOwnProperty;return{add:function(k,x){var D;x=x?x:"default";if(k&&k.constructor)if(!j.call(k,"id"))k.id=M+ ++C;D=ga[x]?ga[x]:ga[x]=[];P[k.id]=D.length;D[k.length]=k}}};var CANI={};
(function(P){var ga=[],M=0,C=false,j=P.register=function(k,x){ga.push({section:k,run:x})};P.init=function(k){function x(){if(M<ga.length){var V=ga[M++];D[V.section]||(D[V.section]={});V.run(D[V.section],x)}else{for(V in D)P[V]=D[V];C=true;k&&k(P)}}var D={};if(C&&k)k(P);else{M=0;x()}};j("canvas",function(k,x){var D=document.createElement("canvas"),V=D.getContext("2d");D.width=200;D.height=200;k.pipTransformed=function(){var m;V.save();try{V.translate(50,50);V.beginPath();V.rect(0,0,20,20);m=V.isPointInPath(10,
10)}finally{V.restore()}return m}();x()})})(CANI);
INTERACT=function(){function P(y){return function(A,I,sa){(sa?sa:y?document.body:document).addEventListener(A,I,false)}}function ga(y){return function(A,I,sa){(sa?sa:y?document.body:document).removeEventListener(A,I,false)}}function M(y,A,I){(I?I:document).attachEvent("on"+y,A)}function C(y,A,I){(I?I:document).detachEvent("on"+y,A)}function j(y,A){return{x:y?y:0,y:A?A:0,count:1}}function k(y,A){H.push(COG.extend({handler:null,checks:{},type:y},A))}function x(y){var A=0,I=0;if(y.offsetParent){do{A+=
y.offsetLeft;I+=y.offsetTop;y=y.offsetParent}while(y)}return{x:A,y:I}}function D(y,A){return{source:y,target:A.target?A.target:A.srcElement}}function V(y,A){for(var I=y.target?y.target:y.srcElement;I&&I!==A&&I.nodeName&&I.nodeName.toUpperCase()!="CANVAS";)I=I.parentNode;return I&&I===A}function m(y,A){return{x:y.x-(A?A.x:0),y:y.y-(A?A.y:0)}}function K(y){if(y.preventDefault){y.preventDefault();y.stopPropagation()}else y.cancelBubble&&y.cancelBubble()}var H=[],N=function(y,A,I){function sa(pa,ca,ua,
X){var fa=0,Ca=0,q=0;COG.tweenValue(0,pa,ua,X,function(ya){q=fa;fa=ya});COG.tweenValue(0,ca,ua,X,function(ya){ha.trigger("pan",fa-q,ya-Ca);Ca=ya})}I=COG.extend({binder:null,unbinder:null,observable:null},I);for(var ha=I.observable,la=null,va=[],ba=[],ta,za,Ia={bind:function(){return ha.bind.apply(null,arguments)},pannable:function(pa){la=COG.extend({inertia:true},pa);return Ia},unbind:function(){ha.unbind();for(var pa=0;pa<va.length;pa++)va[pa].unbind();return Ia}},Ga=0;Ga<A.length;Ga++)va.push(A[Ga](y,
ha,I));ha.bind("pointerDown",function(){ba=[];za=ta=0});ha.bind("pointerMove",function(pa,ca,ua,X){if(la){ba[ba.length]={ticks:(new Date).getTime(),x:X.x,y:X.y};ha.trigger("pan",X.x,X.y)}ta+=X.x?X.x:0;za+=X.y?X.y:0});ha.bind("pointerUp",function(pa,ca,ua){if(Math.abs(ta)>20||Math.abs(za)>20){if(la){ua=ba.length;var X,fa;ca=0;for(fa=ba.length;--fa>1&&ca<50;)ca+=ba[fa].ticks-ba[fa-1].ticks;if(ua-fa>1){pa=ba[ua-1].x-ba[fa].x;X=ba[ua-1].y-ba[fa].y;fa=Math.sqrt(pa*pa+X*X)|0;if(fa>15){pa=ba[ua-1].x-ba[0].x;
X=ba[ua-1].y-ba[0].y;fa=Math.sqrt(pa*pa+X*X)|0;ua=Math.asin(X/fa);ca=fa*500/ca|0;ca=ca>300?300:ca;sa(Math.cos(pa>0?ua:Math.PI-ua)*ca,Math.sin(ua)*ca,COG.easing("sine.out"),500)}}}}else ha.trigger("tap",ca,ua)});return Ia};k("pointer",{handler:function(y,A,I){function sa(q){if(V(q,y))if(Ga=ba(q)){y.style.cursor="move";K(q);fa=q.pageX?q.pageX:q.screenX;Ca=q.pageY?q.pageY:q.screenY;pa=j(fa,Ca);ca=x(y);A.triggerCustom("pointerDown",D("mouse",q),pa,m(pa,ca))}}function ha(q){ua=q.pageX?q.pageX:q.screenX;
X=q.pageY?q.pageY:q.screenY;if(V(q,y))ta(q,Ga?"pointerMove":"pointerHover")}function la(q){if(Ga&&ba(q)){Ga=false;if(V(q,y)){y.style.cursor="default";ta(q,"pointerUp")}}}function va(q){if(V(q,y)){var ya;q=q||window.event;if(q.detail)ya=q.axis===2?-q.detail*za:0;else{ya=q.wheelDeltaY?q.wheelDeltaY:q.wheelDelta;if(window.opera)ya=-ya}if(ya!==0){var qa=j(ua,X);A.triggerCustom("zoom",D("mouse",q),qa,m(qa,x(y)),ya/Ia,"wheel");K(q);q.returnValue=false}}}function ba(q){q=q||window.event;return(q.which||
q.button)==1}function ta(q,ya,qa,Ta,Ja){qa=typeof qa!="undefined"?qa:ua;Ta=typeof Ta!="undefined"?Ta:X;var T=qa-fa,da=Ta-Ca,Z=j(qa,Ta);ca||(ca=x(y));A.triggerCustom(ya,D("mouse",q),Z,m(Z,ca),j(T,da));if(typeof Ja=="undefined"||Ja){fa=qa;Ca=Ta}}I=COG.extend({},I);var za=120,Ia=za*8,Ga=false,pa,ca,ua,X,fa,Ca;I.binder("mousedown",sa,false);I.binder("mousemove",ha,false);I.binder("mouseup",la,false);I.binder("dblclick",function(q){COG.info("captured double click");if(V(q,y)){var ya=j(q.pageX?q.pageX:
q.screenX,q.pageY?q.pageY:q.screenY);COG.info("captured double click + target matched");A.triggerCustom("doubleTap",D("mouse",q),ya,m(ya,x(y)))}},false);I.binder("mousewheel",va,document);I.binder("DOMMouseScroll",va,document);return{unbind:function(){I.unbinder("mousedown",sa,false);I.unbinder("mousemove",ha,false);I.unbinder("mouseup",la,false);I.unbinder("mousewheel",va,document);I.unbinder("DOMMouseScroll",va,document)}}},checks:{touch:false}});k("pointer",{handler:function(y,A,I){function sa(T){if(T.count<
2)return 0;var da=T.x-T.next.x;T=T.y-T.next.y;return~~Math.sqrt(da*da+T*T)}function ha(T,da,Z){da=da?da:0;Z=Z?Z:0;for(var Na={x:T.x-da,y:T.y-Z,id:T.id,count:T.count},Ua=Na;T.next;){T=T.next;Ua=Ua.next={x:T.x-da,y:T.y-Z,id:T.id}}return Na}function la(T,da){var Z=T[da?da:"touches"],Na,Ua;if(Z.length===0)return null;Ua=Na={x:Z[0].pageX,y:Z[0].pageY,id:Z[0].identifier,count:Z.length};for(var Pa=1,ib=Z.length;Pa<ib;Pa++)Ua=Ua.next={x:Z[Pa].pageX,y:Z[Pa].pageY,id:Z[Pa].identifier};return Na}function va(T){if(V(T,
y)){X=x(y);var da=la(T,"changedTouches"),Z=ha(da,X.x,X.y);if(!Ca){fa=pa;A.triggerCustom("pointerDown",D("touch",T),da,Z)}Ta&&A.triggerCustom("pointerDownMulti",D("touch",T),da,Z);Ca=la(T);if(Ca.count>1)ya=sa(Ca);Ja=1;qa=ha(Ca)}}function ba(T){if(V(T,y)){T.preventDefault();q=la(T);if(fa==pa)fa=Math.abs(Ca.x-q.x)>Ia||Math.abs(Ca.y-q.y)>Ia?Ga:pa;if(fa!=pa){fa=q.count>1?ua:ca;if(fa==ua)if(Ca.count===1){Ca=ha(q);ya=sa(Ca)}else{var da=sa(q);if(Math.abs(ya-da)<za)fa=ca;else{var Z;Z=q.x;var Na=q.next.x,Ua=
q.y,Pa=q.next.y,ib=Ua<Pa?Ua:Pa;Z={x:(Z<Na?Z:Na)+(Math.abs(Z-Na)>>1),y:ib+(Math.abs(Ua-Pa)>>1)};da=da/ya;Na=da-Ja;A.triggerCustom("zoom",D("touch",T),Z,m(Z,X),Na,"pinch");Ja=da}}fa==ca&&A.triggerCustom("pointerMove",D("touch",T),q,ha(q,X.x,X.y),j(q.x-qa.x,q.y-qa.y));Ta&&A.triggerCustom("pointerMoveMulti",D("touch",T),q,ha(q,X.x,X.y))}qa=ha(q)}}function ta(T){if(V(T,y)){var da=la(T,"changedTouches"),Z=ha(da,X.x,X.y);q=la(T);if(!q){A.triggerCustom("pointerUp",D("touch",T),da,Z);Ca=null}Ta&&A.triggerCustom("pointerUpMulti",
D("touch",T),da,Z)}}I=COG.extend({detailed:false,inertia:false},I);var za=20,Ia=7,Ga=0,pa=1,ca=2,ua=3,X,fa,Ca,q,ya,qa,Ta=I.detailed,Ja=1;I.binder("touchstart",va,false);I.binder("touchmove",ba,false);I.binder("touchend",ta,false);COG.info("initialized touch handler");return{unbind:function(){I.unbinder("touchstart",va,false);I.unbinder("touchmove",ba,false);I.unbinder("touchend",ta,false)}}},checks:{touch:true}});return{register:k,watch:function(y,A,I){A=COG.extend({bindToBody:false,observable:null,
isIE:typeof window.attachEvent!="undefined",types:null},A);capabilities=COG.extend({touch:"ontouchstart"in window},I);if(!A.observable){COG.info("creating observable");A.observable=COG.observable({});globalOpts=A}A.binder=A.isIE?M:P(A.bindToBody);A.unbinder=A.isIE?C:ga(A.bindToBody);I=A.types;for(var sa=capabilities,ha=[],la=H.length;la--;){var va=H[la],ba=!I||I.indexOf(va.type)>=0,ta=true;for(var za in va.checks){var Ia=va.checks[za];COG.info("checking "+za+" capability. require: "+Ia+", capability = "+
sa[za]);ta=ta&&Ia===sa[za]}if(ba&&ta)ha[ha.length]=va.handler}return new N(y,ha,A)}}}();var T5={};
(function(P){function ga(){return(new Date).getTime()}function M(){for(;Na.length>0;){var b=Na.shift();document.location=b}Z=0}function C(b){for(var n=true,h=Ua.length;h--;)n=n&&b!=Ua[h];return n}function j(b,n){var h=[];for(var e in n)e&&h.push(e+"="+escape(n[e]));return"tile5://"+b+"/"+(h.length>0?"?"+h.join("&"):"")}function k(b,n){C(b)&&COG.info("would push url: "+j(b,n))}function x(b,n){if(C(b)){Na.push(j(b,n));Z||(Z=setTimeout(M,100))}}function D(b){return function(n,h,e){(e?e:b?document.body:
document).addEventListener(n,h,false)}}function V(b){return function(n,h,e){(e?e:b?document.body:document).removeEventListener(n,h,false)}}function m(b,n,h){(h?h:document).attachEvent("on"+b,n)}function K(b,n,h){(h?h:document).detachEvent("on"+b,n)}function H(){Ja={base:{name:"Unknown",bindEvent:D(),unbindEvent:V(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:k,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:m,unbindEvent:K,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:x,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:x},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:x},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:D(true),unbindEvent:V(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:x},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:x}};T=[Ja.froyo,Ja.android,Ja.ipod,Ja.iphone,Ja.ipad,Ja.ie]}function N(){Ja||H();if(!da){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<T.length;b++){var n=T[b];if(n.regex&&n.regex.test(navigator.userAgent)){da=COG.extend({},Ja.base,n);COG.info("PLATFORM DETECTED AS: "+da.name);break}}if(!da){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
da=Ja.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return da}function y(){for(var b=0,n=arguments.length;n--;){var h=Hb[arguments[n].toUpperCase()];if(h)b|=h}return b}function A(b,n){var h,e;if(n&&n.width>0){if(!b.imageOffset)b.imageOffset=q.init(-n.width>>1,-n.height>>1);if(!b.bounds){h=b.xy.x+b.imageOffset.x;e=b.xy.y+b.imageOffset.y;b.bounds=qa.init(h,e,h+n.width,e+n.height)}}}function I(b){function n(){b.transformed=g!==1||e%sa!==0||s!==0||l!==0}var h=1E3/60|0,e=0,g=1,
s=0,l=0;COG.extend(b,{animate:function(v,F,r,z,B,Q){var ma=(new Date).getTime(),oa=b[v],W=F.length&&r.length&&F.length==r.length?F.length:0,t=Array(W),O=Array(W),$=COG.easing(z?z:"sine.out"),R=function(Aa){if(Aa-0>h){var db=Aa-ma;Aa=ma+B<=Aa;for(var ia=W;ia--;)O[ia]=$(db,F[ia],t[ia],B);oa.apply(b,O);b.invalidate.call(b);if(Aa){oa.apply(b,r);b.invalidate.call(b);Q&&Q()}else animFrame(R)}};if(oa&&oa.apply&&W>0){B=B?B:1E3;for(v=W;v--;)t[v]=r[v]-F[v];animFrame(R)}},rotate:function(v){e=v;n()},scale:function(v){g=
v;n()},translate:function(v,F){s=v;l=F;n()},transform:function(v,F,r){v.save();v.translate(b.xy.x-F+s,b.xy.y-r+l);e!==0&&v.rotate(e);g!==1&&v.scale(g,g)}})}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var sa=Math.PI*2,ha=Math.PI/2,la=Math.abs,va=Math.ceil,ba=Math.min,ta=Math.max,
za=Math.pow,Ia=Math.sqrt,Ga=Math.log,pa=Math.round,ca=Math.sin,ua=Math.asin,X=Math.cos,fa=Math.atan,Ca=Math.atan2,q=function(){function b(e,g){return h(e.x-g.x,e.y-g.y)}function n(e,g){if(!g)g=e.length;if(g<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var s={edges:Array(g-1),accrued:Array(g-1),total:0},l=0;l<g-1;l++){var v=b(e[l],e[l+1]);s.edges[l]=Ia(v.x*v.x+v.y*v.y);s.accrued[l]=s.total+s.edges[l];s.total+=s.edges[l]}return s}function h(e,g){return{x:e?
e:0,y:g?g:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var e=0,g=0,s=arguments.length;s--;){e+=arguments[s].x;g+=arguments[s].y}return h(e,g)},absSize:function(e){return ta(la(e.x),la(e.y))},copy:function(e){return e?h(e.x,e.y):null},diff:b,distance:function(e,g){return n(e,g).total},edges:n,equals:function(e,g){return e.x===g.x&&e.y===g.y},extendBy:function(e,g,s){var l=X(g)*s;g=ca(g)*s;return h(e.x-l,e.y-g)},floor:function(e){for(var g=Array(e.length),s=e.length;s--;)g[s]=
h(~~e[s].x,~~e[s].y);return g},getRect:function(e){for(var g,s,l,v,F=e.length;F--;){var r=e[F];g=typeof g==="undefined"||r.x<g?r.x:g;s=typeof s==="undefined"||r.y<s?r.y:s;l=typeof l==="undefined"||r.x>l?r.x:l;v=typeof v==="undefined"||r.y>v?r.y:v}return qa.init(g,s,l,v)},init:h,invert:function(e){return h(-e.x,-e.y)},min:function(e,g){return h(e.x<g.x?e.x:g.x,e.y<g.y?e.y:g.y)},max:function(e,g){return h(e.x>g.x?e.x:g.x,e.y>g.y?e.y:g.y)},offset:function(e,g,s){return h(e.x+g,e.y+(s?s:g))},scale:function(e,
g){return h(e.x/g|0,e.y/g|0)},simplify:function(e,g){if(!e)return null;g=g?g:q.VECTOR_SIMPLIFICATION;for(var s=[],l=null,v=e.length;v--;){var F=e[v];if(include=!l||v===0||la(F.x-l.x)+la(F.y-l.y)>g){s.unshift(F);l=F}}return s},theta:function(e,g,s){s=ua((e.y-g.y)/s);return e.x>g.x?s:Math.PI-s},toString:function(e){return e?e.x+", "+e.y:""}}}(),ya=function(){return{dotProduct:function(b,n){return b.x*n.x+b.y*n.y}}}(),qa=function(){function b(h){return n(h.x1,h.y1,h.x2,h.y2)}function n(h,e,g,s){h=h?
h:0;e=e?e:0;g=typeof g!=="undefined"?g:h;s=typeof s!=="undefined "?s:s;return{x1:h,y1:e,x2:g,y2:s,width:g-h,height:s-e}}return{center:function(h){return q.init(h.x1+(h.width>>1),h.y1+(h.height>>1))},copy:b,diagonalSize:function(h){return Ia(h.width*h.width+h.height*h.height)},fromCenter:function(h,e,g,s){g=g>>1;s=s>>1;return n(h-g,e-s,h+g,e+s)},init:n,intersect:function(h,e){var g=ta(h.x1,e.x1),s=ta(h.y1,e.y1),l=ba(h.x2,e.x2),v=ba(h.y2,e.y2);g=n(g,s,l,v);return g.width>0&&g.height>0?g:null},toString:function(h){return h?
"["+h.x1+", "+h.y1+", "+h.x2+", "+h.y2+"]":""},union:function(h,e){if(h.width===0||h.height===0)return b(e);else if(e.width===0||e.height===0)return b(h);else{var g=ba(h.x1,e.x1),s=ba(h.y1,e.y1),l=ta(h.x2,e.x2),v=ta(h.y2,e.y2);g=n(g,s,l,v);return g.width>0&&g.height>0?g:null}}}}(),Ta=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return q.init(b.width>>1,b.height>>1)},getSize:function(b){return Ia(za(b.width,2)+za(b.height,2))},init:function(b,
n){b=b?b:0;return{width:b,height:n?n:b}}}}();Hits=function(){return{diffHits:function(b,n){var h=[],e={},g;for(g=n.length;g--;)e[n[g].target.id]=true;for(g=b.length;g--;)e[b[g].target.id]||(h[h.length]=b[g]);return h},init:function(b,n,h,e){return{type:b,x:e.x|0,y:e.y|0,elements:[],absXY:n,relXY:h}},initHit:function(b,n,h){return h=COG.extend({type:b,target:n,drag:false},h)},triggerEvent:function(b,n,h,e){n.triggerCustom(b.type+(h?h:"Hit"),{hitType:b.type},e?e:b.elements,b.absXY,b.relXY,q.init(b.x,
b.y))}}}();var Ja=null,T=[],da=null,Z=0,Na=[],Ua=["view.wake","tile.loaded"],Pa=function(){function b(){var t=N().maxImageLoads;if(!t||z.length<t){var O=r.shift();t=T5.ticks();if(O){z[z.length]=O;O.image.onload=h;O.image.src=O.url;O.requested=t}if(t-ma>s){O=false;for(var $=0,R=N();$<z.length;)if(t-z[$].requested>W.loadTimeout*1E3){z.splice($,1);O=true}else $++;O&&b();if(R&&R.imageCacheMaxSize){Q=B.length*W.avgImageSize/R.imageCacheMaxSize;Q>=1&&n()}ma=t}}}function n(){oa=true;try{var t=B.length>>
1;if(t>0){B.sort(function($,R){return $.created-R.created});for(var O=t;O--;)delete l[B[O].url];B.splice(0,t)}}finally{oa=false}W.trigger("cacheCleared")}function h(){var t=v[this.id],O;if(t&&t.image.complete&&t.image.width>0){t.loaded=true;t.hitCount=1;for(O=z.length;O--;)if(z[O].image.src==this.src){z.splice(O,1);break}if(t.background||t.postProcess||t.drawBackground||t.customDraw)if(t.image){globalImageData=t;O=g(t.realSize?t.realSize.width:t.image.width,t.realSize?t.realSize.height:t.image.height);
var $=O.getContext("2d"),R=t.offset?t.offset:T5.XY.init();t.background&&$.drawImage(t.background,0,0);t.drawBackground&&t.drawBackground($);t.customDraw?t.customDraw($,t):$.drawImage(t.image,R.x,R.y);t.postProcess&&t.postProcess($,t);t.image=O}for(O=t.callbacks.length;O--;)t.callbacks[O]&&t.callbacks[O](this,false);t.callbacks=[];B[B.length]={url:this.src,created:t.requested};delete v[this.id];b()}}function e(t,O,$){var R=l[t];if(R){R.hitCount++;R.image.complete&&R.image.width>0&&O?O(R.image,true):
R.callbacks.push(O)}else{R=COG.extend({url:t,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[O]},$);R.image.id="resourceLoaderImage"+F++;l[t]=R;v[R.image.id]=R;r[r.length]=R;b()}return R}function g(t,O){var $=document.createElement("canvas");COG.info("creating new canvas");$.width=t?t:0;$.height=O?O:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild($);FlashCanvas.initElement($)}return $}var s=1E4,l={},v={},F=0,r=[],z=[],B=[],Q=0,ma=0,oa=false,W={avgImageSize:25,
loadTimeout:10,cancelLoad:function(){var t;for(t=z.length;t--;)delete l[z[t].url];z=[];for(t=r.length;t--;)delete l[r[t].url];r=[]},get:function(t,O,$){var R=null,Aa=null;oa||(R=l[t]);if((Aa=R?R.image:null)&&(Aa.getContext||Aa.complete&&Aa.width>0))return Aa;else O&&e(t,O,$);return null},load:e,newCanvas:g,reset:function(){l={}},stats:function(){return{imageLoadingCount:z.length,queuedImageCount:r.length,imageCacheFullness:Q}}};COG.observable(W);return W}(),ib=function(){var b={};return{init:function(n,
h){var e=b[n];if(!e)throw Error("Unable to locate requested generator: "+n);return new e(h)},register:function(n,h){b[n]=h},Template:function(){}}}(),mb=function(){function b(l,v){g[l]=h(v);return l}function n(l){for(var v in l)b(v,l[v])}function h(l){function v(B){var Q=l[B];typeof Q!=="undefined"&&r.push(function(ma){ma[B]=Q})}function F(){r=[];for(var B in l)v(B)}l=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,
globalAlpha:undefined,globalCompositeOperation:undefined},l);var r=[],z={applyToContext:function(B){for(var Q=r.length;Q--;)r[Q](B)},update:function(B,Q){l[B]=Q;F()}};F();return z}var e={},g={},s={apply:function(l,v){var F=g[v]?g[v]:g.basic,r;if(l&&l.canvas){r=e[l.canvas.id];e[l.canvas.id]=v}F.applyToContext(l);return r},define:b,defineMany:n,get:function(l){return g[l]},init:h,load:function(l){COG.jsonp(l,function(v){n(v)})}};n({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,
strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});return s}(),Hb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Fb=function(b){function n(w,u,G){Xa||Qa(wa-u,d-G)}function h(w,u,G,ja){ia(ba(ta(Ha+za(2,ja)-1,0.5),2))}function e(){var w=Ga(Ha)/Math.LN2|0;if(w!==0){Ha=za(2,w);eb(nb+w,ob,pb)}R()}function g(w){w||(w=q.init(Ba,S));U=q.init(wa,d);Y=q.offset(w,wa,d);ob=Y.x;pb=Y.y}function s(w,u){var G=1/Ha;return q.init(ea.x1+w*
G,ea.y1+u*G)}function l(w,u,G){fb("doubleTap",u,G,s(G.x,G.y));b.scalable&&ia(2,G,b.zoomEasing,null,b.zoomDuration)}function v(w,u,G){Xa=null;$("down",u,G)}function F(w,u,G){$("hover",u,G)}function r(w,u,G){t(u,G,false)}function z(w,u,G){t(u,G,true)}function B(){clearTimeout(Cb);Cb=setTimeout(ma,250)}function Q(w,u,G){$("tap",u,G);fb("tap",u,G,s(G.x,G.y,true))}function ma(w,u){var G;jb=typeof FlashCanvas!=="undefined";COG.info("is flash = "+jb);if(Ea){if(b.autoSize&&Ea.parentNode){w=Ea.parentNode.offsetWidth;
u=Ea.parentNode.offsetHeight}try{if(!Ea.id)Ea.id=b.id+"_canvas";Ka=Ea.getContext("2d")}catch(ja){COG.exception(ja);throw Error("Could not initialise canvas on specified view element");}if(w&&u&&(Ra!==u||Sa!==w)){sb=true;Sa=w;Ra=u;Ba=Sa>>1;S=Ra>>1;Fa.trigger("resize",Sa,Ra);for(G=Oa;G--;)ka[G].trigger("resize",Sa,Ra)}for(G=Oa;G--;)ka[G].trigger("contextChanged",Ka);R();W()}}function oa(w,u){u.setId(w);u.added=ga();u.bind("remove",function(){Fa.removeLayer(w)});u.trigger("contextChanged",Ka);u.setParent(Fa);
ka.push(u);ka.sort(function(G,ja){var ra=ja.zindex-G.zindex;if(ra===0)ra=ja.added-G.added;return ra});Oa=ka.length;return u}function W(){Va&&Va.unbind();Va=INTERACT.watch(Ea);b.pannable&&Va.pannable().bind("pan",n);if(b.scalable){Va.bind("zoom",h);Va.bind("doubleTap",l)}Va.bind("pointerDown",v);Va.bind("pointerMove",r);Va.bind("pointerUp",z);b.captureHover&&Va.bind("pointerHover",F);Va.bind("tap",Q)}function t(w,u,G){if(Xa){w=s(u.x,u.y);Xa.drag.call(Xa.target,Xa,w.x,w.y,G)&&R();if(G)Xa=null}}function O(w){var u,
G,ja=false;if(tb|jb){G=wa!==i||d!==o;bb=Db|(Ha!==1?Eb:0)|(G?ub:0)|(vb?wb:0);na=(u=(bb&(Eb|ub))!==0)&&(bb&wb)===0;if(sb&&Ea){jb&&FlashCanvas.initElement(Ea);Ea.width=Sa;Ea.height=Ra;Ea.style.width=Sa+"px";Ea.style.height=Ra+"px";sb=false}J=Aa();for(G=Oa;G--;){bb|=ka[G].animated?wb:0;ka[G].cycle(w,J,bb);ja=ka[G].clip||ja}G=bb;var ra=J;ja=E&&ja&&!u;var La;qa.center(ra);u=0;var Wa;if(Ha!==1){Wa=1/Ha;ob=Y.x+(wa-U.x);pb=Y.y+(d-U.y);Wa=ra?qa.fromCenter(ob>>0,pb>>0,ra.width*Wa>>0,ra.height*Wa>>0):void 0}else Wa=
qa.copy(ra);ea=Wa;ja||Ka.clearRect(0,0,Sa,Ra);ea.scaleFactor=Ha;Ka.save();try{Ha!==1&&Ka.scale(Ha,Ha);Ya=xa=null;if(ja){Ka.beginPath();for(u=Oa;u--;)ka[u].clip&&ka[u].clip(Ka,ea,G,Fa,w);Ka.closePath();Ka.clip()}Ka.globalCompositeOperation="source-over";for(u=Oa;u--;){La=ka[u];if(La.shouldDraw(bb,J)){var Ma=La.style,$a=Ma?mb.apply(Ka,Ma):null;La.draw(Ka,ea,G,Fa,w,L);$a&&mb.apply(Ka,$a)}}}finally{Ka.restore()}tb=0;fb("drawComplete",ra,w);if(L){La=L?L.elements:[];if(gb&&gb.type==="hover"){Ma=Hits.diffHits(gb.elements,
La);Ma.length>0&&Hits.triggerEvent(gb,Fa,"Out",Ma)}if(La.length>0){$a=L.x;G=L.y;for(Ma=La.length;Ma--;){ra=La[Ma];ja=$a;u=G;if(Wa=ra&&ra.drag&&(!ra.canDrag||ra.canDrag(ra,ja,u))){Xa=ra;Xa.startX=ja;Xa.startY=u}if(Wa)break}Hits.triggerEvent(L,Fa)}gb=La.length>0?COG.extend({},L):null;L=null}w-ab>xb&&db();Ib=w;i=wa;o=d;animFrame(O)}else aa=false}function $(w,u,G){L=Hits.init(w,u,G,s(G.x,G.y,true));for(w=Oa;w--;)cb=cb||(ka[w].hitGuess?ka[w].hitGuess(L.x,L.y,bb,Fa):false);cb&&R()}function R(){tb+=1;if(!aa){aa=
true;animFrame(O)}}function Aa(){return qa.init(wa,d,wa+Sa,d+Ra)}function db(){if(p||a){var w=c?wa+Ba:wa,u=f?d+S:d;if(p&&p>Sa)if(w+Sa>p)wa=c?w-p>0?wa-p:wa:p-Sa;else if(w<0)wa=c?wa+p:0;if(a&&a>Ra)if(u+Ra>a)d=f?u-a>0?d-a:d:a-Ra;else if(u<0)d=f?d+a:0}ab=(new Date).getTime();fb("refresh",Fa,Aa());R()}function ia(w,u,G,ja,ra){if(G)COG.tweenValue(Ha,w,G,ra,function(La,Wa){Ha=La;if(Wa){var Ma=pa(Ga(Ha)/Math.LN2);Ha=za(2,Ma);ja&&ja()}g(u);e()});else{Ha=w;g(u);e()}return Fa}function eb(w,u,G){w=ta(b.minZoom,
ba(b.maxZoom,w));if(w!==nb){var ja=za(2,w-nb),ra=Ba/ja|0,La=S/ja|0;nb=w;Qa(((u?u:wa+Ba)-ra)*ja,((G?G:d+S)-La)*ja);i=wa;o=d;fb("zoomLevelChange",w);Ha=1;db()}}function fb(){for(var w=Fa.trigger.apply(null,arguments).cancel,u=ka.length;u--;)w=ka[u].trigger.apply(null,arguments).cancel||w;return!w}function Qa(w,u,G,ja,ra){function La(){Wa+=1;if(Wa>=2){vb=false;ra&&ra()}}var Wa=0,Ma=xa?q.offset(xa,-Ba,-S):null,$a=Ya?q.offset(Ya,-Ba,-S):null;if(Ma){w=w<Ma.x?Ma.x:w;u=u<Ma.y?Ma.y:u}if($a){w=w>$a.x?$a.x:
w;u=u>$a.y?$a.y:u}if(G){if((bb&ub)===0){COG.tweenValue(wa,w,G,ja,function(yb,zb){wa=yb|0;(zb?La:R)();return!na});COG.tweenValue(d,u,G,ja,function(yb,zb){d=yb|0;(zb?La:R)();return!na});vb=true}}else{wa=w|0;d=u|0;R();ra&&ra()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,
tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var ka=[],Oa=0,Ea=document.getElementById(b.container),Xa=null,Ka=null,Ab=typeof window.attachEvent!="undefined",jb,cb=false,xb=b.minRefresh,wa=0,d=0,i=0,o=0,p=null,a=null,c=false,f=false,E=b.clipping,J=null,aa=false,ea,Da=1,Ba=0,S=0,L=null,U=null,Y=null,na=false,xa=null,Ya=null,ab=0,gb=null,Cb=0,Ha=1,Ib=0,sb=false,Va=null,vb=false,Ra,Sa,tb=0,ob,pb,nb=b.zoomLevel,Db=
y("ACTIVE"),ub=y("PAN"),Eb=y("ZOOM"),wb=y("ANIMATING"),bb=Db,Fa={id:b.id,deviceScaling:Da,fastDraw:b.fastDraw||N().requireFastDraw,detach:function(){Va&&Va.unbind()},eachLayer:function(w){for(var u=Oa;u--;)w(ka[u])},getDimensions:function(){return Ta.init(Sa,Ra)},getLayer:function(w){for(var u=0;u<Oa;u++)if(ka[u].getId()==w)return ka[u];return null},getZoomLevel:function(){return nb},setLayer:function(w,u){for(var G=0;G<Oa;G++)if(ka[G].getId()===w){ka.splice(G,1);break}if(u){oa(w,u);u.trigger("refresh",
Fa,Aa())}R();return u},invalidate:R,refresh:db,resetScale:function(){Ha=1},resize:function(w,u){if(Ea){b.autoSize=false;if(Sa!==w||Ra!==u)ma(w,u)}},scale:ia,setZoomLevel:eb,syncXY:function(){},triggerAll:fb,removeLayer:function(w){a:{for(var u=Oa;u--;)if(ka[u].getId()==w){w=u;break a}w=-1}if(w>=0&&w<Oa){Fa.trigger("layerRemoved",ka[w]);ka.splice(w,1);R()}Oa=ka.length},getOffset:function(){return q.init(wa,d)},setMaxOffset:function(w,u,G,ja){p=w;a=u;c=typeof G!="undefined"?G:false;f=typeof ja!="undefined"?
ja:false},getViewRect:Aa,updateOffset:Qa,pan:function(w,u,G,ja,ra){Qa(wa+w,d+u,G,ja,ra)}};Da=N().getScaling();COG.observable(Fa);Fa.bind("invalidate",function(){R()});Fa.bind("resync",function(){Ya=xa=null});COG.configurable(Fa,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,null,{container:function(w,u){Ea=document.getElementById(u);ma()},inertia:W,captureHover:W,scalable:W,pannable:W}),true);CANI.init(function(w){Fa.markers=
oa("markers",new qb({zindex:20}));canvasCaps=w.canvas;ma();if(b.autoSize)Ab?window.attachEvent("onresize",B):window.addEventListener("resize",B,false)});return Fa},Bb=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:y("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var n=null,h=false,e=false,g=b.id,s=y("ACTIVE"),l=b.validStates,v=0,F=0,r=COG.extend({addToView:function(z){z.setLayer(g,r)},shouldDraw:function(z){return(z&l)!==0},clip:null,
cycle:function(){},draw:function(){},hitGuess:null,remove:function(){r.trigger("remove",r)},changed:function(){e=true;n&&n.invalidate()},hitTest:null,getId:function(){return g},setId:function(z){g=z},getParent:function(){return n},setParent:function(z){h=(n=z)?n.fastDraw&&displayState!==s:false;r.trigger("parentChange",n)}},b);COG.observable(r);r.bind("drawComplete",function(z,B){e=false;v=B.x1;F=B.y1});r.bind("resync",function(z,B){r.minXY&&B.syncXY(r.minXY);r.maxXY&&B.syncXY(r.maxXY)});return r},
hb=function(b){b=COG.extend({style:null,xy:null,size:null,fill:false,draggable:false,observable:true,properties:{},type:"shape",transformable:false},b);COG.extend(this,b);this.id=COG.objId(this.type);this.bounds=null;this.observable&&COG.observable(this);this.transformable&&I(this);this.transformed=false};hb.prototype={constructor:hb,drag:null,draw:function(b){this.fill&&b.fill();b.stroke()},invalidate:function(){var b=this.layer?this.layer.getParent():null;b&&b.invalidate()},prepPath:function(){},
resync:function(b){if(this.xy){b.syncXY([this.xy]);this.size&&this.updateBounds(qa.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},setTransformable:function(b){b&&!this.transformable&&I(this);this.transformable=b},updateBounds:function(b,n){this.bounds=b;if(n)this.xy=qa.center(this.bounds)}};var kb=function(b,n){n=COG.extend({simplify:false},n);var h=false,e=n.simplify;y("ZOOM");var g=[];n.type=n.fill?"polygon":"line";hb.call(this,n);COG.extend(this,{animatePath:function(){},prepPath:function(s,
l,v){if(h){var F=true;s.beginPath();for(var r=g.length;r--;){var z=g[r].x-l,B=g[r].y-v;if(F){s.moveTo(z,B);F=false}else s.lineTo(z,B)}}return h},resync:function(s){var l,v,F,r,z;s.syncXY(b);g=q.floor(e?q.simplify(b):b);for(var B=g.length;B--;){s=g[B].x;l=g[B].y;r=typeof r=="undefined"||s<r?s:r;z=typeof z=="undefined"||l<z?l:z;v=typeof v=="undefined"||s>v?s:v;F=typeof F=="undefined"||l>F?l:F}this.updateBounds(qa.init(r,z,v,F),true)}});h=b&&b.length>=2};kb.prototype=COG.extend(hb.prototype,{constructor:kb});
var Gb=function(b,n){n.fill=false;kb.call(this,b,n)};Gb.prototype=new kb;var lb=function(b){function n(F){if(this.imageUrl=F)l=Pa.get(this.imageUrl,function(r){var z=v.layer?v.layer.getParent():null;l=r;z&&z.invalidate()})}b=COG.extend({image:null,imageUrl:null,imageOffset:null},b);var h=null,e=hb.prototype.updateBounds,g,s,l=b.image;hb.call(this,b);var v=COG.extend(this,{changeImage:n,drag:function(F,r,z,B){h||(h=q.init(F.startX-this.xy.x,F.startY-this.xy.y));this.xy.x=r-h.x;this.xy.y=z-h.y;if(B){h=
null;if(this.layer)(F=this.layer.getParent())&&F.syncXY([this.xy],true);this.trigger("dragDrop")}return true},draw:function(F){F.drawImage(l,g,s)},prepPath:function(F,r,z){var B=l&&l.width>0;if(B){A(this,l);g=this.xy.x+this.imageOffset.x-r;s=this.xy.y+this.imageOffset.y-z;F.beginPath();F.rect(g,s,l.width,l.height)}return B},updateBounds:function(F,r){e.call(this,F,r);A(this,l)}});l||n(this.imageUrl)};lb.prototype=new hb;lb.prototype.constructor=lb;var rb=function(b){b=COG.extend({imageAnchor:null},
b);if(b.imageAnchor)b.imageOffset=q.invert(b.imageAnchor);lb.call(this,b)};rb.prototype=new lb;rb.prototype.constructor=rb;var qb=function(b){function n(l){for(var v=e.length;v--;)e[v].resync(l);e.sort(function(F,r){var z=r.xy.y-F.xy.y;return z!=0?z:r.xy.x-F.xy.y});s.changed()}function h(l,v){n(v)}b=COG.extend({zindex:10},b);var e=[],g=CANI.canvas.pipTransformed,s=COG.extend(new Bb(b),{add:function(l){if(l){l.layer=s;var v=s.getParent();if(v){l.resync(s.getParent());v.invalidate()}e[e.length]=l}},
clear:function(){e=[]},draw:function(l,v,F,r,z,B){r=v.x1;z=v.y1;var Q=B?g?B.x-r:B.relXY.x:0,ma=B?g?B.y-z:B.relXY.y:0,oa=v.width;v=v.height;for(var W=e.length;W--;){var t=e[W],O=t.style,$,R=t.transformed;if(R){t.transform(l,r,z);if(g){Q-=t.xy.x;ma-=t.xy.y}}if(t.prepPath(l,R?t.xy.x:r,R?t.xy.y:z,oa,v,F)){if(B&&l.isPointInPath(Q,ma)){B.elements.push(Hits.initHit(t.type,t,{drag:t.draggable?t.drag:null}));$=B.type+"Style";O=t[$]||s[$]||O}O=O?mb.apply(l,O):null;t.draw(l,r,z,oa,v,F);O&&mb.apply(l,O)}R&&l.restore()}},
find:function(){return[].concat(e)},hitGuess:function(l,v){for(var F=false,r=e.length;!F&&r--;){var z=e[r].bounds;F=F||z&&l>=z.x1&&l<=z.x2&&v>=z.y1&&v<=z.y2}return F}});s.bind("parentChange",h);s.bind("resync",h);return s},Jb=function(){return{tileSize:256,init:function(b,n,h,e,g){return COG.extend({x:b,y:n,width:h,height:e},g)}}}();COG.extend(P,{ex:COG.extend,ticks:ga,getConfig:N,userMessage:function(b,n,h){P.trigger("userMessage",b,n,h)},XY:q,XYRect:qa,Dimensions:Ta,Vector:ya,Hits:Hits,Images:Pa,
Generator:ib,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:mb,viewState:y,View:Fb,ViewLayer:Bb,ImageLayer:function(b,n){function h(r,z,B){for(z=l.length;z--;){var Q=l[z],ma=Q.x,oa=Q.y,W=qa.init(Q.x,Q.y,Q.x+Q.width,Q.y+Q.height);if(B&&qa.intersect(r,W))(W=Pa.get(Q.url,function(){F.changed()},v))&&B(W,ma,oa,Q.width,Q.height)}}function e(r){var z=++s,B=F.getParent();g&&g.run(B,r,function(Q){if(z==s){l=[].concat(Q);B.invalidate()}})}n=COG.extend({imageLoadArgs:{}},
n);var g=b?ib.init(b,n):null,s=0,l=[],v=n.imageLoadArgs,F=COG.extend(new Bb(n),{changeGenerator:function(r,z){g=ib.init(r,COG.extend({},n,z));l=null;e(F.getParent().getViewRect())},clip:function(r,z,B){var Q=z.x1,ma=z.y1;h(z,B,function(oa,W,t,O,$){r.rect(W-Q,t-ma,O,$)})},draw:function(r,z,B){var Q=z.x1,ma=z.y1;h(z,B,function(oa,W,t){r.drawImage(oa,W-Q,t-ma,oa.width,oa.height)})},mask:function(r,z,B){h(z,B,function(Q,ma,oa,W,t){COG.info("clearing rect @ x = "+ma+", y = "+oa+", width = "+W+", height = "+
t);r.clearRect(ma,oa,W,t)})}});F.bind("refresh",function(r,z,B){e(B)});F.bind("tap",function(r,z,B,Q){r=[];var ma=Q.x,oa=Q.y,W,t;if(l)for(var O=l.length;O--;){W=l[O];if(t=ma>=W.x&&ma<=W.x+W.width&&oa>=W.y&&oa<=W.y+W.height)r[r.length]=W}r.length>0&&F.trigger("tapImage",r,z,B,Q)});return F},ImageGenerator:function(b){b=COG.extend({relative:false,padding:2},b);b={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(b);return b},Drawable:hb,Poly:kb,Line:Gb,ImageDrawable:lb,
ImageMarker:rb,ShapeLayer:qb,transformable:I,Tiling:Jb});COG.observable(P);var Za=P.Geo=function(){function b(d){for(var i=null,o=1;!i&&o<arguments.length;o++)i=s(d,arguments[o]);i=i?i:s(d);if(!i)throw Error("Unable to find GEO engine with "+d+" capability");return i}function n(d){d=parseFloat(d)*B;d=ca(d);var i=O*d;return Ga((1+d)/(1-d)*za((1-i)/(1+i),O))/2}function h(d){return parseFloat(d)*B}function e(d){d=za(Math.E,-d);for(var i=ha-2*fa(d),o=l(i,d),p=0;p<R&&la(i-o)>$;){i=o;o=l(i,d);p++}return o*
Q}function g(d){return d%360*Q}function s(d,i){var o=null;for(var p in ka)if(i){if(p==i&&ka[p][d]){o=ka[p];break}}else if(ka[p][d]){o=ka[p];break}return o}function l(d,i){var o=O*ca(d);return ha-2*fa(i*za((1-o)/(1+o),O/2))}function v(d,i,o,p){i=F(i);d.add(p(i,o));return i.length}function F(d){var i=d?d.length:0,o=Array(i);for(i=i;i--;)o[i]=Za.Position.init(d[i][1],d[i][0]);return Za.Position.vectorize(o,jb)}function r(d,i,o){return new wa(d,i,o)}var z=[1.406245461070741,1.321415085624082,1.077179995861952,
0.703119412486786,0.488332580888611],B=Math.PI/180,Q=180/Math.PI,ma=ha,oa=-ma,W=sa,t=-W,O=0.08181919084262157,$=1.0E-7,R=12,Aa=null,db={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ia=function(){function d(a){return a?o(a.lat,a.lon):null}function i(a){return!a||a.lat===0&&a.lon===0}function o(a,c){return{lat:parseFloat(a?a:0),lon:parseFloat(c?c:0)}}function p(a){if(a)if(typeof a.lat!=="undefined")return d(a);else{if(a.split)for(var c=[" ",
","],f=0;f<c.length;f++){var E=a.split(c[f]);if(E.length===2)return o(E[0],E[1])}}else return o();return null}return{calcDistance:function(a,c){if(i(a)||i(c))return 0;var f=(c.lat-a.lat)*B>>1,E=(c.lon-a.lon)*B>>1;f=ca(f)*ca(f)+X(a.lat*B)*X(c.lat*B)*ca(E)*ca(E);return 6371*2*Ca(Ia(f),Ia(1-f))},copy:d,empty:i,equal:function(a,c){return a&&c&&a.lat==c.lat&&a.lon==c.lon},fromMercatorPixels:function(a,c){return o(e(c),g(a))},generalize:function(a,c,f){var E=a.length,J=[],aa=null;f||(f=250);f/=1E3;COG.info("generalizing positions, must include "+
c.length+" positions");for(var ea=E;ea--;)if(ea===0)J.unshift(a[ea]);else{var Da=!aa||ia.inArray(a[ea],c)?f:ia.calcDistance(aa,a[ea]);if(a[ea]&&Da>=f){J.unshift(a[ea]);aa=a[ea]}}COG.info("generalized "+E+" positions into "+J.length+" positions");return J},inArray:function(a,c){for(var f=ia.equal,E=c.length;E--;)if(f(a,c[E]))return true;return false},inBounds:function(a,c){var f=!(ia.empty(a)||ia.empty(c));return f=(f=f&&a.lat>=c.min.lat&&a.lat<=c.max.lat)&&a.lon>=c.min.lon&&a.lon<=c.max.lon},init:o,
offset:function(a,c,f){var E=a.lat*B;a=a.lon*B;c=E+c/6371;f=ua(ca(f/6371)/X(E));f=a+f;c=(c+ha)%Math.PI-ha;f%=sa;return o(c*Q,f*Q)},parse:p,parseArray:function(a){var c=a.length,f=Array(c);for(c=c;c--;)f[c]=p(a[c]);return f},toMercatorPixels:function(a){return T5.XY.init(h(a.lon),n(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,c){function f(){for(var ea=0,Da=c.chunkSize,Ba=E;Ba--;){J[Ba]=T5.GeoXY.init(a[Ba]);ea+=1;if(ea>Da)break}E=Ba;if(E<=0)c.callback&&c.callback(J);
else animFrame(f)}var E=a.length,J=Array(E);c=COG.extend({chunkSize:500,async:true,callback:null},c);if(!c.async){for(var aa=E;aa--;)J[aa]=T5.GeoXY.init(a[aa]);return J}animFrame(f);return null}}}(),eb=function(){function d(a,c,f){var E=T5.XY.init(0,c.lat-a.lat);if(typeof f==="undefined")f=true;E.x=f&&a.lon>c.lon?360-a.lon+c.lon:c.lon-a.lon;return E}function i(a,c){return eb.init(ia.init(a.min.lat-c,a.min.lon-c%360),ia.init(a.max.lat+c,a.max.lon+c%360))}function o(a){var c=d(a.min,a.max);return ia.init(a.min.lat+
(c.y>>1),a.min.lon+(c.x>>1))}function p(a,c){return{min:ia.parse(a),max:ia.parse(c)}}return{calcSize:d,createBoundsFromCenter:function(a,c){var f=c/6371,E=a.lat*B,J=a.lon*B,aa=E-f,ea=E+f;if(aa>oa&&ea<ma){E=ua(ca(f)/X(E));f=(J-E)%sa;J=(J+E)%sa}else{aa=ta(aa,oa);ea=ba(ea,ma);f=t;J=W}return eb.init(ia.init(aa*Q,f*Q),ia.init(ea*Q,J*Q))},expand:i,forPositions:function(a,c){var f=null,E=T5.ticks();c||(c="auto");for(var J=a.length;J--;)if(f){var aa=d(f.min,a[J],false),ea=d(a[J],f.max,false);if(aa.x<0)f.min.lon=
a[J].lon;if(aa.y<0)f.min.lat=a[J].lat;if(ea.x<0)f.max.lon=a[J].lon;if(ea.y<0)f.max.lat=a[J].lat}else f=p(a[J],a[J]);if(c){if(c=="auto"){J=d(f.min,f.max);c=ta(J.x,J.y)*0.3}f=i(f,c)}COG.trace("calculated bounds for "+a.length+" positions",E);return f},getCenter:o,getGeoHash:function(a){var c=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+c+", max hash = "+a)},getZoomLevel:function(a,c){var f=o(a);f=ba(pa(la(f.lat)*0.05),z.length);var E=
z[f],J=d(a.min,a.max);f=va(Ga(z[3]*c.height/J.y)/Ga(2));E=va(Ga(E*c.width/J.x)/Ga(2));return ba(isNaN(f)?1E3:f,isNaN(E)?1E3:E)},init:p,isEmpty:function(a){return!a||ia.empty(a.min)||ia.empty(a.max)},toString:function(a){return"min: "+ia.toString(a.min)+", max: "+ia.toString(a.max)}}}(),fb=function(){var d=/^(\d+).*$/,i=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(o,p){d.lastIndex=-1;if(d.test(o))for(var a=o.replace(d,"$1"),c=p.split(","),f=0;f<c.length;f++){i.lastIndex=-1;if(i.test(c[f])){var E=
i.exec(c[f]);if(a>=parseInt(E[1],10)&&a<=parseInt(E[2],10))return true}else if(a==c[f])return true}return false},normalize:function(o){if(!o)return"";o=o.toUpperCase();if(!Aa){var p=[];for(var a in db)p.push(a);Aa=RegExp("(\\s)("+p.join("|")+")(\\s|$)","i")}Aa.lastIndex=-1;if(p=Aa.exec(o))o=o.replace(Aa,"$1"+db[p[2]]);return o},toString:function(o){return o.streetDetails+" "+o.location}}}(),Qa=P.GeoXY=function(){function d(p,a){if(p.length){for(var c,f,E,J,aa=p.length;aa--;){d(p[aa],a);c=typeof c===
"undefined"||p.x<c?p.x:c;f=typeof f==="undefined"||p.y<f?p.y:f;E=typeof E==="undefined"||p.x>E?p.x:E;J=typeof J==="undefined"||p.y>J?p.y:J}return qa.init(c,f,J,J)}else if(p.mercXY){c=p.mercXY;p.x=(c.x+Math.PI)/a|0;p.y=(Math.PI-c.y)/a|0;p.rpp=a}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return p}function i(p,a){if(p.length)for(var c=p.length;c--;)i(p[c],a);else{p.mercXY=q.init(p.x*a-Math.PI,Math.PI-p.y*a);p.pos=ia.fromMercatorPixels(p.mercXY.x,p.mercXY.y)}return p}function o(p,
a,c){p.pos=a;p.mercXY=ia.toMercatorPixels(a);(c=typeof c!=="undefined"?c:p.rpp)&&d(p,c)}return{init:function(p,a){var c=q.init();o(c,p,a);return c},sync:d,syncPos:i,toPos:function(p,a){a=a?a:_self.rpp;return ia.fromMercatorPixels(p.x*a-Math.PI,Math.PI-p.y*a)},updatePos:o}}(),ka={},Oa=function(){return{bestResults:function(d,i){i||(i=20);for(var o=d.length>0?d[0]:null,p=[],a=0;a<d.length;a++)if(o&&d[a]&&o.matchWeight-d[a].matchWeight<=i)p.push(d[a]);else break;return p}}}(),Ea=function(d){d=COG.extend({id:null,
caption:"",resultType:"",data:null,pos:null,matchWeight:0},d);return COG.extend(d,{toString:function(){return d.caption+(d.matchWeight?" ("+d.matchWeight+")":"")}})},Xa=function(){function d(a,c){var f=new T5.ShapeLayer;c.geometry&&ia.vectorize(c.geometry,{callback:function(E){f.add(new T5.Line(E,{style:"waypoints",simplify:true}));a.setLayer("route",f)}})}function i(a){for(var c=o.Unknown,f=p,E=0;E<f.length;E++){f[E].regex.lastIndex=-1;var J=f[E].regex.exec(a);if(J){c=f[E].customCheck?f[E].customCheck(a,
J):f[E].turnType;break}}return c}var o={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},p=function(){var a=[];a.push({regex:/continue/i,turnType:o.Continue});
a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(c,f){return/bear/i.test(f[1])?o.TurnLeftSlight:o.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(c,f){return/bear/i.test(f[1])?o.TurnRightSlight:o.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:o.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:o.Ramp});a.push({regex:/take.*?exit/i,turnType:o.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(c,f){return/right/i.test(f[1])?
o.UTurnRight:o.UTurnLeft}});a.push({regex:/proceed/i,turnType:o.Start});a.push({regex:/arrive/i,turnType:o.Arrive});a.push({regex:/fell\sthrough/i,turnType:o.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var c=b("route");c&&c.route(a,function(f){if(a.generalize)f.geometry=ia.generalize(f.geometry,f.getInstructionPositions());if(a.map){d(a.map,f);a.autoFit&&a.map.gotoBounds(f.boundingBox)}a.success&&
a.success(f)})},createMapOverlay:d,parseTurnType:i,TurnType:o,Instruction:function(a){var c=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),f=a.description;f=f.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");c.description=f;if(!a.turnType)a.turnType=i(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=eb.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var c=
[],f=0;f<a.instructions.length;f++)a.instructions[f].position&&c.push(a.instructions[f].position);return c}},a)}}}(),Ka="featurecollection",Ab="feature",jb={async:false},cb={processor:null,group:"shapes",layerClass:qb},xb={point:COG.extend({},cb,{processor:function(d,i,o,p){i=F([i.coordinates],jb);if(i.length>0)if(o=p.marker(i[0],o)){d.add(o);return i.length}},group:"markers",layerClass:qb}),linestring:COG.extend({},cb,{processor:function(d,i,o,p){i=F(i&&i.coordinates?i.coordinates:[]);return v(d,
i,o,p.line)}}),multilinestring:COG.extend({},cb,{processor:function(d,i,o,p){i=i&&i.coordinates?i.coordinates:[];for(var a=0,c=i.length;c--;)a+=v(d,i[c],o,p.line);return a}}),polygon:COG.extend({},cb,{processor:function(d,i,o,p){i=i&&i.coordinates?i.coordinates:[];if(i.length>0)return v(d,i[0],o,p.poly);return 0}}),multipolygon:COG.extend({},cb,{processor:function(d,i,o,p){i=i&&i.coordinates?i.coordinates:[];for(var a=0,c=0;c<i.length;c++)a+=v(d,i[c][0],o,p.poly);return a}})},wa=function(d,i,o,p){function a(U,
Y){var na=U.processor,xa=aa+U.group,Ya=COG.extend({},U,o,{properties:Y.properties});if(na){var ab=L[xa];if(!ab){ab=new U.layerClass({id:xa});L[xa]=ab}globalLayers=L;return na(ab,Y.data,Ya,p)}return 0}function c(U,Y){var na=U&&U.type?U.type.toLowerCase():null;return na&&na===Ab?c(U.geometry,U.properties):{type:na,isCollection:na?na===Ka:false,definition:xb[na],data:U,properties:Y?Y:U.properties}}function f(){var U=0,Y=COG.extend({},o),na=ea;if(!Ba){for(;na<Da;na++){var xa=c(J?J(d[na]):d[na]),Ya=null;
if(xa.isCollection){Y.layerPrefix=aa+S++ +"-";Ba=r(xa.data.features,function(ab){Ba=null;for(var gb in ab)L[gb]=ab[gb]},Y);Ya+=1}else if(xa.definition)Ya=a(xa.definition,xa);U+=Ya?Ya:1;if(U>=E)break}ea=na+1;if(Ba||ea<Da)animFrame(f);else i&&i(L)}}o=COG.extend({vectorsPerCycle:Za.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},o);p=COG.extend({marker:function(U){return new Marker({xy:U})},line:function(U,Y){return new kb(U,COG.extend({},o,Y))},poly:function(U,Y){return new kb(U,
COG.extend({fill:true},o,Y))}},p);var E=o.vectorsPerCycle,J=o.rowPreParse,aa=o.layerPrefix,ea=0,Da=0,Ba=null,S=0,L={};if(d){if(typeof d.length==="undefined")d=[d];Da=d.length;animFrame(f)}};P.GeoJSON={parse:r};P.Map=function(d){function i(L){try{var U=Za.Position.init(L.coords.latitude,L.coords.longitude),Y=L.coords.accuracy/1E3;S.trigger("locationUpdate",L,Y);if(ea){if(!J){J=new Za.UI.LocationOverlay({pos:U,accuracy:Y});J.update(S.getTileLayer());S.setLayer("location",J)}var na=Za.BoundingBox.createBoundsFromCenter(U,
Math.max(Y,1));S.gotoBounds(na)}else{J.pos=U;J.accuracy=Y;J.update(S.getTileLayer());a(U,null,COG.easing("sine.out"))}ea=false}catch(xa){COG.exception(xa)}}function o(L){COG.info("caught location tracking error:",L)}function p(L,U,Y){S.setZoomLevel(U);a(L,Y)}function a(L,U,Y,na){L=Qa.init(L,Za.radsPerPixel(S.getZoomLevel()));var xa=S.getDimensions();S.updateOffset(L.x-(xa.width>>1),L.y-(xa.height>>1),Y,na,function(){S.refresh();S.trigger("boundsChange",S.getBoundingBox());U&&U(S)})}d=COG.extend({tapExtent:10,
crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18,pannable:true,scalable:true},d);var c={NONE:0,SINGLE:1,WATCH:2},f=q.init(),E=c.NONE,J=null,aa=0,ea=true,Da=0,Ba=d.tapExtent;d.adjustScaleFactor=function(L){return Math.pow(2,(L<1?Math.floor:Math.ceil)(Math.log(L)))};var S=COG.extend(new Fb(d),{getBoundingBox:function(){var L=S.getViewRect();return Za.BoundingBox.init(Qa.toPos(q.init(L.x1,L.y2),Da),Qa.toPos(q.init(L.x2,L.y1),Da))},getCenterPosition:function(){var L=S.getViewRect();
if(L){L=q.init(L.x1+(L.width>>1),L.y1+(L.height>>1));return Qa.toPos(L,Da)}return null},gotoBounds:function(L,U){var Y=Za.BoundingBox.getZoomLevel(L,S.getDimensions());p(Za.BoundingBox.getCenter(L),Y,U)},gotoPosition:p,panToPosition:a,syncXY:function(L,U){return(U?Qa.syncPos:Qa.sync)(L,Da)},locate:function(){S.trackStart(c.SINGLE);setTimeout(S.trackCancel,1E4)},trackStart:function(L){if(navigator.geolocation&&!aa){E=L?L:c.WATCH;ea=true;aa=navigator.geolocation.watchPosition(i,o,{enableHighAccuracy:true,
timeout:1E4,maximumAge:5E3})}},trackCancel:function(){aa&&navigator.geolocation&&navigator.geolocation.clearWatch(aa);S.removeLayer("location");J=null;E=c.NONE;aa=0},animateRoute:function(L,U,Y,na){var xa=S.getLayer("route");if(xa)(L=xa.getAnimation(L,U,Y,na))&&L.addToView(S)}});S.bind("pan",function(){E===c.SINGLE&&S.trackCancel()});S.bind("tap",function(L,U,Y,na){L=Qa.toPos(na,Da);var xa=Qa.toPos(q.offset(na,-Ba,Ba),Da);na=Qa.toPos(q.offset(na,Ba,-Ba),Da);S.trigger("geotap",U,Y,L,eb.init(xa,na))});
S.bind("refresh",function(){if(q.absSize(q.diff(f,S.getOffset()))>d.boundsChangeThreshold){f=q.copy(S.getOffset());S.trigger("boundsChange",S.getBoundingBox())}});S.bind("zoomLevelChange",function(L,U){var Y;Da=Za.radsPerPixel(U);Y=sa/Da|0;S.setMaxOffset(Y,Y,true,false);Pa.cancelLoad();S.resetScale();S.triggerAll("resync",S);S.refresh()});return S};P.GeoShape=function(d,i){i=COG.extend({autoParse:true},i);for(var o=Array(d.length),p=i.autoParse,a=T5.Geo.Position.parse,c=d.length;c--;)o[c]=T5.GeoXY.init(p?
a(d[c]):d[c]);return new T5.Poly(o,i)};P.LocationOverlay=function(d){d=COG.extend({pos:null,accuracy:null,zindex:90},d);var i=new Image,o=T5.XY.init(),p=T5.XY.init(),a=null;i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
i.onload=function(){o=T5.XY.init(i.width>>1,i.height>>1)};var c=COG.extend(new T5.ViewLayer(d),{pos:d.pos,accuracy:d.accuracy,drawAccuracyIndicator:false,draw:function(f,E){var J=p.x-E.x,aa=p.y-E.y;if(a){f.fillStyle="rgba(30, 30, 30, 0.2)";f.beginPath();f.arc(J,aa,a,0,Math.PI*2,false);f.fill()}i.complete&&i.width>0&&f.drawImage(i,J-o.x,aa-o.y,i.width,i.height);c.changed()},update:function(f){if(f){a=f.getPixelDistance(c.accuracy)>>1;p=f.getGridXYForPosition(c.pos);c.changed()}}});c.bind("gridUpdate",
function(f,E){c.update(E)});return c};return{distanceToString:function(d){if(d>1E3)return~~(d/10)/100+" km";return d?d+" m":""},dist2rad:function(d){return d/6371},getEngine:b,lat2pix:n,lon2pix:h,pix2lat:e,pix2lon:g,radsPerPixel:function(d){return sa/(256<<d)},Position:ia,BoundingBox:eb,Radius:function(d,i){return{distance:parseInt(d,10),uom:i}},Address:function(d){return d=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},d)},A:fb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(d){if(!d.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var i=COG.extend({remove:function(){delete ka[i.id]}},d);return ka[i.id]=i},Search:Oa,GeoSearchResult:Ea,LocationSearch:function(d){function i(f,E){navigator.geolocation.clearWatch(p);p=0;if(a){clearTimeout(a);a=0}E&&E([f],d)}function o(f){COG.info("caught location tracking error:",f)}d=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},d);var p=0,a=0,c=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(f,E){if(navigator.geolocation&&!p){p=navigator.geolocation.watchPosition(function(J){var aa=ia.init(J.coords.latitude,J.coords.longitude);J=new Ea({id:1,caption:"Current Location",pos:aa,accuracy:J.coords.accuracy/1E3,matchWeight:100});if(!c||J.accuracy<c.accuracy)c=J;if(!d.requiredAccuracy||c.accuracy<d.requiredAccuracy)i(c,E)},o,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(d.searchTimeout)a=
setTimeout(function(){c&&i(c,E)},d.searchTimeout)}}},d))},Routing:Xa}}()})(T5);
