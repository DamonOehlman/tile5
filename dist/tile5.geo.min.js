COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var ba=arguments[0]||{},ya,M=1,B=arguments.length;M<B;M++)if((ya=arguments[M])!==null)for(var l in ya){var q=ya[l];if(ba!==q)if(q!==undefined)ba[l]=q}return ba};
(function(){var ba=Object.prototype.hasOwnProperty,ya=0,M={};M.toID=function(B){return B.replace(/\s/g,"-")};M.objId=function(B){return(B?B:"obj")+ya++};M.isFunction=function(B){return toString.call(B)==="[object Function]"};M.isArray=function(B){return toString.call(B)==="[object Array]"};M.isPlainObject=function(B){if(!B||toString.call(B)!=="[object Object]"||B.nodeType||B.setInterval)return false;if(B.constructor&&!ba.call(B,"constructor")&&!ba.call(B.constructor.prototype,"isPrototypeOf"))return false;
var l;for(l in B);return l===undefined||ba.call(B,l)};M.isEmptyObject=function(B){for(var l in B)return false;return true};M.isXmlDocument=function(B){return toString.call(B)==="[object Document]"};M.contains=function(B,l){var q=B,C=arguments,H=1;if(l&&module.isArray(l)){C=l;H=0}for(H=H;H<C;H++)q=q&&typeof foo[C[H]]!=="undefined";return q};M.formatStr=function(B){if(arguments.length<=1)return B;for(var l=arguments.length-2,q=0;q<=l;q++)B=B.replace(RegExp("\\{"+q+"\\}","gi"),arguments[q+1]);return B};
M.wordExists=function(B,l){var q="";if(l.toString)l=l.toString();for(var C=0;C<l.length;C++)q+=!/\w/.test(l[C])?"\\"+l[C]:l[C];return RegExp("(^|\\s|\\,)"+q+"(\\,|\\s|$)","i").test(B)};COG.extend(COG,M)})();
(function(){function ba(q){return typeof console!=="undefined"?function(){console[q](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ya=window.console&&window.console.markTimeline,M=ba("error"),B=ba("info"),l=function(){return ya?function(q,C){console.markTimeline(q+(C?": "+((new Date).getTime()-C)+"ms":""))}:function(){}}();COG.extend(COG,{trace:l,debug:ba("debug"),info:B,warn:ba("warn"),error:M,exception:function(q){if(M)for(var C in q)B("ERROR DETAIL: "+
C+": "+q[C])}})})();
(function(){function ba(M,B){var l=M.obsHandlers;l[B]||(l[B]=[]);return l[B]}var ya=0;COG.observable=function(M){if(!M)return null;if(!M.obsHandlers)M.obsHandlers={};if(!(M.bind||M.trigger||M.unbind)){M.bind=function(B,l){var q="callback"+ya++;ba(M,B).unshift({fn:l,id:q});return q};M.triggerCustom=function(B,l){var q=ba(M,B),C={cancel:false,name:B,source:M},H;l&&COG.extend(C,l);if(!q)return null;H=Array.prototype.slice.call(arguments,2);M.eventInterceptor&&M.eventInterceptor(B,C,H);H.unshift(C);for(var k=
q.length;k--&&!C.cancel;)q[k].fn.apply(this,H);return C};M.trigger=function(B){var l=Array.prototype.slice.call(arguments,1);l.splice(0,0,B,null);return M.triggerCustom.apply(this,l)};M.unbind=function(B,l){if(typeof B==="undefined")M.obsHandlers={};else for(var q=ba(M,B),C=0;q&&C<q.length;C++)if(q[C].id===l){q.splice(C,1);break}return M}}return M}})();
(function(){function ba(l,q){l[q]||(l[q]=function(C){return l.configure(q,C)})}function ya(l){l.gtConfId="configurable"+B++;l.gtConfig={};l.gtConfigFns=[];return l.gtConfig}var M={},B=0;COG.paramTweaker=function(l,q,C){return function(H,k){if(typeof k!=="undefined"){if(H in l)l[H]=k;C&&H in C&&C[H](H,k)}else return q&&H in q?q[H](H):l[H]}};COG.configurable=function(l,q,C,H){if(l){l.gtConfId||ya(l);var k=l.gtConfId,F=l.gtConfig,A=l.gtConfigFns;M[k]=l;A.push(C);for(C=q.length;C--;){F[q[C]]=true;H&&
ba(l,q[C])}if(!l.configure)l.configure=function(K,ca){if(F[K]){for(var u=A.length;u--;){var w=A[u](K,ca);if(typeof w!=="undefined")return w}return M[k]}return null}}}})();
(function(){function ba(l){var q=document.createElement("script"),C=false;q.src=l;q.async=true;q.onload=q.onreadystatechange=function(){if(!C&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){C=true;q.onload=q.onreadystatechange=null;q&&q.parentNode&&q.parentNode.removeChild(q)}};M||(M=document.getElementsByTagName("head")[0]);M.appendChild(q)}var ya=0,M,B=this;COG.jsonp=function(l,q,C){l+=l.indexOf("?")>=0?"&":"?";var H="json"+ ++ya;B[H]=function(k){q(k);B[H]=null;try{delete B[H]}catch(F){}};
ba(l+(C?C:"callback")+"="+H);return H}})();
(function(){var ba=1.70158,ya=Math.PI/2,M=Math.abs,B=Math.pow,l=Math.sin,q=Math.asin,C=Math.cos,H={linear:function(k,F,A,K){return A*k/K+F},backin:function(k,F,A,K){return A*(k/=K)*k*((ba+1)*k-ba)+F},backout:function(k,F,A,K){return A*((k=k/K-1)*k*((ba+1)*k+ba)+1)+F},backinout:function(k,F,A,K){return(k/=K/2)<1?A/2*k*k*(((ba*=1.525)+1)*k-ba)+F:A/2*((k-=2)*k*(((ba*=1.525)+1)*k+ba)+2)+F},bouncein:function(k,F,A,K){return A-H.bounceout(K-k,0,A,K)+F},bounceout:function(k,F,A,K){return(k/=K)<1/2.75?A*
7.5625*k*k+F:k<2/2.75?A*(7.5625*(k-=1.5/2.75)*k+0.75)+F:k<2.5/2.75?A*(7.5625*(k-=2.25/2.75)*k+0.9375)+F:A*(7.5625*(k-=2.625/2.75)*k+0.984375)+F},bounceinout:function(k,F,A,K){return k<K/2?H.bouncein(k*2,0,A,K)/2+F:H.bounceout(k*2-K,0,A,K)/2+A/2+F},cubicin:function(k,F,A,K){return A*(k/=K)*k*k+F},cubicout:function(k,F,A,K){return A*((k=k/K-1)*k*k+1)+F},cubicinout:function(k,F,A,K){if((k/=K/2)<1)return A/2*k*k*k+F;return A/2*((k-=2)*k*k+2)+F},elasticin:function(k,F,A,K,ca,u){if(k==0)return F;if((k/=
K)==1)return F+A;u||(u=K*0.3);if(!ca||ca<M(A)){ca=A;A=u/4}else A=u/TWO_PI*q(A/ca);return-(ca*B(2,10*(k-=1))*l((k*K-A)*TWO_PI/u))+F},elasticout:function(k,F,A,K,ca,u){var w;if(k==0)return F;if((k/=K)==1)return F+A;u||(u=K*0.3);if(!ca||ca<M(A)){ca=A;w=u/4}else w=u/TWO_PI*q(A/ca);return ca*B(2,-10*k)*l((k*K-w)*TWO_PI/u)+A+F},elasticinout:function(k,F,A,K,ca,u){var w;if(k==0)return F;if((k/=K/2)==2)return F+A;u||(u=K*0.3*1.5);if(!ca||ca<M(A)){ca=A;w=u/4}else w=u/TWO_PI*q(A/ca);if(k<1)return-0.5*ca*B(2,
10*(k-=1))*l((k*K-w)*TWO_PI/u)+F;return ca*B(2,-10*(k-=1))*l((k*K-w)*TWO_PI/u)*0.5+A+F},quadin:function(k,F,A,K){return A*(k/=K)*k+F},quadout:function(k,F,A,K){return-A*(k/=K)*(k-2)+F},quadinout:function(k,F,A,K){if((k/=K/2)<1)return A/2*k*k+F;return-A/2*(--k*(k-2)-1)+F},sinein:function(k,F,A,K){return-A*C(k/K*ya)+A+F},sineout:function(k,F,A,K){return A*l(k/K*ya)+F},sineinout:function(k,F,A,K){return-A/2*(C(Math.PI*k/K)-1)+F}};COG.tweenValue=function(k,F,A,K,ca){function u(pa){var X=pa-w,ra=A(X,k,
L,K),na=w+K<=pa;pa=!na;if(ca){X=ca(ra,na,X);pa=typeof X!="undefined"?X&&pa:pa}pa&&animFrame(u)}var w=(new Date).getTime(),L=F-k;animFrame(u);return{}};COG.easing=function(k){return H[k.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(k,F){H[k.replace(/[\-\_\s\.]/g,"").toLowerCase()]=F}})();
(function(){var ba=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ya=/^(\d+H)?(\d+M)?(\d+S)?$/,M={8601:function(l){l=l.split("T");var q=null;q=null;var C=0,H=0;ba.lastIndex=-1;q=ba.exec(l[0]);C+=q[3]?parseInt(q[3].slice(0,-1),10):0;ya.lastIndex=-1;q=ya.exec(l[1]);H+=q[1]?parseInt(q[1].slice(0,-1),10)*3600:0;H+=q[2]?parseInt(q[2].slice(0,-1),10)*60:0;H+=q[3]?parseInt(q[3].slice(0,-1),10):0;return new B(C,H)}},B=COG.Duration=function(l,q){return{days:l?l:0,seconds:q?q:0}};COG.addDuration=function(){for(var l=new B,q=arguments.length;q--;){l.days+=
arguments[q].days;l.seconds+=arguments[q].seconds}if(l.seconds>=86400){l.days+=~~(l.seconds/86400);l.seconds%=86400}return l};COG.formatDuration=function(l){var q,C,H="";if(l.days)H=l.days+" days ";if(l.seconds){l=l.seconds;if(l>=3600){q=~~(l/3600);l-=q*3600}if(l>=60){C=Math.round(l/60);l-=C*60}if(q)H=H+q+(q>1?" hrs ":" hr ")+(C?(C>10?C:"0"+C)+" min ":"");else if(C)H=H+C+" min";else if(l>0)H=H+(l>10?l:"0"+l)+" sec"}return H};COG.parseDuration=function(l,q){var C=q?M[q]:null;if(C)return C(l);COG.Log.warn("Could not find duration parser for specified format: "+
q);return new B}})();
INTERACT=function(){function ba(u){return function(w,L,pa){(pa?pa:u?document.body:document).addEventListener(w,L,false)}}function ya(u){return function(w,L,pa){(pa?pa:u?document.body:document).removeEventListener(w,L,false)}}function M(u,w,L){(L?L:document).attachEvent("on"+u,w)}function B(u,w,L){(L?L:document).detachEvent("on"+u,w)}function l(u,w){return{x:u?u:0,y:w?w:0,count:1}}function q(u,w){K.push(COG.extend({handler:null,checks:{},type:u},w))}function C(u){var w=0,L=0;if(u.offsetParent){do{w+=u.offsetLeft;
L+=u.offsetTop;u=u.offsetParent}while(u)}return{x:w,y:L}}function H(u,w){return{source:u,target:w.target?w.target:w.srcElement}}function k(u,w){for(var L=u.target?u.target:u.srcElement;L&&L!==w&&L.nodeName&&L.nodeName.toUpperCase()!="CANVAS";)L=L.parentNode;return L&&L===w}function F(u,w){return{x:u.x-(w?w.x:0),y:u.y-(w?w.y:0)}}function A(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}var K=[],ca=function(u,w,L){function pa(ea,sa,xa,D){var da=
0,fa=0,x=0;COG.tweenValue(0,ea,xa,D,function(ga){x=da;da=ga});COG.tweenValue(0,sa,xa,D,function(ga){X.trigger("pan",da-x,ga-fa);fa=ga})}L=COG.extend({binder:null,unbinder:null,observable:null},L);for(var X=L.observable,ra=null,na=[],oa=[],Ba,Ka,Ca={bind:function(){return X.bind.apply(null,arguments)},pannable:function(ea){ra=COG.extend({inertia:true},ea);return Ca},unbind:function(){X.unbind();for(var ea=0;ea<na.length;ea++)na[ea].unbind();return Ca}},Qa=0;Qa<w.length;Qa++)na.push(w[Qa](u,X,L));X.bind("pointerDown",
function(){oa=[];Ka=Ba=0});X.bind("pointerMove",function(ea,sa,xa,D){if(ra){oa[oa.length]={ticks:(new Date).getTime(),x:D.x,y:D.y};X.trigger("pan",D.x,D.y)}Ba+=D.x?D.x:0;Ka+=D.y?D.y:0});X.bind("pointerUp",function(ea,sa,xa){if(Math.abs(Ba)>20||Math.abs(Ka)>20){if(ra){xa=oa.length;var D,da;sa=0;for(da=oa.length;--da>1&&sa<50;)sa+=oa[da].ticks-oa[da-1].ticks;if(xa-da>1){ea=oa[xa-1].x-oa[da].x;D=oa[xa-1].y-oa[da].y;da=Math.sqrt(ea*ea+D*D)|0;if(da>15){ea=oa[xa-1].x-oa[0].x;D=oa[xa-1].y-oa[0].y;da=Math.sqrt(ea*
ea+D*D)|0;xa=Math.asin(D/da);sa=da*500/sa|0;sa=sa>300?300:sa;pa(Math.cos(ea>0?xa:Math.PI-xa)*sa,Math.sin(xa)*sa,COG.easing("sine.out"),500)}}}}else X.trigger("tap",sa,xa)});return Ca};q("pointer",{handler:function(u,w,L){function pa(x){if(k(x,u))if(Qa=oa(x)){u.style.cursor="move";A(x);da=x.pageX?x.pageX:x.screenX;fa=x.pageY?x.pageY:x.screenY;ea=l(da,fa);sa=C(u);w.triggerCustom("pointerDown",H("mouse",x),ea,F(ea,sa))}}function X(x){xa=x.pageX?x.pageX:x.screenX;D=x.pageY?x.pageY:x.screenY;if(k(x,u))Ba(x,
Qa?"pointerMove":"pointerHover")}function ra(x){if(Qa&&oa(x)){Qa=false;if(k(x,u)){u.style.cursor="default";Ba(x,"pointerUp")}}}function na(x){if(k(x,u)){var ga;x=x||window.event;if(x.detail)ga=x.axis===2?-x.detail*Ka:0;else{ga=x.wheelDeltaY?x.wheelDeltaY:x.wheelDelta;if(window.opera)ga=-ga}if(ga!==0){var Ga=l(xa,D);w.triggerCustom("zoom",H("mouse",x),Ga,F(Ga,C(u)),ga/Ca,"wheel");A(x);x.returnValue=false}}}function oa(x){x=x||window.event;return(x.which||x.button)==1}function Ba(x,ga,Ga,Ia,$a){Ga=
typeof Ga!="undefined"?Ga:xa;Ia=typeof Ia!="undefined"?Ia:D;var T=Ga-da,ja=Ia-fa,Y=l(Ga,Ia);sa||(sa=C(u));w.triggerCustom(ga,H("mouse",x),Y,F(Y,sa),l(T,ja));if(typeof $a=="undefined"||$a){da=Ga;fa=Ia}}L=COG.extend({},L);var Ka=120,Ca=Ka*8,Qa=false,ea,sa,xa,D,da,fa;L.binder("mousedown",pa,false);L.binder("mousemove",X,false);L.binder("mouseup",ra,false);L.binder("dblclick",function(x){COG.info("captured double click");if(k(x,u)){var ga=l(x.pageX?x.pageX:x.screenX,x.pageY?x.pageY:x.screenY);COG.info("captured double click + target matched");
w.triggerCustom("doubleTap",H("mouse",x),ga,F(ga,C(u)))}},false);L.binder("mousewheel",na,document);L.binder("DOMMouseScroll",na,document);return{unbind:function(){L.unbinder("mousedown",pa,false);L.unbinder("mousemove",X,false);L.unbinder("mouseup",ra,false);L.unbinder("mousewheel",na,document);L.unbinder("DOMMouseScroll",na,document)}}},checks:{touch:false}});q("pointer",{handler:function(u,w,L){function pa(T){if(T.count<2)return 0;var ja=T.x-T.next.x;T=T.y-T.next.y;return~~Math.sqrt(ja*ja+T*T)}
function X(T,ja,Y){ja=ja?ja:0;Y=Y?Y:0;for(var Oa={x:T.x-ja,y:T.y-Y,id:T.id,count:T.count},La=Oa;T.next;){T=T.next;La=La.next={x:T.x-ja,y:T.y-Y,id:T.id}}return Oa}function ra(T,ja){var Y=T[ja?ja:"touches"],Oa,La;if(Y.length===0)return null;La=Oa={x:Y[0].pageX,y:Y[0].pageY,id:Y[0].identifier,count:Y.length};for(var Xa=1,ib=Y.length;Xa<ib;Xa++)La=La.next={x:Y[Xa].pageX,y:Y[Xa].pageY,id:Y[Xa].identifier};return Oa}function na(T){if(k(T,u)){D=C(u);var ja=ra(T,"changedTouches"),Y=X(ja,D.x,D.y);if(!fa){da=
ea;w.triggerCustom("pointerDown",H("touch",T),ja,Y)}Ia&&w.triggerCustom("pointerDownMulti",H("touch",T),ja,Y);fa=ra(T);if(fa.count>1)ga=pa(fa);$a=1;Ga=X(fa)}}function oa(T){if(k(T,u)){T.preventDefault();x=ra(T);if(da==ea)da=Math.abs(fa.x-x.x)>Ca||Math.abs(fa.y-x.y)>Ca?Qa:ea;if(da!=ea){da=x.count>1?xa:sa;if(da==xa)if(fa.count===1){fa=X(x);ga=pa(fa)}else{var ja=pa(x);if(Math.abs(ga-ja)<Ka)da=sa;else{var Y;Y=x.x;var Oa=x.next.x,La=x.y,Xa=x.next.y,ib=La<Xa?La:Xa;Y={x:(Y<Oa?Y:Oa)+(Math.abs(Y-Oa)>>1),y:ib+
(Math.abs(La-Xa)>>1)};ja=ja/ga;Oa=ja-$a;w.triggerCustom("zoom",H("touch",T),Y,F(Y,D),Oa,"pinch");$a=ja}}da==sa&&w.triggerCustom("pointerMove",H("touch",T),x,X(x,D.x,D.y),l(x.x-Ga.x,x.y-Ga.y));Ia&&w.triggerCustom("pointerMoveMulti",H("touch",T),x,X(x,D.x,D.y))}Ga=X(x)}}function Ba(T){if(k(T,u)){var ja=ra(T,"changedTouches"),Y=X(ja,D.x,D.y);x=ra(T);if(!x){da===ea&&w.triggerCustom("tap",H("touch",T),ja,Y);w.triggerCustom("pointerUp",H("touch",T),ja,Y);fa=null}Ia&&w.triggerCustom("pointerUpMulti",H("touch",
T),ja,Y)}}L=COG.extend({detailed:false,inertia:false},L);var Ka=20,Ca=7,Qa=0,ea=1,sa=2,xa=3,D,da,fa,x,ga,Ga,Ia=L.detailed,$a=1;L.binder("touchstart",na,false);L.binder("touchmove",oa,false);L.binder("touchend",Ba,false);COG.info("initialized touch handler");return{unbind:function(){L.unbinder("touchstart",na,false);L.unbinder("touchmove",oa,false);L.unbinder("touchend",Ba,false)}}},checks:{touch:true}});return{register:q,watch:function(u,w,L){w=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},w);capabilities=COG.extend({touch:"ontouchstart"in window},L);if(!w.observable){COG.info("creating observable");w.observable=COG.observable({});globalOpts=w}w.binder=w.isIE?M:ba(w.bindToBody);w.unbinder=w.isIE?B:ya(w.bindToBody);L=w.types;for(var pa=capabilities,X=[],ra=K.length;ra--;){var na=K[ra],oa=!L||L.indexOf(na.type)>=0,Ba=true;for(var Ka in na.checks){var Ca=na.checks[Ka];COG.info("checking "+Ka+" capability. require: "+Ca+", capability = "+pa[Ka]);Ba=Ba&&Ca===pa[Ka]}if(oa&&
Ba)X[X.length]=na.handler}return new ca(u,X,w)}}}();
T5=function(){function ba(){return(new Date).getTime()}function ya(){for(;T.length>0;){var d=T.shift();document.location=d}$a=0}function M(d){for(var m=true,g=ja.length;g--;)m=m&&d!=ja[g];return m}function B(d,m){var g=[];for(var b in m)b&&g.push(b+"="+escape(m[b]));return"tile5://"+d+"/"+(g.length>0?"?"+g.join("&"):"")}function l(d,m){M(d)&&COG.info("would push url: "+B(d,m))}function q(d,m){if(M(d)){T.push(B(d,m));$a||($a=setTimeout(ya,100))}}function C(d){return function(m,g,b){(b?b:d?document.body:
document).addEventListener(m,g,false)}}function H(d){return function(m,g,b){(b?b:d?document.body:document).removeEventListener(m,g,false)}}function k(d,m,g){(g?g:document).attachEvent("on"+d,m)}function F(d,m,g){(g?g:document).detachEvent("on"+d,m)}function A(){ga={base:{name:"Unknown",bindEvent:C(),unbindEvent:H(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:l,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:k,unbindEvent:F,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:q,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:q},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:q},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:C(true),unbindEvent:H(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:q},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:q}};Ga=[ga.froyo,ga.android,ga.ipod,ga.iphone,ga.ipad,ga.ie]}function K(){ga||A();if(!Ia){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var d=0;d<Ga.length;d++){var m=Ga[d];if(m.regex&&m.regex.test(navigator.userAgent)){Ia=COG.extend({},ga.base,m);COG.info("PLATFORM DETECTED AS: "+Ia.name);break}}if(!Ia){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Ia=ga.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Ia}function ca(){for(var d=0,m=arguments.length;m--;){var g=Xa[arguments[m].toUpperCase()];if(g)d|=g}return d}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(d){setTimeout(function(){d((new Date).getTime())},1E3/60)}}();var u=Math.PI*2,w=Math.PI/2,L=Math.abs,
pa=Math.ceil,X=Math.min,ra=Math.max,na=Math.pow,oa=Math.sqrt,Ba=Math.log,Ka=Math.round,Ca=Math.sin,Qa=Math.asin,ea=Math.cos,sa=Math.atan,xa=Math.atan2,D=function(){function d(b,e){return g(b.x-e.x,b.y-e.y)}function m(b,e){if(!e)e=b.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var i={edges:Array(e-1),accrued:Array(e-1),total:0},n=0;n<e-1;n++){var I=d(b[n],b[n+1]);i.edges[n]=oa(I.x*I.x+I.y*I.y);i.accrued[n]=i.total+i.edges[n];i.total+=i.edges[n]}return i}
function g(b,e){return{x:b?b:0,y:e?e:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,e=0,i=arguments.length;i--;){b+=arguments[i].x;e+=arguments[i].y}return g(b,e)},absSize:function(b){return ra(L(b.x),L(b.y))},copy:function(b){return b?g(b.x,b.y):null},diff:d,distance:function(b,e){return m(b,e).total},edges:m,equals:function(b,e){return b.x===e.x&&b.y===e.y},extendBy:function(b,e,i){var n=ea(e)*i;e=Ca(e)*i;return g(b.x-n,b.y-e)},floor:function(b){for(var e=
Array(b.length),i=b.length;i--;)e[i]=g(~~b[i].x,~~b[i].y);return e},getRect:function(b){for(var e,i,n,I,R=b.length;R--;){var t=b[R];e=typeof e==="undefined"||t.x<e?t.x:e;i=typeof i==="undefined"||t.y<i?t.y:i;n=typeof n==="undefined"||t.x>n?t.x:n;I=typeof I==="undefined"||t.y>I?t.y:I}return fa.init(e,i,n,I)},init:g,invert:function(b){return g(-b.x,-b.y)},min:function(b,e){return g(b.x<e.x?b.x:e.x,b.y<e.y?b.y:e.y)},max:function(b,e){return g(b.x>e.x?b.x:e.x,b.y>e.y?b.y:e.y)},offset:function(b,e,i){return g(b.x+
e,b.y+(i?i:e))},scale:function(b,e){return g(b.x/e|0,b.y/e|0)},simplify:function(b,e){if(!b)return null;e=e?e:D.VECTOR_SIMPLIFICATION;for(var i=[],n=null,I=b.length;I--;){var R=b[I];if(include=!n||I===0||L(R.x-n.x)+L(R.y-n.y)>e){i.unshift(R);n=R}}return i},theta:function(b,e,i){i=Qa((b.y-e.y)/i);return b.x>e.x?i:Math.PI-i},toString:function(b){return b?b.x+", "+b.y:""}}}(),da=function(){return{dotProduct:function(d,m){return d.x*m.x+d.y*m.y}}}(),fa=function(){function d(g){return m(g.x1,g.y1,g.x2,
g.y2)}function m(g,b,e,i){g=g?g:0;b=b?b:0;e=typeof e!=="undefined"?e:g;i=typeof i!=="undefined "?i:i;return{x1:g,y1:b,x2:e,y2:i,width:e-g,height:i-b}}return{center:function(g){return D.init(g.x1+g.width/2,g.y1+g.height/2)},copy:d,diagonalSize:function(g){return oa(g.width*g.width+g.height*g.height)},fromCenter:function(g,b,e,i){e=e>>1;i=i>>1;return m(g-e,b-i,g+e,b+i)},init:m,intersect:function(g,b){var e=ra(g.x1,b.x1),i=ra(g.y1,b.y1),n=X(g.x2,b.x2),I=X(g.y2,b.y2);e=m(e,i,n,I);return e.width>0&&e.height>
0?e:null},toString:function(g){return g?"["+g.x1+", "+g.y1+", "+g.x2+", "+g.y2+"]":""},union:function(g,b){if(g.width===0||g.height===0)return d(b);else if(b.width===0||b.height===0)return d(g);else{var e=X(g.x1,b.x1),i=X(g.y1,b.y1),n=ra(g.x2,b.x2),I=ra(g.y2,b.y2);e=m(e,i,n,I);return e.width>0&&e.height>0?e:null}}}}(),x=function(){return{getAspectRatio:function(d){return d.height!==0?d.width/d.height:1},getCenter:function(d){return D.init(d.width>>1,d.height>>1)},getSize:function(d){return oa(na(d.width,
2)+na(d.height,2))},init:function(d,m){d=d?d:0;return{width:d,height:m?m:d}}}}();Hits=function(){function d(m,g,b,e){e=e!==1?D.scale(b,e):b;return{type:m,x:e.x,y:e.y,elements:[],absXY:g,relXY:b}}return{copy:function(m){var g=d(null,null,m);g.elements=[].concat(m.elements);return g},diffHits:function(m,g){var b=[],e={},i;for(i=g.length;i--;)e[g[i].target.id]=true;for(i=m.length;i--;)e[m[i].target.id]||(b[b.length]=m[i]);return b},init:d,initHit:function(m,g,b){return b=COG.extend({type:m,target:g,
drag:false},b)}}}();var ga=null,Ga=[],Ia=null,$a=0,T=[],ja=["view.wake","tile.loaded"],Y=function(){function d(){var s=K().maxImageLoads;if(!s||E.length<s){var Q=t.shift();s=T5.ticks();if(Q){E[E.length]=Q;Q.image.onload=g;Q.image.src=Q.url;Q.requested=s}if(s-Z>i){Q=false;for(var ka=0,V=K();ka<E.length;)if(s-E[ka].requested>S.loadTimeout*1E3){E.splice(ka,1);Q=true}else ka++;Q&&d();if(V&&V.imageCacheMaxSize){N=P.length*S.avgImageSize/V.imageCacheMaxSize;N>=1&&m()}Z=s}}}function m(){la=true;try{var s=
P.length>>1;if(s>0){P.sort(function(ka,V){return ka.created-V.created});for(var Q=s;Q--;)delete n[P[Q].url];P.splice(0,s)}}finally{la=false}S.trigger("cacheCleared")}function g(){var s=I[this.id],Q;if(s&&s.image.complete&&s.image.width>0){s.loaded=true;s.hitCount=1;for(Q=E.length;Q--;)if(E[Q].image.src==this.src){E.splice(Q,1);break}if(s.background||s.postProcess||s.drawBackground||s.customDraw)if(s.image){globalImageData=s;Q=e(s.realSize?s.realSize.width:s.image.width,s.realSize?s.realSize.height:
s.image.height);var ka=Q.getContext("2d"),V=s.offset?s.offset:T5.XY.init();s.background&&ka.drawImage(s.background,0,0);s.drawBackground&&s.drawBackground(ka);s.customDraw?s.customDraw(ka,s):ka.drawImage(s.image,V.x,V.y);s.postProcess&&s.postProcess(ka,s);s.image=Q}for(Q=s.callbacks.length;Q--;)s.callbacks[Q]&&s.callbacks[Q](this,false);s.callbacks=[];P[P.length]={url:this.src,created:s.requested};delete I[this.id];d()}}function b(s,Q,ka){var V=n[s];if(V){V.hitCount++;V.image.complete&&V.image.width>
0&&Q?Q(V.image,true):V.callbacks.push(Q)}else{V=COG.extend({url:s,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[Q]},ka);V.image.id="resourceLoaderImage"+R++;n[s]=V;I[V.image.id]=V;t[t.length]=V;d()}return V}function e(s,Q){var ka=document.createElement("canvas");COG.info("creating new canvas");ka.width=s?s:0;ka.height=Q?Q:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(ka);FlashCanvas.initElement(ka)}return ka}var i=1E4,n={},I={},R=0,t=[],E=[],
P=[],N=0,Z=0,la=false,S={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var s;for(s=E.length;s--;)delete n[E[s].url];E=[];for(s=t.length;s--;)delete n[t[s].url];t=[]},get:function(s,Q,ka){var V=null,Ma=null;la||(V=n[s]);if((Ma=V?V.image:null)&&(Ma.getContext||Ma.complete&&Ma.width>0))return Ma;else Q&&b(s,Q,ka);return null},load:b,newCanvas:e,reset:function(){n={}},stats:function(){return{imageLoadingCount:E.length,queuedImageCount:t.length,imageCacheFullness:N}}};COG.observable(S);return S}(),
Oa=function(){var d={};return{init:function(m,g){var b=d[m];if(!b)throw Error("Unable to locate requested generator: "+m);return new b(g)},register:function(m,g){d[m]=g},Template:function(){}}}(),La=function(){function d(n,I){e[n]=g(I);return n}function m(n){for(var I in n)d(I,n[I])}function g(n){function I(P){var N=n[P];typeof N!=="undefined"&&t.push(function(Z){Z[P]=N})}function R(){t=[];for(var P in n)I(P)}n=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,
lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},n);var t=[],E={applyToContext:function(P){for(var N=t.length;N--;)t[N](P)},update:function(P,N){n[P]=N;R()}};R();return E}var b={},e={},i={apply:function(n,I){var R=e[I]?e[I]:e.basic,t;if(n&&n.canvas){t=b[n.canvas.id];b[n.canvas.id]=I}R.applyToContext(n);return t},define:d,defineMany:m,get:function(n){return e[n]},init:g,load:function(n){COG.jsonp(n,function(I){m(I)})}};m({basic:{lineWidth:1,strokeStyle:"#000",
fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});return i}(),Xa={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},ib=function(d){function m(r,v,z){Ra||Sa(ua-v,va-z)}function g(r,v,z,$){ta(X(ra(Da+na(2,$)-1,0.5),2))}function b(){var r=Ba(Da)/Math.LN2|0;if(r!==0){Da=na(2,r);db(kb+r,lb,mb)}V()}function e(r){r||(r=D.init(wa,Aa));O=D.init(ua,va);U=D.offset(r,ua,va);lb=U.x;mb=U.y}function i(r,
v,z){var $=1/Da;return D.init((z&&W?W.x1:0)+r*$,(z&&W?W.y1:0)+v*$)}function n(r,v,z){eb("doubleTap",v,z,i(z.x,z.y));d.scalable&&ta(2,z,d.zoomEasing,null,d.zoomDuration)}function I(r,v,z){Ra=null;ka("down",v,z)}function R(r,v,z){ka("hover",v,z,Da)}function t(r,v,z){if(Ra){r=i(z.x,z.y);Ra.drag(Ra,r.x,r.y,false)&&V()}}function E(r,v,z){if(Ra){r=i(z.x,z.y);Ra.drag(Ra,r.x,r.y,true)&&V()}J=Ra=null}function P(){clearTimeout(Ab);Ab=setTimeout(Z,250)}function N(r,v,z){ka("tap",v,z);eb("tap",v,z,i(z.x,z.y,
true))}function Z(r,v){var z;fb=typeof FlashCanvas!=="undefined";COG.info("is flash = "+fb);if(Ea){if(d.autoSize&&Ea.parentNode){r=Ea.parentNode.offsetWidth;v=Ea.parentNode.offsetHeight}try{if(!Ea.id)Ea.id=d.id+"_canvas";Ja=Ea.getContext("2d")}catch($){COG.exception($);throw Error("Could not initialise canvas on specified view element");}if(r&&v&&(Ta!==v||Ua!==r)){pb=true;Ua=r;Ta=v;wa=Ua>>1;Aa=Ta>>1;Fa.trigger("resize",Ua,Ta);for(z=Pa;z--;)ha[z].trigger("resize",Ua,Ta)}for(z=Pa;z--;)ha[z].trigger("contextChanged",
Ja);V();S()}}function la(r,v){v.setId(r);v.added=ba();v.bind("remove",function(){Fa.removeLayer(r)});v.trigger("contextChanged",Ja);v.setParent(Fa);ha.push(v);ha.sort(function(z,$){var qa=$.zindex-z.zindex;if(qa===0)qa=$.added-z.added;return qa});Pa=ha.length;return v}function S(){Va&&Va.unbind();Va=INTERACT.watch(Ea);d.pannable&&Va.pannable().bind("pan",m);if(d.scalable){Va.bind("zoom",g);Va.bind("doubleTap",n)}Va.bind("pointerDown",I);Va.bind("pointerMove",t);Va.bind("pointerUp",E);d.captureHover&&
Va.bind("pointerHover",R);Va.bind("tap",N)}function s(r){var v=a?ua+wa:ua,z=c?va+Aa:va;if(o&&o>Ua)if(v+Ua>o)ua=a?r&&v-o>0?ua-o:ua:o-Ua;else if(v<0)ua=a?r?ua+o:ua:0;if(p&&p>Ta)if(z+Ta>p)va=c?r&&z-p>0?va-p:va:p-Ta;else if(z<0)va=c?r?va+p:va:0}function Q(r){var v,z=false;if(qb|fb){bb=Bb|(Da!==1?Cb:0)|(ua!==f||va!==j?rb:0)|(sb?tb:0);aa=(v=(bb&(Cb|rb))!==0)&&(bb&tb)===0;if(pb&&Ea){fb&&FlashCanvas.initElement(Ea);Ea.width=Ua;Ea.height=Ta;Ea.style.width=Ua+"px";Ea.style.height=Ta+"px";pb=false}if(o||p)s();
y=Ma();for(var $=Pa;$--;){bb|=ha[$].animated?tb:0;ha[$].cycle(r,y,bb);z=ha[$].clip||z}$=bb;var qa=y;v=h&&z&&!v;var Ha;fa.center(qa);z=0;var Wa;if(Da!==1){Wa=1/Da;lb=U.x+(ua-O.x);mb=U.y+(va-O.y);Wa=qa?fa.fromCenter(lb>>0,mb>>0,qa.width*Wa>>0,qa.height*Wa>>0):void 0}else Wa=fa.copy(qa);W=Wa;v||Ja.clearRect(0,0,Ua,Ta);W.scaleFactor=Da;Ja.save();try{Da!==1&&Ja.scale(Da,Da);za=ia=null;if(v){Ja.beginPath();for(z=Pa;z--;)ha[z].clip&&ha[z].clip(Ja,W,$,Fa,r);Ja.closePath();Ja.clip()}Ja.globalCompositeOperation=
"source-over";for(z=Pa;z--;){Ha=ha[z];if(Ha.shouldDraw(bb,y)){var Na=Ha.style,ab=Na?La.apply(Ja,Na):null;Ha.draw(Ja,W,$,Fa,r,J);ab&&La.apply(Ja,ab)}}}finally{Ja.restore()}qb=0;eb("drawComplete",qa,r);Ha=J?J.elements:[];if(Ya&&J&&J.type==="hover"){Na=Hits.diffHits(Ya.elements,Ha);Na.length>0&&Fa.triggerCustom(J.type+"Out",{hitType:J.type},Na,J.absXY,J.relXY,D.init(J.x,J.y))}if(Ha.length>0){ab=J.x;$=J.y;for(Na=Ha.length;Na--;){qa=Ha[Na];v=ab;z=$;if(Wa=qa&&qa.drag&&(!qa.canDrag||qa.canDrag(qa,v,z))){Ra=
qa;Ra.startX=v;Ra.startY=z}if(Wa)break}Fa.triggerCustom(J.type+"Hit",{hitType:J.type},Ha,J.absXY,J.relXY,D.init(J.x,J.y))}Ya=Ha.length>0?Hits.copy(J):null;r-gb>hb&&jb();Db=r;f=ua;j=va;animFrame(Q)}else G=false}function ka(r,v,z){var $=false;J=Hits.init(r,v,z,Da);for(r=Pa;r--;)$=(ha[r].hitGuess?ha[r].hitGuess(J.x,J.y,bb,Fa):false)|$;$&&V()}function V(){qb+=1;if(!G){G=true;animFrame(Q)}}function Ma(){return fa.init(ua,va,ua+Ua,va+Ta)}function jb(){if(o||p)s(true);gb=(new Date).getTime();eb("refresh",
Fa,Ma());V()}function ta(r,v,z,$,qa){if(z)COG.tweenValue(Da,r,z,qa,function(Ha,Wa){Da=Ha;if(Wa){var Na=Ka(Ba(Da)/Math.LN2);Da=na(2,Na);$&&$()}e(v);b()});else{Da=r;e(v);b()}return Fa}function db(r,v,z){r=ra(d.minZoom,X(d.maxZoom,r));if(r!==kb){var $=na(2,r-kb),qa=wa/$|0,Ha=Aa/$|0;kb=r;Sa(((v?v:ua+wa)-qa)*$,((z?z:va+Aa)-Ha)*$);f=ua;j=va;eb("zoomLevelChange",r);Da=1;jb()}}function eb(){for(var r=Fa.trigger.apply(null,arguments).cancel,v=ha.length;v--;)r=ha[v].trigger.apply(null,arguments).cancel||r;
return!r}function Sa(r,v,z,$,qa){function Ha(){Wa+=1;if(Wa>=2){sb=false;qa&&qa()}}var Wa=0,Na=ia?D.offset(ia,-wa,-Aa):null,ab=za?D.offset(za,-wa,-Aa):null;if(Na){r=r<Na.x?Na.x:r;v=v<Na.y?Na.y:v}if(ab){r=r>ab.x?ab.x:r;v=v>ab.y?ab.y:v}if(z){if((bb&rb)===0){COG.tweenValue(ua,r,z,$,function(ub,vb){ua=ub|0;(vb?Ha:V)();return!aa});COG.tweenValue(va,v,z,$,function(ub,vb){va=ub|0;(vb?Ha:V)();return!aa});sb=true}}else{ua=r|0;va=v|0;V();qa&&qa()}}d=COG.extend({id:COG.objId("view"),container:"",captureHover:true,
captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:true,clipping:true,scalable:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},d);var ha=[],Pa=0,Ea=document.getElementById(d.container),Ra=null,Ja=null,wb=typeof window.attachEvent!="undefined",fb,hb=d.minRefresh,ua=0,va=0,f=0,j=0,o=null,
p=null,a=false,c=false,h=d.clipping,y=null,G=false,W,ma=1,wa=0,Aa=0,J=null,O=null,U=null,aa=false,ia=null,za=null,gb=0,Ya=null,Ab=0,Da=1,Db=0,pb=false,Va=null,sb=false,Ta,Ua,qb=0,lb,mb,kb=d.zoomLevel,Bb=ca("ACTIVE"),rb=ca("PAN"),Cb=ca("ZOOM"),tb=ca("ANIMATING"),bb=Bb,Fa={id:d.id,deviceScaling:ma,fastDraw:d.fastDraw||K().requireFastDraw,detach:function(){Va&&Va.unbind()},eachLayer:function(r){for(var v=Pa;v--;)r(ha[v])},getDimensions:function(){return x.init(Ua,Ta)},getLayer:function(r){for(var v=
0;v<Pa;v++)if(ha[v].getId()==r)return ha[v];return null},getZoomLevel:function(){return kb},setLayer:function(r,v){for(var z=0;z<Pa;z++)if(ha[z].getId()===r){ha.splice(z,1);break}if(v){la(r,v);v.trigger("refresh",Fa,Ma())}V();return v},invalidate:V,refresh:jb,resetScale:function(){Da=1},resize:function(r,v){if(Ea){d.autoSize=false;if(Ua!==r||Ta!==v)Z(r,v)}},scale:ta,setZoomLevel:db,syncXY:function(){},triggerAll:eb,removeLayer:function(r){a:{for(var v=Pa;v--;)if(ha[v].getId()==r){r=v;break a}r=-1}if(r>=
0&&r<Pa){Fa.trigger("layerRemoved",ha[r]);ha.splice(r,1);V()}Pa=ha.length},getOffset:function(){return D.init(ua,va)},setMaxOffset:function(r,v,z,$){o=r;p=v;a=typeof z!="undefined"?z:false;c=typeof $!="undefined"?$:false},getViewRect:Ma,updateOffset:Sa,pan:function(r,v,z,$,qa){Sa(ua+r,va+v,z,$,qa)}};ma=K().getScaling();Fa.markers=la("markers",new nb({zindex:20}));COG.observable(Fa);Fa.bind("invalidate",function(){V()});Fa.bind("resync",function(){za=ia=null});COG.configurable(Fa,["container","captureHover",
"captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(d,null,{container:function(r,v){Ea=document.getElementById(v);Z()},inertia:S,captureHover:S,scalable:S,pannable:S}),true);Z();if(d.autoSize)wb?window.attachEvent("onresize",P):window.addEventListener("resize",P,false);return Fa},xb=function(d){d=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:ca("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},d);var m=null,g=
false,b=false,e=d.id,i=ca("ACTIVE"),n=d.validStates,I=0,R=0,t=COG.extend({addToView:function(E){E.setLayer(e,t)},shouldDraw:function(E){return(E&n)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){t.trigger("remove",t)},changed:function(){b=true;m&&m.invalidate()},hitTest:null,getId:function(){return e},setId:function(E){e=E},getParent:function(){return m},setParent:function(E){g=(m=E)?m.fastDraw&&displayState!==i:false;t.trigger("parentChange",m)}},d);COG.observable(t);
t.bind("drawComplete",function(E,P){b=false;I=P.x1;R=P.y1});t.bind("resync",function(E,P){t.minXY&&P.syncXY(t.minXY);t.maxXY&&P.syncXY(t.maxXY)});return t},ob=function(d){d=COG.extend({style:null,fill:false,observable:true,properties:{},type:"shape",rotation:0,scale:1},d);var m=d.fill,g=COG.extend(d,{id:COG.objId(d.type),bounds:null,hit:false,drag:null,draw:function(b){m&&b.fill();b.stroke()},prepPath:function(){},resync:function(){}});d.observable&&COG.observable(g);return g},yb=function(d,m){m=
COG.extend({simplify:false},m);var g=false,b=m.simplify;ca("ZOOM");var e=[];m.type=m.fill?"polygon":"line";var i=COG.extend(new ob(m),{prepPath:function(n,I,R){if(g){var t=true,E,P,N,Z;n.beginPath();for(var la=e.length;la--;){var S=e[la].x-I,s=e[la].y-R;N=typeof N!="undefined"||S<N?S:N;Z=typeof Z!="undefined"||s<Z?s:Z;E=typeof E!="undefined"||S>E?S:E;P=typeof P!="undefined"||s>P?s:P;if(t){n.moveTo(S,s);t=false}else n.lineTo(S,s)}i.bounds=fa.init(N,Z,E,P)}return g},resync:function(n){i.xy=n.syncXY(d);
e=D.floor(b?D.simplify(d):d)}});g=d&&d.length>=2;return i},zb=function(d){d=COG.extend({xy:D.init(),draggable:false,size:10,type:"marker"},d);var m=d.size,g=COG.extend(new ob(d),{drag:function(b,e,i){g.xy.x=e;g.xy.y=i;return true},prepPath:function(b,e,i){b.beginPath();b.arc(e,i,m,0,Math.PI*2,false);g.bounds=fa.fromCenter(e,i,m,m);return true},resync:function(b){b.syncXY([g.xy])}});return g},nb=function(d){function m(i){for(var n=b.length;n--;)b[n].resync(i);b.sort(function(I,R){var t=R.xy.y-I.xy.y;
return t!=0?t:R.xy.x-I.xy.y});e.changed()}function g(i,n){m(n)}d=COG.extend({zindex:10},d);var b=[],e=COG.extend(new xb(d),{add:function(i){if(i){e.getParent()&&i.resync(e.getParent());b[b.length]=i}},clear:function(){b=[]},draw:function(i,n,I,R,t,E){R=n.x1;t=n.y1;var P=E?E.x:0,N=E?E.y:0,Z=n.width;n=n.height;for(var la=b.length;la--;){var S=b[la],s=S.style,Q;if(S.prepPath(i,R,t,Z,n,I)){if(E&&i.isPointInPath(P,N)){E.elements.push(Hits.initHit(S.type,S));Q=E.type+"Style";s=S[Q]||s}s=s?La.apply(i,s):
null;S.draw(i,R,t,Z,n,I);s&&La.apply(i,s)}}},hitGuess:function(i,n){for(var I=false,R=b.length;!I&&R--;){var t=b[R].bounds;I=I||t&&i>=t.x1&&i<=t.x2&&n>=t.y1&&n<=t.y2}return I}});e.bind("parentChange",g);e.bind("resync",g);return e},Eb=function(){return{tileSize:256,init:function(d,m,g,b,e){return COG.extend({x:d,y:m,width:g,height:b},e)}}}(),cb={ex:COG.extend,ticks:ba,getConfig:K,userMessage:function(d,m,g){cb.trigger("userMessage",d,m,g)},XY:D,XYRect:fa,Dimensions:x,Vector:da,Hits:Hits,D:x,Images:Y,
Generator:Oa,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:La,viewState:ca,View:ib,ViewLayer:xb,ImageLayer:function(d,m){function g(t,E,P){for(E=n.length;E--;){var N=n[E],Z=N.x,la=N.y,S=fa.init(N.x,N.y,N.x+N.width,N.y+N.height);if(P&&fa.intersect(t,S))(S=Y.get(N.url,function(){R.changed()},I))&&P(S,Z,la,N.width,N.height)}}function b(t){var E=++i,P=R.getParent();e&&e.run(P,t,function(N){if(E==i){n=[].concat(N);P.invalidate()}})}m=COG.extend({imageLoadArgs:{}},m);
var e=d?Oa.init(d,m):null,i=0,n=[],I=m.imageLoadArgs,R=COG.extend(new xb(m),{changeGenerator:function(t,E){e=Oa.init(t,COG.extend({},m,E));n=null;b(R.getParent().getViewRect())},clip:function(t,E,P){var N=E.x1,Z=E.y1;g(E,P,function(la,S,s,Q,ka){t.rect(S-N,s-Z,Q,ka)})},draw:function(t,E,P){var N=E.x1,Z=E.y1;g(E,P,function(la,S,s){t.drawImage(la,S-N,s-Z,la.width,la.height)})},mask:function(t,E,P){g(E,P,function(N,Z,la,S,s){COG.info("clearing rect @ x = "+Z+", y = "+la+", width = "+S+", height = "+s);
t.clearRect(Z,la,S,s)})}});R.bind("refresh",function(t,E,P){b(P)});R.bind("tap",function(t,E,P,N){t=[];var Z=N.x,la=N.y,S,s;if(n)for(var Q=n.length;Q--;){S=n[Q];if(s=Z>=S.x&&Z<=S.x+S.width&&la>=S.y&&la<=S.y+S.height)t[t.length]=S}t.length>0&&R.trigger("tapImage",t,E,P,N)});return R},ImageGenerator:function(d){d=COG.extend({relative:false,padding:2},d);d={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(d);return d},Shape:ob,Arc:function(d,m){m=COG.extend({size:4},
m);var g=D.init(),b=COG.extend(m,{draw:function(e){e.beginPath();e.arc(g.x,g.y,b.size,0,Math.PI*2,false);e.fill();e.stroke()},resync:function(e){e.syncXY([d]);g=D.floor([d])[0]}});COG.info("created arc = ",d);return b},Poly:yb,Points:function(d,m){m=COG.extend({fill:true,radius:10},m);var g=m.fill,b=[],e=m.radius;return COG.extend(new ob(m),{draw:function(i,n,I){i.beginPath();for(var R=b.length;R--;)i.arc(b[R].x-n,b[R].y-I,e,0,Math.PI*2,false);g&&i.fill();i.stroke()},resync:function(){b=D.floor(d)}})},
Marker:zb,ImageMarker:function(d){d=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null},d);var m=null,g,b,e=d.imageAnchor?T5.XY.invert(d.imageAnchor):null,i=COG.extend(new zb(d),{changeImage:function(n){i.image=Y.get(n,function(I){i.image=I})},drag:function(n,I,R,t){m||(m=D.init(n.startX-i.xy.x,n.startY-i.xy.y));i.xy.x=I-m.x;i.xy.y=R-m.y;if(t){n=i.parent?i.parent.getParent():null;m=null;n&&n.syncXY([i.xy],true);i.trigger("dragDrop")}return true},draw:function(n){n.drawImage(i.image,
g,b)},prepPath:function(n,I,R){var t=i.image,E=t&&t.width>0;if(E){e||(e=D.init(-t.width>>1,-t.height>>1));g=i.xy.x+e.x-I;b=i.xy.y+e.y-R;i.bounds=fa.init(g,b,g+t.width,b+t.height);n.beginPath();n.rect(g,b,t.width,t.height)}return E}});if(!i.image)i.image=Y.get(d.imageUrl,function(n){i.image=n});if(!i.animatingImage)i.animatingImage=Y.get(d.animatingImageUrl,function(n){i.animatingImage=n});return i},ShapeLayer:nb,Tiling:Eb};COG.observable(cb);var Za=cb.Geo=function(){function d(f){for(var j=null,o=
1;!j&&o<arguments.length;o++)j=i(f,arguments[o]);j=j?j:i(f);if(!j)throw Error("Unable to find GEO engine with "+f+" capability");return j}function m(f){f=parseFloat(f)*N;f=Ca(f);var j=Q*f;return Ba((1+f)/(1-f)*na((1-j)/(1+j),Q))/2}function g(f){return parseFloat(f)*N}function b(f){f=na(Math.E,-f);for(var j=w-2*sa(f),o=n(j,f),p=0;p<V&&L(j-o)>ka;){j=o;o=n(j,f);p++}return o*Z}function e(f){return f%360*Z}function i(f,j){var o=null;for(var p in ha)if(j){if(p==j&&ha[p][f]){o=ha[p];break}}else if(ha[p][f]){o=
ha[p];break}return o}function n(f,j){var o=Q*Ca(f);return w-2*sa(j*na((1-o)/(1+o),Q/2))}function I(f,j,o,p){j=t(j);f.add(p.line(j,o));return j.length}function R(f,j,o,p){j=t(j);f.add(p.poly(j,o));return j.length}function t(f){var j=f?f.length:0,o=Array(j);for(j=j;j--;)o[j]=Za.Position.init(f[j][1],f[j][0]);return Za.Position.vectorize(o,fb)}function E(f,j,o){return new va(f,j,o)}var P=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],N=Math.PI/180,Z=180/Math.PI,
la=w,S=-la,s=-u,Q=0.08181919084262157,ka=1.0E-7,V=12,Ma=null,jb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ta=function(){function f(a){return a?o(a.lat,a.lon):null}function j(a){return!a||a.lat===0&&a.lon===0}function o(a,c){return{lat:parseFloat(a?a:0),lon:parseFloat(c?c:0)}}function p(a){if(a)if(typeof a.lat!=="undefined")return f(a);else{if(a.split)for(var c=[" ",","],h=0;h<c.length;h++){var y=a.split(c[h]);if(y.length===2)return o(y[0],
y[1])}}else return o();return null}return{calcDistance:function(a,c){if(j(a)||j(c))return 0;var h=(c.lat-a.lat)*N>>1,y=(c.lon-a.lon)*N>>1;h=Ca(h)*Ca(h)+ea(a.lat*N)*ea(c.lat*N)*Ca(y)*Ca(y);return 6371*2*xa(oa(h),oa(1-h))},copy:f,empty:j,equal:function(a,c){return a&&c&&a.lat==c.lat&&a.lon==c.lon},fromMercatorPixels:function(a,c){return o(b(c),e(a))},generalize:function(a,c,h){var y=a.length,G=[],W=null;h||(h=250);h/=1E3;COG.info("generalizing positions, must include "+c.length+" positions");for(var ma=
y;ma--;)if(ma===0)G.unshift(a[ma]);else{var wa=!W||ta.inArray(a[ma],c)?h:ta.calcDistance(W,a[ma]);if(a[ma]&&wa>=h){G.unshift(a[ma]);W=a[ma]}}COG.info("generalized "+y+" positions into "+G.length+" positions");return G},inArray:function(a,c){for(var h=ta.equal,y=c.length;y--;)if(h(a,c[y]))return true;return false},inBounds:function(a,c){var h=!(ta.empty(a)||ta.empty(c));return h=(h=h&&a.lat>=c.min.lat&&a.lat<=c.max.lat)&&a.lon>=c.min.lon&&a.lon<=c.max.lon},init:o,offset:function(a,c,h){var y=a.lat*
N;a=a.lon*N;c=y+c/6371;h=Qa(Ca(h/6371)/ea(y));h=a+h;c=(c+w)%Math.PI-w;h%=u;return o(c*Z,h*Z)},parse:p,parseArray:function(a){var c=a.length,h=Array(c);for(c=c;c--;)h[c]=p(a[c]);return h},toMercatorPixels:function(a){return T5.XY.init(g(a.lon),m(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,c){function h(){for(var ma=0,wa=c.chunkSize,Aa=y;Aa--;){G[Aa]=T5.GeoXY.init(a[Aa]);ma+=1;if(ma>wa)break}y=Aa;if(y<=0)c.callback&&c.callback(G);else animFrame(h)}var y=a.length,
G=Array(y);c=COG.extend({chunkSize:500,async:true,callback:null},c);if(!c.async){for(var W=y;W--;)G[W]=T5.GeoXY.init(a[W]);return G}animFrame(h);return null}}}(),db=function(){function f(a,c,h){var y=T5.XY.init(0,c.lat-a.lat);if(typeof h==="undefined")h=true;y.x=h&&a.lon>c.lon?360-a.lon+c.lon:c.lon-a.lon;return y}function j(a,c){return db.init(ta.init(a.min.lat-c,a.min.lon-c%360),ta.init(a.max.lat+c,a.max.lon+c%360))}function o(a){var c=f(a.min,a.max);return ta.init(a.min.lat+(c.y>>1),a.min.lon+(c.x>>
1))}function p(a,c){return{min:ta.parse(a),max:ta.parse(c)}}return{calcSize:f,createBoundsFromCenter:function(a,c){var h=c/6371,y=a.lat*N,G=a.lon*N,W=y-h,ma=y+h;if(W>S&&ma<la){y=Qa(Ca(h)/ea(y));h=(G-y)%u;G=(G+y)%u}else{W=ra(W,S);ma=X(ma,la);h=s;G=u}return db.init(ta.init(W*Z,h*Z),ta.init(ma*Z,G*Z))},expand:j,forPositions:function(a,c){var h=null,y=T5.ticks();c||(c="auto");for(var G=a.length;G--;)if(h){var W=f(h.min,a[G],false),ma=f(a[G],h.max,false);if(W.x<0)h.min.lon=a[G].lon;if(W.y<0)h.min.lat=
a[G].lat;if(ma.x<0)h.max.lon=a[G].lon;if(ma.y<0)h.max.lat=a[G].lat}else h=p(a[G],a[G]);if(c){if(c=="auto"){G=f(h.min,h.max);c=ra(G.x,G.y)*0.3}h=j(h,c)}COG.trace("calculated bounds for "+a.length+" positions",y);return h},getCenter:o,getGeoHash:function(a){var c=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+c+", max hash = "+a)},getZoomLevel:function(a,c){var h=o(a);h=X(Ka(L(h.lat)*0.05),P.length);var y=P[h],G=f(a.min,a.max);h=pa(Ba(P[3]*
c.height/G.y)/Ba(2));y=pa(Ba(y*c.width/G.x)/Ba(2));return X(isNaN(h)?1E3:h,isNaN(y)?1E3:y)},init:p,isEmpty:function(a){return!a||ta.empty(a.min)||ta.empty(a.max)},toString:function(a){return"min: "+ta.toString(a.min)+", max: "+ta.toString(a.max)}}}(),eb=function(){var f=/^(\d+).*$/,j=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(o,p){f.lastIndex=-1;if(f.test(o))for(var a=o.replace(f,"$1"),c=p.split(","),h=0;h<c.length;h++){j.lastIndex=-1;if(j.test(c[h])){var y=j.exec(c[h]);if(a>=parseInt(y[1],
10)&&a<=parseInt(y[2],10))return true}else if(a==c[h])return true}return false},normalize:function(o){if(!o)return"";o=o.toUpperCase();if(!Ma){var p=[];for(var a in jb)p.push(a);Ma=RegExp("(\\s)("+p.join("|")+")(\\s|$)","i")}Ma.lastIndex=-1;if(p=Ma.exec(o))o=o.replace(Ma,"$1"+jb[p[2]]);return o},toString:function(o){return o.streetDetails+" "+o.location}}}(),Sa=cb.GeoXY=function(){function f(p,a){if(p.length){for(var c,h,y,G,W=p.length;W--;){f(p[W],a);c=typeof c==="undefined"||p.x<c?p.x:c;h=typeof h===
"undefined"||p.y<h?p.y:h;y=typeof y==="undefined"||p.x>y?p.x:y;G=typeof G==="undefined"||p.y>G?p.y:G}return fa.init(c,h,G,G)}else if(p.mercXY){c=p.mercXY;p.x=(c.x+Math.PI)/a|0;p.y=(Math.PI-c.y)/a|0;p.rpp=a}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return p}function j(p,a){if(p.length)for(var c=p.length;c--;)j(p[c],a);else{p.mercXY=D.init(p.x*a-Math.PI,Math.PI-p.y*a);p.pos=ta.fromMercatorPixels(p.mercXY.x,p.mercXY.y)}return p}function o(p,a,c){p.pos=a;p.mercXY=ta.toMercatorPixels(a);
(c=typeof c!=="undefined"?c:p.rpp)&&f(p,c)}return{init:function(p,a){var c=D.init();o(c,p,a);return c},sync:f,syncPos:j,toPos:function(p,a){a=a?a:self.rpp;return ta.fromMercatorPixels(p.x*a-Math.PI,Math.PI-p.y*a)},updatePos:o}}(),ha={},Pa=function(){return{bestResults:function(f,j){j||(j=20);for(var o=f.length>0?f[0]:null,p=[],a=0;a<f.length;a++)if(o&&f[a]&&o.matchWeight-f[a].matchWeight<=j)p.push(f[a]);else break;return p}}}(),Ea=function(f){f=COG.extend({id:null,caption:"",resultType:"",data:null,
pos:null,matchWeight:0},f);return COG.extend(f,{toString:function(){return f.caption+(f.matchWeight?" ("+f.matchWeight+")":"")}})},Ra=function(){function f(a,c){var h=new T5.ShapeLayer;c.geometry&&ta.vectorize(c.geometry,{callback:function(y){h.add(new T5.Poly(y,{style:"waypoints",simplify:true}));a.setLayer("route",h)}})}function j(a){for(var c=o.Unknown,h=p,y=0;y<h.length;y++){h[y].regex.lastIndex=-1;var G=h[y].regex.exec(a);if(G){c=h[y].customCheck?h[y].customCheck(a,G):h[y].turnType;break}}return c}
var o={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},p=function(){var a=[];a.push({regex:/continue/i,turnType:o.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,
customCheck:function(c,h){return/bear/i.test(h[1])?o.TurnLeftSlight:o.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(c,h){return/bear/i.test(h[1])?o.TurnRightSlight:o.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:o.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:o.Ramp});a.push({regex:/take.*?exit/i,turnType:o.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(c,h){return/right/i.test(h[1])?o.UTurnRight:o.UTurnLeft}});a.push({regex:/proceed/i,
turnType:o.Start});a.push({regex:/arrive/i,turnType:o.Arrive});a.push({regex:/fell\sthrough/i,turnType:o.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var c=d("route");c&&c.route(a,function(h){if(a.generalize)h.geometry=ta.generalize(h.geometry,h.getInstructionPositions());if(a.map){f(a.map,h);a.autoFit&&a.map.gotoBounds(h.boundingBox)}a.success&&a.success(h)})},createMapOverlay:f,parseTurnType:j,
TurnType:o,Instruction:function(a){var c=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),h=a.description;h=h.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");c.description=h;if(!a.turnType)a.turnType=j(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=db.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var c=[],h=0;h<a.instructions.length;h++)a.instructions[h].position&&
c.push(a.instructions[h].position);return c}},a)}}}(),Ja="featurecollection",wb="feature",fb={async:false},hb={processor:null,group:"shapes",layerClass:nb},ua={point:COG.extend({},hb,{processor:function(f,j,o,p){j=t([j.coordinates],fb);if(j.length>0)if(o=p.marker(j[0],o)){f.add(o);return j.length}},group:"markers",layerClass:nb}),linestring:COG.extend({},hb,{processor:function(f,j,o,p){j=t(j&&j.coordinates?j.coordinates:[]);return I(f,j,o,p)}}),multilinestring:COG.extend({},hb,{processor:function(f,
j,o,p){j=j&&j.coordinates?j.coordinates:[];for(var a=0,c=j.length;c--;)a+=I(f,j[c],o,p);return a}}),polygon:COG.extend({},hb,{processor:function(f,j,o,p){j=j&&j.coordinates?j.coordinates:[];if(j.length>0)return R(f,j[0],o,p);return 0}}),multipolygon:COG.extend({},hb,{processor:function(f,j,o,p){j=j&&j.coordinates?j.coordinates:[];for(var a=0,c=0;c<j.length;c++)a+=R(f,j[c][0],o,p);return a}})},va=function(f,j,o,p){function a(U,aa){var ia=U.processor,za=W+U.group,gb=COG.extend({},U,o,{properties:aa.properties});
if(ia){var Ya=O[za];if(!Ya){Ya=new U.layerClass({id:za});O[za]=Ya}globalLayers=O;return ia(Ya,aa.data,gb,p)}return 0}function c(U,aa){var ia=U&&U.type?U.type.toLowerCase():null;return ia&&ia===wb?c(U.geometry,U.properties):{type:ia,isCollection:ia?ia===Ja:false,definition:ua[ia],data:U,properties:aa?aa:U.properties}}function h(){var U=0,aa=ma;if(!Aa){for(;aa<wa;aa++){var ia=c(G?G(f[aa]):f[aa]),za=null;if(ia.isCollection){J+=1;Aa=E(ia.data.features,function(gb){Aa=null;for(var Ya in gb)O[Ya]=gb[Ya]},
{layerPrefix:W+J+"-"});za+=1}else if(ia.definition)za=a(ia.definition,ia);U+=za?za:1;if(U>=y)break}ma=aa+1;if(Aa||ma<wa)animFrame(h);else j&&j(O)}}o=COG.extend({vectorsPerCycle:Za.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},o);p=COG.extend({marker:function(U){return new zb({xy:U})},line:function(U,aa){return new yb(U,aa)},poly:function(U,aa){return new yb(U,COG.extend({fill:true},aa))}},p);var y=o.vectorsPerCycle,G=o.rowPreParse,W=o.layerPrefix,ma=0,wa=0,Aa=null,J=
0,O={};if(f){if(typeof f.length==="undefined")f=[f];wa=f.length;animFrame(h)}};cb.GeoJSON={parse:E};cb.Map=function(f){function j(O){try{var U=Za.Position.init(O.coords.latitude,O.coords.longitude),aa=O.coords.accuracy/1E3;J.trigger("locationUpdate",O,aa);if(ma){if(!G){G=new Za.UI.LocationOverlay({pos:U,accuracy:aa});G.update(J.getTileLayer());J.setLayer("location",G)}var ia=Za.BoundingBox.createBoundsFromCenter(U,Math.max(aa,1));J.gotoBounds(ia)}else{G.pos=U;G.accuracy=aa;G.update(J.getTileLayer());
a(U,null,COG.easing("sine.out"))}ma=false}catch(za){COG.exception(za)}}function o(O){COG.info("caught location tracking error:",O)}function p(O,U,aa){J.setZoomLevel(U);a(O,aa)}function a(O,U,aa,ia){O=Sa.init(O,Za.radsPerPixel(J.getZoomLevel()));var za=J.getDimensions();J.updateOffset(O.x-(za.width>>1),O.y-(za.height>>1),aa,ia,function(){J.refresh();J.trigger("boundsChange",J.getBoundingBox());U&&U(J)})}f=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18},
f);var c={NONE:0,SINGLE:1,WATCH:2},h=D.init(),y=c.NONE,G=null,W=0,ma=true,wa=0,Aa=f.tapExtent;f.adjustScaleFactor=function(O){return Math.pow(2,(O<1?Math.floor:Math.ceil)(Math.log(O)))};var J=COG.extend(new ib(f),{getBoundingBox:function(){var O=J.getViewRect();return Za.BoundingBox.init(Sa.toPos(D.init(O.x1,O.y2),wa),Sa.toPos(D.init(O.x2,O.y1),wa))},getCenterPosition:function(){var O=J.getViewRect();if(O){O=D.init(O.x1+(O.width>>1),O.y1+(O.height>>1));return Sa.toPos(O,wa)}return null},gotoBounds:function(O,
U){var aa=Za.BoundingBox.getZoomLevel(O,J.getDimensions());p(Za.BoundingBox.getCenter(O),aa,U)},gotoPosition:p,panToPosition:a,syncXY:function(O,U){return(U?Sa.syncPos:Sa.sync)(O,wa)},locate:function(){J.trackStart(c.SINGLE);setTimeout(J.trackCancel,1E4)},trackStart:function(O){if(navigator.geolocation&&!W){y=O?O:c.WATCH;ma=true;W=navigator.geolocation.watchPosition(j,o,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){W&&navigator.geolocation&&navigator.geolocation.clearWatch(W);
J.removeLayer("location");G=null;y=c.NONE;W=0},animateRoute:function(O,U,aa,ia){var za=J.getLayer("route");if(za)(O=za.getAnimation(O,U,aa,ia))&&O.addToView(J)}});J.bind("pan",function(){y===c.SINGLE&&J.trackCancel()});J.bind("tap",function(O,U,aa,ia){O=Sa.toPos(ia,wa);var za=Sa.toPos(D.offset(ia,-Aa,Aa),wa);ia=Sa.toPos(D.offset(ia,Aa,-Aa),wa);J.trigger("geotap",U,aa,O,db.init(za,ia))});J.bind("refresh",function(){if(D.absSize(D.diff(h,J.getOffset()))>f.boundsChangeThreshold){h=D.copy(J.getOffset());
J.trigger("boundsChange",J.getBoundingBox())}});J.bind("zoomLevelChange",function(O,U){var aa;wa=Za.radsPerPixel(U);aa=u/wa|0;J.setMaxOffset(aa,aa,true,false);Y.cancelLoad();J.resetScale();J.triggerAll("resync",J);J.refresh()});return J};cb.GeoShape=function(f,j){j=COG.extend({autoParse:true},j);for(var o=Array(f.length),p=j.autoParse,a=T5.Geo.Position.parse,c=f.length;c--;)o[c]=T5.GeoXY.init(p?a(f[c]):f[c]);return new T5.Poly(o,j)};cb.LocationOverlay=function(f){f=COG.extend({pos:null,accuracy:null,
zindex:90},f);var j=new Image,o=T5.XY.init(),p=T5.XY.init(),a=null;j.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
j.onload=function(){o=T5.XY.init(j.width>>1,j.height>>1)};var c=COG.extend(new T5.ViewLayer(f),{pos:f.pos,accuracy:f.accuracy,drawAccuracyIndicator:false,draw:function(h,y){var G=p.x-y.x,W=p.y-y.y;if(a){h.fillStyle="rgba(30, 30, 30, 0.2)";h.beginPath();h.arc(G,W,a,0,Math.PI*2,false);h.fill()}j.complete&&j.width>0&&h.drawImage(j,G-o.x,W-o.y,j.width,j.height);c.changed()},update:function(h){if(h){a=h.getPixelDistance(c.accuracy)>>1;p=h.getGridXYForPosition(c.pos);c.changed()}}});c.bind("gridUpdate",
function(h,y){c.update(y)});return c};return{distanceToString:function(f){if(f>1E3)return~~(f/10)/100+" km";return f?f+" m":""},dist2rad:function(f){return f/6371},getEngine:d,lat2pix:m,lon2pix:g,pix2lat:b,pix2lon:e,radsPerPixel:function(f){return u/(256<<f)},Position:ta,BoundingBox:db,Radius:function(f,j){return{distance:parseInt(f,10),uom:j}},Address:function(f){return f=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},f)},A:eb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(f){if(!f.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var j=COG.extend({remove:function(){delete ha[j.id]}},f);return ha[j.id]=j},Search:Pa,GeoSearchResult:Ea,LocationSearch:function(f){function j(h,y){navigator.geolocation.clearWatch(p);p=0;if(a){clearTimeout(a);a=0}y&&y([h],f)}function o(h){COG.info("caught location tracking error:",h)}f=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},f);var p=0,a=0,c=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(h,y){if(navigator.geolocation&&!p){p=navigator.geolocation.watchPosition(function(G){var W=ta.init(G.coords.latitude,G.coords.longitude);G=new Ea({id:1,caption:"Current Location",pos:W,accuracy:G.coords.accuracy/1E3,matchWeight:100});if(!c||G.accuracy<c.accuracy)c=G;if(!f.requiredAccuracy||c.accuracy<f.requiredAccuracy)j(c,y)},o,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(f.searchTimeout)a=
setTimeout(function(){c&&j(c,y)},f.searchTimeout)}}},f))},Routing:Ra}}();return cb}();
