COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var N=arguments[0]||{},ea,J=1,B=arguments.length;J<B;J++)if((ea=arguments[J])!==null)for(var k in ea){var l=ea[k];if(N!==l)if(l!==undefined)N[k]=l}return N};
(function(){var N=Object.prototype.hasOwnProperty,ea=0,J={};J.toID=function(B){return B.replace(/\s/g,"-")};J.objId=function(B){return(B?B:"obj")+ea++};J.isFunction=function(B){return toString.call(B)==="[object Function]"};J.isArray=function(B){return toString.call(B)==="[object Array]"};J.isPlainObject=function(B){if(!B||toString.call(B)!=="[object Object]"||B.nodeType||B.setInterval)return false;if(B.constructor&&!N.call(B,"constructor")&&!N.call(B.constructor.prototype,"isPrototypeOf"))return false;
var k;for(k in B);return k===undefined||N.call(B,k)};J.isEmptyObject=function(B){for(var k in B)return false;return true};J.isXmlDocument=function(B){return toString.call(B)==="[object Document]"};J.contains=function(B,k){var l=B,u=arguments,D=1;if(k&&module.isArray(k)){u=k;D=0}for(D=D;D<u;D++)l=l&&typeof foo[u[D]]!=="undefined";return l};J.formatStr=function(B){if(arguments.length<=1)return B;for(var k=arguments.length-2,l=0;l<=k;l++)B=B.replace(RegExp("\\{"+l+"\\}","gi"),arguments[l+1]);return B};
J.wordExists=function(B,k){var l="";if(k.toString)k=k.toString();for(var u=0;u<k.length;u++)l+=!/\w/.test(k[u])?"\\"+k[u]:k[u];return RegExp("(^|\\s|\\,)"+l+"(\\,|\\s|$)","i").test(B)};COG.extend(COG,J)})();
(function(){function N(l){return typeof console!=="undefined"?function(){console[l](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ea=window.console&&window.console.markTimeline,J=N("error"),B=N("info"),k=function(){return ea?function(l,u){console.markTimeline(l+(u?": "+((new Date).getTime()-u)+"ms":""))}:function(){}}();COG.extend(COG,{trace:k,debug:N("debug"),info:B,warn:N("warn"),error:J,exception:function(l){if(J)for(var u in l)B("ERROR DETAIL: "+
u+": "+l[u])}})})();
(function(){function N(J,B){var k=J.hasOwnProperty("obsHandlers")?J.obsHandlers:null;k[B]||(k[B]=[]);return k[B]}var ea=0;COG.observable=function(J){if(!J)return null;if(!(J.hasOwnProperty("obsHandlers")?J.obsHandlers:null))J.obsHandlers={};if(!J.hasOwnProperty("bind")){J.bind=function(B,k){var l="callback"+ea++;N(J,B).unshift({fn:k,id:l});return l};J.triggerCustom=function(B,k){var l=N(J,B),u={cancel:false,name:B,source:this},D;k&&COG.extend(u,k);if(!l)return null;D=Array.prototype.slice.call(arguments,2);
J.eventInterceptor&&J.eventInterceptor(B,u,D);D.unshift(u);for(var U=l.length;U--&&!u.cancel;)l[U].fn.apply(this,D);return u};J.trigger=function(B){var k=Array.prototype.slice.call(arguments,1);k.splice(0,0,B,null);return J.triggerCustom.apply(this,k)};J.unbind=function(B,k){if(typeof B==="undefined")J.obsHandlers={};else for(var l=N(J,B),u=0;l&&u<l.length;u++)if(l[u].id===k){l.splice(u,1);break}return J}}return J}})();
(function(){function N(k,l){k[l]||(k[l]=function(u){return k.configure(l,u)})}function ea(k){k.gtConfId="configurable"+B++;k.gtConfig={};k.gtConfigFns=[];return k.gtConfig}var J={},B=0;COG.paramTweaker=function(k,l,u){return function(D,U){if(typeof U!=="undefined"){if(D in k)k[D]=U;u&&D in u&&u[D](D,U)}else return l&&D in l?l[D](D):k[D]}};COG.configurable=function(k,l,u,D){if(k){k.gtConfId||ea(k);var U=k.gtConfId,n=k.gtConfig,G=k.gtConfigFns;J[U]=k;G.push(u);for(u=l.length;u--;){n[l[u]]=true;D&&N(k,
l[u])}if(!k.configure)k.configure=function(C,H){if(n[C]){for(var x=G.length;x--;){var t=G[x](C,H);if(typeof t!=="undefined")return t}return J[U]}return null}}}})();
(function(){function N(k){var l=document.createElement("script"),u=false;l.src=k;l.async=true;l.onload=l.onreadystatechange=function(){if(!u&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){u=true;l.onload=l.onreadystatechange=null;l&&l.parentNode&&l.parentNode.removeChild(l)}};J||(J=document.getElementsByTagName("head")[0]);J.appendChild(l)}var ea=0,J,B=this;COG.jsonp=function(k,l,u){k+=k.indexOf("?")>=0?"&":"?";var D="json"+ ++ea;B[D]=function(U){l(U);B[D]=null;try{delete B[D]}catch(n){}};
N(k+(u?u:"callback")+"="+D);return D}})();
(function(){var N=1.70158,ea=Math.PI/2,J=1E3/60|0,B=Math.abs,k=Math.pow,l=Math.sin,u=Math.asin,D=Math.cos,U={linear:function(n,G,C,H){return C*n/H+G},backin:function(n,G,C,H){return C*(n/=H)*n*((N+1)*n-N)+G},backout:function(n,G,C,H){return C*((n=n/H-1)*n*((N+1)*n+N)+1)+G},backinout:function(n,G,C,H){return(n/=H/2)<1?C/2*n*n*(((N*=1.525)+1)*n-N)+G:C/2*((n-=2)*n*(((N*=1.525)+1)*n+N)+2)+G},bouncein:function(n,G,C,H){return C-U.bounceout(H-n,0,C,H)+G},bounceout:function(n,G,C,H){return(n/=H)<1/2.75?
C*7.5625*n*n+G:n<2/2.75?C*(7.5625*(n-=1.5/2.75)*n+0.75)+G:n<2.5/2.75?C*(7.5625*(n-=2.25/2.75)*n+0.9375)+G:C*(7.5625*(n-=2.625/2.75)*n+0.984375)+G},bounceinout:function(n,G,C,H){return n<H/2?U.bouncein(n*2,0,C,H)/2+G:U.bounceout(n*2-H,0,C,H)/2+C/2+G},cubicin:function(n,G,C,H){return C*(n/=H)*n*n+G},cubicout:function(n,G,C,H){return C*((n=n/H-1)*n*n+1)+G},cubicinout:function(n,G,C,H){if((n/=H/2)<1)return C/2*n*n*n+G;return C/2*((n-=2)*n*n+2)+G},elasticin:function(n,G,C,H,x,t){if(n==0)return G;if((n/=
H)==1)return G+C;t||(t=H*0.3);if(!x||x<B(C)){x=C;C=t/4}else C=t/TWO_PI*u(C/x);return-(x*k(2,10*(n-=1))*l((n*H-C)*TWO_PI/t))+G},elasticout:function(n,G,C,H,x,t){var E;if(n==0)return G;if((n/=H)==1)return G+C;t||(t=H*0.3);if(!x||x<B(C)){x=C;E=t/4}else E=t/TWO_PI*u(C/x);return x*k(2,-10*n)*l((n*H-E)*TWO_PI/t)+C+G},elasticinout:function(n,G,C,H,x,t){var E;if(n==0)return G;if((n/=H/2)==2)return G+C;t||(t=H*0.3*1.5);if(!x||x<B(C)){x=C;E=t/4}else E=t/TWO_PI*u(C/x);if(n<1)return-0.5*x*k(2,10*(n-=1))*l((n*
H-E)*TWO_PI/t)+G;return x*k(2,-10*(n-=1))*l((n*H-E)*TWO_PI/t)*0.5+C+G},quadin:function(n,G,C,H){return C*(n/=H)*n+G},quadout:function(n,G,C,H){return-C*(n/=H)*(n-2)+G},quadinout:function(n,G,C,H){if((n/=H/2)<1)return C/2*n*n+G;return-C/2*(--n*(n-2)-1)+G},sinein:function(n,G,C,H){return-C*D(n/H*ea)+C+G},sineout:function(n,G,C,H){return C*l(n/H*ea)+G},sineinout:function(n,G,C,H){return-C/2*(D(Math.PI*n/H)-1)+G}};COG.tweenValue=function(n,G,C,H,x){function t(ha){ha=ha?ha:(new Date).getTime();if(ta+J<
ha){var sa=ha-E,$=C(sa,n,na,H),xa=E+H<=ha;ha=!xa;if(x){sa=x($,xa,sa);ha=typeof sa!="undefined"?sa&&ha:ha}ha&&animFrame(t)}}var E=(new Date).getTime(),ta=0,na=G-n;animFrame(t);return{}};COG.easing=function(n){return U[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(n,G){U[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]=G}})();
(function(){var N=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ea=/^(\d+H)?(\d+M)?(\d+S)?$/,J={8601:function(k){k=k.split("T");var l=null;l=null;var u=0,D=0;N.lastIndex=-1;l=N.exec(k[0]);u+=l[3]?parseInt(l[3].slice(0,-1),10):0;ea.lastIndex=-1;l=ea.exec(k[1]);D+=l[1]?parseInt(l[1].slice(0,-1),10)*3600:0;D+=l[2]?parseInt(l[2].slice(0,-1),10)*60:0;D+=l[3]?parseInt(l[3].slice(0,-1),10):0;return new B(u,D)}},B=COG.Duration=function(k,l){return{days:k?k:0,seconds:l?l:0}};COG.addDuration=function(){for(var k=new B,l=arguments.length;l--;){k.days+=
arguments[l].days;k.seconds+=arguments[l].seconds}if(k.seconds>=86400){k.days+=~~(k.seconds/86400);k.seconds%=86400}return k};COG.formatDuration=function(k){var l,u,D="";if(k.days)D=k.days+" days ";if(k.seconds){k=k.seconds;if(k>=3600){l=~~(k/3600);k-=l*3600}if(k>=60){u=Math.round(k/60);k-=u*60}if(l)D=D+l+(l>1?" hrs ":" hr ")+(u?(u>10?u:"0"+u)+" min ":"");else if(u)D=D+u+" min";else if(k>0)D=D+(k>10?k:"0"+k)+" sec"}return D};COG.parseDuration=function(k,l){var u=l?J[l]:null;if(u)return u(k);COG.Log.warn("Could not find duration parser for specified format: "+
l);return new B}})();COG.ObjectStore=function(){var N={},ea={},J="obj_"+(new Date).getTime(),B=0,k=Object.prototype.hasOwnProperty;return{add:function(l,u){var D;u=u?u:"default";if(l&&l.constructor)if(!k.call(l,"id"))l.id=J+ ++B;D=ea[u]?ea[u]:ea[u]=[];N[l.id]=D.length;D[l.length]=l}}};var CANI={};
(function(N){var ea=[],J=0,B=false,k=N.register=function(l,u){ea.push({section:l,run:u})};N.init=function(l){function u(){if(J<ea.length){var U=ea[J++];D[U.section]||(D[U.section]={});U.run(D[U.section],u)}else{for(U in D)N[U]=D[U];B=true;l&&l(N)}}var D={};if(B&&l)l(N);else{J=0;u()}};k("canvas",function(l,u){function D(){var C,H=U.getContext("2d");H.save();try{H.translate(50,50);H.beginPath();H.rect(0,0,20,20);C=H.isPointInPath(10,10)}finally{H.restore()}return C}var U=document.createElement("canvas"),
n=typeof FlashCanvas!="undefined",G=typeof G_vmlCanvasManager!="undefnined";U.width=200;U.height=200;l.pipTransformed=n||G?false:D();u()})})(CANI);
INTERACT=function(){function N(x){return function(t,E,ta){(ta?ta:x?document.body:document).addEventListener(t,E,false)}}function ea(x){return function(t,E,ta){(ta?ta:x?document.body:document).removeEventListener(t,E,false)}}function J(x,t,E){(E?E:document).attachEvent("on"+x,t)}function B(x,t,E){(E?E:document).detachEvent("on"+x,t)}function k(x,t){return{x:x?x:0,y:t?t:0,count:1}}function l(x,t){C.push(COG.extend({handler:null,checks:{},type:x},t))}function u(x){var t=0,E=0;if(x.offsetParent){do{t+=
x.offsetLeft;E+=x.offsetTop;x=x.offsetParent}while(x)}return{left:t,top:E}}function D(x,t){return{source:x,target:t.target?t.target:t.srcElement}}function U(x,t){for(var E=x.target?x.target:x.srcElement;E&&E!==t&&E.nodeName&&E.nodeName.toUpperCase()!="CANVAS";)E=E.parentNode;return E&&E===t}function n(x,t){return{x:x.x-(t?t.left:0),y:x.y-(t?t.top:0)}}function G(x){if(x.preventDefault){x.preventDefault();x.stopPropagation()}else x.cancelBubble&&x.cancelBubble()}var C=[],H=function(x,t,E){function ta(ba,
oa,ja,Z){var W=0,ka=0,y=0;COG.tweenValue(0,ba,ja,Z,function(R){y=W;W=R});COG.tweenValue(0,oa,ja,Z,function(R){na.trigger("pan",W-y,R-ka);ka=R})}E=COG.extend({binder:null,unbinder:null,observable:null},E);for(var na=E.observable,ha=null,sa=[],$=[],xa,ya,Da={bind:function(){return na.bind.apply(null,arguments)},pannable:function(ba){ha=COG.extend({inertia:true},ba);return Da},unbind:function(){na.unbind();for(var ba=0;ba<sa.length;ba++)sa[ba].unbind();return Da}},Ia=0;Ia<t.length;Ia++)sa.push(t[Ia](x,
na,E));na.bind("pointerDown",function(){$=[];ya=xa=0});na.bind("pointerMove",function(ba,oa,ja,Z){if(ha){$[$.length]={ticks:(new Date).getTime(),x:Z.x,y:Z.y};na.trigger("pan",Z.x,Z.y)}xa+=Z.x?Z.x:0;ya+=Z.y?Z.y:0});na.bind("pointerUp",function(ba,oa,ja){if(Math.abs(xa)>20||Math.abs(ya)>20){if(ha){ja=$.length;var Z,W;oa=0;for(W=$.length;--W>1&&oa<50;)oa+=$[W].ticks-$[W-1].ticks;if(ja-W>1){ba=$[ja-1].x-$[W].x;Z=$[ja-1].y-$[W].y;W=Math.sqrt(ba*ba+Z*Z)|0;if(W>15){ba=$[ja-1].x-$[0].x;Z=$[ja-1].y-$[0].y;
W=Math.sqrt(ba*ba+Z*Z)|0;ja=Math.asin(Z/W);oa=W*500/oa|0;oa=oa>300?300:oa;ta(Math.cos(ba>0?ja:Math.PI-ja)*oa,Math.sin(ja)*oa,COG.easing("sine.out"),500)}}}}else na.trigger("tap",oa,ja)});return Da};l("pointer",{handler:function(x,t,E){function ta(y){if(y.pageX&&y.pageY)return k(y.pageX,y.pageY);else{var R=document.documentElement,fa=document.body;return k(y.clientX+(R&&R.scrollLeft||fa&&fa.scrollLeft||0)-(R&&R.clientLeft||fa&&fa.clientLeft||0),y.clientY+(R&&R.scrollTop||fa&&fa.scrollTop||0)-(R&&R.clientTop||
fa&&fa.clientTop||0))}}function na(y){if(U(y,x))if(ba=xa(y)){var R=ta(y);x.style.cursor="move";G(y);W=R.x;ka=R.y;oa=k(W,ka);t.triggerCustom("pointerDown",D("mouse",y),oa,n(oa,u(x)))}}function ha(y){var R=ta(y);ja=R.x;Z=R.y;if(U(y,x))ya(y,ba?"pointerMove":"pointerHover")}function sa(y){if(ba&&xa(y)){ba=false;if(U(y,x)){x.style.cursor="default";ya(y,"pointerUp")}}}function $(y){if(U(y,x)){var R;y=y||window.event;if(y.detail)R=y.axis===2?-y.detail*Da:0;else{R=y.wheelDeltaY?y.wheelDeltaY:y.wheelDelta;
if(window.opera)R=-R}if(R!==0){var fa=k(ja,Z);t.triggerCustom("zoom",D("mouse",y),fa,n(fa,u(x)),R/Ia,"wheel");G(y);y.returnValue=false}}}function xa(y){y=y||window.event;return(y.which||y.button)==1}function ya(y,R,fa,Ja,Ea){fa=typeof fa!="undefined"?fa:ja;Ja=typeof Ja!="undefined"?Ja:Z;var Q=fa-W,da=Ja-ka,aa=k(fa,Ja);t.triggerCustom(R,D("mouse",y),aa,n(aa,u(x)),k(Q,da));if(typeof Ea=="undefined"||Ea){W=fa;ka=Ja}}E=COG.extend({},E);var Da=120,Ia=Da*8,ba=false,oa,ja,Z,W,ka;E.binder("mousedown",na,
false);E.binder("mousemove",ha,false);E.binder("mouseup",sa,false);E.binder("dblclick",function(y){COG.info("captured double click");if(U(y,x)){var R=ta(y);t.triggerCustom("doubleTap",D("mouse",y),R,n(R,u(x)))}},false);E.binder("mousewheel",$,document);E.binder("DOMMouseScroll",$,document);return{unbind:function(){E.unbinder("mousedown",na,false);E.unbinder("mousemove",ha,false);E.unbinder("mouseup",sa,false);E.unbinder("mousewheel",$,document);E.unbinder("DOMMouseScroll",$,document)}}},checks:{touch:false}});
l("pointer",{handler:function(x,t,E){function ta(Q){if(Q.count<2)return 0;var da=Q.x-Q.next.x;Q=Q.y-Q.next.y;return~~Math.sqrt(da*da+Q*Q)}function na(Q,da,aa){da=da?da:0;aa=aa?aa:0;for(var Ka={x:Q.x-da,y:Q.y-aa,id:Q.id,count:Q.count},S=Ka;Q.next;){Q=Q.next;S=S.next={x:Q.x-da,y:Q.y-aa,id:Q.id}}return Ka}function ha(Q,da){var aa=Q[da?da:"touches"],Ka,S;if(aa.length===0)return null;S=Ka={x:aa[0].pageX,y:aa[0].pageY,id:aa[0].identifier,count:aa.length};for(var Oa=1,La=aa.length;Oa<La;Oa++)S=S.next={x:aa[Oa].pageX,
y:aa[Oa].pageY,id:aa[Oa].identifier};return Ka}function sa(Q){if(U(Q,x)){Z=u(x);var da=ha(Q,"changedTouches"),aa=na(da,Z.left,Z.top);if(!ka){W=ba;t.triggerCustom("pointerDown",D("touch",Q),da,aa)}Ja&&t.triggerCustom("pointerDownMulti",D("touch",Q),da,aa);ka=ha(Q);if(ka.count>1)R=ta(ka);Ea=1;fa=na(ka)}}function $(Q){if(U(Q,x)){Q.preventDefault();y=ha(Q);if(W==ba)W=Math.abs(ka.x-y.x)>Da||Math.abs(ka.y-y.y)>Da?Ia:ba;if(W!=ba){W=y.count>1?ja:oa;if(W==ja)if(ka.count===1){ka=na(y);R=ta(ka)}else{var da=
ta(y);if(Math.abs(R-da)<ya)W=oa;else{var aa;aa=y.x;var Ka=y.next.x,S=y.y,Oa=y.next.y,La=S<Oa?S:Oa;aa={x:(aa<Ka?aa:Ka)+(Math.abs(aa-Ka)>>1),y:La+(Math.abs(S-Oa)>>1)};da=da/R;Ka=da-Ea;t.triggerCustom("zoom",D("touch",Q),aa,n(aa,Z),Ka,"pinch");Ea=da}}W==oa&&t.triggerCustom("pointerMove",D("touch",Q),y,na(y,Z.left,Z.top),k(y.x-fa.x,y.y-fa.y));Ja&&t.triggerCustom("pointerMoveMulti",D("touch",Q),y,na(y,Z.left,Z.top))}fa=na(y)}}function xa(Q){if(U(Q,x)){var da=ha(Q,"changedTouches"),aa=na(da,Z.left,Z.top);
y=ha(Q);if(!y){t.triggerCustom("pointerUp",D("touch",Q),da,aa);ka=null}Ja&&t.triggerCustom("pointerUpMulti",D("touch",Q),da,aa)}}E=COG.extend({detailed:false,inertia:false},E);var ya=20,Da=7,Ia=0,ba=1,oa=2,ja=3,Z,W,ka,y,R,fa,Ja=E.detailed,Ea=1;E.binder("touchstart",sa,false);E.binder("touchmove",$,false);E.binder("touchend",xa,false);COG.info("initialized touch handler");return{unbind:function(){E.unbinder("touchstart",sa,false);E.unbinder("touchmove",$,false);E.unbinder("touchend",xa,false)}}},checks:{touch:true}});
return{register:l,watch:function(x,t,E){t=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},t);capabilities=COG.extend({touch:"ontouchstart"in window},E);if(!t.observable){COG.info("creating observable");t.observable=COG.observable({});globalOpts=t}t.binder=t.isIE?J:N(t.bindToBody);t.unbinder=t.isIE?B:ea(t.bindToBody);E=t.types;for(var ta=capabilities,na=[],ha=C.length;ha--;){var sa=C[ha],$=!E||E.indexOf(sa.type)>=0,xa=true;for(var ya in sa.checks){var Da=
sa.checks[ya];COG.info("checking "+ya+" capability. require: "+Da+", capability = "+ta[ya]);xa=xa&&Da===ta[ya]}if($&&xa)na[na.length]=sa.handler}return new H(x,na,t)}}}();var T5={};
(function(N){function ea(){return(new Date).getTime()}function J(){for(;nb.length>0;){var a=nb.shift();document.location=a}ob=0}function B(a){for(var h=true,d=zb.length;d--;)h=h&&a!=zb[d];return h}function k(a,h){var d=[];for(var c in h)c&&d.push(c+"="+escape(h[c]));return"tile5://"+a+"/"+(d.length>0?"?"+d.join("&"):"")}function l(a,h){B(a)&&COG.info("would push url: "+k(a,h))}function u(a,h){if(B(a)){nb.push(k(a,h));ob||(ob=setTimeout(J,100))}}function D(a){return function(h,d,c){(c?c:a?document.body:
document).addEventListener(h,d,false)}}function U(a){return function(h,d,c){(c?c:a?document.body:document).removeEventListener(h,d,false)}}function n(a,h,d){(d?d:document).attachEvent("on"+a,h)}function G(a,h,d){(d?d:document).detachEvent("on"+a,h)}function C(){Ta={base:{name:"Unknown",bindEvent:D(),unbindEvent:U(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:l,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:n,unbindEvent:G,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:u,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:u},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:u},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:D(true),unbindEvent:U(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:u},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:u}};pb=[Ta.froyo,Ta.android,Ta.ipod,Ta.iphone,Ta.ipad,Ta.ie]}function H(){Ta||C();if(!db){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<pb.length;a++){var h=pb[a];if(h.regex&&h.regex.test(navigator.userAgent)){db=COG.extend({},Ta.base,h);COG.info("PLATFORM DETECTED AS: "+db.name);break}}if(!db){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
db=Ta.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return db}function x(){var a=(new Date).getTime(),h=0;clearTimeout(gb);for(gb=0;h<eb.length;){var d=eb[h],c=ab[d],e=ab[d].image&&(Ab||ab[d].image.complete&&ab[d].image.width>0),m=a-c.start;m=e||m>=Nb;if(e){e=c.image;c=c.callbacks;Bb[d]=e;for(var p=0;p<c.length;p++)c[p](e,true)}if(m){eb.splice(h,1);delete ab[d]}else h++}if(eb.length>0)gb=setTimeout(x,Cb)}function t(){for(var a=0,h=arguments.length;h--;){var d=Ob[arguments[h].toUpperCase()];
if(d)a|=d}return a}function E(a){a=a?a:(new Date).getTime();if(a-Db>Pb){for(var h=hb.splice(0),d=h.length;d--;)h[d](a);Db=a}hb.length&&animFrame(E)}function ta(a){var h=hb.length==0;hb[hb.length]=a;h&&animFrame(E)}function na(a,h,d,c,e){e=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},e);var m=(new Date).getTime(),p=a[h],o=e.autoInvalidate,w=d.length&&c.length&&d.length==c.length?d.length:0,z=Array(w),L=Array(w),O=COG.easing(e.easing),K=e.duration,Y=e.progress,
va=function(qa){var ua=qa-m;qa=m+K<=qa;for(var Ha=a.layer?a.layer.view:null,Ga=w;Ga--;)L[Ga]=O(ua,d[Ga],z[Ga],K);p.apply(a,L);if(o&&Ha)Ha.redraw=true;if(Y){ua=[].concat(qa?c:L);ua.unshift(qa);Y.apply(a,ua)}if(qa){a.animations--;p.apply(a,c);e.complete&&e.complete.apply(a,c)}else ta(va)};if(p&&p.apply&&w>0){K=K?K:DEFAULT_DURATION;for(h=w;h--;)z[h]=c[h]-d[h];a.animations++;ta(va)}}function ha(a,h){var d,c;if(h&&h.width>0){if(!a.imageOffset)a.imageOffset=S.init(-h.width>>1,-h.height>>1);if(!a.bounds){d=
a.xy.x+a.imageOffset.x;c=a.xy.y+a.imageOffset.y;a.bounds=La.init(d,c,d+h.width,c+h.height)}}}function sa(a){Ua.call(this,a)}function $(a,h){h=COG.extend({simplify:false},h);var d=false,c=h.simplify;t("ZOOM");var e=[];h.type=h.fill?"polygon":"line";Ua.call(this,h);COG.extend(this,{animatePath:function(){},prep:function(m){return d?m.path(e):null},resync:function(m){var p,o,w,z,L;m.syncXY(a);e=S.floor(c?S.simplify(a):a);for(var O=e.length;O--;){m=e[O].x;p=e[O].y;z=typeof z=="undefined"||m<z?m:z;L=typeof L==
"undefined"||p<L?p:L;o=typeof o=="undefined"||m>o?m:o;w=typeof w=="undefined"||p>w?p:w}this.updateBounds(La.init(z,L,o,w),true)}});d=a&&a.length>=2}function xa(a,h){h.fill=false;$.call(this,a,h)}function ya(a){function h(w){(this.imageUrl=w)&&Eb(this.imageUrl,function(z,L){p=z;if(L){var O=o.layer?o.layer.view:null;if(O)O.redraw=true}})}a=COG.extend({image:null,imageUrl:null,imageOffset:null},a);var d=null,c=Ua.prototype.updateBounds,e,m,p=a.image;Ua.call(this,a);var o=COG.extend(this,{changeImage:h,
drag:function(w,z,L,O){d||(d=S.init(w.startX-this.xy.x,w.startY-this.xy.y));this.xy.x=z-d.x;this.xy.y=L-d.y;if(O){d=null;if(this.layer)(w=this.layer.view)&&w.syncXY([this.xy],true);this.trigger("dragDrop")}return true},prep:function(w){if(p&&p.width>0){ha(this,p);e=this.xy.x+this.imageOffset.x;m=this.xy.y+this.imageOffset.y;return w.image(p,e,m,p.width,p.height)}},updateBounds:function(w,z){c.call(this,w,z);ha(this,p)}});p||h(this.imageUrl)}function Da(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.imageOffset=
S.invert(a.imageAnchor);ya.call(this,a)}function Ia(a){a=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,validStates:t("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);this.view=null;COG.observable(COG.extend(this,a))}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},
1E3/60)}}();var ba=Math.PI*2,oa=Math.PI/2,ja=Math.abs,Z=Math.ceil,W=Math.min,ka=Math.max,y=Math.pow,R=Math.sqrt,fa=Math.log,Ja=Math.round,Ea=Math.sin,Q=Math.asin,da=Math.cos,aa=Math.atan,Ka=Math.atan2,S=function(){function a(c,e){return d(c.x-e.x,c.y-e.y)}function h(c,e){if(!e)e=c.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var m={edges:Array(e-1),accrued:Array(e-1),total:0},p=0;p<e-1;p++){var o=a(c[p],c[p+1]);m.edges[p]=R(o.x*o.x+o.y*o.y);
m.accrued[p]=m.total+m.edges[p];m.total+=m.edges[p]}return m}function d(c,e){return{x:c?c:0,y:e?e:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var c=0,e=0,m=arguments.length;m--;){c+=arguments[m].x;e+=arguments[m].y}return d(c,e)},absSize:function(c){return ka(ja(c.x),ja(c.y))},copy:function(c){return c?d(c.x,c.y):null},diff:a,distance:function(c,e){return h(c,e).total},edges:h,equals:function(c,e){return c.x===e.x&&c.y===e.y},extendBy:function(c,e,m){var p=da(e)*
m|0;e=Ea(e)*m|0;return d(c.x-p,c.y-e)},floor:function(c){for(var e=Array(c.length),m=c.length;m--;)e[m]=d(~~c[m].x,~~c[m].y);return e},getRect:function(c){for(var e,m,p,o,w=c.length;w--;){var z=c[w];e=typeof e==="undefined"||z.x<e?z.x:e;m=typeof m==="undefined"||z.y<m?z.y:m;p=typeof p==="undefined"||z.x>p?z.x:p;o=typeof o==="undefined"||z.y>o?z.y:o}return La.init(e,m,p,o)},init:d,invert:function(c){return d(-c.x,-c.y)},min:function(c,e){return d(c.x<e.x?c.x:e.x,c.y<e.y?c.y:e.y)},max:function(c,e){return d(c.x>
e.x?c.x:e.x,c.y>e.y?c.y:e.y)},offset:function(c,e,m){return d(c.x+e,c.y+(m?m:e))},scale:function(c,e){return d(c.x/e|0,c.y/e|0)},simplify:function(c,e){if(!c)return null;e=e?e:S.VECTOR_SIMPLIFICATION;for(var m=[],p=null,o=c.length;o--;){var w=c[o];if(include=!p||o===0||ja(w.x-p.x)+ja(w.y-p.y)>e){m.unshift(w);p=w}}return m},theta:function(c,e,m){m=Q((c.y-e.y)/m);return c.x>e.x?m:Math.PI-m},toString:function(c){return c?c.x+", "+c.y:""}}}(),Oa=function(){return{dotProduct:function(a,h){return a.x*h.x+
a.y*h.y}}}(),La=function(){function a(d){return h(d.x1,d.y1,d.x2,d.y2)}function h(d,c,e,m){d=d?d:0;c=c?c:0;e=typeof e!=="undefined"?e:d;m=typeof m!=="undefined "?m:m;return{x1:d,y1:c,x2:e,y2:m,width:e-d,height:m-c}}return{center:function(d){return S.init(d.x1+(d.width>>1),d.y1+(d.height>>1))},copy:a,diagonalSize:function(d){return R(d.width*d.width+d.height*d.height)},fromCenter:function(d,c,e,m){e=e>>1;m=m>>1;return h(d-e,c-m,d+e,c+m)},init:h,intersect:function(d,c){var e=ka(d.x1,c.x1),m=ka(d.y1,
c.y1),p=W(d.x2,c.x2),o=W(d.y2,c.y2);e=h(e,m,p,o);return e.width>0&&e.height>0?e:null},toString:function(d){return d?"["+d.x1+", "+d.y1+", "+d.x2+", "+d.y2+"]":""},union:function(d,c){if(d.width===0||d.height===0)return a(c);else if(c.width===0||c.height===0)return a(d);else{var e=W(d.x1,c.x1),m=W(d.y1,c.y1),p=ka(d.x2,c.x2),o=ka(d.y2,c.y2);e=h(e,m,p,o);return e.width>0&&e.height>0?e:null}}}}(),Qb=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return S.init(a.width>>
1,a.height>>1)},getSize:function(a){return R(y(a.width,2)+y(a.height,2))},init:function(a,h){a=a?a:0;return{width:a,height:h?h:a}}}}();Hits=function(){return{diffHits:function(a,h){var d=[],c={},e;for(e=h.length;e--;)c[h[e].target.id]=true;for(e=a.length;e--;)c[a[e].target.id]||(d[d.length]=a[e]);return d},init:function(a,h,d,c){return{type:a,x:c.x|0,y:c.y|0,elements:[],absXY:h,relXY:d}},initHit:function(a,h,d){return{type:a,target:h,drag:d}},triggerEvent:function(a,h,d,c){h.triggerCustom(a.type+
(d?d:"Hit"),{hitType:a.type},c?c:a.elements,a.absXY,a.relXY,S.init(a.x,a.y))}}}();var Ta=null,pb=[],db=null,ob=0,nb=[],zb=["view.wake","tile.loaded"],Cb=100,Nb=3E4,Bb={},Rb=0;(new Date).getTime();var ab={},eb=[],Ab=typeof FlashCanvas!="undefined",gb=0,Eb=T5.getImage=function(a,h){var d=a&&h?Bb[a]:null;if(d&&d&&(Ab||d.complete&&d.width>0))h(d);else{if(d=ab[a])d.callbacks.push(h);else{d=new Image;d.id="_ldimg"+ ++Rb;ab[a]={start:(new Date).getTime(),image:d,callbacks:[h]};d.src=a;eb[eb.length]=a}gb||
(gb=setTimeout(x,Cb))}},Sb=T5.newCanvas=function(a,h){var d=document.createElement("canvas");d.width=a?a:0;d.height=h?h:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(d);FlashCanvas.initElement(d)}typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(d);return d},Fb=function(){var a={};return{init:function(h,d){var c=a[h];if(!c)throw Error("Unable to locate requested generator: "+h);return new c(d)},register:function(h,d){a[h]=d}}}(),Tb=function(){return{applyStyle:function(){},
checkSize:function(){},hitTest:function(){return false},restore:function(){},save:function(){}}},Gb={},kb=N.registerRenderer=function(a,h){Gb[a]=h},qb=N.attachRenderer=function(a,h,d,c){if(a=Gb[a])return new a(h,d,c)};kb("canvas",function(a,h,d){function c(z,L,O){if(z.image)o.drawImage(z.image,L,O);else if(!z.loading){z.loading=true;Eb(z.url,function(K){z.image=K;z.loading=false;o.drawImage(K,z.screenX,z.screenY)})}}d=COG.extend({},d);var e,m,p,o,w;if(h){e=a.width=h.offsetWidth;m=a.height=h.offsetHeight;
p=Sb(e,m);o=null;h.appendChild(p)}return COG.extend(new Tb(a,h,d),{interactTarget:p,arc:function(z,L,O,K,Y){o.beginPath();o.arc(z-w.x1,L-w.y1,O,K,Y,false);return{draw:function(){o.fill();o.stroke()}}},drawTiles:function(z){for(var L,O,K=w.x1,Y=w.y1,va=K-256,qa=Y-256,ua=K+e,Ha=Y+m,Ga,Ma,Ya=z.length;Ya--;){L=z[Ya];O=L.x>=va&&L.x<=ua&&L.y>=qa&&L.y<=Ha;Ga=L.screenX=L.x-K;Ma=L.screenY=L.y-Y;O&&c(L,Ga,Ma)}},image:function(z,L,O,K,Y){var va=L-w.x1,qa=O-w.y1;o.beginPath();o.rect(va,qa,K,Y);return{draw:function(){o.drawImage(z,
va,qa,K,Y)}}},prepare:function(z){var L,O=false;L=a.getOffset();var K=L.x-(e>>1),Y=L.y-(m>>1);if(o)o.restore();else o=p.getContext("2d");for(L=z.length;L--;)O=O||z[L].clip;w=La.init(K,Y,K+e,Y+m);w.scaleFactor=a.getScaleFactor();if(o){O||o.clearRect(0,0,e,m);o.save()}o.globalCompositeOperation="source-over";return o},path:function(z){var L=true,O=w.x1,K=w.y1;o.beginPath();for(var Y=z.length;Y--;){var va=z[Y].x-O,qa=z[Y].y-K;if(L){o.moveTo(va,qa);L=false}else o.lineTo(va,qa)}return{draw:function(){o.fill();
o.stroke()}}},getDimensions:function(){return{width:e,height:m}},getViewport:function(){return w}})});kb("domvas",function(a,h,d){var c=typeof h.style["-webkit-transform"]!="undefined",e=null,m=COG.extend(qb("canvas",a,h,d),{drawTiles:function(p){var o,w;o=m.getViewport();for(var z,L=o.x1,O=o.y1,K=L-256,Y=O-256,va=o.x2,qa=o.y2,ua,Ha,Ga=p.length;Ga--;){o=p[Ga];w=o.image;z=o.x>=K&&o.x<=va&&o.y>=Y&&o.y<=qa;ua=o.x-L;Ha=o.y-O;if(!w){w=o.image=new Image;w.src=o.url;e.appendChild(w);w.style.cssText="-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;"}if(c)w.style["-webkit-transform"]=
"translate3d("+ua+"px, "+Ha+"px, 0px)";else{w.style.left=ua+"px";w.style.top=Ha+"px"}w.style.display=z?"block":"none"}}});e=document.createElement("div");e.id=COG.objId("domImages");e.style.cssText=COG.formatStr("position: absolute; overflow: hidden; width: {0}px; height: {1}px; background: #ddd; z-index: -1;",h.offsetWidth,h.offsetHeight);h.insertBefore(e,m.interactTarget);return m});kb=function(){function a(p,o){e[p]=d(o);return p}function h(p){for(var o in p)a(o,p[o])}function d(p){function o(O){var K=
p[O];typeof K!=="undefined"&&z.push(function(Y){Y[O]=K})}function w(){z=[];for(var O in p)o(O)}p=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},p);var z=[],L={applyToContext:function(O){for(var K=z.length;K--;)z[K](O)},update:function(O,K){p[O]=K;w()}};w();return L}var c={},e={},m={apply:function(p,o){var w=p&&p.canvas?c[p.canvas.id]:null;c[p.canvas.id]=o;(e[o]?
e[o]:e.basic).applyToContext(p);return w},define:a,defineMany:h,get:function(p){return e[p]},init:d,load:function(p){COG.jsonp(p,function(o){h(o)})}};h({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});return m}();var Ob={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Lb=function(a){function h(s,v,I){Na||fb(wa-v,g-I)}function d(s,v,I,ga){Ya(W(ka(za+
y(2,ga)-1,0.5),2))}function c(){var s=fa(za)/Math.LN2|0;if(s!==0){za=y(2,s);ra(ib+s,Hb,Ib)}la.redraw=true}function e(s){s||(s=S.init(F,X));Aa=S.init(wa,g);Ca=S.offset(s,wa,g);Hb=Ca.x;Ib=Ca.y}function m(s,v,I){Pa("doubleTap",v,I,S.init(I.x,I.y));a.scalable&&Ya(2,I,a.zoomEasing,null,a.zoomDuration)}function p(s,v,I){Na=null;ua("down",v,I)}function o(s,v,I){ua("hover",v,I)}function w(s,v,I){va(v,I,false)}function z(s,v,I){va(v,I,true)}function L(){clearTimeout(Ba);Ba=setTimeout(function(){renderer.checkSize()},
250)}function O(s,v,I){ua("tap",v,I);Pa("tap",v,I,S.init(I.x,I.y))}function K(s,v){v.id=s;v.added=ea();v.view=la;v.trigger("parentChange",la,bb,rb);ma.push(v);ma.sort(function(I,ga){var pa=ga.zindex-I.zindex;if(pa===0)pa=ga.added-I.added;return pa});Qa=ma.length;return v}function Y(){Fa&&Fa.unbind();if(renderer){Fa=INTERACT.watch(renderer.interactTarget);a.pannable&&Fa.pannable().bind("pan",h);if(a.scalable){Fa.bind("zoom",d);Fa.bind("doubleTap",m)}Fa.bind("pointerDown",p);Fa.bind("pointerMove",w);
Fa.bind("pointerUp",z);a.captureHover&&Fa.bind("pointerHover",o);Fa.bind("tap",O)}}function va(s,v,I){if(Na){s=S.init(v.x,v.y);if(Na.drag.call(Na.target,Na,s.x,s.y,I))la.redraw=true;if(I)Na=null}}function qa(s){var v;v=false;s=s?s:(new Date).getTime();if(v=s-Va>Ub){la.trigger("enterFrame",s,sb++);s-ca>tb&&Ma();Va=s}if(v&&la.redraw){v=wa!==j||g!==q;Wa=Jb|(za!==1?Kb:0)|(v?ub:0)|(vb?wb:0);T=(v=(Wa&(Kb|ub))!==0)&&(Wa&wb)===0;if(renderer.prepare(ma,Wa,s,V)){v=renderer.getViewport();for(var I=Qa;I--;){Wa|=
ma[I].animated?wb:0;ma[I].cycle(s,v,Wa)}for(I=ma.length;I--;){var ga=ma[I];if(ga.shouldDraw(Wa,v)){var pa=ga.style?renderer.applyStyle(ga.style):null;ga.draw(renderer,v,Wa,la,s,V);pa&&renderer.applyStyle(pa)}}}if(V){s=V?V.elements:[];if(ia&&ia.type==="hover"){v=Hits.diffHits(ia.elements,s);v.length>0&&Hits.triggerEvent(ia,la,"Out",v)}if(s.length>0){I=V.x;ga=V.y;for(v=s.length;v--;){pa=s[v];var Za=I,cb=ga,Xa=pa&&pa.drag&&(!pa.canDrag||pa.canDrag(pa,Za,cb));if(Xa){Na=pa;Na.startX=Za;Na.startY=cb}if(Xa)break}Hits.triggerEvent(V,
la)}ia=s.length>0?COG.extend({},V):null;V=null}j=wa;q=g;la.redraw=false}animFrame(qa)}function ua(s,v,I){V=Hits.init(s,v,I,S.init(I.x,I.y));for(s=Qa;s--;)$a=$a||(ma[s].hitGuess?ma[s].hitGuess(V.x,V.y,Wa,la):false);if($a)la.redraw=true}function Ha(){la.redraw=true}function Ga(){return renderer?renderer.getViewport():null}function Ma(){var s=renderer?renderer.getViewport():null;if(s){if(r||b)if(s){var v=f?wa+F:wa,I=i?g+X:g,ga=s.width,pa=s.height;if(r&&r>ga)if(v+ga>r)wa=f?wa:r-ga;else if(v<0)wa=f?wa:
0;if(b&&b>pa)if(I+pa>b)g=i?g:b-pa;else if(I<0)g=i?g:0}ca=(new Date).getTime();Pa("refresh",la,s);la.redraw=true}}function Ya(s,v,I,ga,pa){if(I)COG.tweenValue(za,s,I,pa,function(Za,cb){za=Za;if(cb){var Xa=Ja(fa(za)/Math.LN2);za=y(2,Xa);ga&&ga()}e(v);c()});else{za=s;e(v);c()}return la}function ra(s,v,I){s=ka(a.minZoom,W(a.maxZoom,s));if(s!==ib){var ga=y(2,s-ib),pa=F/ga|0,Za=X/ga|0;ib=s;fb(((v?v:wa+F)-pa)*ga,((I?I:g+X)-Za)*ga);j=wa;q=g;Pa("zoomLevelChange",s);za=1;Ma()}}function Pa(){for(var s=la.trigger.apply(null,
arguments).cancel,v=ma.length;v--;)s=ma[v].trigger.apply(null,arguments).cancel||s;return!s}function fb(s,v,I,ga,pa){function Za(){cb+=1;if(cb>=2){vb=false;pa&&pa()}}var cb=0,Xa=M?S.offset(M,-F,-X):null,jb=P?S.offset(P,-F,-X):null;if(Xa){s=s<Xa.x?Xa.x:s;v=v<Xa.y?Xa.y:v}if(jb){s=s>jb.x?jb.x:s;v=v>jb.y?jb.y:v}if(I){if((Wa&ub)===0){COG.tweenValue(wa,s,I,ga,function(xb,yb){wa=xb|0;(yb?Za:Ha)();return!T});COG.tweenValue(g,v,I,ga,function(xb,yb){g=xb|0;(yb?Za:Ha)();return!T});vb=true}}else{wa=s|0;g=v|0;
la.redraw=true;pa&&pa()}}a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,renderer:"domvas",zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},a);var Ra={},ma=[],Qa=0,bb=document.getElementById(a.container),
Na=null,sb=0,rb=null,lb=typeof window.attachEvent!="undefined",$a=false,tb=a.minRefresh,wa=0,g=0,j=0,q=0,r=null,b=null,f=false,i=false,A=1,F=0,X=0,V=null,Aa=null,Ca=null,T=false,M=null,P=null,ca=0,ia=null,Ba=0,za=1,Va=0,Fa=null,vb=false,Ub=1E3/a.fps|0,Hb,Ib,ib=a.zoomLevel,Jb=t("ACTIVE"),ub=t("PAN"),Kb=t("ZOOM"),wb=t("ANIMATING"),Wa=Jb,la={id:a.id,deviceScaling:A,fastDraw:a.fastDraw||H().requireFastDraw,detach:function(){Fa&&Fa.unbind()},eachLayer:function(s){for(var v=Qa;v--;)s(ma[v])},getLayer:function(s){for(var v=
0;v<Qa;v++)if(ma[v].id===s)return ma[v];return null},getZoomLevel:function(){return ib},setLayer:function(s,v){for(var I=0;I<Qa;I++)if(ma[I].id===s){ma.splice(I,1);break}if(v){K(s,v);v.trigger("refresh",la,Ga())}la.redraw=true;return v},invalidate:Ha,refresh:Ma,resetScale:function(){za=1},scale:Ya,setZoomLevel:ra,syncXY:function(){},triggerAll:Pa,removeLayer:function(s){a:{for(var v=Qa;v--;)if(ma[v].id===s){s=v;break a}s=-1}if(s>=0&&s<Qa){la.trigger("layerRemoved",ma[s]);ma.splice(s,1);la.redraw=
true}Qa=ma.length},getOffset:function(){return S.init(wa,g)},getScaleFactor:function(){return za},setMaxOffset:function(s,v,I,ga){r=s;b=v;f=typeof I!="undefined"?I:false;i=typeof ga!="undefined"?ga:false},getViewport:Ga,updateOffset:fb,pan:function(s,v,I,ga,pa){fb(wa+s,g+v,I,ga,pa)}};A=H().getScaling();COG.observable(la);la.bind("resync",function(){P=M=null});COG.configurable(la,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(a,
null,{container:function(s,v){bb=document.getElementById(v);renderer=qb(a.renderer,la,bb);Y()},inertia:Y,captureHover:Y,scalable:Y,pannable:Y}),true);CANI.init(function(s){la.markers=K("markers",new mb({zindex:20}));Ra=s;renderer=qb(a.renderer,la,bb);Y();lb?window.attachEvent("onresize",L):window.addEventListener("resize",L,false)});animFrame(qa);return la},Ua=function(a){a=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape"},
a);COG.extend(this,a);this.id=COG.objId(this.type);this.view=this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};Ua.prototype={constructor:Ua,animate:function(a,h,d,c){na(this,a,h,d,c)},drag:null,draw:function(a){this.fill&&a.fill();this.stroke&&a.stroke()},prep:function(){},resync:function(a){if(this.xy){a.syncXY([this.xy]);this.size&&this.updateBounds(La.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},rotate:function(a){this.rotation=
a},scale:function(a){this.scaling=a},translate:function(a,h){this.translateX=a;this.translateY=h},updateBounds:function(a,h){this.bounds=a;if(h)this.xy=La.center(this.bounds)}};var Pb=1E3/60|0,hb=[],Db=0;sa.prototype=COG.extend(Ua.prototype,{constructor:sa,prep:function(a){return a.arc(this.xy.x,this.xy.y,this.size>>1,0,Math.PI*2)}});$.prototype=COG.extend({},Ua.prototype,{constructor:$});xa.prototype=COG.extend({},$.prototype);ya.prototype=COG.extend({},Ua.prototype,{constructor:ya});Da.prototype=
COG.extend({},ya.prototype,{constructor:Da});Ia.prototype={constructor:Ia,shouldDraw:function(a){return(a&this.validStates)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null};var Mb=function(a){a=COG.extend({zindex:10},a);var h=[],d=CANI.canvas.pipTransformed,c=COG.extend(new Ia(a),{draw:function(e,m,p,o,w,z){o=m.x1;m=m.y1;w=z?d?z.x-o:z.relXY.x:0;for(var L=z?d?z.y-m:z.relXY.y:0,O=h.length;O--;){var K=h[O],Y=K.xy.x,va=K.xy.y,qa=K.style||c.style,ua=K.scaling!==1||K.rotatation||K.translateX||
K.translateY;if(drawData=K.prep(e,ua?Y:o,ua?va:m,p)){if(z&&e.hitTest(drawData,w,L)){z.elements.push(Hits.initHit(K.type,K,K.draggable?K.drag:null));Y=z.type+"Style";qa=K[Y]||c[Y]||qa}K=qa?e.applyStyle(qa):null;drawData.draw(o,m,p);K&&e.applyStyle(K)}}},getDrawables:function(){return[]},hitGuess:function(e,m){for(var p=false,o=h.length;!p&&o--;){var w=h[o];if(!(p=p))p=(w=w.bounds)&&e>=w.x1&&e<=w.x2&&m>=w.y1&&m<=w.y2;p=p}return p}});c.bind("refresh",function(e,m,p){h=c.getDrawables(m,p)});return c},
mb=function(a){function h(m){for(var p=c.length;p--;)c[p].resync(m);c.sort(function(o,w){var z=w.xy.y-o.xy.y;return z!=0?z:w.xy.x-o.xy.y});m.redraw=true}function d(m,p){h(p)}a=COG.extend({zindex:10},a);var c=[],e=COG.extend(new Mb(a),{add:function(m,p){if(m){m.layer=e;var o=e.view;if(o){m.resync(o);o.redraw=true}if(p)c.unshift(m);else c[c.length]=m}},clear:function(){c=[]},find:function(){return[].concat(c)},getDrawables:function(){return c}});e.bind("parentChange",d);e.bind("resync",d);return e};
COG.extend(N,{ex:COG.extend,ticks:ea,getConfig:H,userMessage:function(a,h,d){N.trigger("userMessage",a,h,d)},XY:S,XYRect:La,Dimensions:Qb,Vector:Oa,Hits:Hits,Generator:Fb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:kb,viewState:t,View:Lb,ViewLayer:Ia,ImageLayer:function(a,h){function d(o,w){var z=e?Math.abs(e.x1-w.x1)+Math.abs(e.y1-w.y1):0;if(c&&(!e||z>256))c(o,w,function(L){e=La.copy(w);m=[].concat(L)})}h=COG.extend({imageLoadArgs:{}},h);var c=a?Fb.init(a,h).run:
null,e=null,m=[],p=COG.extend(new Ia(h),{draw:function(o){o.drawTiles(m)}});p.bind("refresh",function(o,w,z){d(w,z)});return p},ImageGenerator:function(a){a=COG.extend({relative:false,padding:2},a);a={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(a);return a},Drawable:Ua,Marker:sa,Poly:$,Line:xa,ImageDrawable:ya,ImageMarker:Da,DrawLayer:Mb,ShapeLayer:mb});COG.observable(N);var Sa=N.Geo=function(){function a(g){for(var j=null,q=1;!j&&q<arguments.length;q++)j=
m(g,arguments[q]);j=j?j:m(g);if(!j)throw Error("Unable to find GEO engine with "+g+" capability");return j}function h(g){g=parseFloat(g)*O;g=Ea(g);var j=ua*g;return fa((1+g)/(1-g)*y((1-j)/(1+j),ua))/2}function d(g){return parseFloat(g)*O}function c(g){g=y(Math.E,-g);for(var j=oa-2*aa(g),q=p(j,g),r=0;r<Ga&&ja(j-q)>Ha;){j=q;q=p(j,g);r++}return q*K}function e(g){return g%360*K}function m(g,j){var q=null;for(var r in ma)if(j){if(r==j&&ma[r][g]){q=ma[r];break}}else if(ma[r][g]){q=ma[r];break}return q}
function p(g,j){var q=ua*Ea(g);return oa-2*aa(j*y((1-q)/(1+q),ua/2))}function o(g,j,q,r){j=w(j);g.add(r(j,q));return j.length}function w(g){var j=g?g.length:0,q=Array(j);for(j=j;j--;)q[j]=Sa.Position.init(g[j][1],g[j][0]);return Sa.Position.vectorize(q,lb)}function z(g,j,q){return new wa(g,j,q)}var L=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],O=Math.PI/180,K=180/Math.PI,Y=oa,va=-Y,qa=-ba,ua=0.08181919084262157,Ha=1.0E-7,Ga=12,Ma=null,Ya={RD:"ROAD",
ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ra=function(){function g(b){return b?q(b.lat,b.lon):null}function j(b){return!b||b.lat===0&&b.lon===0}function q(b,f){return{lat:parseFloat(b?b:0),lon:parseFloat(f?f:0)}}function r(b){if(b)if(typeof b.lat!=="undefined")return g(b);else{if(b.split)for(var f=[" ",","],i=0;i<f.length;i++){var A=b.split(f[i]);if(A.length===2)return q(A[0],A[1])}}else return q();return null}return{calcDistance:function(b,f){if(j(b)||
j(f))return 0;var i=(f.lat-b.lat)*O>>1,A=(f.lon-b.lon)*O>>1;i=Ea(i)*Ea(i)+da(b.lat*O)*da(f.lat*O)*Ea(A)*Ea(A);return 6371*2*Ka(R(i),R(1-i))},copy:g,empty:j,equal:function(b,f){return b&&f&&b.lat==f.lat&&b.lon==f.lon},fromMercatorPixels:function(b,f){return q(c(f),e(b))},generalize:function(b,f,i){var A=b.length,F=[],X=null;i||(i=250);i/=1E3;COG.info("generalizing positions, must include "+f.length+" positions");for(var V=A;V--;)if(V===0)F.unshift(b[V]);else{var Aa=!X||ra.inArray(b[V],f)?i:ra.calcDistance(X,
b[V]);if(b[V]&&Aa>=i){F.unshift(b[V]);X=b[V]}}COG.info("generalized "+A+" positions into "+F.length+" positions");return F},inArray:function(b,f){for(var i=ra.equal,A=f.length;A--;)if(i(b,f[A]))return true;return false},inBounds:function(b,f){var i=!(ra.empty(b)||ra.empty(f));return i=(i=i&&b.lat>=f.min.lat&&b.lat<=f.max.lat)&&b.lon>=f.min.lon&&b.lon<=f.max.lon},init:q,offset:function(b,f,i){var A=b.lat*O;b=b.lon*O;f=A+f/6371;i=Q(Ea(i/6371)/da(A));i=b+i;f=(f+oa)%Math.PI-oa;i%=ba;return q(f*K,i*K)},
parse:r,parseArray:function(b){var f=b.length,i=Array(f);for(f=f;f--;)i[f]=r(b[f]);return i},toMercatorPixels:function(b){return T5.XY.init(d(b.lon),h(b.lat))},toString:function(b){return b?b.lat+" "+b.lon:""},vectorize:function(b,f){function i(){for(var V=0,Aa=f.chunkSize,Ca=A;Ca--;){F[Ca]=T5.GeoXY.init(b[Ca]);V+=1;if(V>Aa)break}A=Ca;if(A<=0)f.callback&&f.callback(F);else animFrame(i)}var A=b.length,F=Array(A);f=COG.extend({chunkSize:500,async:true,callback:null},f);if(!f.async){for(var X=A;X--;)F[X]=
T5.GeoXY.init(b[X]);return F}animFrame(i);return null}}}(),Pa=function(){function g(b,f,i){var A=T5.XY.init(0,f.lat-b.lat);if(typeof i==="undefined")i=true;A.x=i&&b.lon>f.lon?360-b.lon+f.lon:f.lon-b.lon;return A}function j(b,f){return Pa.init(ra.init(b.min.lat-f,b.min.lon-f%360),ra.init(b.max.lat+f,b.max.lon+f%360))}function q(b){var f=g(b.min,b.max);return ra.init(b.min.lat+(f.y>>1),b.min.lon+(f.x>>1))}function r(b,f){return{min:ra.parse(b),max:ra.parse(f)}}return{calcSize:g,createBoundsFromCenter:function(b,
f){var i=f/6371,A=b.lat*O,F=b.lon*O,X=A-i,V=A+i;if(X>va&&V<Y){A=Q(Ea(i)/da(A));i=(F-A)%ba;F=(F+A)%ba}else{X=ka(X,va);V=W(V,Y);i=qa;F=ba}return Pa.init(ra.init(X*K,i*K),ra.init(V*K,F*K))},expand:j,forPositions:function(b,f){var i=null,A=T5.ticks();f||(f="auto");for(var F=b.length;F--;)if(i){var X=g(i.min,b[F],false),V=g(b[F],i.max,false);if(X.x<0)i.min.lon=b[F].lon;if(X.y<0)i.min.lat=b[F].lat;if(V.x<0)i.max.lon=b[F].lon;if(V.y<0)i.max.lat=b[F].lat}else i=r(b[F],b[F]);if(f){if(f=="auto"){F=g(i.min,
i.max);f=ka(F.x,F.y)*0.3}i=j(i,f)}COG.trace("calculated bounds for "+b.length+" positions",A);return i},getCenter:q,getGeoHash:function(b){var f=T5.Geo.GeoHash.encode(b.min.lat,b.min.lon);b=T5.Geo.GeoHash.encode(b.max.lat,b.max.lon);COG.info("min hash = "+f+", max hash = "+b)},getZoomLevel:function(b,f){var i=q(b);i=W(Ja(ja(i.lat)*0.05),L.length);var A=L[i],F=g(b.min,b.max);i=Z(fa(L[3]*f.height/F.y)/fa(2));A=Z(fa(A*f.width/F.x)/fa(2));return W(isNaN(i)?1E3:i,isNaN(A)?1E3:A)},init:r,isEmpty:function(b){return!b||
ra.empty(b.min)||ra.empty(b.max)},toString:function(b){return"min: "+ra.toString(b.min)+", max: "+ra.toString(b.max)}}}(),fb=function(){var g=/^(\d+).*$/,j=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(q,r){g.lastIndex=-1;if(g.test(q))for(var b=q.replace(g,"$1"),f=r.split(","),i=0;i<f.length;i++){j.lastIndex=-1;if(j.test(f[i])){var A=j.exec(f[i]);if(b>=parseInt(A[1],10)&&b<=parseInt(A[2],10))return true}else if(b==f[i])return true}return false},normalize:function(q){if(!q)return"";q=q.toUpperCase();
if(!Ma){var r=[];for(var b in Ya)r.push(b);Ma=RegExp("(\\s)("+r.join("|")+")(\\s|$)","i")}Ma.lastIndex=-1;if(r=Ma.exec(q))q=q.replace(Ma,"$1"+Ya[r[2]]);return q},toString:function(q){return q.streetDetails+" "+q.location}}}(),Ra=N.GeoXY=function(){function g(r,b){if(r.length){for(var f,i,A,F,X=r.length;X--;){g(r[X],b);f=typeof f==="undefined"||r.x<f?r.x:f;i=typeof i==="undefined"||r.y<i?r.y:i;A=typeof A==="undefined"||r.x>A?r.x:A;F=typeof F==="undefined"||r.y>F?r.y:F}return La.init(f,i,F,F)}else if(r.mercXY){f=
r.mercXY;r.x=(f.x+Math.PI)/b|0;r.y=(Math.PI-f.y)/b|0;r.rpp=b}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return r}function j(r,b){if(r.length)for(var f=r.length;f--;)j(r[f],b);else{r.mercXY=S.init(r.x*b-Math.PI,Math.PI-r.y*b);r.pos=ra.fromMercatorPixels(r.mercXY.x,r.mercXY.y)}return r}function q(r,b,f){r.pos=b;r.mercXY=ra.toMercatorPixels(b);(f=typeof f!=="undefined"?f:r.rpp)&&g(r,f)}return{init:function(r,b){var f=S.init();q(f,r,b);return f},sync:g,syncPos:j,toPos:function(r,
b){b=b?b:_self.rpp;return ra.fromMercatorPixels(r.x*b-Math.PI,Math.PI-r.y*b)},updatePos:q}}(),ma={},Qa=function(){return{bestResults:function(g,j){j||(j=20);for(var q=g.length>0?g[0]:null,r=[],b=0;b<g.length;b++)if(q&&g[b]&&q.matchWeight-g[b].matchWeight<=j)r.push(g[b]);else break;return r}}}(),bb=function(g){g=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},g);return COG.extend(g,{toString:function(){return g.caption+(g.matchWeight?" ("+g.matchWeight+")":"")}})},Na=
function(){function g(b,f){var i=new T5.ShapeLayer;f.geometry&&ra.vectorize(f.geometry,{callback:function(A){i.add(new T5.Line(A,{style:"waypoints",simplify:true}));b.setLayer("route",i)}})}function j(b){for(var f=q.Unknown,i=r,A=0;A<i.length;A++){i[A].regex.lastIndex=-1;var F=i[A].regex.exec(b);if(F){f=i[A].customCheck?i[A].customCheck(b,F):i[A].turnType;break}}return f}var q={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",
TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},r=function(){var b=[];b.push({regex:/continue/i,turnType:q.Continue});b.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(f,i){return/bear/i.test(i[1])?q.TurnLeftSlight:q.TurnLeft}});b.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(f,
i){return/bear/i.test(i[1])?q.TurnRightSlight:q.TurnRight}});b.push({regex:/enter\s(roundabout|rotaty)/i,turnType:q.EnterRoundabout});b.push({regex:/take.*?ramp/i,turnType:q.Ramp});b.push({regex:/take.*?exit/i,turnType:q.RampExit});b.push({regex:/make(.*?)u\-turn/i,customCheck:function(f,i){return/right/i.test(i[1])?q.UTurnRight:q.UTurnLeft}});b.push({regex:/proceed/i,turnType:q.Start});b.push({regex:/arrive/i,turnType:q.Arrive});b.push({regex:/fell\sthrough/i,turnType:q.Merge});return b}();return{calculate:function(b){b=
COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},b);var f=a("route");f&&f.route(b,function(i){if(b.generalize)i.geometry=ra.generalize(i.geometry,i.getInstructionPositions());if(b.map){g(b.map,i);b.autoFit&&b.map.gotoBounds(i.boundingBox)}b.success&&b.success(i)})},createMapOverlay:g,parseTurnType:j,TurnType:q,Instruction:function(b){var f=b=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},b),
i=b.description;i=i.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");f.description=i;if(!b.turnType)b.turnType=j(b.description);return b},RouteData:function(b){b=COG.extend({geometry:[],instructions:[],boundingBox:null},b);if(!b.boundingBox)b.boundingBox=Pa.forPositions(b.geometry);return COG.extend({getInstructionPositions:function(){for(var f=[],i=0;i<b.instructions.length;i++)b.instructions[i].position&&f.push(b.instructions[i].position);return f}},b)}}}(),sb="featurecollection",rb="feature",lb={async:false},
$a={processor:null,group:"shapes",layerClass:mb},tb={point:COG.extend({},$a,{processor:function(g,j,q,r){j=w([j.coordinates],lb);if(j.length>0)if(q=r.marker(j[0],q)){g.add(q);return j.length}},group:"markers",layerClass:mb}),linestring:COG.extend({},$a,{processor:function(g,j,q,r){j=w(j&&j.coordinates?j.coordinates:[]);return o(g,j,q,r.line)}}),multilinestring:COG.extend({},$a,{processor:function(g,j,q,r){j=j&&j.coordinates?j.coordinates:[];for(var b=0,f=j.length;f--;)b+=o(g,j[f],q,r.line);return b}}),
polygon:COG.extend({},$a,{processor:function(g,j,q,r){j=j&&j.coordinates?j.coordinates:[];if(j.length>0)return o(g,j[0],q,r.poly);return 0}}),multipolygon:COG.extend({},$a,{processor:function(g,j,q,r){j=j&&j.coordinates?j.coordinates:[];for(var b=0,f=0;f<j.length;f++)b+=o(g,j[f][0],q,r.poly);return b}})},wa=function(g,j,q,r){function b(P,ca){var ia=P.processor,Ba=X+P.group,za=COG.extend({},P,q,{properties:ca.properties});if(ia){var Va=M[Ba];if(!Va){Va=new P.layerClass({id:Ba});M[Ba]=Va}globalLayers=
M;return ia(Va,ca.data,za,r)}return 0}function f(P,ca){var ia=P&&P.type?P.type.toLowerCase():null;return ia&&ia===rb?f(P.geometry,P.properties):{type:ia,isCollection:ia?ia===sb:false,definition:tb[ia],data:P,properties:ca?ca:P.properties}}function i(P){var ca=0,ia=COG.extend({},q),Ba=V;P=P?P:(new Date).getTime();if(!Ca){for(;Ba<Aa;Ba++){P=f(F?F(g[Ba]):g[Ba]);var za=null;if(P.isCollection){ia.layerPrefix=X+T++ +"-";Ca=z(P.data.features,function(Va){Ca=null;for(var Fa in Va)M[Fa]=Va[Fa]},ia);za+=1}else if(P.definition)za=
b(P.definition,P);ca+=za?za:1;if(ca>=A)break}V=Ba+1;if(Ca||V<Aa)animFrame(i);else j&&j(M)}}q=COG.extend({vectorsPerCycle:Sa.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},q);r=COG.extend({marker:function(P){return new sa({xy:P})},line:function(P,ca){return new $(P,COG.extend({},q,ca))},poly:function(P,ca){return new $(P,COG.extend({fill:true},q,ca))}},r);var A=q.vectorsPerCycle,F=q.rowPreParse,X=q.layerPrefix,V=0,Aa=0,Ca=null,T=0,M={};if(g){if(typeof g.length==="undefined")g=
[g];Aa=g.length;animFrame(i)}};N.GeoJSON={parse:z};N.Map=function(g){function j(M){try{var P=Sa.Position.init(M.coords.latitude,M.coords.longitude),ca=M.coords.accuracy/1E3;T.trigger("locationUpdate",M,ca);if(V){if(!F){F=new Sa.UI.LocationOverlay({pos:P,accuracy:ca});F.update(T.getTileLayer());T.setLayer("location",F)}var ia=Sa.BoundingBox.createBoundsFromCenter(P,Math.max(ca,1));T.gotoBounds(ia)}else{F.pos=P;F.accuracy=ca;F.update(T.getTileLayer());b(P,null,COG.easing("sine.out"))}V=false}catch(Ba){COG.exception(Ba)}}
function q(M){COG.info("caught location tracking error:",M)}function r(M,P,ca){T.setZoomLevel(P);b(M,ca)}function b(M,P,ca,ia){M=Ra.init(M,Sa.radsPerPixel(T.getZoomLevel()));T.updateOffset(M.x-(self.width>>1),M.y-(self.height>>1),ca,ia,function(){T.refresh();T.trigger("boundsChange",T.getBoundingBox());P&&P(T)})}g=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18,pannable:true,scalable:true},g);var f={NONE:0,SINGLE:1,WATCH:2},i=S.init(),A=f.NONE,F=
null,X=0,V=true,Aa=0,Ca=g.tapExtent;g.adjustScaleFactor=function(M){return Math.pow(2,(M<1?Math.floor:Math.ceil)(Math.log(M)))};var T=COG.extend(new Lb(g),{getBoundingBox:function(){var M=T.getViewport();return M?Sa.BoundingBox.init(Ra.toPos(S.init(M.x1,M.y2),Aa),Ra.toPos(S.init(M.x2,M.y1),Aa)):null},getCenterPosition:function(){var M=T.getViewport();if(M){M=S.init(M.x1+(M.width>>1),M.y1+(M.height>>1));return Ra.toPos(M,Aa)}return null},gotoBounds:function(M,P){var ca=Sa.BoundingBox.getZoomLevel(M,
T.getViewport());r(Sa.BoundingBox.getCenter(M),ca,P)},gotoPosition:r,panToPosition:b,syncXY:function(M,P){return(P?Ra.syncPos:Ra.sync)(M,Aa)},locate:function(){T.trackStart(f.SINGLE);setTimeout(T.trackCancel,1E4)},trackStart:function(M){if(navigator.geolocation&&!X){A=M?M:f.WATCH;V=true;X=navigator.geolocation.watchPosition(j,q,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){X&&navigator.geolocation&&navigator.geolocation.clearWatch(X);T.removeLayer("location");F=null;
A=f.NONE;X=0},animateRoute:function(M,P,ca,ia){var Ba=T.getLayer("route");if(Ba)(M=Ba.getAnimation(M,P,ca,ia))&&M.addToView(T)}});T.bind("pan",function(){A===f.SINGLE&&T.trackCancel()});T.bind("tap",function(M,P,ca,ia){M=Ra.toPos(ia,Aa);var Ba=Ra.toPos(S.offset(ia,-Ca,Ca),Aa);ia=Ra.toPos(S.offset(ia,Ca,-Ca),Aa);T.trigger("geotap",P,ca,M,Pa.init(Ba,ia))});T.bind("refresh",function(){if(S.absSize(S.diff(i,T.getOffset()))>g.boundsChangeThreshold){i=S.copy(T.getOffset());T.trigger("boundsChange",T.getBoundingBox())}});
T.bind("zoomLevelChange",function(M,P){var ca;Aa=Sa.radsPerPixel(P);ca=ba/Aa|0;T.setMaxOffset(ca,ca,true,false);T.resetScale();T.triggerAll("resync",T);T.refresh()});return T};N.GeoShape=function(g,j){j=COG.extend({autoParse:true},j);for(var q=Array(g.length),r=j.autoParse,b=T5.Geo.Position.parse,f=g.length;f--;)q[f]=T5.GeoXY.init(r?b(g[f]):g[f]);return new T5.Poly(q,j)};N.LocationOverlay=function(g){g=COG.extend({pos:null,accuracy:null,zindex:90},g);var j=new Image,q=T5.XY.init(),r=T5.XY.init(),
b=null;j.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
j.onload=function(){q=T5.XY.init(j.width>>1,j.height>>1)};var f=COG.extend(new T5.ViewLayer(g),{pos:g.pos,accuracy:g.accuracy,drawAccuracyIndicator:false,draw:function(i,A){var F=r.x-A.x,X=r.y-A.y;if(b){i.fillStyle="rgba(30, 30, 30, 0.2)";i.beginPath();i.arc(F,X,b,0,Math.PI*2,false);i.fill()}j.complete&&j.width>0&&i.drawImage(j,F-q.x,X-q.y,j.width,j.height)},update:function(i){if(i){b=i.getPixelDistance(f.accuracy)>>1;r=i.getGridXYForPosition(f.pos)}}});f.bind("gridUpdate",function(i,A){f.update(A)});
return f};return{distanceToString:function(g){if(g>1E3)return~~(g/10)/100+" km";return g?g+" m":""},dist2rad:function(g){return g/6371},getEngine:a,lat2pix:h,lon2pix:d,pix2lat:c,pix2lon:e,radsPerPixel:function(g){return ba/(256<<g)},Position:ra,BoundingBox:Pa,Radius:function(g,j){return{distance:parseInt(g,10),uom:j}},Address:function(g){return g=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},g)},A:fb,GeocodeFieldWeights:{streetDetails:50,location:50},
AddressCompareFns:{},Engine:function(g){if(!g.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var j=COG.extend({remove:function(){delete ma[j.id]}},g);return ma[j.id]=j},Search:Qa,GeoSearchResult:bb,LocationSearch:function(g){function j(i,A){navigator.geolocation.clearWatch(r);r=0;if(b){clearTimeout(b);b=0}A&&A([i],g)}function q(i){COG.info("caught location tracking error:",i)}g=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},
g);var r=0,b=0,f=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(i,A){if(navigator.geolocation&&!r){r=navigator.geolocation.watchPosition(function(F){var X=ra.init(F.coords.latitude,F.coords.longitude);F=new bb({id:1,caption:"Current Location",pos:X,accuracy:F.coords.accuracy/1E3,matchWeight:100});if(!f||F.accuracy<f.accuracy)f=F;if(!g.requiredAccuracy||f.accuracy<g.requiredAccuracy)j(f,A)},q,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)b=setTimeout(function(){f&&
j(f,A)},g.searchTimeout)}}},g))},Routing:Na}}()})(T5);
