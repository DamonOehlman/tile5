COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var K=arguments[0]||{},da,I=1,z=arguments.length;I<z;I++)if((da=arguments[I])!==null)for(var l in da){var m=da[l];if(K!==m)if(m!==undefined)K[l]=m}return K};
(function(){var K=Object.prototype.hasOwnProperty,da=0,I={};I.toID=function(z){return z.replace(/\s/g,"-")};I.objId=function(z){return(z?z:"obj")+da++};I.isFunction=function(z){return toString.call(z)==="[object Function]"};I.isArray=function(z){return toString.call(z)==="[object Array]"};I.isPlainObject=function(z){if(!z||toString.call(z)!=="[object Object]"||z.nodeType||z.setInterval)return false;if(z.constructor&&!K.call(z,"constructor")&&!K.call(z.constructor.prototype,"isPrototypeOf"))return false;
var l;for(l in z);return l===undefined||K.call(z,l)};I.isEmptyObject=function(z){for(var l in z)return false;return true};I.isXmlDocument=function(z){return toString.call(z)==="[object Document]"};I.contains=function(z,l){var m=z,t=arguments,C=1;if(l&&module.isArray(l)){t=l;C=0}for(C=C;C<t;C++)m=m&&typeof foo[t[C]]!=="undefined";return m};I.formatStr=function(z){if(arguments.length<=1)return z;for(var l=arguments.length-2,m=0;m<=l;m++)z=z.replace(RegExp("\\{"+m+"\\}","gi"),arguments[m+1]);return z};
I.wordExists=function(z,l){var m="";if(l.toString)l=l.toString();for(var t=0;t<l.length;t++)m+=!/\w/.test(l[t])?"\\"+l[t]:l[t];return RegExp("(^|\\s|\\,)"+m+"(\\,|\\s|$)","i").test(z)};COG.extend(COG,I)})();
(function(){function K(m){return typeof console!=="undefined"?function(){console[m](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var da=window.console&&window.console.markTimeline,I=K("error"),z=K("info"),l=function(){return da?function(m,t){console.markTimeline(m+(t?": "+((new Date).getTime()-t)+"ms":""))}:function(){}}();COG.extend(COG,{trace:l,debug:K("debug"),info:z,warn:K("warn"),error:I,exception:function(m){if(I)for(var t in m)z("ERROR DETAIL: "+
t+": "+m[t])}})})();
(function(){function K(I,z){var l=I.hasOwnProperty("obsHandlers")?I.obsHandlers:null;l[z]||(l[z]=[]);return l[z]}var da=0;COG.observable=function(I){if(!I)return null;if(!(I.hasOwnProperty("obsHandlers")?I.obsHandlers:null))I.obsHandlers={};if(!I.hasOwnProperty("bind")){I.bind=function(z,l){var m="callback"+da++;K(I,z).unshift({fn:l,id:m});return m};I.triggerCustom=function(z,l){var m=K(I,z),t={cancel:false,name:z,source:this},C;l&&COG.extend(t,l);if(!m)return null;C=Array.prototype.slice.call(arguments,2);
I.eventInterceptor&&I.eventInterceptor(z,t,C);C.unshift(t);for(var T=m.length;T--&&!t.cancel;)m[T].fn.apply(this,C);return t};I.trigger=function(z){var l=Array.prototype.slice.call(arguments,1);l.splice(0,0,z,null);return I.triggerCustom.apply(this,l)};I.unbind=function(z,l){if(typeof z==="undefined")I.obsHandlers={};else for(var m=K(I,z),t=0;m&&t<m.length;t++)if(m[t].id===l){m.splice(t,1);break}return I}}return I}})();
(function(){function K(l,m){l[m]||(l[m]=function(t){return l.configure(m,t)})}function da(l){l.gtConfId="configurable"+z++;l.gtConfig={};l.gtConfigFns=[];return l.gtConfig}var I={},z=0;COG.paramTweaker=function(l,m,t){return function(C,T){if(typeof T!=="undefined"){if(C in l)l[C]=T;t&&C in t&&t[C](C,T)}else return m&&C in m?m[C](C):l[C]}};COG.configurable=function(l,m,t,C){if(l){l.gtConfId||da(l);var T=l.gtConfId,n=l.gtConfig,G=l.gtConfigFns;I[T]=l;G.push(t);for(t=m.length;t--;){n[m[t]]=true;C&&K(l,
m[t])}if(!l.configure)l.configure=function(A,H){if(n[A]){for(var w=G.length;w--;){var v=G[w](A,H);if(typeof v!=="undefined")return v}return I[T]}return null}}}})();
(function(){function K(l){var m=document.createElement("script"),t=false;m.src=l;m.async=true;m.onload=m.onreadystatechange=function(){if(!t&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){t=true;m.onload=m.onreadystatechange=null;m&&m.parentNode&&m.parentNode.removeChild(m)}};I||(I=document.getElementsByTagName("head")[0]);I.appendChild(m)}var da=0,I,z=this;COG.jsonp=function(l,m,t){l+=l.indexOf("?")>=0?"&":"?";var C="json"+ ++da;z[C]=function(T){m(T);z[C]=null;try{delete z[C]}catch(n){}};
K(l+(t?t:"callback")+"="+C);return C}})();
(function(){var K=1.70158,da=Math.PI/2,I=1E3/60|0,z=Math.abs,l=Math.pow,m=Math.sin,t=Math.asin,C=Math.cos,T={linear:function(n,G,A,H){return A*n/H+G},backin:function(n,G,A,H){return A*(n/=H)*n*((K+1)*n-K)+G},backout:function(n,G,A,H){return A*((n=n/H-1)*n*((K+1)*n+K)+1)+G},backinout:function(n,G,A,H){return(n/=H/2)<1?A/2*n*n*(((K*=1.525)+1)*n-K)+G:A/2*((n-=2)*n*(((K*=1.525)+1)*n+K)+2)+G},bouncein:function(n,G,A,H){return A-T.bounceout(H-n,0,A,H)+G},bounceout:function(n,G,A,H){return(n/=H)<1/2.75?
A*7.5625*n*n+G:n<2/2.75?A*(7.5625*(n-=1.5/2.75)*n+0.75)+G:n<2.5/2.75?A*(7.5625*(n-=2.25/2.75)*n+0.9375)+G:A*(7.5625*(n-=2.625/2.75)*n+0.984375)+G},bounceinout:function(n,G,A,H){return n<H/2?T.bouncein(n*2,0,A,H)/2+G:T.bounceout(n*2-H,0,A,H)/2+A/2+G},cubicin:function(n,G,A,H){return A*(n/=H)*n*n+G},cubicout:function(n,G,A,H){return A*((n=n/H-1)*n*n+1)+G},cubicinout:function(n,G,A,H){if((n/=H/2)<1)return A/2*n*n*n+G;return A/2*((n-=2)*n*n+2)+G},elasticin:function(n,G,A,H,w,v){if(n==0)return G;if((n/=
H)==1)return G+A;v||(v=H*0.3);if(!w||w<z(A)){w=A;A=v/4}else A=v/TWO_PI*t(A/w);return-(w*l(2,10*(n-=1))*m((n*H-A)*TWO_PI/v))+G},elasticout:function(n,G,A,H,w,v){var B;if(n==0)return G;if((n/=H)==1)return G+A;v||(v=H*0.3);if(!w||w<z(A)){w=A;B=v/4}else B=v/TWO_PI*t(A/w);return w*l(2,-10*n)*m((n*H-B)*TWO_PI/v)+A+G},elasticinout:function(n,G,A,H,w,v){var B;if(n==0)return G;if((n/=H/2)==2)return G+A;v||(v=H*0.3*1.5);if(!w||w<z(A)){w=A;B=v/4}else B=v/TWO_PI*t(A/w);if(n<1)return-0.5*w*l(2,10*(n-=1))*m((n*
H-B)*TWO_PI/v)+G;return w*l(2,-10*(n-=1))*m((n*H-B)*TWO_PI/v)*0.5+A+G},quadin:function(n,G,A,H){return A*(n/=H)*n+G},quadout:function(n,G,A,H){return-A*(n/=H)*(n-2)+G},quadinout:function(n,G,A,H){if((n/=H/2)<1)return A/2*n*n+G;return-A/2*(--n*(n-2)-1)+G},sinein:function(n,G,A,H){return-A*C(n/H*da)+A+G},sineout:function(n,G,A,H){return A*m(n/H*da)+G},sineinout:function(n,G,A,H){return-A/2*(C(Math.PI*n/H)-1)+G}};COG.tweenValue=function(n,G,A,H,w){function v(na){na=na?na:(new Date).getTime();if(xa+I<
na){var ya=na-B,ea=A(ya,n,oa,H),va=B+H<=na;na=!va;if(w){ya=w(ea,va,ya);na=typeof ya!="undefined"?ya&&na:na}na&&animFrame(v)}}var B=(new Date).getTime(),xa=0,oa=G-n;animFrame(v);return{}};COG.easing=function(n){return T[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(n,G){T[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]=G}})();
(function(){var K=/^P(\d+Y)?(\d+M)?(\d+D)?$/,da=/^(\d+H)?(\d+M)?(\d+S)?$/,I={8601:function(l){l=l.split("T");var m=null;m=null;var t=0,C=0;K.lastIndex=-1;m=K.exec(l[0]);t+=m[3]?parseInt(m[3].slice(0,-1),10):0;da.lastIndex=-1;m=da.exec(l[1]);C+=m[1]?parseInt(m[1].slice(0,-1),10)*3600:0;C+=m[2]?parseInt(m[2].slice(0,-1),10)*60:0;C+=m[3]?parseInt(m[3].slice(0,-1),10):0;return new z(t,C)}},z=COG.Duration=function(l,m){return{days:l?l:0,seconds:m?m:0}};COG.addDuration=function(){for(var l=new z,m=arguments.length;m--;){l.days+=
arguments[m].days;l.seconds+=arguments[m].seconds}if(l.seconds>=86400){l.days+=~~(l.seconds/86400);l.seconds%=86400}return l};COG.formatDuration=function(l){var m,t,C="";if(l.days)C=l.days+" days ";if(l.seconds){l=l.seconds;if(l>=3600){m=~~(l/3600);l-=m*3600}if(l>=60){t=Math.round(l/60);l-=t*60}if(m)C=C+m+(m>1?" hrs ":" hr ")+(t?(t>10?t:"0"+t)+" min ":"");else if(t)C=C+t+" min";else if(l>0)C=C+(l>10?l:"0"+l)+" sec"}return C};COG.parseDuration=function(l,m){var t=m?I[m]:null;if(t)return t(l);COG.Log.warn("Could not find duration parser for specified format: "+
m);return new z}})();COG.ObjectStore=function(){var K={},da={},I="obj_"+(new Date).getTime(),z=0,l=Object.prototype.hasOwnProperty;return{add:function(m,t){var C;t=t?t:"default";if(m&&m.constructor)if(!l.call(m,"id"))m.id=I+ ++z;C=da[t]?da[t]:da[t]=[];K[m.id]=C.length;C[m.length]=m}}};var CANI={};
(function(K){var da=[],I=0,z=false,l=K.register=function(m,t){da.push({section:m,run:t})};K.init=function(m){function t(){if(I<da.length){var T=da[I++];C[T.section]||(C[T.section]={});T.run(C[T.section],t)}else{for(T in C)K[T]=C[T];z=true;m&&m(K)}}var C={};if(z&&m)m(K);else{I=0;t()}};l("canvas",function(m,t){function C(){var A,H=T.getContext("2d");H.save();try{H.translate(50,50);H.beginPath();H.rect(0,0,20,20);A=H.isPointInPath(10,10)}finally{H.restore()}return A}var T=document.createElement("canvas"),
n=typeof FlashCanvas!="undefined",G=typeof G_vmlCanvasManager!="undefnined";T.width=200;T.height=200;m.pipTransformed=n||G?false:C();t()})})(CANI);
INTERACT=function(){function K(w){return function(v,B,xa){(xa?xa:w?document.body:document).addEventListener(v,B,false)}}function da(w){return function(v,B,xa){(xa?xa:w?document.body:document).removeEventListener(v,B,false)}}function I(w,v,B){(B?B:document).attachEvent("on"+w,v)}function z(w,v,B){(B?B:document).detachEvent("on"+w,v)}function l(w,v){return{x:w?w:0,y:v?v:0,count:1}}function m(w,v){A.push(COG.extend({handler:null,checks:{},type:w},v))}function t(w){var v=0,B=0;if(w.offsetParent){do{v+=
w.offsetLeft;B+=w.offsetTop;w=w.offsetParent}while(w)}return{left:v,top:B}}function C(w,v){return{source:w,target:v.target?v.target:v.srcElement}}function T(w,v){for(var B=w.target?w.target:w.srcElement;B&&B!==v&&B.nodeName&&B.nodeName.toUpperCase()!="CANVAS";)B=B.parentNode;return B&&B===v}function n(w,v){return{x:w.x-(v?v.left:0),y:w.y-(v?v.top:0)}}function G(w){if(w.preventDefault){w.preventDefault();w.stopPropagation()}else w.cancelBubble&&w.cancelBubble()}var A=[],H=function(w,v,B){function xa(fa,
ma,ra,U){var ca=0,pa=0,x=0;COG.tweenValue(0,fa,ra,U,function(Q){x=ca;ca=Q});COG.tweenValue(0,ma,ra,U,function(Q){oa.trigger("pan",ca-x,Q-pa);pa=Q})}B=COG.extend({binder:null,unbinder:null,observable:null},B);for(var oa=B.observable,na=null,ya=[],ea=[],va,Ia,Fa={bind:function(){return oa.bind.apply(null,arguments)},pannable:function(fa){na=COG.extend({inertia:true},fa);return Fa},unbind:function(){oa.unbind();for(var fa=0;fa<ya.length;fa++)ya[fa].unbind();return Fa}},Oa=0;Oa<v.length;Oa++)ya.push(v[Oa](w,
oa,B));oa.bind("pointerDown",function(){ea=[];Ia=va=0});oa.bind("pointerMove",function(fa,ma,ra,U){if(na){ea[ea.length]={ticks:(new Date).getTime(),x:U.x,y:U.y};oa.trigger("pan",U.x,U.y)}va+=U.x?U.x:0;Ia+=U.y?U.y:0});oa.bind("pointerUp",function(fa,ma,ra){if(Math.abs(va)>20||Math.abs(Ia)>20){if(na){ra=ea.length;var U,ca;ma=0;for(ca=ea.length;--ca>1&&ma<50;)ma+=ea[ca].ticks-ea[ca-1].ticks;if(ra-ca>1){fa=ea[ra-1].x-ea[ca].x;U=ea[ra-1].y-ea[ca].y;ca=Math.sqrt(fa*fa+U*U)|0;if(ca>15){fa=ea[ra-1].x-ea[0].x;
U=ea[ra-1].y-ea[0].y;ca=Math.sqrt(fa*fa+U*U)|0;ra=Math.asin(U/ca);ma=ca*500/ma|0;ma=ma>300?300:ma;xa(Math.cos(fa>0?ra:Math.PI-ra)*ma,Math.sin(ra)*ma,COG.easing("sine.out"),500)}}}}else oa.trigger("tap",ma,ra)});return Fa};m("pointer",{handler:function(w,v,B){function xa(x){if(x.pageX&&x.pageY)return l(x.pageX,x.pageY);else{var Q=document.documentElement,qa=document.body;return l(x.clientX+(Q&&Q.scrollLeft||qa&&qa.scrollLeft||0)-(Q&&Q.clientLeft||qa&&qa.clientLeft||0),x.clientY+(Q&&Q.scrollTop||qa&&
qa.scrollTop||0)-(Q&&Q.clientTop||qa&&qa.clientTop||0))}}function oa(x){if(T(x,w))if(fa=va(x)){var Q=xa(x);w.style.cursor="move";G(x);ca=Q.x;pa=Q.y;ma=l(ca,pa);v.triggerCustom("pointerDown",C("mouse",x),ma,n(ma,t(w)))}}function na(x){var Q=xa(x);ra=Q.x;U=Q.y;if(T(x,w))Ia(x,fa?"pointerMove":"pointerHover")}function ya(x){if(fa&&va(x)){fa=false;if(T(x,w)){w.style.cursor="default";Ia(x,"pointerUp")}}}function ea(x){if(T(x,w)){var Q;x=x||window.event;if(x.detail)Q=x.axis===2?-x.detail*Fa:0;else{Q=x.wheelDeltaY?
x.wheelDeltaY:x.wheelDelta;if(window.opera)Q=-Q}if(Q!==0){var qa=l(ra,U);v.triggerCustom("zoom",C("mouse",x),qa,n(qa,t(w)),Q/Oa,"wheel");G(x);x.returnValue=false}}}function va(x){x=x||window.event;return(x.which||x.button)==1}function Ia(x,Q,qa,Ga,Xa){qa=typeof qa!="undefined"?qa:ra;Ga=typeof Ga!="undefined"?Ga:U;var O=qa-ca,ja=Ga-pa,W=l(qa,Ga);v.triggerCustom(Q,C("mouse",x),W,n(W,t(w)),l(O,ja));if(typeof Xa=="undefined"||Xa){ca=qa;pa=Ga}}B=COG.extend({},B);var Fa=120,Oa=Fa*8,fa=false,ma,ra,U,ca,
pa;B.binder("mousedown",oa,false);B.binder("mousemove",na,false);B.binder("mouseup",ya,false);B.binder("dblclick",function(x){COG.info("captured double click");if(T(x,w)){var Q=xa(x);v.triggerCustom("doubleTap",C("mouse",x),Q,n(Q,t(w)))}},false);B.binder("mousewheel",ea,document);B.binder("DOMMouseScroll",ea,document);return{unbind:function(){B.unbinder("mousedown",oa,false);B.unbinder("mousemove",na,false);B.unbinder("mouseup",ya,false);B.unbinder("mousewheel",ea,document);B.unbinder("DOMMouseScroll",
ea,document)}}},checks:{touch:false}});m("pointer",{handler:function(w,v,B){function xa(O){if(O.count<2)return 0;var ja=O.x-O.next.x;O=O.y-O.next.y;return~~Math.sqrt(ja*ja+O*O)}function oa(O,ja,W){ja=ja?ja:0;W=W?W:0;for(var Ja={x:O.x-ja,y:O.y-W,id:O.id,count:O.count},Ma=Ja;O.next;){O=O.next;Ma=Ma.next={x:O.x-ja,y:O.y-W,id:O.id}}return Ja}function na(O,ja){var W=O[ja?ja:"touches"],Ja,Ma;if(W.length===0)return null;Ma=Ja={x:W[0].pageX,y:W[0].pageY,id:W[0].identifier,count:W.length};for(var $=1,fb=W.length;$<
fb;$++)Ma=Ma.next={x:W[$].pageX,y:W[$].pageY,id:W[$].identifier};return Ja}function ya(O){if(T(O,w)){U=t(w);var ja=na(O,"changedTouches"),W=oa(ja,U.left,U.top);if(!pa){ca=fa;v.triggerCustom("pointerDown",C("touch",O),ja,W)}Ga&&v.triggerCustom("pointerDownMulti",C("touch",O),ja,W);pa=na(O);if(pa.count>1)Q=xa(pa);Xa=1;qa=oa(pa)}}function ea(O){if(T(O,w)){O.preventDefault();x=na(O);if(ca==fa)ca=Math.abs(pa.x-x.x)>Fa||Math.abs(pa.y-x.y)>Fa?Oa:fa;if(ca!=fa){ca=x.count>1?ra:ma;if(ca==ra)if(pa.count===1){pa=
oa(x);Q=xa(pa)}else{var ja=xa(x);if(Math.abs(Q-ja)<Ia)ca=ma;else{var W;W=x.x;var Ja=x.next.x,Ma=x.y,$=x.next.y,fb=Ma<$?Ma:$;W={x:(W<Ja?W:Ja)+(Math.abs(W-Ja)>>1),y:fb+(Math.abs(Ma-$)>>1)};ja=ja/Q;Ja=ja-Xa;v.triggerCustom("zoom",C("touch",O),W,n(W,U),Ja,"pinch");Xa=ja}}ca==ma&&v.triggerCustom("pointerMove",C("touch",O),x,oa(x,U.left,U.top),l(x.x-qa.x,x.y-qa.y));Ga&&v.triggerCustom("pointerMoveMulti",C("touch",O),x,oa(x,U.left,U.top))}qa=oa(x)}}function va(O){if(T(O,w)){var ja=na(O,"changedTouches"),
W=oa(ja,U.left,U.top);x=na(O);if(!x){v.triggerCustom("pointerUp",C("touch",O),ja,W);pa=null}Ga&&v.triggerCustom("pointerUpMulti",C("touch",O),ja,W)}}B=COG.extend({detailed:false,inertia:false},B);var Ia=20,Fa=7,Oa=0,fa=1,ma=2,ra=3,U,ca,pa,x,Q,qa,Ga=B.detailed,Xa=1;B.binder("touchstart",ya,false);B.binder("touchmove",ea,false);B.binder("touchend",va,false);COG.info("initialized touch handler");return{unbind:function(){B.unbinder("touchstart",ya,false);B.unbinder("touchmove",ea,false);B.unbinder("touchend",
va,false)}}},checks:{touch:true}});return{register:m,watch:function(w,v,B){v=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},v);capabilities=COG.extend({touch:"ontouchstart"in window},B);if(!v.observable){COG.info("creating observable");v.observable=COG.observable({});globalOpts=v}v.binder=v.isIE?I:K(v.bindToBody);v.unbinder=v.isIE?z:da(v.bindToBody);B=v.types;for(var xa=capabilities,oa=[],na=A.length;na--;){var ya=A[na],ea=!B||B.indexOf(ya.type)>=
0,va=true;for(var Ia in ya.checks){var Fa=ya.checks[Ia];COG.info("checking "+Ia+" capability. require: "+Fa+", capability = "+xa[Ia]);va=va&&Fa===xa[Ia]}if(ea&&va)oa[oa.length]=ya.handler}return new H(w,oa,v)}}}();var T5={};
(function(K){function da(){return(new Date).getTime()}function I(){for(;nb.length>0;){var a=nb.shift();document.location=a}ob=0}function z(a){for(var g=true,d=xb.length;d--;)g=g&&a!=xb[d];return g}function l(a,g){var d=[];for(var c in g)c&&d.push(c+"="+escape(g[c]));return"tile5://"+a+"/"+(d.length>0?"?"+d.join("&"):"")}function m(a,g){z(a)&&COG.info("would push url: "+l(a,g))}function t(a,g){if(z(a)){nb.push(l(a,g));ob||(ob=setTimeout(I,100))}}function C(a){return function(g,d,c){(c?c:a?document.body:
document).addEventListener(g,d,false)}}function T(a){return function(g,d,c){(c?c:a?document.body:document).removeEventListener(g,d,false)}}function n(a,g,d){(d?d:document).attachEvent("on"+a,g)}function G(a,g,d){(d?d:document).detachEvent("on"+a,g)}function A(){Ta={base:{name:"Unknown",bindEvent:C(),unbindEvent:T(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:m,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:n,unbindEvent:G,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:t,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:t},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:t},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:C(true),unbindEvent:T(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:t},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:t}};pb=[Ta.froyo,Ta.android,Ta.ipod,Ta.iphone,Ta.ipad,Ta.ie]}function H(){Ta||A();if(!db){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<pb.length;a++){var g=pb[a];if(g.regex&&g.regex.test(navigator.userAgent)){db=COG.extend({},Ta.base,g);COG.info("PLATFORM DETECTED AS: "+db.name);break}}if(!db){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
db=Ta.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return db}function w(){var a=(new Date).getTime(),g=0;clearTimeout(gb);for(gb=0;g<eb.length;){var d=eb[g],c=ab[d],e=ab[d].image&&(yb||ab[d].image.complete&&ab[d].image.width>0),j=a-c.start;j=e||j>=Nb;if(e){e=c.image;c=c.callbacks;zb[d]=e;for(var q=0;q<c.length;q++)c[q](e,true)}if(j){eb.splice(g,1);delete ab[d]}else g++}if(eb.length>0)gb=setTimeout(w,Ab)}function v(a){function g(j){var q=a[j];typeof q!=="undefined"&&c.push(function(D){D[j]=
q})}function d(){c=[];for(var j in a)g(j)}a=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},a);var c=[],e={applyToContext:function(j){for(var q=c.length;q--;)c[q](j)},update:function(j,q){a[j]=q;d()}};d();return e}function B(){for(var a=0,g=arguments.length;g--;){var d=Ob[arguments[g].toUpperCase()];if(d)a|=d}return a}function xa(a){a=a?a:(new Date).getTime();
if(a-Bb>Pb){for(var g=hb.splice(0),d=g.length;d--;)g[d](a);Bb=a}hb.length&&animFrame(xa)}function oa(a){var g=hb.length==0;hb[hb.length]=a;g&&animFrame(xa)}function na(a,g,d,c,e){e=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},e);var j=(new Date).getTime(),q=a[g],D=g=="translate",o=e.autoInvalidate,J=d.length&&c.length&&d.length==c.length?d.length:0,ga=Array(J),Z=Array(J),P=COG.easing(e.easing),sa=e.duration,L=e.progress,R=function(ha){var ka=ha-j;ha=
j+sa<=ha;for(var za=a.layer?a.layer.view:null,wa,Da=J;Da--;){wa=P(ka,d[Da],ga[Da],sa);Z[Da]=D?wa|0:wa}q.apply(a,Z);if(o&&za)za.redraw=true;if(L){ka=[].concat(ha?c:Z);ka.unshift(ha);L.apply(a,ka)}if(ha){a.animations--;q.apply(a,c);e.complete&&e.complete.apply(a,c)}else oa(R)};if(q&&q.apply&&J>0){sa=sa?sa:DEFAULT_DURATION;for(g=J;g--;)ga[g]=c[g]-d[g];a.animations++;oa(R)}}function ya(a,g){var d,c;if(g&&g.width>0){if(!a.imageOffset)a.imageOffset=$.init(-g.width>>1,-g.height>>1);if(!a.bounds){d=a.xy.x+
a.imageOffset.x;c=a.xy.y+a.imageOffset.y;a.bounds=Pa.init(d,c,d+g.width,c+g.height)}}}function ea(a){Ua.call(this,a)}function va(a,g){g=COG.extend({simplify:false},g);var d=false,c=g.simplify;B("ZOOM");var e=[];g.type=g.fill?"polygon":"line";Ua.call(this,g);COG.extend(this,{animatePath:function(){},prep:function(j){return d?j.path(e):null},resync:function(j){var q,D,o,J,ga;j.syncXY(a);e=$.floor(c?$.simplify(a):a);for(var Z=e.length;Z--;){j=e[Z].x;q=e[Z].y;J=typeof J=="undefined"||j<J?j:J;ga=typeof ga==
"undefined"||q<ga?q:ga;D=typeof D=="undefined"||j>D?j:D;o=typeof o=="undefined"||q>o?q:o}this.updateBounds(Pa.init(J,ga,D,o),true)}});d=a&&a.length>=2}function Ia(a,g){g.fill=false;va.call(this,a,g)}function Fa(a){function g(o){(this.imageUrl=o)&&Cb(this.imageUrl,function(J,ga){q=J;if(ga){var Z=D.layer?D.layer.view:null;if(Z)Z.redraw=true}})}a=COG.extend({image:null,imageUrl:null,imageOffset:null},a);var d=null,c=Ua.prototype.updateBounds,e,j,q=a.image;Ua.call(this,a);var D=COG.extend(this,{changeImage:g,
drag:function(o,J,ga,Z){d||(d=$.init(o.startX-this.xy.x,o.startY-this.xy.y));this.xy.x=J-d.x;this.xy.y=ga-d.y;if(Z){d=null;if(this.layer)(o=this.layer.view)&&o.syncXY([this.xy],true);this.trigger("dragDrop")}return true},prep:function(o){if(q&&q.width>0){ya(this,q);e=this.xy.x+this.imageOffset.x;j=this.xy.y+this.imageOffset.y;return o.image(q,e,j,q.width,q.height)}},updateBounds:function(o,J){c.call(this,o,J);ya(this,q)}});q||g(this.imageUrl)}function Oa(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.imageOffset=
$.invert(a.imageAnchor);Fa.call(this,a)}function fa(a){a=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,validStates:B("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);this.view=null;COG.observable(COG.extend(this,a))}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},
1E3/60)}}();var ma=Math.PI*2,ra=Math.PI/2,U=Math.abs,ca=Math.ceil,pa=Math.min,x=Math.max,Q=Math.pow,qa=Math.sqrt,Ga=Math.log,Xa=Math.round,O=Math.sin,ja=Math.asin,W=Math.cos,Ja=Math.atan,Ma=Math.atan2,$=function(){function a(c,e){return d(c.x-e.x,c.y-e.y)}function g(c,e){if(!e)e=c.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var j={edges:Array(e-1),accrued:Array(e-1),total:0},q=0;q<e-1;q++){var D=a(c[q],c[q+1]);j.edges[q]=qa(D.x*D.x+D.y*D.y);
j.accrued[q]=j.total+j.edges[q];j.total+=j.edges[q]}return j}function d(c,e){return{x:c?c:0,y:e?e:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var c=0,e=0,j=arguments.length;j--;){c+=arguments[j].x;e+=arguments[j].y}return d(c,e)},absSize:function(c){return x(U(c.x),U(c.y))},copy:function(c){return c?d(c.x,c.y):null},diff:a,distance:function(c,e){return g(c,e).total},edges:g,equals:function(c,e){return c.x===e.x&&c.y===e.y},extendBy:function(c,e,j){var q=W(e)*
j|0;e=O(e)*j|0;return d(c.x-q,c.y-e)},floor:function(c){for(var e=Array(c.length),j=c.length;j--;)e[j]=d(~~c[j].x,~~c[j].y);return e},getRect:function(c){for(var e,j,q,D,o=c.length;o--;){var J=c[o];e=typeof e==="undefined"||J.x<e?J.x:e;j=typeof j==="undefined"||J.y<j?J.y:j;q=typeof q==="undefined"||J.x>q?J.x:q;D=typeof D==="undefined"||J.y>D?J.y:D}return Pa.init(e,j,q,D)},init:d,invert:function(c){return d(-c.x,-c.y)},min:function(c,e){return d(c.x<e.x?c.x:e.x,c.y<e.y?c.y:e.y)},max:function(c,e){return d(c.x>
e.x?c.x:e.x,c.y>e.y?c.y:e.y)},offset:function(c,e,j){return d(c.x+e,c.y+(j?j:e))},scale:function(c,e){return d(c.x/e|0,c.y/e|0)},simplify:function(c,e){if(!c)return null;e=e?e:$.VECTOR_SIMPLIFICATION;for(var j=[],q=null,D=c.length;D--;){var o=c[D];if(include=!q||D===0||U(o.x-q.x)+U(o.y-q.y)>e){j.unshift(o);q=o}}return j},theta:function(c,e,j){j=ja((c.y-e.y)/j);return c.x>e.x?j:Math.PI-j},toString:function(c){return c?c.x+", "+c.y:""}}}(),fb=function(){return{dotProduct:function(a,g){return a.x*g.x+
a.y*g.y}}}(),Pa=function(){function a(d){return g(d.x1,d.y1,d.x2,d.y2)}function g(d,c,e,j){d=d?d:0;c=c?c:0;e=typeof e!=="undefined"?e:d;j=typeof j!=="undefined "?j:j;return{x1:d,y1:c,x2:e,y2:j,width:e-d,height:j-c}}return{buffer:function(d,c,e){return $.init(d.x1-c,d.y1-e?e:c,d.x1+c,d.y1+e?e:c)},center:function(d){return $.init(d.x1+(d.width>>1),d.y1+(d.height>>1))},copy:a,diagonalSize:function(d){return qa(d.width*d.width+d.height*d.height)},fromCenter:function(d,c,e,j){e=e>>1;j=j>>1;return g(d-
e,c-j,d+e,c+j)},init:g,intersect:function(d,c){var e=x(d.x1,c.x1),j=x(d.y1,c.y1),q=pa(d.x2,c.x2),D=pa(d.y2,c.y2);e=g(e,j,q,D);return e.width>0&&e.height>0?e:null},toString:function(d){return d?"["+d.x1+", "+d.y1+", "+d.x2+", "+d.y2+"]":""},union:function(d,c){if(d.width===0||d.height===0)return a(c);else if(c.width===0||c.height===0)return a(d);else{var e=pa(d.x1,c.x1),j=pa(d.y1,c.y1),q=x(d.x2,c.x2),D=x(d.y2,c.y2);e=g(e,j,q,D);return e.width>0&&e.height>0?e:null}}}}(),Qb=function(){return{getAspectRatio:function(a){return a.height!==
0?a.width/a.height:1},getCenter:function(a){return $.init(a.width>>1,a.height>>1)},getSize:function(a){return qa(Q(a.width,2)+Q(a.height,2))},init:function(a,g){a=a?a:0;return{width:a,height:g?g:a}}}}();Hits=function(){return{diffHits:function(a,g){var d=[],c={},e;for(e=g.length;e--;)c[g[e].target.id]=true;for(e=a.length;e--;)c[a[e].target.id]||(d[d.length]=a[e]);return d},init:function(a,g,d,c){return{type:a,x:c.x|0,y:c.y|0,elements:[],absXY:g,relXY:d}},initHit:function(a,g,d){return{type:a,target:g,
drag:d}},triggerEvent:function(a,g,d,c){g.triggerCustom(a.type+(d?d:"Hit"),{hitType:a.type},c?c:a.elements,a.absXY,a.relXY,$.init(a.x,a.y))}}}();var Ta=null,pb=[],db=null,ob=0,nb=[],xb=["view.wake","tile.loaded"],Ab=100,Nb=3E4,zb={},Rb=0;(new Date).getTime();var ab={},eb=[],yb=typeof FlashCanvas!="undefined",gb=0,Cb=T5.getImage=function(a,g){var d=a&&g?zb[a]:null;if(d&&d&&(yb||d.complete&&d.width>0))g(d);else{if(d=ab[a])d.callbacks.push(g);else{d=new Image;d.id="_ldimg"+ ++Rb;ab[a]={start:(new Date).getTime(),
image:d,callbacks:[g]};d.src=a;eb[eb.length]=a}gb||(gb=setTimeout(w,Ab))}},Sb=T5.newCanvas=function(a,g){var d=document.createElement("canvas");d.width=a?a:0;d.height=g?g:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(d);FlashCanvas.initElement(d)}typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(d);return d},Db=function(){var a={};return{init:function(g,d){var c=a[g];if(!c)throw Error("Unable to locate requested generator: "+g);return new c(d)},register:function(g,
d){a[g]=d}}}(),Tb=function(){return{applyStyle:function(){},applyTransform:function(a,g,d){return{restore:null,x:g,y:d}},checkSize:function(){},hitTest:function(){return false},restore:function(){},save:function(){}}},Eb={},Fb=K.registerRenderer=function(a,g){Eb[a]=g},Gb=K.attachRenderer=function(a,g,d,c){a=a.split("/");for(var e=new Tb(g,d,c),j=0;j<a.length;j++){var q=Eb[a[j]];if(q)e=new q(g,d,c,e)}return e};Fb("canvas",function(a,g,d,c){function e(L,R,ha){if(L.image)o.drawImage(L.image,R,ha);else if(!L.loading){L.loading=
true;Cb(L.url,function(ka){L.image=ka;L.loading=false;o.drawImage(ka,L.screenX,L.screenY)})}}d=COG.extend({},d);var j,q,D,o,J,ga=0,Z=0,P=null,sa={};if(g){j=a.width=g.offsetWidth;q=a.height=g.offsetHeight;D=Sb(j,q);D.style.cssText="position: absolute; z-index: 1;";o=null;g.appendChild(D)}return COG.extend(c,{interactTarget:D,applyStyle:function(L){var R=Ub(L),ha=R&&o&&o.canvas?sa[o.canvas.id]:null;if(R){sa[o.canvas.id]=L;R.applyToContext(o);return ha}},applyTransform:function(L){if(L.translateX||L.translateY||
L.scaling!==1||L.rotatation){o.save();P={undo:function(){o.restore();P=null},x:L.xy.x,y:L.xy.y};o.translate(L.xy.x-ga+L.translateX,L.xy.y-Z+L.translateY);L.rotation!==0&&o.rotate(L.rotation);L.scaling!==1&&o.scale(L.scaling,L.scaling)}return P},arc:function(L,R,ha,ka,za){o.beginPath();o.arc(L-(P?P.x:ga),R-(P?P.y:Z),ha,ka,za,false);return{draw:function(){o.fill();o.stroke()}}},drawTiles:function(L){for(var R,ha,ka=P?P.x:ga,za=P?P.y:Z,wa=ka-256,Da=za-256,ta=ka+j,La=za+q,Ya,Ka,ia=L.length;ia--;){R=L[ia];
ha=R.x>=wa&&R.x<=ta&&R.y>=Da&&R.y<=La;Ya=R.screenX=R.x-ka;Ka=R.screenY=R.y-za;ha&&e(R,Ya,Ka)}},image:function(L,R,ha,ka,za){var wa=R-(P?P.x:ga),Da=ha-(P?P.y:Z);o.beginPath();o.rect(wa,Da,ka,za);return{draw:function(){o.drawImage(L,wa,Da,ka,za)}}},prepare:function(L){var R,ha=false;R=a.getOffset();var ka=a.getScaleFactor(),za=R.x,wa=R.y;if(o)o.restore();else o=D.getContext("2d");for(R=L.length;R--;)ha=ha||L[R].clip;J=Pa.init(za,wa,za+j,wa+q);J.scaleFactor=ka;if(ka!==1)J=Pa.buffer(J,j/ka>>1,q/ka>>1);
ga=J.x1-(J.width>>1);Z=J.y1-(J.height>>1);if(o){ha||o.clearRect(0,0,j,q);o.save();o.scale(ka,ka)}o.globalCompositeOperation="source-over";return o},path:function(L){var R=true,ha=P?P.x:ga,ka=P?P.y:Z;o.beginPath();for(var za=L.length;za--;){var wa=L[za].x-ha,Da=L[za].y-ka;if(R){o.moveTo(wa,Da);R=false}else o.lineTo(wa,Da)}return{draw:function(){o.fill();o.stroke()}}},getContext:function(){return o},getDimensions:function(){return{width:j,height:q}},getViewport:function(){return J}})});Fb("dom",function(a,
g,d,c){var e=typeof g.style["-webkit-transform"]!="undefined",j=null;j=document.createElement("div");j.id=COG.objId("domImages");j.style.cssText=COG.formatStr("position: absolute; overflow: hidden; width: {0}px; height: {1}px;",g.offsetWidth,g.offsetHeight);g.insertBefore(j,c.interactTarget);var q=COG.extend(c,{drawTiles:function(D){var o,J;o=q.getViewport();for(var ga=o.x1,Z=o.y1,P,sa,L=D.length;L--;){o=D[L];J=o.image;P=o.x-ga;sa=o.y-Z;if(!J){J=o.image=new Image;J.src=o.url;j.appendChild(J);J.style.cssText=
"-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;"}if(e)J.style["-webkit-transform"]="translate3d("+P+"px, "+sa+"px, 0px)";else{J.style.left=
P+"px";J.style.top=sa+"px"}J.style.display="block"}}});return q});var Hb={},Vb=K.defineStyle=function(a,g){Hb[a]=v(g);return a},Ib=K.defineStyles=function(a){for(var g in a)Vb(g,a[g])},Ub=K.getStyle=function(a){return Hb[a]};K.loadStyles=function(a){COG.jsonp(a,function(g){Ib(g)})};Ib({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});var Ob={NONE:0,
ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Lb=function(a){function g(r,u,F){Na||Ya(Ba-u,h-F)}function d(r,u,F,aa){Da(pa(x(X+Q(2,aa)-1,0.5),2))}function c(){var r=Ga(X)/Math.LN2|0;if(r!==0){X=Q(2,r);ta(ib+r,Wb,Xb)}la.redraw=true}function e(r,u){var F=la.getViewport(),aa=1/X;return $.init(F?F.x1+r*aa:r,F?F.y1+u*aa:u)}function j(r,u,F){La("doubleTap",u,F,e(F.x,F.y));a.scalable&&Da(2,F,a.zoomEasing,null,a.zoomDuration)}function q(r,u,F){Na=null;ha("down",u,F)}function D(r,u,F){ha("hover",u,F)}function o(r,
u,F){L(u,F,false)}function J(r,u,F){L(u,F,true)}function ga(){clearTimeout(ba);ba=setTimeout(function(){renderer.checkSize()},250)}function Z(r,u,F){ha("tap",u,F);La("tap",u,F,e(F.x,F.y,true))}function P(r,u){u.id=r;u.added=da();u.view=la;u.trigger("parentChange",la,bb,qb);ia.push(u);ia.sort(function(F,aa){var ua=aa.zindex-F.zindex;if(ua===0)ua=aa.added-F.added;return ua});Qa=ia.length;return u}function sa(){Ca&&Ca.unbind();if(renderer){Ca=INTERACT.watch(renderer.interactTarget);a.pannable&&Ca.pannable().bind("pan",
g);if(a.scalable){Ca.bind("zoom",d);Ca.bind("doubleTap",j)}Ca.bind("pointerDown",q);Ca.bind("pointerMove",o);Ca.bind("pointerUp",J);a.captureHover&&Ca.bind("pointerHover",D);Ca.bind("tap",Z)}}function L(r,u,F){if(Na){r=e(u.x,u.y);if(Na.drag.call(Na.target,Na,r.x,r.y,F))la.redraw=true;if(F)Na=null}}function R(r){var u;u=false;r=r?r:(new Date).getTime();if(u=r-Ea>kb){la.trigger("enterFrame",r,rb++);r-M>sb&&wa();Ea=r}if(u&&la.redraw){u=Ba!==k||h!==p;Va=Jb|(X!==1?Kb:0)|(u?tb:0)|(Ra?ub:0);Aa=(u=(Va&(Kb|
tb))!==0)&&(Va&ub)===0;if(renderer.prepare(ia,Va,r,V)){u=renderer.getViewport();for(var F=Qa;F--;){Va|=ia[F].animated?ub:0;ia[F].cycle(r,u,Va)}for(F=ia.length;F--;){var aa=ia[F];if(aa.shouldDraw(Va,u)){var ua=aa.style?renderer.applyStyle(aa.style):null;aa.draw(renderer,Va,la,r,V);ua&&renderer.applyStyle(ua)}}}if(V){r=V?V.elements:[];if(N&&N.type==="hover"){u=Hits.diffHits(N.elements,r);u.length>0&&Hits.triggerEvent(N,la,"Out",u)}if(r.length>0){F=V.x;aa=V.y;for(u=r.length;u--;){ua=r[u];var Za=F,cb=
aa,Wa=ua&&ua.drag&&(!ua.canDrag||ua.canDrag(ua,Za,cb));if(Wa){Na=ua;Na.startX=Za;Na.startY=cb}if(Wa)break}Hits.triggerEvent(V,la)}N=r.length>0?COG.extend({},V):null;V=null}k=Ba;p=h;la.redraw=false}animFrame(R)}function ha(r,u,F){V=Hits.init(r,u,F,e(F.x,F.y,true));for(r=Qa;r--;)$a=$a||(ia[r].hitGuess?ia[r].hitGuess(V.x,V.y,Va,la):false);if($a)la.redraw=true}function ka(){la.redraw=true}function za(){var r;if(renderer){r=renderer.getViewport();if(!r){r=renderer.getDimensions();r=Pa.init(Ba,h,Ba+r.width,
h+r.height)}}return r}function wa(){var r=renderer?renderer.getViewport():null;if(r){if(s||b)if(r){var u=f?Ba+E:Ba,F=i?h+Y:h,aa=r.width,ua=r.height;if(s&&s>aa)if(u+aa>s)Ba=f?Ba:s-aa;else if(u<0)Ba=f?Ba:0;if(b&&b>ua)if(F+ua>b)h=i?h:b-ua;else if(F<0)h=i?h:0}M=(new Date).getTime();La("refresh",la,r);la.redraw=true}}function Da(r,u,F,aa,ua){if(F)COG.tweenValue(X,r,F,ua,function(Za,cb){X=Za;if(cb){var Wa=Xa(Ga(X)/Math.LN2);X=Q(2,Wa);aa&&aa()}c()});else{X=r;c()}return la}function ta(r,u,F){r=x(a.minZoom,
pa(a.maxZoom,r));if(r!==ib){var aa=Q(2,r-ib),ua=E/aa|0,Za=Y/aa|0;ib=r;Ya(((u?u:Ba+E)-ua)*aa,((F?F:h+Y)-Za)*aa);k=Ba;p=h;La("zoomLevelChange",r);X=1;wa();la.redraw=true}}function La(){for(var r=la.trigger.apply(null,arguments).cancel,u=ia.length;u--;)r=ia[u].trigger.apply(null,arguments).cancel||r;return!r}function Ya(r,u,F,aa,ua){function Za(){cb+=1;if(cb>=2){Ra=false;ua&&ua()}}var cb=0,Wa=Ha?$.offset(Ha,-E,-Y):null,jb=S?$.offset(S,-E,-Y):null;if(Wa){r=r<Wa.x?Wa.x:r;u=u<Wa.y?Wa.y:u}if(jb){r=r>jb.x?
jb.x:r;u=u>jb.y?jb.y:u}if(F){if((Va&tb)===0){COG.tweenValue(Ba,r,F,aa,function(vb,wb){Ba=vb|0;(wb?Za:ka)();return!Aa});COG.tweenValue(h,u,F,aa,function(vb,wb){h=vb|0;(wb?Za:ka)();return!Aa});Ra=true}}else{Ba=r|0;h=u|0;la.redraw=true;ua&&ua()}}a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,
autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,renderer:"canvas",zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},a);var Ka={},ia=[],Qa=0,bb=document.getElementById(a.container),Na=null,rb=0,qb=null,lb=typeof window.attachEvent!="undefined",$a=false,sb=a.minRefresh,Ba=0,h=0,k=0,p=0,s=null,b=null,f=false,i=false,y=1,E=0,Y=0,V=null,Aa=false,Ha=null,S=null,M=0,N=null,ba=0,X=1,Ea=0,Ca=null,Ra=false,kb=1E3/a.fps|0,Wb,Xb,ib=a.zoomLevel,Jb=B("ACTIVE"),tb=B("PAN"),
Kb=B("ZOOM"),ub=B("ANIMATING"),Va=Jb,la={id:a.id,deviceScaling:y,fastDraw:a.fastDraw||H().requireFastDraw,detach:function(){Ca&&Ca.unbind()},eachLayer:function(r){for(var u=Qa;u--;)r(ia[u])},getLayer:function(r){for(var u=0;u<Qa;u++)if(ia[u].id===r)return ia[u];return null},getZoomLevel:function(){return ib},setLayer:function(r,u){for(var F=0;F<Qa;F++)if(ia[F].id===r){ia.splice(F,1);break}if(u){P(r,u);u.trigger("refresh",la,za())}la.redraw=true;return u},invalidate:ka,refresh:wa,resetScale:function(){X=
1},scale:Da,setZoomLevel:ta,syncXY:function(){},triggerAll:La,removeLayer:function(r){a:{for(var u=Qa;u--;)if(ia[u].id===r){r=u;break a}r=-1}if(r>=0&&r<Qa){la.trigger("layerRemoved",ia[r]);ia.splice(r,1);la.redraw=true}Qa=ia.length},getOffset:function(){return $.init(Ba,h)},getScaleFactor:function(){return X},setMaxOffset:function(r,u,F,aa){s=r;b=u;f=typeof F!="undefined"?F:false;i=typeof aa!="undefined"?aa:false},getViewport:za,updateOffset:Ya,pan:function(r,u,F,aa,ua){Ya(Ba+r,h+u,F,aa,ua)}};y=H().getScaling();
COG.observable(la);la.bind("resync",function(){S=Ha=null});COG.configurable(la,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(a,null,{container:function(r,u){bb=document.getElementById(u);renderer=Gb(a.renderer,la,bb);sa()},inertia:sa,captureHover:sa,scalable:sa,pannable:sa}),true);CANI.init(function(r){la.markers=P("markers",new mb({zindex:20}));Ka=r;renderer=Gb(a.renderer,la,bb);sa();lb?window.attachEvent("onresize",ga):window.addEventListener("resize",
ga,false)});animFrame(R);return la},Ua=function(a){a=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape"},a);COG.extend(this,a);this.id=COG.objId(this.type);this.view=this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};Ua.prototype={constructor:Ua,animate:function(a,g,d,c){na(this,a,g,d,c)},drag:null,prep:function(){},resync:function(a){if(this.xy){a.syncXY([this.xy]);
this.size&&this.updateBounds(Pa.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},rotate:function(a){this.rotation=a},scale:function(a){this.scaling=a},translate:function(a,g){this.translateX=a;this.translateY=g},updateBounds:function(a,g){this.bounds=a;if(g)this.xy=Pa.center(this.bounds)}};var Pb=1E3/60|0,hb=[],Bb=0;ea.prototype=COG.extend(Ua.prototype,{constructor:ea,prep:function(a){return a.arc(this.xy.x,this.xy.y,this.size>>1,0,Math.PI*2)}});va.prototype=COG.extend({},Ua.prototype,{constructor:va});
Ia.prototype=COG.extend({},va.prototype);Fa.prototype=COG.extend({},Ua.prototype,{constructor:Fa});Oa.prototype=COG.extend({},Fa.prototype,{constructor:Oa});fa.prototype={constructor:fa,shouldDraw:function(a){return(a&this.validStates)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null};var Mb=function(a){a=COG.extend({zindex:10},a);var g=[],d=CANI.canvas.pipTransformed,c=COG.extend(new fa(a),{draw:function(e,j,q,D,o){D=e.getViewport();q=D.x1;D=D.y1;for(var J=o?d?o.x-q:o.relXY.x:0,
ga=o?d?o.y-D:o.relXY.y:0,Z=g.length;Z--;){var P=g[Z],sa=P.style||c.style,L,R=e.applyTransform(P,q,D);if(drawData=P.prep(e,R?R.x:q,R?R.y:D,j)){if(o&&e.hitTest(drawData,J,ga)){o.elements.push(Hits.initHit(P.type,P,P.draggable?P.drag:null));L=o.type+"Style";sa=P[L]||c[L]||sa}P=sa?e.applyStyle(sa):null;drawData.draw(q,D,j);P&&e.applyStyle(P)}R&&R.undo&&R.undo()}},getDrawables:function(){return[]},hitGuess:function(e,j){for(var q=false,D=g.length;!q&&D--;){var o=g[D];if(!(q=q))q=(o=o.bounds)&&e>=o.x1&&
e<=o.x2&&j>=o.y1&&j<=o.y2;q=q}return q}});c.bind("refresh",function(e,j,q){g=c.getDrawables(j,q)});return c},mb=function(a){function g(j){for(var q=c.length;q--;)c[q].resync(j);c.sort(function(D,o){var J=o.xy.y-D.xy.y;return J!=0?J:o.xy.x-D.xy.y});j.redraw=true}function d(j,q){g(q)}a=COG.extend({zindex:10},a);var c=[],e=COG.extend(new Mb(a),{add:function(j,q){if(j){j.layer=e;var D=e.view;if(D){j.resync(D);D.redraw=true}if(q)c.unshift(j);else c[c.length]=j}},clear:function(){c=[]},find:function(){return[].concat(c)},
getDrawables:function(){return c}});e.bind("parentChange",d);e.bind("resync",d);return e};COG.extend(K,{ex:COG.extend,ticks:da,getConfig:H,userMessage:function(a,g,d){K.trigger("userMessage",a,g,d)},XY:$,XYRect:Pa,Dimensions:Qb,Vector:fb,Hits:Hits,Generator:Db,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,viewState:B,View:Lb,ViewLayer:fa,ImageLayer:function(a,g){function d(D,o){var J=e?Math.abs(e.x1-o.x1)+Math.abs(e.y1-o.y1):0;if(c&&(!e||J>256))c(D,o,function(ga){e=Pa.copy(o);
j=[].concat(ga)})}g=COG.extend({imageLoadArgs:{}},g);var c=a?Db.init(a,g).run:null,e=null,j=[],q=COG.extend(new fa(g),{draw:function(D){D.drawTiles(j)}});q.bind("refresh",function(D,o,J){d(o,J)});return q},ImageGenerator:function(a){a=COG.extend({relative:false,padding:2},a);a={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(a);return a},Drawable:Ua,Marker:ea,Poly:va,Line:Ia,ImageDrawable:Fa,ImageMarker:Oa,DrawLayer:Mb,ShapeLayer:mb});COG.observable(K);
var Sa=K.Geo=function(){function a(h){for(var k=null,p=1;!k&&p<arguments.length;p++)k=j(h,arguments[p]);k=k?k:j(h);if(!k)throw Error("Unable to find GEO engine with "+h+" capability");return k}function g(h){h=parseFloat(h)*Z;h=O(h);var k=ha*h;return Ga((1+h)/(1-h)*Q((1-k)/(1+k),ha))/2}function d(h){return parseFloat(h)*Z}function c(h){h=Q(Math.E,-h);for(var k=ra-2*Ja(h),p=q(k,h),s=0;s<za&&U(k-p)>ka;){k=p;p=q(k,h);s++}return p*P}function e(h){return h%360*P}function j(h,k){var p=null;for(var s in ia)if(k){if(s==
k&&ia[s][h]){p=ia[s];break}}else if(ia[s][h]){p=ia[s];break}return p}function q(h,k){var p=ha*O(h);return ra-2*Ja(k*Q((1-p)/(1+p),ha/2))}function D(h,k,p,s){k=o(k);h.add(s(k,p));return k.length}function o(h){var k=h?h.length:0,p=Array(k);for(k=k;k--;)p[k]=Sa.Position.init(h[k][1],h[k][0]);return Sa.Position.vectorize(p,lb)}function J(h,k,p){return new Ba(h,k,p)}var ga=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],Z=Math.PI/180,P=180/Math.PI,sa=ra,L=-sa,
R=-ma,ha=0.08181919084262157,ka=1.0E-7,za=12,wa=null,Da={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ta=function(){function h(b){return b?p(b.lat,b.lon):null}function k(b){return!b||b.lat===0&&b.lon===0}function p(b,f){return{lat:parseFloat(b?b:0),lon:parseFloat(f?f:0)}}function s(b){if(b)if(typeof b.lat!=="undefined")return h(b);else{if(b.split)for(var f=[" ",","],i=0;i<f.length;i++){var y=b.split(f[i]);if(y.length===2)return p(y[0],y[1])}}else return p();
return null}return{calcDistance:function(b,f){if(k(b)||k(f))return 0;var i=(f.lat-b.lat)*Z>>1,y=(f.lon-b.lon)*Z>>1;i=O(i)*O(i)+W(b.lat*Z)*W(f.lat*Z)*O(y)*O(y);return 6371*2*Ma(qa(i),qa(1-i))},copy:h,empty:k,equal:function(b,f){return b&&f&&b.lat==f.lat&&b.lon==f.lon},fromMercatorPixels:function(b,f){return p(c(f),e(b))},generalize:function(b,f,i){var y=b.length,E=[],Y=null;i||(i=250);i/=1E3;COG.info("generalizing positions, must include "+f.length+" positions");for(var V=y;V--;)if(V===0)E.unshift(b[V]);
else{var Aa=!Y||ta.inArray(b[V],f)?i:ta.calcDistance(Y,b[V]);if(b[V]&&Aa>=i){E.unshift(b[V]);Y=b[V]}}COG.info("generalized "+y+" positions into "+E.length+" positions");return E},inArray:function(b,f){for(var i=ta.equal,y=f.length;y--;)if(i(b,f[y]))return true;return false},inBounds:function(b,f){var i=!(ta.empty(b)||ta.empty(f));return i=(i=i&&b.lat>=f.min.lat&&b.lat<=f.max.lat)&&b.lon>=f.min.lon&&b.lon<=f.max.lon},init:p,offset:function(b,f,i){var y=b.lat*Z;b=b.lon*Z;f=y+f/6371;i=ja(O(i/6371)/W(y));
i=b+i;f=(f+ra)%Math.PI-ra;i%=ma;return p(f*P,i*P)},parse:s,parseArray:function(b){var f=b.length,i=Array(f);for(f=f;f--;)i[f]=s(b[f]);return i},toMercatorPixels:function(b){return T5.XY.init(d(b.lon),g(b.lat))},toString:function(b){return b?b.lat+" "+b.lon:""},vectorize:function(b,f){function i(){for(var V=0,Aa=f.chunkSize,Ha=y;Ha--;){E[Ha]=T5.GeoXY.init(b[Ha]);V+=1;if(V>Aa)break}y=Ha;if(y<=0)f.callback&&f.callback(E);else animFrame(i)}var y=b.length,E=Array(y);f=COG.extend({chunkSize:500,async:true,
callback:null},f);if(!f.async){for(var Y=y;Y--;)E[Y]=T5.GeoXY.init(b[Y]);return E}animFrame(i);return null}}}(),La=function(){function h(b,f,i){var y=T5.XY.init(0,f.lat-b.lat);if(typeof i==="undefined")i=true;y.x=i&&b.lon>f.lon?360-b.lon+f.lon:f.lon-b.lon;return y}function k(b,f){return La.init(ta.init(b.min.lat-f,b.min.lon-f%360),ta.init(b.max.lat+f,b.max.lon+f%360))}function p(b){var f=h(b.min,b.max);return ta.init(b.min.lat+(f.y>>1),b.min.lon+(f.x>>1))}function s(b,f){return{min:ta.parse(b),max:ta.parse(f)}}
return{calcSize:h,createBoundsFromCenter:function(b,f){var i=f/6371,y=b.lat*Z,E=b.lon*Z,Y=y-i,V=y+i;if(Y>L&&V<sa){y=ja(O(i)/W(y));i=(E-y)%ma;E=(E+y)%ma}else{Y=x(Y,L);V=pa(V,sa);i=R;E=ma}return La.init(ta.init(Y*P,i*P),ta.init(V*P,E*P))},expand:k,forPositions:function(b,f){var i=null,y=T5.ticks();f||(f="auto");for(var E=b.length;E--;)if(i){var Y=h(i.min,b[E],false),V=h(b[E],i.max,false);if(Y.x<0)i.min.lon=b[E].lon;if(Y.y<0)i.min.lat=b[E].lat;if(V.x<0)i.max.lon=b[E].lon;if(V.y<0)i.max.lat=b[E].lat}else i=
s(b[E],b[E]);if(f){if(f=="auto"){E=h(i.min,i.max);f=x(E.x,E.y)*0.3}i=k(i,f)}COG.trace("calculated bounds for "+b.length+" positions",y);return i},getCenter:p,getGeoHash:function(b){var f=T5.Geo.GeoHash.encode(b.min.lat,b.min.lon);b=T5.Geo.GeoHash.encode(b.max.lat,b.max.lon);COG.info("min hash = "+f+", max hash = "+b)},getZoomLevel:function(b,f){var i=p(b);i=pa(Xa(U(i.lat)*0.05),ga.length);var y=ga[i],E=h(b.min,b.max);i=ca(Ga(ga[3]*f.height/E.y)/Ga(2));y=ca(Ga(y*f.width/E.x)/Ga(2));return pa(isNaN(i)?
1E3:i,isNaN(y)?1E3:y)},init:s,isEmpty:function(b){return!b||ta.empty(b.min)||ta.empty(b.max)},toString:function(b){return"min: "+ta.toString(b.min)+", max: "+ta.toString(b.max)}}}(),Ya=function(){var h=/^(\d+).*$/,k=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(p,s){h.lastIndex=-1;if(h.test(p))for(var b=p.replace(h,"$1"),f=s.split(","),i=0;i<f.length;i++){k.lastIndex=-1;if(k.test(f[i])){var y=k.exec(f[i]);if(b>=parseInt(y[1],10)&&b<=parseInt(y[2],10))return true}else if(b==f[i])return true}return false},
normalize:function(p){if(!p)return"";p=p.toUpperCase();if(!wa){var s=[];for(var b in Da)s.push(b);wa=RegExp("(\\s)("+s.join("|")+")(\\s|$)","i")}wa.lastIndex=-1;if(s=wa.exec(p))p=p.replace(wa,"$1"+Da[s[2]]);return p},toString:function(p){return p.streetDetails+" "+p.location}}}(),Ka=K.GeoXY=function(){function h(s,b){if(s.length){for(var f,i,y,E,Y=s.length;Y--;){h(s[Y],b);f=typeof f==="undefined"||s.x<f?s.x:f;i=typeof i==="undefined"||s.y<i?s.y:i;y=typeof y==="undefined"||s.x>y?s.x:y;E=typeof E===
"undefined"||s.y>E?s.y:E}return Pa.init(f,i,E,E)}else if(s.mercXY){f=s.mercXY;s.x=(f.x+Math.PI)/b|0;s.y=(Math.PI-f.y)/b|0;s.rpp=b}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return s}function k(s,b){if(s.length)for(var f=s.length;f--;)k(s[f],b);else{s.mercXY=$.init(s.x*b-Math.PI,Math.PI-s.y*b);s.pos=ta.fromMercatorPixels(s.mercXY.x,s.mercXY.y)}return s}function p(s,b,f){s.pos=b;s.mercXY=ta.toMercatorPixels(b);(f=typeof f!=="undefined"?f:s.rpp)&&h(s,f)}return{init:function(s,b){var f=
$.init();p(f,s,b);return f},sync:h,syncPos:k,toPos:function(s,b){b=b?b:_self.rpp;return ta.fromMercatorPixels(s.x*b-Math.PI,Math.PI-s.y*b)},updatePos:p}}(),ia={},Qa=function(){return{bestResults:function(h,k){k||(k=20);for(var p=h.length>0?h[0]:null,s=[],b=0;b<h.length;b++)if(p&&h[b]&&p.matchWeight-h[b].matchWeight<=k)s.push(h[b]);else break;return s}}}(),bb=function(h){h=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},h);return COG.extend(h,{toString:function(){return h.caption+
(h.matchWeight?" ("+h.matchWeight+")":"")}})},Na=function(){function h(b,f){var i=new T5.ShapeLayer;f.geometry&&ta.vectorize(f.geometry,{callback:function(y){i.add(new T5.Line(y,{style:"waypoints",simplify:true}));b.setLayer("route",i)}})}function k(b){for(var f=p.Unknown,i=s,y=0;y<i.length;y++){i[y].regex.lastIndex=-1;var E=i[y].regex.exec(b);if(E){f=i[y].customCheck?i[y].customCheck(b,E):i[y].turnType;break}}return f}var p={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",
TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},s=function(){var b=[];b.push({regex:/continue/i,turnType:p.Continue});b.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(f,i){return/bear/i.test(i[1])?p.TurnLeftSlight:p.TurnLeft}});
b.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(f,i){return/bear/i.test(i[1])?p.TurnRightSlight:p.TurnRight}});b.push({regex:/enter\s(roundabout|rotaty)/i,turnType:p.EnterRoundabout});b.push({regex:/take.*?ramp/i,turnType:p.Ramp});b.push({regex:/take.*?exit/i,turnType:p.RampExit});b.push({regex:/make(.*?)u\-turn/i,customCheck:function(f,i){return/right/i.test(i[1])?p.UTurnRight:p.UTurnLeft}});b.push({regex:/proceed/i,turnType:p.Start});b.push({regex:/arrive/i,turnType:p.Arrive});
b.push({regex:/fell\sthrough/i,turnType:p.Merge});return b}();return{calculate:function(b){b=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},b);var f=a("route");f&&f.route(b,function(i){if(b.generalize)i.geometry=ta.generalize(i.geometry,i.getInstructionPositions());if(b.map){h(b.map,i);b.autoFit&&b.map.gotoBounds(i.boundingBox)}b.success&&b.success(i)})},createMapOverlay:h,parseTurnType:k,TurnType:p,Instruction:function(b){var f=b=COG.extend({position:null,
description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},b),i=b.description;i=i.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");f.description=i;if(!b.turnType)b.turnType=k(b.description);return b},RouteData:function(b){b=COG.extend({geometry:[],instructions:[],boundingBox:null},b);if(!b.boundingBox)b.boundingBox=La.forPositions(b.geometry);return COG.extend({getInstructionPositions:function(){for(var f=[],i=0;i<b.instructions.length;i++)b.instructions[i].position&&f.push(b.instructions[i].position);
return f}},b)}}}(),rb="featurecollection",qb="feature",lb={async:false},$a={processor:null,group:"shapes",layerClass:mb},sb={point:COG.extend({},$a,{processor:function(h,k,p,s){k=o([k.coordinates],lb);if(k.length>0)if(p=s.marker(k[0],p)){h.add(p);return k.length}},group:"markers",layerClass:mb}),linestring:COG.extend({},$a,{processor:function(h,k,p,s){k=o(k&&k.coordinates?k.coordinates:[]);return D(h,k,p,s.line)}}),multilinestring:COG.extend({},$a,{processor:function(h,k,p,s){k=k&&k.coordinates?k.coordinates:
[];for(var b=0,f=k.length;f--;)b+=D(h,k[f],p,s.line);return b}}),polygon:COG.extend({},$a,{processor:function(h,k,p,s){k=k&&k.coordinates?k.coordinates:[];if(k.length>0)return D(h,k[0],p,s.poly);return 0}}),multipolygon:COG.extend({},$a,{processor:function(h,k,p,s){k=k&&k.coordinates?k.coordinates:[];for(var b=0,f=0;f<k.length;f++)b+=D(h,k[f][0],p,s.poly);return b}})},Ba=function(h,k,p,s){function b(N,ba){var X=N.processor,Ea=Y+N.group,Ca=COG.extend({},N,p,{properties:ba.properties});if(X){var Ra=
M[Ea];if(!Ra){Ra=new N.layerClass({id:Ea});M[Ea]=Ra}globalLayers=M;return X(Ra,ba.data,Ca,s)}return 0}function f(N,ba){var X=N&&N.type?N.type.toLowerCase():null;return X&&X===qb?f(N.geometry,N.properties):{type:X,isCollection:X?X===rb:false,definition:sb[X],data:N,properties:ba?ba:N.properties}}function i(N){var ba=0,X=COG.extend({},p),Ea=V;N=N?N:(new Date).getTime();if(!Ha){for(;Ea<Aa;Ea++){N=f(E?E(h[Ea]):h[Ea]);var Ca=null;if(N.isCollection){X.layerPrefix=Y+S++ +"-";Ha=J(N.data.features,function(Ra){Ha=
null;for(var kb in Ra)M[kb]=Ra[kb]},X);Ca+=1}else if(N.definition)Ca=b(N.definition,N);ba+=Ca?Ca:1;if(ba>=y)break}V=Ea+1;if(Ha||V<Aa)animFrame(i);else k&&k(M)}}p=COG.extend({vectorsPerCycle:Sa.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},p);s=COG.extend({marker:function(N){return new ea({xy:N})},line:function(N,ba){return new va(N,COG.extend({},p,ba))},poly:function(N,ba){return new va(N,COG.extend({fill:true},p,ba))}},s);var y=p.vectorsPerCycle,E=p.rowPreParse,Y=p.layerPrefix,
V=0,Aa=0,Ha=null,S=0,M={};if(h){if(typeof h.length==="undefined")h=[h];Aa=h.length;animFrame(i)}};K.GeoJSON={parse:J};K.Map=function(h){function k(M){try{var N=Sa.Position.init(M.coords.latitude,M.coords.longitude),ba=M.coords.accuracy/1E3;S.trigger("locationUpdate",M,ba);if(V){if(!E){E=new Sa.UI.LocationOverlay({pos:N,accuracy:ba});E.update(S.getTileLayer());S.setLayer("location",E)}var X=Sa.BoundingBox.createBoundsFromCenter(N,Math.max(ba,1));S.gotoBounds(X)}else{E.pos=N;E.accuracy=ba;E.update(S.getTileLayer());
b(N,null,COG.easing("sine.out"))}V=false}catch(Ea){COG.exception(Ea)}}function p(M){COG.info("caught location tracking error:",M)}function s(M,N,ba){S.setZoomLevel(N);b(M,ba)}function b(M,N,ba,X){M=Ka.init(M,Sa.radsPerPixel(S.getZoomLevel()));S.updateOffset(M.x-(self.width>>1),M.y-(self.height>>1),ba,X,function(){S.refresh();S.trigger("boundsChange",S.getBoundingBox());N&&N(S)})}h=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18,pannable:true,scalable:true},
h);var f={NONE:0,SINGLE:1,WATCH:2},i=$.init(),y=f.NONE,E=null,Y=0,V=true,Aa=0,Ha=h.tapExtent;h.adjustScaleFactor=function(M){return Math.pow(2,(M<1?Math.floor:Math.ceil)(Math.log(M)))};var S=COG.extend(new Lb(h),{getBoundingBox:function(){var M=S.getViewport();return M?Sa.BoundingBox.init(Ka.toPos($.init(M.x1,M.y2),Aa),Ka.toPos($.init(M.x2,M.y1),Aa)):null},getCenterPosition:function(){var M=S.getViewport();if(M){M=$.init(M.x1+(M.width>>1),M.y1+(M.height>>1));return Ka.toPos(M,Aa)}return null},gotoBounds:function(M,
N){var ba=Sa.BoundingBox.getZoomLevel(M,S.getViewport());s(Sa.BoundingBox.getCenter(M),ba,N)},gotoPosition:s,panToPosition:b,syncXY:function(M,N){return(N?Ka.syncPos:Ka.sync)(M,Aa)},locate:function(){S.trackStart(f.SINGLE);setTimeout(S.trackCancel,1E4)},trackStart:function(M){if(navigator.geolocation&&!Y){y=M?M:f.WATCH;V=true;Y=navigator.geolocation.watchPosition(k,p,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){Y&&navigator.geolocation&&navigator.geolocation.clearWatch(Y);
S.removeLayer("location");E=null;y=f.NONE;Y=0},animateRoute:function(M,N,ba,X){var Ea=S.getLayer("route");if(Ea)(M=Ea.getAnimation(M,N,ba,X))&&M.addToView(S)}});S.bind("pan",function(){y===f.SINGLE&&S.trackCancel()});S.bind("tap",function(M,N,ba,X){M=Ka.toPos(X,Aa);var Ea=Ka.toPos($.offset(X,-Ha,Ha),Aa);X=Ka.toPos($.offset(X,Ha,-Ha),Aa);S.trigger("geotap",N,ba,M,La.init(Ea,X))});S.bind("refresh",function(){if($.absSize($.diff(i,S.getOffset()))>h.boundsChangeThreshold){i=$.copy(S.getOffset());S.trigger("boundsChange",
S.getBoundingBox())}});S.bind("zoomLevelChange",function(M,N){var ba;Aa=Sa.radsPerPixel(N);ba=ma/Aa|0;S.setMaxOffset(ba,ba,true,false);S.resetScale();S.triggerAll("resync",S);S.refresh()});return S};K.GeoShape=function(h,k){k=COG.extend({autoParse:true},k);for(var p=Array(h.length),s=k.autoParse,b=T5.Geo.Position.parse,f=h.length;f--;)p[f]=T5.GeoXY.init(s?b(h[f]):h[f]);return new T5.Poly(p,k)};K.LocationOverlay=function(h){h=COG.extend({pos:null,accuracy:null,zindex:90},h);var k=new Image,p=T5.XY.init(),
s=T5.XY.init(),b=null;k.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
k.onload=function(){p=T5.XY.init(k.width>>1,k.height>>1)};var f=COG.extend(new T5.ViewLayer(h),{pos:h.pos,accuracy:h.accuracy,drawAccuracyIndicator:false,draw:function(i,y){var E=s.x-y.x,Y=s.y-y.y;if(b){i.fillStyle="rgba(30, 30, 30, 0.2)";i.beginPath();i.arc(E,Y,b,0,Math.PI*2,false);i.fill()}k.complete&&k.width>0&&i.drawImage(k,E-p.x,Y-p.y,k.width,k.height)},update:function(i){if(i){b=i.getPixelDistance(f.accuracy)>>1;s=i.getGridXYForPosition(f.pos)}}});f.bind("gridUpdate",function(i,y){f.update(y)});
return f};return{distanceToString:function(h){if(h>1E3)return~~(h/10)/100+" km";return h?h+" m":""},dist2rad:function(h){return h/6371},getEngine:a,lat2pix:g,lon2pix:d,pix2lat:c,pix2lon:e,radsPerPixel:function(h){return ma/(256<<h)},Position:ta,BoundingBox:La,Radius:function(h,k){return{distance:parseInt(h,10),uom:k}},Address:function(h){return h=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},h)},A:Ya,GeocodeFieldWeights:{streetDetails:50,location:50},
AddressCompareFns:{},Engine:function(h){if(!h.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var k=COG.extend({remove:function(){delete ia[k.id]}},h);return ia[k.id]=k},Search:Qa,GeoSearchResult:bb,LocationSearch:function(h){function k(i,y){navigator.geolocation.clearWatch(s);s=0;if(b){clearTimeout(b);b=0}y&&y([i],h)}function p(i){COG.info("caught location tracking error:",i)}h=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},
h);var s=0,b=0,f=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(i,y){if(navigator.geolocation&&!s){s=navigator.geolocation.watchPosition(function(E){var Y=ta.init(E.coords.latitude,E.coords.longitude);E=new bb({id:1,caption:"Current Location",pos:Y,accuracy:E.coords.accuracy/1E3,matchWeight:100});if(!f||E.accuracy<f.accuracy)f=E;if(!h.requiredAccuracy||f.accuracy<h.requiredAccuracy)k(f,y)},p,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(h.searchTimeout)b=setTimeout(function(){f&&
k(f,y)},h.searchTimeout)}}},h))},Routing:Na}}()})(T5);
