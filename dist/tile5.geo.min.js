COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var Y=arguments[0]||{},ta,O=1,G=arguments.length;O<G;O++)if((ta=arguments[O])!==null)for(var p in ta){var s=ta[p];if(Y!==s)if(s!==undefined)Y[p]=s}return Y};
(function(){var Y=Object.prototype.hasOwnProperty,ta=0,O={};O.toID=function(G){return G.replace(/\s/g,"-")};O.objId=function(G){return(G?G:"obj")+ta++};O.isFunction=function(G){return toString.call(G)==="[object Function]"};O.isArray=function(G){return toString.call(G)==="[object Array]"};O.isPlainObject=function(G){if(!G||toString.call(G)!=="[object Object]"||G.nodeType||G.setInterval)return false;if(G.constructor&&!Y.call(G,"constructor")&&!Y.call(G.constructor.prototype,"isPrototypeOf"))return false;
var p;for(p in G);return p===undefined||Y.call(G,p)};O.isEmptyObject=function(G){for(var p in G)return false;return true};O.isXmlDocument=function(G){return toString.call(G)==="[object Document]"};O.contains=function(G,p){var s=G,H=arguments,K=1;if(p&&module.isArray(p)){H=p;K=0}for(K=K;K<H;K++)s=s&&typeof foo[H[K]]!=="undefined";return s};O.formatStr=function(G){if(arguments.length<=1)return G;for(var p=arguments.length-2,s=0;s<=p;s++)G=G.replace(RegExp("\\{"+s+"\\}","gi"),arguments[s+1]);return G};
O.wordExists=function(G,p){var s="";if(p.toString)p=p.toString();for(var H=0;H<p.length;H++)s+=!/\w/.test(p[H])?"\\"+p[H]:p[H];return RegExp("(^|\\s|\\,)"+s+"(\\,|\\s|$)","i").test(G)};COG.extend(COG,O)})();
(function(){function Y(s){return typeof console!=="undefined"?function(){console[s](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ta=window.console&&window.console.markTimeline,O=Y("error"),G=Y("info"),p=function(){return ta?function(s,H){console.markTimeline(s+(H?": "+((new Date).getTime()-H)+"ms":""))}:function(){}}();COG.extend(COG,{trace:p,debug:Y("debug"),info:G,warn:Y("warn"),error:O,exception:function(s){if(O)for(var H in s)G("ERROR DETAIL: "+
H+": "+s[H])}})})();
(function(){function Y(O,G){var p=O.obsHandlers;p[G]||(p[G]=[]);return p[G]}var ta=0;COG.observable=function(O){if(!O)return null;if(!O.obsHandlers)O.obsHandlers={};if(!(O.bind||O.trigger||O.unbind)){O.bind=function(G,p){var s="callback"+ta++;Y(O,G).unshift({fn:p,id:s});return s};O.triggerCustom=function(G,p){var s=Y(O,G),H={cancel:false,name:G},K;p&&COG.extend(H,p);if(!s)return null;K=Array.prototype.slice.call(arguments,2);O.eventInterceptor&&O.eventInterceptor(G,H,K);K.unshift(H);for(var o=s.length;o--&&
!H.cancel;)s[o].fn.apply(this,K);return H};O.trigger=function(G){var p=Array.prototype.slice.call(arguments,1);p.splice(0,0,G,null);return O.triggerCustom.apply(this,p)};O.unbind=function(G,p){if(typeof G==="undefined")O.obsHandlers={};else for(var s=Y(O,G),H=0;s&&H<s.length;H++)if(s[H].id===p){s.splice(H,1);break}return O}}return O}})();
(function(){function Y(p,s){p[s]||(p[s]=function(H){return p.configure(s,H)})}function ta(p){p.gtConfId="configurable"+G++;p.gtConfig={};p.gtConfigFns=[];return p.gtConfig}var O={},G=0;COG.paramTweaker=function(p,s,H){return function(K,o){if(typeof o!=="undefined"){if(K in p)p[K]=o;H&&K in H&&H[K](K,o)}else return s&&K in s?s[K](K):p[K]}};COG.configurable=function(p,s,H,K){if(p){p.gtConfId||ta(p);var o=p.gtConfId,J=p.gtConfig,E=p.gtConfigFns;O[o]=p;E.push(H);for(H=s.length;H--;){J[s[H]]=true;K&&Y(p,
s[H])}if(!p.configure)p.configure=function(M,$){if(J[M]){for(var u=E.length;u--;){var B=E[u](M,$);if(typeof B!=="undefined")return B}return O[o]}return null}}}})();
(function(){function Y(p){var s=document.createElement("script"),H=false;s.src=p;s.async=true;s.onload=s.onreadystatechange=function(){if(!H&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){H=true;s.onload=s.onreadystatechange=null;s&&s.parentNode&&s.parentNode.removeChild(s)}};O||(O=document.getElementsByTagName("head")[0]);O.appendChild(s)}var ta=0,O,G=this;COG.jsonp=function(p,s,H){p+=p.indexOf("?")>=0?"&":"?";var K="json"+ ++ta;G[K]=function(o){s(o);G[K]=null;try{delete G[K]}catch(J){}};
Y(p+(H?H:"callback")+"="+K);return K}})();
(function(){var Y=1.70158,ta=Math.PI/2,O=Math.abs,G=Math.pow,p=Math.sin,s=Math.asin,H=Math.cos,K={linear:function(o,J,E,M){return E*o/M+J},backin:function(o,J,E,M){return E*(o/=M)*o*((Y+1)*o-Y)+J},backout:function(o,J,E,M){return E*((o=o/M-1)*o*((Y+1)*o+Y)+1)+J},backinout:function(o,J,E,M){return(o/=M/2)<1?E/2*o*o*(((Y*=1.525)+1)*o-Y)+J:E/2*((o-=2)*o*(((Y*=1.525)+1)*o+Y)+2)+J},bouncein:function(o,J,E,M){return E-K.bounceout(M-o,0,E,M)+J},bounceout:function(o,J,E,M){return(o/=M)<1/2.75?E*7.5625*o*
o+J:o<2/2.75?E*(7.5625*(o-=1.5/2.75)*o+0.75)+J:o<2.5/2.75?E*(7.5625*(o-=2.25/2.75)*o+0.9375)+J:E*(7.5625*(o-=2.625/2.75)*o+0.984375)+J},bounceinout:function(o,J,E,M){return o<M/2?K.bouncein(o*2,0,E,M)/2+J:K.bounceout(o*2-M,0,E,M)/2+E/2+J},cubicin:function(o,J,E,M){return E*(o/=M)*o*o+J},cubicout:function(o,J,E,M){return E*((o=o/M-1)*o*o+1)+J},cubicinout:function(o,J,E,M){if((o/=M/2)<1)return E/2*o*o*o+J;return E/2*((o-=2)*o*o+2)+J},elasticin:function(o,J,E,M,$,u){if(o==0)return J;if((o/=M)==1)return J+
E;u||(u=M*0.3);if(!$||$<O(E)){$=E;E=u/4}else E=u/TWO_PI*s(E/$);return-($*G(2,10*(o-=1))*p((o*M-E)*TWO_PI/u))+J},elasticout:function(o,J,E,M,$,u){var B;if(o==0)return J;if((o/=M)==1)return J+E;u||(u=M*0.3);if(!$||$<O(E)){$=E;B=u/4}else B=u/TWO_PI*s(E/$);return $*G(2,-10*o)*p((o*M-B)*TWO_PI/u)+E+J},elasticinout:function(o,J,E,M,$,u){var B;if(o==0)return J;if((o/=M/2)==2)return J+E;u||(u=M*0.3*1.5);if(!$||$<O(E)){$=E;B=u/4}else B=u/TWO_PI*s(E/$);if(o<1)return-0.5*$*G(2,10*(o-=1))*p((o*M-B)*TWO_PI/u)+
J;return $*G(2,-10*(o-=1))*p((o*M-B)*TWO_PI/u)*0.5+E+J},quadin:function(o,J,E,M){return E*(o/=M)*o+J},quadout:function(o,J,E,M){return-E*(o/=M)*(o-2)+J},quadinout:function(o,J,E,M){if((o/=M/2)<1)return E/2*o*o+J;return-E/2*(--o*(o-2)-1)+J},sinein:function(o,J,E,M){return-E*H(o/M*ta)+E+J},sineout:function(o,J,E,M){return E*p(o/M*ta)+J},sineinout:function(o,J,E,M){return-E/2*(H(Math.PI*o/M)-1)+J}};COG.tweenValue=function(o,J,E,M,$){function u(ka){var V=ka-B,la=E(V,o,L,M),ha=B+M<=ka;ka=!ha;if($){V=$(la,
ha,V);ka=typeof V!="undefined"?V&&ka:ka}ka&&animFrame(u)}var B=(new Date).getTime(),L=J-o;animFrame(u);return{}};COG.easing=function(o){return K[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(o,J){K[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]=J}})();
(function(){var Y=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ta=/^(\d+H)?(\d+M)?(\d+S)?$/,O={8601:function(p){p=p.split("T");var s=null;s=null;var H=0,K=0;Y.lastIndex=-1;s=Y.exec(p[0]);H+=s[3]?parseInt(s[3].slice(0,-1),10):0;ta.lastIndex=-1;s=ta.exec(p[1]);K+=s[1]?parseInt(s[1].slice(0,-1),10)*3600:0;K+=s[2]?parseInt(s[2].slice(0,-1),10)*60:0;K+=s[3]?parseInt(s[3].slice(0,-1),10):0;return new G(H,K)}},G=COG.Duration=function(p,s){return{days:p?p:0,seconds:s?s:0}};COG.addDuration=function(){for(var p=new G,s=arguments.length;s--;){p.days+=
arguments[s].days;p.seconds+=arguments[s].seconds}if(p.seconds>=86400){p.days+=~~(p.seconds/86400);p.seconds%=86400}return p};COG.formatDuration=function(p){var s,H,K="";if(p.days)K=p.days+" days ";if(p.seconds){p=p.seconds;if(p>=3600){s=~~(p/3600);p-=s*3600}if(p>=60){H=Math.round(p/60);p-=H*60}if(s)K=K+s+(s>1?" hrs ":" hr ")+(H?(H>10?H:"0"+H)+" min ":"");else if(H)K=K+H+" min";else if(p>0)K=K+(p>10?p:"0"+p)+" sec"}return K};COG.parseDuration=function(p,s){var H=s?O[s]:null;if(H)return H(p);COG.Log.warn("Could not find duration parser for specified format: "+
s);return new G}})();
INTERACT=function(){function Y(u){return function(B,L,ka){(ka?ka:u?document.body:document).addEventListener(B,L,false)}}function ta(u){return function(B,L,ka){(ka?ka:u?document.body:document).removeEventListener(B,L,false)}}function O(u,B,L){(L?L:document).attachEvent("on"+u,B)}function G(u,B,L){(L?L:document).detachEvent("on"+u,B)}function p(u,B){return{x:u?u:0,y:B?B:0,count:1}}function s(u,B){M.push(COG.extend({handler:null,checks:{},type:u},B))}function H(u){var B=0,L=0;if(u.offsetParent){do{B+=u.offsetLeft;
L+=u.offsetTop;u=u.offsetParent}while(u)}return{x:B,y:L}}function K(u,B){return{source:u,target:B.target?B.target:B.srcElement}}function o(u,B){for(var L=u.target?u.target:u.srcElement;L&&L!==B&&L.nodeName&&L.nodeName.toUpperCase()!="CANVAS";)L=L.parentNode;return L&&L===B}function J(u,B){return{x:u.x-(B?B.x:0),y:u.y-(B?B.y:0)}}function E(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}var M=[],$=function(u,B,L){function ka(ca,ma,ra,F){var aa=0,
ia=0,C=0;COG.tweenValue(0,ca,ra,F,function(da){C=aa;aa=da});COG.tweenValue(0,ma,ra,F,function(da){V.trigger("pan",aa-C,da-ia);ia=da})}L=COG.extend({binder:null,unbinder:null,observable:null},L);for(var V=L.observable,la=null,ha=[],ja=[],xa,Ha,ya={bind:function(){return V.bind.apply(null,arguments)},pannable:function(ca){la=COG.extend({inertia:true},ca);return ya},unbind:function(){V.unbind();for(var ca=0;ca<ha.length;ca++)ha[ca].unbind();return ya}},Ma=0;Ma<B.length;Ma++)ha.push(B[Ma](u,V,L));V.bind("pointerDown",
function(){ja=[];Ha=xa=0});V.bind("pointerMove",function(ca,ma,ra,F){if(la){ja[ja.length]={ticks:(new Date).getTime(),x:F.x,y:F.y};V.trigger("pan",F.x,F.y)}xa+=F.x?F.x:0;Ha+=F.y?F.y:0});V.bind("pointerUp",function(ca,ma,ra){if(Math.abs(xa)>20||Math.abs(Ha)>20){if(la){ra=ja.length;var F,aa;ma=0;for(aa=ja.length;--aa>1&&ma<50;)ma+=ja[aa].ticks-ja[aa-1].ticks;if(ra-aa>1){ca=ja[ra-1].x-ja[aa].x;F=ja[ra-1].y-ja[aa].y;aa=Math.sqrt(ca*ca+F*F)|0;if(aa>15){ca=ja[ra-1].x-ja[0].x;F=ja[ra-1].y-ja[0].y;aa=Math.sqrt(ca*
ca+F*F)|0;ra=Math.asin(F/aa);ma=aa*500/ma|0;ma=ma>300?300:ma;ka(Math.cos(ca>0?ra:Math.PI-ra)*ma,Math.sin(ra)*ma,COG.easing("sine.out"),500)}}}}else V.trigger("tap",ma,ra)});return ya};s("pointer",{handler:function(u,B,L){function ka(C){if(o(C,u))if(Ma=ja(C)){u.style.cursor="move";E(C);aa=C.pageX?C.pageX:C.screenX;ia=C.pageY?C.pageY:C.screenY;ca=p(aa,ia);ma=H(u);B.triggerCustom("pointerDown",K("mouse",C),ca,J(ca,ma))}}function V(C){ra=C.pageX?C.pageX:C.screenX;F=C.pageY?C.pageY:C.screenY;if(o(C,u))xa(C,
Ma?"pointerMove":"pointerHover")}function la(C){if(Ma&&ja(C)){Ma=false;if(o(C,u)){u.style.cursor="default";xa(C,"pointerUp")}}}function ha(C){if(o(C,u)){var da;C=C||window.event;if(C.detail)da=C.axis===2?-C.detail*Ha:0;else{da=C.wheelDeltaY?C.wheelDeltaY:C.wheelDelta;if(window.opera)da=-da}if(da!==0){var Ca=p(ra,F);B.triggerCustom("zoom",K("mouse",C),Ca,J(Ca,H(u)),da/ya,"wheel");E(C);C.returnValue=false}}}function ja(C){C=C||window.event;return(C.which||C.button)==1}function xa(C,da,Ca,Fa,Ua){Ca=
typeof Ca!="undefined"?Ca:ra;Fa=typeof Fa!="undefined"?Fa:F;var Q=Ca-aa,ea=Fa-ia,W=p(Ca,Fa);ma||(ma=H(u));B.triggerCustom(da,K("mouse",C),W,J(W,ma),p(Q,ea));if(typeof Ua=="undefined"||Ua){aa=Ca;ia=Fa}}L=COG.extend({},L);var Ha=120,ya=Ha*8,Ma=false,ca,ma,ra,F,aa,ia;L.binder("mousedown",ka,false);L.binder("mousemove",V,false);L.binder("mouseup",la,false);L.binder("dblclick",function(C){COG.info("captured double click");if(o(C,u)){var da=p(C.pageX?C.pageX:C.screenX,C.pageY?C.pageY:C.screenY);COG.info("captured double click + target matched");
B.triggerCustom("doubleTap",K("mouse",C),da,J(da,H(u)))}},false);L.binder("mousewheel",ha,document);L.binder("DOMMouseScroll",ha,document);return{unbind:function(){L.unbinder("mousedown",ka,false);L.unbinder("mousemove",V,false);L.unbinder("mouseup",la,false);L.unbinder("mousewheel",ha,document);L.unbinder("DOMMouseScroll",ha,document)}}},checks:{touch:false}});s("pointer",{handler:function(u,B,L){function ka(Q){if(Q.count<2)return 0;var ea=Q.x-Q.next.x;Q=Q.y-Q.next.y;return~~Math.sqrt(ea*ea+Q*Q)}
function V(Q,ea,W){ea=ea?ea:0;W=W?W:0;for(var Ia={x:Q.x-ea,y:Q.y-W,id:Q.id,count:Q.count},Ga=Ia;Q.next;){Q=Q.next;Ga=Ga.next={x:Q.x-ea,y:Q.y-W,id:Q.id}}return Ia}function la(Q,ea){var W=Q[ea?ea:"touches"],Ia,Ga;if(W.length===0)return null;Ga=Ia={x:W[0].pageX,y:W[0].pageY,id:W[0].identifier,count:W.length};for(var Ta=1,eb=W.length;Ta<eb;Ta++)Ga=Ga.next={x:W[Ta].pageX,y:W[Ta].pageY,id:W[Ta].identifier};return Ia}function ha(Q){if(o(Q,u)){F=H(u);var ea=la(Q,"changedTouches"),W=V(ea,F.x,F.y);if(!ia){aa=
ca;B.triggerCustom("pointerDown",K("touch",Q),ea,W)}Fa&&B.triggerCustom("pointerDownMulti",K("touch",Q),ea,W);ia=la(Q);if(ia.count>1)da=ka(ia);Ua=1;Ca=V(ia)}}function ja(Q){if(o(Q,u)){Q.preventDefault();C=la(Q);if(aa==ca)aa=Math.abs(ia.x-C.x)>ya||Math.abs(ia.y-C.y)>ya?Ma:ca;if(aa!=ca){aa=C.count>1?ra:ma;if(aa==ra)if(ia.count===1){ia=V(C);da=ka(ia)}else{var ea=ka(C);if(Math.abs(da-ea)<Ha)aa=ma;else{var W;W=C.x;var Ia=C.next.x,Ga=C.y,Ta=C.next.y,eb=Ga<Ta?Ga:Ta;W={x:(W<Ia?W:Ia)+(Math.abs(W-Ia)>>1),y:eb+
(Math.abs(Ga-Ta)>>1)};ea=ea/da;Ia=ea-Ua;B.triggerCustom("zoom",K("touch",Q),W,J(W,F),Ia,"pinch");Ua=ea}}aa==ma&&B.triggerCustom("pointerMove",K("touch",Q),C,V(C,F.x,F.y),p(C.x-Ca.x,C.y-Ca.y));Fa&&B.triggerCustom("pointerMoveMulti",K("touch",Q),C,V(C,F.x,F.y))}Ca=V(C)}}function xa(Q){if(o(Q,u)){var ea=la(Q,"changedTouches"),W=V(ea,F.x,F.y);C=la(Q);if(!C){aa===ca&&B.triggerCustom("tap",K("touch",Q),ea,W);B.triggerCustom("pointerUp",K("touch",Q),ea,W);ia=null}Fa&&B.triggerCustom("pointerUpMulti",K("touch",
Q),ea,W)}}L=COG.extend({detailed:false,inertia:false},L);var Ha=20,ya=7,Ma=0,ca=1,ma=2,ra=3,F,aa,ia,C,da,Ca,Fa=L.detailed,Ua=1;L.binder("touchstart",ha,false);L.binder("touchmove",ja,false);L.binder("touchend",xa,false);COG.info("initialized touch handler");return{unbind:function(){L.unbinder("touchstart",ha,false);L.unbinder("touchmove",ja,false);L.unbinder("touchend",xa,false)}}},checks:{touch:true}});return{register:s,watch:function(u,B,L){B=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},B);capabilities=COG.extend({touch:"ontouchstart"in window},L);if(!B.observable){COG.info("creating observable");B.observable=COG.observable({});globalOpts=B}B.binder=B.isIE?O:Y(B.bindToBody);B.unbinder=B.isIE?G:ta(B.bindToBody);L=B.types;for(var ka=capabilities,V=[],la=M.length;la--;){var ha=M[la],ja=!L||L.indexOf(ha.type)>=0,xa=true;for(var Ha in ha.checks){var ya=ha.checks[Ha];COG.info("checking "+Ha+" capability. require: "+ya+", capability = "+ka[Ha]);xa=xa&&ya===ka[Ha]}if(ja&&
xa)V[V.length]=ha.handler}return new $(u,V,B)}}}();
T5=function(){function Y(){return(new Date).getTime()}function ta(){for(;Q.length>0;){var c=Q.shift();document.location=c}Ua=0}function O(c){for(var r=true,f=ea.length;f--;)r=r&&c!=ea[f];return r}function G(c,r){var f=[];for(var b in r)b&&f.push(b+"="+escape(r[b]));return"tile5://"+c+"/"+(f.length>0?"?"+f.join("&"):"")}function p(c,r){O(c)&&COG.info("would push url: "+G(c,r))}function s(c,r){if(O(c)){Q.push(G(c,r));Ua||(Ua=setTimeout(ta,100))}}function H(c){return function(r,f,b){(b?b:c?document.body:
document).addEventListener(r,f,false)}}function K(c){return function(r,f,b){(b?b:c?document.body:document).removeEventListener(r,f,false)}}function o(c,r,f){(f?f:document).attachEvent("on"+c,r)}function J(c,r,f){(f?f:document).detachEvent("on"+c,r)}function E(){da={base:{name:"Unknown",bindEvent:H(),unbindEvent:K(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:p,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:o,unbindEvent:J,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:s,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:s},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:s},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:H(true),unbindEvent:K(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:s},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:s}};Ca=[da.froyo,da.android,da.ipod,da.iphone,da.ipad,da.ie]}function M(){da||E();if(!Fa){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<Ca.length;c++){var r=Ca[c];if(r.regex&&r.regex.test(navigator.userAgent)){Fa=COG.extend({},da.base,r);COG.info("PLATFORM DETECTED AS: "+Fa.name);break}}if(!Fa){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Fa=da.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Fa}function $(){for(var c=0,r=arguments.length;r--;){var f=Ta[arguments[r].toUpperCase()];if(f)c|=f}return c}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){setTimeout(function(){c((new Date).getTime())},1E3/60)}}();var u=Math.PI*2,B=Math.PI/2,L=Math.abs,ka=
Math.ceil,V=Math.min,la=Math.max,ha=Math.pow,ja=Math.sqrt,xa=Math.log,Ha=Math.round,ya=Math.sin,Ma=Math.asin,ca=Math.cos,ma=Math.atan,ra=Math.atan2,F=function(){function c(b,d){return f(b.x-d.x,b.y-d.y)}function r(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var m={edges:Array(d-1),accrued:Array(d-1),total:0},l=0;l<d-1;l++){var t=c(b[l],b[l+1]);m.edges[l]=ja(t.x*t.x+t.y*t.y);m.accrued[l]=m.total+m.edges[l];m.total+=m.edges[l]}return m}
function f(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,m=arguments.length;m--;){b+=arguments[m].x;d+=arguments[m].y}return f(b,d)},absSize:function(b){return la(L(b.x),L(b.y))},copy:function(b){return b?f(b.x,b.y):null},diff:c,distance:function(b,d){return r(b,d).total},edges:r,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,m){var l=ca(d)*m;d=ya(d)*m;return f(b.x-l,b.y-d)},floor:function(b){for(var d=
Array(b.length),m=b.length;m--;)d[m]=f(~~b[m].x,~~b[m].y);return d},getRect:function(b){for(var d,m,l,t,q=b.length;q--;){var n=b[q];d=typeof d==="undefined"||n.x<d?n.x:d;m=typeof m==="undefined"||n.y<m?n.y:m;l=typeof l==="undefined"||n.x>l?n.x:l;t=typeof t==="undefined"||n.y>t?n.y:t}return ia.init(d,m,l,t)},init:f,invert:function(b){return f(-b.x,-b.y)},min:function(b,d){return f(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return f(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,m){return f(b.x+
d,b.y+(m?m:d))},simplify:function(b,d){if(!b)return null;d=d?d:F.VECTOR_SIMPLIFICATION;for(var m=[],l=null,t=b.length;t--;){var q=b[t];if(include=!l||t===0||L(q.x-l.x)+L(q.y-l.y)>d){m.unshift(q);l=q}}return m},theta:function(b,d,m){m=Ma((b.y-d.y)/m);return b.x>d.x?m:Math.PI-m},toString:function(b){return b?b.x+", "+b.y:""}}}(),aa=function(){return{dotProduct:function(c,r){return c.x*r.x+c.y*r.y}}}(),ia=function(){function c(f){return r(f.x1,f.y1,f.x2,f.y2)}function r(f,b,d,m){f=f?f:0;b=b?b:0;d=typeof d!==
"undefined"?d:f;m=typeof m!=="undefined "?m:m;return{x1:f,y1:b,x2:d,y2:m,width:d-f,height:m-b}}return{center:function(f){return F.init(f.x1+f.width/2,f.y1+f.height/2)},copy:c,diagonalSize:function(f){return ja(f.width*f.width+f.height*f.height)},fromCenter:function(f,b,d,m){d=d>>1;m=m>>1;return r(f-d,b-m,f+d,b+m)},init:r,intersect:function(f,b){var d=la(f.x1,b.x1),m=la(f.y1,b.y1),l=V(f.x2,b.x2),t=V(f.y2,b.y2);d=r(d,m,l,t);return d.width>0&&d.height>0?d:null},toString:function(f){return"["+f.x1+", "+
f.y1+", "+f.x2+", "+f.y2+"]"},union:function(f,b){if(f.width===0||f.height===0)return c(b);else if(b.width===0||b.height===0)return c(f);else{var d=V(f.x1,b.x1),m=V(f.y1,b.y1),l=la(f.x2,b.x2),t=la(f.y2,b.y2);d=r(d,m,l,t);return d.width>0&&d.height>0?d:null}}}}(),C=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return F.init(c.width>>1,c.height>>1)},getSize:function(c){return ja(ha(c.width,2)+ha(c.height,2))},init:function(c,r){c=c?c:0;return{width:c,
height:r?r:c}}}}(),da=null,Ca=[],Fa=null,Ua=0,Q=[],ea=["view.wake","tile.loaded"],W=function(){function c(){var j=M().maxImageLoads;if(!j||q.length<j)if(j=t.shift()){q[q.length]=j;j.image.onload=r;j.image.src=j.url;j.requested=T5.ticks()}}function r(){var j=m[this.id],z;if(j&&j.image.complete&&j.image.width>0){j.loaded=true;j.hitCount=1;for(z=q.length;z--;)if(q[z].image.src==this.src){q.splice(z,1);break}if(j.background||j.postProcess||j.drawBackground||j.customDraw)if(j.image){globalImageData=j;
z=b(j.realSize?j.realSize.width:j.image.width,j.realSize?j.realSize.height:j.image.height);var P=z.getContext("2d"),U=j.offset?j.offset:T5.XY.init();j.background&&P.drawImage(j.background,0,0);j.drawBackground&&j.drawBackground(P);j.customDraw?j.customDraw(P,j):P.drawImage(j.image,U.x,U.y);j.postProcess&&j.postProcess(P,j);j.image=z}for(z=j.callbacks.length;z--;)j.callbacks[z]&&j.callbacks[z](this,false);j.callbacks=[];n[n.length]={url:this.src,created:j.requested};delete m[this.id];c()}}function f(j,
z,P){var U=d[j];if(U){U.hitCount++;U.image.complete&&U.image.width>0&&z?z(U.image,true):U.callbacks.push(z)}else{U=COG.extend({url:j,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[z]},P);U.image.id="resourceLoaderImage"+l++;d[j]=U;m[U.image.id]=U;t[t.length]=U;c()}return U}function b(j,z){var P=document.createElement("canvas");COG.info("creating new canvas");P.width=j?j:0;P.height=z?z:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(P);FlashCanvas.initElement(P)}return P}
var d={},m={},l=0,t=[],q=[],n=[],w={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var j;for(j=q.length;j--;)delete d[q[j].url];q=[];for(j=t.length;j--;)delete d[t[j].url];t=[]},get:function(j,z,P){var U=null;U=null;if((U=(U=d[j])?U.image:null)&&(U.getContext||U.complete&&U.width>0))return U;else z&&f(j,z,P);return null},load:f,newCanvas:b,reset:function(){d={}},stats:function(){return{imageLoadingCount:q.length,queuedImageCount:t.length,imageCacheFullness:0}}};COG.observable(w);return w}(),
Ia=function(){var c={};return{init:function(r,f){var b=c[r];if(!b)throw Error("Unable to locate requested generator: "+r);return new b(f)},register:function(r,f){c[r]=f},Template:function(){}}}(),Ga=function(){function c(l,t){d[l]=f(t);return l}function r(l){for(var t in l)c(t,l[t])}function f(l){function t(j){var z=l[j];typeof z!=="undefined"&&n.push(function(P){P[j]=z})}function q(){n=[];for(var j in l)t(j)}l=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,
lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},l);var n=[],w={applyToContext:function(j){for(var z=n.length;z--;)n[z](j)},update:function(j,z){l[j]=z;q()}};q();return w}var b={},d={},m={apply:function(l,t){var q=d[t]?d[t]:d.basic,n;if(l&&l.canvas){n=b[l.canvas.id];b[l.canvas.id]=t}q.applyToContext(l);return n},define:c,defineMany:r,get:function(l){return d[l]},init:f,load:function(l){COG.jsonp(l,function(t){r(t)})}};r({basic:{lineWidth:1,strokeStyle:"#000",
fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return m}(),Ta={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},eb=function(c){function r(v,x,D,S){Na=mb;fb(na-x,ua-D,S?c.panAnimationEasing:null,S?c.panAnimationDuration:null);clearTimeout(T);T=setTimeout(f,100)}function f(){Na=Ab;Oa()}function b(v,x,D,S){gb(V(la(oa+ha(2,S)-1,0.5),2))}function d(){var v=xa(oa)/Math.LN2>>0;if(v!==0){oa=ha(2,v);pa(lb+Math.log(oa)/Math.LN2,nb,ob)}Oa()}function m(v){v||
(v=F.init(I,X));fa=F.init(na,ua);Aa=F.offset(v,na,ua);nb=Aa.x;ob=Aa.y}function l(v,x){var D,S;S=1/oa;if(oa!==1&&e){D=e.x1+v*S;S=e.y1+x*S}else{D=v+na;S=x+ua}return F.init(D,S)}function t(v,x,D){Pa("doubleTap",x,D,l(D.x,D.y));c.scalable&&gb(2,D,c.zoomEasing,null,c.zoomDuration)}function q(v,x,D){hb=null;z(x,D,l(D.x,D.y),"down")}function n(v,x,D){hb=l(D.x,D.y);z(x,D,hb,"hover")}function w(){clearTimeout(va);va=setTimeout(P,250)}function j(v,x,D){z(x,D,l(D.x,D.y),"tap");Pa("tap",x,D,l(D.x,D.y))}function z(v,
x,D,S){for(var wa=[],za=Ja;za--;)if(ba[za].hitTest)wa=wa.concat(ba[za].hitTest(D.x,D.y,Na,Da));wa.length>0&&Da.triggerCustom(S+"Hit",{hitType:S},wa,v,x,D)}function P(v,x){var D;if(Ba){if(c.autoSize&&Ba.parentNode){v=Ba.parentNode.offsetWidth;x=Ba.parentNode.offsetHeight}try{if(!Ba.id)Ba.id=c.id+"_canvas";qa=Ba.getContext("2d")}catch(S){COG.exception(S);throw Error("Could not initialise canvas on specified view element");}if(v&&x&&(Ka!==x||La!==v)){pb=true;La=v;Ka=x;I=La>>1;X=Ka>>1;Da.trigger("resize",
La,Ka);for(D=Ja;D--;)ba[D].trigger("resize",La,Ka)}for(D=Ja;D--;)ba[D].trigger("contextChanged",qa);Oa();sa()}}function U(v,x){x.setId(v);x.added=Y();x.bind("remove",function(){Da.removeLayer(v)});x.trigger("contextChanged",qa);x.setParent(Da);ba.push(x);ba.sort(function(D,S){var wa=S.zindex-D.zindex;if(wa===0)wa=S.added-D.added;return wa});Ja=ba.length;return x}function sa(){ab&&ab.unbind();ab=INTERACT.watch(Ba);c.pannable&&ab.pannable().bind("pan",r);if(c.scalable){ab.bind("zoom",b);ab.bind("doubleTap",
t)}if(c.captureHover){ab.bind("pointerDown",q);ab.bind("pointerHover",n)}ab.bind("tap",j)}function Va(v){var x=g?na+I:na,D=i?ua+X:ua;if(Qa&&Qa>La)if(x+La>Qa)na=g?v&&x-Qa>0?na-Qa:na:Qa-La;else if(x<0)na=g?v?na+Qa:na:0;if(Ra&&Ra>Ka)if(D+Ka>Ra)ua=i?v&&D-Ra>0?ua-Ra:ua:Ra-Ka;else if(D<0)ua=i?v?ua+Ra:ua:0}function Wa(v){var x,D=false;if(qb){if(v-Xa>Eb){Na=oa!==1?Na|rb:Na&~rb;Ea=(x=(Na&(rb|mb))!==0)&&(Na&sb)===0;if(pb&&Ba){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(Ba);Ba.width=La;Ba.height=
Ka;Ba.style.width=La+"px";Ba.style.height=Ka+"px";pb=false}if(Qa||Ra)Va();y=ib();for(var S=Ja;S--;){if(ba[S].animated)Na|=sb;ba[S].cycle(v,y,Na);ba[S].shouldDraw(Na,y);D=ba[S].clip||D}S=Na;var wa=y;x=k&&D&&!x;var za;ia.center(wa);D=0;e=ia.copy(wa);e.scaleFactor=oa;if(!x)if(!tb||v-ga>Ya){qa.clearRect(0,0,La,Ka);ga=v}qa.save();try{if(oa!==1){var cb=e,Za=1/oa;nb=Aa.x+(na-fa.x);ob=Aa.y+(ua-fa.y);e=cb?ia.fromCenter(nb>>0,ob>>0,cb.width*Za>>0,cb.height*Za>>0):void 0;qa.scale(oa,oa)}qa.translate(-e.x1,-e.y1);
R=N=null;if(x&&!tb){qa.beginPath();for(D=Ja;D--;)ba[D].clip&&ba[D].clip(qa,e,S,Da,v);qa.closePath();qa.clip()}for(D=Ja;D--;){za=ba[D];qa.globalCompositeOperation=tb&&za.zIndex<=0?"copy":"source-over";var db=za.style,jb=db?Ga.apply(qa,db):null;if(za.minXY)N=N?F.min(N,za.minXY):F.copy(za.minXY);if(za.maxXY)R=R?F.max(R,za.maxXY):F.copy(za.maxXY);za.draw(qa,e,S,Da,v);jb&&Ga.apply(qa,jb)}}finally{qa.restore()}if(h){qa.globalCompositeOperation="source-over";qa.strokeStyle="#f00";qa.beginPath();qa.moveTo(I,
0);qa.lineTo(I,Ka);qa.moveTo(0,X);qa.lineTo(La,X);qa.stroke()}qb=0;Pa("drawComplete",wa,v);v-Z>ub&&bb();Xa=v}animFrame(Wa)}else a=false}function Oa(){qb+=1;if(!a){a=true;animFrame(Wa)}}function ib(){return ia.init(na,ua,na+La,ua+Ka)}function bb(){if(Qa||Ra)Va(true);Z=(new Date).getTime();Pa("refresh",Da,ib());Oa()}function gb(v,x,D,S,wa){if(D)COG.tweenValue(oa,v,D,wa,function(za,cb){oa=za;if(cb){var Za=Ha(xa(oa)/Math.LN2);oa=ha(2,Za);S&&S()}m(x);d()});else{oa=v;m(x);d()}return Da}function pa(v,x,
D){v=la(c.minZoom,V(c.maxZoom,v));if(v!==lb){var S=ha(2,v-lb),wa=I/S|0,za=X/S|0;lb=v;fb(((x?x:na+I)-wa)*S,((D?D:ua+X)-za)*S);Pa("zoomLevelChange",v);oa=1;bb()}}function Pa(){for(var v=Da.trigger.apply(null,arguments).cancel,x=ba.length;x--;)v=ba[x].trigger.apply(null,arguments).cancel||v;return!v}function fb(v,x,D,S,wa){function za(){cb+=1;if(cb>=2){f();wa&&wa()}}var cb=0,Za=N?F.offset(N,-I,-X):null,db=R?F.offset(R,-I,-X):null;if(Za){v=v<Za.x?Za.x:v;x=x<Za.y?Za.y:x}if(db){v=v>db.x?db.x:v;x=x>db.y?
db.y:x}if(D){if((Na&mb)===0){COG.tweenValue(na,v,D,S,function(jb,vb){na=jb|0;(vb?za:Oa)();return!Ea});COG.tweenValue(ua,x,D,S,function(jb,vb){ua=jb|0;(vb?za:Oa)();return!Ea});Na=mb|sb}}else{na=v|0;ua=x|0;Oa();wa&&wa()}}c=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastDraw:false,inertia:true,minRefresh:1E3,pannable:true,clipping:true,scalable:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,
turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},c);var Ya=500,ba=[],Ja=0,Ba=document.getElementById(c.container),qa=null,wb=typeof window.attachEvent!="undefined",ub=c.minRefresh,hb=null,na=0,ua=0,Qa=null,Ra=null,g=false,i=false,k=c.clipping,y=null,a=false,e,h=c.guides,A=1,I=0,X=0,fa=null,Aa=null,Ea=false,T=0,N=null,R=null,Z=0,ga=0,va=0,oa=1,Xa=0,pb=false,ab=null,tb=c.turbo,Ka,La,Eb=1E3/c.fps|0,qb=0,nb,ob,lb=c.zoomLevel,Ab=$("ACTIVE"),mb=$("PAN"),
rb=$("ZOOM"),sb=$("ANIMATING"),Na=Ab,Da={id:c.id,deviceScaling:A,fastDraw:c.fastDraw||M().requireFastDraw,getDimensions:function(){return C.init(La,Ka)},getLayer:function(v){for(var x=0;x<Ja;x++)if(ba[x].getId()==v)return ba[x];return null},getZoomLevel:function(){return lb},setLayer:function(v,x){for(var D=0;D<Ja;D++)if(ba[D].getId()===v){ba.splice(D,1);break}if(x){U(v,x);x.trigger("refresh",Da,ib())}Oa();return x},eachLayer:function(v){for(var x=Ja;x--;)v(ba[x])},invalidate:Oa,refresh:bb,resetScale:function(){oa=
1},resize:function(v,x){if(Ba){c.autoSize=false;if(La!==v||Ka!==x)P(v,x)}},scale:gb,setZoomLevel:pa,triggerAll:Pa,removeLayer:function(v){a:{for(var x=Ja;x--;)if(ba[x].getId()==v){v=x;break a}v=-1}if(v>=0&&v<Ja){Da.trigger("layerRemoved",ba[v]);ba.splice(v,1);Oa()}Ja=ba.length},getOffset:function(){return F.init(na,ua)},setMaxOffset:function(v,x,D,S){Qa=v;Ra=x;g=typeof D!="undefined"?D:false;i=typeof S!="undefined"?S:false},getViewRect:ib,updateOffset:fb,pan:function(v,x,D,S,wa){fb(na+v,ua+x,D,S,
wa)}};A=M().getScaling();Da.markers=U("markers",new xb);COG.observable(Da);Da.bind("invalidate",function(){Oa()});Da.bind("resync",function(){R=N=null});COG.configurable(Da,["container","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(c,null,{container:function(v,x){Ba=document.getElementById(x);P()},inertia:sa,scalable:sa,pannable:sa}),true);P();if(c.autoSize)wb?window.attachEvent("onresize",w):window.addEventListener("resize",w,false);return Da},kb=function(c){c=COG.extend({id:"",
zindex:0,supportFastDraw:false,animated:false,validStates:$("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var r=null,f=false,b=false,d=c.id,m=$("ACTIVE"),l=c.validStates,t=0,q=0,n=COG.extend({addToView:function(w){w.setLayer(d,n)},shouldDraw:function(w){return(w&l)!==0},clip:null,cycle:function(){},draw:function(){},remove:function(){n.trigger("remove",n)},changed:function(){b=true;r&&r.invalidate()},hitTest:null,getId:function(){return d},setId:function(w){d=w},getParent:function(){return r},
setParent:function(w){f=(r=w)?r.fastDraw&&displayState!==m:false;n.trigger("parentChange",r)}},c);COG.observable(n);n.bind("drawComplete",function(w,j){b=false;t=j.x1;q=j.y1});n.bind("resync",function(w,j){if(j.syncXY){n.minXY&&j.syncXY(n.minXY);n.maxXY&&j.syncXY(n.maxXY)}});return n},yb=function(c){function r(q,n,w,j){b=q;d=n;m=w;l=j}c=COG.extend({xy:F.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var f=false,b=0,d=0,m=0,l=0,t=COG.extend(c,{isAnimating:function(){return f},draw:function(q,
n,w,j,z){if(t.isNew&&c.tweenIn)COG.tweenValue(n.y1-20,t.xy.y,c.tweenIn,c.animationSpeed?c.animationSpeed:250+Math.random()*500,function(P,U){t.xy.y=P|0;f=!U;z.invalidate()});t.drawMarker(q,n,t.xy.x,t.xy.y,w,j,z);t.isNew=false},drawMarker:function(q,n,w,j){q.beginPath();q.arc(w,j,4,0,Math.PI*2,false);q.fill();r(w-4,j-4,8,8)},hitTest:function(q,n){return q>=b&&q<=b+m&&n>=d&&n<=d+l},updateBounds:r});COG.observable(t);return t},xb=function(c){function r(){f();d.changed();d.trigger("markerUpdate",b)}function f(){var m=
d.getParent();if(m&&m.syncXY)for(var l=b.length;l--;)m.syncXY([b[l].xy]);b.sort(function(t,q){var n=q.xy.y-t.xy.y;if(n==0)n=q.xy.x-t.xy.x;return n})}c=COG.extend({zindex:100,style:"basic"},c);var b=[],d=COG.extend(new kb(c),{draw:function(m,l,t,q){for(var n=b.length;n--;)b[n].draw(m,l,t,d,q)},add:function(m){if(m&&typeof m.length!=="undefined")for(var l=m.length;l--;){if(m[l])b[b.length]=m[l]}else if(m)b[b.length]=m;r()},clear:function(m){if(m)for(var l=0;l<b.length;)if(m(b[l]))b.splice(l,1);else l+=
1;else b=[];r()},each:function(m){if(m)for(var l=b.length;l--;)m(b[l])},find:function(m){for(var l=[],t=b.length;t--;)if(!m||m(b[t]))l[l.length]=b[t];return l},hitTest:function(m,l){for(var t=[],q=b.length;q--;)if(b[q].hitTest(m,l))t[t.length]={type:"marker",data:b[q]};return t}});d.bind("tap",function(m,l,t,q){var n=[],w=q.x;q=q.y;for(var j=b.length;j--;)if(b[j].hitTest(w,q))n[n.length]=b[j];if(n.length>0)m.cancel=d.trigger("markerTap",l,t,n).cancel});d.bind("parentChange",f);d.bind("resync",f);
return d},Bb=function(c){function r(q,n,w){q.fillStyle="#FFFFFF";q.strokeStyle="#222222";q.beginPath();q.arc(w.x,w.y,4,0,Math.PI*2,false);q.stroke();q.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:$("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},c);var f=F.edges(c.path),b,d=null,m=c.drawIndicator?c.drawIndicator:r,l=0,t=COG.extend(new kb(c),{cycle:function(){for(var q=0;q<f.accrued.length&&f.accrued[q]<l;)q++;d=null;if(q<c.path.length-1){var n=
l-(q>0?f.accrued[q-1]:0),w=c.path[q];b=F.theta(w,c.path[q+1],f.edges[q]);d=F.extendBy(w,b,n)}return d},draw:function(q,n){d&&m&&m(q,n,F.init(d.x,d.y),b)}});COG.tweenValue(0,f.total,c.easing,c.duration,function(q,n){l=q;n&&t.remove();t.changed()});return t},Cb=function(c){c=COG.extend({style:null,properties:{}},c);return COG.extend(c,{rect:null,draw:function(){},resync:function(){}})},zb=function(c,r){r=COG.extend({fill:false,simplify:false},r);var f=false,b=r.fill,d=r.simplify,m=$("ZOOM"),l=[],t=
COG.extend(new Cb(r),{draw:function(q,n,w,j,z,P){if(f){n=true;w=(P&m)!==0;q.beginPath();for(P=l.length;P--;){w=l[P].x;j=l[P].y;if(n){q.moveTo(w,j);n=false}else q.lineTo(w,j);w=true}if(w){b&&q.fill();q.stroke()}}},resync:function(q){t.xy=q.syncXY(c);l=F.floor(d?F.simplify(c):c)}});f=c&&c.length>=2;return t},Db=function(c){function r(m){for(var l=b.length;l--;)b[l].resync(m);b.sort(function(t,q){var n=q.xy.y-t.xy.y;if(n===0)n=q.xy.x-t.xy.y;return n});d.changed()}function f(m,l){l.syncXY&&r(l)}c=COG.extend({zindex:80},
c);var b=[],d=COG.extend(new kb(c),{add:function(m){b[b.length]=m},each:function(m){for(var l=b.length;l--;)m(b[l])},draw:function(m,l,t){var q=l.x1,n=l.y1,w=l.width;l=l.height;for(var j=b.length;j--;){var z=b[j].style;z=z?Ga.apply(m,z):null;b[j].draw(m,q,n,w,l,t);z&&Ga.apply(m,z)}}});d.bind("parentChange",f);d.bind("resync",f);return d},Fb=function(){return{tileSize:256,init:function(c,r,f,b,d){return COG.extend({x:c,y:r,width:f,height:b},d)}}}(),$a={ex:COG.extend,ticks:Y,getConfig:M,userMessage:function(c,
r,f){$a.trigger("userMessage",c,r,f)},XY:F,XYRect:ia,Dimensions:C,Vector:aa,D:C,Images:W,Generator:Ia,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ga,viewState:$,View:eb,ViewLayer:kb,ImageLayer:function(c,r){function f(n,w,j){for(w=l.length;w--;){var z=l[w],P=z.x,U=z.y,sa=ia.init(z.x,z.y,z.x+z.width,z.y+z.height);if(j&&ia.intersect(n,sa))(sa=W.get(z.url,function(){q.changed()},t))&&j(sa,P,U,z.width,z.height)}}function b(n){var w=++m,j=q.getParent();d&&d.run(j,
n,function(z){if(w==m){l=[].concat(z);j.invalidate()}})}r=COG.extend({imageLoadArgs:{}},r);var d=c?Ia.init(c,r):null,m=0,l=[],t=r.imageLoadArgs,q=COG.extend(new kb(r),{changeGenerator:function(n,w){d=Ia.init(n,COG.extend({},r,w));l=null;b(q.getParent().getViewRect())},clip:function(n,w,j){f(w,j,function(z,P,U,sa,Va){n.rect(P,U,sa,Va)})},draw:function(n,w,j){f(w,j,function(z,P,U,sa,Va){q.drawImage(n,z,P,U,sa,Va,w,j)})},drawImage:function(n,w,j,z){w&&n.drawImage(w,j,z,w.width,w.height)}});q.bind("refresh",
function(n,w,j){b(j)});q.bind("tap",function(n,w,j,z){n=[];var P=z.x,U=z.y,sa,Va;if(l)for(var Wa=l.length;Wa--;){sa=l[Wa];if(Va=P>=sa.x&&P<=sa.x+sa.width&&U>=sa.y&&U<=sa.y+sa.height)n[n.length]=sa}n.length>0&&q.trigger("tapImage",n,w,j,z)});return q},ImageGenerator:function(c){c=COG.extend({relative:false,padding:2},c);c={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(c);return c},Marker:yb,ImageMarker:function(c){c=COG.extend({image:null,imageUrl:null,
animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},c);var r=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,f=COG.extend(new yb(c),{changeImage:function(b){f.image=W.get(b,function(d){f.image=d})},drawMarker:function(b,d,m,l){if((d=f.isAnimating()&&f.animatingImage?f.animatingImage:f.image)&&d.width>0){r||(r=F.init(-d.width>>1,-d.height>>1));var t=f.scale,q=m+~~(r.x*t),n=l+~~(r.y*t),w=~~(d.width*t),j=~~(d.height*t);f.updateBounds(q,n,w,w);if(f.rotation||f.opacity!==
1){b.save();try{b.globalAlpha=f.opacity;b.translate(m,l);b.rotate(f.rotation);b.drawImage(d,r.x*t,r.y*t,w,j)}finally{b.restore()}}else b.drawImage(d,q,n,w,j)}}});if(!f.image)f.image=W.get(c.imageUrl,function(b){f.image=b});if(!f.animatingImage)f.animatingImage=W.get(c.animatingImageUrl,function(b){f.animatingImage=b});return f},MarkerLayer:xb,PathLayer:function(c){function r(){var n=q.getParent();if(n&&n.syncXY){n.syncXY(d);m&&n.syncXY(m);q.trigger("tidy")}}c=COG.extend({style:"waypoints",pixelGeneralization:8,
zindex:50},c);var f=[],b=null,d=[],m=null,l=0,t=[],q=COG.extend(new kb(c),{getAnimation:function(n,w,j,z){var P="pathAnimation"+l++;t.push(P);return new Bb({id:P,path:f,zindex:c.zindex+1,easing:n?n:COG.easing("sine.inout"),duration:w?w:5E3,drawIndicator:j,autoCenter:z?z:false})},draw:function(n){var w,j=f.length;n.save();try{Ga.apply(n,c.style);if(j>0){n.beginPath();n.moveTo(f[j-1].x,f[j-1].y);for(w=j;w--;)n.lineTo(f[w].x,f[w].y);n.stroke();if(b){n.fillStyle=c.waypointFillStyle;for(w=b.length;w--;){n.beginPath();
n.arc(b[w].x,b[w].y,2,0,Math.PI*2,false);n.stroke();n.fill()}}}}finally{n.restore()}},updateCoordinates:function(n,w){d=n;m=w;r()}});q.bind("tidy",function(){f=F.simplify(d,c.pixelGeneralization);b=F.simplify(m,c.pixelGeneralization);q.changed(true)});q.bind("resync",r);return q},AnimatedPathLayer:Bb,Shape:Cb,Arc:function(c,r){r=COG.extend({size:4},r);var f=F.init(),b=COG.extend(r,{draw:function(d){d.beginPath();d.arc(f.x,f.y,b.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([c]);
f=F.floor([c])[0]}});COG.info("created arc = ",c);return b},Poly:zb,ShapeLayer:Db,Tiling:Fb};COG.observable($a);var Sa=$a.Geo=function(){function c(g){for(var i=null,k=1;!i&&k<arguments.length;k++)i=m(g,arguments[k]);i=i?i:m(g);if(!i)throw Error("Unable to find GEO engine with "+g+" capability");return i}function r(g){g=parseFloat(g)*z;g=ya(g);var i=Wa*g;return xa((1+g)/(1-g)*ha((1-i)/(1+i),Wa))/2}function f(g){return parseFloat(g)*z}function b(g){g=ha(Math.E,-g);for(var i=B-2*ma(g),k=l(i,g),y=0;y<
ib&&L(i-k)>Oa;){i=k;k=l(i,g);y++}return k*P}function d(g){return g%360*P}function m(g,i){var k=null;for(var y in ba)if(i){if(y==i&&ba[y][g]){k=ba[y];break}}else if(ba[y][g]){k=ba[y];break}return k}function l(g,i){var k=Wa*ya(g);return B-2*ma(i*ha((1-k)/(1+k),Wa/2))}function t(g,i,k,y){i=n(i);g.add(y.line(i,k));return i.length}function q(g,i,k,y){i=n(i);g.add(y.poly(i,k));return i.length}function n(g){var i=g?g.length:0,k=Array(i);for(i=i;i--;)k[i]=Sa.Position.init(g[i][1],g[i][0]);return Sa.Position.vectorize(k,
hb)}function w(g,i,k){return new Qa(g,i,k)}var j=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],z=Math.PI/180,P=180/Math.PI,U=B,sa=-U,Va=-u,Wa=0.08181919084262157,Oa=1.0E-7,ib=12,bb=null,gb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},pa=function(){function g(a){return a?k(a.lat,a.lon):null}function i(a){return!a||a.lat===0&&a.lon===0}function k(a,e){return{lat:parseFloat(a?a:0),lon:parseFloat(e?
e:0)}}function y(a){if(a)if(typeof a.lat!=="undefined")return g(a);else{if(a.split)for(var e=[" ",","],h=0;h<e.length;h++){var A=a.split(e[h]);if(A.length===2)return k(A[0],A[1])}}else return k();return null}return{calcDistance:function(a,e){if(i(a)||i(e))return 0;var h=(e.lat-a.lat)*z>>1,A=(e.lon-a.lon)*z>>1;h=ya(h)*ya(h)+ca(a.lat*z)*ca(e.lat*z)*ya(A)*ya(A);return 6371*2*ra(ja(h),ja(1-h))},copy:g,empty:i,equal:function(a,e){return a&&e&&a.lat==e.lat&&a.lon==e.lon},fromMercatorPixels:function(a,e){return k(b(e),
d(a))},generalize:function(a,e,h){var A=a.length,I=[],X=null;h||(h=250);h/=1E3;COG.info("generalizing positions, must include "+e.length+" positions");for(var fa=A;fa--;)if(fa===0)I.unshift(a[fa]);else{var Aa=!X||pa.inArray(a[fa],e)?h:pa.calcDistance(X,a[fa]);if(a[fa]&&Aa>=h){I.unshift(a[fa]);X=a[fa]}}COG.info("generalized "+A+" positions into "+I.length+" positions");return I},inArray:function(a,e){for(var h=pa.equal,A=e.length;A--;)if(h(a,e[A]))return true;return false},inBounds:function(a,e){var h=
!(pa.empty(a)||pa.empty(e));return h=(h=h&&a.lat>=e.min.lat&&a.lat<=e.max.lat)&&a.lon>=e.min.lon&&a.lon<=e.max.lon},init:k,offset:function(a,e,h){var A=a.lat*z;a=a.lon*z;e=A+e/6371;h=Ma(ya(h/6371)/ca(A));h=a+h;e=(e+B)%Math.PI-B;h%=u;return k(e*P,h*P)},parse:y,parseArray:function(a){var e=a.length,h=Array(e);for(e=e;e--;)h[e]=y(a[e]);return h},toMercatorPixels:function(a){return T5.XY.init(f(a.lon),r(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,e){function h(){for(var fa=
0,Aa=e.chunkSize,Ea=A;Ea--;){I[Ea]=T5.GeoXY.init(a[Ea]);fa+=1;if(fa>Aa)break}A=Ea;if(A<=0)e.callback&&e.callback(I);else animFrame(h)}var A=a.length,I=Array(A);e=COG.extend({chunkSize:500,async:true,callback:null},e);if(!e.async){for(var X=A;X--;)I[X]=T5.GeoXY.init(a[X]);return I}animFrame(h);return null}}}(),Pa=function(){function g(a,e,h){var A=T5.XY.init(0,e.lat-a.lat);if(typeof h==="undefined")h=true;A.x=h&&a.lon>e.lon?360-a.lon+e.lon:e.lon-a.lon;return A}function i(a,e){return Pa.init(pa.init(a.min.lat-
e,a.min.lon-e%360),pa.init(a.max.lat+e,a.max.lon+e%360))}function k(a){var e=g(a.min,a.max);return pa.init(a.min.lat+(e.y>>1),a.min.lon+(e.x>>1))}function y(a,e){return{min:pa.parse(a),max:pa.parse(e)}}return{calcSize:g,createBoundsFromCenter:function(a,e){var h=e/6371,A=a.lat*z,I=a.lon*z,X=A-h,fa=A+h;if(X>sa&&fa<U){A=Ma(ya(h)/ca(A));h=(I-A)%u;I=(I+A)%u}else{X=la(X,sa);fa=V(fa,U);h=Va;I=u}return Pa.init(pa.init(X*P,h*P),pa.init(fa*P,I*P))},expand:i,forPositions:function(a,e){var h=null,A=T5.ticks();
e||(e="auto");for(var I=a.length;I--;)if(h){var X=g(h.min,a[I],false),fa=g(a[I],h.max,false);if(X.x<0)h.min.lon=a[I].lon;if(X.y<0)h.min.lat=a[I].lat;if(fa.x<0)h.max.lon=a[I].lon;if(fa.y<0)h.max.lat=a[I].lat}else h=y(a[I],a[I]);if(e){if(e=="auto"){I=g(h.min,h.max);e=la(I.x,I.y)*0.3}h=i(h,e)}COG.trace("calculated bounds for "+a.length+" positions",A);return h},getCenter:k,getGeoHash:function(a){var e=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+
e+", max hash = "+a)},getZoomLevel:function(a,e){var h=k(a);h=V(Ha(L(h.lat)*0.05),j.length);var A=j[h],I=g(a.min,a.max);h=ka(xa(j[3]*e.height/I.y)/xa(2));A=ka(xa(A*e.width/I.x)/xa(2));return V(isNaN(h)?1E3:h,isNaN(A)?1E3:A)},init:y,isEmpty:function(a){return!a||pa.empty(a.min)||pa.empty(a.max)},toString:function(a){return"min: "+pa.toString(a.min)+", max: "+pa.toString(a.max)}}}(),fb=function(){var g=/^(\d+).*$/,i=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(k,y){g.lastIndex=-1;if(g.test(k))for(var a=
k.replace(g,"$1"),e=y.split(","),h=0;h<e.length;h++){i.lastIndex=-1;if(i.test(e[h])){var A=i.exec(e[h]);if(a>=parseInt(A[1],10)&&a<=parseInt(A[2],10))return true}else if(a==e[h])return true}return false},normalize:function(k){if(!k)return"";k=k.toUpperCase();if(!bb){var y=[];for(var a in gb)y.push(a);bb=RegExp("(\\s)("+y.join("|")+")(\\s|$)","i")}bb.lastIndex=-1;if(y=bb.exec(k))k=k.replace(bb,"$1"+gb[y[2]]);return k},toString:function(k){return k.streetDetails+" "+k.location}}}(),Ya=$a.GeoXY=function(){function g(k,
y){if(k.length){for(var a,e,h,A,I=k.length;I--;){g(k[I],y);a=typeof a==="undefined"||k.x<a?k.x:a;e=typeof e==="undefined"||k.y<e?k.y:e;h=typeof h==="undefined"||k.x>h?k.x:h;A=typeof A==="undefined"||k.y>A?k.y:A}return ia.init(a,e,A,A)}else if(k.mercXY){a=k.mercXY;k.x=(a.x+Math.PI)/y|0;k.y=(Math.PI-a.y)/y|0;k.rpp=y}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return k}function i(k,y,a){k.pos=y;k.mercXY=pa.toMercatorPixels(y);(a=typeof a!=="undefined"?a:k.rpp)&&g(k,a)}return{init:function(k,
y){var a=F.init();i(a,k,y);return a},sync:g,toPos:function(k,y){y=y?y:self.rpp;return pa.fromMercatorPixels(k.x*y-Math.PI,Math.PI-k.y*y)},updatePos:i}}(),ba={},Ja=function(){return{bestResults:function(g,i){i||(i=20);for(var k=g.length>0?g[0]:null,y=[],a=0;a<g.length;a++)if(k&&g[a]&&k.matchWeight-g[a].matchWeight<=i)y.push(g[a]);else break;return y}}}(),Ba=function(g){g=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},g);return COG.extend(g,{toString:function(){return g.caption+
(g.matchWeight?" ("+g.matchWeight+")":"")}})},qa=function(){function g(a,e){var h=a.getDimensions();h=new Ra({data:e,width:h.width,height:h.height});a.setLayer("route",h)}function i(a){for(var e=k.Unknown,h=y,A=0;A<h.length;A++){h[A].regex.lastIndex=-1;var I=h[A].regex.exec(a);if(I){e=h[A].customCheck?h[A].customCheck(a,I):h[A].turnType;break}}return e}var k={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",
TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},y=function(){var a=[];a.push({regex:/continue/i,turnType:k.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(e,h){return/bear/i.test(h[1])?k.TurnLeftSlight:k.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(e,
h){return/bear/i.test(h[1])?k.TurnRightSlight:k.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:k.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:k.Ramp});a.push({regex:/take.*?exit/i,turnType:k.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(e,h){return/right/i.test(h[1])?k.UTurnRight:k.UTurnLeft}});a.push({regex:/proceed/i,turnType:k.Start});a.push({regex:/arrive/i,turnType:k.Arrive});a.push({regex:/fell\sthrough/i,turnType:k.Merge});return a}();return{calculate:function(a){a=
COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var e=c("route");e&&e.route(a,function(h){if(a.generalize)h.geometry=pa.generalize(h.geometry,h.getInstructionPositions());if(a.map){g(a.map,h);a.autoFit&&a.map.gotoBounds(h.boundingBox)}a.success&&a.success(h)})},createMapOverlay:g,parseTurnType:i,TurnType:k,Instruction:function(a){var e=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),
h=a.description;h=h.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");e.description=h;if(!a.turnType)a.turnType=i(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Pa.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var e=[],h=0;h<a.instructions.length;h++)a.instructions[h].position&&e.push(a.instructions[h].position);return e}},a)}}}(),wb="featurecollection",ub="feature",hb={async:false},
na={processor:null,group:"shapes",layerClass:Db},ua={point:COG.extend({},na,{processor:function(g,i,k,y){i=n([i.coordinates],hb);if(i.length>0)if(k=y.marker(i[0],k)){g.add(k);return i.length}},group:"markers",layerClass:xb}),linestring:COG.extend({},na,{processor:function(g,i,k,y){i=n(i&&i.coordinates?i.coordinates:[]);return t(g,i,k,y)}}),multilinestring:COG.extend({},na,{processor:function(g,i,k,y){i=i&&i.coordinates?i.coordinates:[];for(var a=0,e=i.length;e--;)a+=t(g,i[e],k,y);return a}}),polygon:COG.extend({},
na,{processor:function(g,i,k,y){i=i&&i.coordinates?i.coordinates:[];if(i.length>0)return q(g,i[0],k,y);return 0}}),multipolygon:COG.extend({},na,{processor:function(g,i,k,y){i=i&&i.coordinates?i.coordinates:[];for(var a=0,e=0;e<i.length;e++)a+=q(g,i[e][0],k,y);return a}})},Qa=function(g,i,k,y){function a(R,Z){var ga=R.processor,va=X+R.group,oa=COG.extend({},R,k,{properties:Z.properties});if(ga){var Xa=N[va];if(!Xa){Xa=new R.layerClass({id:va});N[va]=Xa}globalLayers=N;return ga(Xa,Z.data,oa,y)}return 0}
function e(R,Z){var ga=R&&R.type?R.type.toLowerCase():null;return ga&&ga===ub?e(R.geometry,R.properties):{type:ga,isCollection:ga?ga===wb:false,definition:ua[ga],data:R,properties:Z?Z:R.properties}}function h(){var R=0,Z=fa;if(!Ea){for(;Z<Aa;Z++){var ga=e(I?I(g[Z]):g[Z]),va=null;if(ga.isCollection){T+=1;Ea=w(ga.data.features,function(oa){Ea=null;for(var Xa in oa)N[Xa]=oa[Xa]},{layerPrefix:X+T+"-"});va+=1}else if(ga.definition)va=a(ga.definition,ga);R+=va?va:1;if(R>=A)break}fa=Z+1;if(Ea||fa<Aa)animFrame(h);
else i&&i(N)}}k=COG.extend({vectorsPerCycle:Sa.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},k);y=COG.extend({marker:function(R){return new yb({xy:R})},line:function(R,Z){return new zb(R,Z)},poly:function(R,Z){return new zb(R,COG.extend({fill:true},Z))}},y);var A=k.vectorsPerCycle,I=k.rowPreParse,X=k.layerPrefix,fa=0,Aa=0,Ea=null,T=0,N={};if(g){if(typeof g.length==="undefined")g=[g];Aa=g.length;animFrame(h)}};$a.GeoJSON={parse:w};$a.Map=function(g){function i(N){try{var R=
Sa.Position.init(N.coords.latitude,N.coords.longitude),Z=N.coords.accuracy/1E3;T.trigger("locationUpdate",N,Z);if(fa){if(!I){I=new Sa.UI.LocationOverlay({pos:R,accuracy:Z});I.update(T.getTileLayer());T.setLayer("location",I)}var ga=Sa.BoundingBox.createBoundsFromCenter(R,Math.max(Z,1));T.gotoBounds(ga)}else{I.pos=R;I.accuracy=Z;I.update(T.getTileLayer());a(R,null,COG.easing("sine.out"))}fa=false}catch(va){COG.exception(va)}}function k(N){COG.info("caught location tracking error:",N)}function y(N,
R,Z){T.setZoomLevel(R);a(N,Z)}function a(N,R,Z,ga){N=Ya.init(N,Sa.radsPerPixel(T.getZoomLevel()));var va=T.getDimensions();T.updateOffset(N.x-(va.width>>1),N.y-(va.height>>1),Z,ga,function(){T.refresh();T.trigger("boundsChange",T.getBoundingBox());R&&R(T)})}g=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18},g);var e={NONE:0,SINGLE:1,WATCH:2},h=F.init(),A=e.NONE,I=null,X=0,fa=true,Aa=0,Ea=g.tapExtent;g.adjustScaleFactor=function(N){return Math.pow(2,
(N<1?Math.floor:Math.ceil)(Math.log(N)))};var T=COG.extend(new eb(g),{getBoundingBox:function(){var N=T.getViewRect();return Sa.BoundingBox.init(Ya.toPos(F.init(N.x1,N.y2),Aa),Ya.toPos(F.init(N.x2,N.y1),Aa))},getCenterPosition:function(){var N=T.getViewRect();if(N){N=F.init(N.x1+(N.width>>1),N.y1+(N.height>>1));return Ya.toPos(N,Aa)}return null},gotoBounds:function(N,R){var Z=Sa.BoundingBox.getZoomLevel(N,T.getDimensions());y(Sa.BoundingBox.getCenter(N),Z,R)},gotoPosition:y,panToPosition:a,syncXY:function(N){return Ya.sync(N,
Aa)},locate:function(){T.trackStart(e.SINGLE);setTimeout(T.trackCancel,1E4)},trackStart:function(N){if(navigator.geolocation&&!X){A=N?N:e.WATCH;fa=true;X=navigator.geolocation.watchPosition(i,k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){X&&navigator.geolocation&&navigator.geolocation.clearWatch(X);T.removeLayer("location");I=null;A=e.NONE;X=0},animateRoute:function(N,R,Z,ga){var va=T.getLayer("route");if(va)(N=va.getAnimation(N,R,Z,ga))&&N.addToView(T)}});T.bind("pan",
function(){A===e.SINGLE&&T.trackCancel()});T.bind("tap",function(N,R,Z,ga){var va=Sa.radsPerPixel(T.getZoomLevel());N=Ya.toPos(ga,va);var oa=Ya.toPos(F.offset(ga,-Ea,Ea),va);ga=Ya.toPos(F.offset(ga,Ea,-Ea),va);T.trigger("geotap",R,Z,N,Pa.init(oa,ga))});T.bind("refresh",function(){if(F.absSize(F.diff(h,T.getOffset()))>g.boundsChangeThreshold){h=F.copy(T.getOffset());T.trigger("boundsChange",T.getBoundingBox())}});T.bind("zoomLevelChange",function(N,R){var Z;Aa=Sa.radsPerPixel(R);Z=u/Aa|0;T.setMaxOffset(Z,
Z,true,false);W.cancelLoad();T.resetScale();T.triggerAll("resync",T);T.refresh()});return T};$a.GeoShape=function(g,i){i=COG.extend({autoParse:true},i);for(var k=Array(g.length),y=i.autoParse,a=T5.Geo.Position.parse,e=g.length;e--;)k[e]=T5.GeoXY.init(y?a(g[e]):g[e]);return new T5.Poly(k,i)};var Ra=$a.RouteOverlay=function(g){g=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},g);var i=[],k=[],y=new T5.PathLayer(g);
(function(){if(g.data&&g.data.instructions){for(var a=g.data.instructions,e=Array(a.length),h=a.length;h--;)e[h]=a[h].position;pa.vectorize(e,{callback:function(A){k=A}})}g.data&&g.data.geometry&&pa.vectorize(g.data.geometry,{callback:function(A){i=A;y.updateCoordinates(i,k,true)}})})();return y};$a.LocationOverlay=function(g){g=COG.extend({pos:null,accuracy:null,zindex:90},g);var i=new Image,k=T5.XY.init(),y=T5.XY.init(),a=null;i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
i.onload=function(){k=T5.XY.init(i.width>>1,i.height>>1)};var e=COG.extend(new T5.ViewLayer(g),{pos:g.pos,accuracy:g.accuracy,drawAccuracyIndicator:false,draw:function(h,A){var I=y.x-A.x,X=y.y-A.y;if(a){h.fillStyle="rgba(30, 30, 30, 0.2)";h.beginPath();h.arc(I,X,a,0,Math.PI*2,false);h.fill()}i.complete&&i.width>0&&h.drawImage(i,I-k.x,X-k.y,i.width,i.height);e.changed()},update:function(h){if(h){a=h.getPixelDistance(e.accuracy)>>1;y=h.getGridXYForPosition(e.pos);e.changed()}}});e.bind("gridUpdate",
function(h,A){e.update(A)});return e};return{distanceToString:function(g){if(g>1E3)return~~(g/10)/100+" km";return g?g+" m":""},dist2rad:function(g){return g/6371},getEngine:c,lat2pix:r,lon2pix:f,pix2lat:b,pix2lon:d,radsPerPixel:function(g){return u/(256<<g)},Position:pa,BoundingBox:Pa,Radius:function(g,i){return{distance:parseInt(g,10),uom:i}},Address:function(g){return g=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},g)},A:fb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(g){if(!g.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var i=COG.extend({remove:function(){delete ba[i.id]}},g);return ba[i.id]=i},Search:Ja,GeoSearchResult:Ba,LocationSearch:function(g){function i(h,A){navigator.geolocation.clearWatch(y);y=0;if(a){clearTimeout(a);a=0}A&&A([h],g)}function k(h){COG.info("caught location tracking error:",h)}g=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},g);var y=0,a=0,e=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(h,A){if(navigator.geolocation&&!y){y=navigator.geolocation.watchPosition(function(I){var X=pa.init(I.coords.latitude,I.coords.longitude);I=new Ba({id:1,caption:"Current Location",pos:X,accuracy:I.coords.accuracy/1E3,matchWeight:100});if(!e||I.accuracy<e.accuracy)e=I;if(!g.requiredAccuracy||e.accuracy<g.requiredAccuracy)i(e,A)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)a=
setTimeout(function(){e&&i(e,A)},g.searchTimeout)}}},g))},Routing:qa}}();return $a}();
