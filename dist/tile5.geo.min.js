COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var Y=arguments[0]||{},ua,O=1,G=arguments.length;O<G;O++)if((ua=arguments[O])!==null)for(var p in ua){var s=ua[p];if(Y!==s)if(s!==undefined)Y[p]=s}return Y};
(function(){var Y=Object.prototype.hasOwnProperty,ua=0,O={};O.toID=function(G){return G.replace(/\s/g,"-")};O.objId=function(G){return(G?G:"obj")+ua++};O.isFunction=function(G){return toString.call(G)==="[object Function]"};O.isArray=function(G){return toString.call(G)==="[object Array]"};O.isPlainObject=function(G){if(!G||toString.call(G)!=="[object Object]"||G.nodeType||G.setInterval)return false;if(G.constructor&&!Y.call(G,"constructor")&&!Y.call(G.constructor.prototype,"isPrototypeOf"))return false;
var p;for(p in G);return p===undefined||Y.call(G,p)};O.isEmptyObject=function(G){for(var p in G)return false;return true};O.isXmlDocument=function(G){return toString.call(G)==="[object Document]"};O.contains=function(G,p){var s=G,H=arguments,K=1;if(p&&module.isArray(p)){H=p;K=0}for(K=K;K<H;K++)s=s&&typeof foo[H[K]]!=="undefined";return s};O.formatStr=function(G){if(arguments.length<=1)return G;for(var p=arguments.length-2,s=0;s<=p;s++)G=G.replace(RegExp("\\{"+s+"\\}","gi"),arguments[s+1]);return G};
O.wordExists=function(G,p){var s="";if(p.toString)p=p.toString();for(var H=0;H<p.length;H++)s+=!/\w/.test(p[H])?"\\"+p[H]:p[H];return RegExp("(^|\\s|\\,)"+s+"(\\,|\\s|$)","i").test(G)};COG.extend(COG,O)})();
(function(){function Y(s){return typeof console!=="undefined"?function(){console[s](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ua=window.console&&window.console.markTimeline,O=Y("error"),G=Y("info"),p=function(){return ua?function(s,H){console.markTimeline(s+(H?": "+((new Date).getTime()-H)+"ms":""))}:function(){}}();COG.extend(COG,{trace:p,debug:Y("debug"),info:G,warn:Y("warn"),error:O,exception:function(s){if(O)for(var H in s)G("ERROR DETAIL: "+
H+": "+s[H])}})})();
(function(){function Y(O,G){var p=O.obsHandlers;p[G]||(p[G]=[]);return p[G]}var ua=0;COG.observable=function(O){if(!O)return null;if(!O.obsHandlers)O.obsHandlers={};if(!(O.bind||O.trigger||O.unbind)){O.bind=function(G,p){var s="callback"+ua++;Y(O,G).unshift({fn:p,id:s});return s};O.triggerCustom=function(G,p){var s=Y(O,G),H={cancel:false,name:G},K;p&&COG.extend(H,p);if(!s)return null;K=Array.prototype.slice.call(arguments,2);O.eventInterceptor&&O.eventInterceptor(G,H,K);K.unshift(H);for(var o=s.length;o--&&
!H.cancel;)s[o].fn.apply(this,K);return H};O.trigger=function(G){var p=Array.prototype.slice.call(arguments,1);p.splice(0,0,G,null);return O.triggerCustom.apply(this,p)};O.unbind=function(G,p){if(typeof G==="undefined")O.obsHandlers={};else for(var s=Y(O,G),H=0;s&&H<s.length;H++)if(s[H].id===p){s.splice(H,1);break}return O}}return O}})();
(function(){function Y(p,s){p[s]||(p[s]=function(H){return p.configure(s,H)})}function ua(p){p.gtConfId="configurable"+G++;p.gtConfig={};p.gtConfigFns=[];return p.gtConfig}var O={},G=0;COG.paramTweaker=function(p,s,H){return function(K,o){if(typeof o!=="undefined"){if(K in p)p[K]=o;H&&K in H&&H[K](K,o)}else return s&&K in s?s[K](K):p[K]}};COG.configurable=function(p,s,H,K){if(p){p.gtConfId||ua(p);var o=p.gtConfId,J=p.gtConfig,D=p.gtConfigFns;O[o]=p;D.push(H);for(H=s.length;H--;){J[s[H]]=true;K&&Y(p,
s[H])}if(!p.configure)p.configure=function(M,$){if(J[M]){for(var u=D.length;u--;){var A=D[u](M,$);if(typeof A!=="undefined")return A}return O[o]}return null}}}})();
(function(){function Y(p){var s=document.createElement("script"),H=false;s.src=p;s.async=true;s.onload=s.onreadystatechange=function(){if(!H&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){H=true;s.onload=s.onreadystatechange=null;s&&s.parentNode&&s.parentNode.removeChild(s)}};O||(O=document.getElementsByTagName("head")[0]);O.appendChild(s)}var ua=0,O,G=this;COG.jsonp=function(p,s,H){p+=p.indexOf("?")>=0?"&":"?";var K="json"+ ++ua;G[K]=function(o){s(o);G[K]=null;try{delete G[K]}catch(J){}};
Y(p+(H?H:"callback")+"="+K);return K}})();
(function(){var Y=1.70158,ua=Math.PI/2,O=Math.abs,G=Math.pow,p=Math.sin,s=Math.asin,H=Math.cos,K={linear:function(o,J,D,M){return D*o/M+J},backin:function(o,J,D,M){return D*(o/=M)*o*((Y+1)*o-Y)+J},backout:function(o,J,D,M){return D*((o=o/M-1)*o*((Y+1)*o+Y)+1)+J},backinout:function(o,J,D,M){return(o/=M/2)<1?D/2*o*o*(((Y*=1.525)+1)*o-Y)+J:D/2*((o-=2)*o*(((Y*=1.525)+1)*o+Y)+2)+J},bouncein:function(o,J,D,M){return D-K.bounceout(M-o,0,D,M)+J},bounceout:function(o,J,D,M){return(o/=M)<1/2.75?D*7.5625*o*
o+J:o<2/2.75?D*(7.5625*(o-=1.5/2.75)*o+0.75)+J:o<2.5/2.75?D*(7.5625*(o-=2.25/2.75)*o+0.9375)+J:D*(7.5625*(o-=2.625/2.75)*o+0.984375)+J},bounceinout:function(o,J,D,M){return o<M/2?K.bouncein(o*2,0,D,M)/2+J:K.bounceout(o*2-M,0,D,M)/2+D/2+J},cubicin:function(o,J,D,M){return D*(o/=M)*o*o+J},cubicout:function(o,J,D,M){return D*((o=o/M-1)*o*o+1)+J},cubicinout:function(o,J,D,M){if((o/=M/2)<1)return D/2*o*o*o+J;return D/2*((o-=2)*o*o+2)+J},elasticin:function(o,J,D,M,$,u){if(o==0)return J;if((o/=M)==1)return J+
D;u||(u=M*0.3);if(!$||$<O(D)){$=D;D=u/4}else D=u/TWO_PI*s(D/$);return-($*G(2,10*(o-=1))*p((o*M-D)*TWO_PI/u))+J},elasticout:function(o,J,D,M,$,u){var A;if(o==0)return J;if((o/=M)==1)return J+D;u||(u=M*0.3);if(!$||$<O(D)){$=D;A=u/4}else A=u/TWO_PI*s(D/$);return $*G(2,-10*o)*p((o*M-A)*TWO_PI/u)+D+J},elasticinout:function(o,J,D,M,$,u){var A;if(o==0)return J;if((o/=M/2)==2)return J+D;u||(u=M*0.3*1.5);if(!$||$<O(D)){$=D;A=u/4}else A=u/TWO_PI*s(D/$);if(o<1)return-0.5*$*G(2,10*(o-=1))*p((o*M-A)*TWO_PI/u)+
J;return $*G(2,-10*(o-=1))*p((o*M-A)*TWO_PI/u)*0.5+D+J},quadin:function(o,J,D,M){return D*(o/=M)*o+J},quadout:function(o,J,D,M){return-D*(o/=M)*(o-2)+J},quadinout:function(o,J,D,M){if((o/=M/2)<1)return D/2*o*o+J;return-D/2*(--o*(o-2)-1)+J},sinein:function(o,J,D,M){return-D*H(o/M*ua)+D+J},sineout:function(o,J,D,M){return D*p(o/M*ua)+J},sineinout:function(o,J,D,M){return-D/2*(H(Math.PI*o/M)-1)+J}};COG.tweenValue=function(o,J,D,M,$){function u(ma){var V=ma-A,na=D(V,o,L,M),ja=A+M<=ma;ma=!ja;if($){V=$(na,
ja,V);ma=typeof V!="undefined"?V&&ma:ma}ma&&animFrame(u)}var A=(new Date).getTime(),L=J-o;animFrame(u);return{}};COG.easing=function(o){return K[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(o,J){K[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]=J}})();
(function(){var Y=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ua=/^(\d+H)?(\d+M)?(\d+S)?$/,O={8601:function(p){p=p.split("T");var s=null;s=null;var H=0,K=0;Y.lastIndex=-1;s=Y.exec(p[0]);H+=s[3]?parseInt(s[3].slice(0,-1),10):0;ua.lastIndex=-1;s=ua.exec(p[1]);K+=s[1]?parseInt(s[1].slice(0,-1),10)*3600:0;K+=s[2]?parseInt(s[2].slice(0,-1),10)*60:0;K+=s[3]?parseInt(s[3].slice(0,-1),10):0;return new G(H,K)}},G=COG.Duration=function(p,s){return{days:p?p:0,seconds:s?s:0}};COG.addDuration=function(){for(var p=new G,s=arguments.length;s--;){p.days+=
arguments[s].days;p.seconds+=arguments[s].seconds}if(p.seconds>=86400){p.days+=~~(p.seconds/86400);p.seconds%=86400}return p};COG.formatDuration=function(p){var s,H,K="";if(p.days)K=p.days+" days ";if(p.seconds){p=p.seconds;if(p>=3600){s=~~(p/3600);p-=s*3600}if(p>=60){H=Math.round(p/60);p-=H*60}if(s)K=K+s+(s>1?" hrs ":" hr ")+(H?(H>10?H:"0"+H)+" min ":"");else if(H)K=K+H+" min";else if(p>0)K=K+(p>10?p:"0"+p)+" sec"}return K};COG.parseDuration=function(p,s){var H=s?O[s]:null;if(H)return H(p);COG.Log.warn("Could not find duration parser for specified format: "+
s);return new G}})();
INTERACT=function(){function Y(u){return function(A,L,ma){(ma?ma:u?document.body:document).addEventListener(A,L,false)}}function ua(u){return function(A,L,ma){(ma?ma:u?document.body:document).removeEventListener(A,L,false)}}function O(u,A,L){(L?L:document).attachEvent("on"+u,A)}function G(u,A,L){(L?L:document).detachEvent("on"+u,A)}function p(u,A){return{x:u?u:0,y:A?A:0,count:1}}function s(u,A){M.push(COG.extend({handler:null,checks:{},type:u},A))}function H(u){var A=0,L=0;if(u.offsetParent){do{A+=u.offsetLeft;
L+=u.offsetTop;u=u.offsetParent}while(u)}return{x:A,y:L}}function K(u,A){return{source:u,target:A.target?A.target:A.srcElement}}function o(u,A){for(var L=u.target?u.target:u.srcElement;L&&L!==A&&L.nodeName&&L.nodeName.toUpperCase()!="CANVAS";)L=L.parentNode;return L&&L===A}function J(u,A){return{x:u.x-(A?A.x:0),y:u.y-(A?A.y:0)}}function D(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}var M=[],$=function(u,A,L){function ma(ea,oa,sa,E){var ba=0,
ka=0,B=0;COG.tweenValue(0,ea,sa,E,function(fa){B=ba;ba=fa});COG.tweenValue(0,oa,sa,E,function(fa){V.trigger("pan",ba-B,fa-ka);ka=fa})}L=COG.extend({binder:null,unbinder:null,observable:null},L);for(var V=L.observable,na=null,ja=[],la=[],wa,Ia,xa={bind:function(){return V.bind.apply(null,arguments)},pannable:function(ea){na=COG.extend({inertia:true},ea);return xa},unbind:function(){V.unbind();for(var ea=0;ea<ja.length;ea++)ja[ea].unbind();return xa}},Ma=0;Ma<A.length;Ma++)ja.push(A[Ma](u,V,L));V.bind("pointerDown",
function(){la=[];Ia=wa=0});V.bind("pointerMove",function(ea,oa,sa,E){if(na){la[la.length]={ticks:(new Date).getTime(),x:E.x,y:E.y};V.trigger("pan",E.x,E.y)}wa+=E.x?E.x:0;Ia+=E.y?E.y:0});V.bind("pointerUp",function(ea,oa,sa){if(Math.abs(wa)>20||Math.abs(Ia)>20){if(na){sa=la.length;var E,ba;oa=0;for(ba=la.length;--ba>1&&oa<50;)oa+=la[ba].ticks-la[ba-1].ticks;if(sa-ba>1){ea=la[sa-1].x-la[ba].x;E=la[sa-1].y-la[ba].y;ba=Math.sqrt(ea*ea+E*E)|0;if(ba>15){ea=la[sa-1].x-la[0].x;E=la[sa-1].y-la[0].y;ba=Math.sqrt(ea*
ea+E*E)|0;sa=Math.asin(E/ba);oa=ba*500/oa|0;oa=oa>300?300:oa;ma(Math.cos(ea>0?sa:Math.PI-sa)*oa,Math.sin(sa)*oa,COG.easing("sine.out"),500)}}}}else V.trigger("tap",oa,sa)});return xa};s("pointer",{handler:function(u,A,L){function ma(B){if(o(B,u))if(Ma=la(B)){u.style.cursor="move";D(B);ba=B.pageX?B.pageX:B.screenX;ka=B.pageY?B.pageY:B.screenY;ea=p(ba,ka);oa=H(u);A.triggerCustom("pointerDown",K("mouse",B),ea,J(ea,oa))}}function V(B){sa=B.pageX?B.pageX:B.screenX;E=B.pageY?B.pageY:B.screenY;if(o(B,u))wa(B,
Ma?"pointerMove":"pointerHover")}function na(B){if(Ma&&la(B)){Ma=false;if(o(B,u)){u.style.cursor="default";wa(B,"pointerUp")}}}function ja(B){if(o(B,u)){var fa;B=B||window.event;if(B.detail)fa=B.axis===2?-B.detail*Ia:0;else{fa=B.wheelDeltaY?B.wheelDeltaY:B.wheelDelta;if(window.opera)fa=-fa}if(fa!==0){var Ba=p(sa,E);A.triggerCustom("zoom",K("mouse",B),Ba,J(Ba,H(u)),fa/xa,"wheel");D(B);B.returnValue=false}}}function la(B){B=B||window.event;return(B.which||B.button)==1}function wa(B,fa,Ba,Fa,Ta){Ba=
typeof Ba!="undefined"?Ba:sa;Fa=typeof Fa!="undefined"?Fa:E;var S=Ba-ba,ga=Fa-ka,W=p(Ba,Fa);oa||(oa=H(u));A.triggerCustom(fa,K("mouse",B),W,J(W,oa),p(S,ga));if(typeof Ta=="undefined"||Ta){ba=Ba;ka=Fa}}L=COG.extend({},L);var Ia=120,xa=Ia*8,Ma=false,ea,oa,sa,E,ba,ka;L.binder("mousedown",ma,false);L.binder("mousemove",V,false);L.binder("mouseup",na,false);L.binder("dblclick",function(B){COG.info("captured double click");if(o(B,u)){var fa=p(B.pageX?B.pageX:B.screenX,B.pageY?B.pageY:B.screenY);COG.info("captured double click + target matched");
A.triggerCustom("doubleTap",K("mouse",B),fa,J(fa,H(u)))}},false);L.binder("mousewheel",ja,document);L.binder("DOMMouseScroll",ja,document);return{unbind:function(){L.unbinder("mousedown",ma,false);L.unbinder("mousemove",V,false);L.unbinder("mouseup",na,false);L.unbinder("mousewheel",ja,document);L.unbinder("DOMMouseScroll",ja,document)}}},checks:{touch:false}});s("pointer",{handler:function(u,A,L){function ma(S){if(S.count<2)return 0;var ga=S.x-S.next.x;S=S.y-S.next.y;return~~Math.sqrt(ga*ga+S*S)}
function V(S,ga,W){ga=ga?ga:0;W=W?W:0;for(var Ja={x:S.x-ga,y:S.y-W,id:S.id,count:S.count},Ga=Ja;S.next;){S=S.next;Ga=Ga.next={x:S.x-ga,y:S.y-W,id:S.id}}return Ja}function na(S,ga){var W=S[ga?ga:"touches"],Ja,Ga;if(W.length===0)return null;Ga=Ja={x:W[0].pageX,y:W[0].pageY,id:W[0].identifier,count:W.length};for(var Pa=1,cb=W.length;Pa<cb;Pa++)Ga=Ga.next={x:W[Pa].pageX,y:W[Pa].pageY,id:W[Pa].identifier};return Ja}function ja(S){if(o(S,u)){E=H(u);var ga=na(S,"changedTouches"),W=V(ga,E.x,E.y);if(!ka){ba=
ea;A.triggerCustom("pointerDown",K("touch",S),ga,W)}Fa&&A.triggerCustom("pointerDownMulti",K("touch",S),ga,W);ka=na(S);if(ka.count>1)fa=ma(ka);Ta=1;Ba=V(ka)}}function la(S){if(o(S,u)){S.preventDefault();B=na(S);if(ba==ea)ba=Math.abs(ka.x-B.x)>xa||Math.abs(ka.y-B.y)>xa?Ma:ea;if(ba!=ea){ba=B.count>1?sa:oa;if(ba==sa)if(ka.count===1){ka=V(B);fa=ma(ka)}else{var ga=ma(B);if(Math.abs(fa-ga)<Ia)ba=oa;else{var W;W=B.x;var Ja=B.next.x,Ga=B.y,Pa=B.next.y,cb=Ga<Pa?Ga:Pa;W={x:(W<Ja?W:Ja)+(Math.abs(W-Ja)>>1),y:cb+
(Math.abs(Ga-Pa)>>1)};ga=ga/fa;Ja=ga-Ta;A.triggerCustom("zoom",K("touch",S),W,J(W,E),Ja,"pinch");Ta=ga}}ba==oa&&A.triggerCustom("pointerMove",K("touch",S),B,V(B,E.x,E.y),p(B.x-Ba.x,B.y-Ba.y));Fa&&A.triggerCustom("pointerMoveMulti",K("touch",S),B,V(B,E.x,E.y))}Ba=V(B)}}function wa(S){if(o(S,u)){var ga=na(S,"changedTouches"),W=V(ga,E.x,E.y);B=na(S);if(!B){ba===ea&&A.triggerCustom("tap",K("touch",S),ga,W);A.triggerCustom("pointerUp",K("touch",S),ga,W);ka=null}Fa&&A.triggerCustom("pointerUpMulti",K("touch",
S),ga,W)}}L=COG.extend({detailed:false,inertia:false},L);var Ia=20,xa=7,Ma=0,ea=1,oa=2,sa=3,E,ba,ka,B,fa,Ba,Fa=L.detailed,Ta=1;L.binder("touchstart",ja,false);L.binder("touchmove",la,false);L.binder("touchend",wa,false);COG.info("initialized touch handler");return{unbind:function(){L.unbinder("touchstart",ja,false);L.unbinder("touchmove",la,false);L.unbinder("touchend",wa,false)}}},checks:{touch:true}});return{register:s,watch:function(u,A,L){A=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},A);capabilities=COG.extend({touch:"ontouchstart"in window},L);if(!A.observable){COG.info("creating observable");A.observable=COG.observable({});globalOpts=A}A.binder=A.isIE?O:Y(A.bindToBody);A.unbinder=A.isIE?G:ua(A.bindToBody);L=A.types;for(var ma=capabilities,V=[],na=M.length;na--;){var ja=M[na],la=!L||L.indexOf(ja.type)>=0,wa=true;for(var Ia in ja.checks){var xa=ja.checks[Ia];COG.info("checking "+Ia+" capability. require: "+xa+", capability = "+ma[Ia]);wa=wa&&xa===ma[Ia]}if(la&&
wa)V[V.length]=ja.handler}return new $(u,V,A)}}}();
T5=function(){function Y(){return(new Date).getTime()}function ua(){for(;S.length>0;){var c=S.shift();document.location=c}Ta=0}function O(c){for(var r=true,e=ga.length;e--;)r=r&&c!=ga[e];return r}function G(c,r){var e=[];for(var b in r)b&&e.push(b+"="+escape(r[b]));return"tile5://"+c+"/"+(e.length>0?"?"+e.join("&"):"")}function p(c,r){O(c)&&COG.info("would push url: "+G(c,r))}function s(c,r){if(O(c)){S.push(G(c,r));Ta||(Ta=setTimeout(ua,100))}}function H(c){return function(r,e,b){(b?b:c?document.body:
document).addEventListener(r,e,false)}}function K(c){return function(r,e,b){(b?b:c?document.body:document).removeEventListener(r,e,false)}}function o(c,r,e){(e?e:document).attachEvent("on"+c,r)}function J(c,r,e){(e?e:document).detachEvent("on"+c,r)}function D(){fa={base:{name:"Unknown",bindEvent:H(),unbindEvent:K(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:p,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:o,unbindEvent:J,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:s,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:s},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:s},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:H(true),unbindEvent:K(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:s},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:s}};Ba=[fa.froyo,fa.android,fa.ipod,fa.iphone,fa.ipad,fa.ie]}function M(){fa||D();if(!Fa){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<Ba.length;c++){var r=Ba[c];if(r.regex&&r.regex.test(navigator.userAgent)){Fa=COG.extend({},fa.base,r);COG.info("PLATFORM DETECTED AS: "+Fa.name);break}}if(!Fa){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Fa=fa.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Fa}function $(){for(var c=0,r=arguments.length;r--;){var e=Pa[arguments[r].toUpperCase()];if(e)c|=e}return c}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){setTimeout(function(){c((new Date).getTime())},1E3/60)}}();var u=Math.PI*2,A=Math.PI/2,L=Math.abs,ma=
Math.ceil,V=Math.min,na=Math.max,ja=Math.pow,la=Math.sqrt,wa=Math.log,Ia=Math.round,xa=Math.sin,Ma=Math.asin,ea=Math.cos,oa=Math.atan,sa=Math.atan2,E=function(){function c(b,d){return e(b.x-d.x,b.y-d.y)}function r(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var m={edges:Array(d-1),accrued:Array(d-1),total:0},l=0;l<d-1;l++){var t=c(b[l],b[l+1]);m.edges[l]=la(t.x*t.x+t.y*t.y);m.accrued[l]=m.total+m.edges[l];m.total+=m.edges[l]}return m}
function e(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,m=arguments.length;m--;){b+=arguments[m].x;d+=arguments[m].y}return e(b,d)},absSize:function(b){return na(L(b.x),L(b.y))},copy:function(b){return b?e(b.x,b.y):null},diff:c,distance:function(b,d){return r(b,d).total},edges:r,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,m){var l=ea(d)*m;d=xa(d)*m;return e(b.x-l,b.y-d)},floor:function(b){for(var d=
Array(b.length),m=b.length;m--;)d[m]=e(~~b[m].x,~~b[m].y);return d},getRect:function(b){for(var d,m,l,t,q=b.length;q--;){var n=b[q];d=typeof d==="undefined"||n.x<d?n.x:d;m=typeof m==="undefined"||n.y<m?n.y:m;l=typeof l==="undefined"||n.x>l?n.x:l;t=typeof t==="undefined"||n.y>t?n.y:t}return ka.init(d,m,l,t)},init:e,invert:function(b){return e(-b.x,-b.y)},min:function(b,d){return e(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return e(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,m){return e(b.x+
d,b.y+(m?m:d))},simplify:function(b,d){if(!b)return null;d=d?d:E.VECTOR_SIMPLIFICATION;for(var m=[],l=null,t=b.length;t--;){var q=b[t];if(include=!l||t===0||L(q.x-l.x)+L(q.y-l.y)>d){m.unshift(q);l=q}}return m},theta:function(b,d,m){m=Ma((b.y-d.y)/m);return b.x>d.x?m:Math.PI-m},toString:function(b){return b?b.x+", "+b.y:""}}}(),ba=function(){return{dotProduct:function(c,r){return c.x*r.x+c.y*r.y}}}(),ka=function(){function c(e){return r(e.x1,e.y1,e.x2,e.y2)}function r(e,b,d,m){e=e?e:0;b=b?b:0;d=typeof d!==
"undefined"?d:e;m=typeof m!=="undefined "?m:m;return{x1:e,y1:b,x2:d,y2:m,width:d-e,height:m-b}}return{center:function(e){return E.init(e.x1+e.width/2,e.y1+e.height/2)},copy:c,diagonalSize:function(e){return la(e.width*e.width+e.height*e.height)},fromCenter:function(e,b,d,m){d=d>>1;m=m>>1;return r(e-d,b-m,e+d,b+m)},init:r,intersect:function(e,b){var d=na(e.x1,b.x1),m=na(e.y1,b.y1),l=V(e.x2,b.x2),t=V(e.y2,b.y2);d=r(d,m,l,t);return d.width>0&&d.height>0?d:null},toString:function(e){return"["+e.x1+", "+
e.y1+", "+e.x2+", "+e.y2+"]"},union:function(e,b){if(e.width===0||e.height===0)return c(b);else if(b.width===0||b.height===0)return c(e);else{var d=V(e.x1,b.x1),m=V(e.y1,b.y1),l=na(e.x2,b.x2),t=na(e.y2,b.y2);d=r(d,m,l,t);return d.width>0&&d.height>0?d:null}}}}(),B=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return E.init(c.width>>1,c.height>>1)},getSize:function(c){return la(ja(c.width,2)+ja(c.height,2))},init:function(c,r){c=c?c:0;return{width:c,
height:r?r:c}}}}(),fa=null,Ba=[],Fa=null,Ta=0,S=[],ga=["view.wake","tile.loaded"],W=function(){function c(){var j=M().maxImageLoads;if(!j||q.length<j)if(j=t.shift()){q[q.length]=j;j.image.onload=r;j.image.src=j.url;j.requested=T5.ticks()}}function r(){var j=m[this.id],x;if(j&&j.image.complete&&j.image.width>0){j.loaded=true;j.hitCount=1;for(x=q.length;x--;)if(q[x].image.src==this.src){q.splice(x,1);break}if(j.background||j.postProcess||j.drawBackground||j.customDraw)if(j.image){globalImageData=j;
x=b(j.realSize?j.realSize.width:j.image.width,j.realSize?j.realSize.height:j.image.height);var P=x.getContext("2d"),T=j.offset?j.offset:T5.XY.init();j.background&&P.drawImage(j.background,0,0);j.drawBackground&&j.drawBackground(P);j.customDraw?j.customDraw(P,j):P.drawImage(j.image,T.x,T.y);j.postProcess&&j.postProcess(P,j);j.image=x}for(x=j.callbacks.length;x--;)j.callbacks[x]&&j.callbacks[x](this,false);j.callbacks=[];n[n.length]={url:this.src,created:j.requested};delete m[this.id];c()}}function e(j,
x,P){var T=d[j];if(T){T.hitCount++;T.image.complete&&T.image.width>0&&x?x(T.image,true):T.callbacks.push(x)}else{T=COG.extend({url:j,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[x]},P);T.image.id="resourceLoaderImage"+l++;d[j]=T;m[T.image.id]=T;t[t.length]=T;c()}return T}function b(j,x){var P=document.createElement("canvas");COG.info("creating new canvas");P.width=j?j:0;P.height=x?x:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(P);FlashCanvas.initElement(P)}return P}
var d={},m={},l=0,t=[],q=[],n=[],w={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var j;for(j=q.length;j--;)delete d[q[j].url];q=[];for(j=t.length;j--;)delete d[t[j].url];t=[]},get:function(j,x,P){var T=null;T=null;if((T=(T=d[j])?T.image:null)&&(T.getContext||T.complete&&T.width>0))return T;else x&&e(j,x,P);return null},load:e,newCanvas:b,reset:function(){d={}},stats:function(){return{imageLoadingCount:q.length,queuedImageCount:t.length,imageCacheFullness:0}}};COG.observable(w);return w}(),
Ja=function(){var c={};return{init:function(r,e){var b=c[r];if(!b)throw Error("Unable to locate requested generator: "+r);return new b(e)},register:function(r,e){c[r]=e},Template:function(){}}}(),Ga=function(){function c(l,t){d[l]=e(t);return l}function r(l){for(var t in l)c(t,l[t])}function e(l){function t(j){var x=l[j];typeof x!=="undefined"&&n.push(function(P){P[j]=x})}function q(){n=[];for(var j in l)t(j)}l=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,
lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},l);var n=[],w={applyToContext:function(j){for(var x=n.length;x--;)n[x](j)},update:function(j,x){l[j]=x;q()}};q();return w}var b={},d={},m={apply:function(l,t){var q=d[t]?d[t]:d.basic,n;if(l&&l.canvas){n=b[l.canvas.id];b[l.canvas.id]=t}q.applyToContext(l);return n},define:c,defineMany:r,get:function(l){return d[l]},init:e,load:function(l){COG.jsonp(l,function(t){r(t)})}};r({basic:{lineWidth:1,strokeStyle:"#000",
fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return m}(),Pa={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},cb=function(c){function r(y,C,F,R){Na=lb;Ua(va-C,ra-F,R?c.panAnimationEasing:null,R?c.panAnimationDuration:null);clearTimeout(Ha);Ha=setTimeout(e,100)}function e(){Na=zb;Aa()}function b(y,C,F,R){Ya(V(na(X+ja(2,R)-1,0.5),2))}function d(){var y=wa(X)/Math.LN2>>0;if(y!==0){X=ja(2,y);hb(ib+Math.log(X)/Math.LN2,mb,nb)}Aa()}function m(y){y||
(y=E.init(v,I));ca=E.init(va,ra);da=E.offset(y,va,ra);mb=da.x;nb=da.y}function l(y,C){var F,R;R=1/X;if(X!==1&&a){F=a.x1+y*R;R=a.y1+C*R}else{F=y+va;R=C+ra}return E.init(F,R)}function t(y,C,F){ha("doubleTap",C,F,l(F.x,F.y));c.scalable&&Ya(2,F,c.zoomEasing,null,c.zoomDuration)}function q(y,C,F){jb=null;x(C,F,l(F.x,F.y),"down")}function n(y,C,F){jb=l(F.x,F.y);x(C,F,jb,"hover")}function w(){clearTimeout(ia);ia=setTimeout(P,250)}function j(y,C,F){x(C,F,l(F.x,F.y),"tap");ha("tap",C,F,l(F.x,F.y))}function x(y,
C,F,R){for(var pa=[],za=ya;za--;)if(aa[za].hitTest)pa=pa.concat(aa[za].hitTest(F.x,F.y,Na,Ca));pa.length>0&&Ca.triggerCustom(R+"Hit",{hitType:R},pa,y,C,F)}function P(y,C){var F;if(Da){if(c.autoSize&&Da.parentNode){y=Da.parentNode.offsetWidth;C=Da.parentNode.offsetHeight}try{if(!Da.id)Da.id=c.id+"_canvas";qa=Da.getContext("2d")}catch(R){COG.exception(R);throw Error("Could not initialise canvas on specified view element");}if(y&&C&&(Ka!==C||La!==y)){Qa=true;La=y;Ka=C;v=La>>1;I=Ka>>1;Ca.trigger("resize",
La,Ka);for(F=ya;F--;)aa[F].trigger("resize",La,Ka)}for(F=ya;F--;)aa[F].trigger("contextChanged",qa);Aa();ta()}}function T(y,C){C.setId(y);C.added=Y();C.bind("remove",function(){Ca.removeLayer(y)});C.trigger("contextChanged",qa);C.setParent(Ca);aa.push(C);aa.sort(function(F,R){var pa=R.zindex-F.zindex;if(pa===0)pa=R.added-F.added;return pa});ya=aa.length;return C}function ta(){Za&&Za.unbind();Za=INTERACT.watch(Da);c.pannable&&Za.pannable().bind("pan",r);if(c.scalable){Za.bind("zoom",b);Za.bind("doubleTap",
t)}if(c.captureHover){Za.bind("pointerDown",q);Za.bind("pointerHover",n)}Za.bind("tap",j)}function Va(y){var C,F=false;if(ob){if(y-$a>Db){Na=X!==1?Na|pb:Na&~pb;Ea=(C=(Na&(pb|lb))!==0)&&(Na&qb)===0;if(Qa&&Da){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(Da);Da.width=La;Da.height=Ka;Da.style.width=La+"px";Da.style.height=Ka+"px";Qa=false}if(Ra||Sa){var R=db?va+v:va,pa=f?ra+I:ra;if(Ra&&Ra>La)if(R+La>Ra)va=db?R-Ra>0?va-Ra:va:Ra-La;else if(R<0)va=db?va+Ra:0;if(Sa&&Sa>Ka)if(pa+Ka>Sa)ra=f?pa-
Sa>0?ra-Sa:ra:Sa-Ka;else if(pa<0)ra=f?ra+Sa:0}i=eb();for(R=ya;R--;){if(aa[R].animated)Na|=qb;aa[R].cycle(y,i,Na);aa[R].shouldDraw(Na,i);F=aa[R].clip||F}R=Na;pa=i;C=k&&F&&!C;var za;ka.center(pa);F=0;a=ka.copy(pa);a.scaleFactor=X;if(!C)if(!rb||y-Z>sb){qa.clearRect(0,0,La,Ka);Z=y}qa.save();try{if(X!==1){var ab=a,Wa=1/X;mb=da.x+(va-ca.x);nb=da.y+(ra-ca.y);a=ab?ka.fromCenter(mb>>0,nb>>0,ab.width*Wa>>0,ab.height*Wa>>0):void 0;qa.scale(X,X)}qa.translate(-a.x1,-a.y1);N=Q=null;if(C&&!rb){qa.beginPath();for(F=
ya;F--;)aa[F].clip&&aa[F].clip(qa,a,R,Ca,y);qa.closePath();qa.clip()}for(F=ya;F--;){za=aa[F];qa.globalCompositeOperation=rb&&za.zIndex<=0?"copy":"source-over";var bb=za.style,fb=bb?Ga.apply(qa,bb):null;if(za.minXY)Q=Q?E.min(Q,za.minXY):E.copy(za.minXY);if(za.maxXY)N=N?E.max(N,za.maxXY):E.copy(za.maxXY);za.draw(qa,a,R,Ca,y);fb&&Ga.apply(qa,fb)}}finally{qa.restore()}if(g){qa.globalCompositeOperation="source-over";qa.strokeStyle="#f00";qa.beginPath();qa.moveTo(v,0);qa.lineTo(v,Ka);qa.moveTo(0,I);qa.lineTo(La,
I);qa.stroke()}ob=0;ha("drawComplete",pa,y);y-U>tb&&kb();$a=y}animFrame(Va)}else z=false}function Aa(){ob+=1;if(!z){z=true;animFrame(Va)}}function eb(){return ka.init(va,ra,va+La,ra+Ka)}function kb(){U=(new Date).getTime();ha("refresh",Ca,eb());Aa()}function Ya(y,C,F,R,pa){if(F)COG.tweenValue(X,y,F,pa,function(za,ab){X=za;if(ab){var Wa=Ia(wa(X)/Math.LN2);X=ja(2,Wa);R&&R()}m(C);d()});else{X=y;m(C);d()}return Ca}function hb(y,C,F){y=na(c.minZoom,V(c.maxZoom,y));if(y!==ib){var R=ja(2,y-ib),pa=v/R|0,
za=I/R|0;ib=y;Ua(((C?C:va+v)-pa)*R,((F?F:ra+I)-za)*R);ha("zoomLevelChange",y);X=1;kb()}}function ha(){for(var y=Ca.trigger.apply(null,arguments).cancel,C=aa.length;C--;)y=aa[C].trigger.apply(null,arguments).cancel||y;return!y}function Ua(y,C,F,R,pa){function za(){ab+=1;if(ab>=2){e();pa&&pa()}}var ab=0,Wa=Q?E.offset(Q,-v,-I):null,bb=N?E.offset(N,-v,-I):null;if(Wa){y=y<Wa.x?Wa.x:y;C=C<Wa.y?Wa.y:C}if(bb){y=y>bb.x?bb.x:y;C=C>bb.y?bb.y:C}if(F){if((Na&lb)===0){COG.tweenValue(va,y,F,R,function(fb,ub){va=
fb|0;(ub?za:Aa)();return!Ea});COG.tweenValue(ra,C,F,R,function(fb,ub){ra=fb|0;(ub?za:Aa)();return!Ea});Na=lb|qb}}else{va=y|0;ra=C|0;Aa();pa&&pa()}}c=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastDraw:false,inertia:true,minRefresh:1E3,pannable:true,clipping:true,scalable:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),
zoomDuration:300,zoomLevel:1},c);var sb=500,aa=[],ya=0,Da=document.getElementById(c.container),qa=null,vb=typeof window.attachEvent!="undefined",tb=c.minRefresh,jb=null,va=0,ra=0,Ra=null,Sa=null,db=false,f=false,k=c.clipping,i=null,z=false,a,g=c.guides,h=1,v=0,I=0,ca=null,da=null,Ea=false,Ha=0,Q=null,N=null,U=0,Z=0,ia=0,X=1,$a=0,Qa=false,Za=null,rb=c.turbo,Ka,La,Db=1E3/c.fps|0,ob=0,mb,nb,ib=c.zoomLevel,zb=$("ACTIVE"),lb=$("PAN"),pb=$("ZOOM"),qb=$("ANIMATING"),Na=zb,Ca={id:c.id,deviceScaling:h,fastDraw:c.fastDraw||
M().requireFastDraw,getDimensions:function(){return B.init(La,Ka)},getLayer:function(y){for(var C=0;C<ya;C++)if(aa[C].getId()==y)return aa[C];return null},getZoomLevel:function(){return ib},setLayer:function(y,C){for(var F=0;F<ya;F++)if(aa[F].getId()===y){aa.splice(F,1);break}if(C){T(y,C);C.trigger("refresh",Ca,eb())}Aa();return C},eachLayer:function(y){for(var C=ya;C--;)y(aa[C])},invalidate:Aa,refresh:kb,resetScale:function(){X=1},resize:function(y,C){if(Da){c.autoSize=false;if(La!==y||Ka!==C)P(y,
C)}},scale:Ya,setZoomLevel:hb,triggerAll:ha,removeLayer:function(y){a:{for(var C=ya;C--;)if(aa[C].getId()==y){y=C;break a}y=-1}if(y>=0&&y<ya){Ca.trigger("layerRemoved",aa[y]);aa.splice(y,1);Aa()}ya=aa.length},getOffset:function(){return E.init(va,ra)},setMaxOffset:function(y,C,F,R){Ra=y;Sa=C;db=typeof F!="undefined"?F:false;f=typeof R!="undefined"?R:false},getViewRect:eb,updateOffset:Ua,pan:function(y,C,F,R,pa){Ua(va+y,ra+C,F,R,pa)}};h=M().getScaling();Ca.markers=T("markers",new wb);COG.observable(Ca);
Ca.bind("invalidate",function(){Aa()});Ca.bind("resync",function(){N=Q=null});COG.configurable(Ca,["container","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(c,null,{container:function(y,C){Da=document.getElementById(C);P()},inertia:ta,scalable:ta,pannable:ta}),true);P();if(c.autoSize)vb?window.attachEvent("onresize",w):window.addEventListener("resize",w,false);return Ca},gb=function(c){c=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:$("ACTIVE",
"ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var r=null,e=false,b=false,d=c.id,m=$("ACTIVE"),l=c.validStates,t=0,q=0,n=COG.extend({addToView:function(w){w.setLayer(d,n)},shouldDraw:function(w){return(w&l)!==0},clip:null,cycle:function(){},draw:function(){},remove:function(){n.trigger("remove",n)},changed:function(){b=true;r&&r.invalidate()},hitTest:null,getId:function(){return d},setId:function(w){d=w},getParent:function(){return r},setParent:function(w){e=(r=w)?r.fastDraw&&displayState!==
m:false;n.trigger("parentChange",r)}},c);COG.observable(n);n.bind("drawComplete",function(w,j){b=false;t=j.x1;q=j.y1});n.bind("resync",function(w,j){if(j.syncXY){n.minXY&&j.syncXY(n.minXY);n.maxXY&&j.syncXY(n.maxXY)}});return n},xb=function(c){function r(q,n,w,j){b=q;d=n;m=w;l=j}c=COG.extend({xy:E.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var e=false,b=0,d=0,m=0,l=0,t=COG.extend(c,{isAnimating:function(){return e},draw:function(q,n,w,j,x){if(t.isNew&&c.tweenIn)COG.tweenValue(n.y1-
20,t.xy.y,c.tweenIn,c.animationSpeed?c.animationSpeed:250+Math.random()*500,function(P,T){t.xy.y=P|0;e=!T;x.invalidate()});t.drawMarker(q,n,t.xy.x,t.xy.y,w,j,x);t.isNew=false},drawMarker:function(q,n,w,j){q.beginPath();q.arc(w,j,4,0,Math.PI*2,false);q.fill();r(w-4,j-4,8,8)},hitTest:function(q,n){return q>=b&&q<=b+m&&n>=d&&n<=d+l},updateBounds:r});COG.observable(t);return t},wb=function(c){function r(){e();d.changed();d.trigger("markerUpdate",b)}function e(){var m=d.getParent();if(m&&m.syncXY)for(var l=
b.length;l--;)m.syncXY([b[l].xy]);b.sort(function(t,q){var n=q.xy.y-t.xy.y;if(n==0)n=q.xy.x-t.xy.x;return n})}c=COG.extend({zindex:100,style:"basic"},c);var b=[],d=COG.extend(new gb(c),{draw:function(m,l,t,q){for(var n=b.length;n--;)b[n].draw(m,l,t,d,q)},add:function(m){if(m&&typeof m.length!=="undefined")for(var l=m.length;l--;){if(m[l])b[b.length]=m[l]}else if(m)b[b.length]=m;r()},clear:function(m){if(m)for(var l=0;l<b.length;)if(m(b[l]))b.splice(l,1);else l+=1;else b=[];r()},each:function(m){if(m)for(var l=
b.length;l--;)m(b[l])},find:function(m){for(var l=[],t=b.length;t--;)if(!m||m(b[t]))l[l.length]=b[t];return l},hitTest:function(m,l){for(var t=[],q=b.length;q--;)if(b[q].hitTest(m,l))t[t.length]={type:"marker",data:b[q]};return t}});d.bind("tap",function(m,l,t,q){var n=[],w=q.x;q=q.y;for(var j=b.length;j--;)if(b[j].hitTest(w,q))n[n.length]=b[j];if(n.length>0)m.cancel=d.trigger("markerTap",l,t,n).cancel});d.bind("parentChange",e);d.bind("resync",e);return d},Ab=function(c){function r(q,n,w){q.fillStyle=
"#FFFFFF";q.strokeStyle="#222222";q.beginPath();q.arc(w.x,w.y,4,0,Math.PI*2,false);q.stroke();q.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:$("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},c);var e=E.edges(c.path),b,d=null,m=c.drawIndicator?c.drawIndicator:r,l=0,t=COG.extend(new gb(c),{cycle:function(){for(var q=0;q<e.accrued.length&&e.accrued[q]<l;)q++;d=null;if(q<c.path.length-1){var n=l-(q>0?e.accrued[q-1]:0),w=c.path[q];b=E.theta(w,
c.path[q+1],e.edges[q]);d=E.extendBy(w,b,n)}return d},draw:function(q,n){d&&m&&m(q,n,E.init(d.x,d.y),b)}});COG.tweenValue(0,e.total,c.easing,c.duration,function(q,n){l=q;n&&t.remove();t.changed()});return t},Bb=function(c){c=COG.extend({style:null,properties:{}},c);return COG.extend(c,{rect:null,draw:function(){},resync:function(){}})},yb=function(c,r){r=COG.extend({fill:false,simplify:false},r);var e=false,b=r.fill,d=r.simplify,m=$("ZOOM"),l=[],t=COG.extend(new Bb(r),{draw:function(q,n,w,j,x,P){if(e){n=
true;w=(P&m)!==0;q.beginPath();for(P=l.length;P--;){w=l[P].x;j=l[P].y;if(n){q.moveTo(w,j);n=false}else q.lineTo(w,j);w=true}if(w){b&&q.fill();q.stroke()}}},resync:function(q){t.xy=q.syncXY(c);l=E.floor(d?E.simplify(c):c)}});e=c&&c.length>=2;return t},Cb=function(c){function r(m){for(var l=b.length;l--;)b[l].resync(m);b.sort(function(t,q){var n=q.xy.y-t.xy.y;if(n===0)n=q.xy.x-t.xy.y;return n});d.changed()}function e(m,l){l.syncXY&&r(l)}c=COG.extend({zindex:80},c);var b=[],d=COG.extend(new gb(c),{add:function(m){b[b.length]=
m},each:function(m){for(var l=b.length;l--;)m(b[l])},draw:function(m,l,t){var q=l.x1,n=l.y1,w=l.width;l=l.height;for(var j=b.length;j--;){var x=b[j].style;x=x?Ga.apply(m,x):null;b[j].draw(m,q,n,w,l,t);x&&Ga.apply(m,x)}}});d.bind("parentChange",e);d.bind("resync",e);return d},Eb=function(){return{tileSize:256,init:function(c,r,e,b,d){return COG.extend({x:c,y:r,width:e,height:b},d)}}}(),Xa={ex:COG.extend,ticks:Y,getConfig:M,userMessage:function(c,r,e){Xa.trigger("userMessage",c,r,e)},XY:E,XYRect:ka,
Dimensions:B,Vector:ba,D:B,Images:W,Generator:Ja,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ga,viewState:$,View:cb,ViewLayer:gb,ImageLayer:function(c,r){function e(n,w,j){for(w=l.length;w--;){var x=l[w],P=x.x,T=x.y,ta=ka.init(x.x,x.y,x.x+x.width,x.y+x.height);if(j&&ka.intersect(n,ta))(ta=W.get(x.url,function(){q.changed()},t))&&j(ta,P,T,x.width,x.height)}}function b(n){var w=++m,j=q.getParent();d&&d.run(j,n,function(x){if(w==m){l=[].concat(x);j.invalidate()}})}
r=COG.extend({imageLoadArgs:{}},r);var d=c?Ja.init(c,r):null,m=0,l=[],t=r.imageLoadArgs,q=COG.extend(new gb(r),{changeGenerator:function(n,w){d=Ja.init(n,COG.extend({},r,w));l=null;b(q.getParent().getViewRect())},clip:function(n,w,j){e(w,j,function(x,P,T,ta,Va){n.rect(P,T,ta,Va)})},draw:function(n,w,j){e(w,j,function(x,P,T,ta,Va){q.drawImage(n,x,P,T,ta,Va,w,j)})},drawImage:function(n,w,j,x){w&&n.drawImage(w,j,x,w.width,w.height)}});q.bind("refresh",function(n,w,j){b(j)});q.bind("tap",function(n,w,
j,x){n=[];var P=x.x,T=x.y,ta,Va;if(l)for(var Aa=l.length;Aa--;){ta=l[Aa];if(Va=P>=ta.x&&P<=ta.x+ta.width&&T>=ta.y&&T<=ta.y+ta.height)n[n.length]=ta}n.length>0&&q.trigger("tapImage",n,w,j,x)});return q},ImageGenerator:function(c){c=COG.extend({relative:false,padding:2},c);c={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(c);return c},Marker:xb,ImageMarker:function(c){c=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,
rotation:0,scale:1,opacity:1},c);var r=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,e=COG.extend(new xb(c),{changeImage:function(b){e.image=W.get(b,function(d){e.image=d})},drawMarker:function(b,d,m,l){if((d=e.isAnimating()&&e.animatingImage?e.animatingImage:e.image)&&d.width>0){r||(r=E.init(-d.width>>1,-d.height>>1));var t=e.scale,q=m+~~(r.x*t),n=l+~~(r.y*t),w=~~(d.width*t),j=~~(d.height*t);e.updateBounds(q,n,w,w);if(e.rotation||e.opacity!==1){b.save();try{b.globalAlpha=e.opacity;b.translate(m,
l);b.rotate(e.rotation);b.drawImage(d,r.x*t,r.y*t,w,j)}finally{b.restore()}}else b.drawImage(d,q,n,w,j)}}});if(!e.image)e.image=W.get(c.imageUrl,function(b){e.image=b});if(!e.animatingImage)e.animatingImage=W.get(c.animatingImageUrl,function(b){e.animatingImage=b});return e},MarkerLayer:wb,PathLayer:function(c){function r(){var n=q.getParent();if(n&&n.syncXY){n.syncXY(d);m&&n.syncXY(m);q.trigger("tidy")}}c=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},c);var e=[],b=null,d=[],m=null,
l=0,t=[],q=COG.extend(new gb(c),{getAnimation:function(n,w,j,x){var P="pathAnimation"+l++;t.push(P);return new Ab({id:P,path:e,zindex:c.zindex+1,easing:n?n:COG.easing("sine.inout"),duration:w?w:5E3,drawIndicator:j,autoCenter:x?x:false})},draw:function(n){var w,j=e.length;n.save();try{Ga.apply(n,c.style);if(j>0){n.beginPath();n.moveTo(e[j-1].x,e[j-1].y);for(w=j;w--;)n.lineTo(e[w].x,e[w].y);n.stroke();if(b){n.fillStyle=c.waypointFillStyle;for(w=b.length;w--;){n.beginPath();n.arc(b[w].x,b[w].y,2,0,Math.PI*
2,false);n.stroke();n.fill()}}}}finally{n.restore()}},updateCoordinates:function(n,w){d=n;m=w;r()}});q.bind("tidy",function(){e=E.simplify(d,c.pixelGeneralization);b=E.simplify(m,c.pixelGeneralization);q.changed(true)});q.bind("resync",r);return q},AnimatedPathLayer:Ab,Shape:Bb,Arc:function(c,r){r=COG.extend({size:4},r);var e=E.init(),b=COG.extend(r,{draw:function(d){d.beginPath();d.arc(e.x,e.y,b.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([c]);e=E.floor([c])[0]}});COG.info("created arc = ",
c);return b},Poly:yb,ShapeLayer:Cb,Tiling:Eb};COG.observable(Xa);var Oa=Xa.Geo=function(){function c(f){for(var k=null,i=1;!k&&i<arguments.length;i++)k=m(f,arguments[i]);k=k?k:m(f);if(!k)throw Error("Unable to find GEO engine with "+f+" capability");return k}function r(f){f=parseFloat(f)*x;f=xa(f);var k=Aa*f;return wa((1+f)/(1-f)*ja((1-k)/(1+k),Aa))/2}function e(f){return parseFloat(f)*x}function b(f){f=ja(Math.E,-f);for(var k=A-2*oa(f),i=l(k,f),z=0;z<kb&&L(k-i)>eb;){k=i;i=l(k,f);z++}return i*P}function d(f){return f%
360*P}function m(f,k){var i=null;for(var z in ya)if(k){if(z==k&&ya[z][f]){i=ya[z];break}}else if(ya[z][f]){i=ya[z];break}return i}function l(f,k){var i=Aa*xa(f);return A-2*oa(k*ja((1-i)/(1+i),Aa/2))}function t(f,k,i,z){k=n(k);f.add(z.line(k,i));return k.length}function q(f,k,i,z){k=n(k);f.add(z.poly(k,i));return k.length}function n(f){var k=f?f.length:0,i=Array(k);for(k=k;k--;)i[k]=Oa.Position.init(f[k][1],f[k][0]);return Oa.Position.vectorize(i,va)}function w(f,k,i){return new Sa(f,k,i)}var j=[1.406245461070741,
1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],x=Math.PI/180,P=180/Math.PI,T=A,ta=-T,Va=-u,Aa=0.08181919084262157,eb=1.0E-7,kb=12,Ya=null,hb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ha=function(){function f(a){return a?i(a.lat,a.lon):null}function k(a){return!a||a.lat===0&&a.lon===0}function i(a,g){return{lat:parseFloat(a?a:0),lon:parseFloat(g?g:0)}}function z(a){if(a)if(typeof a.lat!=="undefined")return f(a);
else{if(a.split)for(var g=[" ",","],h=0;h<g.length;h++){var v=a.split(g[h]);if(v.length===2)return i(v[0],v[1])}}else return i();return null}return{calcDistance:function(a,g){if(k(a)||k(g))return 0;var h=(g.lat-a.lat)*x>>1,v=(g.lon-a.lon)*x>>1;h=xa(h)*xa(h)+ea(a.lat*x)*ea(g.lat*x)*xa(v)*xa(v);return 6371*2*sa(la(h),la(1-h))},copy:f,empty:k,equal:function(a,g){return a&&g&&a.lat==g.lat&&a.lon==g.lon},fromMercatorPixels:function(a,g){return i(b(g),d(a))},generalize:function(a,g,h){var v=a.length,I=
[],ca=null;h||(h=250);h/=1E3;COG.info("generalizing positions, must include "+g.length+" positions");for(var da=v;da--;)if(da===0)I.unshift(a[da]);else{var Ea=!ca||ha.inArray(a[da],g)?h:ha.calcDistance(ca,a[da]);if(a[da]&&Ea>=h){I.unshift(a[da]);ca=a[da]}}COG.info("generalized "+v+" positions into "+I.length+" positions");return I},inArray:function(a,g){for(var h=ha.equal,v=g.length;v--;)if(h(a,g[v]))return true;return false},inBounds:function(a,g){var h=!(ha.empty(a)||ha.empty(g));return h=(h=h&&
a.lat>=g.min.lat&&a.lat<=g.max.lat)&&a.lon>=g.min.lon&&a.lon<=g.max.lon},init:i,offset:function(a,g,h){var v=a.lat*x;a=a.lon*x;g=v+g/6371;h=Ma(xa(h/6371)/ea(v));h=a+h;g=(g+A)%Math.PI-A;h%=u;return i(g*P,h*P)},parse:z,parseArray:function(a){var g=a.length,h=Array(g);for(g=g;g--;)h[g]=z(a[g]);return h},toMercatorPixels:function(a){return T5.XY.init(e(a.lon),r(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,g){function h(){for(var da=0,Ea=g.chunkSize,Ha=v;Ha--;){I[Ha]=
T5.GeoXY.init(a[Ha]);da+=1;if(da>Ea)break}v=Ha;if(v<=0)g.callback&&g.callback(I);else animFrame(h)}var v=a.length,I=Array(v);g=COG.extend({chunkSize:500,async:true,callback:null},g);if(!g.async){for(var ca=v;ca--;)I[ca]=T5.GeoXY.init(a[ca]);return I}animFrame(h);return null}}}(),Ua=function(){function f(a,g,h){var v=T5.XY.init(0,g.lat-a.lat);if(typeof h==="undefined")h=true;v.x=h&&a.lon>g.lon?360-a.lon+g.lon:g.lon-a.lon;return v}function k(a,g){return Ua.init(ha.init(a.min.lat-g,a.min.lon-g%360),
ha.init(a.max.lat+g,a.max.lon+g%360))}function i(a){var g=f(a.min,a.max);return ha.init(a.min.lat+(g.y>>1),a.min.lon+(g.x>>1))}function z(a,g){return{min:ha.parse(a),max:ha.parse(g)}}return{calcSize:f,createBoundsFromCenter:function(a,g){var h=g/6371,v=a.lat*x,I=a.lon*x,ca=v-h,da=v+h;if(ca>ta&&da<T){v=Ma(xa(h)/ea(v));h=(I-v)%u;I=(I+v)%u}else{ca=na(ca,ta);da=V(da,T);h=Va;I=u}return Ua.init(ha.init(ca*P,h*P),ha.init(da*P,I*P))},expand:k,forPositions:function(a,g){var h=null,v=T5.ticks();g||(g="auto");
for(var I=a.length;I--;)if(h){var ca=f(h.min,a[I],false),da=f(a[I],h.max,false);if(ca.x<0)h.min.lon=a[I].lon;if(ca.y<0)h.min.lat=a[I].lat;if(da.x<0)h.max.lon=a[I].lon;if(da.y<0)h.max.lat=a[I].lat}else h=z(a[I],a[I]);if(g){if(g=="auto"){I=f(h.min,h.max);g=na(I.x,I.y)*0.3}h=k(h,g)}COG.trace("calculated bounds for "+a.length+" positions",v);return h},getCenter:i,getGeoHash:function(a){var g=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+
g+", max hash = "+a)},getZoomLevel:function(a,g){var h=i(a);h=V(Ia(L(h.lat)*0.05),j.length);var v=j[h],I=f(a.min,a.max);h=ma(wa(j[3]*g.height/I.y)/wa(2));v=ma(wa(v*g.width/I.x)/wa(2));return V(isNaN(h)?1E3:h,isNaN(v)?1E3:v)},init:z,isEmpty:function(a){return!a||ha.empty(a.min)||ha.empty(a.max)},toString:function(a){return"min: "+ha.toString(a.min)+", max: "+ha.toString(a.max)}}}(),sb=function(){var f=/^(\d+).*$/,k=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(i,z){f.lastIndex=-1;if(f.test(i))for(var a=
i.replace(f,"$1"),g=z.split(","),h=0;h<g.length;h++){k.lastIndex=-1;if(k.test(g[h])){var v=k.exec(g[h]);if(a>=parseInt(v[1],10)&&a<=parseInt(v[2],10))return true}else if(a==g[h])return true}return false},normalize:function(i){if(!i)return"";i=i.toUpperCase();if(!Ya){var z=[];for(var a in hb)z.push(a);Ya=RegExp("(\\s)("+z.join("|")+")(\\s|$)","i")}Ya.lastIndex=-1;if(z=Ya.exec(i))i=i.replace(Ya,"$1"+hb[z[2]]);return i},toString:function(i){return i.streetDetails+" "+i.location}}}(),aa=Xa.GeoXY=function(){function f(i,
z){if(i.length){for(var a,g,h,v,I=i.length;I--;){f(i[I],z);a=typeof a==="undefined"||i.x<a?i.x:a;g=typeof g==="undefined"||i.y<g?i.y:g;h=typeof h==="undefined"||i.x>h?i.x:h;v=typeof v==="undefined"||i.y>v?i.y:v}return ka.init(a,g,v,v)}else if(i.mercXY){a=i.mercXY;i.x=(a.x+Math.PI)/z|0;i.y=(Math.PI-a.y)/z|0;i.rpp=z}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return i}function k(i,z,a){i.pos=z;i.mercXY=ha.toMercatorPixels(z);(a=typeof a!=="undefined"?a:i.rpp)&&f(i,a)}return{init:function(i,
z){var a=E.init();k(a,i,z);return a},sync:f,toPos:function(i,z){z=z?z:self.rpp;return ha.fromMercatorPixels(i.x*z-Math.PI,Math.PI-i.y*z)},updatePos:k}}(),ya={},Da=function(){return{bestResults:function(f,k){k||(k=20);for(var i=f.length>0?f[0]:null,z=[],a=0;a<f.length;a++)if(i&&f[a]&&i.matchWeight-f[a].matchWeight<=k)z.push(f[a]);else break;return z}}}(),qa=function(f){f=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},f);return COG.extend(f,{toString:function(){return f.caption+
(f.matchWeight?" ("+f.matchWeight+")":"")}})},vb=function(){function f(a,g){var h=a.getDimensions();h=new db({data:g,width:h.width,height:h.height});a.setLayer("route",h)}function k(a){for(var g=i.Unknown,h=z,v=0;v<h.length;v++){h[v].regex.lastIndex=-1;var I=h[v].regex.exec(a);if(I){g=h[v].customCheck?h[v].customCheck(a,I):h[v].turnType;break}}return g}var i={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",
TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},z=function(){var a=[];a.push({regex:/continue/i,turnType:i.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(g,h){return/bear/i.test(h[1])?i.TurnLeftSlight:i.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(g,
h){return/bear/i.test(h[1])?i.TurnRightSlight:i.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:i.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:i.Ramp});a.push({regex:/take.*?exit/i,turnType:i.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(g,h){return/right/i.test(h[1])?i.UTurnRight:i.UTurnLeft}});a.push({regex:/proceed/i,turnType:i.Start});a.push({regex:/arrive/i,turnType:i.Arrive});a.push({regex:/fell\sthrough/i,turnType:i.Merge});return a}();return{calculate:function(a){a=
COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var g=c("route");g&&g.route(a,function(h){if(a.generalize)h.geometry=ha.generalize(h.geometry,h.getInstructionPositions());if(a.map){f(a.map,h);a.autoFit&&a.map.gotoBounds(h.boundingBox)}a.success&&a.success(h)})},createMapOverlay:f,parseTurnType:k,TurnType:i,Instruction:function(a){var g=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),
h=a.description;h=h.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");g.description=h;if(!a.turnType)a.turnType=k(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Ua.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var g=[],h=0;h<a.instructions.length;h++)a.instructions[h].position&&g.push(a.instructions[h].position);return g}},a)}}}(),tb="featurecollection",jb="feature",va={async:false},
ra={processor:null,group:"shapes",layerClass:Cb},Ra={point:COG.extend({},ra,{processor:function(f,k,i,z){k=n([k.coordinates],va);if(k.length>0)if(i=z.marker(k[0],i)){f.add(i);return k.length}},group:"markers",layerClass:wb}),linestring:COG.extend({},ra,{processor:function(f,k,i,z){k=n(k&&k.coordinates?k.coordinates:[]);return t(f,k,i,z)}}),multilinestring:COG.extend({},ra,{processor:function(f,k,i,z){k=k&&k.coordinates?k.coordinates:[];for(var a=0,g=k.length;g--;)a+=t(f,k[g],i,z);return a}}),polygon:COG.extend({},
ra,{processor:function(f,k,i,z){k=k&&k.coordinates?k.coordinates:[];if(k.length>0)return q(f,k[0],i,z);return 0}}),multipolygon:COG.extend({},ra,{processor:function(f,k,i,z){k=k&&k.coordinates?k.coordinates:[];for(var a=0,g=0;g<k.length;g++)a+=q(f,k[g][0],i,z);return a}})},Sa=function(f,k,i,z){function a(U,Z){var ia=U.processor,X=ca+U.group,$a=COG.extend({},U,i,{properties:Z.properties});if(ia){var Qa=N[X];if(!Qa){Qa=new U.layerClass({id:X});N[X]=Qa}globalLayers=N;return ia(Qa,Z.data,$a,z)}return 0}
function g(U,Z){var ia=U&&U.type?U.type.toLowerCase():null;return ia&&ia===jb?g(U.geometry,U.properties):{type:ia,isCollection:ia?ia===tb:false,definition:Ra[ia],data:U,properties:Z?Z:U.properties}}function h(){var U=0,Z=da;if(!Ha){for(;Z<Ea;Z++){var ia=g(I?I(f[Z]):f[Z]),X=null;if(ia.isCollection){Q+=1;Ha=w(ia.data.features,function($a){Ha=null;for(var Qa in $a)N[Qa]=$a[Qa]},{layerPrefix:ca+Q+"-"});X+=1}else if(ia.definition)X=a(ia.definition,ia);U+=X?X:1;if(U>=v)break}da=Z+1;if(Ha||da<Ea)animFrame(h);
else k&&k(N)}}i=COG.extend({vectorsPerCycle:Oa.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},i);z=COG.extend({marker:function(U){return new xb({xy:U})},line:function(U,Z){return new yb(U,Z)},poly:function(U,Z){return new yb(U,COG.extend({fill:true},Z))}},z);var v=i.vectorsPerCycle,I=i.rowPreParse,ca=i.layerPrefix,da=0,Ea=0,Ha=null,Q=0,N={};if(f){if(typeof f.length==="undefined")f=[f];Ea=f.length;animFrame(h)}};Xa.GeoJSON={parse:w};Xa.Map=function(f){function k(N){try{var U=
Oa.Position.init(N.coords.latitude,N.coords.longitude),Z=N.coords.accuracy/1E3;Q.trigger("locationUpdate",N,Z);if(da){if(!I){I=new Oa.UI.LocationOverlay({pos:U,accuracy:Z});I.update(Q.getTileLayer());Q.setLayer("location",I)}var ia=Oa.BoundingBox.createBoundsFromCenter(U,Math.max(Z,1));Q.gotoBounds(ia)}else{I.pos=U;I.accuracy=Z;I.update(Q.getTileLayer());a(U,null,COG.easing("sine.out"))}da=false}catch(X){COG.exception(X)}}function i(N){COG.info("caught location tracking error:",N)}function z(N,U,
Z){Q.setZoomLevel(U);a(N,Z)}function a(N,U,Z,ia){N=aa.init(N,Oa.radsPerPixel(Q.getZoomLevel()));var X=Q.getDimensions();Q.updateOffset(N.x-(X.width>>1),N.y-(X.height>>1),Z,ia,function(){Q.refresh();Q.trigger("boundsChange",Q.getBoundingBox());U&&U(Q)})}f=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18},f);var g={NONE:0,SINGLE:1,WATCH:2},h=E.init(),v=g.NONE,I=null,ca=0,da=true,Ea=0,Ha=f.tapExtent;f.adjustScaleFactor=function(N){return Math.pow(2,(N<
1?Math.floor:Math.ceil)(Math.log(N)))};var Q=COG.extend(new cb(f),{getBoundingBox:function(){var N=Q.getViewRect();return Oa.BoundingBox.init(aa.toPos(E.init(N.x1,N.y2),Ea),aa.toPos(E.init(N.x2,N.y1),Ea))},getCenterPosition:function(){var N=Q.getViewRect();if(N){N=E.init(N.x1+(N.width>>1),N.y1+(N.height>>1));return aa.toPos(N,Ea)}return null},gotoBounds:function(N,U){var Z=Oa.BoundingBox.getZoomLevel(N,Q.getDimensions());z(Oa.BoundingBox.getCenter(N),Z,U)},gotoPosition:z,panToPosition:a,syncXY:function(N){return aa.sync(N,
Ea)},locate:function(){Q.trackStart(g.SINGLE);setTimeout(Q.trackCancel,1E4)},trackStart:function(N){if(navigator.geolocation&&!ca){v=N?N:g.WATCH;da=true;ca=navigator.geolocation.watchPosition(k,i,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){ca&&navigator.geolocation&&navigator.geolocation.clearWatch(ca);Q.removeLayer("location");I=null;v=g.NONE;ca=0},animateRoute:function(N,U,Z,ia){var X=Q.getLayer("route");if(X)(N=X.getAnimation(N,U,Z,ia))&&N.addToView(Q)}});Q.bind("pan",
function(){v===g.SINGLE&&Q.trackCancel()});Q.bind("tap",function(N,U,Z,ia){var X=Oa.radsPerPixel(Q.getZoomLevel());N=aa.toPos(ia,X);var $a=aa.toPos(E.offset(ia,-Ha,Ha),X);ia=aa.toPos(E.offset(ia,Ha,-Ha),X);Q.trigger("geotap",U,Z,N,Ua.init($a,ia))});Q.bind("refresh",function(){if(E.absSize(E.diff(h,Q.getOffset()))>f.boundsChangeThreshold){h=E.copy(Q.getOffset());Q.trigger("boundsChange",Q.getBoundingBox())}});Q.bind("zoomLevelChange",function(N,U){var Z;Ea=Oa.radsPerPixel(U);Z=u/Ea|0;Q.setMaxOffset(Z,
Z,true,false);W.cancelLoad();Q.resetScale();Q.triggerAll("resync",Q);Q.refresh()});return Q};Xa.GeoShape=function(f,k){k=COG.extend({autoParse:true},k);for(var i=Array(f.length),z=k.autoParse,a=T5.Geo.Position.parse,g=f.length;g--;)i[g]=T5.GeoXY.init(z?a(f[g]):f[g]);return new T5.Poly(i,k)};var db=Xa.RouteOverlay=function(f){f=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},f);var k=[],i=[],z=new T5.PathLayer(f);
(function(){if(f.data&&f.data.instructions){for(var a=f.data.instructions,g=Array(a.length),h=a.length;h--;)g[h]=a[h].position;ha.vectorize(g,{callback:function(v){i=v}})}f.data&&f.data.geometry&&ha.vectorize(f.data.geometry,{callback:function(v){k=v;z.updateCoordinates(k,i,true)}})})();return z};Xa.LocationOverlay=function(f){f=COG.extend({pos:null,accuracy:null,zindex:90},f);var k=new Image,i=T5.XY.init(),z=T5.XY.init(),a=null;k.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
k.onload=function(){i=T5.XY.init(k.width>>1,k.height>>1)};var g=COG.extend(new T5.ViewLayer(f),{pos:f.pos,accuracy:f.accuracy,drawAccuracyIndicator:false,draw:function(h,v){var I=z.x-v.x,ca=z.y-v.y;if(a){h.fillStyle="rgba(30, 30, 30, 0.2)";h.beginPath();h.arc(I,ca,a,0,Math.PI*2,false);h.fill()}k.complete&&k.width>0&&h.drawImage(k,I-i.x,ca-i.y,k.width,k.height);g.changed()},update:function(h){if(h){a=h.getPixelDistance(g.accuracy)>>1;z=h.getGridXYForPosition(g.pos);g.changed()}}});g.bind("gridUpdate",
function(h,v){g.update(v)});return g};return{distanceToString:function(f){if(f>1E3)return~~(f/10)/100+" km";return f?f+" m":""},dist2rad:function(f){return f/6371},getEngine:c,lat2pix:r,lon2pix:e,pix2lat:b,pix2lon:d,radsPerPixel:function(f){return u/(256<<f)},Position:ha,BoundingBox:Ua,Radius:function(f,k){return{distance:parseInt(f,10),uom:k}},Address:function(f){return f=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},f)},A:sb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(f){if(!f.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var k=COG.extend({remove:function(){delete ya[k.id]}},f);return ya[k.id]=k},Search:Da,GeoSearchResult:qa,LocationSearch:function(f){function k(h,v){navigator.geolocation.clearWatch(z);z=0;if(a){clearTimeout(a);a=0}v&&v([h],f)}function i(h){COG.info("caught location tracking error:",h)}f=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},f);var z=0,a=0,g=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(h,v){if(navigator.geolocation&&!z){z=navigator.geolocation.watchPosition(function(I){var ca=ha.init(I.coords.latitude,I.coords.longitude);I=new qa({id:1,caption:"Current Location",pos:ca,accuracy:I.coords.accuracy/1E3,matchWeight:100});if(!g||I.accuracy<g.accuracy)g=I;if(!f.requiredAccuracy||g.accuracy<f.requiredAccuracy)k(g,v)},i,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(f.searchTimeout)a=
setTimeout(function(){g&&k(g,v)},f.searchTimeout)}}},f))},Routing:vb}}();return Xa}();
