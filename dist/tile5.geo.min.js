COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var ca=arguments[0]||{},ra,L=1,J=arguments.length;L<J;L++)if((ra=arguments[L])!==null)for(var n in ra){var r=ra[n];if(ca!==r)if(r!==undefined)ca[n]=r}return ca};
(function(){var ca=Object.prototype.hasOwnProperty,ra=0,L={};L.toID=function(J){return J.replace(/\s/g,"-")};L.objId=function(J){return(J?J:"obj")+ra++};L.isFunction=function(J){return toString.call(J)==="[object Function]"};L.isArray=function(J){return toString.call(J)==="[object Array]"};L.isPlainObject=function(J){if(!J||toString.call(J)!=="[object Object]"||J.nodeType||J.setInterval)return false;if(J.constructor&&!ca.call(J,"constructor")&&!ca.call(J.constructor.prototype,"isPrototypeOf"))return false;
var n;for(n in J);return n===undefined||ca.call(J,n)};L.isEmptyObject=function(J){for(var n in J)return false;return true};L.isXmlDocument=function(J){return toString.call(J)==="[object Document]"};L.contains=function(J,n){var r=J,x=arguments,M=1;if(n&&module.isArray(n)){x=n;M=0}for(M=M;M<x;M++)r=r&&typeof foo[x[M]]!=="undefined";return r};L.formatStr=function(J){if(arguments.length<=1)return J;for(var n=arguments.length-2,r=0;r<=n;r++)J=J.replace(RegExp("\\{"+r+"\\}","gi"),arguments[r+1]);return J};
L.wordExists=function(J,n){var r="";if(n.toString)n=n.toString();for(var x=0;x<n.length;x++)r+=!/\w/.test(n[x])?"\\"+n[x]:n[x];return RegExp("(^|\\s|\\,)"+r+"(\\,|\\s|$)","i").test(J)};COG.extend(COG,L)})();
(function(){function ca(r){return typeof console!=="undefined"?function(){console[r](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ra=window.console&&window.console.markTimeline,L=ca("error"),J=ca("info"),n=function(){return ra?function(r,x){console.markTimeline(r+(x?": "+((new Date).getTime()-x)+"ms":""))}:function(){}}();COG.extend(COG,{trace:n,debug:ca("debug"),info:J,warn:ca("warn"),error:L,exception:function(r){if(L)for(var x in r)J("ERROR DETAIL: "+
x+": "+r[x])}})})();
COG.Loopage=function(){function ca(Z){return COG.extend({id:r++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},Z)}function ra(Z){M.push(Z);L()}function L(){sa&&clearTimeout(sa);sa=setTimeout(J,0);za=true}function J(){for(var Z,G=(new Date).getTime(),H=x.length;M.length>0;){var I=M.shift();for(Z=H;Z--;)if(x[Z].id===I){x.splice(Z,1);break}za=true;H=x.length}if(za){ha=n;for(Z=H;Z--;)ha=x[Z].frequency<ha?x[Z].frequency:ha}for(Z=H;Z--;){I=G-x[Z].lastTick;if(x[Z].lastTick===0||I>=x[Z].frequency){x[Z].execute(G,
x[Z]);x[Z].lastTick=G;x[Z].single&&x[Z].trigger("complete")}}sa=H?setTimeout(J,ha):0}var n=6E4,r=0,x=[],M=[],sa=0,ha=n,za=true;return{join:function(Z){var G=new ca(Z);if(G.after>0)G.lastTick=(new Date).getTime()+G.after;COG.observable(G);G.bind("complete",function(){ra(G.id)});x.unshift(G);L();return G},leave:ra}}();
(function(){function ca(L,J){var n=L.obsHandlers;n[J]||(n[J]=[]);return n[J]}var ra=0;COG.observable=function(L){if(!L)return null;if(!L.obsHandlers)L.obsHandlers={};if(!(L.bind||L.trigger||L.unbind)){L.bind=function(J,n){var r="callback"+ra++;ca(L,J).unshift({fn:n,id:r});return r};L.trigger=function(J){var n=ca(L,J),r={cancel:false,name:J,tickCount:(new Date).getTime()},x;if(!n)return null;x=Array.prototype.slice.call(arguments,1);L.eventInterceptor&&L.eventInterceptor(J,r,x);x.unshift(r);for(var M=
n.length;M--&&!r.cancel;)n[M].fn.apply(self,x);return r};L.unbind=function(J,n){if(typeof J==="undefined")L.obsHandlers={};else for(var r=ca(L,J),x=0;r&&x<r.length;x++)if(r[x].id===n){r.splice(x,1);break}return L}}return L}})();
(function(){function ca(n,r){n[r]||(n[r]=function(x){return n.configure(r,x)})}function ra(n){n.gtConfId="configurable"+J++;n.gtConfig={};n.gtConfigFns=[];return n.gtConfig}var L={},J=0;COG.paramTweaker=function(n,r,x){return function(M,sa){if(typeof sa!=="undefined"){if(M in n)n[M]=sa;x&&M in x&&x[M](M,sa)}else return r&&M in r?r[M](M):n[M]}};COG.configurable=function(n,r,x,M){if(n){n.gtConfId||ra(n);var sa=n.gtConfId,ha=n.gtConfig,za=n.gtConfigFns;L[sa]=n;za.push(x);for(x=r.length;x--;){ha[r[x]]=
true;M&&ca(n,r[x])}if(!n.configure)n.configure=function(Z,G){if(ha[Z]){for(var H=za.length;H--;){var I=za[H](Z,G);if(typeof I!=="undefined")return I}return L[sa]}return null}}}})();
(function(){function ca(n){var r=document.createElement("script"),x=false;r.src=n;r.async=true;r.onload=r.onreadystatechange=function(){if(!x&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){x=true;r.onload=r.onreadystatechange=null;r&&r.parentNode&&r.parentNode.removeChild(r)}};L||(L=document.getElementsByTagName("head")[0]);L.appendChild(r)}var ra=0,L,J=this;COG.jsonp=function(n,r,x){n+=n.indexOf("?")>=0?"&":"?";var M="json"+ ++ra;J[M]=function(sa){r(sa);J[M]=null;
try{delete J[M]}catch(ha){}};ca(n+(x?x:"callback")+"="+M);return M}})();
(function(){function ca(d){if(Z)return ha.length;Z=true;try{for(var t=0;t<ha.length;)if(ha[t].isComplete()){ha[t].triggerComplete(false);ha.splice(t,1)}else{ha[t].update(d);t++}}finally{Z=false}ha.length===0&&za.trigger("complete");return ha.length}function ra(){if(!za){za=COG.Loopage.join({execute:ca,frequency:20});za.bind("complete",function(){za=null})}}var L=1.70158,J=Math.PI/2,n=Math.abs,r=Math.pow,x=Math.sin,M=Math.asin,sa=Math.cos,ha=[],za=null,Z=false,G={linear:function(d,t,w,F){return w*
d/F+t},backin:function(d,t,w,F){return w*(d/=F)*d*((L+1)*d-L)+t},backout:function(d,t,w,F){return w*((d=d/F-1)*d*((L+1)*d+L)+1)+t},backinout:function(d,t,w,F){return(d/=F/2)<1?w/2*d*d*(((L*=1.525)+1)*d-L)+t:w/2*((d-=2)*d*(((L*=1.525)+1)*d+L)+2)+t},bouncein:function(d,t,w,F){return w-G.bounceout(F-d,0,w,F)+t},bounceout:function(d,t,w,F){return(d/=F)<1/2.75?w*7.5625*d*d+t:d<2/2.75?w*(7.5625*(d-=1.5/2.75)*d+0.75)+t:d<2.5/2.75?w*(7.5625*(d-=2.25/2.75)*d+0.9375)+t:w*(7.5625*(d-=2.625/2.75)*d+0.984375)+
t},bounceinout:function(d,t,w,F){return d<F/2?G.bouncein(d*2,0,w,F)/2+t:G.bounceout(d*2-F,0,w,F)/2+w/2+t},cubicin:function(d,t,w,F){return w*(d/=F)*d*d+t},cubicout:function(d,t,w,F){return w*((d=d/F-1)*d*d+1)+t},cubicinout:function(d,t,w,F){if((d/=F/2)<1)return w/2*d*d*d+t;return w/2*((d-=2)*d*d+2)+t},elasticin:function(d,t,w,F,U,T){if(d==0)return t;if((d/=F)==1)return t+w;T||(T=F*0.3);if(!U||U<n(w)){U=w;w=T/4}else w=T/TWO_PI*M(w/U);return-(U*r(2,10*(d-=1))*x((d*F-w)*TWO_PI/T))+t},elasticout:function(d,
t,w,F,U,T){var ma;if(d==0)return t;if((d/=F)==1)return t+w;T||(T=F*0.3);if(!U||U<n(w)){U=w;ma=T/4}else ma=T/TWO_PI*M(w/U);return U*r(2,-10*d)*x((d*F-ma)*TWO_PI/T)+w+t},elasticinout:function(d,t,w,F,U,T){var ma;if(d==0)return t;if((d/=F/2)==2)return t+w;T||(T=F*0.3*1.5);if(!U||U<n(w)){U=w;ma=T/4}else ma=T/TWO_PI*M(w/U);if(d<1)return-0.5*U*r(2,10*(d-=1))*x((d*F-ma)*TWO_PI/T)+t;return U*r(2,-10*(d-=1))*x((d*F-ma)*TWO_PI/T)*0.5+w+t},quadin:function(d,t,w,F){return w*(d/=F)*d+t},quadout:function(d,t,w,
F){return-w*(d/=F)*(d-2)+t},quadinout:function(d,t,w,F){if((d/=F/2)<1)return w/2*d*d+t;return-w/2*(--d*(d-2)-1)+t},sinein:function(d,t,w,F){return-w*sa(d/F*J)+w+t},sineout:function(d,t,w,F){return w*x(d/F*J)+t},sineinout:function(d,t,w,F){return-w/2*(sa(Math.PI*d/F)-1)+t}},H=COG.Tween=function(d){d=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:I("sine.out"),complete:null},d);var t=(new Date).getTime(),w=[],F=false,U=0,T=0,ma={isComplete:function(){return F},
triggerComplete:function(pa){d.complete&&d.complete(pa)},update:function(pa){var Ca=d.tweenFn(pa-t,U,T,d.duration);if(d.target)d.target[d.property]=Ca;for(var wa=w.length;wa--;)w[wa](Ca,void 0);if(F=t+d.duration<=pa){if(d.target)d.target[d.property]=d.tweenFn(d.duration,U,T,d.duration);for(pa=w.length;pa--;)w[pa](Ca,true)}},requestUpdates:function(pa){w.push(pa)}};U=d.target&&d.property&&d.target[d.property]?d.target[d.property]:d.startValue;if(typeof d.endValue!=="undefined")T=d.endValue-U;if(T==
0)F=true;ra();return ma};COG.tweenValue=function(d,t,w,F,U){d=new H({startValue:d,endValue:t,tweenFn:w,complete:F,duration:U});ha.push(d);return d};COG.tween=function(d,t,w,F,U,T){d=new H({target:d,property:t,endValue:w,tweenFn:F,duration:T,complete:U});ha.push(d);return d};COG.endTweens=function(d){if(!Z){Z=true;try{for(var t=0;t<ha.length;)if(!d||d(ha[t])){ha[t].triggerComplete(true);ha.splice(t,1)}else t++}finally{Z=false}}};COG.getTweens=function(){return[].concat(ha)};var I=COG.easing=function(d){return G[d.replace(/[\-\_\s\.]/g,
"").toLowerCase()]};COG.registerEasingType=function(d,t){G[d.replace(/[\-\_\s\.]/g,"").toLowerCase()]=t}})();
(function(){var ca=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ra=/^(\d+H)?(\d+M)?(\d+S)?$/,L={8601:function(n){n=n.split("T");var r=null;r=null;var x=0,M=0;ca.lastIndex=-1;r=ca.exec(n[0]);x+=r[3]?parseInt(r[3].slice(0,-1),10):0;ra.lastIndex=-1;r=ra.exec(n[1]);M+=r[1]?parseInt(r[1].slice(0,-1),10)*3600:0;M+=r[2]?parseInt(r[2].slice(0,-1),10)*60:0;M+=r[3]?parseInt(r[3].slice(0,-1),10):0;return new J(x,M)}},J=COG.Duration=function(n,r){return{days:n?n:0,seconds:r?r:0}};COG.addDuration=function(){for(var n=new J,r=arguments.length;r--;){n.days+=
arguments[r].days;n.seconds+=arguments[r].seconds}if(n.seconds>=86400){n.days+=~~(n.seconds/86400);n.seconds%=86400}return n};COG.formatDuration=function(n){var r,x,M="";if(n.days)M=n.days+" days ";if(n.seconds){n=n.seconds;if(n>=3600){r=~~(n/3600);n-=r*3600}if(n>=60){x=Math.round(n/60);n-=x*60}if(r)M=M+r+(r>1?" hrs ":" hr ")+(x?(x>10?x:"0"+x)+" min ":"");else if(x)M=M+x+" min";else if(n>0)M=M+(n>10?n:"0"+n)+" sec"}return M};COG.parseDuration=function(n,r){var x=r?L[r]:null;if(x)return x(n);COG.Log.warn("Could not find duration parser for specified format: "+
r);return new J}})();
INTERACT=function(){function ca(G){return function(H,I,d){(d?d:G?document.body:document).addEventListener(H,I,false)}}function ra(G){return function(H,I,d){(d?d:G?document.body:document).removeEventListener(H,I,false)}}function L(G,H,I){(I?I:document).attachEvent("on"+G,H)}function J(G,H,I){(I?I:document).detachEvent("on"+G,H)}function n(G,H){return{x:G?G:0,y:H?H:0,count:1}}function r(G,H){za.push(COG.extend({handler:null,checks:{},type:G},H))}function x(G){var H=0,I=0;if(G.offsetParent){do{H+=G.offsetLeft;
I+=G.offsetTop;G=G.offsetParent}while(G)}return{x:H,y:I}}function M(G,H){for(var I=G.target?G.target:G.srcElement;I&&I.nodeName&&I.nodeName.toUpperCase()!="CANVAS";)I=I.parentNode;return I&&I===H}function sa(G,H){return{x:G.x-(H?H.x:0),y:G.y-(H?H.y:0)}}function ha(G){if(G.preventDefault){G.preventDefault();G.stopPropagation()}else G.cancelBubble&&G.cancelBubble()}var za=[],Z=function(G,H,I){function d(T,ma,pa,Ca){t.trigger("pan",Ca.x,Ca.y)}I=COG.extend({binder:null,unbinder:null,observable:null},
I);for(var t=I.observable,w=[],F={bind:function(){return t.bind.apply(null,arguments)},pannable:function(T){COG.extend({inertia:true},T);t.bind("pointerMove",d);return F},unbind:function(){t.unbind();for(var T=0;T<w.length;T++)w[T].unbind();return F}},U=0;U<H.length;U++)w.push(H[U](G,t,I));return F};r("pointer",{handler:function(G,H,I){function d(D){if(M(D,G))if(Ca=U(D)){G.style.cursor="move";ha(D);Da=D.pageX?D.pageX:D.screenX;N=D.pageY?D.pageY:D.screenY;wa=n(Da,N);Ua=x(G);H.trigger("pointerDown",
wa,sa(wa,Ua))}}function t(D){Ka=D.pageX?D.pageX:D.screenX;Aa=D.pageY?D.pageY:D.screenY;Ca&&M(D,G)&&T("pointerMove")}function w(D){if(Ca&&U(D)){Ca=false;if(M(D,G)){G.style.cursor="default";T("pointerUp")}}}function F(D){if(M(D,G)){var na;D=D||window.event;if(D.detail)na=D.axis===2?-D.detail*ma:0;else{na=D.wheelDeltaY?D.wheelDeltaY:D.wheelDelta;if(window.opera)na=-na}if(na!==0){var Va=n(Ka,Aa);H.trigger("zoom",Va,sa(Va,x(G)),na/pa,"wheel");ha(D);D.returnValue=false}}}function U(D){D=D||window.event;
return(D.which||D.button)==1}function T(D){var na=n(Ka,Aa);H.trigger(D,na,sa(na,Ua),n(Ka-Da,Aa-N));Da=Ka;N=Aa}I=COG.extend({inertia:false},I);var ma=120,pa=ma*8,Ca=false,wa,Ua,Ka,Aa,Da,N;I.binder("mousedown",d,false);I.binder("mousemove",t,false);I.binder("mouseup",w,false);I.binder("click",function(D){if(M(D,G)){D=n(D.pageX?D.pageX:D.screenX,D.pageY?D.pageY:D.screenY);H.trigger("tap",D,sa(D,x(G)))}},false);I.binder("dblclick",function(D){COG.info("captured double click");if(M(D,G)){D=n(D.pageX?D.pageX:
D.screenX,D.pageY?D.pageY:D.screenY);COG.info("captured double click + target matched");H.trigger("doubleTap",D,sa(D,x(G)))}},false);I.binder("mousewheel",F,document);I.binder("DOMMouseScroll",F,document);return{unbind:function(){I.unbinder("mousedown",d,false);I.unbinder("mousemove",t,false);I.unbinder("mouseup",w,false);I.unbinder("mousewheel",F,document);I.unbinder("DOMMouseScroll",F,document)}}},checks:{touch:false}});r("pointer",{handler:function(G,H,I){function d(V){if(V.count<2)return 0;var da=
V.x-V.next.x;V=V.y-V.next.y;return~~Math.sqrt(da*da+V*V)}function t(V,da,ea){da=da?da:0;ea=ea?ea:0;for(var Pa={x:V.x-da,y:V.y-ea,id:V.id,count:V.count},Ea=Pa;V.next;){V=V.next;Ea=Ea.next={x:V.x-da,y:V.y-ea,id:V.id}}return Pa}function w(V,da){var ea=V[da?da:"touches"],Pa,Ea;if(ea.length===0)return null;Ea=Pa={x:ea[0].pageX,y:ea[0].pageY,id:ea[0].identifier,count:ea.length};for(var Wa=1,bb=ea.length;Wa<bb;Wa++)Ea=Ea.next={x:ea[Wa].pageX,y:ea[Wa].pageY,id:ea[Wa].identifier};return Pa}function F(V){if(M(V,
G)){Aa=x(G);var da=w(V,"changedTouches"),ea=t(da,Aa.x,Aa.y);if(!N){Da=wa;H.trigger("pointerDown",da,ea)}La&&H.trigger("pointerDownMulti",da,ea);N=w(V);if(N.count>1)na=d(N);db=1;Va=t(N)}}function U(V){if(M(V,G)){V.preventDefault();D=w(V);if(Da==wa)Da=Math.abs(N.x-D.x)>pa||Math.abs(N.y-D.y)>pa?Ca:wa;if(Da!=wa){Da=D.count>1?Ka:Ua;if(Da==Ka)if(N.count===1){N=t(D);na=d(N)}else{V=d(D);if(Math.abs(na-V)<ma)Da=Ua;else{var da;da=D.x;var ea=D.next.x,Pa=D.y,Ea=D.next.y,Wa=Pa<Ea?Pa:Ea;da={x:(da<ea?da:ea)+(Math.abs(da-
ea)>>1),y:Wa+(Math.abs(Pa-Ea)>>1)};V=V/na;ea=V-db;H.trigger("zoom",da,sa(da,Aa),ea,"pinch");db=V}}Da==Ua&&H.trigger("pointerMove",D,t(D,Aa.x,Aa.y),n(D.x-Va.x,D.y-Va.y));La&&H.trigger("pointerMoveMulti",D,t(D,Aa.x,Aa.y))}Va=t(D)}}function T(V){if(M(V,G)){var da=w(V,"changedTouches"),ea=t(da,Aa.x,Aa.y);D=w(V);if(!D){Da===wa&&H.trigger("pointerTap",da,ea);H.trigger("pointerUp",da,ea);N=null}La&&H.trigger("pointerUpMulti",da,ea)}}I=COG.extend({detailed:false,inertia:false},I);var ma=20,pa=7,Ca=0,wa=1,
Ua=2,Ka=3,Aa,Da,N,D,na,Va,La=I.detailed,db=1;I.binder("touchstart",F,false);I.binder("touchmove",U,false);I.binder("touchend",T,false);COG.info("initialized touch handler");return{unbind:function(){I.unbinder("touchstart",F,false);I.unbinder("touchmove",U,false);I.unbinder("touchend",T,false)}}},checks:{touch:true}});return{register:r,watch:function(G,H,I){H=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},H);capabilities=COG.extend({touch:"ontouchstart"in
window},I);if(!H.observable){COG.info("creating observable");H.observable=COG.observable({});globalOpts=H}H.binder=H.isIE?L:ca(H.bindToBody);H.unbinder=H.isIE?J:ra(H.bindToBody);I=H.types;for(var d=capabilities,t=[],w=za.length;w--;){var F=za[w],U=!I||I.indexOf(F.type)>=0,T=true;for(var ma in F.checks){var pa=F.checks[ma];COG.info("checking "+ma+" capability. require: "+pa+", capability = "+d[ma]);T=T&&pa===d[ma]}if(U&&T)t[t.length]=F.handler}return new Z(G,t,H)}}}();
T5=function(){function ca(){return(new Date).getTime()}function ra(){for(;ea.length>0;){var c=ea.shift();document.location=c}da=0}function L(c){for(var o=true,g=Pa.length;g--;)o=o&&c!=Pa[g];return o}function J(c,o){var g=[];for(var b in o)b&&g.push(b+"="+escape(o[b]));return"tile5://"+c+"/"+(g.length>0?"?"+g.join("&"):"")}function n(c,o){L(c)&&COG.info("would push url: "+J(c,o))}function r(c,o){if(L(c)){ea.push(J(c,o));da||(da=setTimeout(ra,100))}}function x(c){return function(o,g,b){(b?b:c?document.body:
document).addEventListener(o,g,false)}}function M(c){return function(o,g,b){(b?b:c?document.body:document).removeEventListener(o,g,false)}}function sa(c,o,g){(g?g:document).attachEvent("on"+c,o)}function ha(c,o,g){(g?g:document).detachEvent("on"+c,o)}function za(){La={base:{name:"Unknown",bindEvent:x(),unbindEvent:M(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:n,targetFps:null},ie:{name:"MSIE",
regex:/msie/i,bindEvent:sa,unbindEvent:ha,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:r,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:r},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:r},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:x(true),unbindEvent:M(true),supportsTouch:true,getScaling:function(){return 1/
window.devicePixelRatio},bridgeNotify:r},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:r}};db=[La.froyo,La.android,La.ipod,La.iphone,La.ipad,La.ie]}function Z(){La||za();if(!V){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<db.length;c++){var o=db[c];if(o.regex&&o.regex.test(navigator.userAgent)){V=COG.extend({},La.base,o);COG.info("PLATFORM DETECTED AS: "+V.name);break}}if(!V){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
V=La.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return V}function G(c,o){function g(l,p){if(l&&b!==l){var u=l>=e&&l<=k&&c.triggerAll("zoomLevelChange",l,p);if(u)b=l;return u}}o=COG.extend({initial:1,minZoom:1,maxZoom:16},o);var b=o.initial,e=o.minZoom,k=o.maxZoom;COG.extend(c,{getZoomLevel:function(){return b},setZoomLevel:g});c.bind("scale",function(l,p,u){var q=Math.log(p)/Math.LN2;COG.endTweens(function(s){return s.cancelOnInteract});l.cancel=!g(b+q,u);l.cancel||c.updateOffset(u.x*
p,u.y*p)})}function H(){for(var c=0,o=arguments.length;o--;){var g=Fb[arguments[o].toUpperCase()];if(g)c|=g}return c}var I=Math.PI*2,d=Math.PI/2,t=Math.abs,w=Math.ceil,F=Math.min,U=Math.max,T=Math.pow,ma=Math.sqrt,pa=Math.log,Ca=Math.round,wa=Math.sin,Ua=Math.asin,Ka=Math.cos,Aa=Math.atan,Da=Math.atan2,N=function(){function c(b,e){return g(b.x-e.x,b.y-e.y)}function o(b,e){if(!e)e=b.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var k={edges:Array(e-
1),accrued:Array(e-1),total:0},l=0;l<e-1;l++){var p=c(b[l],b[l+1]);k.edges[l]=ma(p.x*p.x+p.y*p.y);k.accrued[l]=k.total+k.edges[l];k.total+=k.edges[l]}return k}function g(b,e){return{x:b?b:0,y:e?e:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,e=0,k=arguments.length;k--;){b+=arguments[k].x;e+=arguments[k].y}return g(b,e)},absSize:function(b){return U(t(b.x),t(b.y))},copy:function(b){return b?g(b.x,b.y):null},diff:c,distance:function(b,e){return o(b,e).total},
edges:o,equals:function(b,e){return b.x===e.x&&b.y===e.y},extendBy:function(b,e,k){var l=Ka(e)*k;e=wa(e)*k;return g(b.x-l,b.y-e)},floor:function(b){for(var e=Array(b.length),k=b.length;k--;)e[k]=g(~~b[k].x,~~b[k].y);return e},getRect:function(b){for(var e,k,l,p,u=b.length;u--;){var q=b[u];e=typeof e==="undefined"||q.x<e?q.x:e;k=typeof k==="undefined"||q.y<k?q.y:k;l=typeof l==="undefined"||q.x>l?q.x:l;p=typeof p==="undefined"||q.y>p?q.y:p}return na.init(e,k,l,p)},init:g,invert:function(b){return g(-b.x,
-b.y)},min:function(b,e){return g(b.x<e.x?b.x:e.x,b.y<e.y?b.y:e.y)},max:function(b,e){return g(b.x>e.x?b.x:e.x,b.y>e.y?b.y:e.y)},offset:function(b,e,k){return g(b.x+e,b.y+(k?k:e))},simplify:function(b,e){if(!b)return null;e=e?e:N.VECTOR_SIMPLIFICATION;for(var k=[],l=null,p=b.length;p--;){var u=b[p];if(include=!l||p===0||t(u.x-l.x)+t(u.y-l.y)>e){k.unshift(u);l=u}}return k},theta:function(b,e,k){k=Ua((b.y-e.y)/k);return b.x>e.x?k:Math.PI-k},toString:function(b){return b.x+", "+b.y}}}(),D=function(){return{dotProduct:function(c,
o){return c.x*o.x+c.y*o.y}}}(),na=function(){function c(g){return o(g.x1,g.y1,g.x2,g.y2)}function o(g,b,e,k){g=g?g:0;b=b?b:0;e=typeof e!=="undefined"?e:g;k=typeof k!=="undefined "?k:k;return{x1:g,y1:b,x2:e,y2:k,width:e-g,height:k-b}}return{center:function(g){return N.init(g.x1+g.width/2,g.y1+g.height/2)},copy:c,diagonalSize:function(g){return ma(g.width*g.width+g.height*g.height)},fromCenter:function(g,b,e,k){e=e>>1;k=k>>1;return o(g-e,b-k,g+e,b+k)},init:o,intersect:function(g,b){var e=U(g.x1,b.x1),
k=U(g.y1,b.y1),l=F(g.x2,b.x2),p=F(g.y2,b.y2);e=o(e,k,l,p);return e.width>0&&e.height>0?e:null},toString:function(g){return"["+g.x1+", "+g.y1+", "+g.x2+", "+g.y2+"]"},union:function(g,b){if(g.width===0||g.height===0)return c(b);else if(b.width===0||b.height===0)return c(g);else{var e=F(g.x1,b.x1),k=F(g.y1,b.y1),l=U(g.x2,b.x2),p=U(g.y2,b.y2);e=o(e,k,l,p);return e.width>0&&e.height>0?e:null}}}}(),Va=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return N.init(c.width>>
1,c.height>>1)},getSize:function(c){return ma(T(c.width,2)+T(c.height,2))},init:function(c,o){c=c?c:0;return{width:c,height:o?o:c}}}}(),La=null,db=[],V=null,da=0,ea=[],Pa=["view.wake","tile.loaded"],Ea=function(){function c(){if(!y){var v=Z().maxImageLoads;y=COG.Loopage.join({execute:function(W,Y){if(!v||q.length<v){var Q=u.shift();if(Q){q[q.length]=Q;Q.image.onload=g;Q.image.src=Q.url;Q.requested=T5.ticks()}else Y.trigger("complete")}},frequency:10});y.bind("complete",function(){y=null})}}function o(){O=
true;try{var v=s.length>>1;if(v>0){s.sort(function(Y,Q){return Y.created-Q.created});for(var W=v;W--;)delete k[s[W].url];s.splice(0,v)}}finally{O=false}fa.trigger("cacheCleared")}function g(){var v=l[this.id],W;if(v&&v.image.complete&&v.image.width>0){v.loaded=true;v.hitCount=1;for(W=q.length;W--;)if(q[W].image.src==this.src){q.splice(W,1);break}if(v.background||v.postProcess||v.drawBackground||v.customDraw)if(v.image){globalImageData=v;W=e(v.realSize?v.realSize.width:v.image.width,v.realSize?v.realSize.height:
v.image.height);var Y=W.getContext("2d"),Q=v.offset?v.offset:T5.XY.init();v.background&&Y.drawImage(v.background,0,0);v.drawBackground&&v.drawBackground(Y);v.customDraw?v.customDraw(Y,v):Y.drawImage(v.image,Q.x,Q.y);v.postProcess&&v.postProcess(Y,v);v.image=W}for(W=v.callbacks.length;W--;)v.callbacks[W]&&v.callbacks[W](this,false);v.callbacks=[];s[s.length]={url:this.src,created:v.requested};delete l[this.id];c()}}function b(v,W,Y){var Q=k[v];if(Q){Q.hitCount++;Q.image.complete&&Q.image.width>0&&
W?W(Q.image,true):Q.callbacks.push(W)}else{Q=COG.extend({url:v,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[W]},Y);Q.image.id="resourceLoaderImage"+p++;k[v]=Q;l[Q.image.id]=Q;u[u.length]=Q;c()}return Q}function e(v,W){var Y=document.createElement("canvas");COG.info("creating new canvas");Y.width=v?v:0;Y.height=W?W:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(Y);FlashCanvas.initElement(Y)}return Y}var k={},l={},p=0,u=[],q=[],s=[],A=0,y=null,
O=false,fa={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var v;if(y){COG.Loopage.leave(y.id);y=null}for(v=q.length;v--;)delete k[q[v].url];q=[];for(v=u.length;v--;)delete k[u[v].url];u=[]},get:function(v,W,Y){var Q=null,Ma=null;O||(Q=k[v]);if((Ma=Q?Q.image:null)&&(Ma.getContext||Ma.complete&&Ma.width>0))return Ma;else W&&b(v,W,Y);return null},load:b,newCanvas:e,reset:function(){k={}},stats:function(){return{imageLoadingCount:q.length,queuedImageCount:u.length,imageCacheFullness:A}}};COG.observable(fa);
COG.Loopage.join({execute:function(v){for(var W=false,Y=0,Q=Z();Y<q.length;)if(v-q[Y].requested>fa.loadTimeout*1E3){q.splice(Y,1);W=true}else Y++;W&&c();if(Q&&Q.imageCacheMaxSize){A=s.length*fa.avgImageSize/Q.imageCacheMaxSize;A>=1&&o()}},frequency:2E4});return fa}(),Wa=function(){var c={};return{init:function(o,g){var b=c[o];if(!b)throw Error("Unable to locate requested generator: "+o);return new b(g)},register:function(o,g){c[o]=g},Template:function(){}}}(),bb=function(){function c(l,p){e[l]=g(p);
return l}function o(l){for(var p in l)c(p,l[p])}function g(l){function p(A){var y=l[A];typeof y!=="undefined"&&q.push(function(O){O[A]=y})}function u(){q=[];for(var A in l)p(A)}l=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},l);var q=[],s={applyToContext:function(A){for(var y=q.length;y--;)q[y](A)},update:function(A,y){l[A]=y;u()}};u();return s}var b={},e={},
k={apply:function(l,p){var u=e[p]?e[p]:e.basic,q;if(l&&l.canvas){q=b[l.canvas.id];b[l.canvas.id]=p}u.applyToContext(l);return q},define:c,defineMany:o,get:function(l){return e[l]},init:g,load:function(l){COG.jsonp(l,function(p){o(p)})}};o({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return k}(),Fb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Ab=function(c){function o(B,z,R,$){$a=jb;Q();if($&&c.inertia)s(xa-
z,ya-R,c.panAnimationEasing,c.panAnimationDuration);else $||s(xa-z,ya-R);clearTimeout(S);S=setTimeout(g,100)}function g(){$a=pb;va=false;Q()}function b(B,z,R,$){eb(F(U(la+T(2,$)-1,0.5),2))}function e(B){var z=pa(la)/Math.LN2>>0;if(la!==1)$a=xb;if(z!==0){la=T(2,z);z=N.init(kb-(h/la>>0),lb-(C/la>>0));if(!Fa.trigger("scale",la,z).cancel){for(B=ia.length;B--;)ia[B].trigger("scale",la,z);la=1;mb=null;$a=pb;B=true}}Q(B)}function k(B){B||(B=N.init(h,C));K=N.init(xa,ya);ba=N.offset(B,xa,ya);kb=ba.x;lb=ba.y}
function l(B,z){var R,$;$=1/la;if(la!==1&&j){R=j.x1+B*$;$=j.y1+z*$}else{R=B+xa;$=z+ya}return N.init(R,$)}function p(B,z,R){ka("doubleTap",z,R,l(R.x,R.y));if(c.scalable){COG.endTweens(function($){return $.cancelOnInteract});eb(2,R,c.zoomAnimation,null,c.zoomDuration)}}function u(){clearTimeout(Qa);Qa=setTimeout(A,250)}function q(B,z,R){ka("tap",z,R,l(R.x,R.y))}function s(B,z,R,$,oa){function Ba(){Xa+=1;if(Xa>=2){g();oa&&oa()}}var Xa=0,Za=P?N.offset(P,-h,-C):null,cb=X?N.offset(X,-h,-C):null;if(Za){B=
B<Za.x?Za.x:B;z=z<Za.y?Za.y:z}if(cb){B=B>cb.x?cb.x:B;z=z>cb.y?cb.y:z}if(R){if(!va){B=COG.tweenValue(xa,B,R,Ba,$);z=COG.tweenValue(ya,z,R,Ba,$);B.cancelOnInteract=true;B.requestUpdates(function(fb){xa=fb|0;va=true;Q()});z.cancelOnInteract=true;z.requestUpdates(function(fb){ya=fb|0;va=true;Q()})}}else{xa=B|0;ya=z|0}}function A(B,z){var R;if(ta){ab&&ab.unbind();if(c.autoSize&&ta.parentNode){B=ta.parentNode.offsetWidth;z=ta.parentNode.offsetHeight}try{if(!ta.id)ta.id=c.id+"_canvas";ga=ta.getContext("2d")}catch($){COG.exception($);
throw Error("Could not initialise canvas on specified view element");}if(B&&z&&(Ha!==z||Ia!==B)){qb=true;Ia=B;Ha=z;h=Ia>>1;C=Ha>>1;Fa.trigger("resize",Ia,Ha);for(R=Na;R--;)ia[R].trigger("resize",Ia,Ha)}if(c.interactive){ab=INTERACT.watch(ta).pannable();O()}for(R=Na;R--;)ia[R].trigger("contextChanged",ga);Q(true)}}function y(B,z){z.setId(B);z.added=ca();z.bind("remove",function(){Fa.removeLayer(B)});z.trigger("contextChanged",ga);z.setParent(Fa);ia.push(z);ia.sort(function(R,$){var oa=$.zindex-R.zindex;
if(oa===0)oa=$.added-R.added;return oa});Na=ia.length;return z}function O(){if(ab){if(c.pannable){ab.bind("pan",o);ab.bind("inertiaCancel",function(){va=false;Q()})}if(c.scalable){ab.bind("zoom",b);ab.bind("doubleTap",p)}ab.bind("tap",q)}}function fa(){var B=gb?xa+h:xa,z=hb?ya+C:ya;if(Ra&&Ra>Ia)if(B+Ia>Ra)xa=gb?B-Ra>0?xa-Ra:xa:Ra-Ia;else if(B<0)xa=gb?xa+Ra:0;if(Ja&&Ja>Ha)if(z+Ha>Ja)ya=hb?z-Ja>0?ya-Ja:ya:Ja-Ha;else if(z<0)ya=hb?ya+Ja:0}function v(){Sa();ja=true;Ga=0}function W(B,z,R,$){var oa;na.center(z);
var Ba=0;j=na.copy(z);j.scaleFactor=la;R&&ga.clearRect(0,0,Ia,Ha);ga.save();try{ga.globalCompositeOperation="source-over";if(la!==1){var Xa=j,Za=1/la;kb=ba.x+(xa-K.x);lb=ba.y+(ya-K.y);j=Xa?na.fromCenter(kb>>0,lb>>0,Xa.width*Za>>0,Xa.height*Za>>0):void 0;ga.scale(la,la)}ga.translate(-j.x1,-j.y1);X=P=null;if(rb){ga.beginPath();clipped=false;for(Ba=Na;Ba--;)if(ia[Ba].clip){ia[Ba].clip(ga,j,B,Fa,R,$);clipped=true}ga.closePath();clipped&&ga.clip()}for(Ba=Na;Ba--;){oa=ia[Ba];var cb=oa.style,fb=cb?bb.apply(ga,
cb):null;if(oa.minXY)P=P?N.min(P,oa.minXY):N.copy(oa.minXY);if(oa.maxXY)X=X?N.max(X,oa.maxXY):N.copy(oa.maxXY);oa.draw(ga,j,B,Fa,R,$);fb&&bb.apply(ga,fb)}}finally{ga.restore()}if(E){ga.globalCompositeOperation="source-over";ga.strokeStyle="#f00";ga.beginPath();ga.moveTo(h,0);ga.lineTo(h,Ha);ga.moveTo(0,C);ga.lineTo(Ia,C);ga.stroke()}ka("drawComplete",z,$);COG.trace("draw complete",$)}function Y(B,z){var R=false,$=ua?ua:va?jb:$a,oa=!va&&($===xb||$===jb),Ba=Oa||$===jb||COG.getTweens().length>0;if(qb&&
ta){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(ta);ta.width=Ia;ta.height=Ha;ta.style.width=Ia+"px";ta.style.height=Ha+"px";qb=false}if(Ra||Ja)fa();f=Ma();if(oa){COG.endTweens(function(Xa){return Xa.cancelOnInteract});ja=false;if(Ga!==0){clearTimeout(Ga);Ga=0}}for(oa=Na;oa--;){if(ia[oa].animated)$a|=yb;ia[oa].cycle(B,f,$a,Ba);R=ia[oa].shouldDraw($a,f,Ba)||R}Ba=Ba||($a&yb)!==0;if(R=R||Ba||la!==1&&la!==zb){W($,f,Ba,B);zb=la;Oa=false}if(!R&&i===0&&!Gb){if(!ja&&Ga===0)Ga=setTimeout(v,nb);
z.trigger("complete")}B-aa>sb&&Sa();i=0;COG.trace("Completed draw cycle",B)}function Q(B){Oa=B?true:false;i+=1;if(!m){m=COG.Loopage.join({execute:Y,frequency:Hb});m.bind("complete",function(){m=null})}}function Ma(){return na.init(xa,ya,xa+Ia,ya+Ha)}function Sa(){aa=(new Date).getTime();ka("refresh",Fa);Q()}function eb(B,z,R,$,oa){if(R&&!ob){ob=COG.tweenValue(la,B,R,null,oa);ob.requestUpdates(function(Ba,Xa){la=Ba;if(Xa){var Za=Ca(pa(la)/Math.LN2);la=T(2,Za);$&&$();ob=null}k(z);e(Xa)})}else{la=B;
k(z);e()}return Fa}function ka(){for(var B=Fa.trigger.apply(null,arguments).cancel,z=ia.length;z--;)B=ia[z].trigger.apply(null,arguments).cancel||B;return!B}c=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,idleDelay:100,minRefresh:1E3,pannable:true,clipping:false,scalable:true,interactive:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25,zoomAnimation:COG.easing("quad.out"),
zoomDuration:300},c);var ia=[],Na=0,ta=document.getElementById(c.container),ga=null,tb=typeof window.attachEvent!="undefined",nb=c.idleDelay,sb=c.minRefresh,xa=0,ya=0,Ra=null,Ja=null,gb=false,hb=false,rb=c.clipping,f=null,m=null,j,E=c.guides,a=1,i=0,h=0,C=0,K=null,ba=null,ja=false,va=false,Ga=0,S=0,P=null,X=null,aa=0,qa=0,ua=null,Oa=false,Qa=0,mb=null,la=1,ob=null,zb=0,qb=false,ab=null,Ha,Ia,Gb=typeof FlashCanvas!=="undefined",Hb=~~(1E3/c.fps),kb,lb,pb=H("ACTIVE"),jb=H("PAN"),xb=H("ZOOM"),yb=H("ANIMATING"),
$a=pb,Fa={id:c.id,deviceScaling:a,fastDraw:c.fastDraw||Z().requireFastDraw,getDimensions:function(){return Va.init(Ia,Ha)},getLayer:function(B){for(var z=0;z<Na;z++)if(ia[z].getId()==B)return ia[z];return null},setLayer:function(B,z){for(var R=0;R<Na;R++)if(ia[R].getId()===B){ia.splice(R,1);break}z&&y(B,z);Q();return z},eachLayer:function(B){for(var z=Na;z--;)B(ia[z])},invalidate:Q,refresh:Sa,resetScale:function(){la=1},resize:function(B,z){if(ta){c.autoSize=false;if(Ia!==B||Ha!==z)A(B,z)}},scale:eb,
triggerAll:ka,removeLayer:function(B){a:{for(var z=Na;z--;)if(ia[z].getId()==B){B=z;break a}B=-1}if(B>=0&&B<Na){Fa.trigger("layerRemoved",ia[B]);ia.splice(B,1);Q(true)}Na=ia.length},stateOverride:function(B){ua=B},getOffset:function(){return N.init(xa,ya)},setMaxOffset:function(B,z,R,$){Ra=B;Ja=z;gb=typeof R!="undefined"?R:false;hb=typeof $!="undefined"?$:false},getViewRect:Ma,updateOffset:s,pan:function(B,z,R,$,oa){s(xa+B,ya+z,R,$,oa)}};a=Z().getScaling();Fa.markers=y("markers",new ub);COG.observable(Fa);
Fa.bind("invalidate",function(B,z){Q(z)});Fa.bind("resync",function(){X=P=null});COG.configurable(Fa,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(c,null,{container:function(B,z){ta=document.getElementById(z);A()},rotation:function(B,z){qa=z}}),true);A();if(c.autoSize)tb?window.attachEvent("onresize",u):window.addEventListener("resize",u,false);return Fa},ib=function(c){c=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:H("ACTIVE",
"ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var o=null,g=false,b=false,e=c.supportFastDraw,k=c.id,l=H("ACTIVE"),p=c.validStates,u=0,q=0,s=COG.extend({addToView:function(A){A.setLayer(k,s)},shouldDraw:function(A,y,O){return(b||O||u!==y.x1||q!==y.y1)&&(A&p)!==0&&(g?e:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){s.trigger("remove",s)},changed:function(A){b=true;s.trigger("changed",s);o&&o.trigger("invalidate",A)},getId:function(){return k},setId:function(A){k=
A},getParent:function(){return o},setParent:function(A){g=(o=A)?o.fastDraw&&displayState!==l:false;s.trigger("parentChange",o)}},c);COG.observable(s);s.bind("drawComplete",function(A,y){b=false;u=y.x1;q=y.y1});s.bind("resync",function(A,y){if(y.syncXY){s.minXY&&y.syncXY(s.minXY);s.maxXY&&y.syncXY(s.maxXY)}});return s},vb=function(c){function o(u,q,s,A){b=u;e=q;k=s;l=A}c=COG.extend({xy:N.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var g=false,b=0,e=0,k=0,l=0,p=COG.extend(c,{isAnimating:function(){return g},
draw:function(u,q,s,A,y){if(p.isNew&&c.tweenIn){var O=p.xy.y;p.xy.y=q.y1-20;g=true;COG.tween(p.xy,"y",O,c.tweenIn,function(){p.xy.y=O>>0;g=false},c.animationSpeed?c.animationSpeed:250+Math.random()*500)}p.drawMarker(u,q,p.xy.x,p.xy.y,s,A,y);p.isNew=false},drawMarker:function(u,q,s,A){u.beginPath();u.arc(s,A,4,0,Math.PI*2,false);u.fill();o(s-4,A-4,8,8)},hitTest:function(u,q){return u>=b&&u<=b+k&&q>=e&&q<=e+l},updateBounds:o});COG.observable(p);return p},ub=function(c){function o(){e.changed(true);
e.trigger("markerUpdate",b)}function g(){var k=e.getParent();if(k&&k.syncXY)for(var l=b.length;l--;)k.syncXY([b[l].xy])}c=COG.extend({zindex:100,style:"basic"},c);var b=[],e=COG.extend(new ib(c),{draw:function(k,l,p,u){for(var q=b.length;q--;)b[q].draw(k,l,p,e,u)},add:function(k){if(k&&typeof k.length!=="undefined")for(var l=k.length;l--;){if(k[l])b[b.length]=k[l]}else if(k)b[b.length]=k;o()},clear:function(k){if(k)for(var l=0;l<b.length;)if(k(b[l]))b.splice(l,1);else l+=1;else b=[];o()},each:function(k){if(k)for(var l=
b.length;l--;)k(b[l])},find:function(k){for(var l=[],p=b.length;p--;)if(!k||k(b[p]))l[l.length]=b[p];return l}});e.bind("tap",function(k,l,p,u){var q=[],s=u.x;u=u.y;for(var A=b.length;A--;)if(b[A].hitTest(s,u))q[q.length]=b[A];if(q.length>0)k.cancel=e.trigger("markerTap",l,p,q).cancel});e.bind("parentChange",g);e.bind("resync",g);e.bind("changed",g);return e},Bb=function(c){function o(p,u,q){p.fillStyle="#FFFFFF";p.strokeStyle="#222222";p.beginPath();p.arc(q.x,q.y,4,0,Math.PI*2,false);p.stroke();
p.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:H("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},c);var g=N.edges(c.path),b,e=null,k=0;COG.tweenValue(0,g.total,c.easing,function(){l.remove()},c.duration).requestUpdates(function(p,u){k=p;u&&l.remove()});var l=COG.extend(new ib(c),{cycle:function(){for(var p=0;p<g.accrued.length&&g.accrued[p]<k;)p++;e=null;if(p<c.path.length-1){var u=k-(p>0?g.accrued[p-1]:0),q=c.path[p];b=N.theta(q,c.path[p+
1],g.edges[p]);e=N.extendBy(q,b,u)}return e},draw:function(p,u){if(e)(c.drawIndicator?c.drawIndicator:o)(p,u,N.init(e.x,e.y),b)}});return l},Cb=function(c){c=COG.extend({style:null,properties:{}},c);return COG.extend(c,{rect:null,draw:function(){},resync:function(){}})},wb=function(c,o){o=COG.extend({fill:false,simplify:false},o);var g=false,b=o.fill,e=o.simplify,k=H("ZOOM"),l=[],p=COG.extend(new Cb(o),{draw:function(u,q,s,A,y,O){if(g){q=true;s=(O&k)!==0;u.beginPath();for(O=l.length;O--;){s=l[O].x;
A=l[O].y;if(q){u.moveTo(s,A);q=false}else u.lineTo(s,A);s=true}if(s){b&&u.fill();u.stroke()}}},resync:function(u){p.xy=u.syncXY(c);l=N.floor(e?N.simplify(c):c)}});g=c&&c.length>=2;return p},Db=function(c){function o(k){for(var l=b.length;l--;)b[l].resync(k);b.sort(function(p,u){var q=u.xy.y-p.xy.y;if(q===0)q=u.xy.x-p.xy.y;return q});e.changed()}function g(k,l){l.syncXY&&o(l)}c=COG.extend({zindex:80},c);var b=[],e=COG.extend(new ib(c),{add:function(k){b[b.length]=k},each:function(k){for(var l=b.length;l--;)k(b[l])},
draw:function(k,l,p){var u=l.x1,q=l.y1,s=l.width;l=l.height;for(var A=b.length;A--;){var y=b[A].style;y=y?bb.apply(k,y):null;b[A].draw(k,u,q,s,l,p);y&&bb.apply(k,y)}}});e.bind("parentChange",g);e.bind("resync",g);return e},Ib=function(){return{tileSize:256,init:function(c,o,g,b,e){return COG.extend({x:c,y:o,width:g,height:b},e)}}}(),Eb=function(c){function o(O,fa,v,W){function Y(){if(y.initTileCreator){l=true;y.initTileCreator(O,fa,v,W)}}y.prepTileCreator?y.prepTileCreator(O,fa,v,Y):Y()}function g(O,
fa){for(var v=~~((O.x1-e.x)/p),W=~~((O.y1-e.y)/u),Y=[],Q=-k;Q<s;Q++)for(var Ma=-k;Ma<A;Ma++){var Sa=q(v+Q,W+Ma);if(Sa)Y[Y.length]=Sa}fa&&fa(Y);b=na.copy(O)}c=COG.extend({tileWidth:256,tileHeight:256,relative:false,padding:2},c);var b=null,e=N.init(),k=c.padding,l=false,p=c.tileWidth,u=c.tileHeight,q=null,s=0,A=0,y={getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){q=null;l=false;b=null},run:function(O,fa,v){var W=!b||Math.abs(O.x1-
b.x1)>p||Math.abs(O.y1-b.y1)>u,Y=W?y.requireRefresh(O,fa):false;if(W){if(!q&&!l||Y){e=c.relative?N.init(O.x1,O.y1):N.init();s=Math.ceil(O.width/p)+k;A=Math.ceil(O.height/u)+k;o(p,u,y.getTileCreatorArgs?y.getTileCreatorArgs(fa):{},function(Q){q=Q;l=false;g(O,v)})}q&&g(O,v)}}};COG.observable(y);y.bind("update",function(){COG.info("captured generator update");b=null});return y},Ya={ex:COG.extend,ticks:ca,getConfig:Z,userMessage:function(c,o,g){Ya.trigger("userMessage",c,o,g)},zoomable:G,XY:N,XYRect:na,
Dimensions:Va,Vector:D,D:Va,Images:Ea,Generator:Wa,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:bb,viewState:H,View:Ab,ViewLayer:ib,ImageLayer:function(c,o){function g(q,s,A){for(s=k.length;s--;){var y=k[s],O=y.x,fa=y.y,v=na.init(y.x,y.y,y.x+y.width,y.y+y.height);if(A&&na.intersect(q,v)){v=Ea.get(y.url,function(){u.changed()},p);A(v,O,fa,y.width,y.height)}}}function b(q){e&&e.run(q,u.getParent(),function(s){k=[].concat(s);u.changed()})}o=COG.extend({imageLoadArgs:{}},
o);var e=c?Wa.init(c,o):null,k=[],l=na.init(),p=o.imageLoadArgs,u=COG.extend(new ib(o),{changeGenerator:function(q,s){e=Wa.init(q,COG.extend({},o,s));k=null;b(l)},clip:function(q,s,A){g(s,A,function(y,O,fa,v,W){y&&q.rect(O,fa,v,W)})},cycle:function(q,s){b(s)},draw:function(q,s,A){g(s,A,function(y,O,fa,v,W){u.drawImage(q,y,O,fa,v,W,s,A)});l=na.copy(s)},drawImage:function(q,s,A,y){s&&q.drawImage(s,A,y,s.width,s.height)}});u.bind("refresh",function(){b(l)});u.bind("tap",function(q,s,A,y){q=[];var O=
y.x,fa=y.y,v,W;if(k)for(var Y=k.length;Y--;){v=k[Y];if(W=O>=v.x&&O<=v.x+v.width&&fa>=v.y&&fa<=v.y+v.height)q[q.length]=v}q.length>0&&u.trigger("tapImage",q,s,A,y)});return u},Marker:vb,ImageMarker:function(c){c=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},c);var o=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,g=COG.extend(new vb(c),{drawMarker:function(b,e,k,l){if((e=g.isAnimating()&&g.animatingImage?g.animatingImage:
g.image)&&e.width>0){o||(o=N.init(-e.width>>1,-e.height>>1));var p=g.scale,u=k+~~(o.x*p),q=l+~~(o.y*p),s=~~(e.width*p),A=~~(e.height*p);g.updateBounds(u,q,s,s);if(g.rotation||g.opacity!==1){b.save();try{b.globalAlpha=g.opacity;b.translate(k,l);b.rotate(g.rotation);b.drawImage(e,o.x*p,o.y*p,s,A)}finally{b.restore()}}else b.drawImage(e,u,q,s,A)}}});if(!g.image)g.image=Ea.get(c.imageUrl,function(b){g.image=b});if(!g.animatingImage)g.animatingImage=Ea.get(c.animatingImageUrl,function(b){g.animatingImage=
b});return g},MarkerLayer:ub,PathLayer:function(c){function o(){var s=q.getParent();if(s&&s.syncXY){s.syncXY(k);l&&s.syncXY(l);q.trigger("tidy")}}c=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},c);var g=false,b=[],e=null,k=[],l=null,p=0,u=[],q=COG.extend(new ib(c),{getAnimation:function(s,A,y,O){var fa="pathAnimation"+p++;u.push(fa);return new Bb({id:fa,path:b,zindex:c.zindex+1,easing:s?s:COG.easing("sine.inout"),duration:A?A:5E3,drawIndicator:y,autoCenter:O?O:false})},cycle:function(s,
A,y,O){return O},draw:function(s){var A,y=b.length;s.save();try{bb.apply(s,c.style);if(y>0){s.beginPath();s.moveTo(b[y-1].x,b[y-1].y);for(A=y;A--;)s.lineTo(b[A].x,b[A].y);s.stroke();if(e){s.fillStyle=c.waypointFillStyle;for(A=e.length;A--;){s.beginPath();s.arc(e[A].x,e[A].y,2,0,Math.PI*2,false);s.stroke();s.fill()}}}}finally{s.restore()}g=false},updateCoordinates:function(s,A){k=s;l=A;o()}});q.bind("tidy",function(){b=N.simplify(k,c.pixelGeneralization);e=N.simplify(l,c.pixelGeneralization);g=true;
q.changed()});q.bind("resync",o);return q},AnimatedPathLayer:Bb,Shape:Cb,Arc:function(c,o){o=COG.extend({size:4},o);var g=N.init(),b=COG.extend(o,{draw:function(e){e.beginPath();e.arc(g.x,g.y,b.size,0,Math.PI*2,false);e.fill();e.stroke()},resync:function(e){e.syncXY([c]);g=N.floor([c])[0]}});COG.info("created arc = ",c);return b},Poly:wb,ShapeLayer:Db,Tiling:Ib,TileGenerator:Eb};COG.observable(Ya);var Ta=Ya.Geo=function(){function c(f){for(var m=null,j=1;!m&&j<arguments.length;j++)m=k(f,arguments[j]);
m=m?m:k(f);if(!m)throw Error("Unable to find GEO engine with "+f+" capability");return m}function o(f){f=parseFloat(f)*y;f=wa(f);var m=Y*f;return pa((1+f)/(1-f)*T((1-m)/(1+m),Y))/2}function g(f){return parseFloat(f)*y}function b(f){f=T(Math.E,-f);for(var m=d-2*Aa(f),j=l(m,f),E=0;E<Ma&&t(m-j)>Q;){m=j;j=l(m,f);E++}return j*O}function e(f){return f%360*O}function k(f,m){var j=null;for(var E in ga)if(m){if(E==m&&ga[E][f]){j=ga[E];break}}else if(ga[E][f]){j=ga[E];break}return j}function l(f,m){var j=Y*
wa(f);return d-2*Aa(m*T((1-j)/(1+j),Y/2))}function p(f,m,j,E){m=q(m);f.add(E.line(m,j));return m.length}function u(f,m,j,E){m=q(m);f.add(E.poly(m,j));return m.length}function q(f){var m=f?f.length:0,j=Array(m);for(m=m;m--;)j[m]=Ta.Position.init(f[m][1],f[m][0]);return Ta.Position.vectorize(j,Ra)}function s(f,m,j){return new hb(f,m,j)}var A=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],y=Math.PI/180,O=180/Math.PI,fa=d,v=-fa,W=-I,Y=0.08181919084262157,Q=
1.0E-7,Ma=12,Sa=null,eb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ka=function(){function f(a){return a?j(a.lat,a.lon):null}function m(a){return!a||a.lat===0&&a.lon===0}function j(a,i){return{lat:parseFloat(a?a:0),lon:parseFloat(i?i:0)}}function E(a){if(a)if(typeof a.lat!=="undefined")return f(a);else{if(a.split)for(var i=[" ",","],h=0;h<i.length;h++){var C=a.split(i[h]);if(C.length===2)return j(C[0],C[1])}}else return j();return null}return{calcDistance:function(a,
i){if(m(a)||m(i))return 0;var h=(i.lat-a.lat)*y>>1,C=(i.lon-a.lon)*y>>1;h=wa(h)*wa(h)+Ka(a.lat*y)*Ka(i.lat*y)*wa(C)*wa(C);return 6371*2*Da(ma(h),ma(1-h))},copy:f,empty:m,equal:function(a,i){return a&&i&&a.lat==i.lat&&a.lon==i.lon},fromMercatorPixels:function(a,i){return j(b(i),e(a))},generalize:function(a,i,h){var C=a.length,K=[],ba=null;h||(h=250);h/=1E3;COG.info("generalizing positions, must include "+i.length+" positions");for(var ja=C;ja--;)if(ja===0)K.unshift(a[ja]);else{var va=!ba||ka.inArray(a[ja],
i)?h:ka.calcDistance(ba,a[ja]);if(a[ja]&&va>=h){K.unshift(a[ja]);ba=a[ja]}}COG.info("generalized "+C+" positions into "+K.length+" positions");return K},inArray:function(a,i){for(var h=ka.equal,C=i.length;C--;)if(h(a,i[C]))return true;return false},inBounds:function(a,i){var h=!(ka.empty(a)||ka.empty(i));return h=(h=h&&a.lat>=i.min.lat&&a.lat<=i.max.lat)&&a.lon>=i.min.lon&&a.lon<=i.max.lon},init:j,offset:function(a,i,h){var C=a.lat*y;a=a.lon*y;i=C+i/6371;h=Ua(wa(h/6371)/Ka(C));h=a+h;i=(i+d)%Math.PI-
d;h%=I;return j(i*O,h*O)},parse:E,parseArray:function(a){var i=a.length,h=Array(i);for(i=i;i--;)h[i]=E(a[i]);return h},toMercatorPixels:function(a){return T5.XY.init(g(a.lon),o(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,i){var h=a.length,C=Array(h);i=COG.extend({chunkSize:500,async:true},i);if(!i.async){for(var K=h;K--;)C[K]=T5.GeoXY.init(a[K]);return C}return COG.Loopage.join({frequency:10,execute:function(ba,ja){for(var va=0,Ga=i.chunkSize,S=h;S--;){C[S]=T5.GeoXY.init(a[S]);
va+=1;if(va>Ga)break}h=S;h<=0&&ja.trigger("complete",C)}})}}}(),ia=function(){function f(a,i,h){var C=T5.XY.init(0,i.lat-a.lat);if(typeof h==="undefined")h=true;C.x=h&&a.lon>i.lon?360-a.lon+i.lon:i.lon-a.lon;return C}function m(a,i){return ia.init(ka.init(a.min.lat-i,a.min.lon-i%360),ka.init(a.max.lat+i,a.max.lon+i%360))}function j(a){var i=f(a.min,a.max);return ka.init(a.min.lat+(i.y>>1),a.min.lon+(i.x>>1))}function E(a,i){return{min:ka.parse(a),max:ka.parse(i)}}return{calcSize:f,createBoundsFromCenter:function(a,
i){var h=i/6371,C=a.lat*y,K=a.lon*y,ba=C-h,ja=C+h;if(ba>v&&ja<fa){C=Ua(wa(h)/Ka(C));h=(K-C)%I;K=(K+C)%I}else{ba=U(ba,v);ja=F(ja,fa);h=W;K=I}return ia.init(ka.init(ba*O,h*O),ka.init(ja*O,K*O))},expand:m,forPositions:function(a,i){var h=null,C=T5.ticks();i||(i="auto");for(var K=a.length;K--;)if(h){var ba=f(h.min,a[K],false),ja=f(a[K],h.max,false);if(ba.x<0)h.min.lon=a[K].lon;if(ba.y<0)h.min.lat=a[K].lat;if(ja.x<0)h.max.lon=a[K].lon;if(ja.y<0)h.max.lat=a[K].lat}else h=E(a[K],a[K]);if(i){if(i=="auto"){K=
f(h.min,h.max);i=U(K.x,K.y)*0.3}h=m(h,i)}COG.trace("calculated bounds for "+a.length+" positions",C);return h},getCenter:j,getGeoHash:function(a){var i=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+i+", max hash = "+a)},getZoomLevel:function(a,i){var h=j(a);h=F(Ca(t(h.lat)*0.05),A.length);var C=A[h],K=f(a.min,a.max);h=w(pa(A[3]*i.height/K.y)/pa(2));C=w(pa(C*i.width/K.x)/pa(2));return F(isNaN(h)?1E3:h,isNaN(C)?1E3:C)},init:E,isEmpty:function(a){return!a||
ka.empty(a.min)||ka.empty(a.max)},toString:function(a){return"min: "+ka.toString(a.min)+", max: "+ka.toString(a.max)}}}(),Na=function(){var f=/^(\d+).*$/,m=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(j,E){f.lastIndex=-1;if(f.test(j))for(var a=j.replace(f,"$1"),i=E.split(","),h=0;h<i.length;h++){m.lastIndex=-1;if(m.test(i[h])){var C=m.exec(i[h]);if(a>=parseInt(C[1],10)&&a<=parseInt(C[2],10))return true}else if(a==i[h])return true}return false},normalize:function(j){if(!j)return"";j=j.toUpperCase();
if(!Sa){var E=[];for(var a in eb)E.push(a);Sa=RegExp("(\\s)("+E.join("|")+")(\\s|$)","i")}Sa.lastIndex=-1;if(E=Sa.exec(j))j=j.replace(Sa,"$1"+eb[E[2]]);return j},toString:function(j){return j.streetDetails+" "+j.location}}}(),ta=Ya.GeoXY=function(){function f(j,E){if(j.length){for(var a,i,h,C,K=j.length;K--;){f(j[K],E);a=typeof a==="undefined"||j.x<a?j.x:a;i=typeof i==="undefined"||j.y<i?j.y:i;h=typeof h==="undefined"||j.x>h?j.x:h;C=typeof C==="undefined"||j.y>C?j.y:C}return na.init(a,i,C,C)}else if(j.mercXY){a=
j.mercXY;j.x=(a.x+Math.PI)/E|0;j.y=(Math.PI-a.y)/E|0;j.rpp=E}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return j}function m(j,E,a){j.pos=E;j.mercXY=ka.toMercatorPixels(E);(a=typeof a!=="undefined"?a:j.rpp)&&f(j,a)}return{init:function(j,E){var a=N.init();m(a,j,E);return a},sync:f,toPos:function(j,E){E=E?E:self.rpp;return ka.fromMercatorPixels(j.x*E-Math.PI,Math.PI-j.y*E)},updatePos:m}}(),ga={},tb=function(){return{bestResults:function(f,m){m||(m=20);for(var j=f.length>0?f[0]:
null,E=[],a=0;a<f.length;a++)if(j&&f[a]&&j.matchWeight-f[a].matchWeight<=m)E.push(f[a]);else break;return E}}}(),nb=function(f){f=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},f);return COG.extend(f,{toString:function(){return f.caption+(f.matchWeight?" ("+f.matchWeight+")":"")}})},sb=function(){function f(a,i){var h=a.getDimensions();h=new rb({data:i,width:h.width,height:h.height});a.setLayer("route",h)}function m(a){for(var i=j.Unknown,h=E,C=0;C<h.length;C++){h[C].regex.lastIndex=
-1;var K=h[C].regex.exec(a);if(K){i=h[C].customCheck?h[C].customCheck(a,K):h[C].turnType;break}}return i}var j={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},
E=function(){var a=[];a.push({regex:/continue/i,turnType:j.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(i,h){return/bear/i.test(h[1])?j.TurnLeftSlight:j.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(i,h){return/bear/i.test(h[1])?j.TurnRightSlight:j.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:j.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:j.Ramp});a.push({regex:/take.*?exit/i,turnType:j.RampExit});a.push({regex:/make(.*?)u\-turn/i,
customCheck:function(i,h){return/right/i.test(h[1])?j.UTurnRight:j.UTurnLeft}});a.push({regex:/proceed/i,turnType:j.Start});a.push({regex:/arrive/i,turnType:j.Arrive});a.push({regex:/fell\sthrough/i,turnType:j.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var i=c("route");i&&i.route(a,function(h){if(a.generalize)h.geometry=ka.generalize(h.geometry,h.getInstructionPositions());if(a.map){f(a.map,
h);a.autoFit&&a.map.gotoBounds(h.boundingBox)}a.success&&a.success(h)})},createMapOverlay:f,parseTurnType:m,TurnType:j,Instruction:function(a){var i=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),h=a.description;h=h.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");i.description=h;if(!a.turnType)a.turnType=m(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=ia.forPositions(a.geometry);
return COG.extend({getInstructionPositions:function(){for(var i=[],h=0;h<a.instructions.length;h++)a.instructions[h].position&&i.push(a.instructions[h].position);return i}},a)}}}(),xa="featurecollection",ya="feature",Ra={async:false},Ja={processor:null,group:"shapes",layerClass:Db},gb={point:COG.extend({},Ja,{processor:function(f,m,j,E){m=q([m.coordinates],Ra);if(m.length>0)if(j=E.marker(m[0],j)){f.add(j);return m.length}},group:"markers",layerClass:ub}),linestring:COG.extend({},Ja,{processor:function(f,
m,j,E){m=q(m&&m.coordinates?m.coordinates:[]);return p(f,m,j,E)}}),multilinestring:COG.extend({},Ja,{processor:function(f,m,j,E){m=m&&m.coordinates?m.coordinates:[];for(var a=0,i=m.length;i--;)a+=p(f,m[i],j,E);return a}}),polygon:COG.extend({},Ja,{processor:function(f,m,j,E){m=m&&m.coordinates?m.coordinates:[];if(m.length>0)return u(f,m[0],j,E);return 0}}),multipolygon:COG.extend({},Ja,{processor:function(f,m,j,E){m=m&&m.coordinates?m.coordinates:[];for(var a=0,i=0;i<m.length;i++)a+=u(f,m[i][0],j,
E);return a}})},hb=function(f,m,j,E){function a(X,aa){var qa=X.processor,ua=K+X.group,Oa=COG.extend({},X,j,{properties:aa.properties});if(qa){var Qa=S[ua];if(!Qa){Qa=new X.layerClass({id:ua});S[ua]=Qa}globalLayers=S;return qa(Qa,aa.data,Oa,E)}return 0}function i(X,aa){var qa=X&&X.type?X.type.toLowerCase():null;return qa&&qa===ya?i(X.geometry,X.properties):{type:qa,isCollection:qa?qa===xa:false,definition:gb[qa],data:X,properties:aa?aa:X.properties}}j=COG.extend({vectorsPerCycle:Ta.VECTORIZE_PER_CYCLE,
rowPreParse:null,simplify:false,layerPrefix:"geojson-"},j);E=COG.extend({marker:function(X){return new vb({xy:X})},line:function(X,aa){return new wb(X,aa)},poly:function(X,aa){return new wb(X,COG.extend({fill:true},aa))}},E);var h=j.vectorsPerCycle,C=j.rowPreParse,K=j.layerPrefix,ba=0,ja=0,va=null,Ga=0,S={},P;if(!f)return null;if(typeof f.length==="undefined")f=[f];ja=f.length;P=COG.Loopage.join({frequency:10,execute:function(X,aa){var qa=0,ua=ba;if(!va){for(;ua<ja;ua++){var Oa=i(C?C(f[ua]):f[ua]),
Qa=null;if(Oa.isCollection){Ga+=1;va=s(Oa.data.features,function(mb){va=null;for(var la in mb)S[la]=mb[la]},{layerPrefix:K+Ga+"-"});Qa+=1}else if(Oa.definition)Qa=a(Oa.definition,Oa);qa+=Qa?Qa:1;if(qa>=h)break}ba=ua+1;!va&&ba>=ja&&aa.trigger("complete")}}});P.bind("complete",function(){m&&m(S)});return P};Ya.GeoJSON={parse:s};Ya.Map=function(f){function m(P){try{var X=Ta.Position.init(P.coords.latitude,P.coords.longitude),aa=P.coords.accuracy/1E3;S.trigger("locationUpdate",P,aa);if(ja){if(!K){K=new Ta.UI.LocationOverlay({pos:X,
accuracy:aa});K.update(S.getTileLayer());S.setLayer("location",K)}var qa=Ta.BoundingBox.createBoundsFromCenter(X,Math.max(aa,1));S.gotoBounds(qa)}else{K.pos=X;K.accuracy=aa;K.update(S.getTileLayer());a(X,null,COG.easing("sine.out"))}ja=false}catch(ua){COG.exception(ua)}}function j(P){COG.info("caught location tracking error:",P)}function E(P,X,aa){S.setZoomLevel(X);COG.endTweens();a(P,aa)}function a(P,X,aa,qa){P=ta.init(P,Ta.radsPerPixel(S.getZoomLevel()));var ua=S.getDimensions();S.updateOffset(P.x-
(ua.width>>1),P.y-(ua.height>>1),aa,qa,X);S.trigger("wake");S.trigger("boundsChange",S.getBoundingBox());X&&typeof aa==="undefined"&&X(S)}f=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},f);var i={NONE:0,SINGLE:1,WATCH:2},h=N.init(),C=i.NONE,K=null,ba=0,ja=true,va=0,Ga=f.tapExtent;f.adjustScaleFactor=function(P){return Math.pow(2,(P<1?Math.floor:Math.ceil)(Math.log(P)))};var S=COG.extend(new Ab(f),{getBoundingBox:function(){var P=S.getViewRect();return Ta.BoundingBox.init(ta.toPos(N.init(P.x1,
P.y2),va),ta.toPos(N.init(P.x2,P.y1),va))},getCenterPosition:function(){var P=S.getViewRect();if(P){P=N.init(P.x1+(P.width>>1),P.y1+(P.height>>1));return ta.toPos(P,va)}return null},gotoBounds:function(P,X){var aa=Ta.BoundingBox.getZoomLevel(P,S.getDimensions());E(Ta.BoundingBox.getCenter(P),aa,X)},gotoPosition:E,panToPosition:a,syncXY:function(P){return ta.sync(P,va)},locate:function(){S.trackStart(i.SINGLE);setTimeout(S.trackCancel,1E4)},trackStart:function(P){if(navigator.geolocation&&!ba){C=P?
P:i.WATCH;ja=true;ba=navigator.geolocation.watchPosition(m,j,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){ba&&navigator.geolocation&&navigator.geolocation.clearWatch(ba);S.removeLayer("location");K=null;C=i.NONE;ba=0},animateRoute:function(P,X,aa,qa){var ua=S.getLayer("route");if(ua)(P=ua.getAnimation(P,X,aa,qa))&&P.addToView(S)}});S.bind("pan",function(){C===i.SINGLE&&S.trackCancel()});S.bind("tap",function(P,X,aa,qa){var ua=Ta.radsPerPixel(S.getZoomLevel());P=ta.toPos(qa,
ua);var Oa=ta.toPos(N.offset(qa,-Ga,Ga),ua);qa=ta.toPos(N.offset(qa,Ga,-Ga),ua);S.trigger("geotap",X,aa,P,ia.init(Oa,qa))});S.bind("refresh",function(){if(N.absSize(N.diff(h,S.getOffset()))>f.boundsChangeThreshold){h=N.copy(S.getOffset());S.trigger("boundsChange",S.getBoundingBox())}});G(S,f);S.bind("zoomLevelChange",function(P,X){var aa;va=Ta.radsPerPixel(X);aa=I/va|0;S.setMaxOffset(aa,aa,true,false);Ea.cancelLoad();S.resetScale();S.triggerAll("resync",S)});return S};Ya.MapTileGenerator=function(f){f=
COG.extend({relative:true},f);var m=0,j=null;return COG.extend(new Eb(f),{minLevel:2,maxLevel:20,getTileCreatorArgs:function(E){j=E.getCenterPosition();m=E.getZoomLevel();return{zoomLevel:m,position:j}},requireRefresh:function(E,a){return!j||m!==a.getZoomLevel()}})};Ya.GeoPoly=function(f,m){m=COG.extend({autoParse:true},m);for(var j=Array(f.length),E=m.autoParse,a=T5.Geo.Position.parse,i=f.length;i--;)j[i]=T5.GeoXY.init(E?a(f[i]):f[i]);return new T5.Poly(j,m)};var rb=Ya.RouteOverlay=function(f){f=
COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},f);var m=[],j=[],E=new T5.PathLayer(f);(function(){if(f.data&&f.data.instructions){for(var a=f.data.instructions,i=Array(a.length),h=a.length;h--;)i[h]=a[h].position;ka.vectorize(i).bind("complete",function(C,K){j=K})}f.data&&f.data.geometry&&ka.vectorize(f.data.geometry).bind("complete",function(C,K){m=K;E.updateCoordinates(m,j,true)})})();return E};
Ya.LocationOverlay=function(f){f=COG.extend({pos:null,accuracy:null,zindex:90},f);var m=new Image,j=T5.XY.init(),E=T5.XY.init(),a=null;m.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
m.onload=function(){j=T5.XY.init(m.width>>1,m.height>>1)};var i=COG.extend(new T5.ViewLayer(f),{pos:f.pos,accuracy:f.accuracy,drawAccuracyIndicator:false,draw:function(h,C){var K=E.x-C.x,ba=E.y-C.y;if(a){h.fillStyle="rgba(30, 30, 30, 0.2)";h.beginPath();h.arc(K,ba,a,0,Math.PI*2,false);h.fill()}m.complete&&m.width>0&&h.drawImage(m,K-j.x,ba-j.y,m.width,m.height);i.changed()},update:function(h){if(h){a=h.getPixelDistance(i.accuracy)>>1;E=h.getGridXYForPosition(i.pos);i.changed()}}});i.bind("gridUpdate",
function(h,C){i.update(C)});return i};return{distanceToString:function(f){if(f>1E3)return~~(f/10)/100+" km";return f?f+" m":""},dist2rad:function(f){return f/6371},getEngine:c,lat2pix:o,lon2pix:g,pix2lat:b,pix2lon:e,radsPerPixel:function(f){return I/(256<<f)},Position:ka,BoundingBox:ia,Radius:function(f,m){return{distance:parseInt(f,10),uom:m}},Address:function(f){return f=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},f)},A:Na,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(f){if(!f.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var m=COG.extend({remove:function(){delete ga[m.id]}},f);return ga[m.id]=m},Search:tb,GeoSearchResult:nb,LocationSearch:function(f){function m(h,C){navigator.geolocation.clearWatch(E);E=0;if(a){clearTimeout(a);a=0}C&&C([h],f)}function j(h){COG.info("caught location tracking error:",h)}f=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},f);var E=0,a=0,i=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(h,C){if(navigator.geolocation&&!E){E=navigator.geolocation.watchPosition(function(K){var ba=ka.init(K.coords.latitude,K.coords.longitude);K=new nb({id:1,caption:"Current Location",pos:ba,accuracy:K.coords.accuracy/1E3,matchWeight:100});if(!i||K.accuracy<i.accuracy)i=K;if(!f.requiredAccuracy||i.accuracy<f.requiredAccuracy)m(i,C)},j,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(f.searchTimeout)a=
setTimeout(function(){i&&m(i,C)},f.searchTimeout)}}},f))},Routing:sb}}();return Ya}();
