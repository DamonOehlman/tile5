COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var M=arguments[0]||{},ha,y=1,A=arguments.length;y<A;y++)if((ha=arguments[y])!==null)for(var m in ha){var k=ha[m];if(M!==k)if(k!==undefined)M[m]=k}return M};
(function(){var M=Object.prototype.hasOwnProperty,ha=0,y={};y.toID=function(A){return A.replace(/\s/g,"-")};y.objId=function(A){return(A?A:"obj")+ha++};y.isFunction=function(A){return toString.call(A)==="[object Function]"};y.isArray=function(A){return toString.call(A)==="[object Array]"};y.isPlainObject=function(A){if(!A||toString.call(A)!=="[object Object]"||A.nodeType||A.setInterval)return false;if(A.constructor&&!M.call(A,"constructor")&&!M.call(A.constructor.prototype,"isPrototypeOf"))return false;
var m;for(m in A);return m===undefined||M.call(A,m)};y.isEmptyObject=function(A){for(var m in A)return false;return true};y.isXmlDocument=function(A){return toString.call(A)==="[object Document]"};y.contains=function(A,m){var k=A,u=arguments,C=1;if(m&&module.isArray(m)){u=m;C=0}for(C=C;C<u;C++)k=k&&typeof foo[u[C]]!=="undefined";return k};y.formatStr=function(A){if(arguments.length<=1)return A;for(var m=arguments.length-2,k=0;k<=m;k++)A=A.replace(RegExp("\\{"+k+"\\}","gi"),arguments[k+1]);return A};
y.wordExists=function(A,m){var k="";if(m.toString)m=m.toString();for(var u=0;u<m.length;u++)k+=!/\w/.test(m[u])?"\\"+m[u]:m[u];return RegExp("(^|\\s|\\,)"+k+"(\\,|\\s|$)","i").test(A)};COG.extend(COG,y)})();
(function(){function M(k){return typeof console!=="undefined"?function(){console[k](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ha=window.console&&window.console.markTimeline,y=M("error"),A=M("info"),m=function(){return ha?function(k,u){console.markTimeline(k+(u?": "+((new Date).getTime()-u)+"ms":""))}:function(){}}();COG.extend(COG,{trace:m,debug:M("debug"),info:A,warn:M("warn"),error:y,exception:function(k){if(y)for(var u in k)A("ERROR DETAIL: "+
u+": "+k[u])}})})();
(function(){function M(y,A){var m=y.hasOwnProperty("obsHandlers")?y.obsHandlers:null;m[A]||(m[A]=[]);return m[A]}var ha=0;COG.observable=function(y){if(!y)return null;if(!(y.hasOwnProperty("obsHandlers")?y.obsHandlers:null))y.obsHandlers={};if(!y.hasOwnProperty("bind")){y.bind=function(A,m){var k="callback"+ha++;M(y,A).unshift({fn:m,id:k});return k};y.triggerCustom=function(A,m){var k=M(y,A),u={cancel:false,name:A,source:this},C;m&&COG.extend(u,m);if(!k)return null;C=Array.prototype.slice.call(arguments,2);
y.eventInterceptor&&y.eventInterceptor(A,u,C);C.unshift(u);for(var S=k.length;S--&&!u.cancel;)k[S].fn.apply(this,C);return u};y.trigger=function(A){var m=Array.prototype.slice.call(arguments,1);m.splice(0,0,A,null);return y.triggerCustom.apply(this,m)};y.unbind=function(A,m){if(typeof A==="undefined")y.obsHandlers={};else for(var k=M(y,A),u=0;k&&u<k.length;u++)if(k[u].id===m){k.splice(u,1);break}return y}}return y}})();
(function(){function M(m,k){m[k]||(m[k]=function(u){return m.configure(k,u)})}function ha(m){m.gtConfId="configurable"+A++;m.gtConfig={};m.gtConfigFns=[];return m.gtConfig}var y={},A=0;COG.paramTweaker=function(m,k,u){return function(C,S){if(typeof S!=="undefined"){if(C in m)m[C]=S;u&&C in u&&u[C](C,S)}else return k&&C in k?k[C](C):m[C]}};COG.configurable=function(m,k,u,C){if(m){m.gtConfId||ha(m);var S=m.gtConfId,n=m.gtConfig,E=m.gtConfigFns;y[S]=m;E.push(u);for(u=k.length;u--;){n[k[u]]=true;C&&M(m,
k[u])}if(!m.configure)m.configure=function(z,J){if(n[z]){for(var v=E.length;v--;){var w=E[v](z,J);if(typeof w!=="undefined")return w}return y[S]}return null}}}})();
(function(){function M(m){var k=document.createElement("script"),u=false;k.src=m;k.async=true;k.onload=k.onreadystatechange=function(){if(!u&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){u=true;k.onload=k.onreadystatechange=null;k&&k.parentNode&&k.parentNode.removeChild(k)}};y||(y=document.getElementsByTagName("head")[0]);y.appendChild(k)}var ha=0,y,A=this;COG.jsonp=function(m,k,u){m+=m.indexOf("?")>=0?"&":"?";var C="json"+ ++ha;A[C]=function(S){k(S);A[C]=null;try{delete A[C]}catch(n){}};
M(m+(u?u:"callback")+"="+C);return C}})();
(function(){var M=1.70158,ha=Math.PI/2,y=1E3/60|0,A=Math.abs,m=Math.pow,k=Math.sin,u=Math.asin,C=Math.cos,S={linear:function(n,E,z,J){return z*n/J+E},backin:function(n,E,z,J){return z*(n/=J)*n*((M+1)*n-M)+E},backout:function(n,E,z,J){return z*((n=n/J-1)*n*((M+1)*n+M)+1)+E},backinout:function(n,E,z,J){return(n/=J/2)<1?z/2*n*n*(((M*=1.525)+1)*n-M)+E:z/2*((n-=2)*n*(((M*=1.525)+1)*n+M)+2)+E},bouncein:function(n,E,z,J){return z-S.bounceout(J-n,0,z,J)+E},bounceout:function(n,E,z,J){return(n/=J)<1/2.75?
z*7.5625*n*n+E:n<2/2.75?z*(7.5625*(n-=1.5/2.75)*n+0.75)+E:n<2.5/2.75?z*(7.5625*(n-=2.25/2.75)*n+0.9375)+E:z*(7.5625*(n-=2.625/2.75)*n+0.984375)+E},bounceinout:function(n,E,z,J){return n<J/2?S.bouncein(n*2,0,z,J)/2+E:S.bounceout(n*2-J,0,z,J)/2+z/2+E},cubicin:function(n,E,z,J){return z*(n/=J)*n*n+E},cubicout:function(n,E,z,J){return z*((n=n/J-1)*n*n+1)+E},cubicinout:function(n,E,z,J){if((n/=J/2)<1)return z/2*n*n*n+E;return z/2*((n-=2)*n*n+2)+E},elasticin:function(n,E,z,J,v,w){if(n==0)return E;if((n/=
J)==1)return E+z;w||(w=J*0.3);if(!v||v<A(z)){v=z;z=w/4}else z=w/TWO_PI*u(z/v);return-(v*m(2,10*(n-=1))*k((n*J-z)*TWO_PI/w))+E},elasticout:function(n,E,z,J,v,w){var D;if(n==0)return E;if((n/=J)==1)return E+z;w||(w=J*0.3);if(!v||v<A(z)){v=z;D=w/4}else D=w/TWO_PI*u(z/v);return v*m(2,-10*n)*k((n*J-D)*TWO_PI/w)+z+E},elasticinout:function(n,E,z,J,v,w){var D;if(n==0)return E;if((n/=J/2)==2)return E+z;w||(w=J*0.3*1.5);if(!v||v<A(z)){v=z;D=w/4}else D=w/TWO_PI*u(z/v);if(n<1)return-0.5*v*m(2,10*(n-=1))*k((n*
J-D)*TWO_PI/w)+E;return v*m(2,-10*(n-=1))*k((n*J-D)*TWO_PI/w)*0.5+z+E},quadin:function(n,E,z,J){return z*(n/=J)*n+E},quadout:function(n,E,z,J){return-z*(n/=J)*(n-2)+E},quadinout:function(n,E,z,J){if((n/=J/2)<1)return z/2*n*n+E;return-z/2*(--n*(n-2)-1)+E},sinein:function(n,E,z,J){return-z*C(n/J*ha)+z+E},sineout:function(n,E,z,J){return z*k(n/J*ha)+E},sineinout:function(n,E,z,J){return-z/2*(C(Math.PI*n/J)-1)+E}};COG.tweenValue=function(n,E,z,J,v){function w($){$=$?$:(new Date).getTime();if(qa+y<$){var ya=
$-D,X=z(ya,n,ia,J),ua=D+J<=$;$=!ua;if(v){ya=v(X,ua,ya);$=typeof ya!="undefined"?ya&&$:$}$&&animFrame(w)}}var D=(new Date).getTime(),qa=0,ia=E-n;animFrame(w);return{}};COG.easing=function(n){return S[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(n,E){S[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]=E}})();
(function(){var M=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ha=/^(\d+H)?(\d+M)?(\d+S)?$/,y={8601:function(m){m=m.split("T");var k=null;k=null;var u=0,C=0;M.lastIndex=-1;k=M.exec(m[0]);u+=k[3]?parseInt(k[3].slice(0,-1),10):0;ha.lastIndex=-1;k=ha.exec(m[1]);C+=k[1]?parseInt(k[1].slice(0,-1),10)*3600:0;C+=k[2]?parseInt(k[2].slice(0,-1),10)*60:0;C+=k[3]?parseInt(k[3].slice(0,-1),10):0;return new A(u,C)}},A=COG.Duration=function(m,k){return{days:m?m:0,seconds:k?k:0}};COG.addDuration=function(){for(var m=new A,k=arguments.length;k--;){m.days+=
arguments[k].days;m.seconds+=arguments[k].seconds}if(m.seconds>=86400){m.days+=~~(m.seconds/86400);m.seconds%=86400}return m};COG.formatDuration=function(m){var k,u,C="";if(m.days)C=m.days+" days ";if(m.seconds){m=m.seconds;if(m>=3600){k=~~(m/3600);m-=k*3600}if(m>=60){u=Math.round(m/60);m-=u*60}if(k)C=C+k+(k>1?" hrs ":" hr ")+(u?(u>10?u:"0"+u)+" min ":"");else if(u)C=C+u+" min";else if(m>0)C=C+(m>10?m:"0"+m)+" sec"}return C};COG.parseDuration=function(m,k){var u=k?y[k]:null;if(u)return u(m);COG.Log.warn("Could not find duration parser for specified format: "+
k);return new A}})();COG.ObjectStore=function(){var M={},ha={},y="obj_"+(new Date).getTime(),A=0,m=Object.prototype.hasOwnProperty;return{add:function(k,u){var C;u=u?u:"default";if(k&&k.constructor)if(!m.call(k,"id"))k.id=y+ ++A;C=ha[u]?ha[u]:ha[u]=[];M[k.id]=C.length;C[k.length]=k}}};var CANI={};
(function(M){var ha=[],y=0,A=false,m=M.register=function(k,u){ha.push({section:k,run:u})};M.init=function(k){function u(){if(y<ha.length){var S=ha[y++];C[S.section]||(C[S.section]={});S.run(C[S.section],u)}else{for(S in C)M[S]=C[S];A=true;k&&k(M)}}var C={};if(A&&k)k(M);else{y=0;u()}};m("canvas",function(k,u){function C(){var z,J=S.getContext("2d");J.save();try{J.translate(50,50);J.beginPath();J.rect(0,0,20,20);z=J.isPointInPath(10,10)}finally{J.restore()}return z}var S=document.createElement("canvas"),
n=typeof FlashCanvas!="undefined",E=typeof G_vmlCanvasManager!="undefnined";S.width=200;S.height=200;k.pipTransformed=n||E?false:C();u()})})(CANI);
INTERACT=function(){function M(v){return function(w,D,qa){(qa?qa:v?document.body:document).addEventListener(w,D,false)}}function ha(v){return function(w,D,qa){(qa?qa:v?document.body:document).removeEventListener(w,D,false)}}function y(v,w,D){(D?D:document).attachEvent("on"+v,w)}function A(v,w,D){(D?D:document).detachEvent("on"+v,w)}function m(v,w){return{x:v?v:0,y:w?w:0,count:1}}function k(v,w){z.push(COG.extend({handler:null,checks:{},type:v},w))}function u(v){var w=0,D=0;if(v.offsetParent){do{w+=
v.offsetLeft;D+=v.offsetTop;v=v.offsetParent}while(v)}return{left:w,top:D}}function C(v,w){return{source:v,target:w.target?w.target:w.srcElement}}function S(v,w){for(var D=v.target?v.target:v.srcElement;D&&D!==w&&D.nodeName&&D.nodeName.toUpperCase()!="CANVAS";)D=D.parentNode;return D&&D===w}function n(v,w){return{x:v.x-(w?w.left:0),y:v.y-(w?w.top:0)}}function E(v){if(v.preventDefault){v.preventDefault();v.stopPropagation()}else v.cancelBubble&&v.cancelBubble()}var z=[],J=function(v,w,D){function qa(ma,
ja,va,T){var ba=0,Ca=0,F=0;COG.tweenValue(0,ma,va,T,function(U){F=ba;ba=U});COG.tweenValue(0,ja,va,T,function(U){ia.trigger("pan",ba-F,U-Ca);Ca=U})}D=COG.extend({binder:null,unbinder:null,observable:null},D);for(var ia=D.observable,$=null,ya=[],X=[],ua,za,Ga={bind:function(){return ia.bind.apply(null,arguments)},pannable:function(ma){$=COG.extend({inertia:true},ma);return Ga},unbind:function(){ia.unbind();for(var ma=0;ma<ya.length;ma++)ya[ma].unbind();return Ga}},Ja=0;Ja<w.length;Ja++)ya.push(w[Ja](v,
ia,D));ia.bind("pointerDown",function(){X=[];za=ua=0});ia.bind("pointerMove",function(ma,ja,va,T){if($){X[X.length]={ticks:(new Date).getTime(),x:T.x,y:T.y};ia.trigger("pan",T.x,T.y)}ua+=T.x?T.x:0;za+=T.y?T.y:0});ia.bind("pointerUp",function(ma,ja,va){if(Math.abs(ua)>20||Math.abs(za)>20){if($){va=X.length;var T,ba;ja=0;for(ba=X.length;--ba>1&&ja<50;)ja+=X[ba].ticks-X[ba-1].ticks;if(va-ba>1){ma=X[va-1].x-X[ba].x;T=X[va-1].y-X[ba].y;ba=Math.sqrt(ma*ma+T*T)|0;if(ba>15){ma=X[va-1].x-X[0].x;T=X[va-1].y-
X[0].y;ba=Math.sqrt(ma*ma+T*T)|0;va=Math.asin(T/ba);ja=ba*500/ja|0;ja=ja>300?300:ja;qa(Math.cos(ma>0?va:Math.PI-va)*ja,Math.sin(va)*ja,COG.easing("sine.out"),500)}}}}else ia.trigger("tap",ja,va)});return Ga};k("pointer",{handler:function(v,w,D){function qa(F){if(F.pageX&&F.pageY)return m(F.pageX,F.pageY);else{var U=document.documentElement,xa=document.body;return m(F.clientX+(U&&U.scrollLeft||xa&&xa.scrollLeft||0)-(U&&U.clientLeft||xa&&xa.clientLeft||0),F.clientY+(U&&U.scrollTop||xa&&xa.scrollTop||
0)-(U&&U.clientTop||xa&&xa.clientTop||0))}}function ia(F){if(S(F,v))if(ma=ua(F)){var U=qa(F);v.style.cursor="move";E(F);ba=U.x;Ca=U.y;ja=m(ba,Ca);w.triggerCustom("pointerDown",C("mouse",F),ja,n(ja,u(v)))}}function $(F){var U=qa(F);va=U.x;T=U.y;if(S(F,v))za(F,ma?"pointerMove":"pointerHover")}function ya(F){if(ma&&ua(F)){ma=false;if(S(F,v)){v.style.cursor="default";za(F,"pointerUp")}}}function X(F){if(S(F,v)){var U;F=F||window.event;if(F.detail)U=F.axis===2?-F.detail*Ga:0;else{U=F.wheelDeltaY?F.wheelDeltaY:
F.wheelDelta;if(window.opera)U=-U}if(U!==0){var xa=m(va,T);w.triggerCustom("zoom",C("mouse",F),xa,n(xa,u(v)),U/Ja,"wheel");E(F);F.returnValue=false}}}function ua(F){F=F||window.event;return(F.which||F.button)==1}function za(F,U,xa,Na,Aa){xa=typeof xa!="undefined"?xa:va;Na=typeof Na!="undefined"?Na:T;var P=xa-ba,na=Na-Ca,Y=m(xa,Na);w.triggerCustom(U,C("mouse",F),Y,n(Y,u(v)),m(P,na));if(typeof Aa=="undefined"||Aa){ba=xa;Ca=Na}}D=COG.extend({},D);var Ga=120,Ja=Ga*8,ma=false,ja,va,T,ba,Ca;D.binder("mousedown",
ia,false);D.binder("mousemove",$,false);D.binder("mouseup",ya,false);D.binder("dblclick",function(F){COG.info("captured double click");if(S(F,v)){var U=qa(F);w.triggerCustom("doubleTap",C("mouse",F),U,n(U,u(v)))}},false);D.binder("mousewheel",X,document);D.binder("DOMMouseScroll",X,document);return{unbind:function(){D.unbinder("mousedown",ia,false);D.unbinder("mousemove",$,false);D.unbinder("mouseup",ya,false);D.unbinder("mousewheel",X,document);D.unbinder("DOMMouseScroll",X,document)}}},checks:{touch:false}});
k("pointer",{handler:function(v,w,D){function qa(P){if(P.count<2)return 0;var na=P.x-P.next.x;P=P.y-P.next.y;return~~Math.sqrt(na*na+P*P)}function ia(P,na,Y){na=na?na:0;Y=Y?Y:0;for(var V={x:P.x-na,y:P.y-Y,id:P.id,count:P.count},Oa=V;P.next;){P=P.next;Oa=Oa.next={x:P.x-na,y:P.y-Y,id:P.id}}return V}function $(P,na){var Y=P[na?na:"touches"],V,Oa;if(Y.length===0)return null;Oa=V={x:Y[0].pageX,y:Y[0].pageY,id:Y[0].identifier,count:Y.length};for(var Da=1,db=Y.length;Da<db;Da++)Oa=Oa.next={x:Y[Da].pageX,
y:Y[Da].pageY,id:Y[Da].identifier};return V}function ya(P){if(S(P,v)){T=u(v);var na=$(P,"changedTouches"),Y=ia(na,T.left,T.top);if(!Ca){ba=ma;w.triggerCustom("pointerDown",C("touch",P),na,Y)}Na&&w.triggerCustom("pointerDownMulti",C("touch",P),na,Y);Ca=$(P);if(Ca.count>1)U=qa(Ca);Aa=1;xa=ia(Ca)}}function X(P){if(S(P,v)){P.preventDefault();F=$(P);if(ba==ma)ba=Math.abs(Ca.x-F.x)>Ga||Math.abs(Ca.y-F.y)>Ga?Ja:ma;if(ba!=ma){ba=F.count>1?va:ja;if(ba==va)if(Ca.count===1){Ca=ia(F);U=qa(Ca)}else{var na=qa(F);
if(Math.abs(U-na)<za)ba=ja;else{var Y;Y=F.x;var V=F.next.x,Oa=F.y,Da=F.next.y,db=Oa<Da?Oa:Da;Y={x:(Y<V?Y:V)+(Math.abs(Y-V)>>1),y:db+(Math.abs(Oa-Da)>>1)};na=na/U;V=na-Aa;w.triggerCustom("zoom",C("touch",P),Y,n(Y,T),V,"pinch");Aa=na}}ba==ja&&w.triggerCustom("pointerMove",C("touch",P),F,ia(F,T.left,T.top),m(F.x-xa.x,F.y-xa.y));Na&&w.triggerCustom("pointerMoveMulti",C("touch",P),F,ia(F,T.left,T.top))}xa=ia(F)}}function ua(P){if(S(P,v)){var na=$(P,"changedTouches"),Y=ia(na,T.left,T.top);F=$(P);if(!F){w.triggerCustom("pointerUp",
C("touch",P),na,Y);Ca=null}Na&&w.triggerCustom("pointerUpMulti",C("touch",P),na,Y)}}D=COG.extend({detailed:false,inertia:false},D);var za=20,Ga=7,Ja=0,ma=1,ja=2,va=3,T,ba,Ca,F,U,xa,Na=D.detailed,Aa=1;D.binder("touchstart",ya,false);D.binder("touchmove",X,false);D.binder("touchend",ua,false);COG.info("initialized touch handler");return{unbind:function(){D.unbinder("touchstart",ya,false);D.unbinder("touchmove",X,false);D.unbinder("touchend",ua,false)}}},checks:{touch:true}});return{register:k,watch:function(v,
w,D){w=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},w);capabilities=COG.extend({touch:"ontouchstart"in window},D);if(!w.observable){COG.info("creating observable");w.observable=COG.observable({});globalOpts=w}w.binder=w.isIE?y:M(w.bindToBody);w.unbinder=w.isIE?A:ha(w.bindToBody);D=w.types;for(var qa=capabilities,ia=[],$=z.length;$--;){var ya=z[$],X=!D||D.indexOf(ya.type)>=0,ua=true;for(var za in ya.checks){var Ga=ya.checks[za];COG.info("checking "+
za+" capability. require: "+Ga+", capability = "+qa[za]);ua=ua&&Ga===qa[za]}if(X&&ua)ia[ia.length]=ya.handler}return new J(v,ia,w)}}}();var T5={};
(function(M){function ha(){return(new Date).getTime()}function y(b,h){h=xa.call(h);if(h=="finite")return!U[F](+b);return h=="null"&&b===null||h==typeof b||h=="object"&&b===Object(b)||h=="array"&&Array.isArray&&Array.isArray(b)||Na.call(b).slice(8,-1).toLowerCase()==h}function A(){var b=(new Date).getTime(),h=0;clearTimeout(eb);for(eb=0;h<bb.length;){var f=bb[h],c=$a[f],d=$a[f].image&&(Y||$a[f].image.complete&&$a[f].image.width>0),j=b-c.start;j=d||j>=Ab;if(d){d=c.image;c=c.callbacks;nb[f]=d;for(var o=
0;o<c.length;o++)c[o](d,true)}if(j){bb.splice(h,1);delete $a[f]}else h++}if(bb.length>0)eb=setTimeout(A,ob)}function m(b){function h(j){var o=b[j];y(o,Aa)||c.push(function(B){B[j]=o})}function f(){c=[];for(var j in b)h(j)}b=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},b);var c=[],d={applyToContext:function(j){for(var o=c.length;o--;)c[o](j)},update:function(j,
o){b[j]=o;f()}};f();return d}function k(){for(var b=0,h=arguments.length;h--;){var f=Bb[arguments[h].toUpperCase()];if(f)b|=f}return b}function u(b){b=b?b:(new Date).getTime();if(b-pb>Cb){for(var h=fb.splice(0),f=h.length;f--;)h[f](b);pb=b}fb.length&&animFrame(u)}function C(b){var h=fb.length==0;fb[fb.length]=b;h&&animFrame(u)}function S(b,h,f,c,d){d=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},d);var j=(new Date).getTime(),o=b[h],B=h=="translate",q=
d.autoInvalidate,L=f.length&&c.length&&f.length==c.length?f.length:0,ca=Array(L),W=Array(L),Q=COG.easing(d.easing),la=d.duration,Ha=d.progress,K=function(O){var ta=O-j;O=j+la<=O;for(var ra=b.layer?b.layer.view:null,oa,Ba=L;Ba--;){oa=Q(ta,f[Ba],ca[Ba],la);W[Ba]=B?oa|0:oa}o.apply(b,W);if(q&&ra)ra.redraw=true;if(Ha){ta=[].concat(O?c:W);ta.unshift(O);Ha.apply(b,ta)}if(O){b.animations--;o.apply(b,c);d.complete&&d.complete.apply(b,c)}else C(K)};if(o&&o.apply&&L>0){la=la?la:DEFAULT_DURATION;for(h=L;h--;)ca[h]=
c[h]-f[h];b.animations++;C(K)}}function n(b,h){var f,c;if(h&&h.width>0){if(!b.imageOffset)b.imageOffset=V.init(-h.width>>1,-h.height>>1);if(!b.bounds){f=b.xy.x+b.imageOffset.x;c=b.xy.y+b.imageOffset.y;b.bounds=Da.init(f,c,f+h.width,c+h.height)}}}function E(b){Sa.call(this,b)}function z(b,h){h=COG.extend({simplify:false},h);var f=false,c=h.simplify;k("ZOOM");var d=[];h.type=h.fill?"polygon":"line";Sa.call(this,h);COG.extend(this,{animatePath:function(){},prep:function(j){return f?j.path(d):null},resync:function(j){var o,
B,q,L,ca;j.syncXY(b);d=V.floor(c?V.simplify(b):b);for(var W=d.length;W--;){j=d[W].x;o=d[W].y;L=y(L,Aa)||j<L?j:L;ca=y(ca,Aa)||o<ca?o:ca;B=y(B,Aa)||j>B?j:B;q=y(q,Aa)||o>q?o:q}this.updateBounds(Da.init(L,ca,B,q),true)}});f=b&&b.length>=2}function J(b,h){h.fill=false;z.call(this,b,h)}function v(b){function h(q){(this.imageUrl=q)&&qb(this.imageUrl,function(L,ca){o=L;if(ca){var W=B.layer?B.layer.view:null;if(W)W.redraw=true}})}b=COG.extend({image:null,imageUrl:null,imageOffset:null},b);var f=null,c=Sa.prototype.updateBounds,
d,j,o=b.image;Sa.call(this,b);var B=COG.extend(this,{changeImage:h,drag:function(q,L,ca,W){f||(f=V.init(q.startX-this.xy.x,q.startY-this.xy.y));this.xy.x=L-f.x;this.xy.y=ca-f.y;if(W){f=null;if(this.layer)(q=this.layer.view)&&q.syncXY([this.xy],true);this.trigger("dragDrop")}return true},prep:function(q){if(o&&o.width>0){n(this,o);d=this.xy.x+this.imageOffset.x;j=this.xy.y+this.imageOffset.y;return q.image(o,d,j,o.width,o.height)}},updateBounds:function(q,L){c.call(this,q,L);n(this,o)}});o||h(this.imageUrl)}
function w(b){b=COG.extend({imageAnchor:null},b);if(b.imageAnchor)b.imageOffset=V.invert(b.imageAnchor);v.call(this,b)}function D(b){b=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,validStates:k("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);this.view=null;COG.observable(COG.extend(this,b))}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var qa=Math.PI*2,ia=Math.PI/2,$=Math.abs,ya=Math.ceil,X=Math.min,ua=Math.max,za=Math.pow,Ga=Math.sqrt,Ja=Math.log,ma=Math.round,ja=Math.sin,va=Math.asin,T=Math.cos,ba=Math.atan,Ca=Math.atan2,F="hasOwnProperty",U={NaN:1,Infinity:1,"-Infinity":1},xa=String.prototype.toLowerCase,Na=Object.prototype.toString,Aa="undefined",P="number",na=typeof G_vmlCanvasManager!=Aa,Y=typeof FlashCanvas!=Aa,V=function(){function b(c,d){return f(c.x-
d.x,c.y-d.y)}function h(c,d){if(!d)d=c.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var j={edges:Array(d-1),accrued:Array(d-1),total:0},o=0;o<d-1;o++){var B=b(c[o],c[o+1]);j.edges[o]=Ga(B.x*B.x+B.y*B.y);j.accrued[o]=j.total+j.edges[o];j.total+=j.edges[o]}return j}function f(c,d){return{x:c?c:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var c=0,d=0,j=arguments.length;j--;){c+=arguments[j].x;d+=
arguments[j].y}return f(c,d)},absSize:function(c){return ua($(c.x),$(c.y))},copy:function(c){return c?f(c.x,c.y):null},diff:b,distance:function(c,d){return h(c,d).total},edges:h,equals:function(c,d){return c.x===d.x&&c.y===d.y},extendBy:function(c,d,j){var o=T(d)*j|0;d=ja(d)*j|0;return f(c.x-o,c.y-d)},floor:function(c){for(var d=Array(c.length),j=c.length;j--;)d[j]=f(~~c[j].x,~~c[j].y);return d},getRect:function(c){for(var d,j,o,B,q=c.length;q--;){var L=c[q];d=y(d,Aa)||L.x<d?L.x:d;j=y(j,Aa)||L.y<
j?L.y:j;o=y(o,Aa)||L.x>o?L.x:o;B=y(B,Aa)||L.y>B?L.y:B}return Da.init(d,j,o,B)},init:f,invert:function(c){return f(-c.x,-c.y)},min:function(c,d){return f(c.x<d.x?c.x:d.x,c.y<d.y?c.y:d.y)},max:function(c,d){return f(c.x>d.x?c.x:d.x,c.y>d.y?c.y:d.y)},offset:function(c,d,j){return f(c.x+d,c.y+(j?j:d))},scale:function(c,d){return f(c.x/d|0,c.y/d|0)},simplify:function(c,d){if(!c)return null;d=d?d:V.VECTOR_SIMPLIFICATION;for(var j=[],o=null,B=c.length;B--;){var q=c[B];if(include=!o||B===0||$(q.x-o.x)+$(q.y-
o.y)>d){j.unshift(q);o=q}}return j},theta:function(c,d,j){j=va((c.y-d.y)/j);return c.x>d.x?j:Math.PI-j},toString:function(c){return c?c.x+", "+c.y:""}}}(),Oa=function(){return{dotProduct:function(b,h){return b.x*h.x+b.y*h.y}}}(),Da=function(){function b(f){return h(f.x1,f.y1,f.x2,f.y2)}function h(f,c,d,j){f=f?f:0;c=c?c:0;d=y(d,P)?d:f;j=y(j,P)?j:j;return{x1:f,y1:c,x2:d,y2:j,width:d-f,height:j-c}}return{buffer:function(f,c,d){return V.init(f.x1-c,f.y1-d?d:c,f.x1+c,f.y1+d?d:c)},center:function(f){return V.init(f.x1+
(f.width>>1),f.y1+(f.height>>1))},copy:b,diagonalSize:function(f){return Ga(f.width*f.width+f.height*f.height)},fromCenter:function(f,c,d,j){d=d>>1;j=j>>1;return h(f-d,c-j,f+d,c+j)},init:h,intersect:function(f,c){var d=ua(f.x1,c.x1),j=ua(f.y1,c.y1),o=X(f.x2,c.x2),B=X(f.y2,c.y2);d=h(d,j,o,B);return d.width>0&&d.height>0?d:null},toString:function(f){return f?"["+f.x1+", "+f.y1+", "+f.x2+", "+f.y2+"]":""},union:function(f,c){if(f.width===0||f.height===0)return b(c);else if(c.width===0||c.height===0)return b(f);
else{var d=X(f.x1,c.x1),j=X(f.y1,c.y1),o=ua(f.x2,c.x2),B=ua(f.y2,c.y2);d=h(d,j,o,B);return d.width>0&&d.height>0?d:null}}}}(),db=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return V.init(b.width>>1,b.height>>1)},getSize:function(b){return Ga(za(b.width,2)+za(b.height,2))},init:function(b,h){b=b?b:0;return{width:b,height:h?h:b}}}}();Hits=function(){return{diffHits:function(b,h){var f=[],c={},d;for(d=h.length;d--;)c[h[d].target.id]=true;
for(d=b.length;d--;)c[b[d].target.id]||(f[f.length]=b[d]);return f},init:function(b,h,f,c){return{type:b,x:c.x|0,y:c.y|0,elements:[],absXY:h,relXY:f}},initHit:function(b,h,f){return{type:b,target:h,drag:f}},triggerEvent:function(b,h,f,c){h.triggerCustom(b.type+(f?f:"Hit"),{hitType:b.type},c?c:b.elements,b.absXY,b.relXY,V.init(b.x,b.y))}}}();var ob=100,Ab=3E4,nb={},Db=0;(new Date).getTime();var $a={},bb=[],eb=0,qb=T5.getImage=function(b,h){var f=b&&h?nb[b]:null;if(f&&f&&(Y||f.complete&&f.width>0))h(f);
else{if(f=$a[b])f.callbacks.push(h);else{f=new Image;f.id="_ldimg"+ ++Db;$a[b]={start:(new Date).getTime(),image:f,callbacks:[h]};f.src=b;bb[bb.length]=b}eb||(eb=setTimeout(A,ob))}},Eb=T5.newCanvas=function(b,h){var f=document.createElement("canvas");f.width=b?b:0;f.height=h?h:0;if(Y){document.body.appendChild(f);FlashCanvas.initElement(f)}na&&G_vmlCanvasManager.initElement(f);return f},rb=function(){var b={};return{init:function(h,f){var c=b[h];if(!c)throw Error("Unable to locate requested generator: "+
h);return new c(f)},register:function(h,f){b[h]=f}}}(),Fb=function(){return{applyStyle:function(){},applyTransform:function(b,h,f){return{restore:null,x:h,y:f}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getOffset:function(){return V.init(0,0)},getViewport:function(){},hitTest:function(){return false},prepare:function(){},render:function(){},reset:function(){}}},sb={},tb=M.registerRenderer=function(b,h){sb[b]=h},ub=M.attachRenderer=function(b,h,f,c){b=b.split("/");for(var d=
new Fb(h,f,c),j=0;j<b.length;j++){var o=sb[b[j]];if(o)d=new o(h,f,c,d)}return d};tb("canvas",function(b,h,f,c){function d(K,O,ta){if(K.image)q.drawImage(K.image,O,ta);else if(!K.loading){K.loading=true;qb(K.url,function(ra){K.image=ra;K.loading=false;q.drawImage(ra,K.screenX,K.screenY)})}}f=COG.extend({},f);var j,o,B,q,L,ca=0,W=0,Q=null,la={},Ha={draw:function(){this.fill&&q.fill();this.stroke&&q.stroke()}};(function(){if(h){var K=h.tagName=="CANVAS",O=K?h.parentNode:h;j=b.width=O.offsetWidth;o=b.height=
O.offsetHeight;if(K){B=h;B.width=j;B.height=o;Y&&FlashCanvas.initElement(B)}else{B=Eb(j,o);B.style.cssText="position: absolute; z-index: 1;";h.appendChild(B)}q=null}})();return COG.extend(c,{interactTarget:B,applyStyle:function(K){var O=Gb(K),ta=O&&q&&q.canvas?la[q.canvas.id]:null;if(O){la[q.canvas.id]=K;O.applyToContext(q);return ta}},applyTransform:function(K){if(K.translateX||K.translateY||K.scaling!==1||K.rotatation){q.save();Q={undo:function(){q.restore();Q=null},x:K.xy.x,y:K.xy.y};q.translate(K.xy.x-
ca+K.translateX,K.xy.y-W+K.translateY);K.rotation!==0&&q.rotate(K.rotation);K.scaling!==1&&q.scale(K.scaling,K.scaling)}return Q},arc:function(K,O,ta,ra,oa){q.beginPath();q.arc(K-(Q?Q.x:ca),O-(Q?Q.y:W),ta,ra,oa,false);return Ha},drawTiles:function(K){for(var O,ta,ra=Q?Q.x:ca,oa=Q?Q.y:W,Ba=ra-256,aa=oa-256,Ma=ra+j,Za=oa+o,Ka,ka,La=K.length;La--;){O=K[La];ta=O.x>=Ba&&O.x<=Ma&&O.y>=aa&&O.y<=Za;Ka=O.screenX=O.x-ra;ka=O.screenY=O.y-oa;ta&&d(O,Ka,ka)}},image:function(K,O,ta,ra,oa){var Ba=O-(Q?Q.x:ca),aa=
ta-(Q?Q.y:W);q.beginPath();q.rect(Ba,aa,ra,oa);return{draw:function(){q.drawImage(K,Ba,aa,ra,oa)}}},prepare:function(K){var O,ta=false;O=b.getOffset();var ra=b.getScaleFactor(),oa=O.x,Ba=O.y;if(q)q.restore();else q=B.getContext("2d");for(O=K.length;O--;)ta=ta||K[O].clip;L=Da.init(oa,Ba,oa+j,Ba+o);L.scaleFactor=ra;if(ra!==1)L=Da.fromCenter(L.x1+(j>>1),L.y1+(o>>1),j/ra|0,o/ra|0);ca=L.x1;W=L.y1;if(q){ta||q.clearRect(0,0,j,o);q.save();q.scale(ra,ra)}q.globalCompositeOperation="source-over";return q},
path:function(K){var O=true,ta=Q?Q.x:ca,ra=Q?Q.y:W;q.beginPath();for(var oa=K.length;oa--;){var Ba=K[oa].x-ta,aa=K[oa].y-ra;if(O){q.moveTo(Ba,aa);O=false}else q.lineTo(Ba,aa)}return Ha},getContext:function(){return q},getDimensions:function(){return{width:j,height:o}},getOffset:function(){return V.init(ca,W)},getViewport:function(){return L}})});tb("dom",function(b,h,f,c){var d=typeof h.style["-webkit-transform"]!="undefined",j=null;j=document.createElement("div");j.id=COG.objId("domImages");j.style.cssText=
COG.formatStr("position: absolute; overflow: hidden; width: {0}px; height: {1}px;",h.offsetWidth,h.offsetHeight);h.insertBefore(j,c.interactTarget);var o=COG.extend(c,{drawTiles:function(B){var q,L;q=o.getOffset();o.getViewport();for(var ca=q.x,W=q.y,Q,la,Ha=B.length;Ha--;){q=B[Ha];L=q.image;Q=q.x-ca;la=q.y-W;if(!L){L=q.image=new Image;L.src=q.url;j.appendChild(L);L.style.cssText="-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;"}if(d)L.style["-webkit-transform"]=
"translate3d("+Q+"px, "+la+"px, 0px)";else{L.style.left=Q+"px";L.style.top=la+"px"}L.style.display="block"}},reset:function(){j.innerHTML=""}});return o});var vb={},Hb=M.defineStyle=function(b,h){vb[b]=m(h);return b},wb=M.defineStyles=function(b){for(var h in b)Hb(h,b[h])},Gb=M.getStyle=function(b){return vb[b]};M.loadStyles=function(b){COG.jsonp(b,function(h){wb(h)})};wb({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},
waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});var Bb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},yb=function(b){function h(s,x,G){Pa||Za(Ea-x,g-G)}function f(s,x,G,da){Ba(X(ua(sa+za(2,da)-1,0.5),2))}function c(){var s=Ja(sa)/Math.LN2|0;if(s!==0){sa=za(2,s);aa(Qa+s,wa,Ia)}ea.redraw=true}function d(s,x){var G=ea.getViewport(),da=1/sa;return V.init(G?G.x1+s*da:s,G?G.y1+x*da:x)}function j(s,x,G){Ma("doubleTap",x,G,d(G.x,G.y));b.scalable&&Ba(2,d(G.x,G.y),b.zoomEasing,null,
b.zoomDuration)}function o(s,x,G){Pa=null;O("down",x,G)}function B(s,x,G){O("hover",x,G)}function q(s,x,G){Ha(x,G,false)}function L(s,x,G){Ha(x,G,true)}function ca(){clearTimeout(Fa);Fa=setTimeout(function(){renderer.checkSize()},250)}function W(s,x,G){O("tap",x,G);Ma("tap",x,G,d(G.x,G.y,true))}function Q(s,x){x.id=s;x.added=ha();x.view=ea;x.trigger("parentChange",ea,ab,ib);ka.push(x);ka.sort(function(G,da){var pa=da.zindex-G.zindex;if(pa===0)pa=da.added-G.added;return pa});La=ka.length;return x}
function la(){I&&I.unbind();if(renderer){I=INTERACT.watch(renderer.interactTarget);b.pannable&&I.pannable().bind("pan",h);if(b.scalable){I.bind("zoom",f);I.bind("doubleTap",j)}I.bind("pointerDown",o);I.bind("pointerMove",q);I.bind("pointerUp",L);b.captureHover&&I.bind("pointerHover",B);I.bind("tap",W)}}function Ha(s,x,G){if(Pa){s=d(x.x,x.y);if(Pa.drag.call(Pa.target,Pa,s.x,s.y,G))ea.redraw=true;if(G)Pa=null}}function K(s){var x;x=false;s=s?s:(new Date).getTime();if(x=s-R>fa){ea.trigger("enterFrame",
s,jb++);s-Z>kb&&oa();R=s}if(x&&ea.redraw){x=Ea!==l||g!==p;Ta=Ua|(sa!==1?xb:0)|(x?cb:0)|(N?lb:0);H=(x=(Ta&(xb|cb))!==0)&&(Ta&lb)===0;if(renderer.prepare(ka,Ta,s,t)){x=renderer.getViewport();for(var G=La;G--;){Ta|=ka[G].animated?lb:0;ka[G].cycle(s,x,Ta)}for(G=ka.length;G--;){var da=ka[G];if(da.shouldDraw(Ta,x)){var pa=da.style?renderer.applyStyle(da.style):null;da.draw(renderer,Ta,ea,s,t);pa&&renderer.applyStyle(pa)}}renderer.render()}if(t){s=t?t.elements:[];if(ga&&ga.type==="hover"){x=Hits.diffHits(ga.elements,
s);x.length>0&&Hits.triggerEvent(ga,ea,"Out",x)}if(s.length>0){G=t.x;da=t.y;for(x=s.length;x--;){pa=s[x];var Va=G,Xa=da,Wa=pa&&pa.drag&&(!pa.canDrag||pa.canDrag(pa,Va,Xa));if(Wa){Pa=pa;Pa.startX=Va;Pa.startY=Xa}if(Wa)break}Hits.triggerEvent(t,ea)}ga=s.length>0?COG.extend({},t):null;t=null}l=Ea;p=g;ea.redraw=false}animFrame(K)}function O(s,x,G){t=Hits.init(s,x,G,d(G.x,G.y,true));for(s=La;s--;)Ya=Ya||(ka[s].hitGuess?ka[s].hitGuess(t.x,t.y,Ta,ea):false);if(Ya)ea.redraw=true}function ta(){ea.redraw=true}
function ra(){var s;if(renderer){s=renderer.getViewport();if(!s){s=renderer.getDimensions();s=Da.init(Ea,g,Ea+s.width,g+s.height)}}return s}function oa(){var s=renderer?renderer.getViewport():null;if(s){if(r||a)if(s){var x=e?Ea+(s.width>>1):Ea,G=i?g+(s.height>>1):g,da=s.width,pa=s.height;if(r&&r>da)if(x+da>r)Ea=e?Ea:r-da;else if(x<0)Ea=e?Ea:0;if(a&&a>pa)if(G+pa>a)g=i?g:a-pa;else if(G<0)g=i?g:0}Z=(new Date).getTime();Ma("refresh",ea,s);ea.redraw=true}}function Ba(s,x,G,da,pa){if(G)COG.tweenValue(sa,
s,G,pa,function(Va,Xa){sa=Va;if(Xa){var Wa=ma(Ja(sa)/Math.LN2);sa=za(2,Wa);da&&da()}c()});else{sa=s;c()}return ea}function aa(s,x,G){s=ua(b.minZoom,X(b.maxZoom,s));if(s!==Qa){var da=za(2,s-Qa),pa=ea.width>>1,Va=ea.height>>1,Xa=pa/da|0,Wa=Va/da|0;Qa=s;Za(((x?x:Ea+pa)-Xa)*da,((G?G:g+Va)-Wa)*da);l=Ea;p=g;Ma("zoomLevelChange",s);sa=1;renderer.reset();oa();ea.redraw=true}}function Ma(){for(var s=ea.trigger.apply(null,arguments).cancel,x=ka.length;x--;)s=ka[x].trigger.apply(null,arguments).cancel||s;return!s}
function Za(s,x,G,da,pa){function Va(){Xa+=1;if(Xa>=2){N=false;pa&&pa()}}var Xa=0;if(G){if((Ta&cb)===0){COG.tweenValue(Ea,s,G,da,function(Wa,mb){Ea=Wa|0;(mb?Va:ta)();return!H});COG.tweenValue(g,x,G,da,function(Wa,mb){g=Wa|0;(mb?Va:ta)();return!H});N=true}}else{Ea=s|0;g=x|0;ea.redraw=true;pa&&pa()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,
pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,renderer:"canvas",zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var Ka={},ka=[],La=0,ab=document.getElementById(b.container),Pa=null,jb=0,ib=null,gb=y(window.attachEvent,"function"),Ya=false,kb=b.minRefresh,Ea=0,g=0,l=0,p=0,r=null,a=null,e=false,i=false,t=null,H=false,Z=0,ga=null,Fa=0,sa=1,R=0,I=null,N=false,fa=1E3/b.fps|0,wa,Ia,Qa=b.zoomLevel,Ua=k("ACTIVE"),cb=k("PAN"),
xb=k("ZOOM"),lb=k("ANIMATING"),Ta=Ua,ea={id:b.id,detach:function(){I&&I.unbind()},eachLayer:function(s){for(var x=La;x--;)s(ka[x])},getLayer:function(s){for(var x=0;x<La;x++)if(ka[x].id===s)return ka[x];return null},getZoomLevel:function(){return Qa},setLayer:function(s,x){for(var G=0;G<La;G++)if(ka[G].id===s){ka.splice(G,1);break}if(x){Q(s,x);x.trigger("refresh",ea,ra())}ea.redraw=true;return x},invalidate:ta,refresh:oa,resetScale:function(){sa=1},scale:Ba,setZoomLevel:aa,syncXY:function(){},triggerAll:Ma,
removeLayer:function(s){a:{for(var x=La;x--;)if(ka[x].id===s){s=x;break a}s=-1}if(s>=0&&s<La){ea.trigger("layerRemoved",ka[s]);ka.splice(s,1);ea.redraw=true}La=ka.length},getOffset:function(){return V.init(Ea,g)},getRenderer:function(){return renderer},getScaleFactor:function(){return sa},setMaxOffset:function(s,x,G,da){r=s;a=x;e=G;i=da},getViewport:ra,updateOffset:Za,pan:function(s,x,G,da,pa){Za(Ea+s,g+x,G,da,pa)}};COG.observable(ea);ea.bind("resync",function(){});COG.configurable(ea,["container",
"captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,null,{container:function(s,x){ab=document.getElementById(x);renderer=ub(b.renderer,ea,ab);la()},inertia:la,captureHover:la,scalable:la,pannable:la}),true);CANI.init(function(s){ea.markers=Q("markers",new hb({zindex:20}));Ka=s;renderer=ub(b.renderer,ea,ab);la();gb?window.attachEvent("onresize",ca):window.addEventListener("resize",ca,false)});animFrame(K);return ea},Sa=function(b){b=COG.extend({style:null,
xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape"},b);COG.extend(this,b);this.id=COG.objId(this.type);this.view=this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};Sa.prototype={constructor:Sa,animate:function(b,h,f,c){S(this,b,h,f,c)},drag:null,prep:function(){},resync:function(b){if(this.xy){b.syncXY([this.xy]);this.size&&this.updateBounds(Da.fromCenter(this.xy.x,
this.xy.y,this.size,this.size))}},rotate:function(b){this.rotation=b},scale:function(b){this.scaling=b},translate:function(b,h){this.translateX=b;this.translateY=h},updateBounds:function(b,h){this.bounds=b;if(h)this.xy=Da.center(this.bounds)}};var Cb=1E3/60|0,fb=[],pb=0;E.prototype=COG.extend(Sa.prototype,{constructor:E,prep:function(b){return b.arc(this.xy.x,this.xy.y,this.size>>1,0,Math.PI*2)}});z.prototype=COG.extend({},Sa.prototype,{constructor:z});J.prototype=COG.extend({},z.prototype);v.prototype=
COG.extend({},Sa.prototype,{constructor:v});w.prototype=COG.extend({},v.prototype,{constructor:w});D.prototype={constructor:D,shouldDraw:function(b){return(b&this.validStates)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null};var zb=function(b){b=COG.extend({zindex:10},b);var h=[],f=CANI.canvas.pipTransformed,c=COG.extend(new D(b),{draw:function(d,j,o,B,q){B=d.getViewport();o=B.x1;B=B.y1;for(var L=q?f?q.x-o:q.relXY.x:0,ca=q?f?q.y-B:q.relXY.y:0,W=h.length;W--;){var Q=h[W],la=Q.style||
c.style,Ha,K=d.applyTransform(Q,o,B);if(drawData=Q.prep(d,K?K.x:o,K?K.y:B,j)){if(q&&d.hitTest(drawData,L,ca)){q.elements.push(Hits.initHit(Q.type,Q,Q.draggable?Q.drag:null));Ha=q.type+"Style";la=Q[Ha]||c[Ha]||la}la=la?d.applyStyle(la):null;drawData.draw&&drawData.draw.call(Q,o,B,j);la&&d.applyStyle(la)}K&&K.undo&&K.undo()}},getDrawables:function(){return[]},hitGuess:function(d,j){for(var o=false,B=h.length;!o&&B--;){var q=h[B];if(!(o=o))o=(q=q.bounds)&&d>=q.x1&&d<=q.x2&&j>=q.y1&&j<=q.y2;o=o}return o}});
c.bind("refresh",function(d,j,o){h=c.getDrawables(j,o)});return c},hb=function(b){function h(j){for(var o=c.length;o--;)c[o].resync(j);c.sort(function(B,q){var L=q.xy.y-B.xy.y;return L!=0?L:q.xy.x-B.xy.y});j.redraw=true}function f(j,o){h(o)}b=COG.extend({zindex:10},b);var c=[],d=COG.extend(new zb(b),{add:function(j,o){if(j){j.layer=d;var B=d.view;if(B){j.resync(B);B.redraw=true}if(o)c.unshift(j);else c[c.length]=j}},clear:function(){c=[]},find:function(){return[].concat(c)},getDrawables:function(){return c}});
d.bind("parentChange",f);d.bind("resync",f);return d};COG.extend(M,{ex:COG.extend,is:y,ticks:ha,userMessage:function(b,h,f){M.trigger("userMessage",b,h,f)},XY:V,XYRect:Da,Dimensions:db,Vector:Oa,Hits:Hits,Generator:rb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,viewState:k,View:yb,ViewLayer:D,ImageLayer:function(b,h){function f(B,q){var L=d?Math.abs(d.x1-q.x1)+Math.abs(d.y1-q.y1):0;if(c&&(!d||L>256))c(B,q,function(ca){d=Da.copy(q);j=[].concat(ca)})}h=COG.extend({imageLoadArgs:{}},
h);var c=b?rb.init(b,h).run:null,d=null,j=[],o=COG.extend(new D(h),{draw:function(B){B.drawTiles(j)}});o.bind("refresh",function(B,q,L){f(q,L)});return o},ImageGenerator:function(b){b=COG.extend({relative:false,padding:2},b);b={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(b);return b},Drawable:Sa,Marker:E,Poly:z,Line:J,ImageDrawable:v,ImageMarker:w,DrawLayer:zb,ShapeLayer:hb});COG.observable(M);var Ra=M.Geo=function(){function b(g){for(var l=null,p=
1;!l&&p<arguments.length;p++)l=j(g,arguments[p]);l=l?l:j(g);if(!l)throw Error("Unable to find GEO engine with "+g+" capability");return l}function h(g){g=parseFloat(g)*W;g=ja(g);var l=O*g;return Ja((1+g)/(1-g)*za((1-l)/(1+l),O))/2}function f(g){return parseFloat(g)*W}function c(g){g=za(Math.E,-g);for(var l=ia-2*ba(g),p=o(l,g),r=0;r<ra&&$(l-p)>ta;){l=p;p=o(l,g);r++}return p*Q}function d(g){return g%360*Q}function j(g,l){var p=null;for(var r in ka)if(l){if(r==l&&ka[r][g]){p=ka[r];break}}else if(ka[r][g]){p=
ka[r];break}return p}function o(g,l){var p=O*ja(g);return ia-2*ba(l*za((1-p)/(1+p),O/2))}function B(g,l,p,r){l=q(l);g.add(r(l,p));return l.length}function q(g){var l=g?g.length:0,p=Array(l);for(l=l;l--;)p[l]=Ra.Position.init(g[l][1],g[l][0]);return Ra.Position.vectorize(p,gb)}function L(g,l,p){return new Ea(g,l,p)}var ca=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],W=Math.PI/180,Q=180/Math.PI,la=ia,Ha=-la,K=-qa,O=0.08181919084262157,ta=1.0E-7,ra=12,oa=
null,Ba={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},aa=function(){function g(a){return a?p(a.lat,a.lon):null}function l(a){return!a||a.lat===0&&a.lon===0}function p(a,e){return{lat:parseFloat(a?a:0),lon:parseFloat(e?e:0)}}function r(a){if(a)if(y(a.lat,P))return g(a);else{if(a.split)for(var e=[" ",","],i=0;i<e.length;i++){var t=a.split(e[i]);if(t.length===2)return p(t[0],t[1])}}else return p();return null}return{calcDistance:function(a,e){if(l(a)||
l(e))return 0;var i=(e.lat-a.lat)*W>>1,t=(e.lon-a.lon)*W>>1;i=ja(i)*ja(i)+T(a.lat*W)*T(e.lat*W)*ja(t)*ja(t);return 6371*2*Ca(Ga(i),Ga(1-i))},copy:g,empty:l,equal:function(a,e){return a&&e&&a.lat==e.lat&&a.lon==e.lon},fromMercatorPixels:function(a,e){return p(c(e),d(a))},generalize:function(a,e,i){var t=a.length,H=[],Z=null;i||(i=250);i/=1E3;COG.info("generalizing positions, must include "+e.length+" positions");for(var ga=t;ga--;)if(ga===0)H.unshift(a[ga]);else{var Fa=!Z||aa.inArray(a[ga],e)?i:aa.calcDistance(Z,
a[ga]);if(a[ga]&&Fa>=i){H.unshift(a[ga]);Z=a[ga]}}COG.info("generalized "+t+" positions into "+H.length+" positions");return H},inArray:function(a,e){for(var i=aa.equal,t=e.length;t--;)if(i(a,e[t]))return true;return false},inBounds:function(a,e){var i=!(aa.empty(a)||aa.empty(e));return i=(i=i&&a.lat>=e.min.lat&&a.lat<=e.max.lat)&&a.lon>=e.min.lon&&a.lon<=e.max.lon},init:p,offset:function(a,e,i){var t=a.lat*W;a=a.lon*W;e=t+e/6371;i=va(ja(i/6371)/T(t));i=a+i;e=(e+ia)%Math.PI-ia;i%=qa;return p(e*Q,
i*Q)},parse:r,parseArray:function(a){var e=a.length,i=Array(e);for(e=e;e--;)i[e]=r(a[e]);return i},toMercatorPixels:function(a){return T5.XY.init(f(a.lon),h(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,e){function i(){for(var ga=0,Fa=e.chunkSize,sa=t;sa--;){H[sa]=T5.GeoXY.init(a[sa]);ga+=1;if(ga>Fa)break}t=sa;if(t<=0)e.callback&&e.callback(H);else animFrame(i)}var t=a.length,H=Array(t);e=COG.extend({chunkSize:500,async:true,callback:null},e);if(!e.async){for(var Z=
t;Z--;)H[Z]=T5.GeoXY.init(a[Z]);return H}animFrame(i);return null}}}(),Ma=function(){function g(a,e,i){var t=T5.XY.init(0,e.lat-a.lat);t.x=(i||y(i,Aa))&&a.lon>e.lon?360-a.lon+e.lon:e.lon-a.lon;return t}function l(a,e){return Ma.init(aa.init(a.min.lat-e,a.min.lon-e%360),aa.init(a.max.lat+e,a.max.lon+e%360))}function p(a){var e=g(a.min,a.max);return aa.init(a.min.lat+(e.y>>1),a.min.lon+(e.x>>1))}function r(a,e){return{min:aa.parse(a),max:aa.parse(e)}}return{calcSize:g,createBoundsFromCenter:function(a,
e){var i=e/6371,t=a.lat*W,H=a.lon*W,Z=t-i,ga=t+i;if(Z>Ha&&ga<la){t=va(ja(i)/T(t));i=(H-t)%qa;H=(H+t)%qa}else{Z=ua(Z,Ha);ga=X(ga,la);i=K;H=qa}return Ma.init(aa.init(Z*Q,i*Q),aa.init(ga*Q,H*Q))},expand:l,forPositions:function(a,e){var i=null,t=T5.ticks();e||(e="auto");for(var H=a.length;H--;)if(i){var Z=g(i.min,a[H],false),ga=g(a[H],i.max,false);if(Z.x<0)i.min.lon=a[H].lon;if(Z.y<0)i.min.lat=a[H].lat;if(ga.x<0)i.max.lon=a[H].lon;if(ga.y<0)i.max.lat=a[H].lat}else i=r(a[H],a[H]);if(e){if(e=="auto"){H=
g(i.min,i.max);e=ua(H.x,H.y)*0.3}i=l(i,e)}COG.trace("calculated bounds for "+a.length+" positions",t);return i},getCenter:p,getGeoHash:function(a){var e=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+e+", max hash = "+a)},getZoomLevel:function(a,e){var i=p(a);i=X(ma($(i.lat)*0.05),ca.length);var t=ca[i],H=g(a.min,a.max);i=ya(Ja(ca[3]*e.height/H.y)/Ja(2));t=ya(Ja(t*e.width/H.x)/Ja(2));return X(isNaN(i)?1E3:i,isNaN(t)?1E3:t)},init:r,isEmpty:function(a){return!a||
aa.empty(a.min)||aa.empty(a.max)},toString:function(a){return"min: "+aa.toString(a.min)+", max: "+aa.toString(a.max)}}}(),Za=function(){var g=/^(\d+).*$/,l=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(p,r){g.lastIndex=-1;if(g.test(p))for(var a=p.replace(g,"$1"),e=r.split(","),i=0;i<e.length;i++){l.lastIndex=-1;if(l.test(e[i])){var t=l.exec(e[i]);if(a>=parseInt(t[1],10)&&a<=parseInt(t[2],10))return true}else if(a==e[i])return true}return false},normalize:function(p){if(!p)return"";p=p.toUpperCase();
if(!oa){var r=[];for(var a in Ba)r.push(a);oa=RegExp("(\\s)("+r.join("|")+")(\\s|$)","i")}oa.lastIndex=-1;if(r=oa.exec(p))p=p.replace(oa,"$1"+Ba[r[2]]);return p},toString:function(p){return p.streetDetails+" "+p.location}}}(),Ka=M.GeoXY=function(){function g(r,a){if(r.length){for(var e,i,t,H,Z=r.length;Z--;){g(r[Z],a);e=y(e,Aa)||r.x<e?r.x:e;i=y(i,Aa)||r.y<i?r.y:i;t=y(t,Aa)||r.x>t?r.x:t;H=y(H,Aa)||r.y>H?r.y:H}return Da.init(e,i,H,H)}else if(r.mercXY){e=r.mercXY;r.x=(e.x+Math.PI)/a|0;r.y=(Math.PI-e.y)/
a|0;r.rpp=a}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return r}function l(r,a){if(r.length)for(var e=r.length;e--;)l(r[e],a);else{r.mercXY=V.init(r.x*a-Math.PI,Math.PI-r.y*a);r.pos=aa.fromMercatorPixels(r.mercXY.x,r.mercXY.y)}return r}function p(r,a,e){r.pos=a;r.mercXY=aa.toMercatorPixels(a);(e=y(e,P)?e:r.rpp)&&g(r,e)}return{init:function(r,a){var e=V.init();p(e,r,a);return e},sync:g,syncPos:l,toPos:function(r,a){a=a?a:_self.rpp;return aa.fromMercatorPixels(r.x*a-Math.PI,Math.PI-
r.y*a)},updatePos:p}}(),ka={},La=function(){return{bestResults:function(g,l){l||(l=20);for(var p=g.length>0?g[0]:null,r=[],a=0;a<g.length;a++)if(p&&g[a]&&p.matchWeight-g[a].matchWeight<=l)r.push(g[a]);else break;return r}}}(),ab=function(g){g=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},g);return COG.extend(g,{toString:function(){return g.caption+(g.matchWeight?" ("+g.matchWeight+")":"")}})},Pa=function(){function g(a,e){var i=new T5.ShapeLayer;e.geometry&&aa.vectorize(e.geometry,
{callback:function(t){i.add(new T5.Line(t,{style:"waypoints",simplify:true}));a.setLayer("route",i)}})}function l(a){for(var e=p.Unknown,i=r,t=0;t<i.length;t++){i[t].regex.lastIndex=-1;var H=i[t].regex.exec(a);if(H){e=i[t].customCheck?i[t].customCheck(a,H):i[t].turnType;break}}return e}var p={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},r=function(){var a=[];a.push({regex:/continue/i,turnType:p.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(e,i){return/bear/i.test(i[1])?p.TurnLeftSlight:p.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(e,i){return/bear/i.test(i[1])?p.TurnRightSlight:p.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,
turnType:p.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:p.Ramp});a.push({regex:/take.*?exit/i,turnType:p.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(e,i){return/right/i.test(i[1])?p.UTurnRight:p.UTurnLeft}});a.push({regex:/proceed/i,turnType:p.Start});a.push({regex:/arrive/i,turnType:p.Arrive});a.push({regex:/fell\sthrough/i,turnType:p.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,
generalize:false},a);var e=b("route");e&&e.route(a,function(i){if(a.generalize)i.geometry=aa.generalize(i.geometry,i.getInstructionPositions());if(a.map){g(a.map,i);a.autoFit&&a.map.gotoBounds(i.boundingBox)}a.success&&a.success(i)})},createMapOverlay:g,parseTurnType:l,TurnType:p,Instruction:function(a){var e=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),i=a.description;i=i.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");e.description=i;if(!a.turnType)a.turnType=
l(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Ma.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var e=[],i=0;i<a.instructions.length;i++)a.instructions[i].position&&e.push(a.instructions[i].position);return e}},a)}}}(),jb="featurecollection",ib="feature",gb={async:false},Ya={processor:null,group:"shapes",layerClass:hb},kb={point:COG.extend({},Ya,{processor:function(g,
l,p,r){l=q([l.coordinates],gb);if(l.length>0)if(p=r.marker(l[0],p)){g.add(p);return l.length}},group:"markers",layerClass:hb}),linestring:COG.extend({},Ya,{processor:function(g,l,p,r){l=q(l&&l.coordinates?l.coordinates:[]);return B(g,l,p,r.line)}}),multilinestring:COG.extend({},Ya,{processor:function(g,l,p,r){l=l&&l.coordinates?l.coordinates:[];for(var a=0,e=l.length;e--;)a+=B(g,l[e],p,r.line);return a}}),polygon:COG.extend({},Ya,{processor:function(g,l,p,r){l=l&&l.coordinates?l.coordinates:[];if(l.length>
0)return B(g,l[0],p,r.poly);return 0}}),multipolygon:COG.extend({},Ya,{processor:function(g,l,p,r){l=l&&l.coordinates?l.coordinates:[];for(var a=0,e=0;e<l.length;e++)a+=B(g,l[e][0],p,r.poly);return a}})},Ea=function(g,l,p,r){function a(N,fa){var wa=N.processor,Ia=Z+N.group,Qa=COG.extend({},N,p,{properties:fa.properties});if(wa){var Ua=I[Ia];if(!Ua){Ua=new N.layerClass({id:Ia});I[Ia]=Ua}globalLayers=I;return wa(Ua,fa.data,Qa,r)}return 0}function e(N,fa){var wa=N&&N.type?N.type.toLowerCase():null;return wa&&
wa===ib?e(N.geometry,N.properties):{type:wa,isCollection:wa?wa===jb:false,definition:kb[wa],data:N,properties:fa?fa:N.properties}}function i(N){var fa=0,wa=COG.extend({},p),Ia=ga;N=N?N:(new Date).getTime();if(!sa){for(;Ia<Fa;Ia++){N=e(H?H(g[Ia]):g[Ia]);var Qa=null;if(N.isCollection){wa.layerPrefix=Z+R++ +"-";sa=L(N.data.features,function(Ua){sa=null;for(var cb in Ua)I[cb]=Ua[cb]},wa);Qa+=1}else if(N.definition)Qa=a(N.definition,N);fa+=Qa?Qa:1;if(fa>=t)break}ga=Ia+1;if(sa||ga<Fa)animFrame(i);else l&&
l(I)}}p=COG.extend({vectorsPerCycle:Ra.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},p);r=COG.extend({marker:function(N){return new E({xy:N})},line:function(N,fa){return new z(N,COG.extend({},p,fa))},poly:function(N,fa){return new z(N,COG.extend({fill:true},p,fa))}},r);var t=p.vectorsPerCycle,H=p.rowPreParse,Z=p.layerPrefix,ga=0,Fa=0,sa=null,R=0,I={};if(g){y(g,"array")||(g=[g]);Fa=g.length;animFrame(i)}};M.GeoJSON={parse:L};M.Map=function(g){function l(I){try{var N=Ra.Position.init(I.coords.latitude,
I.coords.longitude),fa=I.coords.accuracy/1E3;R.trigger("locationUpdate",I,fa);if(ga){if(!H){H=new Ra.UI.LocationOverlay({pos:N,accuracy:fa});H.update(R.getTileLayer());R.setLayer("location",H)}var wa=Ra.BoundingBox.createBoundsFromCenter(N,Math.max(fa,1));R.gotoBounds(wa)}else{H.pos=N;H.accuracy=fa;H.update(R.getTileLayer());a(N,null,COG.easing("sine.out"))}ga=false}catch(Ia){COG.exception(Ia)}}function p(I){COG.info("caught location tracking error:",I)}function r(I,N,fa){R.setZoomLevel(N);a(I,fa)}
function a(I,N,fa,wa){I=Ka.init(I,Ra.radsPerPixel(R.getZoomLevel()));R.updateOffset(I.x-(R.width>>1),I.y-(R.height>>1),fa,wa,function(){R.refresh();R.trigger("boundsChange",R.getBoundingBox());N&&N(R)})}g=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18,pannable:true,scalable:true},g);var e={NONE:0,SINGLE:1,WATCH:2},i=V.init(),t=e.NONE,H=null,Z=0,ga=true,Fa=0,sa=g.tapExtent;g.adjustScaleFactor=function(I){return Math.pow(2,(I<1?Math.floor:Math.ceil)(Math.log(I)))};
var R=COG.extend(new yb(g),{getBoundingBox:function(){var I=R.getViewport();return I?Ra.BoundingBox.init(Ka.toPos(V.init(I.x1,I.y2),Fa),Ka.toPos(V.init(I.x2,I.y1),Fa)):null},getCenterPosition:function(){var I=R.getViewport();if(I){I=V.init(I.x1+(I.width>>1),I.y1+(I.height>>1));return Ka.toPos(I,Fa)}return null},gotoBounds:function(I,N){var fa=Ra.BoundingBox.getZoomLevel(I,R.getViewport());r(Ra.BoundingBox.getCenter(I),fa,N)},gotoPosition:r,panToPosition:a,syncXY:function(I,N){return(N?Ka.syncPos:
Ka.sync)(I,Fa)},locate:function(){R.trackStart(e.SINGLE);setTimeout(R.trackCancel,1E4)},trackStart:function(I){if(navigator.geolocation&&!Z){t=I?I:e.WATCH;ga=true;Z=navigator.geolocation.watchPosition(l,p,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){Z&&navigator.geolocation&&navigator.geolocation.clearWatch(Z);R.removeLayer("location");H=null;t=e.NONE;Z=0},animateRoute:function(I,N,fa,wa){var Ia=R.getLayer("route");if(Ia)(I=Ia.getAnimation(I,N,fa,wa))&&I.addToView(R)}});
R.bind("pan",function(){t===e.SINGLE&&R.trackCancel()});R.bind("tap",function(I,N,fa,wa){I=Ka.toPos(wa,Fa);var Ia=Ka.toPos(V.offset(wa,-sa,sa),Fa);wa=Ka.toPos(V.offset(wa,sa,-sa),Fa);R.trigger("geotap",N,fa,I,Ma.init(Ia,wa))});R.bind("refresh",function(){if(V.absSize(V.diff(i,R.getOffset()))>g.boundsChangeThreshold){i=V.copy(R.getOffset());R.trigger("boundsChange",R.getBoundingBox())}});R.bind("zoomLevelChange",function(I,N){var fa;Fa=Ra.radsPerPixel(N);fa=qa/Fa|0;R.setMaxOffset(fa,fa,true,false);
R.resetScale();R.triggerAll("resync",R);R.refresh()});return R};M.GeoShape=function(g,l){l=COG.extend({autoParse:true},l);for(var p=Array(g.length),r=l.autoParse,a=T5.Geo.Position.parse,e=g.length;e--;)p[e]=T5.GeoXY.init(r?a(g[e]):g[e]);return new T5.Poly(p,l)};M.LocationOverlay=function(g){g=COG.extend({pos:null,accuracy:null,zindex:90},g);var l=new Image,p=T5.XY.init(),r=T5.XY.init(),a=null;l.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
l.onload=function(){p=T5.XY.init(l.width>>1,l.height>>1)};var e=COG.extend(new T5.ViewLayer(g),{pos:g.pos,accuracy:g.accuracy,drawAccuracyIndicator:false,draw:function(i,t){var H=r.x-t.x,Z=r.y-t.y;if(a){i.fillStyle="rgba(30, 30, 30, 0.2)";i.beginPath();i.arc(H,Z,a,0,Math.PI*2,false);i.fill()}l.complete&&l.width>0&&i.drawImage(l,H-p.x,Z-p.y,l.width,l.height)},update:function(i){if(i){a=i.getPixelDistance(e.accuracy)>>1;r=i.getGridXYForPosition(e.pos)}}});e.bind("gridUpdate",function(i,t){e.update(t)});
return e};return{distanceToString:function(g){if(g>1E3)return~~(g/10)/100+" km";return g?g+" m":""},dist2rad:function(g){return g/6371},getEngine:b,lat2pix:h,lon2pix:f,pix2lat:c,pix2lon:d,radsPerPixel:function(g){return qa/(256<<g)},Position:aa,BoundingBox:Ma,Radius:function(g,l){return{distance:parseInt(g,10),uom:l}},Address:function(g){return g=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},g)},A:Za,GeocodeFieldWeights:{streetDetails:50,location:50},
AddressCompareFns:{},Engine:function(g){if(!g.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var l=COG.extend({remove:function(){delete ka[l.id]}},g);return ka[l.id]=l},Search:La,GeoSearchResult:ab,LocationSearch:function(g){function l(i,t){navigator.geolocation.clearWatch(r);r=0;if(a){clearTimeout(a);a=0}t&&t([i],g)}function p(i){COG.info("caught location tracking error:",i)}g=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},
g);var r=0,a=0,e=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(i,t){if(navigator.geolocation&&!r){r=navigator.geolocation.watchPosition(function(H){var Z=aa.init(H.coords.latitude,H.coords.longitude);H=new ab({id:1,caption:"Current Location",pos:Z,accuracy:H.coords.accuracy/1E3,matchWeight:100});if(!e||H.accuracy<e.accuracy)e=H;if(!g.requiredAccuracy||e.accuracy<g.requiredAccuracy)l(e,t)},p,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)a=setTimeout(function(){e&&
l(e,t)},g.searchTimeout)}}},g))},Routing:Pa}}()})(T5);
