COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var ia=arguments[0]||{},ra,L=1,J=arguments.length;L<J;L++)if((ra=arguments[L])!==null)for(var y in ra){var A=ra[y];if(ia!==A)if(A!==undefined)ia[y]=A}return ia};
(function(){var ia=Object.prototype.hasOwnProperty,ra=0,L={};L.toID=function(J){return J.replace(/\s/g,"-")};L.objId=function(J){return(J?J:"obj")+ra++};L.isFunction=function(J){return toString.call(J)==="[object Function]"};L.isArray=function(J){return toString.call(J)==="[object Array]"};L.isPlainObject=function(J){if(!J||toString.call(J)!=="[object Object]"||J.nodeType||J.setInterval)return false;if(J.constructor&&!ia.call(J,"constructor")&&!ia.call(J.constructor.prototype,"isPrototypeOf"))return false;
var y;for(y in J);return y===undefined||ia.call(J,y)};L.isEmptyObject=function(J){for(var y in J)return false;return true};L.isXmlDocument=function(J){return toString.call(J)==="[object Document]"};L.contains=function(J,y){var A=J,E=arguments,W=1;if(y&&module.isArray(y)){E=y;W=0}for(W=W;W<E;W++)A=A&&typeof foo[E[W]]!=="undefined";return A};L.formatStr=function(J){if(arguments.length<=1)return J;for(var y=arguments.length-2,A=0;A<=y;A++)J=J.replace(RegExp("\\{"+A+"\\}","gi"),arguments[A+1]);return J};
L.wordExists=function(J,y){var A="";if(y.toString)y=y.toString();for(var E=0;E<y.length;E++)A+=!/\w/.test(y[E])?"\\"+y[E]:y[E];return RegExp("(^|\\s|\\,)"+A+"(\\,|\\s|$)","i").test(J)};COG.extend(COG,L)})();
(function(){function ia(A){return typeof console!=="undefined"?function(){console[A](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ra=window.console&&window.console.markTimeline,L=ia("error"),J=ia("info"),y=function(){return ra?function(A,E){console.markTimeline(A+(E?": "+((new Date).getTime()-E)+"ms":""))}:function(){}}();COG.extend(COG,{trace:y,debug:ia("debug"),info:J,warn:ia("warn"),error:L,exception:function(A){if(L)for(var E in A)J("ERROR DETAIL: "+
E+": "+A[E])}})})();
COG.Loopage=function(){function ia(x){return COG.extend({id:A++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},x)}function ra(x){W.push(x);L()}function L(){ua&&clearTimeout(ua);ua=setTimeout(J,0);Ba=true}function J(){for(var x,B=(new Date).getTime(),H=E.length;W.length>0;){var ca=W.shift();for(x=H;x--;)if(E[x].id===ca){E.splice(x,1);break}Ba=true;H=E.length}if(Ba){ea=y;for(x=H;x--;)ea=E[x].frequency<ea?E[x].frequency:ea}for(x=H;x--;){ca=B-E[x].lastTick;if(E[x].lastTick===0||ca>=
E[x].frequency){E[x].execute(B,E[x]);E[x].lastTick=B;E[x].single&&E[x].trigger("complete")}}ua=H?setTimeout(J,ea):0}var y=6E4,A=0,E=[],W=[],ua=0,ea=y,Ba=true;return{join:function(x){var B=new ia(x);if(B.after>0)B.lastTick=(new Date).getTime()+B.after;COG.observable(B);B.bind("complete",function(){ra(B.id)});E.unshift(B);L();return B},leave:ra}}();
(function(){function ia(L,J){var y=L.obsHandlers;y[J]||(y[J]=[]);return y[J]}var ra=0;COG.observable=function(L){if(!L)return null;if(!L.obsHandlers)L.obsHandlers={};if(!(L.bind||L.trigger||L.unbind)){L.bind=function(J,y){var A="callback"+ra++;ia(L,J).unshift({fn:y,id:A});return A};L.trigger=function(J){var y=ia(L,J),A={cancel:false,name:J,tickCount:(new Date).getTime()},E;if(!y)return null;E=Array.prototype.slice.call(arguments,1);L.eventInterceptor&&L.eventInterceptor(J,A,E);E.unshift(A);for(var W=
y.length;W--&&!A.cancel;)y[W].fn.apply(self,E);return A};L.unbind=function(J,y){if(typeof J==="undefined")L.obsHandlers={};else for(var A=ia(L,J),E=0;A&&E<A.length;E++)if(A[E].id===y){A.splice(E,1);break}return L}}return L}})();
(function(){function ia(y,A){y[A]||(y[A]=function(E){return y.configure(A,E)})}function ra(y){y.gtConfId="configurable"+J++;y.gtConfig={};y.gtConfigFns=[];return y.gtConfig}var L={},J=0;COG.paramTweaker=function(y,A,E){return function(W,ua){if(typeof ua!=="undefined"){if(W in y)y[W]=ua;E&&W in E&&E[W](W,ua)}else return A&&W in A?A[W](W):y[W]}};COG.configurable=function(y,A,E,W){if(y){y.gtConfId||ra(y);var ua=y.gtConfId,ea=y.gtConfig,Ba=y.gtConfigFns;L[ua]=y;Ba.push(E);for(E=A.length;E--;){ea[A[E]]=
true;W&&ia(y,A[E])}if(!y.configure)y.configure=function(x,B){if(ea[x]){for(var H=Ba.length;H--;){var ca=Ba[H](x,B);if(typeof ca!=="undefined")return ca}return L[ua]}return null}}}})();
(function(){function ia(y){var A=document.createElement("script"),E=false;A.src=y;A.async=true;A.onload=A.onreadystatechange=function(){if(!E&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){E=true;A.onload=A.onreadystatechange=null;A&&A.parentNode&&A.parentNode.removeChild(A)}};L||(L=document.getElementsByTagName("head")[0]);L.appendChild(A)}var ra=0,L,J=this;COG.jsonp=function(y,A,E){y+=y.indexOf("?")>=0?"&":"?";var W="json"+ ++ra;J[W]=function(ua){A(ua);J[W]=null;
try{delete J[W]}catch(ea){}};ia(y+(E?E:"callback")+"="+W);return W}})();
(function(){function ia(f){if(x)return ea.length;x=true;try{for(var s=0;s<ea.length;)if(ea[s].isComplete()){ea[s].triggerComplete(false);ea.splice(s,1)}else{ea[s].update(f);s++}}finally{x=false}ea.length===0&&Ba.trigger("complete");return ea.length}function ra(){if(!Ba){Ba=COG.Loopage.join({execute:ia,frequency:20});Ba.bind("complete",function(){Ba=null})}}var L=1.70158,J=Math.PI/2,y=Math.abs,A=Math.pow,E=Math.sin,W=Math.asin,ua=Math.cos,ea=[],Ba=null,x=false,B={linear:function(f,s,t,C){return t*
f/C+s},backin:function(f,s,t,C){return t*(f/=C)*f*((L+1)*f-L)+s},backout:function(f,s,t,C){return t*((f=f/C-1)*f*((L+1)*f+L)+1)+s},backinout:function(f,s,t,C){return(f/=C/2)<1?t/2*f*f*(((L*=1.525)+1)*f-L)+s:t/2*((f-=2)*f*(((L*=1.525)+1)*f+L)+2)+s},bouncein:function(f,s,t,C){return t-B.bounceout(C-f,0,t,C)+s},bounceout:function(f,s,t,C){return(f/=C)<1/2.75?t*7.5625*f*f+s:f<2/2.75?t*(7.5625*(f-=1.5/2.75)*f+0.75)+s:f<2.5/2.75?t*(7.5625*(f-=2.25/2.75)*f+0.9375)+s:t*(7.5625*(f-=2.625/2.75)*f+0.984375)+
s},bounceinout:function(f,s,t,C){return f<C/2?B.bouncein(f*2,0,t,C)/2+s:B.bounceout(f*2-C,0,t,C)/2+t/2+s},cubicin:function(f,s,t,C){return t*(f/=C)*f*f+s},cubicout:function(f,s,t,C){return t*((f=f/C-1)*f*f+1)+s},cubicinout:function(f,s,t,C){if((f/=C/2)<1)return t/2*f*f*f+s;return t/2*((f-=2)*f*f+2)+s},elasticin:function(f,s,t,C,P,Y){if(f==0)return s;if((f/=C)==1)return s+t;Y||(Y=C*0.3);if(!P||P<y(t)){P=t;t=Y/4}else t=Y/TWO_PI*W(t/P);return-(P*A(2,10*(f-=1))*E((f*C-t)*TWO_PI/Y))+s},elasticout:function(f,
s,t,C,P,Y){var na;if(f==0)return s;if((f/=C)==1)return s+t;Y||(Y=C*0.3);if(!P||P<y(t)){P=t;na=Y/4}else na=Y/TWO_PI*W(t/P);return P*A(2,-10*f)*E((f*C-na)*TWO_PI/Y)+t+s},elasticinout:function(f,s,t,C,P,Y){var na;if(f==0)return s;if((f/=C/2)==2)return s+t;Y||(Y=C*0.3*1.5);if(!P||P<y(t)){P=t;na=Y/4}else na=Y/TWO_PI*W(t/P);if(f<1)return-0.5*P*A(2,10*(f-=1))*E((f*C-na)*TWO_PI/Y)+s;return P*A(2,-10*(f-=1))*E((f*C-na)*TWO_PI/Y)*0.5+t+s},quadin:function(f,s,t,C){return t*(f/=C)*f+s},quadout:function(f,s,t,
C){return-t*(f/=C)*(f-2)+s},quadinout:function(f,s,t,C){if((f/=C/2)<1)return t/2*f*f+s;return-t/2*(--f*(f-2)-1)+s},sinein:function(f,s,t,C){return-t*ua(f/C*J)+t+s},sineout:function(f,s,t,C){return t*E(f/C*J)+s},sineinout:function(f,s,t,C){return-t/2*(ua(Math.PI*f/C)-1)+s}},H=COG.Tween=function(f){f=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:ca("sine.out"),complete:null},f);var s=(new Date).getTime(),t=[],C=false,P=0,Y=0,na={isComplete:function(){return C},
triggerComplete:function(Ia){f.complete&&f.complete(Ia)},update:function(Ia){try{var qa=f.tweenFn(Ia-s,P,Y,f.duration);if(f.target)f.target[f.property]=qa;for(var Ka=t.length;Ka--;)t[Ka](qa,void 0);if(C=s+f.duration<=Ia){if(f.target)f.target[f.property]=f.tweenFn(f.duration,P,Y,f.duration);for(var Ja=t.length;Ja--;)t[Ja](qa,true)}}catch(va){COG.exception(va)}},requestUpdates:function(Ia){t.push(Ia)}};P=f.target&&f.property&&f.target[f.property]?f.target[f.property]:f.startValue;if(typeof f.endValue!==
"undefined")Y=f.endValue-P;if(Y==0)C=true;ra();return na};COG.tweenValue=function(f,s,t,C,P){f=new H({startValue:f,endValue:s,tweenFn:t,complete:C,duration:P});ea.push(f);return f};COG.tween=function(f,s,t,C,P,Y){f=new H({target:f,property:s,endValue:t,tweenFn:C,duration:Y,complete:P});ea.push(f);return f};COG.endTweens=function(f){if(!x){x=true;try{for(var s=0;s<ea.length;)if(!f||f(ea[s])){ea[s].triggerComplete(true);ea.splice(s,1)}else s++}finally{x=false}}};COG.getTweens=function(){return[].concat(ea)};
var ca=COG.easing=function(f){return B[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(f,s){B[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]=s}})();
INTERACT=function(){function ia(x){return function(B,H,ca){(ca?ca:x?document.body:document).addEventListener(B,H,false)}}function ra(x){return function(B,H,ca){(ca?ca:x?document.body:document).removeEventListener(B,H,false)}}function L(x,B,H){(H?H:document).attachEvent("on"+x,B)}function J(x,B,H){(H?H:document).detachEvent("on"+x,B)}function y(x,B){return{x:x?x:0,y:B?B:0,count:1}}function A(x,B){ea.push(COG.extend({handler:null,checks:{},type:x},B))}function E(x){var B=0,H=0;if(x.offsetParent){do{B+=
x.offsetLeft;H+=x.offsetTop;x=x.offsetParent}while(x)}return{x:B,y:H}}function W(x,B){return{x:x.x-(B?B.x:0),y:x.y-(B?B.y:0)}}function ua(x){if(x.preventDefault){x.preventDefault();x.stopPropagation()}else x.cancelBubble&&x.cancelBubble()}var ea=[],Ba=function(x,B,H){function ca(P,Y,na,Ia){f.trigger("pan",Ia.x,Ia.y)}H=COG.extend({binder:null,unbinder:null,observable:null},H);for(var f=H.observable,s=[],t={bind:function(){return f.bind.apply(null,arguments)},pannable:function(P){COG.extend({inertia:true},
P);f.bind("pointerMove",ca);return t},unbind:function(){f.unbind();for(var P=0;P<s.length;P++)s[P].unbind();return t}},C=0;C<B.length;C++)s.push(B[C](x,f,H));return t};A("pointer",{handler:function(x,B,H){function ca(w){if(P(w))if(qa=C(w)){x.style.cursor="move";ua(w);N=w.pageX?w.pageX:w.screenX;oa=w.pageY?w.pageY:w.screenY;Ka=y(N,oa);Ja=E(x);B.trigger("pointerDown",Ka,W(Ka,Ja))}}function f(w){va=w.pageX?w.pageX:w.screenX;Ca=w.pageY?w.pageY:w.screenY;qa&&P(w)&&Y("pointerMove")}function s(w){if(qa&&
C(w)){qa=false;if(P(w)){x.style.cursor="default";Y("pointerUp")}}}function t(w){if(P(w)){var Aa;w=w||window.event;if(w.detail)Aa=w.axis===2?-w.detail*na:0;else{Aa=w.wheelDeltaY?w.wheelDeltaY:w.wheelDelta;if(window.opera)Aa=-Aa}if(Aa!==0){var Da=y(va,Ca);B.trigger("zoom",Da,W(Da,E(x)),Aa/Ia);ua(w);w.returnValue=false}}}function C(w){w=w||window.event;return(w.which||w.button)==1}function P(w){for(w=w.target?w.target:w.srcElement;w&&w.nodeName&&w.nodeName.toUpperCase()!="CANVAS";)w=w.parentNode;return w&&
w===x}function Y(w){var Aa=y(va,Ca);B.trigger(w,Aa,W(Aa,Ja),y(va-N,Ca-oa));N=va;oa=Ca}H=COG.extend({inertia:false},H);var na=120,Ia=na*8,qa=false,Ka,Ja,va,Ca,N,oa;H.binder("mousedown",ca,false);H.binder("mousemove",f,false);H.binder("mouseup",s,false);H.binder("click",function(w){if(P(w)){w=y(w.pageX?w.pageX:w.screenX,w.pageY?w.pageY:w.screenY);B.trigger("tap",w,W(w,E(x)))}},false);H.binder("dblclick",function(w){COG.info("captured double click");if(P(w)){w=y(w.pageX?w.pageX:w.screenX,w.pageY?w.pageY:
w.screenY);COG.info("captured double click + target matched");B.trigger("doubleTap",w,W(w,E(x)))}},false);H.binder("mousewheel",t,document);H.binder("DOMMouseScroll",t,document);return{unbind:function(){H.unbinder("mousedown",ca,false);H.unbinder("mousemove",f,false);H.unbinder("mouseup",s,false);H.unbinder("mousewheel",t,document);H.unbinder("DOMMouseScroll",t,document)}}},checks:{touch:false}});A("pointer",{handler:function(x,B,H){function ca(R){if(R.count<2)return 0;var Z=R.x-R.next.x;R=R.y-R.next.y;
return~~Math.sqrt(Z*Z+R*R)}function f(R,Z,da){Z=Z?Z:0;da=da?da:0;for(var Ma={x:R.x-Z,y:R.y-da,id:R.id,count:R.count},Fa=Ma;R.next;){R=R.next;Fa=Fa.next={x:R.x-Z,y:R.y-da,id:R.id}}return Ma}function s(R,Z){var da=R[Z?Z:"touches"],Ma,Fa;if(da.length===0)return null;Fa=Ma={x:da[0].pageX,y:da[0].pageY,id:da[0].identifier,count:da.length};for(var Pa=1,Ua=da.length;Pa<Ua;Pa++)Fa=Fa.next={x:da[Pa].pageX,y:da[Pa].pageY,id:da[Pa].identifier};return Ma}function t(R){var Z=R.target?R.target:R.srcElement;if(Z&&
Z===x){va=E(x);Z=s(R,"changedTouches");var da=f(Z,va.x,va.y);if(!N){Ca=qa;B.trigger("pointerDown",Z,da)}Da&&B.trigger("pointerDownMulti",Z,da);N=s(R);if(N.count>1)w=ca(N);Xa=1;Aa=f(N)}}function C(R){var Z=R.target?R.target:R.srcElement;if(Z&&Z===x){R.preventDefault();oa=s(R);if(Ca==qa)Ca=Math.abs(N.x-oa.x)>na||Math.abs(N.y-oa.y)>na?Ia:qa;if(Ca!=qa){Ca=oa.count>1?Ja:Ka;if(Ca==Ja)if(N.count===1){N=f(oa);w=ca(N)}else{R=ca(oa);if(Math.abs(w-R)<Y)Ca=Ka;else{Z=oa.x;var da=oa.next.x,Ma=oa.y,Fa=oa.next.y,
Pa=Ma<Fa?Ma:Fa;Z={x:(Z<da?Z:da)+(Math.abs(Z-da)>>1),y:Pa+(Math.abs(Ma-Fa)>>1)};R=R/w;da=R-Xa;B.trigger("zoom",Z,W(Z,va),da);Xa=R}}Ca==Ka&&B.trigger("pointerMove",oa,f(oa,va.x,va.y),y(oa.x-Aa.x,oa.y-Aa.y));Da&&B.trigger("pointerMoveMulti",oa,f(oa,va.x,va.y))}Aa=f(oa)}}function P(R){var Z=R.target?R.target:R.srcElement;if(Z&&Z===x){Z=s(R,"changedTouches");var da=f(Z,va.x,va.y);oa=s(R);if(!oa){Ca===qa&&B.trigger("pointerTap",Z,da);B.trigger("pointerUp",Z,da);N=null}Da&&B.trigger("pointerUpMulti",Z,da)}}
H=COG.extend({detailed:false,inertia:false},H);var Y=20,na=7,Ia=0,qa=1,Ka=2,Ja=3,va,Ca,N,oa,w,Aa,Da=H.detailed,Xa=1;H.binder("touchstart",t,false);H.binder("touchmove",C,false);H.binder("touchend",P,false);COG.info("initialized touch handler");return{unbind:function(){H.unbinder("touchstart",t,false);H.unbinder("touchmove",C,false);H.unbinder("touchend",P,false)}}},checks:{touch:true}});return{register:A,watch:function(x,B,H){B=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},B);capabilities=COG.extend({touch:"ontouchstart"in window},H);if(!B.observable){COG.info("creating observable");B.observable=COG.observable({});globalOpts=B}B.binder=B.isIE?L:ia(B.bindToBody);B.unbinder=B.isIE?J:ra(B.bindToBody);H=B.types;for(var ca=capabilities,f=[],s=ea.length;s--;){var t=ea[s],C=!H||H.indexOf(t.type)>=0,P=true;for(var Y in t.checks){var na=t.checks[Y];COG.info("checking "+Y+" capability. require: "+na+", capability = "+ca[Y]);P=P&&na===ca[Y]}if(C&&P)f[f.length]=
t.handler}return new Ba(x,f,B)}}}();
T5=function(){function ia(){return(new Date).getTime()}function ra(){for(;da.length>0;){var c=da.shift();document.location=c}Z=0}function L(c){for(var p=true,h=Ma.length;h--;)p=p&&c!=Ma[h];return p}function J(c,p){var h=[];for(var a in p)a&&h.push(a+"="+escape(p[a]));return"tile5://"+c+"/"+(h.length>0?"?"+h.join("&"):"")}function y(c,p){L(c)&&COG.info("would push url: "+J(c,p))}function A(c,p){if(L(c)){da.push(J(c,p));Z||(Z=setTimeout(ra,100))}}function E(c){return function(p,h,a){(a?a:c?document.body:
document).addEventListener(p,h,false)}}function W(c){return function(p,h,a){(a?a:c?document.body:document).removeEventListener(p,h,false)}}function ua(c,p,h){(h?h:document).attachEvent("on"+c,p)}function ea(c,p,h){(h?h:document).detachEvent("on"+c,p)}function Ba(){Da={base:{name:"Unknown",bindEvent:E(),unbindEvent:W(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:y,targetFps:null},ie:{name:"MSIE",
regex:/msie/i,bindEvent:ua,unbindEvent:ea,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:A,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:A},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:A},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:E(true),unbindEvent:W(true),supportsTouch:true,getScaling:function(){return 1/
window.devicePixelRatio},bridgeNotify:A},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:A}};Xa=[Da.froyo,Da.android,Da.ipod,Da.iphone,Da.ipad,Da.ie]}function x(){Da||Ba();if(!R){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<Xa.length;c++){var p=Xa[c];if(p.regex&&p.regex.test(navigator.userAgent)){R=COG.extend({},Da.base,p);COG.info("PLATFORM DETECTED AS: "+R.name);break}}if(!R){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
R=Da.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return R}function B(c,p){function h(d,j){if(d&&a!==d){var l=c.triggerAll("zoomLevelChange",d,j);if(l)a=d;return l}}p=COG.extend({initial:1,min:0,max:null,zoomAnimation:COG.easing("quad.out")},p);var a=p.initial;COG.extend(c,{getZoomLevel:function(){return a},setZoomLevel:h});c.bind("scale",function(d,j,l){var q=Math.log(j)/Math.LN2;COG.endTweens(function(v){return v.cancelOnInteract});d.cancel=!h(a+q,l);d.cancel||c.updateOffset(l.x*
j,l.y*j)})}function H(){for(var c=0,p=arguments.length;p--;){var h=vb[arguments[p].toUpperCase()];if(h)c|=h}return c}var ca=Math.PI*2,f=Math.PI/2,s=Math.abs,t=Math.min,C=Math.max,P=Math.pow,Y=Math.sqrt,na=Math.log,Ia=Math.round,qa=Math.sin,Ka=Math.asin,Ja=Math.cos,va=Math.atan,Ca=Math.atan2,N=function(){function c(a,d){return h(a.x-d.x,a.y-d.y)}function p(a,d){if(!d)d=a.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var j={edges:Array(d-1),
accrued:Array(d-1),total:0},l=0;l<d-1;l++){var q=c(a[l],a[l+1]);j.edges[l]=Y(q.x*q.x+q.y*q.y);j.accrued[l]=j.total+j.edges[l];j.total+=j.edges[l]}return j}function h(a,d){return{x:a?a:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var a=0,d=0,j=arguments.length;j--;){a+=arguments[j].x;d+=arguments[j].y}return h(a,d)},absSize:function(a){return C(s(a.x),s(a.y))},copy:function(a){return a?h(a.x,a.y):null},diff:c,distance:function(a,d){return p(a,d).total},
edges:p,equals:function(a,d){return a.x===d.x&&a.y===d.y},extendBy:function(a,d,j){var l=Ja(d)*j;d=qa(d)*j;return h(a.x-l,a.y-d)},floor:function(a){for(var d=Array(a.length),j=a.length;j--;)d[j]=h(~~a[j].x,~~a[j].y);return d},getRect:function(a){for(var d,j,l,q,v=a.length;v--;){var n=a[v];d=typeof d==="undefined"||n.x<d?n.x:d;j=typeof j==="undefined"||n.y<j?n.y:j;l=typeof l==="undefined"||n.x>l?n.x:l;q=typeof q==="undefined"||n.y>q?n.y:q}return w.init(d,j,l,q)},init:h,invert:function(a){return h(-a.x,
-a.y)},min:function(a,d){return h(a.x<d.x?a.x:d.x,a.y<d.y?a.y:d.y)},max:function(a,d){return h(a.x>d.x?a.x:d.x,a.y>d.y?a.y:d.y)},offset:function(a,d,j){return h(a.x+d,a.y+(j?j:d))},simplify:function(a,d){if(!a)return null;d=d?d:N.VECTOR_SIMPLIFICATION;for(var j=[],l=null,q=a.length;q--;){var v=a[q];if(include=!l||q===0||s(v.x-l.x)+s(v.y-l.y)>d){j.unshift(v);l=v}}return j},theta:function(a,d,j){j=Ka((a.y-d.y)/j);return a.x>d.x?j:Math.PI-j}}}(),oa=function(){return{dotProduct:function(c,p){return c.x*
p.x+c.y*p.y}}}(),w=function(){function c(h){return p(h.x1,h.y1,h.x2,h.y2)}function p(h,a,d,j){h=h?h:0;a=a?a:0;d=typeof d!=="undefined"?d:h;j=typeof j!=="undefined "?j:j;return{x1:h,y1:a,x2:d,y2:j,width:d-h,height:j-a}}return{center:function(h){return N.init(h.x1+h.width/2,h.y1+h.height/2)},copy:c,diagonalSize:function(h){return Y(h.width*h.width+h.height*h.height)},fromCenter:function(h,a,d,j){d=d>>1;j=j>>1;return p(h-d,a-j,h+d,a+j)},init:p,intersect:function(h,a){var d=C(h.x1,a.x1),j=C(h.y1,a.y1),
l=t(h.x2,a.x2),q=t(h.y2,a.y2);d=p(d,j,l,q);return d.width>0&&d.height>0?d:null},union:function(h,a){if(h.width===0||h.height===0)return c(a);else if(a.width===0||a.height===0)return c(h);else{var d=t(h.x1,a.x1),j=t(h.y1,a.y1),l=C(h.x2,a.x2),q=C(h.y2,a.y2);d=p(d,j,l,q);return d.width>0&&d.height>0?d:null}}}}(),Aa=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return N.init(c.width>>1,c.height>>1)},getSize:function(c){return Y(P(c.width,2)+
P(c.height,2))},init:function(c,p){c=c?c:0;return{width:c,height:p?p:c}}}}(),Da=null,Xa=[],R=null,Z=0,da=[],Ma=["view.wake","tile.loaded"],Fa=function(){function c(){if(!K){var u=x().maxImageLoads;K=COG.Loopage.join({execute:function(O,$){if(!u||n.length<u){var U=v.shift();if(U){n[n.length]=U;U.image.onload=h;U.image.src=U.url;U.requested=T5.ticks()}else $.trigger("complete")}},frequency:10});K.bind("complete",function(){K=null})}}function p(){X=true;try{var u=r.length>>1;if(u>0){r.sort(function($,
U){return $.created-U.created});for(var O=u;O--;)delete j[r[O].url];r.splice(0,u)}}finally{X=false}V.trigger("cacheCleared")}function h(){var u=l[this.id],O;if(u&&u.image.complete&&u.image.width>0){u.loaded=true;u.hitCount=1;for(O=n.length;O--;)if(n[O].image.src==this.src){n.splice(O,1);break}if(u.background||u.postProcess||u.drawBackground||u.customDraw)if(u.image){globalImageData=u;O=d(u.realSize?u.realSize.width:u.image.width,u.realSize?u.realSize.height:u.image.height);var $=O.getContext("2d"),
U=u.offset?u.offset:T5.XY.init();u.background&&$.drawImage(u.background,0,0);u.drawBackground&&u.drawBackground($);u.customDraw?u.customDraw($,u):$.drawImage(u.image,U.x,U.y);u.postProcess&&u.postProcess($,u);u.image=O}for(O=u.callbacks.length;O--;)u.callbacks[O]&&u.callbacks[O](this,false);u.callbacks=[];r[r.length]={url:this.src,created:u.requested};delete l[this.id];c()}}function a(u,O,$){var U=j[u];if(U){U.hitCount++;U.image.complete&&U.image.width>0&&O?O(U.image,true):U.callbacks.push(O)}else{U=
COG.extend({url:u,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[O]},$);U.image.id="resourceLoaderImage"+q++;j[u]=U;l[U.image.id]=U;v[v.length]=U;c()}return U}function d(u,O){var $=document.createElement("canvas");COG.info("creating new canvas");$.width=u?u:0;$.height=O?O:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild($);FlashCanvas.initElement($)}return $}var j={},l={},q=0,v=[],n=[],r=[],z=0,K=null,X=false,V={avgImageSize:25,loadTimeout:10,cancelLoad:function(){n=
[]},get:function(u,O,$){var U=null,wa=null;X||(U=j[u]);if((wa=U?U.image:null)&&(wa.getContext||wa.complete&&wa.width>0))return wa;else O&&a(u,O,$);return null},load:a,newCanvas:d,reset:function(){j={}},stats:function(){return{imageLoadingCount:n.length,queuedImageCount:v.length,imageCacheFullness:z}}};COG.observable(V);COG.Loopage.join({execute:function(u){for(var O=false,$=0,U=x();$<n.length;)if(u-n[$].requested>V.loadTimeout*1E3){n.splice($,1);O=true}else $++;O&&c();if(U&&U.imageCacheMaxSize){z=
r.length*V.avgImageSize/U.imageCacheMaxSize;z>=1&&p()}},frequency:2E4});return V}(),Pa=function(){var c={};return{init:function(p,h){var a=c[p];if(!a)throw Error("Unable to locate requested generator: "+p);return new a(h)},register:function(p,h){c[p]=h},Template:function(){}}}(),Ua=function(){function c(l,q){d[l]=h(q);return l}function p(l){for(var q in l)c(q,l[q])}function h(l){function q(z){var K=l[z];typeof K!=="undefined"&&n.push(function(X){X[z]=K})}function v(){n=[];for(var z in l)q(z)}l=COG.extend({lineWidth:undefined,
lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},l);var n=[],r={applyToContext:function(z){for(var K=n.length;K--;)n[K](z)},update:function(z,K){l[z]=K;v()}};v();return r}var a={},d={},j={apply:function(l,q){var v=d[q]?d[q]:d.basic,n;if(l&&l.canvas){n=a[l.canvas.id];a[l.canvas.id]=q}v.applyToContext(l);return n},define:c,defineMany:p,get:function(l){return d[l]},init:h,load:function(l){COG.jsonp(l,
function(q){p(q)})}};p({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return j}(),vb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},qb=function(c){function p(F,D,T,ja){Ta=db;O();if(ja&&c.inertia)n(Ga-D,Ea-T,c.panAnimationEasing,c.panAnimationDuration);else ja||n(Ga-D,Ea-T);clearTimeout(G);G=setTimeout(h,100)}function h(){Ta=jb;i=false;O()}function a(F,D,T,ja){U(Math.max(M+Math.pow(2,ja)-1,0.25))}function d(F){var D=
Math.log(M)/Math.LN2>>0;if(M!==1)Ta=ob;if(D!==0){M=Math.pow(2,D);D=N.init(eb-(g/M>>0),fb-(e/M>>0));if(!Ha.trigger("scale",M,D).cancel){for(F=fa.length;F--;)fa[F].trigger("scale",M,D);M=1;Q=null;Ta=jb;F=true}}O(F)}function j(F){F||(F=N.init(g,e));k=N.init(Ga,Ea);o=N.offset(F,Ga,Ea);eb=o.x;fb=o.y}function l(F,D,T){wa("doubleTap",D,T,N.offset(T,Ga,Ea));if(c.scalable){COG.endTweens(function(ja){return ja.cancelOnInteract});U(2,T,c.zoomAnimation)}}function q(){clearTimeout(S);S=setTimeout(r,250)}function v(F,
D,T){wa("tap",D,T,N.offset(T,Ga,Ea))}function n(F,D,T,ja,ma){function xa(){Ra+=1;if(Ra>=2){h();ma&&ma()}}var Ra=0,Va=I?N.offset(I,-g,-e):null,Wa=ba?N.offset(ba,-g,-e):null;if(Va){F=F<Va.x?Va.x:F;D=D<Va.y?Va.y:D}if(Wa){F=F>Wa.x?Wa.x:F;D=D>Wa.y?Wa.y:D}if(T){if(!i){F=COG.tweenValue(Ga,F,T,xa,ja);D=COG.tweenValue(Ea,D,T,xa,ja);F.cancelOnInteract=true;F.requestUpdates(function(Za){Ga=Za>>0;i=true;O()});D.cancelOnInteract=true;D.requestUpdates(function(Za){Ea=Za>>0;i=true;O()})}}else{Ga=F>>0;Ea=D>>0}}function r(F,
D){var T;if(ya){ga&&ga.unbind();if(c.autoSize&&ya.parentNode){T=ya.parentNode.getBoundingClientRect();F=T.right-T.left;D=T.bottom-T.top}try{if(!ya.id)ya.id=c.id+"_canvas";pa=ya.getContext("2d")}catch(ja){COG.exception(ja);throw Error("Could not initialise canvas on specified view element");}if(F&&D&&(sa!==D||ta!==F)){ka=true;ta=F;sa=D;g=ta>>1;e=sa>>1;Ha.trigger("resize",ta,sa);for(T=aa;T--;)fa[T].trigger("resize",ta,sa)}if(c.interactive){ga=INTERACT.watch(ya).pannable();K()}for(T=aa;T--;)fa[T].trigger("contextChanged",
pa);O(true)}}function z(F,D){D.setId(F);D.added=ia();D.bind("remove",function(){Ha.removeLayer(F)});D.trigger("contextChanged",pa);D.setParent(Ha);fa.push(D);fa.sort(function(T,ja){var ma=ja.zindex-T.zindex;if(ma===0)ma=ja.added-T.added;return ma});aa=fa.length;return D}function K(){if(ga){if(c.pannable){ga.bind("pan",p);ga.bind("inertiaCancel",function(){i=false;O()})}if(c.scalable){ga.bind("zoom",a);ga.bind("doubleTap",l)}ga.bind("tap",v)}}function X(){wa("idle",Ha);b=true;m=0}function V(F,D,T,
ja){var ma,xa=0;Sa=w.copy(D);T&&pa.clearRect(0,0,ta,sa);pa.save();try{pa.globalCompositeOperation="source-over";if(M!==1){var Ra=Sa,Va=1/M;eb=o.x+(Ga-k.x);fb=o.y+(Ea-k.y);Sa=Ra?w.fromCenter(eb>>0,fb>>0,Ra.width*Va>>0,Ra.height*Va>>0):void 0;pa.scale(M,M)}pa.translate(-Sa.x1,-Sa.y1);ba=I=null;if(kb){pa.beginPath();clipped=false;for(xa=aa;xa--;)if(fa[xa].clip){fa[xa].clip(pa,Sa,F,Ha,T,ja);clipped=true}pa.closePath();clipped&&pa.clip()}for(xa=aa;xa--;){ma=fa[xa];var Wa=ma.style,Za=Wa?Ua.apply(pa,Wa):
null;if(ma.minXY)I=I?N.min(I,ma.minXY):N.copy(ma.minXY);if(ma.maxXY)ba=ba?N.max(ba,ma.maxXY):N.copy(ma.maxXY);ma.draw(pa,Sa,F,Ha,T,ja);Za&&Ua.apply(pa,Za)}}finally{pa.restore()}if(Ya){pa.globalCompositeOperation="source-over";pa.strokeStyle="#f00";pa.beginPath();pa.moveTo(g,0);pa.lineTo(g,sa);pa.moveTo(0,e);pa.lineTo(ta,e);pa.stroke()}wa("drawComplete",D,ja);COG.trace("draw complete",ja)}function u(F,D){var T=false,ja=za?za:i?db:Ta,ma=!i&&(ja===ob||ja===db),xa=La||ja===db||COG.getTweens().length>
0;if(ka&&ya){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(ya);ya.width=ta;ya.height=sa;ya.style.width=ta+"px";ya.style.height=sa+"px";ka=false}$a=$();if(ma){COG.endTweens(function(Ra){return Ra.cancelOnInteract});b=false;if(m!==0){clearTimeout(m);m=0}}for(ma=aa;ma--;){if(fa[ma].animated)Ta|=pb;fa[ma].cycle(F,$a,Ta,xa);T=fa[ma].shouldDraw(Ta,$a,xa)||T}xa=xa||(Ta&pb)!==0;if(T=T||xa||M!==1&&M!==ha){V(ja,$a,xa,F);ha=M;La=false}if(!T&&cb===0&&!gb){if(!b&&m===0)m=setTimeout(X,500);D.trigger("complete")}cb=
0;COG.trace("Completed draw cycle",F)}function O(F){La=F?true:false;cb+=1;if(!ab){ab=COG.Loopage.join({execute:u,frequency:hb});ab.bind("complete",function(){ab=null})}}function $(){return w.init(Ga,Ea,Ga+ta,Ea+sa)}function U(F,D,T,ja){function ma(){M=Math.pow(2,Math.round(Math.log(M)/Math.LN2));ja&&ja();d(true)}var xa=M;j(D);if(T)COG.tweenValue(0,F-xa,T,ma,1E3).requestUpdates(function(Ra){M=xa+Ra;d()});else{M=F;d()}return Ha}function wa(){for(var F=Ha.trigger.apply(null,arguments).cancel,D=fa.length;D--;)F=
fa[D].trigger.apply(null,arguments).cancel||F;return!F}c=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,clipping:false,scalable:true,interactive:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25,zoomAnimation:COG.easing("quad.out")},c);var fa=[],aa=0,ya=document.getElementById(c.container),pa=null,Qa=typeof window.attachEvent!="undefined",
Ga=0,Ea=0,kb=c.clipping,$a=null,ab=null,Sa,Ya=c.guides,ib=1,cb=0,g=0,e=0,k=null,o=null,b=false,i=false,m=0,G=0,I=null,ba=null,la=0,za=null,La=false,S=0,Q=null,M=1,ha=0,ka=false,ga=null,sa,ta,gb=typeof FlashCanvas!=="undefined",hb=~~(1E3/c.fps),eb,fb,jb=H("ACTIVE"),db=H("PAN"),ob=H("ZOOM"),pb=H("ANIMATING"),Ta=jb,Ha={id:c.id,deviceScaling:ib,fastDraw:c.fastDraw||x().requireFastDraw,getDimensions:function(){return Aa.init(ta,sa)},getLayer:function(F){for(var D=0;D<aa;D++)if(fa[D].getId()==F)return fa[D];
return null},setLayer:function(F,D){for(var T=0;T<aa;T++)if(fa[T].getId()===F){fa.splice(T,1);break}D&&z(F,D);O();return D},eachLayer:function(F){for(var D=aa;D--;)F(fa[D])},invalidate:O,resize:function(F,D){if(ya){c.autoSize=false;if(ta!==F||sa!==D)r(F,D)}},scale:U,triggerAll:wa,removeLayer:function(F){a:{for(var D=aa;D--;)if(fa[D].getId()==F){F=D;break a}F=-1}if(F>=0&&F<aa){Ha.trigger("layerRemoved",fa[F]);fa.splice(F,1);O()}aa=fa.length},stateOverride:function(F){za=F},getOffset:function(){return N.init(Ga,
Ea)},getViewRect:$,updateOffset:n,pan:function(F,D,T,ja,ma){n(Ga+F,Ea+D,T,ja,ma)}};ib=x().getScaling();Ha.markers=z("markers",new lb);COG.observable(Ha);Ha.bind("invalidate",function(F,D){O(D)});Ha.bind("resync",function(){ba=I=null});COG.configurable(Ha,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(c,null,{container:function(F,D){ya=document.getElementById(D);r()},rotation:function(F,D){la=D}}),true);r();if(c.autoSize)Qa?window.attachEvent("onresize",q):window.addEventListener("resize",
q,false);return Ha},bb=function(c){c=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:H("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var p=null,h=false,a=false,d=c.supportFastDraw,j=c.id,l=H("ACTIVE"),q=c.validStates,v=0,n=0,r=COG.extend({addToView:function(z){z.setLayer(j,r)},shouldDraw:function(z,K,X){return(a||X||v!==K.x1||n!==K.y1)&&(z&q)!==0&&(h?d:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){r.trigger("remove",r)},
changed:function(z){a=true;r.trigger("changed",r);p&&p.trigger("invalidate",z)},getId:function(){return j},setId:function(z){j=z},getParent:function(){return p},setParent:function(z){h=(p=z)?p.fastDraw&&displayState!==l:false;r.trigger("parentChange",p)}},c);COG.observable(r);r.bind("drawComplete",function(z,K){a=false;v=K.x1;n=K.y1});r.bind("resync",function(z,K){if(K.syncXY){r.minXY&&K.syncXY(r.minXY);r.maxXY&&K.syncXY(r.maxXY)}});return r},mb=function(c){function p(v,n,r,z){a=v;d=n;j=r;l=z}c=COG.extend({xy:N.init(),
offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var h=false,a=0,d=0,j=0,l=0,q=COG.extend(c,{isAnimating:function(){return h},draw:function(v,n,r,z,K){if(q.isNew&&c.tweenIn){var X=q.xy.y;q.xy.y=n.y1-20;h=true;COG.tween(q.xy,"y",X,c.tweenIn,function(){q.xy.y=X>>0;h=false},c.animationSpeed?c.animationSpeed:250+Math.random()*500)}q.drawMarker(v,n,q.xy.x,q.xy.y,r,z,K);q.isNew=false},drawMarker:function(v,n,r,z){v.beginPath();v.arc(r,z,4,0,Math.PI*2,false);v.fill();p(r-4,z-4,8,8)},hitTest:function(v,
n){return v>=a&&v<=a+j&&n>=d&&n<=d+l},updateBounds:p});COG.observable(q);return q},lb=function(c){function p(){d.changed();d.trigger("markerUpdate",a)}function h(){var j=d.getParent();if(j&&j.syncXY)for(var l=a.length;l--;)j.syncXY([a[l].xy])}c=COG.extend({zindex:100,style:"basic"},c);var a=[],d=COG.extend(new bb(c),{draw:function(j,l,q,v){for(var n=a.length;n--;)a[n].draw(j,l,q,d,v)},add:function(j){if(j&&typeof j.length!=="undefined")for(var l=j.length;l--;){if(j[l])a[a.length]=j[l]}else if(j)a[a.length]=
j;p()},clear:function(j){if(j)for(var l=0;l<a.length;)if(j(a[l]))a.splice(l,1);else l+=1;else a=[];p()},each:function(j){if(j)for(var l=a.length;l--;)j(a[l])},find:function(j){for(var l=[],q=a.length;q--;)if(!j||j(a[q]))l[l.length]=a[q];return l}});d.bind("tap",function(j,l,q,v){var n=[],r=v.x;v=v.y;for(var z=a.length;z--;)if(a[z].hitTest(r,v))n[n.length]=a[z];if(n.length>0)j.cancel=d.trigger("markerTap",l,q,n).cancel});d.bind("parentChange",h);d.bind("resync",h);d.bind("changed",h);return d},rb=
function(c){function p(q,v,n){q.fillStyle="#FFFFFF";q.strokeStyle="#222222";q.beginPath();q.arc(n.x,n.y,4,0,Math.PI*2,false);q.stroke();q.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:H("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},c);var h=N.edges(c.path),a,d=null,j=0;COG.tweenValue(0,h.total,c.easing,function(){l.remove()},c.duration).requestUpdates(function(q,v){j=q;v&&l.remove()});var l=COG.extend(new bb(c),{cycle:function(){for(var q=
0;q<h.accrued.length&&h.accrued[q]<j;)q++;d=null;if(q<c.path.length-1){var v=j-(q>0?h.accrued[q-1]:0),n=c.path[q];a=N.theta(n,c.path[q+1],h.edges[q]);d=N.extendBy(n,a,v)}return d},draw:function(q,v){if(d)(c.drawIndicator?c.drawIndicator:p)(q,v,N.init(d.x,d.y),a)}});return l},sb=function(c){c=COG.extend({style:null,properties:{}},c);return COG.extend(c,{rect:null,draw:function(){},resync:function(){}})},nb=function(c,p){p=COG.extend({fill:false,simplify:false},p);var h=false,a=p.fill,d=p.simplify,
j=H("ZOOM"),l=[],q=COG.extend(new sb(p),{draw:function(v,n,r,z,K,X){if(h){n=true;r=(X&j)!==0;v.beginPath();for(X=l.length;X--;){r=l[X].x;z=l[X].y;if(n){v.moveTo(r,z);n=false}else v.lineTo(r,z);r=true}if(r){a&&v.fill();v.stroke()}}},resync:function(v){q.xy=v.syncXY(c);l=N.floor(d?N.simplify(c):c)}});h=c&&c.length>=2;return q},tb=function(c){function p(j){for(var l=a.length;l--;)a[l].resync(j);a.sort(function(q,v){var n=v.xy.y-q.xy.y;if(n===0)n=v.xy.x-q.xy.y;return n});d.changed()}function h(j,l){l.syncXY&&
p(l)}c=COG.extend({zindex:80},c);var a=[],d=COG.extend(new bb(c),{add:function(j){a[a.length]=j},each:function(j){for(var l=a.length;l--;)j(a[l])},draw:function(j,l,q){var v=l.x1,n=l.y1,r=l.width;l=l.height;for(var z=a.length;z--;){var K=a[z].style;K=K?Ua.apply(j,K):null;a[z].draw(j,v,n,r,l,q);K&&Ua.apply(j,K)}}});d.bind("parentChange",h);d.bind("resync",h);return d},wb=function(){return{tileSize:256,init:function(c,p,h,a,d){return COG.extend({x:c,y:p,width:h,height:a},d)}}}(),ub=function(c){function p(V,
u,O,$){function U(){if(X.initTileCreator){q=true;X.initTileCreator(V,u,O,$)}}X.prepTileCreator?X.prepTileCreator(V,u,O,U):U()}function h(V,u){for(var O=~~((V.x1-j.x)/v),$=~~((V.y1-j.y)/n),U=[],wa=-l;wa<z;wa++)for(var fa=-l;fa<K;fa++){var aa=r(O+wa,$+fa);if(aa)U[U.length]=aa}u&&u(U);d=w.copy(V)}c=COG.extend({tileWidth:256,tileHeight:256,relative:false,padding:2},c);var a=null,d=null,j=N.init(),l=c.padding,q=false,v=c.tileWidth,n=c.tileHeight,r=null,z=0,K=0,X={bindToView:function(V){COG.info("initializing generator");
a=V;X.trigger("bindView",V)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){r=null;q=false;d=null},run:function(V,u){if(!d||Math.abs(V.x1-d.x1)>v||Math.abs(V.y1-d.y1)>n){if(!r&&!q||X.requireRefresh()){j=c.relative?N.init(V.x1,V.y1):N.init();z=Math.ceil(V.width/v)+l;K=Math.ceil(V.height/n)+l;p(v,n,X.getTileCreatorArgs?X.getTileCreatorArgs(a):{},function(O){r=O;q=false;h(V,u)})}r&&h(V,u)}}};COG.observable(X);X.bind("update",
function(){COG.info("captured generator update");d=null});return X},Na={ex:COG.extend,ticks:ia,getConfig:x,userMessage:function(c,p,h){Na.trigger("userMessage",c,p,h)},zoomable:B,XY:N,XYRect:w,Dimensions:Aa,Vector:oa,D:Aa,Images:Fa,Generator:Pa,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ua,viewState:H,View:qb,ViewLayer:bb,ImageLayer:function(c,p){function h(n,r,z){for(r=j.length;r--;){var K=j[r],X=K.x,V=K.y,u=w.init(K.x,K.y,K.x+K.width,K.y+K.height);if(z&&w.intersect(n,
u)){u=Fa.get(K.url,function(){v.changed()},q);z(u,X,V,K.width,K.height)}}}function a(n){d&&d.run(n,function(r){j=[].concat(r);v.changed()})}p=COG.extend({imageLoadArgs:{}},p);var d=c?Pa.init(c,p):null,j=[],l=w.init(),q=p.imageLoadArgs,v=COG.extend(new bb(p),{changeGenerator:function(n,r){d=Pa.init(n,COG.extend({},p,r));d.bindToView(v.getParent());j=null;a(l)},clip:function(n,r,z){h(r,z,function(K,X,V,u,O){K&&n.rect(X,V,u,O)})},cycle:function(n,r){a(r)},draw:function(n,r,z){h(r,z,function(K,X,V,u,
O){v.drawImage(n,K,X,V,u,O,r,z)});l=w.copy(r)},drawImage:function(n,r,z,K){r&&n.drawImage(r,z,K,r.width,r.height)}});v.bind("idle",function(){a(l)});v.bind("parentChange",function(n,r){d&&d.bindToView(r)});v.bind("tap",function(n,r,z,K){n=[];var X=K.x,V=K.y,u,O;if(j)for(var $=j.length;$--;){u=j[$];if(O=X>=u.x&&X<=u.x+u.width&&V>=u.y&&V<=u.y+u.height)n[n.length]=u}n.length>0&&v.trigger("tapImage",n,r,z,K)});return v},Marker:mb,ImageMarker:function(c){c=COG.extend({image:null,imageUrl:null,animatingImage:null,
animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},c);var p=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,h=COG.extend(new mb(c),{drawMarker:function(a,d,j,l){if((d=h.isAnimating()&&h.animatingImage?h.animatingImage:h.image)&&d.width>0){p||(p=N.init(-d.width>>1,-d.height>>1));var q=h.scale,v=j+~~(p.x*q),n=l+~~(p.y*q),r=~~(d.width*q),z=~~(d.height*q);h.updateBounds(v,n,r,r);if(h.rotation||h.opacity!==1){a.save();try{a.globalAlpha=h.opacity;a.translate(j,l);a.rotate(h.rotation);
a.drawImage(d,p.x*q,p.y*q,r,z)}finally{a.restore()}}else a.drawImage(d,v,n,r,z)}}});if(!h.image)h.image=Fa.get(c.imageUrl,function(a){h.image=a});if(!h.animatingImage)h.animatingImage=Fa.get(c.animatingImageUrl,function(a){h.animatingImage=a});return h},MarkerLayer:lb,PathLayer:function(c){c=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},c);var p=false,h=[],a=null,d=[],j=null,l=0,q=[],v=COG.extend(new bb(c),{getAnimation:function(n,r,z,K){var X="pathAnimation"+l++;q.push(X);return new rb({id:X,
path:h,zindex:c.zindex+1,easing:n?n:COG.easing("sine.inout"),duration:r?r:5E3,drawIndicator:z,autoCenter:K?K:false})},cycle:function(n,r,z,K){return K},draw:function(n){var r,z=h.length;n.save();try{Ua.apply(n,c.style);if(z>0){n.beginPath();n.moveTo(h[z-1].x,h[z-1].y);for(r=z;r--;)n.lineTo(h[r].x,h[r].y);n.stroke();if(a){n.fillStyle=c.waypointFillStyle;for(r=a.length;r--;){n.beginPath();n.arc(a[r].x,a[r].y,2,0,Math.PI*2,false);n.stroke();n.fill()}}}}finally{n.restore()}p=false},updateCoordinates:function(n,
r){d=n;j=r;var z=v.getParent();if(z&&z.syncXY){z.syncXY(d);j&&z.syncXY(j);v.trigger("tidy")}}});v.bind("tidy",function(){h=N.simplify(d,c.pixelGeneralization);a=N.simplify(j,c.pixelGeneralization);p=true;v.changed()});return v},AnimatedPathLayer:rb,Shape:sb,Arc:function(c,p){p=COG.extend({size:4},p);var h=N.init(),a=COG.extend(p,{draw:function(d){d.beginPath();d.arc(h.x,h.y,a.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([c]);h=N.floor([c])[0]}});COG.info("created arc = ",
c);return a},Poly:nb,ShapeLayer:tb,Tiling:wb,TileGenerator:ub};COG.observable(Na);var Oa=Na.Geo=function(){function c(g){g=parseFloat(g)*V;g=qa(g);var e=O*g;return na((1+g)/(1-g)*P((1-e)/(1+e),O))/2}function p(g){return parseFloat(g)*V}function h(g){g=P(Math.E,-g);for(var e=f-2*va(g),k=j(e,g),o=0;o<U&&s(e-k)>$;){e=k;k=j(e,g);o++}return k*u}function a(g){return g%360*u}function d(g,e){var k=null;for(var o in engines)if(e){if(o==e&&engines[o][g]){k=engines[o];break}}else if(engines[o][g]){k=engines[o];
break}return k}function j(g,e){var k=O*qa(g);return f-2*va(e*P((1-k)/(1+k),O/2))}function l(g,e,k,o){e=v(e);g.add(o.line(e,k));return e.length}function q(g,e,k,o){e=v(e);g.add(o.poly(e,k));return e.length}function v(g){var e=g?g.length:0,k=Array(e);for(e=e;e--;)k[e]=Oa.Position.init(g[e][1],g[e][0]);return Oa.Position.vectorize(k,Sa)}function n(g,e,k){return new cb(g,e,k)}var r=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],z=-f,K=f,X=-ca,V=Math.PI/180,
u=180/Math.PI,O=0.08181919084262157,$=1.0E-7,U=12,wa=null,fa={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},aa=function(){function g(b){return b?k(b.lat,b.lon):null}function e(b){return!b||b.lat===0&&b.lon===0}function k(b,i){return{lat:parseFloat(b?b:0),lon:parseFloat(i?i:0)}}function o(b){if(b)if(typeof b.lat!=="undefined")return g(b);else{if(b.split)for(var i=[" ",","],m=0;m<i.length;m++){var G=b.split(i[m]);if(G.length===2)return k(G[0],
G[1])}}else return k();return null}return{calcDistance:function(b,i){if(e(b)||e(i))return 0;var m=(i.lat-b.lat)*V>>1,G=(i.lon-b.lon)*V>>1;m=qa(m)*qa(m)+Ja(b.lat*V)*Ja(i.lat*V)*qa(G)*qa(G);return 6371*2*Ca(Y(m),Y(1-m))},copy:g,empty:e,equal:function(b,i){return b&&i&&b.lat==i.lat&&b.lon==i.lon},fromMercatorPixels:function(b,i){return k(h(i),a(b))},generalize:function(b,i,m){var G=b.length,I=[],ba=null;m||(m=250);m/=1E3;COG.info("generalizing positions, must include "+i.length+" positions");for(var la=
G;la--;)if(la===0)I.unshift(b[la]);else{var za=!ba||aa.inArray(b[la],i)?m:aa.calcDistance(ba,b[la]);if(b[la]&&za>=m){I.unshift(b[la]);ba=b[la]}}COG.info("generalized "+G+" positions into "+I.length+" positions");return I},inArray:function(b,i){for(var m=aa.equal,G=i.length;G--;)if(m(b,i[G]))return true;return false},inBounds:function(b,i){var m=!(aa.empty(b)||aa.empty(i));return m=(m=m&&b.lat>=i.min.lat&&b.lat<=i.max.lat)&&b.lon>=i.min.lon&&b.lon<=i.max.lon},init:k,offset:function(b,i,m){var G=b.lat*
V;b=b.lon*V;i=G+i/6371;m=Ka(qa(m/6371)/Ja(G));m=b+m;i=(i+f)%Math.PI-f;m%=ca;return k(i*u,m*u)},parse:o,parseArray:function(b){var i=b.length,m=Array(i);for(i=i;i--;)m[i]=o(b[i]);return m},toMercatorPixels:function(b){return T5.XY.init(p(b.lon),c(b.lat))},toString:function(b){return b?b.lat+" "+b.lon:""},vectorize:function(b,i){var m=b.length,G=Array(m);i=COG.extend({chunkSize:500,async:true},i);if(!i.async){for(var I=m;I--;)G[I]=T5.GeoXY.init(b[I]);return G}return COG.Loopage.join({frequency:10,execute:function(ba,
la){for(var za=0,La=i.chunkSize,S=m;S--;){G[S]=T5.GeoXY.init(b[S]);za+=1;if(za>La)break}m=S;m<=0&&la.trigger("complete",G)}})}}}(),ya=function(){function g(b,i,m){var G=T5.XY.init(0,i.lat-b.lat);if(typeof m==="undefined")m=true;G.x=m&&b.lon>i.lon?360-b.lon+i.lon:i.lon-b.lon;return G}function e(b,i){return ya.init(aa.init(b.min.lat-i,b.min.lon-i%360),aa.init(b.max.lat+i,b.max.lon+i%360))}function k(b){var i=g(b.min,b.max);return aa.init(b.min.lat+(i.y>>1),b.min.lon+(i.x>>1))}function o(b,i){return{min:aa.parse(b),
max:aa.parse(i)}}return{calcSize:g,createBoundsFromCenter:function(b,i){var m=i/6371,G=b.lat*V,I=b.lon*V,ba=G-m,la=G+m;if(ba>z&&la<K){G=Ka(qa(m)/Ja(G));m=(I-G)%ca;I=(I+G)%ca}else{ba=C(ba,z);la=t(la,K);m=X;I=ca}return ya.init(aa.init(ba*u,m*u),aa.init(la*u,I*u))},expand:e,forPositions:function(b,i){var m=null,G=T5.ticks();i||(i="auto");for(var I=b.length;I--;)if(m){var ba=g(m.min,b[I],false),la=g(b[I],m.max,false);if(ba.x<0)m.min.lon=b[I].lon;if(ba.y<0)m.min.lat=b[I].lat;if(la.x<0)m.max.lon=b[I].lon;
if(la.y<0)m.max.lat=b[I].lat}else m=o(b[I],b[I]);if(i){if(i=="auto"){I=g(m.min,m.max);i=C(I.x,I.y)*0.3}m=e(m,i)}COG.trace("calculated bounds for "+b.length+" positions",G);return m},getCenter:k,getGeoHash:function(b){var i=T5.Geo.GeoHash.encode(b.min.lat,b.min.lon);b=T5.Geo.GeoHash.encode(b.max.lat,b.max.lon);COG.info("min hash = "+i+", max hash = "+b)},getZoomLevel:function(b,i){var m=k(b);m=t(Ia(s(m.lat)*0.05),r.length);var G=r[m],I=g(b.min,b.max);m=ceil(na(r[3]*i.height/I.y)/na(2));G=ceil(na(G*
i.width/I.x)/na(2));return t(isNaN(m)?1E3:m,isNaN(G)?1E3:G)},init:o,isEmpty:function(b){return!b||aa.empty(b.min)||aa.empty(b.max)},toString:function(b){return"min: "+aa.toString(b.min)+", max: "+aa.toString(b.max)}}}(),pa=function(){var g=/^(\d+).*$/,e=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(k,o){g.lastIndex=-1;if(g.test(k))for(var b=k.replace(g,"$1"),i=o.split(","),m=0;m<i.length;m++){e.lastIndex=-1;if(e.test(i[m])){var G=e.exec(i[m]);if(b>=parseInt(G[1],10)&&b<=parseInt(G[2],10))return true}else if(b==
i[m])return true}return false},normalize:function(k){if(!k)return"";k=k.toUpperCase();if(!wa){var o=[];for(var b in fa)o.push(b);wa=RegExp("(\\s)("+o.join("|")+")(\\s|$)","i")}wa.lastIndex=-1;if(o=wa.exec(k))k=k.replace(wa,"$1"+fa[o[2]]);return k},toString:function(k){return k.streetDetails+" "+k.location}}}(),Qa=Na.GeoXY=function(){function g(k,o){if(k.length){for(var b,i,m,G,I=k.length;I--;){g(k[I],o);b=typeof b==="undefined"||k.x<b?k.x:b;i=typeof i==="undefined"||k.y<i?k.y:i;m=typeof m==="undefined"||
k.x>m?k.x:m;G=typeof G==="undefined"||k.y>G?k.y:G}return w.init(b,i,G,G)}else if(k.mercXY){b=k.mercXY;k.x=~~(b.x/o);k.y=~~((Math.PI-b.y)/o);k.rpp=o}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return k}function e(k,o,b){k.pos=o;k.mercXY=aa.toMercatorPixels(o);(b=typeof b!=="undefined"?b:k.rpp)&&g(k,b)}return{init:function(k,o){var b=N.init();e(b,k,o);return b},sync:g,toPos:function(k,o){o=o?o:self.rpp;return aa.fromMercatorPixels(k.x*o,Math.PI-k.y*o)},updatePos:e}}();Na.GeoVector=
function(g){COG.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return Qa.init(g)};var Ga=function(){return{bestResults:function(g,e){e||(e=20);for(var k=g.length>0?g[0]:null,o=[],b=0;b<g.length;b++)if(k&&g[b]&&k.matchWeight-g[b].matchWeight<=e)o.push(g[b]);else break;return o}}}(),Ea=function(g){g=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},g);return COG.extend(g,{toString:function(){return g.caption+(g.matchWeight?" ("+
g.matchWeight+")":"")}})},kb=function(){var g={calculate:function(e){e=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},e);var k=T5.Geo.getEngine("route");k&&k.route(e,function(o){if(e.generalize)o.geometry=T5.Geo.Position.generalize(o.geometry,o.getInstructionPositions());if(e.map){g.createMapOverlay(e.map,o);e.autoFit&&e.map.gotoBounds(o.boundingBox)}e.success&&e.success(o)})},createMapOverlay:function(e,k){var o=e.getDimensions();o=new T5.Geo.UI.RouteOverlay({data:k,
width:o.width,height:o.height});e.setLayer("route",o)},parseTurnType:function(e){for(var k=g.TurnType.Unknown,o=T5.Geo.Routing.TurnTypeRules,b=0;b<o.length;b++){o[b].regex.lastIndex=-1;var i=o[b].regex.exec(e);if(i){k=o[b].customCheck?o[b].customCheck(e,i):o[b].turnType;break}}return k},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",
TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(e){var k=e=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},e),o=e.description;o=o.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");k.description=o;if(!e.turnType)e.turnType=g.parseTurnType(e.description);return e},RouteData:function(e){e=
COG.extend({geometry:[],instructions:[],boundingBox:null},e);if(!e.boundingBox)e.boundingBox=T5.Geo.BoundingBox.forPositions(e.geometry);return COG.extend({getInstructionPositions:function(){for(var k=[],o=0;o<e.instructions.length;o++)e.instructions[o].position&&k.push(e.instructions[o].position);return k}},e)}};return g}(),$a="featurecollection",ab="feature",Sa={async:false},Ya={processor:null,group:"shapes",layerClass:tb},ib={point:COG.extend({},Ya,{processor:function(g,e,k,o){e=v([e.coordinates],
Sa);if(e.length>0)if(k=o.marker(e[0],k)){g.add(k);return e.length}},group:"markers",layerClass:lb}),linestring:COG.extend({},Ya,{processor:function(g,e,k,o){e=v(e&&e.coordinates?e.coordinates:[]);return l(g,e,k,o)}}),multilinestring:COG.extend({},Ya,{processor:function(g,e,k,o){e=e&&e.coordinates?e.coordinates:[];for(var b=0,i=e.length;i--;)b+=l(g,e[i],k,o);return b}}),polygon:COG.extend({},Ya,{processor:function(g,e,k,o){e=e&&e.coordinates?e.coordinates:[];if(e.length>0)return q(g,e[0],k,o);return 0}}),
multipolygon:COG.extend({},Ya,{processor:function(g,e,k,o){e=e&&e.coordinates?e.coordinates:[];for(var b=0,i=0;i<e.length;i++)b+=q(g,e[i][0],k,o);return b}})},cb=function(g,e,k,o){function b(M,ha){var ka=M.processor,ga=I+M.group,sa=COG.extend({},M,k,{properties:ha.properties});if(ka){var ta=S[ga];if(!ta){ta=new M.layerClass({id:ga});S[ga]=ta}globalLayers=S;return ka(ta,ha.data,sa,o)}return 0}function i(M,ha){var ka=M&&M.type?M.type.toLowerCase():null;return ka&&ka===ab?i(M.geometry,M.properties):
{type:ka,isCollection:ka?ka===$a:false,definition:ib[ka],data:M,properties:ha?ha:M.properties}}k=COG.extend({vectorsPerCycle:Oa.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},k);o=COG.extend({marker:function(M){return new mb({xy:M})},line:function(M,ha){return new nb(M,ha)},poly:function(M,ha){return new nb(M,COG.extend({fill:true},ha))}},o);var m=k.vectorsPerCycle,G=k.rowPreParse,I=k.layerPrefix,ba=0,la=0,za=null,La=0,S={},Q;if(!g)return null;if(typeof g.length==="undefined")g=
[g];la=g.length;Q=COG.Loopage.join({frequency:10,execute:function(M,ha){var ka=0,ga=ba;if(!za){for(;ga<la;ga++){var sa=i(G?G(g[ga]):g[ga]),ta=null;if(sa.isCollection){La+=1;za=n(sa.data.features,function(gb){za=null;for(var hb in gb)S[hb]=gb[hb]},{layerPrefix:I+La+"-"});ta+=1}else if(sa.definition)ta=b(sa.definition,sa);ka+=ta?ta:1;if(ka>=m)break}ba=ga+1;!za&&ba>=la&&ha.trigger("complete")}}});Q.bind("complete",function(){e&&e(S)});return Q};Na.GeoJSON={parse:n};Na.Map=function(g){function e(Q){try{var M=
Oa.Position.init(Q.coords.latitude,Q.coords.longitude),ha=Q.coords.accuracy/1E3;S.trigger("locationUpdate",Q,ha);if(la){if(!I){I=new Oa.UI.LocationOverlay({pos:M,accuracy:ha});I.update(S.getTileLayer());S.setLayer("location",I)}var ka=Oa.BoundingBox.createBoundsFromCenter(M,Math.max(ha,1));S.gotoBounds(ka)}else{I.pos=M;I.accuracy=ha;I.update(S.getTileLayer());b(M,null,COG.easing("sine.out"))}la=false}catch(ga){COG.exception(ga)}}function k(Q){COG.info("caught location tracking error:",Q)}function o(Q,
M,ha){S.setZoomLevel(M);Fa.cancelLoad();COG.endTweens();b(Q,ha)}function b(Q,M,ha,ka){Q=Qa.init(Q,Oa.radsPerPixel(S.getZoomLevel()));var ga=S.getDimensions();S.updateOffset(Q.x-(ga.width>>1),Q.y-(ga.height>>1),ha,ka,M);S.trigger("wake");S.trigger("boundsChange",S.getBoundingBox());M&&typeof ha==="undefined"&&M(S)}g=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},g);var i={NONE:0,SINGLE:1,WATCH:2},m=N.init(),G=i.NONE,I=null,ba=0,la=true,za=0,La=g.tapExtent;g.adjustScaleFactor=
function(Q){return Math.pow(2,(Q<1?Math.floor:Math.ceil)(Math.log(Q)))};var S=COG.extend(new qb(g),{getBoundingBox:function(){var Q=S.getViewRect();return Oa.BoundingBox.init(Qa.toPos(N.init(Q.x1,Q.y2),za),Qa.toPos(N.init(Q.x2,Q.y1),za))},getCenterPosition:function(){var Q=S.getViewRect();if(Q){Q=N.init(Q.x1+(Q.width>>1),Q.y1+(Q.height>>1));return Qa.toPos(Q,za)}return null},gotoBounds:function(Q,M){var ha=Oa.BoundingBox.getZoomLevel(Q,S.getDimensions());o(Oa.BoundingBox.getCenter(Q),ha,M)},gotoPosition:o,
panToPosition:b,syncXY:function(Q){return Qa.sync(Q,za)},locate:function(){S.trackStart(i.SINGLE);setTimeout(S.trackCancel,1E4)},trackStart:function(Q){if(navigator.geolocation&&!ba){G=Q?Q:i.WATCH;la=true;ba=navigator.geolocation.watchPosition(e,k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){ba&&navigator.geolocation&&navigator.geolocation.clearWatch(ba);S.removeLayer("location");I=null;G=i.NONE;ba=0},animateRoute:function(Q,M,ha,ka){var ga=S.getLayer("route");if(ga)(Q=
ga.getAnimation(Q,M,ha,ka))&&Q.addToView(S)}});S.bind("pan",function(){G===i.SINGLE&&S.trackCancel()});S.bind("tap",function(Q,M,ha,ka){var ga=Oa.radsPerPixel(S.getZoomLevel());Q=Qa.toPos(ka,ga);var sa=Qa.toPos(N.offset(ka,-La,La),ga);ka=Qa.toPos(N.offset(ka,La,-La),ga);S.trigger("geotap",M,ha,Q,ya.init(sa,ka))});S.bind("idle",function(){var Q=N.absSize(N.diff(m,S.getOffset()));COG.info("idle detected, change delta = "+Q);if(Q>g.boundsChangeThreshold){m=N.copy(S.getOffset());S.trigger("boundsChange",
S.getBoundingBox())}});B(S,g);S.bind("zoomLevelChange",function(Q,M){za=Oa.radsPerPixel(M);S.triggerAll("resync",S)});return S};Na.MapTileGenerator=function(g){function e(i,m){var G=m>=b.minLevel&&(!b.maxLevel||m<=b.maxLevel);COG.info("new zoom level = "+m+", zoom ok = "+G);i.cancel=!G;if(G){k=m;b.reset()}}g=COG.extend({relative:true},g);var k=0,o=null,b=COG.extend(new ub(g),{minLevel:2,maxLevel:20,getTileCreatorArgs:function(i){o=i.getCenterPosition();return{zoomLevel:k,position:o}},requireRefresh:function(){return!o}});
b.bind("bindView",function(i,m){if(m.getZoomLevel){k=m.getZoomLevel();m.bind("zoomLevelChange",e)}});return b};Na.GeoPoly=function(g,e){e=COG.extend({autoParse:true},e);for(var k=Array(g.length),o=e.autoParse,b=T5.Geo.Position.parse,i=g.length;i--;)k[i]=T5.GeoXY.init(o?b(g[i]):g[i]);return new T5.Poly(k,e)};Na.RouteOverlay=function(g){g=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},g);var e=[],k=
[],o=new T5.PathLayer(g);(function(){if(g.data&&g.data.instructions){for(var b=g.data.instructions,i=Array(b.length),m=b.length;m--;)i[m]=b[m].position;T5.Geo.Position.vectorize(i).bind("complete",function(G,I){k=I})}g.data&&g.data.geometry&&T5.Geo.Position.vectorize(g.data.geometry).bind("complete",function(G,I){e=I;o.updateCoordinates(e,k,true)})})();return o};Na.LocationOverlay=function(g){g=COG.extend({pos:null,accuracy:null,zindex:90},g);var e=new Image,k=T5.XY.init(),o=T5.XY.init(),b=null;e.src=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
e.onload=function(){k=T5.XY.init(e.width>>1,e.height>>1)};var i=COG.extend(new T5.ViewLayer(g),{pos:g.pos,accuracy:g.accuracy,drawAccuracyIndicator:false,draw:function(m,G){var I=o.x-G.x,ba=o.y-G.y;if(b){m.fillStyle="rgba(30, 30, 30, 0.2)";m.beginPath();m.arc(I,ba,b,0,Math.PI*2,false);m.fill()}e.complete&&e.width>0&&m.drawImage(e,I-k.x,ba-k.y,e.width,e.height);i.changed()},update:function(m){if(m){b=m.getPixelDistance(i.accuracy)>>1;o=m.getGridXYForPosition(i.pos);i.changed()}}});i.bind("gridUpdate",
function(m,G){i.update(G)});return i};return{distanceToString:function(g){if(g>1E3)return~~(g/10)/100+" km";return g?g+" m":""},dist2rad:function(g){return g/6371},getEngine:function(g){for(var e=null,k=1;!e&&k<arguments.length;k++)e=d(g,arguments[k]);e=e?e:d(g);if(!e)throw Error("Unable to find GEO engine with "+g+" capability");return e},lat2pix:c,lon2pix:p,pix2lat:h,pix2lon:a,radsPerPixel:function(g){return ca/(256<<g)},Position:aa,BoundingBox:ya,Radius:function(g,e){return{distance:parseInt(g,
10),uom:e}},Address:function(g){return g=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},g)},A:pa,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(g){if(!g.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var e=COG.extend({remove:function(){delete engines[e.id]}},g);return engines[e.id]=e},Search:Ga,GeoSearchResult:Ea,LocationSearch:function(g){function e(m,G){navigator.geolocation.clearWatch(o);
o=0;if(b){clearTimeout(b);b=0}G&&G([m],g)}function k(m){COG.info("caught location tracking error:",m)}g=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},g);var o=0,b=0,i=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(m,G){if(navigator.geolocation&&!o){o=navigator.geolocation.watchPosition(function(I){var ba=aa.init(I.coords.latitude,I.coords.longitude);I=new Ea({id:1,caption:"Current Location",pos:ba,accuracy:I.coords.accuracy/1E3,matchWeight:100});
if(!i||I.accuracy<i.accuracy)i=I;if(!g.requiredAccuracy||i.accuracy<g.requiredAccuracy)e(i,G)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)b=setTimeout(function(){i&&e(i,G)},g.searchTimeout)}}},g))},Routing:kb}}();return Na}();
