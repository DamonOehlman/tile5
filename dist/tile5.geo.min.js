COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var P=arguments[0]||{},ha,L=1,A=arguments.length;L<A;L++)if((ha=arguments[L])!==null)for(var k in ha){var l=ha[k];if(P!==l)if(l!==undefined)P[k]=l}return P};
(function(){var P=Object.prototype.hasOwnProperty,ha=0,L={};L.toID=function(A){return A.replace(/\s/g,"-")};L.objId=function(A){return(A?A:"obj")+ha++};L.isFunction=function(A){return toString.call(A)==="[object Function]"};L.isArray=function(A){return toString.call(A)==="[object Array]"};L.isPlainObject=function(A){if(!A||toString.call(A)!=="[object Object]"||A.nodeType||A.setInterval)return false;if(A.constructor&&!P.call(A,"constructor")&&!P.call(A.constructor.prototype,"isPrototypeOf"))return false;
var k;for(k in A);return k===undefined||P.call(A,k)};L.isEmptyObject=function(A){for(var k in A)return false;return true};L.isXmlDocument=function(A){return toString.call(A)==="[object Document]"};L.contains=function(A,k){var l=A,v=arguments,D=1;if(k&&module.isArray(k)){v=k;D=0}for(D=D;D<v;D++)l=l&&typeof foo[v[D]]!=="undefined";return l};L.formatStr=function(A){if(arguments.length<=1)return A;for(var k=arguments.length-2,l=0;l<=k;l++)A=A.replace(RegExp("\\{"+l+"\\}","gi"),arguments[l+1]);return A};
L.wordExists=function(A,k){var l="";if(k.toString)k=k.toString();for(var v=0;v<k.length;v++)l+=!/\w/.test(k[v])?"\\"+k[v]:k[v];return RegExp("(^|\\s|\\,)"+l+"(\\,|\\s|$)","i").test(A)};COG.extend(COG,L)})();
(function(){function P(l){return typeof console!=="undefined"?function(){console[l](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ha=window.console&&window.console.markTimeline,L=P("error"),A=P("info"),k=function(){return ha?function(l,v){console.markTimeline(l+(v?": "+((new Date).getTime()-v)+"ms":""))}:function(){}}();COG.extend(COG,{trace:k,debug:P("debug"),info:A,warn:P("warn"),error:L,exception:function(l){if(L)for(var v in l)A("ERROR DETAIL: "+
v+": "+l[v])}})})();
(function(){function P(L,A){var k=L.hasOwnProperty("obsHandlers")?L.obsHandlers:null;k[A]||(k[A]=[]);return k[A]}var ha=0;COG.observable=function(L){if(!L)return null;if(!(L.hasOwnProperty("obsHandlers")?L.obsHandlers:null))L.obsHandlers={};if(!L.hasOwnProperty("bind")){L.bind=function(A,k){var l="callback"+ha++;P(L,A).unshift({fn:k,id:l});return l};L.triggerCustom=function(A,k){var l=P(L,A),v={cancel:false,name:A,source:this},D;k&&COG.extend(v,k);if(!l)return null;D=Array.prototype.slice.call(arguments,2);
L.eventInterceptor&&L.eventInterceptor(A,v,D);D.unshift(v);for(var U=l.length;U--&&!v.cancel;)l[U].fn.apply(this,D);return v};L.trigger=function(A){var k=Array.prototype.slice.call(arguments,1);k.splice(0,0,A,null);return L.triggerCustom.apply(this,k)};L.unbind=function(A,k){if(typeof A==="undefined")L.obsHandlers={};else for(var l=P(L,A),v=0;l&&v<l.length;v++)if(l[v].id===k){l.splice(v,1);break}return L}}return L}})();
(function(){function P(k,l){k[l]||(k[l]=function(v){return k.configure(l,v)})}function ha(k){k.gtConfId="configurable"+A++;k.gtConfig={};k.gtConfigFns=[];return k.gtConfig}var L={},A=0;COG.paramTweaker=function(k,l,v){return function(D,U){if(typeof U!=="undefined"){if(D in k)k[D]=U;v&&D in v&&v[D](D,U)}else return l&&D in l?l[D](D):k[D]}};COG.configurable=function(k,l,v,D){if(k){k.gtConfId||ha(k);var U=k.gtConfId,m=k.gtConfig,I=k.gtConfigFns;L[U]=k;I.push(v);for(v=l.length;v--;){m[l[v]]=true;D&&P(k,
l[v])}if(!k.configure)k.configure=function(B,J){if(m[B]){for(var x=I.length;x--;){var u=I[x](B,J);if(typeof u!=="undefined")return u}return L[U]}return null}}}})();
(function(){function P(k){var l=document.createElement("script"),v=false;l.src=k;l.async=true;l.onload=l.onreadystatechange=function(){if(!v&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){v=true;l.onload=l.onreadystatechange=null;l&&l.parentNode&&l.parentNode.removeChild(l)}};L||(L=document.getElementsByTagName("head")[0]);L.appendChild(l)}var ha=0,L,A=this;COG.jsonp=function(k,l,v){k+=k.indexOf("?")>=0?"&":"?";var D="json"+ ++ha;A[D]=function(U){l(U);A[D]=null;try{delete A[D]}catch(m){}};
P(k+(v?v:"callback")+"="+D);return D}})();
(function(){var P=1.70158,ha=Math.PI/2,L=1E3/60|0,A=Math.abs,k=Math.pow,l=Math.sin,v=Math.asin,D=Math.cos,U={linear:function(m,I,B,J){return B*m/J+I},backin:function(m,I,B,J){return B*(m/=J)*m*((P+1)*m-P)+I},backout:function(m,I,B,J){return B*((m=m/J-1)*m*((P+1)*m+P)+1)+I},backinout:function(m,I,B,J){return(m/=J/2)<1?B/2*m*m*(((P*=1.525)+1)*m-P)+I:B/2*((m-=2)*m*(((P*=1.525)+1)*m+P)+2)+I},bouncein:function(m,I,B,J){return B-U.bounceout(J-m,0,B,J)+I},bounceout:function(m,I,B,J){return(m/=J)<1/2.75?
B*7.5625*m*m+I:m<2/2.75?B*(7.5625*(m-=1.5/2.75)*m+0.75)+I:m<2.5/2.75?B*(7.5625*(m-=2.25/2.75)*m+0.9375)+I:B*(7.5625*(m-=2.625/2.75)*m+0.984375)+I},bounceinout:function(m,I,B,J){return m<J/2?U.bouncein(m*2,0,B,J)/2+I:U.bounceout(m*2-J,0,B,J)/2+B/2+I},cubicin:function(m,I,B,J){return B*(m/=J)*m*m+I},cubicout:function(m,I,B,J){return B*((m=m/J-1)*m*m+1)+I},cubicinout:function(m,I,B,J){if((m/=J/2)<1)return B/2*m*m*m+I;return B/2*((m-=2)*m*m+2)+I},elasticin:function(m,I,B,J,x,u){if(m==0)return I;if((m/=
J)==1)return I+B;u||(u=J*0.3);if(!x||x<A(B)){x=B;B=u/4}else B=u/TWO_PI*v(B/x);return-(x*k(2,10*(m-=1))*l((m*J-B)*TWO_PI/u))+I},elasticout:function(m,I,B,J,x,u){var G;if(m==0)return I;if((m/=J)==1)return I+B;u||(u=J*0.3);if(!x||x<A(B)){x=B;G=u/4}else G=u/TWO_PI*v(B/x);return x*k(2,-10*m)*l((m*J-G)*TWO_PI/u)+B+I},elasticinout:function(m,I,B,J,x,u){var G;if(m==0)return I;if((m/=J/2)==2)return I+B;u||(u=J*0.3*1.5);if(!x||x<A(B)){x=B;G=u/4}else G=u/TWO_PI*v(B/x);if(m<1)return-0.5*x*k(2,10*(m-=1))*l((m*
J-G)*TWO_PI/u)+I;return x*k(2,-10*(m-=1))*l((m*J-G)*TWO_PI/u)*0.5+B+I},quadin:function(m,I,B,J){return B*(m/=J)*m+I},quadout:function(m,I,B,J){return-B*(m/=J)*(m-2)+I},quadinout:function(m,I,B,J){if((m/=J/2)<1)return B/2*m*m+I;return-B/2*(--m*(m-2)-1)+I},sinein:function(m,I,B,J){return-B*D(m/J*ha)+B+I},sineout:function(m,I,B,J){return B*l(m/J*ha)+I},sineinout:function(m,I,B,J){return-B/2*(D(Math.PI*m/J)-1)+I}};COG.tweenValue=function(m,I,B,J,x){function u(la){la=la?la:(new Date).getTime();if(xa+L<
la){var pa=la-G,ga=B(pa,m,oa,J),ya=G+J<=la;la=!ya;if(x){pa=x(ga,ya,pa);la=typeof pa!="undefined"?pa&&la:la}la&&animFrame(u)}}var G=(new Date).getTime(),xa=0,oa=I-m;animFrame(u);return{}};COG.easing=function(m){return U[m.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(m,I){U[m.replace(/[\-\_\s\.]/g,"").toLowerCase()]=I}})();
(function(){var P=/^P(\d+Y)?(\d+M)?(\d+D)?$/,ha=/^(\d+H)?(\d+M)?(\d+S)?$/,L={8601:function(k){k=k.split("T");var l=null;l=null;var v=0,D=0;P.lastIndex=-1;l=P.exec(k[0]);v+=l[3]?parseInt(l[3].slice(0,-1),10):0;ha.lastIndex=-1;l=ha.exec(k[1]);D+=l[1]?parseInt(l[1].slice(0,-1),10)*3600:0;D+=l[2]?parseInt(l[2].slice(0,-1),10)*60:0;D+=l[3]?parseInt(l[3].slice(0,-1),10):0;return new A(v,D)}},A=COG.Duration=function(k,l){return{days:k?k:0,seconds:l?l:0}};COG.addDuration=function(){for(var k=new A,l=arguments.length;l--;){k.days+=
arguments[l].days;k.seconds+=arguments[l].seconds}if(k.seconds>=86400){k.days+=~~(k.seconds/86400);k.seconds%=86400}return k};COG.formatDuration=function(k){var l,v,D="";if(k.days)D=k.days+" days ";if(k.seconds){k=k.seconds;if(k>=3600){l=~~(k/3600);k-=l*3600}if(k>=60){v=Math.round(k/60);k-=v*60}if(l)D=D+l+(l>1?" hrs ":" hr ")+(v?(v>10?v:"0"+v)+" min ":"");else if(v)D=D+v+" min";else if(k>0)D=D+(k>10?k:"0"+k)+" sec"}return D};COG.parseDuration=function(k,l){var v=l?L[l]:null;if(v)return v(k);COG.Log.warn("Could not find duration parser for specified format: "+
l);return new A}})();COG.ObjectStore=function(){var P={},ha={},L="obj_"+(new Date).getTime(),A=0,k=Object.prototype.hasOwnProperty;return{add:function(l,v){var D;v=v?v:"default";if(l&&l.constructor)if(!k.call(l,"id"))l.id=L+ ++A;D=ha[v]?ha[v]:ha[v]=[];P[l.id]=D.length;D[l.length]=l}}};var CANI={};
(function(P){var ha=[],L=0,A=false,k=P.register=function(l,v){ha.push({section:l,run:v})};P.init=function(l){function v(){if(L<ha.length){var U=ha[L++];D[U.section]||(D[U.section]={});U.run(D[U.section],v)}else{for(U in D)P[U]=D[U];A=true;l&&l(P)}}var D={};if(A&&l)l(P);else{L=0;v()}};k("canvas",function(l,v){function D(){var B,J=U.getContext("2d");J.save();try{J.translate(50,50);J.beginPath();J.rect(0,0,20,20);B=J.isPointInPath(10,10)}finally{J.restore()}return B}var U=document.createElement("canvas"),
m=typeof FlashCanvas!="undefined",I=typeof G_vmlCanvasManager!="undefnined";U.width=200;U.height=200;l.pipTransformed=m||I?false:D();v()})})(CANI);
INTERACT=function(){function P(x){return function(u,G,xa){(xa?xa:x?document.body:document).addEventListener(u,G,false)}}function ha(x){return function(u,G,xa){(xa?xa:x?document.body:document).removeEventListener(u,G,false)}}function L(x,u,G){(G?G:document).attachEvent("on"+x,u)}function A(x,u,G){(G?G:document).detachEvent("on"+x,u)}function k(x,u){return{x:x?x:0,y:u?u:0,count:1}}function l(x,u){B.push(COG.extend({handler:null,checks:{},type:x},u))}function v(x){var u=0,G=0;if(x.offsetParent){do{u+=
x.offsetLeft;G+=x.offsetTop;x=x.offsetParent}while(x)}return{left:u,top:G}}function D(x,u){return{source:x,target:u.target?u.target:u.srcElement}}function U(x,u){for(var G=x.target?x.target:x.srcElement;G&&G!==u&&G.nodeName&&G.nodeName.toUpperCase()!="CANVAS";)G=G.parentNode;return G&&G===u}function m(x,u){return{x:x.x-(u?u.left:0),y:x.y-(u?u.top:0)}}function I(x){if(x.preventDefault){x.preventDefault();x.stopPropagation()}else x.cancelBubble&&x.cancelBubble()}var B=[],J=function(x,u,G){function xa(ba,
qa,ma,Y){var V=0,za=0,E=0;COG.tweenValue(0,ba,ma,Y,function(W){E=V;V=W});COG.tweenValue(0,qa,ma,Y,function(W){oa.trigger("pan",V-E,W-za);za=W})}G=COG.extend({binder:null,unbinder:null,observable:null},G);for(var oa=G.observable,la=null,pa=[],ga=[],ya,Ma,Ba={bind:function(){return oa.bind.apply(null,arguments)},pannable:function(ba){la=COG.extend({inertia:true},ba);return Ba},unbind:function(){oa.unbind();for(var ba=0;ba<pa.length;ba++)pa[ba].unbind();return Ba}},Ia=0;Ia<u.length;Ia++)pa.push(u[Ia](x,
oa,G));oa.bind("pointerDown",function(){ga=[];Ma=ya=0});oa.bind("pointerMove",function(ba,qa,ma,Y){if(la){ga[ga.length]={ticks:(new Date).getTime(),x:Y.x,y:Y.y};oa.trigger("pan",Y.x,Y.y)}ya+=Y.x?Y.x:0;Ma+=Y.y?Y.y:0});oa.bind("pointerUp",function(ba,qa,ma){if(Math.abs(ya)>20||Math.abs(Ma)>20){if(la){ma=ga.length;var Y,V;qa=0;for(V=ga.length;--V>1&&qa<50;)qa+=ga[V].ticks-ga[V-1].ticks;if(ma-V>1){ba=ga[ma-1].x-ga[V].x;Y=ga[ma-1].y-ga[V].y;V=Math.sqrt(ba*ba+Y*Y)|0;if(V>15){ba=ga[ma-1].x-ga[0].x;Y=ga[ma-
1].y-ga[0].y;V=Math.sqrt(ba*ba+Y*Y)|0;ma=Math.asin(Y/V);qa=V*500/qa|0;qa=qa>300?300:qa;xa(Math.cos(ba>0?ma:Math.PI-ma)*qa,Math.sin(ma)*qa,COG.easing("sine.out"),500)}}}}else oa.trigger("tap",qa,ma)});return Ba};l("pointer",{handler:function(x,u,G){function xa(E){if(E.pageX&&E.pageY)return k(E.pageX,E.pageY);else{var W=document.documentElement,ua=document.body;return k(E.clientX+(W&&W.scrollLeft||ua&&ua.scrollLeft||0)-(W&&W.clientLeft||ua&&ua.clientLeft||0),E.clientY+(W&&W.scrollTop||ua&&ua.scrollTop||
0)-(W&&W.clientTop||ua&&ua.clientTop||0))}}function oa(E){if(U(E,x))if(ba=ya(E)){var W=xa(E);x.style.cursor="move";I(E);V=W.x;za=W.y;qa=k(V,za);u.triggerCustom("pointerDown",D("mouse",E),qa,m(qa,v(x)))}}function la(E){var W=xa(E);ma=W.x;Y=W.y;if(U(E,x))Ma(E,ba?"pointerMove":"pointerHover")}function pa(E){if(ba&&ya(E)){ba=false;if(U(E,x)){x.style.cursor="default";Ma(E,"pointerUp")}}}function ga(E){if(U(E,x)){var W;E=E||window.event;if(E.detail)W=E.axis===2?-E.detail*Ba:0;else{W=E.wheelDeltaY?E.wheelDeltaY:
E.wheelDelta;if(window.opera)W=-W}if(W!==0){var ua=k(ma,Y);u.triggerCustom("zoom",D("mouse",E),ua,m(ua,v(x)),W/Ia,"wheel");I(E);E.returnValue=false}}}function ya(E){E=E||window.event;return(E.which||E.button)==1}function Ma(E,W,ua,X,eb){ua=typeof ua!="undefined"?ua:ma;X=typeof X!="undefined"?X:Y;var M=ua-V,na=X-za,T=k(ua,X);u.triggerCustom(W,D("mouse",E),T,m(T,v(x)),k(M,na));if(typeof eb=="undefined"||eb){V=ua;za=X}}G=COG.extend({},G);var Ba=120,Ia=Ba*8,ba=false,qa,ma,Y,V,za;G.binder("mousedown",
oa,false);G.binder("mousemove",la,false);G.binder("mouseup",pa,false);G.binder("dblclick",function(E){COG.info("captured double click");if(U(E,x)){var W=xa(E);u.triggerCustom("doubleTap",D("mouse",E),W,m(W,v(x)))}},false);G.binder("mousewheel",ga,document);G.binder("DOMMouseScroll",ga,document);return{unbind:function(){G.unbinder("mousedown",oa,false);G.unbinder("mousemove",la,false);G.unbinder("mouseup",pa,false);G.unbinder("mousewheel",ga,document);G.unbinder("DOMMouseScroll",ga,document)}}},checks:{touch:false}});
l("pointer",{handler:function(x,u,G){function xa(M){if(M.count<2)return 0;var na=M.x-M.next.x;M=M.y-M.next.y;return~~Math.sqrt(na*na+M*M)}function oa(M,na,T){na=na?na:0;T=T?T:0;for(var Na={x:M.x-na,y:M.y-T,id:M.id,count:M.count},Ja=Na;M.next;){M=M.next;Ja=Ja.next={x:M.x-na,y:M.y-T,id:M.id}}return Na}function la(M,na){var T=M[na?na:"touches"],Na,Ja;if(T.length===0)return null;Ja=Na={x:T[0].pageX,y:T[0].pageY,id:T[0].identifier,count:T.length};for(var Va=1,jb=T.length;Va<jb;Va++)Ja=Ja.next={x:T[Va].pageX,
y:T[Va].pageY,id:T[Va].identifier};return Na}function pa(M){if(U(M,x)){Y=v(x);var na=la(M,"changedTouches"),T=oa(na,Y.left,Y.top);if(!za){V=ba;u.triggerCustom("pointerDown",D("touch",M),na,T)}X&&u.triggerCustom("pointerDownMulti",D("touch",M),na,T);za=la(M);if(za.count>1)W=xa(za);eb=1;ua=oa(za)}}function ga(M){if(U(M,x)){M.preventDefault();E=la(M);if(V==ba)V=Math.abs(za.x-E.x)>Ba||Math.abs(za.y-E.y)>Ba?Ia:ba;if(V!=ba){V=E.count>1?ma:qa;if(V==ma)if(za.count===1){za=oa(E);W=xa(za)}else{var na=xa(E);
if(Math.abs(W-na)<Ma)V=qa;else{var T;T=E.x;var Na=E.next.x,Ja=E.y,Va=E.next.y,jb=Ja<Va?Ja:Va;T={x:(T<Na?T:Na)+(Math.abs(T-Na)>>1),y:jb+(Math.abs(Ja-Va)>>1)};na=na/W;Na=na-eb;u.triggerCustom("zoom",D("touch",M),T,m(T,Y),Na,"pinch");eb=na}}V==qa&&u.triggerCustom("pointerMove",D("touch",M),E,oa(E,Y.left,Y.top),k(E.x-ua.x,E.y-ua.y));X&&u.triggerCustom("pointerMoveMulti",D("touch",M),E,oa(E,Y.left,Y.top))}ua=oa(E)}}function ya(M){if(U(M,x)){var na=la(M,"changedTouches"),T=oa(na,Y.left,Y.top);E=la(M);if(!E){u.triggerCustom("pointerUp",
D("touch",M),na,T);za=null}X&&u.triggerCustom("pointerUpMulti",D("touch",M),na,T)}}G=COG.extend({detailed:false,inertia:false},G);var Ma=20,Ba=7,Ia=0,ba=1,qa=2,ma=3,Y,V,za,E,W,ua,X=G.detailed,eb=1;G.binder("touchstart",pa,false);G.binder("touchmove",ga,false);G.binder("touchend",ya,false);COG.info("initialized touch handler");return{unbind:function(){G.unbinder("touchstart",pa,false);G.unbinder("touchmove",ga,false);G.unbinder("touchend",ya,false)}}},checks:{touch:true}});return{register:l,watch:function(x,
u,G){u=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},u);capabilities=COG.extend({touch:"ontouchstart"in window},G);if(!u.observable){COG.info("creating observable");u.observable=COG.observable({});globalOpts=u}u.binder=u.isIE?L:P(u.bindToBody);u.unbinder=u.isIE?A:ha(u.bindToBody);G=u.types;for(var xa=capabilities,oa=[],la=B.length;la--;){var pa=B[la],ga=!G||G.indexOf(pa.type)>=0,ya=true;for(var Ma in pa.checks){var Ba=pa.checks[Ma];COG.info("checking "+
Ma+" capability. require: "+Ba+", capability = "+xa[Ma]);ya=ya&&Ba===xa[Ma]}if(ga&&ya)oa[oa.length]=pa.handler}return new J(x,oa,u)}}}();var T5={};
(function(P){function ha(){return(new Date).getTime()}function L(){for(;jb.length>0;){var b=jb.shift();document.location=b}Va=0}function A(b){for(var i=true,d=Jb.length;d--;)i=i&&b!=Jb[d];return i}function k(b,i){var d=[];for(var e in i)e&&d.push(e+"="+escape(i[e]));return"tile5://"+b+"/"+(d.length>0?"?"+d.join("&"):"")}function l(b,i){A(b)&&COG.info("would push url: "+k(b,i))}function v(b,i){if(A(b)){jb.push(k(b,i));Va||(Va=setTimeout(L,100))}}function D(b){return function(i,d,e){(e?e:b?document.body:
document).addEventListener(i,d,false)}}function U(b){return function(i,d,e){(e?e:b?document.body:document).removeEventListener(i,d,false)}}function m(b,i,d){(d?d:document).attachEvent("on"+b,i)}function I(b,i,d){(d?d:document).detachEvent("on"+b,i)}function B(){T={base:{name:"Unknown",bindEvent:D(),unbindEvent:U(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:l,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:m,unbindEvent:I,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:v,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:v},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:v},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:D(true),unbindEvent:U(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:v},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:v}};Na=[T.froyo,T.android,T.ipod,T.iphone,T.ipad,T.ie]}function J(){T||B();if(!Ja){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<Na.length;b++){var i=Na[b];if(i.regex&&i.regex.test(navigator.userAgent)){Ja=COG.extend({},T.base,i);COG.info("PLATFORM DETECTED AS: "+Ja.name);break}}if(!Ja){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Ja=T.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Ja}function x(){var b=(new Date).getTime(),i=0;clearTimeout(pb);for(pb=0;i<nb.length;){var d=nb[i],e=kb[d],h=kb[d].image&&(Kb||kb[d].image.complete&&kb[d].image.width>0),t=b-e.start;t=h||t>=Ub;if(h){h=e.image;e=e.callbacks;Lb[d]=h;for(var n=0;n<e.length;n++)e[n](h,true)}if(t){nb.splice(i,1);delete kb[d]}else i++}if(nb.length>0)pb=setTimeout(x,Mb)}function u(){for(var b=0,i=arguments.length;i--;){var d=Vb[arguments[i].toUpperCase()];
if(d)b|=d}return b}function G(b,i){var d,e;if(i&&i.width>0){if(!b.imageOffset)b.imageOffset=X.init(-i.width>>1,-i.height>>1);if(!b.bounds){d=b.xy.x+b.imageOffset.x;e=b.xy.y+b.imageOffset.y;b.bounds=M.init(d,e,d+i.width,e+i.height)}}}function xa(b){var i=qb.length==0;qb[qb.length]=b;i&&animFrame(oa)}function oa(b){b=b?b:(new Date).getTime();if(b-Nb>Wb){for(var i=qb.splice(0),d=i.length;d--;)i[d](b);Nb=b}qb.length&&animFrame(oa)}function la(b){function i(){b.transformed=e!==1||d%pa!==0||h!==0||t!==
0}var d=0,e=1,h=0,t=0;COG.extend(b,{animate:function(n,r,z,y){y=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},y);var O=(new Date).getTime(),w=b[n],N=y.autoInvalidate,Z=r.length&&z.length&&r.length==z.length?r.length:0,$=Array(Z),ca=Array(Z),fa=COG.easing(y.easing),S=y.duration,Aa=y.progress,ta=function(Ca){var Ya=Ca-O;Ca=O+S<=Ca;for(var ia=Z;ia--;)ca[ia]=fa(Ya,r[ia],$[ia],S);w.apply(b,ca);N&&b.invalidate.call(b);if(Aa){Ya=[].concat(Ca?z:ca);Ya.unshift(Ca);
Aa.apply(b,Ya)}if(Ca){w.apply(b,z);y.complete&&y.complete.apply(b,z)}else xa(ta)};if(w&&w.apply&&Z>0){S=S?S:1E3;for(n=Z;n--;)$[n]=z[n]-r[n];xa(ta)}},rotate:function(n){d=n;i()},scale:function(n){e=n;i()},translate:function(n,r){h=n;t=r;i()},transform:function(n,r,z){n.save();n.translate(b.xy.x-r+h,b.xy.y-z+t);d!==0&&n.rotate(d);e!==1&&n.scale(e,e)}})}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var pa=Math.PI*2,ga=Math.PI/2,ya=Math.abs,Ma=Math.ceil,Ba=Math.min,Ia=Math.max,ba=Math.pow,qa=Math.sqrt,ma=Math.log,Y=Math.round,V=Math.sin,za=Math.asin,E=Math.cos,W=Math.atan,ua=Math.atan2,X=function(){function b(e,h){return d(e.x-h.x,e.y-h.y)}function i(e,h){if(!h)h=e.length;if(h<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var t={edges:Array(h-1),
accrued:Array(h-1),total:0},n=0;n<h-1;n++){var r=b(e[n],e[n+1]);t.edges[n]=qa(r.x*r.x+r.y*r.y);t.accrued[n]=t.total+t.edges[n];t.total+=t.edges[n]}return t}function d(e,h){return{x:e?e:0,y:h?h:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var e=0,h=0,t=arguments.length;t--;){e+=arguments[t].x;h+=arguments[t].y}return d(e,h)},absSize:function(e){return Ia(ya(e.x),ya(e.y))},copy:function(e){return e?d(e.x,e.y):null},diff:b,distance:function(e,h){return i(e,h).total},
edges:i,equals:function(e,h){return e.x===h.x&&e.y===h.y},extendBy:function(e,h,t){var n=E(h)*t|0;h=V(h)*t|0;return d(e.x-n,e.y-h)},floor:function(e){for(var h=Array(e.length),t=e.length;t--;)h[t]=d(~~e[t].x,~~e[t].y);return h},getRect:function(e){for(var h,t,n,r,z=e.length;z--;){var y=e[z];h=typeof h==="undefined"||y.x<h?y.x:h;t=typeof t==="undefined"||y.y<t?y.y:t;n=typeof n==="undefined"||y.x>n?y.x:n;r=typeof r==="undefined"||y.y>r?y.y:r}return M.init(h,t,n,r)},init:d,invert:function(e){return d(-e.x,
-e.y)},min:function(e,h){return d(e.x<h.x?e.x:h.x,e.y<h.y?e.y:h.y)},max:function(e,h){return d(e.x>h.x?e.x:h.x,e.y>h.y?e.y:h.y)},offset:function(e,h,t){return d(e.x+h,e.y+(t?t:h))},scale:function(e,h){return d(e.x/h|0,e.y/h|0)},simplify:function(e,h){if(!e)return null;h=h?h:X.VECTOR_SIMPLIFICATION;for(var t=[],n=null,r=e.length;r--;){var z=e[r];if(include=!n||r===0||ya(z.x-n.x)+ya(z.y-n.y)>h){t.unshift(z);n=z}}return t},theta:function(e,h,t){t=za((e.y-h.y)/t);return e.x>h.x?t:Math.PI-t},toString:function(e){return e?
e.x+", "+e.y:""}}}(),eb=function(){return{dotProduct:function(b,i){return b.x*i.x+b.y*i.y}}}(),M=function(){function b(d){return i(d.x1,d.y1,d.x2,d.y2)}function i(d,e,h,t){d=d?d:0;e=e?e:0;h=typeof h!=="undefined"?h:d;t=typeof t!=="undefined "?t:t;return{x1:d,y1:e,x2:h,y2:t,width:h-d,height:t-e}}return{center:function(d){return X.init(d.x1+(d.width>>1),d.y1+(d.height>>1))},copy:b,diagonalSize:function(d){return qa(d.width*d.width+d.height*d.height)},fromCenter:function(d,e,h,t){h=h>>1;t=t>>1;return i(d-
h,e-t,d+h,e+t)},init:i,intersect:function(d,e){var h=Ia(d.x1,e.x1),t=Ia(d.y1,e.y1),n=Ba(d.x2,e.x2),r=Ba(d.y2,e.y2);h=i(h,t,n,r);return h.width>0&&h.height>0?h:null},toString:function(d){return d?"["+d.x1+", "+d.y1+", "+d.x2+", "+d.y2+"]":""},union:function(d,e){if(d.width===0||d.height===0)return b(e);else if(e.width===0||e.height===0)return b(d);else{var h=Ba(d.x1,e.x1),t=Ba(d.y1,e.y1),n=Ia(d.x2,e.x2),r=Ia(d.y2,e.y2);h=i(h,t,n,r);return h.width>0&&h.height>0?h:null}}}}(),na=function(){return{getAspectRatio:function(b){return b.height!==
0?b.width/b.height:1},getCenter:function(b){return X.init(b.width>>1,b.height>>1)},getSize:function(b){return qa(ba(b.width,2)+ba(b.height,2))},init:function(b,i){b=b?b:0;return{width:b,height:i?i:b}}}}();Hits=function(){return{diffHits:function(b,i){var d=[],e={},h;for(h=i.length;h--;)e[i[h].target.id]=true;for(h=b.length;h--;)e[b[h].target.id]||(d[d.length]=b[h]);return d},init:function(b,i,d,e){return{type:b,x:e.x|0,y:e.y|0,elements:[],absXY:i,relXY:d}},initHit:function(b,i,d){return d=COG.extend({type:b,
target:i,drag:false},d)},triggerEvent:function(b,i,d,e){i.triggerCustom(b.type+(d?d:"Hit"),{hitType:b.type},e?e:b.elements,b.absXY,b.relXY,X.init(b.x,b.y))}}}();var T=null,Na=[],Ja=null,Va=0,jb=[],Jb=["view.wake","tile.loaded"],Mb=100,Ub=3E4,Lb={},Xb=0;(new Date).getTime();var kb={},nb=[],Kb=typeof FlashCanvas!="undefined",pb=0,yb=T5.getImage=function(b,i){var d=b&&i?Lb[b]:null;if(d&&d&&(Kb||d.complete&&d.width>0))i(d);else{if(d=kb[b])d.callbacks.push(i);else{d=new Image;d.id="_ldimg"+ ++Xb;kb[b]=
{start:(new Date).getTime(),image:d,callbacks:[i]};d.src=b;nb[nb.length]=b}pb||(pb=setTimeout(x,Mb))}};T5.newCanvas=function(b,i){var d=document.createElement("canvas");d.width=b?b:0;d.height=i?i:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(d);FlashCanvas.initElement(d)}typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(d);return d};var zb=function(){var b={};return{init:function(i,d){var e=b[i];if(!e)throw Error("Unable to locate requested generator: "+i);return new e(d)},
register:function(i,d){b[i]=d},Template:function(){}}}(),rb=function(){function b(n,r){h[n]=d(r);return n}function i(n){for(var r in n)b(r,n[r])}function d(n){function r(w){var N=n[w];typeof N!=="undefined"&&y.push(function(Z){Z[w]=N})}function z(){y=[];for(var w in n)r(w)}n=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},n);var y=[],O={applyToContext:function(w){for(var N=
y.length;N--;)y[N](w)},update:function(w,N){n[w]=N;z()}};z();return O}var e={},h={},t={apply:function(n,r){var z=h[r]?h[r]:h.basic,y;if(n&&n.canvas){y=e[n.canvas.id];e[n.canvas.id]=r}z.applyToContext(n);return y},define:b,defineMany:i,get:function(n){return h[n]},init:d,load:function(n){COG.jsonp(n,function(r){i(r)})}};i({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",
fillStyle:"#FFF"}});return t}(),Vb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Sb=function(b){function i(q,s,F){Xa||Pa(va-s,f-F)}function d(q,s,F,ja){ia(Ba(Ia(Ha+ba(2,ja)-1,0.5),2))}function e(){var q=ma(Ha)/Math.LN2|0;if(q!==0){Ha=ba(2,q);fb(sb+q,tb,ub)}ta()}function h(q){q||(q=X.init(Da,R));Q=X.init(va,f);aa=X.offset(q,va,f);tb=aa.x;ub=aa.y}function t(q,s){var F=1/Ha;return X.init(da?da.x1+q*F:q,da?da.y1+s*F:s)}function n(q,s,F){gb("doubleTap",s,F,t(F.x,F.y));b.scalable&&ia(2,F,b.zoomEasing,
null,b.zoomDuration)}function r(q,s,F){Xa=null;Aa("down",s,F)}function z(q,s,F){Aa("hover",s,F)}function y(q,s,F){fa(s,F,false)}function O(q,s,F){fa(s,F,true)}function w(){clearTimeout(Ob);Ob=setTimeout(Z,250)}function N(q,s,F){Aa("tap",s,F);gb("tap",s,F,t(F.x,F.y,true))}function Z(q,s){var F;lb=typeof FlashCanvas!=="undefined";COG.info("is flash = "+lb);if(Ea){if(b.autoSize&&Ea.parentNode){q=Ea.parentNode.offsetWidth;s=Ea.parentNode.offsetHeight}try{if(!Ea.id)Ea.id=b.id+"_canvas";Ka=Ea.getContext("2d")}catch(ja){COG.exception(ja);
throw Error("Could not initialise canvas on specified view element");}if(q&&s&&(Qa!==s||Ra!==q)){Ab=true;Ra=q;Qa=s;Da=Ra>>1;R=Qa>>1;Ga.trigger("resize",Ra,Qa);for(F=Oa;F--;)ka[F].trigger("resize",Ra,Qa)}for(F=Oa;F--;)ka[F].trigger("contextChanged",Ka);ta();ca()}}function $(q,s){s.setId(q);s.added=ha();s.bind("remove",function(){Ga.removeLayer(q)});s.trigger("contextChanged",Ka);s.setParent(Ga);ka.push(s);ka.sort(function(F,ja){var ra=ja.zindex-F.zindex;if(ra===0)ra=ja.added-F.added;return ra});Oa=
ka.length;return s}function ca(){Wa&&Wa.unbind();Wa=INTERACT.watch(Ea);b.pannable&&Wa.pannable().bind("pan",i);if(b.scalable){Wa.bind("zoom",d);Wa.bind("doubleTap",n)}Wa.bind("pointerDown",r);Wa.bind("pointerMove",y);Wa.bind("pointerUp",O);b.captureHover&&Wa.bind("pointerHover",z);Wa.bind("tap",N)}function fa(q,s,F){if(Xa){q=t(s.x,s.y);Xa.drag.call(Xa.target,Xa,q.x,q.y,F)&&ta();if(F)Xa=null}}function S(q){var s,F,ja=false;if(Bb|lb){q=q?q:(new Date).getTime();if(q-Pb>Yb){F=va!==j||f!==o;cb=Qb|(Ha!==
1?Rb:0)|(F?Cb:0)|(Db?Eb:0);sa=(s=(cb&(Rb|Cb))!==0)&&(cb&Eb)===0;if(Ab&&Ea){Ea.width=Ra;Ea.height=Qa;Ea.style.width=Ra+"px";Ea.style.height=Qa+"px";lb&&FlashCanvas.initElement(Ea);typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(Ea);Ab=false}H=Ca();for(F=Oa;F--;){cb|=ka[F].animated?Eb:0;ka[F].cycle(q,H,cb);ja=ka[F].clip||ja}F=cb;var ra=H;ja=C&&ja&&!s;s=q;var La;M.center(ra);var Sa=0,Ta;if(Ha!==1){Ta=1/Ha;tb=aa.x+(va-Q.x);ub=aa.y+(f-Q.y);Ta=ra?M.fromCenter(tb>>0,ub>>0,ra.width*
Ta>>0,ra.height*Ta>>0):void 0}else Ta=M.copy(ra);da=Ta;ja||Ka.clearRect(0,0,Ra,Qa);da.scaleFactor=Ha;Ka.save();try{Ha!==1&&Ka.scale(Ha,Ha);Za=wa=null;if(ja){Ka.beginPath();for(Sa=Oa;Sa--;)ka[Sa].clip&&ka[Sa].clip(Ka,da,F,Ga,s);Ka.closePath();Ka.clip()}Ka.globalCompositeOperation="source-over";for(Sa=Oa;Sa--;){La=ka[Sa];if(La.shouldDraw(cb,H)){var Ua=La.style,hb=Ua?rb.apply(Ka,Ua):null;La.draw(Ka,da,F,Ga,s,K);hb&&rb.apply(Ka,hb)}}}finally{Ka.restore()}Bb=0;gb("drawComplete",ra,s);if(K){La=K?K.elements:
[];if(ib&&ib.type==="hover"){Ua=Hits.diffHits(ib.elements,La);Ua.length>0&&Hits.triggerEvent(ib,Ga,"Out",Ua)}if(La.length>0){hb=K.x;F=K.y;for(Ua=La.length;Ua--;){ra=La[Ua];ja=hb;s=F;if(Sa=ra&&ra.drag&&(!ra.canDrag||ra.canDrag(ra,ja,s))){Xa=ra;Xa.startX=ja;Xa.startY=s}if(Sa)break}Hits.triggerEvent(K,Ga)}ib=La.length>0?COG.extend({},K):null;K=null}q-ab>Fb&&Ya();Pb=q;j=va;o=f}animFrame(S)}else ea=false}function Aa(q,s,F){K=Hits.init(q,s,F,t(F.x,F.y,true));for(q=Oa;q--;)db=db||(ka[q].hitGuess?ka[q].hitGuess(K.x,
K.y,cb,Ga):false);db&&ta()}function ta(){Bb+=1;if(!ea){ea=true;animFrame(S)}}function Ca(){return M.init(va,f,va+Ra,f+Qa)}function Ya(){if(p||a){var q=c?va+Da:va,s=g?f+R:f;if(p&&p>Ra)if(q+Ra>p)va=c?q-p>0?va-p:va:p-Ra;else if(q<0)va=c?va+p:0;if(a&&a>Qa)if(s+Qa>a)f=g?s-a>0?f-a:f:a-Qa;else if(s<0)f=g?f+a:0}ab=(new Date).getTime();gb("refresh",Ga,Ca());ta()}function ia(q,s,F,ja,ra){if(F)COG.tweenValue(Ha,q,F,ra,function(La,Sa){Ha=La;if(Sa){var Ta=Y(ma(Ha)/Math.LN2);Ha=ba(2,Ta);ja&&ja()}h(s);e()});else{Ha=
q;h(s);e()}return Ga}function fb(q,s,F){q=Ia(b.minZoom,Ba(b.maxZoom,q));if(q!==sb){var ja=ba(2,q-sb),ra=Da/ja|0,La=R/ja|0;sb=q;Pa(((s?s:va+Da)-ra)*ja,((F?F:f+R)-La)*ja);j=va;o=f;gb("zoomLevelChange",q);Ha=1;Ya()}}function gb(){for(var q=Ga.trigger.apply(null,arguments).cancel,s=ka.length;s--;)q=ka[s].trigger.apply(null,arguments).cancel||q;return!q}function Pa(q,s,F,ja,ra){function La(){Sa+=1;if(Sa>=2){Db=false;ra&&ra()}}var Sa=0,Ta=wa?X.offset(wa,-Da,-R):null,Ua=Za?X.offset(Za,-Da,-R):null;if(Ta){q=
q<Ta.x?Ta.x:q;s=s<Ta.y?Ta.y:s}if(Ua){q=q>Ua.x?Ua.x:q;s=s>Ua.y?Ua.y:s}if(F){if((cb&Cb)===0){COG.tweenValue(va,q,F,ja,function(hb,Gb){va=hb|0;(Gb?La:ta)();return!sa});COG.tweenValue(f,s,F,ja,function(hb,Gb){f=hb|0;(Gb?La:ta)();return!sa});Db=true}}else{va=q|0;f=s|0;ta();ra&&ra()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,
pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var ka=[],Oa=0,Ea=document.getElementById(b.container),Xa=null,Ka=null,Hb=typeof window.attachEvent!="undefined",lb,db=false,Fb=b.minRefresh,va=0,f=0,j=0,o=0,p=null,a=null,c=false,g=false,C=b.clipping,H=null,ea=false,da,Fa=1,Da=0,R=0,K=null,Q=null,aa=null,sa=false,wa=null,Za=null,ab=0,ib=null,Ob=0,Ha=1,Pb=0,Ab=false,Wa=null,Db=
false,Qa,Ra,Yb=1E3/b.fps|0,Bb=0,tb,ub,sb=b.zoomLevel,Qb=u("ACTIVE"),Cb=u("PAN"),Rb=u("ZOOM"),Eb=u("ANIMATING"),cb=Qb,Ga={id:b.id,deviceScaling:Fa,fastDraw:b.fastDraw||J().requireFastDraw,detach:function(){Wa&&Wa.unbind()},eachLayer:function(q){for(var s=Oa;s--;)q(ka[s])},getDimensions:function(){return na.init(Ra,Qa)},getLayer:function(q){for(var s=0;s<Oa;s++)if(ka[s].getId()==q)return ka[s];return null},getZoomLevel:function(){return sb},setLayer:function(q,s){for(var F=0;F<Oa;F++)if(ka[F].getId()===
q){ka.splice(F,1);break}if(s){$(q,s);s.trigger("refresh",Ga,Ca())}ta();return s},invalidate:ta,refresh:Ya,resetScale:function(){Ha=1},resize:function(q,s){if(Ea){b.autoSize=false;if(Ra!==q||Qa!==s)Z(q,s)}},scale:ia,setZoomLevel:fb,syncXY:function(){},triggerAll:gb,removeLayer:function(q){a:{for(var s=Oa;s--;)if(ka[s].getId()==q){q=s;break a}q=-1}if(q>=0&&q<Oa){Ga.trigger("layerRemoved",ka[q]);ka.splice(q,1);ta()}Oa=ka.length},getOffset:function(){return X.init(va,f)},setMaxOffset:function(q,s,F,ja){p=
q;a=s;c=typeof F!="undefined"?F:false;g=typeof ja!="undefined"?ja:false},getViewRect:Ca,updateOffset:Pa,pan:function(q,s,F,ja,ra){Pa(va+q,f+s,F,ja,ra)}};Fa=J().getScaling();COG.observable(Ga);Ga.bind("invalidate",function(){ta()});Ga.bind("resync",function(){Za=wa=null});COG.configurable(Ga,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,null,{container:function(q,s){Ea=document.getElementById(s);Z()},inertia:ca,captureHover:ca,
scalable:ca,pannable:ca}),true);CANI.init(function(q){Ga.markers=$("markers",new vb({zindex:20}));canvasCaps=q.canvas;Z();if(b.autoSize)Hb?window.attachEvent("onresize",w):window.addEventListener("resize",w,false)});return Ga},Ib=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:u("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var i=null,d=false,e=false,h=b.id,t=u("ACTIVE"),n=b.validStates,r=0,z=0,y=COG.extend({addToView:function(O){O.setLayer(h,
y)},shouldDraw:function(O){return(O&n)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){y.trigger("remove",y)},changed:function(){e=true;i&&i.invalidate()},hitTest:null,getId:function(){return h},setId:function(O){h=O},getParent:function(){return i},setParent:function(O){d=(i=O)?i.fastDraw&&displayState!==t:false;y.trigger("parentChange",i)}},b);COG.observable(y);y.bind("drawComplete",function(O,w){e=false;r=w.x1;z=w.y1});y.bind("resync",function(O,w){y.minXY&&w.syncXY(y.minXY);
y.maxXY&&w.syncXY(y.maxXY)});return y},bb=function(b){b=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape",transformable:false},b);COG.extend(this,b);this.id=COG.objId(this.type);this.view=this.bounds=null;this.observable&&COG.observable(this);this.transformable&&la(this);this.transformed=false};bb.prototype={constructor:bb,drag:null,draw:function(b){this.fill&&b.fill();this.stroke&&b.stroke()},invalidate:function(){var b=this.layer?
this.layer.getParent():null;b&&b.invalidate()},prepPath:function(){},resync:function(b){if(this.xy){b.syncXY([this.xy]);this.size&&this.updateBounds(M.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},setTransformable:function(b){b&&!this.transformable&&la(this);this.transformable=b},updateBounds:function(b,i){this.bounds=b;if(i)this.xy=M.center(this.bounds)}};var Wb=1E3/60|0,qb=[],Nb=0,wb=function(b){bb.call(this,b)};wb.prototype=COG.extend(bb.prototype,{constructor:wb,prepPath:function(b,i,
d){b.beginPath();b.arc(this.xy.x-i,this.xy.y-d,this.size>>1,0,Math.PI*2,false);return true}});var mb=function(b,i){i=COG.extend({simplify:false},i);var d=false,e=i.simplify;u("ZOOM");var h=[];i.type=i.fill?"polygon":"line";bb.call(this,i);COG.extend(this,{animatePath:function(){},prepPath:function(t,n,r){if(d){var z=true;t.beginPath();for(var y=h.length;y--;){var O=h[y].x-n,w=h[y].y-r;if(z){t.moveTo(O,w);z=false}else t.lineTo(O,w)}}return d},resync:function(t){var n,r,z,y,O;t.syncXY(b);h=X.floor(e?
X.simplify(b):b);for(var w=h.length;w--;){t=h[w].x;n=h[w].y;y=typeof y=="undefined"||t<y?t:y;O=typeof O=="undefined"||n<O?n:O;r=typeof r=="undefined"||t>r?t:r;z=typeof z=="undefined"||n>z?n:z}this.updateBounds(M.init(y,O,r,z),true)}});d=b&&b.length>=2};mb.prototype=COG.extend(bb.prototype,{constructor:mb});var Tb=function(b,i){i.fill=false;mb.call(this,b,i)};Tb.prototype=new mb;var ob=function(b){function i(z){(this.imageUrl=z)&&yb(this.imageUrl,function(y,O){n=y;if(O){var w=r.layer?r.layer.getParent():
null;w&&w.invalidate()}})}b=COG.extend({image:null,imageUrl:null,imageOffset:null},b);var d=null,e=bb.prototype.updateBounds,h,t,n=b.image;bb.call(this,b);var r=COG.extend(this,{changeImage:i,drag:function(z,y,O,w){d||(d=X.init(z.startX-this.xy.x,z.startY-this.xy.y));this.xy.x=y-d.x;this.xy.y=O-d.y;if(w){d=null;if(this.layer)(z=this.layer.getParent())&&z.syncXY([this.xy],true);this.trigger("dragDrop")}return true},draw:function(z){z.drawImage(n,h,t)},prepPath:function(z,y,O){var w=n&&n.width>0;if(w){G(this,
n);h=this.xy.x+this.imageOffset.x-y;t=this.xy.y+this.imageOffset.y-O;z.beginPath();z.rect(h,t,n.width,n.height)}return w},updateBounds:function(z,y){e.call(this,z,y);G(this,n)}});n||i(this.imageUrl)};ob.prototype=new bb;ob.prototype.constructor=ob;var xb=function(b){b=COG.extend({imageAnchor:null},b);if(b.imageAnchor)b.imageOffset=X.invert(b.imageAnchor);ob.call(this,b)};xb.prototype=new ob;xb.prototype.constructor=xb;var vb=function(b){function i(r){for(var z=e.length;z--;)e[z].resync(r);e.sort(function(y,
O){var w=O.xy.y-y.xy.y;return w!=0?w:O.xy.x-y.xy.y});n.changed()}function d(r,z){i(z)}b=COG.extend({zindex:10},b);var e=[],h=CANI.canvas.pipTransformed,t=typeof FlashCanvas!="undefined",n=COG.extend(new Ib(b),{add:function(r,z){if(r){r.layer=n;var y=n.getParent();if(y){r.resync(n.getParent());y.invalidate()}if(z)e.unshift(r);else e[e.length]=r}},clear:function(){e=[]},draw:function(r,z,y,O,w,N){O=z.x1;w=z.y1;var Z=N?h?N.x-O:N.relXY.x:0,$=N?h?N.y-w:N.relXY.y:0,ca=z.width;z=z.height;for(var fa=e.length;fa--;){var S=
e[fa],Aa=S.style||n.style,ta,Ca=S.transformed&&!t;if(Ca){S.transform(r,O,w);if(h){Z-=S.xy.x;$-=S.xy.y}}if(S.prepPath(r,Ca?S.xy.x:O,Ca?S.xy.y:w,ca,z,y)){if(N&&r.isPointInPath(Z,$)){N.elements.push(Hits.initHit(S.type,S,{drag:S.draggable?S.drag:null}));ta=N.type+"Style";Aa=S[ta]||n[ta]||Aa}Aa=Aa?rb.apply(r,Aa):null;S.draw(r,O,w,ca,z,y);Aa&&rb.apply(r,Aa)}Ca&&r.restore()}},find:function(){return[].concat(e)},hitGuess:function(r,z){for(var y=false,O=e.length;!y&&O--;){var w=e[O];if(!(y=y))y=(w=w.bounds)&&
r>=w.x1&&r<=w.x2&&z>=w.y1&&z<=w.y2;y=y}return y}});n.bind("parentChange",d);n.bind("resync",d);return n},Zb=function(){return{tileSize:256,init:function(b,i,d,e,h){return COG.extend({x:b,y:i,width:d,height:e},h)}}}();COG.extend(P,{ex:COG.extend,ticks:ha,getConfig:J,userMessage:function(b,i,d){P.trigger("userMessage",b,i,d)},XY:X,XYRect:M,Dimensions:na,Vector:eb,Hits:Hits,Generator:zb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:rb,viewState:u,View:Sb,ViewLayer:Ib,
ImageLayer:function(b,i){function d(w,N,Z,$){N.image?w.drawImage(N.image,Z,$):yb(N.url,function(ca){N.image=ca;O.changed()})}function e(w,N,Z){for(N=r.length;N--;){var $=r[N],ca=$.x,fa=$.y,S=M.init($.x,$.y,$.x+$.width,$.y+$.height);Z&&M.intersect(w,S)&&yb($.url,function(Aa,ta){Z(Aa,ca,fa,$.width,$.height);ta&&O.changed()},y)}}function h(w){var N=z?Math.abs(z.x1-w.x1)+Math.abs(z.y1-w.y1):0;if(t&&(!z||N>256)){var Z=++n;N=O.getParent();t.run(N,w,function($){z=M.copy(w);if(Z==n)for(var ca=$.length;ca--;){var fa=
$[ca];r[r.length]={image:null,sequence:Z,url:fa.url,rect:M.init(fa.x,fa.y,fa.x+fa.width,fa.y+fa.height)}}})}}i=COG.extend({imageLoadArgs:{}},i);var t=b?zb.init(b,i):null,n=0,r=[],z=null,y=i.imageLoadArgs,O=COG.extend(new Ib(i),{changeGenerator:function(w,N){t=zb.init(w,COG.extend({},i,N));h(O.getParent().getViewRect())},clip:function(w,N){for(var Z=N.x1,$=N.y1,ca=r.length;ca--;){var fa=r[ca].rect;M.intersect(N,fa)&&w.rect(fa.x1-Z,fa.y1-$,fa.width,fa.height)}},draw:function(w,N){for(var Z=N.x1,$=N.y1,
ca=0;ca<r.length;){var fa=r[ca],S=fa.rect;M.intersect(N,S)&&d(w,fa,S.x1-Z,S.y1-$);if(fa.sequence!==n)r.splice(ca,1);else ca++}},mask:function(w,N,Z){e(N,Z,function($,ca,fa,S,Aa){COG.info("clearing rect @ x = "+ca+", y = "+fa+", width = "+S+", height = "+Aa);w.clearRect(ca,fa,S,Aa)})}});O.bind("refresh",function(w,N,Z){h(Z)});O.bind("tap",function(w,N,Z,$){w=[];var ca=$.x,fa=$.y,S,Aa;if(r)for(var ta=r.length;ta--;){S=r[ta];if(Aa=ca>=S.x&&ca<=S.x+S.width&&fa>=S.y&&fa<=S.y+S.height)w[w.length]=S}w.length>
0&&O.trigger("tapImage",w,N,Z,$)});return O},ImageGenerator:function(b){b=COG.extend({relative:false,padding:2},b);b={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(b);return b},Drawable:bb,Marker:wb,Poly:mb,Line:Tb,ImageDrawable:ob,ImageMarker:xb,ShapeLayer:vb,transformable:la,Tiling:Zb});COG.observable(P);var $a=P.Geo=function(){function b(f){for(var j=null,o=1;!j&&o<arguments.length;o++)j=t(f,arguments[o]);j=j?j:t(f);if(!j)throw Error("Unable to find GEO engine with "+
f+" capability");return j}function i(f){f=parseFloat(f)*w;f=V(f);var j=S*f;return ma((1+f)/(1-f)*ba((1-j)/(1+j),S))/2}function d(f){return parseFloat(f)*w}function e(f){f=ba(Math.E,-f);for(var j=ga-2*W(f),o=n(j,f),p=0;p<ta&&ya(j-o)>Aa;){j=o;o=n(j,f);p++}return o*N}function h(f){return f%360*N}function t(f,j){var o=null;for(var p in ka)if(j){if(p==j&&ka[p][f]){o=ka[p];break}}else if(ka[p][f]){o=ka[p];break}return o}function n(f,j){var o=S*V(f);return ga-2*W(j*ba((1-o)/(1+o),S/2))}function r(f,j,o,
p){j=z(j);f.add(p(j,o));return j.length}function z(f){var j=f?f.length:0,o=Array(j);for(j=j;j--;)o[j]=$a.Position.init(f[j][1],f[j][0]);return $a.Position.vectorize(o,lb)}function y(f,j,o){return new va(f,j,o)}var O=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],w=Math.PI/180,N=180/Math.PI,Z=ga,$=-Z,ca=pa,fa=-ca,S=0.08181919084262157,Aa=1.0E-7,ta=12,Ca=null,Ya={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},
ia=function(){function f(a){return a?o(a.lat,a.lon):null}function j(a){return!a||a.lat===0&&a.lon===0}function o(a,c){return{lat:parseFloat(a?a:0),lon:parseFloat(c?c:0)}}function p(a){if(a)if(typeof a.lat!=="undefined")return f(a);else{if(a.split)for(var c=[" ",","],g=0;g<c.length;g++){var C=a.split(c[g]);if(C.length===2)return o(C[0],C[1])}}else return o();return null}return{calcDistance:function(a,c){if(j(a)||j(c))return 0;var g=(c.lat-a.lat)*w>>1,C=(c.lon-a.lon)*w>>1;g=V(g)*V(g)+E(a.lat*w)*E(c.lat*
w)*V(C)*V(C);return 6371*2*ua(qa(g),qa(1-g))},copy:f,empty:j,equal:function(a,c){return a&&c&&a.lat==c.lat&&a.lon==c.lon},fromMercatorPixels:function(a,c){return o(e(c),h(a))},generalize:function(a,c,g){var C=a.length,H=[],ea=null;g||(g=250);g/=1E3;COG.info("generalizing positions, must include "+c.length+" positions");for(var da=C;da--;)if(da===0)H.unshift(a[da]);else{var Fa=!ea||ia.inArray(a[da],c)?g:ia.calcDistance(ea,a[da]);if(a[da]&&Fa>=g){H.unshift(a[da]);ea=a[da]}}COG.info("generalized "+C+
" positions into "+H.length+" positions");return H},inArray:function(a,c){for(var g=ia.equal,C=c.length;C--;)if(g(a,c[C]))return true;return false},inBounds:function(a,c){var g=!(ia.empty(a)||ia.empty(c));return g=(g=g&&a.lat>=c.min.lat&&a.lat<=c.max.lat)&&a.lon>=c.min.lon&&a.lon<=c.max.lon},init:o,offset:function(a,c,g){var C=a.lat*w;a=a.lon*w;c=C+c/6371;g=za(V(g/6371)/E(C));g=a+g;c=(c+ga)%Math.PI-ga;g%=pa;return o(c*N,g*N)},parse:p,parseArray:function(a){var c=a.length,g=Array(c);for(c=c;c--;)g[c]=
p(a[c]);return g},toMercatorPixels:function(a){return T5.XY.init(d(a.lon),i(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,c){function g(){for(var da=0,Fa=c.chunkSize,Da=C;Da--;){H[Da]=T5.GeoXY.init(a[Da]);da+=1;if(da>Fa)break}C=Da;if(C<=0)c.callback&&c.callback(H);else animFrame(g)}var C=a.length,H=Array(C);c=COG.extend({chunkSize:500,async:true,callback:null},c);if(!c.async){for(var ea=C;ea--;)H[ea]=T5.GeoXY.init(a[ea]);return H}animFrame(g);return null}}}(),fb=
function(){function f(a,c,g){var C=T5.XY.init(0,c.lat-a.lat);if(typeof g==="undefined")g=true;C.x=g&&a.lon>c.lon?360-a.lon+c.lon:c.lon-a.lon;return C}function j(a,c){return fb.init(ia.init(a.min.lat-c,a.min.lon-c%360),ia.init(a.max.lat+c,a.max.lon+c%360))}function o(a){var c=f(a.min,a.max);return ia.init(a.min.lat+(c.y>>1),a.min.lon+(c.x>>1))}function p(a,c){return{min:ia.parse(a),max:ia.parse(c)}}return{calcSize:f,createBoundsFromCenter:function(a,c){var g=c/6371,C=a.lat*w,H=a.lon*w,ea=C-g,da=C+
g;if(ea>$&&da<Z){C=za(V(g)/E(C));g=(H-C)%pa;H=(H+C)%pa}else{ea=Ia(ea,$);da=Ba(da,Z);g=fa;H=ca}return fb.init(ia.init(ea*N,g*N),ia.init(da*N,H*N))},expand:j,forPositions:function(a,c){var g=null,C=T5.ticks();c||(c="auto");for(var H=a.length;H--;)if(g){var ea=f(g.min,a[H],false),da=f(a[H],g.max,false);if(ea.x<0)g.min.lon=a[H].lon;if(ea.y<0)g.min.lat=a[H].lat;if(da.x<0)g.max.lon=a[H].lon;if(da.y<0)g.max.lat=a[H].lat}else g=p(a[H],a[H]);if(c){if(c=="auto"){H=f(g.min,g.max);c=Ia(H.x,H.y)*0.3}g=j(g,c)}COG.trace("calculated bounds for "+
a.length+" positions",C);return g},getCenter:o,getGeoHash:function(a){var c=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+c+", max hash = "+a)},getZoomLevel:function(a,c){var g=o(a);g=Ba(Y(ya(g.lat)*0.05),O.length);var C=O[g],H=f(a.min,a.max);g=Ma(ma(O[3]*c.height/H.y)/ma(2));C=Ma(ma(C*c.width/H.x)/ma(2));return Ba(isNaN(g)?1E3:g,isNaN(C)?1E3:C)},init:p,isEmpty:function(a){return!a||ia.empty(a.min)||ia.empty(a.max)},toString:function(a){return"min: "+
ia.toString(a.min)+", max: "+ia.toString(a.max)}}}(),gb=function(){var f=/^(\d+).*$/,j=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(o,p){f.lastIndex=-1;if(f.test(o))for(var a=o.replace(f,"$1"),c=p.split(","),g=0;g<c.length;g++){j.lastIndex=-1;if(j.test(c[g])){var C=j.exec(c[g]);if(a>=parseInt(C[1],10)&&a<=parseInt(C[2],10))return true}else if(a==c[g])return true}return false},normalize:function(o){if(!o)return"";o=o.toUpperCase();if(!Ca){var p=[];for(var a in Ya)p.push(a);Ca=RegExp("(\\s)("+
p.join("|")+")(\\s|$)","i")}Ca.lastIndex=-1;if(p=Ca.exec(o))o=o.replace(Ca,"$1"+Ya[p[2]]);return o},toString:function(o){return o.streetDetails+" "+o.location}}}(),Pa=P.GeoXY=function(){function f(p,a){if(p.length){for(var c,g,C,H,ea=p.length;ea--;){f(p[ea],a);c=typeof c==="undefined"||p.x<c?p.x:c;g=typeof g==="undefined"||p.y<g?p.y:g;C=typeof C==="undefined"||p.x>C?p.x:C;H=typeof H==="undefined"||p.y>H?p.y:H}return M.init(c,g,H,H)}else if(p.mercXY){c=p.mercXY;p.x=(c.x+Math.PI)/a|0;p.y=(Math.PI-c.y)/
a|0;p.rpp=a}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return p}function j(p,a){if(p.length)for(var c=p.length;c--;)j(p[c],a);else{p.mercXY=X.init(p.x*a-Math.PI,Math.PI-p.y*a);p.pos=ia.fromMercatorPixels(p.mercXY.x,p.mercXY.y)}return p}function o(p,a,c){p.pos=a;p.mercXY=ia.toMercatorPixels(a);(c=typeof c!=="undefined"?c:p.rpp)&&f(p,c)}return{init:function(p,a){var c=X.init();o(c,p,a);return c},sync:f,syncPos:j,toPos:function(p,a){a=a?a:_self.rpp;return ia.fromMercatorPixels(p.x*
a-Math.PI,Math.PI-p.y*a)},updatePos:o}}(),ka={},Oa=function(){return{bestResults:function(f,j){j||(j=20);for(var o=f.length>0?f[0]:null,p=[],a=0;a<f.length;a++)if(o&&f[a]&&o.matchWeight-f[a].matchWeight<=j)p.push(f[a]);else break;return p}}}(),Ea=function(f){f=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},f);return COG.extend(f,{toString:function(){return f.caption+(f.matchWeight?" ("+f.matchWeight+")":"")}})},Xa=function(){function f(a,c){var g=new T5.ShapeLayer;
c.geometry&&ia.vectorize(c.geometry,{callback:function(C){g.add(new T5.Line(C,{style:"waypoints",simplify:true}));a.setLayer("route",g)}})}function j(a){for(var c=o.Unknown,g=p,C=0;C<g.length;C++){g[C].regex.lastIndex=-1;var H=g[C].regex.exec(a);if(H){c=g[C].customCheck?g[C].customCheck(a,H):g[C].turnType;break}}return c}var o={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",
TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},p=function(){var a=[];a.push({regex:/continue/i,turnType:o.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(c,g){return/bear/i.test(g[1])?o.TurnLeftSlight:o.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(c,g){return/bear/i.test(g[1])?
o.TurnRightSlight:o.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:o.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:o.Ramp});a.push({regex:/take.*?exit/i,turnType:o.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(c,g){return/right/i.test(g[1])?o.UTurnRight:o.UTurnLeft}});a.push({regex:/proceed/i,turnType:o.Start});a.push({regex:/arrive/i,turnType:o.Arrive});a.push({regex:/fell\sthrough/i,turnType:o.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",
waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var c=b("route");c&&c.route(a,function(g){if(a.generalize)g.geometry=ia.generalize(g.geometry,g.getInstructionPositions());if(a.map){f(a.map,g);a.autoFit&&a.map.gotoBounds(g.boundingBox)}a.success&&a.success(g)})},createMapOverlay:f,parseTurnType:j,TurnType:o,Instruction:function(a){var c=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),g=a.description;g=g.replace(/(\w)(\/)(\w)/g,
"$1 $2 $3");c.description=g;if(!a.turnType)a.turnType=j(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=fb.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var c=[],g=0;g<a.instructions.length;g++)a.instructions[g].position&&c.push(a.instructions[g].position);return c}},a)}}}(),Ka="featurecollection",Hb="feature",lb={async:false},db={processor:null,group:"shapes",layerClass:vb},
Fb={point:COG.extend({},db,{processor:function(f,j,o,p){j=z([j.coordinates],lb);if(j.length>0)if(o=p.marker(j[0],o)){f.add(o);return j.length}},group:"markers",layerClass:vb}),linestring:COG.extend({},db,{processor:function(f,j,o,p){j=z(j&&j.coordinates?j.coordinates:[]);return r(f,j,o,p.line)}}),multilinestring:COG.extend({},db,{processor:function(f,j,o,p){j=j&&j.coordinates?j.coordinates:[];for(var a=0,c=j.length;c--;)a+=r(f,j[c],o,p.line);return a}}),polygon:COG.extend({},db,{processor:function(f,
j,o,p){j=j&&j.coordinates?j.coordinates:[];if(j.length>0)return r(f,j[0],o,p.poly);return 0}}),multipolygon:COG.extend({},db,{processor:function(f,j,o,p){j=j&&j.coordinates?j.coordinates:[];for(var a=0,c=0;c<j.length;c++)a+=r(f,j[c][0],o,p.poly);return a}})},va=function(f,j,o,p){function a(Q,aa){var sa=Q.processor,wa=ea+Q.group,Za=COG.extend({},Q,o,{properties:aa.properties});if(sa){var ab=K[wa];if(!ab){ab=new Q.layerClass({id:wa});K[wa]=ab}globalLayers=K;return sa(ab,aa.data,Za,p)}return 0}function c(Q,
aa){var sa=Q&&Q.type?Q.type.toLowerCase():null;return sa&&sa===Hb?c(Q.geometry,Q.properties):{type:sa,isCollection:sa?sa===Ka:false,definition:Fb[sa],data:Q,properties:aa?aa:Q.properties}}function g(Q){var aa=0,sa=COG.extend({},o),wa=da;Q=Q?Q:(new Date).getTime();if(!Da){for(;wa<Fa;wa++){Q=c(H?H(f[wa]):f[wa]);var Za=null;if(Q.isCollection){sa.layerPrefix=ea+R++ +"-";Da=y(Q.data.features,function(ab){Da=null;for(var ib in ab)K[ib]=ab[ib]},sa);Za+=1}else if(Q.definition)Za=a(Q.definition,Q);aa+=Za?
Za:1;if(aa>=C)break}da=wa+1;if(Da||da<Fa)animFrame(g);else j&&j(K)}}o=COG.extend({vectorsPerCycle:$a.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},o);p=COG.extend({marker:function(Q){return new wb({xy:Q})},line:function(Q,aa){return new mb(Q,COG.extend({},o,aa))},poly:function(Q,aa){return new mb(Q,COG.extend({fill:true},o,aa))}},p);var C=o.vectorsPerCycle,H=o.rowPreParse,ea=o.layerPrefix,da=0,Fa=0,Da=null,R=0,K={};if(f){if(typeof f.length==="undefined")f=[f];Fa=f.length;
animFrame(g)}};P.GeoJSON={parse:y};P.Map=function(f){function j(K){try{var Q=$a.Position.init(K.coords.latitude,K.coords.longitude),aa=K.coords.accuracy/1E3;R.trigger("locationUpdate",K,aa);if(da){if(!H){H=new $a.UI.LocationOverlay({pos:Q,accuracy:aa});H.update(R.getTileLayer());R.setLayer("location",H)}var sa=$a.BoundingBox.createBoundsFromCenter(Q,Math.max(aa,1));R.gotoBounds(sa)}else{H.pos=Q;H.accuracy=aa;H.update(R.getTileLayer());a(Q,null,COG.easing("sine.out"))}da=false}catch(wa){COG.exception(wa)}}
function o(K){COG.info("caught location tracking error:",K)}function p(K,Q,aa){R.setZoomLevel(Q);a(K,aa)}function a(K,Q,aa,sa){K=Pa.init(K,$a.radsPerPixel(R.getZoomLevel()));var wa=R.getDimensions();R.updateOffset(K.x-(wa.width>>1),K.y-(wa.height>>1),aa,sa,function(){R.refresh();R.trigger("boundsChange",R.getBoundingBox());Q&&Q(R)})}f=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18,pannable:true,scalable:true},f);var c={NONE:0,SINGLE:1,WATCH:2},g=
X.init(),C=c.NONE,H=null,ea=0,da=true,Fa=0,Da=f.tapExtent;f.adjustScaleFactor=function(K){return Math.pow(2,(K<1?Math.floor:Math.ceil)(Math.log(K)))};var R=COG.extend(new Sb(f),{getBoundingBox:function(){var K=R.getViewRect();return $a.BoundingBox.init(Pa.toPos(X.init(K.x1,K.y2),Fa),Pa.toPos(X.init(K.x2,K.y1),Fa))},getCenterPosition:function(){var K=R.getViewRect();if(K){K=X.init(K.x1+(K.width>>1),K.y1+(K.height>>1));return Pa.toPos(K,Fa)}return null},gotoBounds:function(K,Q){var aa=$a.BoundingBox.getZoomLevel(K,
R.getDimensions());p($a.BoundingBox.getCenter(K),aa,Q)},gotoPosition:p,panToPosition:a,syncXY:function(K,Q){return(Q?Pa.syncPos:Pa.sync)(K,Fa)},locate:function(){R.trackStart(c.SINGLE);setTimeout(R.trackCancel,1E4)},trackStart:function(K){if(navigator.geolocation&&!ea){C=K?K:c.WATCH;da=true;ea=navigator.geolocation.watchPosition(j,o,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){ea&&navigator.geolocation&&navigator.geolocation.clearWatch(ea);R.removeLayer("location");
H=null;C=c.NONE;ea=0},animateRoute:function(K,Q,aa,sa){var wa=R.getLayer("route");if(wa)(K=wa.getAnimation(K,Q,aa,sa))&&K.addToView(R)}});R.bind("pan",function(){C===c.SINGLE&&R.trackCancel()});R.bind("tap",function(K,Q,aa,sa){K=Pa.toPos(sa,Fa);var wa=Pa.toPos(X.offset(sa,-Da,Da),Fa);sa=Pa.toPos(X.offset(sa,Da,-Da),Fa);R.trigger("geotap",Q,aa,K,fb.init(wa,sa))});R.bind("refresh",function(){if(X.absSize(X.diff(g,R.getOffset()))>f.boundsChangeThreshold){g=X.copy(R.getOffset());R.trigger("boundsChange",
R.getBoundingBox())}});R.bind("zoomLevelChange",function(K,Q){var aa;Fa=$a.radsPerPixel(Q);aa=pa/Fa|0;R.setMaxOffset(aa,aa,true,false);R.resetScale();R.triggerAll("resync",R);R.refresh()});return R};P.GeoShape=function(f,j){j=COG.extend({autoParse:true},j);for(var o=Array(f.length),p=j.autoParse,a=T5.Geo.Position.parse,c=f.length;c--;)o[c]=T5.GeoXY.init(p?a(f[c]):f[c]);return new T5.Poly(o,j)};P.LocationOverlay=function(f){f=COG.extend({pos:null,accuracy:null,zindex:90},f);var j=new Image,o=T5.XY.init(),
p=T5.XY.init(),a=null;j.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
j.onload=function(){o=T5.XY.init(j.width>>1,j.height>>1)};var c=COG.extend(new T5.ViewLayer(f),{pos:f.pos,accuracy:f.accuracy,drawAccuracyIndicator:false,draw:function(g,C){var H=p.x-C.x,ea=p.y-C.y;if(a){g.fillStyle="rgba(30, 30, 30, 0.2)";g.beginPath();g.arc(H,ea,a,0,Math.PI*2,false);g.fill()}j.complete&&j.width>0&&g.drawImage(j,H-o.x,ea-o.y,j.width,j.height);c.changed()},update:function(g){if(g){a=g.getPixelDistance(c.accuracy)>>1;p=g.getGridXYForPosition(c.pos);c.changed()}}});c.bind("gridUpdate",
function(g,C){c.update(C)});return c};return{distanceToString:function(f){if(f>1E3)return~~(f/10)/100+" km";return f?f+" m":""},dist2rad:function(f){return f/6371},getEngine:b,lat2pix:i,lon2pix:d,pix2lat:e,pix2lon:h,radsPerPixel:function(f){return pa/(256<<f)},Position:ia,BoundingBox:fb,Radius:function(f,j){return{distance:parseInt(f,10),uom:j}},Address:function(f){return f=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},f)},A:gb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(f){if(!f.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var j=COG.extend({remove:function(){delete ka[j.id]}},f);return ka[j.id]=j},Search:Oa,GeoSearchResult:Ea,LocationSearch:function(f){function j(g,C){navigator.geolocation.clearWatch(p);p=0;if(a){clearTimeout(a);a=0}C&&C([g],f)}function o(g){COG.info("caught location tracking error:",g)}f=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},f);var p=0,a=0,c=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(g,C){if(navigator.geolocation&&!p){p=navigator.geolocation.watchPosition(function(H){var ea=ia.init(H.coords.latitude,H.coords.longitude);H=new Ea({id:1,caption:"Current Location",pos:ea,accuracy:H.coords.accuracy/1E3,matchWeight:100});if(!c||H.accuracy<c.accuracy)c=H;if(!f.requiredAccuracy||c.accuracy<f.requiredAccuracy)j(c,C)},o,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(f.searchTimeout)a=
setTimeout(function(){c&&j(c,C)},f.searchTimeout)}}},f))},Routing:Xa}}()})(T5);
