COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var Y=arguments[0]||{},sa,N=1,F=arguments.length;N<F;N++)if((sa=arguments[N])!==null)for(var p in sa){var s=sa[p];if(Y!==s)if(s!==undefined)Y[p]=s}return Y};
(function(){var Y=Object.prototype.hasOwnProperty,sa=0,N={};N.toID=function(F){return F.replace(/\s/g,"-")};N.objId=function(F){return(F?F:"obj")+sa++};N.isFunction=function(F){return toString.call(F)==="[object Function]"};N.isArray=function(F){return toString.call(F)==="[object Array]"};N.isPlainObject=function(F){if(!F||toString.call(F)!=="[object Object]"||F.nodeType||F.setInterval)return false;if(F.constructor&&!Y.call(F,"constructor")&&!Y.call(F.constructor.prototype,"isPrototypeOf"))return false;
var p;for(p in F);return p===undefined||Y.call(F,p)};N.isEmptyObject=function(F){for(var p in F)return false;return true};N.isXmlDocument=function(F){return toString.call(F)==="[object Document]"};N.contains=function(F,p){var s=F,G=arguments,K=1;if(p&&module.isArray(p)){G=p;K=0}for(K=K;K<G;K++)s=s&&typeof foo[G[K]]!=="undefined";return s};N.formatStr=function(F){if(arguments.length<=1)return F;for(var p=arguments.length-2,s=0;s<=p;s++)F=F.replace(RegExp("\\{"+s+"\\}","gi"),arguments[s+1]);return F};
N.wordExists=function(F,p){var s="";if(p.toString)p=p.toString();for(var G=0;G<p.length;G++)s+=!/\w/.test(p[G])?"\\"+p[G]:p[G];return RegExp("(^|\\s|\\,)"+s+"(\\,|\\s|$)","i").test(F)};COG.extend(COG,N)})();
(function(){function Y(s){return typeof console!=="undefined"?function(){console[s](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var sa=window.console&&window.console.markTimeline,N=Y("error"),F=Y("info"),p=function(){return sa?function(s,G){console.markTimeline(s+(G?": "+((new Date).getTime()-G)+"ms":""))}:function(){}}();COG.extend(COG,{trace:p,debug:Y("debug"),info:F,warn:Y("warn"),error:N,exception:function(s){if(N)for(var G in s)F("ERROR DETAIL: "+
G+": "+s[G])}})})();
(function(){function Y(N,F){var p=N.obsHandlers;p[F]||(p[F]=[]);return p[F]}var sa=0;COG.observable=function(N){if(!N)return null;if(!N.obsHandlers)N.obsHandlers={};if(!(N.bind||N.trigger||N.unbind)){N.bind=function(F,p){var s="callback"+sa++;Y(N,F).unshift({fn:p,id:s});return s};N.triggerCustom=function(F,p){var s=Y(N,F),G={cancel:false,name:F},K;p&&COG.extend(G,p);if(!s)return null;K=Array.prototype.slice.call(arguments,2);N.eventInterceptor&&N.eventInterceptor(F,G,K);K.unshift(G);for(var o=s.length;o--&&
!G.cancel;)s[o].fn.apply(this,K);return G};N.trigger=function(F){var p=Array.prototype.slice.call(arguments,1);p.splice(0,0,F,null);return N.triggerCustom.apply(this,p)};N.unbind=function(F,p){if(typeof F==="undefined")N.obsHandlers={};else for(var s=Y(N,F),G=0;s&&G<s.length;G++)if(s[G].id===p){s.splice(G,1);break}return N}}return N}})();
(function(){function Y(p,s){p[s]||(p[s]=function(G){return p.configure(s,G)})}function sa(p){p.gtConfId="configurable"+F++;p.gtConfig={};p.gtConfigFns=[];return p.gtConfig}var N={},F=0;COG.paramTweaker=function(p,s,G){return function(K,o){if(typeof o!=="undefined"){if(K in p)p[K]=o;G&&K in G&&G[K](K,o)}else return s&&K in s?s[K](K):p[K]}};COG.configurable=function(p,s,G,K){if(p){p.gtConfId||sa(p);var o=p.gtConfId,I=p.gtConfig,E=p.gtConfigFns;N[o]=p;E.push(G);for(G=s.length;G--;){I[s[G]]=true;K&&Y(p,
s[G])}if(!p.configure)p.configure=function(M,aa){if(I[M]){for(var u=E.length;u--;){var A=E[u](M,aa);if(typeof A!=="undefined")return A}return N[o]}return null}}}})();
(function(){function Y(p){var s=document.createElement("script"),G=false;s.src=p;s.async=true;s.onload=s.onreadystatechange=function(){if(!G&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){G=true;s.onload=s.onreadystatechange=null;s&&s.parentNode&&s.parentNode.removeChild(s)}};N||(N=document.getElementsByTagName("head")[0]);N.appendChild(s)}var sa=0,N,F=this;COG.jsonp=function(p,s,G){p+=p.indexOf("?")>=0?"&":"?";var K="json"+ ++sa;F[K]=function(o){s(o);F[K]=null;try{delete F[K]}catch(I){}};
Y(p+(G?G:"callback")+"="+K);return K}})();
(function(){var Y=1.70158,sa=Math.PI/2,N=Math.abs,F=Math.pow,p=Math.sin,s=Math.asin,G=Math.cos,K={linear:function(o,I,E,M){return E*o/M+I},backin:function(o,I,E,M){return E*(o/=M)*o*((Y+1)*o-Y)+I},backout:function(o,I,E,M){return E*((o=o/M-1)*o*((Y+1)*o+Y)+1)+I},backinout:function(o,I,E,M){return(o/=M/2)<1?E/2*o*o*(((Y*=1.525)+1)*o-Y)+I:E/2*((o-=2)*o*(((Y*=1.525)+1)*o+Y)+2)+I},bouncein:function(o,I,E,M){return E-K.bounceout(M-o,0,E,M)+I},bounceout:function(o,I,E,M){return(o/=M)<1/2.75?E*7.5625*o*
o+I:o<2/2.75?E*(7.5625*(o-=1.5/2.75)*o+0.75)+I:o<2.5/2.75?E*(7.5625*(o-=2.25/2.75)*o+0.9375)+I:E*(7.5625*(o-=2.625/2.75)*o+0.984375)+I},bounceinout:function(o,I,E,M){return o<M/2?K.bouncein(o*2,0,E,M)/2+I:K.bounceout(o*2-M,0,E,M)/2+E/2+I},cubicin:function(o,I,E,M){return E*(o/=M)*o*o+I},cubicout:function(o,I,E,M){return E*((o=o/M-1)*o*o+1)+I},cubicinout:function(o,I,E,M){if((o/=M/2)<1)return E/2*o*o*o+I;return E/2*((o-=2)*o*o+2)+I},elasticin:function(o,I,E,M,aa,u){if(o==0)return I;if((o/=M)==1)return I+
E;u||(u=M*0.3);if(!aa||aa<N(E)){aa=E;E=u/4}else E=u/TWO_PI*s(E/aa);return-(aa*F(2,10*(o-=1))*p((o*M-E)*TWO_PI/u))+I},elasticout:function(o,I,E,M,aa,u){var A;if(o==0)return I;if((o/=M)==1)return I+E;u||(u=M*0.3);if(!aa||aa<N(E)){aa=E;A=u/4}else A=u/TWO_PI*s(E/aa);return aa*F(2,-10*o)*p((o*M-A)*TWO_PI/u)+E+I},elasticinout:function(o,I,E,M,aa,u){var A;if(o==0)return I;if((o/=M/2)==2)return I+E;u||(u=M*0.3*1.5);if(!aa||aa<N(E)){aa=E;A=u/4}else A=u/TWO_PI*s(E/aa);if(o<1)return-0.5*aa*F(2,10*(o-=1))*p((o*
M-A)*TWO_PI/u)+I;return aa*F(2,-10*(o-=1))*p((o*M-A)*TWO_PI/u)*0.5+E+I},quadin:function(o,I,E,M){return E*(o/=M)*o+I},quadout:function(o,I,E,M){return-E*(o/=M)*(o-2)+I},quadinout:function(o,I,E,M){if((o/=M/2)<1)return E/2*o*o+I;return-E/2*(--o*(o-2)-1)+I},sinein:function(o,I,E,M){return-E*G(o/M*sa)+E+I},sineout:function(o,I,E,M){return E*p(o/M*sa)+I},sineinout:function(o,I,E,M){return-E/2*(G(Math.PI*o/M)-1)+I}};COG.tweenValue=function(o,I,E,M,aa){function u(na){var V=na-A,oa=E(V,o,L,M),ka=A+M<=na;
na=!ka;if(aa){V=aa(oa,ka,V);na=typeof V!="undefined"?V&&na:na}na&&animFrame(u)}var A=(new Date).getTime(),L=I-o;animFrame(u);return{}};COG.easing=function(o){return K[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(o,I){K[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]=I}})();
(function(){var Y=/^P(\d+Y)?(\d+M)?(\d+D)?$/,sa=/^(\d+H)?(\d+M)?(\d+S)?$/,N={8601:function(p){p=p.split("T");var s=null;s=null;var G=0,K=0;Y.lastIndex=-1;s=Y.exec(p[0]);G+=s[3]?parseInt(s[3].slice(0,-1),10):0;sa.lastIndex=-1;s=sa.exec(p[1]);K+=s[1]?parseInt(s[1].slice(0,-1),10)*3600:0;K+=s[2]?parseInt(s[2].slice(0,-1),10)*60:0;K+=s[3]?parseInt(s[3].slice(0,-1),10):0;return new F(G,K)}},F=COG.Duration=function(p,s){return{days:p?p:0,seconds:s?s:0}};COG.addDuration=function(){for(var p=new F,s=arguments.length;s--;){p.days+=
arguments[s].days;p.seconds+=arguments[s].seconds}if(p.seconds>=86400){p.days+=~~(p.seconds/86400);p.seconds%=86400}return p};COG.formatDuration=function(p){var s,G,K="";if(p.days)K=p.days+" days ";if(p.seconds){p=p.seconds;if(p>=3600){s=~~(p/3600);p-=s*3600}if(p>=60){G=Math.round(p/60);p-=G*60}if(s)K=K+s+(s>1?" hrs ":" hr ")+(G?(G>10?G:"0"+G)+" min ":"");else if(G)K=K+G+" min";else if(p>0)K=K+(p>10?p:"0"+p)+" sec"}return K};COG.parseDuration=function(p,s){var G=s?N[s]:null;if(G)return G(p);COG.Log.warn("Could not find duration parser for specified format: "+
s);return new F}})();
INTERACT=function(){function Y(u){return function(A,L,na){(na?na:u?document.body:document).addEventListener(A,L,false)}}function sa(u){return function(A,L,na){(na?na:u?document.body:document).removeEventListener(A,L,false)}}function N(u,A,L){(L?L:document).attachEvent("on"+u,A)}function F(u,A,L){(L?L:document).detachEvent("on"+u,A)}function p(u,A){return{x:u?u:0,y:A?A:0,count:1}}function s(u,A){M.push(COG.extend({handler:null,checks:{},type:u},A))}function G(u){var A=0,L=0;if(u.offsetParent){do{A+=u.offsetLeft;
L+=u.offsetTop;u=u.offsetParent}while(u)}return{x:A,y:L}}function K(u,A){return{source:u,target:A.target?A.target:A.srcElement}}function o(u,A){for(var L=u.target?u.target:u.srcElement;L&&L!==A&&L.nodeName&&L.nodeName.toUpperCase()!="CANVAS";)L=L.parentNode;return L&&L===A}function I(u,A){return{x:u.x-(A?A.x:0),y:u.y-(A?A.y:0)}}function E(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}var M=[],aa=function(u,A,L){function na(da,pa,ra,H){var ca=
0,la=0,B=0;COG.tweenValue(0,da,ra,H,function(ea){B=ca;ca=ea});COG.tweenValue(0,pa,ra,H,function(ea){V.trigger("pan",ca-B,ea-la);la=ea})}L=COG.extend({binder:null,unbinder:null,observable:null},L);for(var V=L.observable,oa=null,ka=[],ma=[],va,Ha,wa={bind:function(){return V.bind.apply(null,arguments)},pannable:function(da){oa=COG.extend({inertia:true},da);return wa},unbind:function(){V.unbind();for(var da=0;da<ka.length;da++)ka[da].unbind();return wa}},Ka=0;Ka<A.length;Ka++)ka.push(A[Ka](u,V,L));V.bind("pointerDown",
function(){ma=[];Ha=va=0});V.bind("pointerMove",function(da,pa,ra,H){if(oa){ma[ma.length]={ticks:(new Date).getTime(),x:H.x,y:H.y};V.trigger("pan",H.x,H.y)}va+=H.x?H.x:0;Ha+=H.y?H.y:0});V.bind("pointerUp",function(da,pa,ra){if(Math.abs(va)>20||Math.abs(Ha)>20){if(oa){ra=ma.length;var H,ca;pa=0;for(ca=ma.length;--ca>1&&pa<50;)pa+=ma[ca].ticks-ma[ca-1].ticks;if(ra-ca>1){da=ma[ra-1].x-ma[ca].x;H=ma[ra-1].y-ma[ca].y;ca=Math.sqrt(da*da+H*H)|0;if(ca>15){da=ma[ra-1].x-ma[0].x;H=ma[ra-1].y-ma[0].y;ca=Math.sqrt(da*
da+H*H)|0;ra=Math.asin(H/ca);pa=ca*500/pa|0;pa=pa>300?300:pa;na(Math.cos(da>0?ra:Math.PI-ra)*pa,Math.sin(ra)*pa,COG.easing("sine.out"),500)}}}}else V.trigger("tap",pa,ra)});return wa};s("pointer",{handler:function(u,A,L){function na(B){if(o(B,u))if(Ka=ma(B)){u.style.cursor="move";E(B);ca=B.pageX?B.pageX:B.screenX;la=B.pageY?B.pageY:B.screenY;da=p(ca,la);pa=G(u);A.triggerCustom("pointerDown",K("mouse",B),da,I(da,pa))}}function V(B){ra=B.pageX?B.pageX:B.screenX;H=B.pageY?B.pageY:B.screenY;if(o(B,u))va(B,
Ka?"pointerMove":"pointerHover")}function oa(B){if(Ka&&ma(B)){Ka=false;if(o(B,u)){u.style.cursor="default";va(B,"pointerUp")}}}function ka(B){if(o(B,u)){var ea;B=B||window.event;if(B.detail)ea=B.axis===2?-B.detail*Ha:0;else{ea=B.wheelDeltaY?B.wheelDeltaY:B.wheelDelta;if(window.opera)ea=-ea}if(ea!==0){var Aa=p(ra,H);A.triggerCustom("zoom",K("mouse",B),Aa,I(Aa,G(u)),ea/wa,"wheel");E(B);B.returnValue=false}}}function ma(B){B=B||window.event;return(B.which||B.button)==1}function va(B,ea,Aa,Fa,Ra){Aa=
typeof Aa!="undefined"?Aa:ra;Fa=typeof Fa!="undefined"?Fa:H;var Q=Aa-ca,fa=Fa-la,W=p(Aa,Fa);pa||(pa=G(u));A.triggerCustom(ea,K("mouse",B),W,I(W,pa),p(Q,fa));if(typeof Ra=="undefined"||Ra){ca=Aa;la=Fa}}L=COG.extend({},L);var Ha=120,wa=Ha*8,Ka=false,da,pa,ra,H,ca,la;L.binder("mousedown",na,false);L.binder("mousemove",V,false);L.binder("mouseup",oa,false);L.binder("dblclick",function(B){COG.info("captured double click");if(o(B,u)){var ea=p(B.pageX?B.pageX:B.screenX,B.pageY?B.pageY:B.screenY);COG.info("captured double click + target matched");
A.triggerCustom("doubleTap",K("mouse",B),ea,I(ea,G(u)))}},false);L.binder("mousewheel",ka,document);L.binder("DOMMouseScroll",ka,document);return{unbind:function(){L.unbinder("mousedown",na,false);L.unbinder("mousemove",V,false);L.unbinder("mouseup",oa,false);L.unbinder("mousewheel",ka,document);L.unbinder("DOMMouseScroll",ka,document)}}},checks:{touch:false}});s("pointer",{handler:function(u,A,L){function na(Q){if(Q.count<2)return 0;var fa=Q.x-Q.next.x;Q=Q.y-Q.next.y;return~~Math.sqrt(fa*fa+Q*Q)}
function V(Q,fa,W){fa=fa?fa:0;W=W?W:0;for(var Ia={x:Q.x-fa,y:Q.y-W,id:Q.id,count:Q.count},Ga=Ia;Q.next;){Q=Q.next;Ga=Ga.next={x:Q.x-fa,y:Q.y-W,id:Q.id}}return Ia}function oa(Q,fa){var W=Q[fa?fa:"touches"],Ia,Ga;if(W.length===0)return null;Ga=Ia={x:W[0].pageX,y:W[0].pageY,id:W[0].identifier,count:W.length};for(var Pa=1,bb=W.length;Pa<bb;Pa++)Ga=Ga.next={x:W[Pa].pageX,y:W[Pa].pageY,id:W[Pa].identifier};return Ia}function ka(Q){if(o(Q,u)){H=G(u);var fa=oa(Q,"changedTouches"),W=V(fa,H.x,H.y);if(!la){ca=
da;A.triggerCustom("pointerDown",K("touch",Q),fa,W)}Fa&&A.triggerCustom("pointerDownMulti",K("touch",Q),fa,W);la=oa(Q);if(la.count>1)ea=na(la);Ra=1;Aa=V(la)}}function ma(Q){if(o(Q,u)){Q.preventDefault();B=oa(Q);if(ca==da)ca=Math.abs(la.x-B.x)>wa||Math.abs(la.y-B.y)>wa?Ka:da;if(ca!=da){ca=B.count>1?ra:pa;if(ca==ra)if(la.count===1){la=V(B);ea=na(la)}else{var fa=na(B);if(Math.abs(ea-fa)<Ha)ca=pa;else{var W;W=B.x;var Ia=B.next.x,Ga=B.y,Pa=B.next.y,bb=Ga<Pa?Ga:Pa;W={x:(W<Ia?W:Ia)+(Math.abs(W-Ia)>>1),y:bb+
(Math.abs(Ga-Pa)>>1)};fa=fa/ea;Ia=fa-Ra;A.triggerCustom("zoom",K("touch",Q),W,I(W,H),Ia,"pinch");Ra=fa}}ca==pa&&A.triggerCustom("pointerMove",K("touch",Q),B,V(B,H.x,H.y),p(B.x-Aa.x,B.y-Aa.y));Fa&&A.triggerCustom("pointerMoveMulti",K("touch",Q),B,V(B,H.x,H.y))}Aa=V(B)}}function va(Q){if(o(Q,u)){var fa=oa(Q,"changedTouches"),W=V(fa,H.x,H.y);B=oa(Q);if(!B){ca===da&&A.triggerCustom("tap",K("touch",Q),fa,W);A.triggerCustom("pointerUp",K("touch",Q),fa,W);la=null}Fa&&A.triggerCustom("pointerUpMulti",K("touch",
Q),fa,W)}}L=COG.extend({detailed:false,inertia:false},L);var Ha=20,wa=7,Ka=0,da=1,pa=2,ra=3,H,ca,la,B,ea,Aa,Fa=L.detailed,Ra=1;L.binder("touchstart",ka,false);L.binder("touchmove",ma,false);L.binder("touchend",va,false);COG.info("initialized touch handler");return{unbind:function(){L.unbinder("touchstart",ka,false);L.unbinder("touchmove",ma,false);L.unbinder("touchend",va,false)}}},checks:{touch:true}});return{register:s,watch:function(u,A,L){A=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},A);capabilities=COG.extend({touch:"ontouchstart"in window},L);if(!A.observable){COG.info("creating observable");A.observable=COG.observable({});globalOpts=A}A.binder=A.isIE?N:Y(A.bindToBody);A.unbinder=A.isIE?F:sa(A.bindToBody);L=A.types;for(var na=capabilities,V=[],oa=M.length;oa--;){var ka=M[oa],ma=!L||L.indexOf(ka.type)>=0,va=true;for(var Ha in ka.checks){var wa=ka.checks[Ha];COG.info("checking "+Ha+" capability. require: "+wa+", capability = "+na[Ha]);va=va&&wa===na[Ha]}if(ma&&
va)V[V.length]=ka.handler}return new aa(u,V,A)}}}();
T5=function(){function Y(){return(new Date).getTime()}function sa(){for(;Q.length>0;){var c=Q.shift();document.location=c}Ra=0}function N(c){for(var r=true,f=fa.length;f--;)r=r&&c!=fa[f];return r}function F(c,r){var f=[];for(var b in r)b&&f.push(b+"="+escape(r[b]));return"tile5://"+c+"/"+(f.length>0?"?"+f.join("&"):"")}function p(c,r){N(c)&&COG.info("would push url: "+F(c,r))}function s(c,r){if(N(c)){Q.push(F(c,r));Ra||(Ra=setTimeout(sa,100))}}function G(c){return function(r,f,b){(b?b:c?document.body:
document).addEventListener(r,f,false)}}function K(c){return function(r,f,b){(b?b:c?document.body:document).removeEventListener(r,f,false)}}function o(c,r,f){(f?f:document).attachEvent("on"+c,r)}function I(c,r,f){(f?f:document).detachEvent("on"+c,r)}function E(){ea={base:{name:"Unknown",bindEvent:G(),unbindEvent:K(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:p,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:o,unbindEvent:I,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:s,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:s},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:s},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:G(true),unbindEvent:K(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:s},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:s}};Aa=[ea.froyo,ea.android,ea.ipod,ea.iphone,ea.ipad,ea.ie]}function M(){ea||E();if(!Fa){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<Aa.length;c++){var r=Aa[c];if(r.regex&&r.regex.test(navigator.userAgent)){Fa=COG.extend({},ea.base,r);COG.info("PLATFORM DETECTED AS: "+Fa.name);break}}if(!Fa){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Fa=ea.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Fa}function aa(){for(var c=0,r=arguments.length;r--;){var f=Pa[arguments[r].toUpperCase()];if(f)c|=f}return c}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){setTimeout(function(){c((new Date).getTime())},1E3/60)}}();var u=Math.PI*2,A=Math.PI/2,L=Math.abs,
na=Math.ceil,V=Math.min,oa=Math.max,ka=Math.pow,ma=Math.sqrt,va=Math.log,Ha=Math.round,wa=Math.sin,Ka=Math.asin,da=Math.cos,pa=Math.atan,ra=Math.atan2,H=function(){function c(b,d){return f(b.x-d.x,b.y-d.y)}function r(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var l={edges:Array(d-1),accrued:Array(d-1),total:0},n=0;n<d-1;n++){var t=c(b[n],b[n+1]);l.edges[n]=ma(t.x*t.x+t.y*t.y);l.accrued[n]=l.total+l.edges[n];l.total+=l.edges[n]}return l}
function f(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,l=arguments.length;l--;){b+=arguments[l].x;d+=arguments[l].y}return f(b,d)},absSize:function(b){return oa(L(b.x),L(b.y))},copy:function(b){return b?f(b.x,b.y):null},diff:c,distance:function(b,d){return r(b,d).total},edges:r,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,l){var n=da(d)*l;d=wa(d)*l;return f(b.x-n,b.y-d)},floor:function(b){for(var d=
Array(b.length),l=b.length;l--;)d[l]=f(~~b[l].x,~~b[l].y);return d},getRect:function(b){for(var d,l,n,t,q=b.length;q--;){var m=b[q];d=typeof d==="undefined"||m.x<d?m.x:d;l=typeof l==="undefined"||m.y<l?m.y:l;n=typeof n==="undefined"||m.x>n?m.x:n;t=typeof t==="undefined"||m.y>t?m.y:t}return la.init(d,l,n,t)},init:f,invert:function(b){return f(-b.x,-b.y)},min:function(b,d){return f(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return f(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,l){return f(b.x+
d,b.y+(l?l:d))},simplify:function(b,d){if(!b)return null;d=d?d:H.VECTOR_SIMPLIFICATION;for(var l=[],n=null,t=b.length;t--;){var q=b[t];if(include=!n||t===0||L(q.x-n.x)+L(q.y-n.y)>d){l.unshift(q);n=q}}return l},theta:function(b,d,l){l=Ka((b.y-d.y)/l);return b.x>d.x?l:Math.PI-l},toString:function(b){return b?b.x+", "+b.y:""}}}(),ca=function(){return{dotProduct:function(c,r){return c.x*r.x+c.y*r.y}}}(),la=function(){function c(f){return r(f.x1,f.y1,f.x2,f.y2)}function r(f,b,d,l){f=f?f:0;b=b?b:0;d=typeof d!==
"undefined"?d:f;l=typeof l!=="undefined "?l:l;return{x1:f,y1:b,x2:d,y2:l,width:d-f,height:l-b}}return{center:function(f){return H.init(f.x1+f.width/2,f.y1+f.height/2)},copy:c,diagonalSize:function(f){return ma(f.width*f.width+f.height*f.height)},fromCenter:function(f,b,d,l){d=d>>1;l=l>>1;return r(f-d,b-l,f+d,b+l)},init:r,intersect:function(f,b){var d=oa(f.x1,b.x1),l=oa(f.y1,b.y1),n=V(f.x2,b.x2),t=V(f.y2,b.y2);d=r(d,l,n,t);return d.width>0&&d.height>0?d:null},toString:function(f){return f?"["+f.x1+
", "+f.y1+", "+f.x2+", "+f.y2+"]":""},union:function(f,b){if(f.width===0||f.height===0)return c(b);else if(b.width===0||b.height===0)return c(f);else{var d=V(f.x1,b.x1),l=V(f.y1,b.y1),n=oa(f.x2,b.x2),t=oa(f.y2,b.y2);d=r(d,l,n,t);return d.width>0&&d.height>0?d:null}}}}(),B=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return H.init(c.width>>1,c.height>>1)},getSize:function(c){return ma(ka(c.width,2)+ka(c.height,2))},init:function(c,r){c=
c?c:0;return{width:c,height:r?r:c}}}}(),ea=null,Aa=[],Fa=null,Ra=0,Q=[],fa=["view.wake","tile.loaded"],W=function(){function c(){var j=M().maxImageLoads;if(!j||q.length<j)if(j=t.shift()){q[q.length]=j;j.image.onload=r;j.image.src=j.url;j.requested=T5.ticks()}}function r(){var j=l[this.id],y;if(j&&j.image.complete&&j.image.width>0){j.loaded=true;j.hitCount=1;for(y=q.length;y--;)if(q[y].image.src==this.src){q.splice(y,1);break}if(j.background||j.postProcess||j.drawBackground||j.customDraw)if(j.image){globalImageData=
j;y=b(j.realSize?j.realSize.width:j.image.width,j.realSize?j.realSize.height:j.image.height);var P=y.getContext("2d"),S=j.offset?j.offset:T5.XY.init();j.background&&P.drawImage(j.background,0,0);j.drawBackground&&j.drawBackground(P);j.customDraw?j.customDraw(P,j):P.drawImage(j.image,S.x,S.y);j.postProcess&&j.postProcess(P,j);j.image=y}for(y=j.callbacks.length;y--;)j.callbacks[y]&&j.callbacks[y](this,false);j.callbacks=[];m[m.length]={url:this.src,created:j.requested};delete l[this.id];c()}}function f(j,
y,P){var S=d[j];if(S){S.hitCount++;S.image.complete&&S.image.width>0&&y?y(S.image,true):S.callbacks.push(y)}else{S=COG.extend({url:j,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[y]},P);S.image.id="resourceLoaderImage"+n++;d[j]=S;l[S.image.id]=S;t[t.length]=S;c()}return S}function b(j,y){var P=document.createElement("canvas");COG.info("creating new canvas");P.width=j?j:0;P.height=y?y:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(P);FlashCanvas.initElement(P)}return P}
var d={},l={},n=0,t=[],q=[],m=[],x={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var j;for(j=q.length;j--;)delete d[q[j].url];q=[];for(j=t.length;j--;)delete d[t[j].url];t=[]},get:function(j,y,P){var S=null;S=null;if((S=(S=d[j])?S.image:null)&&(S.getContext||S.complete&&S.width>0))return S;else y&&f(j,y,P);return null},load:f,newCanvas:b,reset:function(){d={}},stats:function(){return{imageLoadingCount:q.length,queuedImageCount:t.length,imageCacheFullness:0}}};COG.observable(x);return x}(),
Ia=function(){var c={};return{init:function(r,f){var b=c[r];if(!b)throw Error("Unable to locate requested generator: "+r);return new b(f)},register:function(r,f){c[r]=f},Template:function(){}}}(),Ga=function(){function c(n,t){d[n]=f(t);return n}function r(n){for(var t in n)c(t,n[t])}function f(n){function t(j){var y=n[j];typeof y!=="undefined"&&m.push(function(P){P[j]=y})}function q(){m=[];for(var j in n)t(j)}n=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,
lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},n);var m=[],x={applyToContext:function(j){for(var y=m.length;y--;)m[y](j)},update:function(j,y){n[j]=y;q()}};q();return x}var b={},d={},l={apply:function(n,t){var q=d[t]?d[t]:d.basic,m;if(n&&n.canvas){m=b[n.canvas.id];b[n.canvas.id]=t}q.applyToContext(n);return m},define:c,defineMany:r,get:function(n){return d[n]},init:f,load:function(n){COG.jsonp(n,function(t){r(t)})}};r({basic:{lineWidth:1,strokeStyle:"#000",
fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return l}(),Pa={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},bb=function(c){function r(w,v,D,T){Sa(qa-v,ha-D,T?c.panAnimationEasing:null,T?c.panAnimationDuration:null)}function f(w,v,D,T){Wa(V(oa(X+ka(2,T)-1,0.5),2))}function b(){var w=va(X)/Math.LN2>>0;if(w!==0){X=ka(2,w);fb(gb+Math.log(X)/Math.LN2,lb,mb)}Ba()}function d(w){w||(w=H.init(J,Z));ga=H.init(qa,ha);ya=H.offset(w,qa,ha);lb=ya.x;mb=
ya.y}function l(w,v){var D,T;T=1/X;if(X!==1&&g){D=g.x1+w*T;T=g.y1+v*T}else{D=w+qa;T=v+ha}return H.init(D,T)}function n(w,v,D){ia("doubleTap",v,D,l(D.x,D.y));c.scalable&&Wa(2,D,c.zoomEasing,null,c.zoomDuration)}function t(w,v,D){hb=null;j(v,D,l(D.x,D.y),"down")}function q(w,v,D){hb=l(D.x,D.y);j(v,D,hb,"hover")}function m(){clearTimeout(ja);ja=setTimeout(y,250)}function x(w,v,D){j(v,D,l(D.x,D.y),"tap");ia("tap",v,D,l(D.x,D.y))}function j(w,v,D,T){for(var ta=[],Ja=xa;Ja--;)if(ba[Ja].hitTest)ta=ta.concat(ba[Ja].hitTest(D.x,
D.y,Xa,Ca));ta.length>0&&Ca.triggerCustom(T+"Hit",{hitType:T},ta,w,v,D)}function y(w,v){var D;if(Da){if(c.autoSize&&Da.parentNode){w=Da.parentNode.offsetWidth;v=Da.parentNode.offsetHeight}try{if(!Da.id)Da.id=c.id+"_canvas";za=Da.getContext("2d")}catch(T){COG.exception(T);throw Error("Could not initialise canvas on specified view element");}if(w&&v&&(La!==v||Ma!==w)){Qa=true;Ma=w;La=v;J=Ma>>1;Z=La>>1;Ca.trigger("resize",Ma,La);for(D=xa;D--;)ba[D].trigger("resize",Ma,La)}for(D=xa;D--;)ba[D].trigger("contextChanged",
za);Ba();S()}}function P(w,v){v.setId(w);v.added=Y();v.bind("remove",function(){Ca.removeLayer(w)});v.trigger("contextChanged",za);v.setParent(Ca);ba.push(v);ba.sort(function(D,T){var ta=T.zindex-D.zindex;if(ta===0)ta=T.added-D.added;return ta});xa=ba.length;return v}function S(){Ya&&Ya.unbind();Ya=INTERACT.watch(Da);c.pannable&&Ya.pannable().bind("pan",r);if(c.scalable){Ya.bind("zoom",f);Ya.bind("doubleTap",n)}if(c.captureHover){Ya.bind("pointerDown",t);Ya.bind("pointerHover",q)}Ya.bind("tap",x)}
function ua(w){var v=k?qa+J:qa,D=i?ha+Z:ha;if(Na&&Na>Ma)if(v+Ma>Na)qa=k?w&&v-Na>0?qa-Na:qa:Na-Ma;else if(v<0)qa=k?w?qa+Na:qa:0;if(e&&e>La)if(D+La>e)ha=i?w&&D-e>0?ha-e:ha:e-La;else if(D<0)ha=i?w?ha+e:ha:0}function Ta(w){var v,D,T=false;if(nb){if(w-Za>Eb){D=qa!==ib||ha!==jb;Xa=zb|(X!==1?Ab:0)|(D?ob:0)|(pb?qb:0);Ea=(v=(Xa&(Ab|ob))!==0)&&(Xa&qb)===0;if(Qa&&Da){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(Da);Da.width=Ma;Da.height=La;Da.style.width=Ma+"px";Da.style.height=La+"px";Qa=false}if(Na||
e)ua();a=cb();for(D=xa;D--;){Xa|=ba[D].animated?qb:0;ba[D].cycle(w,a,Xa);ba[D].shouldDraw(Xa,a);T=ba[D].clip||T}D=Xa;var ta=a;T=C&&T&&!v;var Ja;la.center(ta);v=0;g=la.copy(ta);g.scaleFactor=X;if(!T)if(!rb||w-$>sb){za.clearRect(0,0,Ma,La);$=w}za.save();try{if(X!==1){var $a=g,Ua=1/X;lb=ya.x+(qa-ga.x);mb=ya.y+(ha-ga.y);g=$a?la.fromCenter(lb>>0,mb>>0,$a.width*Ua>>0,$a.height*Ua>>0):void 0;za.scale(X,X)}za.translate(-g.x1,-g.y1);O=R=null;if(T&&!rb){za.beginPath();for(v=xa;v--;)ba[v].clip&&ba[v].clip(za,
g,D,Ca,w);za.closePath();za.clip()}for(v=xa;v--;){Ja=ba[v];za.globalCompositeOperation=rb&&Ja.zIndex<=0?"copy":"source-over";var ab=Ja.style,db=ab?Ga.apply(za,ab):null;Ja.draw(za,g,D,Ca,w);db&&Ga.apply(za,db)}}finally{za.restore()}nb=0;ia("drawComplete",ta,w);w-U>tb&&kb();Za=w;ib=qa;jb=ha}animFrame(Ta)}else h=false}function Ba(){nb+=1;if(!h){h=true;animFrame(Ta)}}function cb(){return la.init(qa,ha,qa+Ma,ha+La)}function kb(){if(Na||e)ua(true);U=(new Date).getTime();ia("refresh",Ca,cb());Ba()}function Wa(w,
v,D,T,ta){if(D)COG.tweenValue(X,w,D,ta,function(Ja,$a){X=Ja;if($a){var Ua=Ha(va(X)/Math.LN2);X=ka(2,Ua);T&&T()}d(v);b()});else{X=w;d(v);b()}return Ca}function fb(w,v,D){w=oa(c.minZoom,V(c.maxZoom,w));if(w!==gb){var T=ka(2,w-gb),ta=J/T|0,Ja=Z/T|0;gb=w;Sa(((v?v:qa+J)-ta)*T,((D?D:ha+Z)-Ja)*T);ib=qa;jb=ha;ia("zoomLevelChange",w);X=1;kb()}}function ia(){for(var w=Ca.trigger.apply(null,arguments).cancel,v=ba.length;v--;)w=ba[v].trigger.apply(null,arguments).cancel||w;return!w}function Sa(w,v,D,T,ta){function Ja(){$a+=
1;if($a>=2){pb=false;ta&&ta()}}var $a=0,Ua=R?H.offset(R,-J,-Z):null,ab=O?H.offset(O,-J,-Z):null;if(Ua){w=w<Ua.x?Ua.x:w;v=v<Ua.y?Ua.y:v}if(ab){w=w>ab.x?ab.x:w;v=v>ab.y?ab.y:v}if(D){if((Xa&ob)===0){COG.tweenValue(qa,w,D,T,function(db,ub){qa=db|0;(ub?Ja:Ba)();return!Ea});COG.tweenValue(ha,v,D,T,function(db,ub){ha=db|0;(ub?Ja:Ba)();return!Ea});pb=true}}else{qa=w|0;ha=v|0;Ba();ta&&ta()}}c=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastDraw:false,inertia:true,minRefresh:1E3,pannable:true,
clipping:true,scalable:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},c);var sb=500,ba=[],xa=0,Da=document.getElementById(c.container),za=null,vb=typeof window.attachEvent!="undefined",tb=c.minRefresh,hb=null,qa=0,ha=0,ib=0,jb=0,Na=null,e=null,k=false,i=false,C=c.clipping,a=null,h=false,g,z=1,J=0,Z=0,ga=
null,ya=null,Ea=false,R=null,O=null,U=0,$=0,ja=0,X=1,Za=0,Qa=false,Ya=null,rb=c.turbo,pb=false,La,Ma,Eb=1E3/c.fps|0,nb=0,lb,mb,gb=c.zoomLevel,zb=aa("ACTIVE"),ob=aa("PAN"),Ab=aa("ZOOM"),qb=aa("ANIMATING"),Xa=zb,Ca={id:c.id,deviceScaling:z,fastDraw:c.fastDraw||M().requireFastDraw,getDimensions:function(){return B.init(Ma,La)},getLayer:function(w){for(var v=0;v<xa;v++)if(ba[v].getId()==w)return ba[v];return null},getZoomLevel:function(){return gb},setLayer:function(w,v){for(var D=0;D<xa;D++)if(ba[D].getId()===
w){ba.splice(D,1);break}if(v){P(w,v);v.trigger("refresh",Ca,cb())}Ba();return v},eachLayer:function(w){for(var v=xa;v--;)w(ba[v])},invalidate:Ba,refresh:kb,resetScale:function(){X=1},resize:function(w,v){if(Da){c.autoSize=false;if(Ma!==w||La!==v)y(w,v)}},scale:Wa,setZoomLevel:fb,triggerAll:ia,removeLayer:function(w){a:{for(var v=xa;v--;)if(ba[v].getId()==w){w=v;break a}w=-1}if(w>=0&&w<xa){Ca.trigger("layerRemoved",ba[w]);ba.splice(w,1);Ba()}xa=ba.length},getOffset:function(){return H.init(qa,ha)},
setMaxOffset:function(w,v,D,T){Na=w;e=v;k=typeof D!="undefined"?D:false;i=typeof T!="undefined"?T:false},getViewRect:cb,updateOffset:Sa,pan:function(w,v,D,T,ta){Sa(qa+w,ha+v,D,T,ta)}};z=M().getScaling();Ca.markers=P("markers",new wb);COG.observable(Ca);Ca.bind("invalidate",function(){Ba()});Ca.bind("resync",function(){O=R=null});COG.configurable(Ca,["container","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(c,null,{container:function(w,v){Da=document.getElementById(v);
y()},inertia:S,scalable:S,pannable:S}),true);y();if(c.autoSize)vb?window.attachEvent("onresize",m):window.addEventListener("resize",m,false);return Ca},eb=function(c){c=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:aa("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var r=null,f=false,b=false,d=c.id,l=aa("ACTIVE"),n=c.validStates,t=0,q=0,m=COG.extend({addToView:function(x){x.setLayer(d,m)},shouldDraw:function(x){return(x&n)!==0},clip:null,cycle:function(){},
draw:function(){},remove:function(){m.trigger("remove",m)},changed:function(){b=true;r&&r.invalidate()},hitTest:null,getId:function(){return d},setId:function(x){d=x},getParent:function(){return r},setParent:function(x){f=(r=x)?r.fastDraw&&displayState!==l:false;m.trigger("parentChange",r)}},c);COG.observable(m);m.bind("drawComplete",function(x,j){b=false;t=j.x1;q=j.y1});m.bind("resync",function(x,j){if(j.syncXY){m.minXY&&j.syncXY(m.minXY);m.maxXY&&j.syncXY(m.maxXY)}});return m},xb=function(c){function r(q,
m,x,j){b=q;d=m;l=x;n=j}c=COG.extend({xy:H.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var f=false,b=0,d=0,l=0,n=0,t=COG.extend(c,{isAnimating:function(){return f},draw:function(q,m,x,j,y){if(t.isNew&&c.tweenIn)COG.tweenValue(m.y1-20,t.xy.y,c.tweenIn,c.animationSpeed?c.animationSpeed:250+Math.random()*500,function(P,S){t.xy.y=P|0;f=!S;y.invalidate()});t.drawMarker(q,m,t.xy.x,t.xy.y,x,j,y);t.isNew=false},drawMarker:function(q,m,x,j){q.beginPath();q.arc(x,j,4,0,Math.PI*2,false);
q.fill();r(x-4,j-4,8,8)},hitTest:function(q,m){return q>=b&&q<=b+l&&m>=d&&m<=d+n},updateBounds:r});COG.observable(t);return t},wb=function(c){function r(){f();d.changed();d.trigger("markerUpdate",b)}function f(){var l=d.getParent();if(l&&l.syncXY)for(var n=b.length;n--;)l.syncXY([b[n].xy]);b.sort(function(t,q){var m=q.xy.y-t.xy.y;if(m==0)m=q.xy.x-t.xy.x;return m})}c=COG.extend({zindex:100,style:"basic"},c);var b=[],d=COG.extend(new eb(c),{draw:function(l,n,t,q){for(var m=b.length;m--;)b[m].draw(l,
n,t,d,q)},add:function(l){if(l&&typeof l.length!=="undefined")for(var n=l.length;n--;){if(l[n])b[b.length]=l[n]}else if(l)b[b.length]=l;r()},clear:function(l){if(l)for(var n=0;n<b.length;)if(l(b[n]))b.splice(n,1);else n+=1;else b=[];r()},each:function(l){if(l)for(var n=b.length;n--;)l(b[n])},find:function(l){for(var n=[],t=b.length;t--;)if(!l||l(b[t]))n[n.length]=b[t];return n},hitTest:function(l,n){for(var t=[],q=b.length;q--;)if(b[q].hitTest(l,n))t[t.length]={type:"marker",data:b[q]};return t}});
d.bind("tap",function(l,n,t,q){var m=[],x=q.x;q=q.y;for(var j=b.length;j--;)if(b[j].hitTest(x,q))m[m.length]=b[j];if(m.length>0)l.cancel=d.trigger("markerTap",n,t,m).cancel});d.bind("parentChange",f);d.bind("resync",f);return d},Bb=function(c){function r(q,m,x){q.fillStyle="#FFFFFF";q.strokeStyle="#222222";q.beginPath();q.arc(x.x,x.y,4,0,Math.PI*2,false);q.stroke();q.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:aa("ACTIVE","PAN","ZOOM"),drawIndicator:null,
duration:2E3},c);var f=H.edges(c.path),b,d=null,l=c.drawIndicator?c.drawIndicator:r,n=0,t=COG.extend(new eb(c),{cycle:function(){for(var q=0;q<f.accrued.length&&f.accrued[q]<n;)q++;d=null;if(q<c.path.length-1){var m=n-(q>0?f.accrued[q-1]:0),x=c.path[q];b=H.theta(x,c.path[q+1],f.edges[q]);d=H.extendBy(x,b,m)}return d},draw:function(q,m){d&&l&&l(q,m,H.init(d.x,d.y),b)}});COG.tweenValue(0,f.total,c.easing,c.duration,function(q,m){n=q;m&&t.remove();t.changed()});return t},Cb=function(c){c=COG.extend({style:null,
properties:{}},c);return COG.extend(c,{rect:null,draw:function(){},resync:function(){}})},yb=function(c,r){r=COG.extend({fill:false,simplify:false},r);var f=false,b=r.fill,d=r.simplify,l=aa("ZOOM"),n=[],t=COG.extend(new Cb(r),{draw:function(q,m,x,j,y,P){if(f){m=true;x=(P&l)!==0;q.beginPath();for(P=n.length;P--;){x=n[P].x;j=n[P].y;if(m){q.moveTo(x,j);m=false}else q.lineTo(x,j);x=true}if(x){b&&q.fill();q.stroke()}}},resync:function(q){t.xy=q.syncXY(c);n=H.floor(d?H.simplify(c):c)}});f=c&&c.length>=
2;return t},Db=function(c){function r(l){for(var n=b.length;n--;)b[n].resync(l);b.sort(function(t,q){var m=q.xy.y-t.xy.y;if(m===0)m=q.xy.x-t.xy.y;return m});d.changed()}function f(l,n){n.syncXY&&r(n)}c=COG.extend({zindex:80},c);var b=[],d=COG.extend(new eb(c),{add:function(l){b[b.length]=l},each:function(l){for(var n=b.length;n--;)l(b[n])},draw:function(l,n,t){var q=n.x1,m=n.y1,x=n.width;n=n.height;for(var j=b.length;j--;){var y=b[j].style;y=y?Ga.apply(l,y):null;b[j].draw(l,q,m,x,n,t);y&&Ga.apply(l,
y)}}});d.bind("parentChange",f);d.bind("resync",f);return d},Fb=function(){return{tileSize:256,init:function(c,r,f,b,d){return COG.extend({x:c,y:r,width:f,height:b},d)}}}(),Va={ex:COG.extend,ticks:Y,getConfig:M,userMessage:function(c,r,f){Va.trigger("userMessage",c,r,f)},XY:H,XYRect:la,Dimensions:B,Vector:ca,D:B,Images:W,Generator:Ia,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ga,viewState:aa,View:bb,ViewLayer:eb,ImageLayer:function(c,r){function f(m,x,j){for(x=
n.length;x--;){var y=n[x],P=y.x,S=y.y,ua=la.init(y.x,y.y,y.x+y.width,y.y+y.height);if(j&&la.intersect(m,ua))(ua=W.get(y.url,function(){q.changed()},t))&&j(ua,P,S,y.width,y.height)}}function b(m){var x=++l,j=q.getParent();d&&d.run(j,m,function(y){if(x==l){n=[].concat(y);j.invalidate()}})}r=COG.extend({imageLoadArgs:{}},r);var d=c?Ia.init(c,r):null,l=0,n=[],t=r.imageLoadArgs,q=COG.extend(new eb(r),{changeGenerator:function(m,x){d=Ia.init(m,COG.extend({},r,x));n=null;b(q.getParent().getViewRect())},
clip:function(m,x,j){f(x,j,function(y,P,S,ua,Ta){m.rect(P,S,ua,Ta)})},draw:function(m,x,j){f(x,j,function(y,P,S,ua,Ta){q.drawImage(m,y,P,S,ua,Ta,x,j)})},drawImage:function(m,x,j,y){x&&m.drawImage(x,j,y,x.width,x.height)}});q.bind("refresh",function(m,x,j){b(j)});q.bind("tap",function(m,x,j,y){m=[];var P=y.x,S=y.y,ua,Ta;if(n)for(var Ba=n.length;Ba--;){ua=n[Ba];if(Ta=P>=ua.x&&P<=ua.x+ua.width&&S>=ua.y&&S<=ua.y+ua.height)m[m.length]=ua}m.length>0&&q.trigger("tapImage",m,x,j,y)});return q},ImageGenerator:function(c){c=
COG.extend({relative:false,padding:2},c);c={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(c);return c},Marker:xb,ImageMarker:function(c){c=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},c);var r=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,f=COG.extend(new xb(c),{changeImage:function(b){f.image=W.get(b,function(d){f.image=d})},drawMarker:function(b,d,l,n){if((d=f.isAnimating()&&
f.animatingImage?f.animatingImage:f.image)&&d.width>0){r||(r=H.init(-d.width>>1,-d.height>>1));var t=f.scale,q=l+~~(r.x*t),m=n+~~(r.y*t),x=~~(d.width*t),j=~~(d.height*t);f.updateBounds(q,m,x,x);if(f.rotation||f.opacity!==1){b.save();try{b.globalAlpha=f.opacity;b.translate(l,n);b.rotate(f.rotation);b.drawImage(d,r.x*t,r.y*t,x,j)}finally{b.restore()}}else b.drawImage(d,q,m,x,j)}}});if(!f.image)f.image=W.get(c.imageUrl,function(b){f.image=b});if(!f.animatingImage)f.animatingImage=W.get(c.animatingImageUrl,
function(b){f.animatingImage=b});return f},MarkerLayer:wb,PathLayer:function(c){function r(){var m=q.getParent();if(m&&m.syncXY){m.syncXY(d);l&&m.syncXY(l);q.trigger("tidy")}}c=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},c);var f=[],b=null,d=[],l=null,n=0,t=[],q=COG.extend(new eb(c),{getAnimation:function(m,x,j,y){var P="pathAnimation"+n++;t.push(P);return new Bb({id:P,path:f,zindex:c.zindex+1,easing:m?m:COG.easing("sine.inout"),duration:x?x:5E3,drawIndicator:j,autoCenter:y?y:false})},
draw:function(m){var x,j=f.length;m.save();try{Ga.apply(m,c.style);if(j>0){m.beginPath();m.moveTo(f[j-1].x,f[j-1].y);for(x=j;x--;)m.lineTo(f[x].x,f[x].y);m.stroke();if(b){m.fillStyle=c.waypointFillStyle;for(x=b.length;x--;){m.beginPath();m.arc(b[x].x,b[x].y,2,0,Math.PI*2,false);m.stroke();m.fill()}}}}finally{m.restore()}},updateCoordinates:function(m,x){d=m;l=x;r()}});q.bind("tidy",function(){f=H.simplify(d,c.pixelGeneralization);b=H.simplify(l,c.pixelGeneralization);q.changed(true)});q.bind("resync",
r);return q},AnimatedPathLayer:Bb,Shape:Cb,Arc:function(c,r){r=COG.extend({size:4},r);var f=H.init(),b=COG.extend(r,{draw:function(d){d.beginPath();d.arc(f.x,f.y,b.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([c]);f=H.floor([c])[0]}});COG.info("created arc = ",c);return b},Poly:yb,ShapeLayer:Db,Tiling:Fb};COG.observable(Va);var Oa=Va.Geo=function(){function c(e){for(var k=null,i=1;!k&&i<arguments.length;i++)k=l(e,arguments[i]);k=k?k:l(e);if(!k)throw Error("Unable to find GEO engine with "+
e+" capability");return k}function r(e){e=parseFloat(e)*y;e=wa(e);var k=Ba*e;return va((1+e)/(1-e)*ka((1-k)/(1+k),Ba))/2}function f(e){return parseFloat(e)*y}function b(e){e=ka(Math.E,-e);for(var k=A-2*pa(e),i=n(k,e),C=0;C<kb&&L(k-i)>cb;){k=i;i=n(k,e);C++}return i*P}function d(e){return e%360*P}function l(e,k){var i=null;for(var C in xa)if(k){if(C==k&&xa[C][e]){i=xa[C];break}}else if(xa[C][e]){i=xa[C];break}return i}function n(e,k){var i=Ba*wa(e);return A-2*pa(k*ka((1-i)/(1+i),Ba/2))}function t(e,
k,i,C){k=m(k);e.add(C.line(k,i));return k.length}function q(e,k,i,C){k=m(k);e.add(C.poly(k,i));return k.length}function m(e){var k=e?e.length:0,i=Array(k);for(k=k;k--;)i[k]=Oa.Position.init(e[k][1],e[k][0]);return Oa.Position.vectorize(i,qa)}function x(e,k,i){return new jb(e,k,i)}var j=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],y=Math.PI/180,P=180/Math.PI,S=A,ua=-S,Ta=-u,Ba=0.08181919084262157,cb=1.0E-7,kb=12,Wa=null,fb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",
CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ia=function(){function e(a){return a?i(a.lat,a.lon):null}function k(a){return!a||a.lat===0&&a.lon===0}function i(a,h){return{lat:parseFloat(a?a:0),lon:parseFloat(h?h:0)}}function C(a){if(a)if(typeof a.lat!=="undefined")return e(a);else{if(a.split)for(var h=[" ",","],g=0;g<h.length;g++){var z=a.split(h[g]);if(z.length===2)return i(z[0],z[1])}}else return i();return null}return{calcDistance:function(a,h){if(k(a)||k(h))return 0;var g=
(h.lat-a.lat)*y>>1,z=(h.lon-a.lon)*y>>1;g=wa(g)*wa(g)+da(a.lat*y)*da(h.lat*y)*wa(z)*wa(z);return 6371*2*ra(ma(g),ma(1-g))},copy:e,empty:k,equal:function(a,h){return a&&h&&a.lat==h.lat&&a.lon==h.lon},fromMercatorPixels:function(a,h){return i(b(h),d(a))},generalize:function(a,h,g){var z=a.length,J=[],Z=null;g||(g=250);g/=1E3;COG.info("generalizing positions, must include "+h.length+" positions");for(var ga=z;ga--;)if(ga===0)J.unshift(a[ga]);else{var ya=!Z||ia.inArray(a[ga],h)?g:ia.calcDistance(Z,a[ga]);
if(a[ga]&&ya>=g){J.unshift(a[ga]);Z=a[ga]}}COG.info("generalized "+z+" positions into "+J.length+" positions");return J},inArray:function(a,h){for(var g=ia.equal,z=h.length;z--;)if(g(a,h[z]))return true;return false},inBounds:function(a,h){var g=!(ia.empty(a)||ia.empty(h));return g=(g=g&&a.lat>=h.min.lat&&a.lat<=h.max.lat)&&a.lon>=h.min.lon&&a.lon<=h.max.lon},init:i,offset:function(a,h,g){var z=a.lat*y;a=a.lon*y;h=z+h/6371;g=Ka(wa(g/6371)/da(z));g=a+g;h=(h+A)%Math.PI-A;g%=u;return i(h*P,g*P)},parse:C,
parseArray:function(a){var h=a.length,g=Array(h);for(h=h;h--;)g[h]=C(a[h]);return g},toMercatorPixels:function(a){return T5.XY.init(f(a.lon),r(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,h){function g(){for(var ga=0,ya=h.chunkSize,Ea=z;Ea--;){J[Ea]=T5.GeoXY.init(a[Ea]);ga+=1;if(ga>ya)break}z=Ea;if(z<=0)h.callback&&h.callback(J);else animFrame(g)}var z=a.length,J=Array(z);h=COG.extend({chunkSize:500,async:true,callback:null},h);if(!h.async){for(var Z=z;Z--;)J[Z]=
T5.GeoXY.init(a[Z]);return J}animFrame(g);return null}}}(),Sa=function(){function e(a,h,g){var z=T5.XY.init(0,h.lat-a.lat);if(typeof g==="undefined")g=true;z.x=g&&a.lon>h.lon?360-a.lon+h.lon:h.lon-a.lon;return z}function k(a,h){return Sa.init(ia.init(a.min.lat-h,a.min.lon-h%360),ia.init(a.max.lat+h,a.max.lon+h%360))}function i(a){var h=e(a.min,a.max);return ia.init(a.min.lat+(h.y>>1),a.min.lon+(h.x>>1))}function C(a,h){return{min:ia.parse(a),max:ia.parse(h)}}return{calcSize:e,createBoundsFromCenter:function(a,
h){var g=h/6371,z=a.lat*y,J=a.lon*y,Z=z-g,ga=z+g;if(Z>ua&&ga<S){z=Ka(wa(g)/da(z));g=(J-z)%u;J=(J+z)%u}else{Z=oa(Z,ua);ga=V(ga,S);g=Ta;J=u}return Sa.init(ia.init(Z*P,g*P),ia.init(ga*P,J*P))},expand:k,forPositions:function(a,h){var g=null,z=T5.ticks();h||(h="auto");for(var J=a.length;J--;)if(g){var Z=e(g.min,a[J],false),ga=e(a[J],g.max,false);if(Z.x<0)g.min.lon=a[J].lon;if(Z.y<0)g.min.lat=a[J].lat;if(ga.x<0)g.max.lon=a[J].lon;if(ga.y<0)g.max.lat=a[J].lat}else g=C(a[J],a[J]);if(h){if(h=="auto"){J=e(g.min,
g.max);h=oa(J.x,J.y)*0.3}g=k(g,h)}COG.trace("calculated bounds for "+a.length+" positions",z);return g},getCenter:i,getGeoHash:function(a){var h=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+h+", max hash = "+a)},getZoomLevel:function(a,h){var g=i(a);g=V(Ha(L(g.lat)*0.05),j.length);var z=j[g],J=e(a.min,a.max);g=na(va(j[3]*h.height/J.y)/va(2));z=na(va(z*h.width/J.x)/va(2));return V(isNaN(g)?1E3:g,isNaN(z)?1E3:z)},init:C,isEmpty:function(a){return!a||
ia.empty(a.min)||ia.empty(a.max)},toString:function(a){return"min: "+ia.toString(a.min)+", max: "+ia.toString(a.max)}}}(),sb=function(){var e=/^(\d+).*$/,k=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(i,C){e.lastIndex=-1;if(e.test(i))for(var a=i.replace(e,"$1"),h=C.split(","),g=0;g<h.length;g++){k.lastIndex=-1;if(k.test(h[g])){var z=k.exec(h[g]);if(a>=parseInt(z[1],10)&&a<=parseInt(z[2],10))return true}else if(a==h[g])return true}return false},normalize:function(i){if(!i)return"";i=i.toUpperCase();
if(!Wa){var C=[];for(var a in fb)C.push(a);Wa=RegExp("(\\s)("+C.join("|")+")(\\s|$)","i")}Wa.lastIndex=-1;if(C=Wa.exec(i))i=i.replace(Wa,"$1"+fb[C[2]]);return i},toString:function(i){return i.streetDetails+" "+i.location}}}(),ba=Va.GeoXY=function(){function e(i,C){if(i.length){for(var a,h,g,z,J=i.length;J--;){e(i[J],C);a=typeof a==="undefined"||i.x<a?i.x:a;h=typeof h==="undefined"||i.y<h?i.y:h;g=typeof g==="undefined"||i.x>g?i.x:g;z=typeof z==="undefined"||i.y>z?i.y:z}return la.init(a,h,z,z)}else if(i.mercXY){a=
i.mercXY;i.x=(a.x+Math.PI)/C|0;i.y=(Math.PI-a.y)/C|0;i.rpp=C}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return i}function k(i,C,a){i.pos=C;i.mercXY=ia.toMercatorPixels(C);(a=typeof a!=="undefined"?a:i.rpp)&&e(i,a)}return{init:function(i,C){var a=H.init();k(a,i,C);return a},sync:e,toPos:function(i,C){C=C?C:self.rpp;return ia.fromMercatorPixels(i.x*C-Math.PI,Math.PI-i.y*C)},updatePos:k}}(),xa={},Da=function(){return{bestResults:function(e,k){k||(k=20);for(var i=e.length>0?e[0]:
null,C=[],a=0;a<e.length;a++)if(i&&e[a]&&i.matchWeight-e[a].matchWeight<=k)C.push(e[a]);else break;return C}}}(),za=function(e){e=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},e);return COG.extend(e,{toString:function(){return e.caption+(e.matchWeight?" ("+e.matchWeight+")":"")}})},vb=function(){function e(a,h){var g=a.getDimensions();g=new Na({data:h,width:g.width,height:g.height});a.setLayer("route",g)}function k(a){for(var h=i.Unknown,g=C,z=0;z<g.length;z++){g[z].regex.lastIndex=
-1;var J=g[z].regex.exec(a);if(J){h=g[z].customCheck?g[z].customCheck(a,J):g[z].turnType;break}}return h}var i={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},
C=function(){var a=[];a.push({regex:/continue/i,turnType:i.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(h,g){return/bear/i.test(g[1])?i.TurnLeftSlight:i.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(h,g){return/bear/i.test(g[1])?i.TurnRightSlight:i.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:i.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:i.Ramp});a.push({regex:/take.*?exit/i,turnType:i.RampExit});a.push({regex:/make(.*?)u\-turn/i,
customCheck:function(h,g){return/right/i.test(g[1])?i.UTurnRight:i.UTurnLeft}});a.push({regex:/proceed/i,turnType:i.Start});a.push({regex:/arrive/i,turnType:i.Arrive});a.push({regex:/fell\sthrough/i,turnType:i.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var h=c("route");h&&h.route(a,function(g){if(a.generalize)g.geometry=ia.generalize(g.geometry,g.getInstructionPositions());if(a.map){e(a.map,
g);a.autoFit&&a.map.gotoBounds(g.boundingBox)}a.success&&a.success(g)})},createMapOverlay:e,parseTurnType:k,TurnType:i,Instruction:function(a){var h=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),g=a.description;g=g.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");h.description=g;if(!a.turnType)a.turnType=k(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Sa.forPositions(a.geometry);
return COG.extend({getInstructionPositions:function(){for(var h=[],g=0;g<a.instructions.length;g++)a.instructions[g].position&&h.push(a.instructions[g].position);return h}},a)}}}(),tb="featurecollection",hb="feature",qa={async:false},ha={processor:null,group:"shapes",layerClass:Db},ib={point:COG.extend({},ha,{processor:function(e,k,i,C){k=m([k.coordinates],qa);if(k.length>0)if(i=C.marker(k[0],i)){e.add(i);return k.length}},group:"markers",layerClass:wb}),linestring:COG.extend({},ha,{processor:function(e,
k,i,C){k=m(k&&k.coordinates?k.coordinates:[]);return t(e,k,i,C)}}),multilinestring:COG.extend({},ha,{processor:function(e,k,i,C){k=k&&k.coordinates?k.coordinates:[];for(var a=0,h=k.length;h--;)a+=t(e,k[h],i,C);return a}}),polygon:COG.extend({},ha,{processor:function(e,k,i,C){k=k&&k.coordinates?k.coordinates:[];if(k.length>0)return q(e,k[0],i,C);return 0}}),multipolygon:COG.extend({},ha,{processor:function(e,k,i,C){k=k&&k.coordinates?k.coordinates:[];for(var a=0,h=0;h<k.length;h++)a+=q(e,k[h][0],i,
C);return a}})},jb=function(e,k,i,C){function a(U,$){var ja=U.processor,X=Z+U.group,Za=COG.extend({},U,i,{properties:$.properties});if(ja){var Qa=O[X];if(!Qa){Qa=new U.layerClass({id:X});O[X]=Qa}globalLayers=O;return ja(Qa,$.data,Za,C)}return 0}function h(U,$){var ja=U&&U.type?U.type.toLowerCase():null;return ja&&ja===hb?h(U.geometry,U.properties):{type:ja,isCollection:ja?ja===tb:false,definition:ib[ja],data:U,properties:$?$:U.properties}}function g(){var U=0,$=ga;if(!Ea){for(;$<ya;$++){var ja=h(J?
J(e[$]):e[$]),X=null;if(ja.isCollection){R+=1;Ea=x(ja.data.features,function(Za){Ea=null;for(var Qa in Za)O[Qa]=Za[Qa]},{layerPrefix:Z+R+"-"});X+=1}else if(ja.definition)X=a(ja.definition,ja);U+=X?X:1;if(U>=z)break}ga=$+1;if(Ea||ga<ya)animFrame(g);else k&&k(O)}}i=COG.extend({vectorsPerCycle:Oa.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},i);C=COG.extend({marker:function(U){return new xb({xy:U})},line:function(U,$){return new yb(U,$)},poly:function(U,$){return new yb(U,
COG.extend({fill:true},$))}},C);var z=i.vectorsPerCycle,J=i.rowPreParse,Z=i.layerPrefix,ga=0,ya=0,Ea=null,R=0,O={};if(e){if(typeof e.length==="undefined")e=[e];ya=e.length;animFrame(g)}};Va.GeoJSON={parse:x};Va.Map=function(e){function k(O){try{var U=Oa.Position.init(O.coords.latitude,O.coords.longitude),$=O.coords.accuracy/1E3;R.trigger("locationUpdate",O,$);if(ga){if(!J){J=new Oa.UI.LocationOverlay({pos:U,accuracy:$});J.update(R.getTileLayer());R.setLayer("location",J)}var ja=Oa.BoundingBox.createBoundsFromCenter(U,
Math.max($,1));R.gotoBounds(ja)}else{J.pos=U;J.accuracy=$;J.update(R.getTileLayer());a(U,null,COG.easing("sine.out"))}ga=false}catch(X){COG.exception(X)}}function i(O){COG.info("caught location tracking error:",O)}function C(O,U,$){R.setZoomLevel(U);a(O,$)}function a(O,U,$,ja){O=ba.init(O,Oa.radsPerPixel(R.getZoomLevel()));var X=R.getDimensions();R.updateOffset(O.x-(X.width>>1),O.y-(X.height>>1),$,ja,function(){R.refresh();R.trigger("boundsChange",R.getBoundingBox());U&&U(R)})}e=COG.extend({tapExtent:10,
crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18},e);var h={NONE:0,SINGLE:1,WATCH:2},g=H.init(),z=h.NONE,J=null,Z=0,ga=true,ya=0,Ea=e.tapExtent;e.adjustScaleFactor=function(O){return Math.pow(2,(O<1?Math.floor:Math.ceil)(Math.log(O)))};var R=COG.extend(new bb(e),{getBoundingBox:function(){var O=R.getViewRect();return Oa.BoundingBox.init(ba.toPos(H.init(O.x1,O.y2),ya),ba.toPos(H.init(O.x2,O.y1),ya))},getCenterPosition:function(){var O=R.getViewRect();if(O){O=H.init(O.x1+(O.width>>
1),O.y1+(O.height>>1));return ba.toPos(O,ya)}return null},gotoBounds:function(O,U){var $=Oa.BoundingBox.getZoomLevel(O,R.getDimensions());C(Oa.BoundingBox.getCenter(O),$,U)},gotoPosition:C,panToPosition:a,syncXY:function(O){return ba.sync(O,ya)},locate:function(){R.trackStart(h.SINGLE);setTimeout(R.trackCancel,1E4)},trackStart:function(O){if(navigator.geolocation&&!Z){z=O?O:h.WATCH;ga=true;Z=navigator.geolocation.watchPosition(k,i,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){Z&&
navigator.geolocation&&navigator.geolocation.clearWatch(Z);R.removeLayer("location");J=null;z=h.NONE;Z=0},animateRoute:function(O,U,$,ja){var X=R.getLayer("route");if(X)(O=X.getAnimation(O,U,$,ja))&&O.addToView(R)}});R.bind("pan",function(){z===h.SINGLE&&R.trackCancel()});R.bind("tap",function(O,U,$,ja){var X=Oa.radsPerPixel(R.getZoomLevel());O=ba.toPos(ja,X);var Za=ba.toPos(H.offset(ja,-Ea,Ea),X);ja=ba.toPos(H.offset(ja,Ea,-Ea),X);R.trigger("geotap",U,$,O,Sa.init(Za,ja))});R.bind("refresh",function(){if(H.absSize(H.diff(g,
R.getOffset()))>e.boundsChangeThreshold){g=H.copy(R.getOffset());R.trigger("boundsChange",R.getBoundingBox())}});R.bind("zoomLevelChange",function(O,U){var $;ya=Oa.radsPerPixel(U);$=u/ya|0;R.setMaxOffset($,$,true,false);W.cancelLoad();R.resetScale();R.triggerAll("resync",R);R.refresh()});return R};Va.GeoShape=function(e,k){k=COG.extend({autoParse:true},k);for(var i=Array(e.length),C=k.autoParse,a=T5.Geo.Position.parse,h=e.length;h--;)i[h]=T5.GeoXY.init(C?a(e[h]):e[h]);return new T5.Poly(i,k)};var Na=
Va.RouteOverlay=function(e){e=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},e);var k=[],i=[],C=new T5.PathLayer(e);(function(){if(e.data&&e.data.instructions){for(var a=e.data.instructions,h=Array(a.length),g=a.length;g--;)h[g]=a[g].position;ia.vectorize(h,{callback:function(z){i=z}})}e.data&&e.data.geometry&&ia.vectorize(e.data.geometry,{callback:function(z){k=z;C.updateCoordinates(k,i,true)}})})();
return C};Va.LocationOverlay=function(e){e=COG.extend({pos:null,accuracy:null,zindex:90},e);var k=new Image,i=T5.XY.init(),C=T5.XY.init(),a=null;k.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
k.onload=function(){i=T5.XY.init(k.width>>1,k.height>>1)};var h=COG.extend(new T5.ViewLayer(e),{pos:e.pos,accuracy:e.accuracy,drawAccuracyIndicator:false,draw:function(g,z){var J=C.x-z.x,Z=C.y-z.y;if(a){g.fillStyle="rgba(30, 30, 30, 0.2)";g.beginPath();g.arc(J,Z,a,0,Math.PI*2,false);g.fill()}k.complete&&k.width>0&&g.drawImage(k,J-i.x,Z-i.y,k.width,k.height);h.changed()},update:function(g){if(g){a=g.getPixelDistance(h.accuracy)>>1;C=g.getGridXYForPosition(h.pos);h.changed()}}});h.bind("gridUpdate",
function(g,z){h.update(z)});return h};return{distanceToString:function(e){if(e>1E3)return~~(e/10)/100+" km";return e?e+" m":""},dist2rad:function(e){return e/6371},getEngine:c,lat2pix:r,lon2pix:f,pix2lat:b,pix2lon:d,radsPerPixel:function(e){return u/(256<<e)},Position:ia,BoundingBox:Sa,Radius:function(e,k){return{distance:parseInt(e,10),uom:k}},Address:function(e){return e=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},e)},A:sb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(e){if(!e.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var k=COG.extend({remove:function(){delete xa[k.id]}},e);return xa[k.id]=k},Search:Da,GeoSearchResult:za,LocationSearch:function(e){function k(g,z){navigator.geolocation.clearWatch(C);C=0;if(a){clearTimeout(a);a=0}z&&z([g],e)}function i(g){COG.info("caught location tracking error:",g)}e=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},e);var C=0,a=0,h=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(g,z){if(navigator.geolocation&&!C){C=navigator.geolocation.watchPosition(function(J){var Z=ia.init(J.coords.latitude,J.coords.longitude);J=new za({id:1,caption:"Current Location",pos:Z,accuracy:J.coords.accuracy/1E3,matchWeight:100});if(!h||J.accuracy<h.accuracy)h=J;if(!e.requiredAccuracy||h.accuracy<e.requiredAccuracy)k(h,z)},i,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(e.searchTimeout)a=
setTimeout(function(){h&&k(h,z)},e.searchTimeout)}}},e))},Routing:vb}}();return Va}();
