COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var Y=arguments[0]||{},la,J=1,G=arguments.length;J<G;J++)if((la=arguments[J])!==null)for(var p in la){var o=la[p];if(Y!==o)if(o!==undefined)Y[p]=o}return Y};
(function(){var Y=Object.prototype.hasOwnProperty,la=0,J={};J.toID=function(G){return G.replace(/\s/g,"-")};J.objId=function(G){return(G?G:"obj")+la++};J.isFunction=function(G){return toString.call(G)==="[object Function]"};J.isArray=function(G){return toString.call(G)==="[object Array]"};J.isPlainObject=function(G){if(!G||toString.call(G)!=="[object Object]"||G.nodeType||G.setInterval)return false;if(G.constructor&&!Y.call(G,"constructor")&&!Y.call(G.constructor.prototype,"isPrototypeOf"))return false;
var p;for(p in G);return p===undefined||Y.call(G,p)};J.isEmptyObject=function(G){for(var p in G)return false;return true};J.isXmlDocument=function(G){return toString.call(G)==="[object Document]"};J.contains=function(G,p){var o=G,E=arguments,C=1;if(p&&module.isArray(p)){E=p;C=0}for(C=C;C<E;C++)o=o&&typeof foo[E[C]]!=="undefined";return o};J.formatStr=function(G){if(arguments.length<=1)return G;for(var p=arguments.length-2,o=0;o<=p;o++)G=G.replace(RegExp("\\{"+o+"\\}","gi"),arguments[o+1]);return G};
J.wordExists=function(G,p){var o="";if(p.toString)p=p.toString();for(var E=0;E<p.length;E++)o+=!/\w/.test(p[E])?"\\"+p[E]:p[E];return RegExp("(^|\\s|\\,)"+o+"(\\,|\\s|$)","i").test(G)};COG.extend(COG,J)})();
(function(){function Y(o){return typeof console!=="undefined"?function(){console[o](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var la=window.console&&window.console.markTimeline,J=Y("error"),G=Y("info"),p=function(){return la?function(o,E){console.markTimeline(o+(E?": "+((new Date).getTime()-E)+"ms":""))}:function(){}}();COG.extend(COG,{trace:p,debug:Y("debug"),info:G,warn:Y("warn"),error:J,exception:function(o){if(J)for(var E in o)G("ERROR DETAIL: "+
E+": "+o[E])}})})();var FNS_TIME=["webkitAnimationTime","mozAnimationTime","animationTime","webkitAnimationStartTime","mozAnimationStartTime","animationStartTime"],FNS_FRAME=["webkitRequestAnimationFrame","mozRequestAnimationFrame","requestAnimationFrame"],animTime=function(){return(new Date).getTime()},animFrame=function(Y){setTimeout(function(){Y(animTime())},1E3/60)};FNS_TIME.forEach(function(Y){if(Y in window)animTime=function(){return window[Y]}});
FNS_FRAME.forEach(function(Y){if(Y in window)animFrame=function(la){window[Y](la)}});COG.animTime=animTime;COG.animFrame=animFrame;
COG.Loopage=function(){function Y(C){return COG.extend({id:p++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},C)}function la(C){E.push(C);G||(G=animFrame(J));recalcSleepFrequency=true}function J(){for(var C,aa=animTime(),ka=o.length;E.length>0;){var wa=E.shift();for(C=ka;C--;)if(o[C].id===wa){o.splice(C,1);break}ka=o.length}for(C=ka;C--;){wa=aa-o[C].lastTick;if(o[C].lastTick===0||wa>=o[C].frequency){o[C].execute(aa,o[C]);o[C].lastTick=aa;o[C].single&&o[C].trigger("complete")}}G=
ka?animFrame(J):0}var G=0,p=0,o=[],E=[];return{join:function(C){var aa=new Y(C);if(aa.after>0)aa.lastTick=(new Date).getTime()+aa.after;COG.observable(aa);aa.bind("complete",function(){la(aa.id)});o.unshift(aa);G||(G=animFrame(J));recalcSleepFrequency=true;return aa},leave:la}}();
(function(){function Y(J,G){var p=J.obsHandlers;p[G]||(p[G]=[]);return p[G]}var la=0;COG.observable=function(J){if(!J)return null;if(!J.obsHandlers)J.obsHandlers={};if(!(J.bind||J.trigger||J.unbind)){J.bind=function(G,p){var o="callback"+la++;Y(J,G).unshift({fn:p,id:o});return o};J.trigger=function(G){var p=Y(J,G),o={cancel:false,name:G},E;if(!p)return null;E=Array.prototype.slice.call(arguments,1);J.eventInterceptor&&J.eventInterceptor(G,o,E);E.unshift(o);for(var C=p.length;C--&&!o.cancel;)p[C].fn.apply(self,
E);return o};J.unbind=function(G,p){if(typeof G==="undefined")J.obsHandlers={};else for(var o=Y(J,G),E=0;o&&E<o.length;E++)if(o[E].id===p){o.splice(E,1);break}return J}}return J}})();
(function(){function Y(p,o){p[o]||(p[o]=function(E){return p.configure(o,E)})}function la(p){p.gtConfId="configurable"+G++;p.gtConfig={};p.gtConfigFns=[];return p.gtConfig}var J={},G=0;COG.paramTweaker=function(p,o,E){return function(C,aa){if(typeof aa!=="undefined"){if(C in p)p[C]=aa;E&&C in E&&E[C](C,aa)}else return o&&C in o?o[C](C):p[C]}};COG.configurable=function(p,o,E,C){if(p){p.gtConfId||la(p);var aa=p.gtConfId,ka=p.gtConfig,wa=p.gtConfigFns;J[aa]=p;wa.push(E);for(E=o.length;E--;){ka[o[E]]=
true;C&&Y(p,o[E])}if(!p.configure)p.configure=function(Ea,K){if(ka[Ea]){for(var H=wa.length;H--;){var I=wa[H](Ea,K);if(typeof I!=="undefined")return I}return J[aa]}return null}}}})();
(function(){function Y(p){var o=document.createElement("script"),E=false;o.src=p;o.async=true;o.onload=o.onreadystatechange=function(){if(!E&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){E=true;o.onload=o.onreadystatechange=null;o&&o.parentNode&&o.parentNode.removeChild(o)}};J||(J=document.getElementsByTagName("head")[0]);J.appendChild(o)}var la=0,J,G=this;COG.jsonp=function(p,o,E){p+=p.indexOf("?")>=0?"&":"?";var C="json"+ ++la;G[C]=function(aa){o(aa);G[C]=null;try{delete G[C]}catch(ka){}};
Y(p+(E?E:"callback")+"="+C);return C}})();
(function(){function Y(f){if(Ea)return ka.length;Ea=true;try{for(var t=0;t<ka.length;)if(ka[t].isComplete()){ka[t].triggerComplete(false);ka.splice(t,1)}else{ka[t].update(f);t++}}finally{Ea=false}ka.length===0&&wa.trigger("complete");return ka.length}function la(){if(!wa){wa=COG.Loopage.join({execute:Y,frequency:20});wa.bind("complete",function(){wa=null})}}var J=1.70158,G=Math.PI/2,p=Math.abs,o=Math.pow,E=Math.sin,C=Math.asin,aa=Math.cos,ka=[],wa=null,Ea=false,K={linear:function(f,t,v,z){return v*
f/z+t},backin:function(f,t,v,z){return v*(f/=z)*f*((J+1)*f-J)+t},backout:function(f,t,v,z){return v*((f=f/z-1)*f*((J+1)*f+J)+1)+t},backinout:function(f,t,v,z){return(f/=z/2)<1?v/2*f*f*(((J*=1.525)+1)*f-J)+t:v/2*((f-=2)*f*(((J*=1.525)+1)*f+J)+2)+t},bouncein:function(f,t,v,z){return v-K.bounceout(z-f,0,v,z)+t},bounceout:function(f,t,v,z){return(f/=z)<1/2.75?v*7.5625*f*f+t:f<2/2.75?v*(7.5625*(f-=1.5/2.75)*f+0.75)+t:f<2.5/2.75?v*(7.5625*(f-=2.25/2.75)*f+0.9375)+t:v*(7.5625*(f-=2.625/2.75)*f+0.984375)+
t},bounceinout:function(f,t,v,z){return f<z/2?K.bouncein(f*2,0,v,z)/2+t:K.bounceout(f*2-z,0,v,z)/2+v/2+t},cubicin:function(f,t,v,z){return v*(f/=z)*f*f+t},cubicout:function(f,t,v,z){return v*((f=f/z-1)*f*f+1)+t},cubicinout:function(f,t,v,z){if((f/=z/2)<1)return v/2*f*f*f+t;return v/2*((f-=2)*f*f+2)+t},elasticin:function(f,t,v,z,P,Q){if(f==0)return t;if((f/=z)==1)return t+v;Q||(Q=z*0.3);if(!P||P<p(v)){P=v;v=Q/4}else v=Q/TWO_PI*C(v/P);return-(P*o(2,10*(f-=1))*E((f*z-v)*TWO_PI/Q))+t},elasticout:function(f,
t,v,z,P,Q){var ba;if(f==0)return t;if((f/=z)==1)return t+v;Q||(Q=z*0.3);if(!P||P<p(v)){P=v;ba=Q/4}else ba=Q/TWO_PI*C(v/P);return P*o(2,-10*f)*E((f*z-ba)*TWO_PI/Q)+v+t},elasticinout:function(f,t,v,z,P,Q){var ba;if(f==0)return t;if((f/=z/2)==2)return t+v;Q||(Q=z*0.3*1.5);if(!P||P<p(v)){P=v;ba=Q/4}else ba=Q/TWO_PI*C(v/P);if(f<1)return-0.5*P*o(2,10*(f-=1))*E((f*z-ba)*TWO_PI/Q)+t;return P*o(2,-10*(f-=1))*E((f*z-ba)*TWO_PI/Q)*0.5+v+t},quadin:function(f,t,v,z){return v*(f/=z)*f+t},quadout:function(f,t,v,
z){return-v*(f/=z)*(f-2)+t},quadinout:function(f,t,v,z){if((f/=z/2)<1)return v/2*f*f+t;return-v/2*(--f*(f-2)-1)+t},sinein:function(f,t,v,z){return-v*aa(f/z*G)+v+t},sineout:function(f,t,v,z){return v*E(f/z*G)+t},sineinout:function(f,t,v,z){return-v/2*(aa(Math.PI*f/z)-1)+t}},H=COG.Tween=function(f){f=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:I("sine.out"),complete:null},f);var t=(new Date).getTime(),v=[],z=false,P=0,Q=0,ba={isComplete:function(){return z},
triggerComplete:function($){f.complete&&f.complete($)},update:function($){var pa=f.tweenFn($-t,P,Q,f.duration);if(f.target)f.target[f.property]=pa;for(var ia=v.length;ia--;)v[ia](pa,void 0);if(z=t+f.duration<=$){if(f.target)f.target[f.property]=f.tweenFn(f.duration,P,Q,f.duration);for($=v.length;$--;)v[$](pa,true)}},requestUpdates:function($){v.push($)}};P=f.target&&f.property&&f.target[f.property]?f.target[f.property]:f.startValue;if(typeof f.endValue!=="undefined")Q=f.endValue-P;if(Q==0)z=true;
la();return ba};COG.tweenValue=function(f,t,v,z,P){function Q(pa){var ia=pa-ba,xa=v(ia,f,$,z),Ia=ba+z<=pa;pa=!Ia;if(P){ia=P(xa,Ia,ia);pa=typeof ia!="undefined"?ia&&pa:pa}pa&&animFrame(Q)}var ba=animTime(),$=t-f;animFrame(Q);return{}};COG.tween=function(f,t,v,z,P,Q){f=new H({target:f,property:t,endValue:v,tweenFn:z,duration:Q,complete:P});ka.push(f);return f};COG.endTweens=function(f){if(!Ea){Ea=true;try{for(var t=0;t<ka.length;)if(!f||f(ka[t])){ka[t].triggerComplete(true);ka.splice(t,1)}else t++}finally{Ea=
false}}};COG.getTweens=function(){return[].concat(ka)};var I=COG.easing=function(f){return K[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(f,t){K[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]=t}})();
(function(){var Y=/^P(\d+Y)?(\d+M)?(\d+D)?$/,la=/^(\d+H)?(\d+M)?(\d+S)?$/,J={8601:function(p){p=p.split("T");var o=null;o=null;var E=0,C=0;Y.lastIndex=-1;o=Y.exec(p[0]);E+=o[3]?parseInt(o[3].slice(0,-1),10):0;la.lastIndex=-1;o=la.exec(p[1]);C+=o[1]?parseInt(o[1].slice(0,-1),10)*3600:0;C+=o[2]?parseInt(o[2].slice(0,-1),10)*60:0;C+=o[3]?parseInt(o[3].slice(0,-1),10):0;return new G(E,C)}},G=COG.Duration=function(p,o){return{days:p?p:0,seconds:o?o:0}};COG.addDuration=function(){for(var p=new G,o=arguments.length;o--;){p.days+=
arguments[o].days;p.seconds+=arguments[o].seconds}if(p.seconds>=86400){p.days+=~~(p.seconds/86400);p.seconds%=86400}return p};COG.formatDuration=function(p){var o,E,C="";if(p.days)C=p.days+" days ";if(p.seconds){p=p.seconds;if(p>=3600){o=~~(p/3600);p-=o*3600}if(p>=60){E=Math.round(p/60);p-=E*60}if(o)C=C+o+(o>1?" hrs ":" hr ")+(E?(E>10?E:"0"+E)+" min ":"");else if(E)C=C+E+" min";else if(p>0)C=C+(p>10?p:"0"+p)+" sec"}return C};COG.parseDuration=function(p,o){var E=o?J[o]:null;if(E)return E(p);COG.Log.warn("Could not find duration parser for specified format: "+
o);return new G}})();
INTERACT=function(){function Y(K){return function(H,I,f){(f?f:K?document.body:document).addEventListener(H,I,false)}}function la(K){return function(H,I,f){(f?f:K?document.body:document).removeEventListener(H,I,false)}}function J(K,H,I){(I?I:document).attachEvent("on"+K,H)}function G(K,H,I){(I?I:document).detachEvent("on"+K,H)}function p(K,H){return{x:K?K:0,y:H?H:0,count:1}}function o(K,H){wa.push(COG.extend({handler:null,checks:{},type:K},H))}function E(K){var H=0,I=0;if(K.offsetParent){do{H+=K.offsetLeft;
I+=K.offsetTop;K=K.offsetParent}while(K)}return{x:H,y:I}}function C(K,H){for(var I=K.target?K.target:K.srcElement;I&&I.nodeName&&I.nodeName.toUpperCase()!="CANVAS";)I=I.parentNode;return I&&I===H}function aa(K,H){return{x:K.x-(H?H.x:0),y:K.y-(H?H.y:0)}}function ka(K){if(K.preventDefault){K.preventDefault();K.stopPropagation()}else K.cancelBubble&&K.cancelBubble()}var wa=[],Ea=function(K,H,I){function f($,pa,ia,xa){P[P.length]={ticks:(new Date).getTime(),x:xa.x,y:xa.y};v.trigger("pan",xa.x,xa.y)}function t(){COG.info("reset "+
P.length+" pan history");P=[]}I=COG.extend({binder:null,unbinder:null,observable:null},I);for(var v=I.observable,z=[],P=[],Q={bind:function(){return v.bind.apply(null,arguments)},pannable:function($){COG.extend({inertia:true},$);v.bind("pointerDown",t);v.bind("pointerMove",f);return Q},unbind:function(){v.unbind();for(var $=0;$<z.length;$++)z[$].unbind();return Q}},ba=0;ba<H.length;ba++)z.push(H[ba](K,v,I));return Q};o("pointer",{handler:function(K,H,I){function f(A){if(C(A,K))if(pa=P(A)){K.style.cursor=
"move";ka(A);Fa=A.pageX?A.pageX:A.screenX;N=A.pageY?A.pageY:A.screenY;ia=p(Fa,N);xa=E(K);H.trigger("pointerDown",ia,aa(ia,xa))}}function t(A){Ia=A.pageX?A.pageX:A.screenX;Ba=A.pageY?A.pageY:A.screenY;if(C(A,K))Q(pa?"pointerMove":"pointerHover")}function v(A){if(pa&&P(A)){pa=false;if(C(A,K)){K.style.cursor="default";Q("pointerUp")}}}function z(A){if(C(A,K)){var ja;A=A||window.event;if(A.detail)ja=A.axis===2?-A.detail*ba:0;else{ja=A.wheelDeltaY?A.wheelDeltaY:A.wheelDelta;if(window.opera)ja=-ja}if(ja!==
0){var ya=p(Ia,Ba);H.trigger("zoom",ya,aa(ya,E(K)),ja/$,"wheel");ka(A);A.returnValue=false}}}function P(A){A=A||window.event;return(A.which||A.button)==1}function Q(A,ja,ya,Ca){ja=typeof ja!="undefined"?ja:Ia;ya=typeof ya!="undefined"?ya:Ba;var Ra=p(ja,ya);H.trigger(A,Ra,aa(Ra,xa),p(ja-Fa,ya-N));if(typeof Ca=="undefined"||Ca){Fa=ja;N=ya}}I=COG.extend({},I);var ba=120,$=ba*8,pa=false,ia,xa,Ia,Ba,Fa,N;I.binder("mousedown",f,false);I.binder("mousemove",t,false);I.binder("mouseup",v,false);I.binder("click",
function(A){if(C(A,K)){A=p(A.pageX?A.pageX:A.screenX,A.pageY?A.pageY:A.screenY);H.trigger("tap",A,aa(A,E(K)))}},false);I.binder("dblclick",function(A){COG.info("captured double click");if(C(A,K)){A=p(A.pageX?A.pageX:A.screenX,A.pageY?A.pageY:A.screenY);COG.info("captured double click + target matched");H.trigger("doubleTap",A,aa(A,E(K)))}},false);I.binder("mousewheel",z,document);I.binder("DOMMouseScroll",z,document);return{unbind:function(){I.unbinder("mousedown",f,false);I.unbinder("mousemove",
t,false);I.unbinder("mouseup",v,false);I.unbinder("mousewheel",z,document);I.unbinder("DOMMouseScroll",z,document)}}},checks:{touch:false}});o("pointer",{handler:function(K,H,I){function f(U){if(U.count<2)return 0;var ea=U.x-U.next.x;U=U.y-U.next.y;return~~Math.sqrt(ea*ea+U*U)}function t(U,ea,fa){ea=ea?ea:0;fa=fa?fa:0;for(var Ka={x:U.x-ea,y:U.y-fa,id:U.id,count:U.count},Ga=Ka;U.next;){U=U.next;Ga=Ga.next={x:U.x-ea,y:U.y-fa,id:U.id}}return Ka}function v(U,ea){var fa=U[ea?ea:"touches"],Ka,Ga;if(fa.length===
0)return null;Ga=Ka={x:fa[0].pageX,y:fa[0].pageY,id:fa[0].identifier,count:fa.length};for(var Oa=1,Ya=fa.length;Oa<Ya;Oa++)Ga=Ga.next={x:fa[Oa].pageX,y:fa[Oa].pageY,id:fa[Oa].identifier};return Ka}function z(U){if(C(U,K)){Ba=E(K);var ea=v(U,"changedTouches"),fa=t(ea,Ba.x,Ba.y);if(!N){Fa=ia;H.trigger("pointerDown",ea,fa)}Ca&&H.trigger("pointerDownMulti",ea,fa);N=v(U);if(N.count>1)ja=f(N);Ra=1;ya=t(N)}}function P(U){if(C(U,K)){U.preventDefault();A=v(U);if(Fa==ia)Fa=Math.abs(N.x-A.x)>$||Math.abs(N.y-
A.y)>$?pa:ia;if(Fa!=ia){Fa=A.count>1?Ia:xa;if(Fa==Ia)if(N.count===1){N=t(A);ja=f(N)}else{U=f(A);if(Math.abs(ja-U)<ba)Fa=xa;else{var ea;ea=A.x;var fa=A.next.x,Ka=A.y,Ga=A.next.y,Oa=Ka<Ga?Ka:Ga;ea={x:(ea<fa?ea:fa)+(Math.abs(ea-fa)>>1),y:Oa+(Math.abs(Ka-Ga)>>1)};U=U/ja;fa=U-Ra;H.trigger("zoom",ea,aa(ea,Ba),fa,"pinch");Ra=U}}Fa==xa&&H.trigger("pointerMove",A,t(A,Ba.x,Ba.y),p(A.x-ya.x,A.y-ya.y));Ca&&H.trigger("pointerMoveMulti",A,t(A,Ba.x,Ba.y))}ya=t(A)}}function Q(U){if(C(U,K)){var ea=v(U,"changedTouches"),
fa=t(ea,Ba.x,Ba.y);A=v(U);if(!A){Fa===ia&&H.trigger("pointerTap",ea,fa);H.trigger("pointerUp",ea,fa);N=null}Ca&&H.trigger("pointerUpMulti",ea,fa)}}I=COG.extend({detailed:false,inertia:false},I);var ba=20,$=7,pa=0,ia=1,xa=2,Ia=3,Ba,Fa,N,A,ja,ya,Ca=I.detailed,Ra=1;I.binder("touchstart",z,false);I.binder("touchmove",P,false);I.binder("touchend",Q,false);COG.info("initialized touch handler");return{unbind:function(){I.unbinder("touchstart",z,false);I.unbinder("touchmove",P,false);I.unbinder("touchend",
Q,false)}}},checks:{touch:true}});return{register:o,watch:function(K,H,I){H=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},H);capabilities=COG.extend({touch:"ontouchstart"in window},I);if(!H.observable){COG.info("creating observable");H.observable=COG.observable({});globalOpts=H}H.binder=H.isIE?J:Y(H.bindToBody);H.unbinder=H.isIE?G:la(H.bindToBody);I=H.types;for(var f=capabilities,t=[],v=wa.length;v--;){var z=wa[v],P=!I||I.indexOf(z.type)>=0,Q=
true;for(var ba in z.checks){var $=z.checks[ba];COG.info("checking "+ba+" capability. require: "+$+", capability = "+f[ba]);Q=Q&&$===f[ba]}if(P&&Q)t[t.length]=z.handler}return new Ea(K,t,H)}}}();
T5=function(){function Y(){return(new Date).getTime()}function la(){for(;fa.length>0;){var c=fa.shift();document.location=c}ea=0}function J(c){for(var s=true,g=Ka.length;g--;)s=s&&c!=Ka[g];return s}function G(c,s){var g=[];for(var b in s)b&&g.push(b+"="+escape(s[b]));return"tile5://"+c+"/"+(g.length>0?"?"+g.join("&"):"")}function p(c,s){J(c)&&COG.info("would push url: "+G(c,s))}function o(c,s){if(J(c)){fa.push(G(c,s));ea||(ea=setTimeout(la,100))}}function E(c){return function(s,g,b){(b?b:c?document.body:
document).addEventListener(s,g,false)}}function C(c){return function(s,g,b){(b?b:c?document.body:document).removeEventListener(s,g,false)}}function aa(c,s,g){(g?g:document).attachEvent("on"+c,s)}function ka(c,s,g){(g?g:document).detachEvent("on"+c,s)}function wa(){Ca={base:{name:"Unknown",bindEvent:E(),unbindEvent:C(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:p,targetFps:null},ie:{name:"MSIE",
regex:/msie/i,bindEvent:aa,unbindEvent:ka,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:o,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:o},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:o},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:E(true),unbindEvent:C(true),supportsTouch:true,getScaling:function(){return 1/
window.devicePixelRatio},bridgeNotify:o},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:o}};Ra=[Ca.froyo,Ca.android,Ca.ipod,Ca.iphone,Ca.ipad,Ca.ie]}function Ea(){Ca||wa();if(!U){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<Ra.length;c++){var s=Ra[c];if(s.regex&&s.regex.test(navigator.userAgent)){U=COG.extend({},Ca.base,s);COG.info("PLATFORM DETECTED AS: "+U.name);break}}if(!U){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
U=Ca.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return U}function K(c,s){function g(k,q){k=k?P(z(k,n),d):d;if(k!=b){b=k;c.triggerAll("zoomLevelChange",k,q)}}s=COG.extend({initial:1,minZoom:1,maxZoom:16},s);var b=null,d=s.minZoom,n=s.maxZoom;COG.extend(c,{getZoomLevel:function(){return b},setZoomLevel:g});c.bind("scale",function(k,q,u){k=Math.log(q)/Math.LN2;COG.endTweens(function(r){return r.cancelOnInteract});g(b+k,u);c.updateOffset(u.x*q,u.y*q)})}function H(){for(var c=
0,s=arguments.length;s--;){var g=zb[arguments[s].toUpperCase()];if(g)c|=g}return c}var I=Math.PI*2,f=Math.PI/2,t=Math.abs,v=Math.ceil,z=Math.min,P=Math.max,Q=Math.pow,ba=Math.sqrt,$=Math.log,pa=Math.round,ia=Math.sin,xa=Math.asin,Ia=Math.cos,Ba=Math.atan,Fa=Math.atan2,N=function(){function c(b,d){return g(b.x-d.x,b.y-d.y)}function s(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var n={edges:Array(d-1),accrued:Array(d-1),total:0},
k=0;k<d-1;k++){var q=c(b[k],b[k+1]);n.edges[k]=ba(q.x*q.x+q.y*q.y);n.accrued[k]=n.total+n.edges[k];n.total+=n.edges[k]}return n}function g(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,n=arguments.length;n--;){b+=arguments[n].x;d+=arguments[n].y}return g(b,d)},absSize:function(b){return P(t(b.x),t(b.y))},copy:function(b){return b?g(b.x,b.y):null},diff:c,distance:function(b,d){return s(b,d).total},edges:s,equals:function(b,
d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,n){var k=Ia(d)*n;d=ia(d)*n;return g(b.x-k,b.y-d)},floor:function(b){for(var d=Array(b.length),n=b.length;n--;)d[n]=g(~~b[n].x,~~b[n].y);return d},getRect:function(b){for(var d,n,k,q,u=b.length;u--;){var r=b[u];d=typeof d==="undefined"||r.x<d?r.x:d;n=typeof n==="undefined"||r.y<n?r.y:n;k=typeof k==="undefined"||r.x>k?r.x:k;q=typeof q==="undefined"||r.y>q?r.y:q}return ja.init(d,n,k,q)},init:g,invert:function(b){return g(-b.x,-b.y)},min:function(b,
d){return g(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return g(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,n){return g(b.x+d,b.y+(n?n:d))},simplify:function(b,d){if(!b)return null;d=d?d:N.VECTOR_SIMPLIFICATION;for(var n=[],k=null,q=b.length;q--;){var u=b[q];if(include=!k||q===0||t(u.x-k.x)+t(u.y-k.y)>d){n.unshift(u);k=u}}return n},theta:function(b,d,n){n=xa((b.y-d.y)/n);return b.x>d.x?n:Math.PI-n},toString:function(b){return b.x+", "+b.y}}}(),A=function(){return{dotProduct:function(c,
s){return c.x*s.x+c.y*s.y}}}(),ja=function(){function c(g){return s(g.x1,g.y1,g.x2,g.y2)}function s(g,b,d,n){g=g?g:0;b=b?b:0;d=typeof d!=="undefined"?d:g;n=typeof n!=="undefined "?n:n;return{x1:g,y1:b,x2:d,y2:n,width:d-g,height:n-b}}return{center:function(g){return N.init(g.x1+g.width/2,g.y1+g.height/2)},copy:c,diagonalSize:function(g){return ba(g.width*g.width+g.height*g.height)},fromCenter:function(g,b,d,n){d=d>>1;n=n>>1;return s(g-d,b-n,g+d,b+n)},init:s,intersect:function(g,b){var d=P(g.x1,b.x1),
n=P(g.y1,b.y1),k=z(g.x2,b.x2),q=z(g.y2,b.y2);d=s(d,n,k,q);return d.width>0&&d.height>0?d:null},toString:function(g){return"["+g.x1+", "+g.y1+", "+g.x2+", "+g.y2+"]"},union:function(g,b){if(g.width===0||g.height===0)return c(b);else if(b.width===0||b.height===0)return c(g);else{var d=z(g.x1,b.x1),n=z(g.y1,b.y1),k=P(g.x2,b.x2),q=P(g.y2,b.y2);d=s(d,n,k,q);return d.width>0&&d.height>0?d:null}}}}(),ya=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return N.init(c.width>>
1,c.height>>1)},getSize:function(c){return ba(Q(c.width,2)+Q(c.height,2))},init:function(c,s){c=c?c:0;return{width:c,height:s?s:c}}}}(),Ca=null,Ra=[],U=null,ea=0,fa=[],Ka=["view.wake","tile.loaded"],Ga=function(){function c(){var j=Ea().maxImageLoads;if(!j||u.length<j)if(j=q.shift()){u[u.length]=j;j.image.onload=s;j.image.src=j.url;j.requested=T5.ticks()}}function s(){var j=n[this.id],w;if(j&&j.image.complete&&j.image.width>0){j.loaded=true;j.hitCount=1;for(w=u.length;w--;)if(u[w].image.src==this.src){u.splice(w,
1);break}if(j.background||j.postProcess||j.drawBackground||j.customDraw)if(j.image){globalImageData=j;w=b(j.realSize?j.realSize.width:j.image.width,j.realSize?j.realSize.height:j.image.height);var T=w.getContext("2d"),W=j.offset?j.offset:T5.XY.init();j.background&&T.drawImage(j.background,0,0);j.drawBackground&&j.drawBackground(T);j.customDraw?j.customDraw(T,j):T.drawImage(j.image,W.x,W.y);j.postProcess&&j.postProcess(T,j);j.image=w}for(w=j.callbacks.length;w--;)j.callbacks[w]&&j.callbacks[w](this,
false);j.callbacks=[];r[r.length]={url:this.src,created:j.requested};delete n[this.id];c()}}function g(j,w,T){var W=d[j];if(W){W.hitCount++;W.image.complete&&W.image.width>0&&w?w(W.image,true):W.callbacks.push(w)}else{W=COG.extend({url:j,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[w]},T);W.image.id="resourceLoaderImage"+k++;d[j]=W;n[W.image.id]=W;q[q.length]=W;c()}return W}function b(j,w){var T=document.createElement("canvas");COG.info("creating new canvas");
T.width=j?j:0;T.height=w?w:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(T);FlashCanvas.initElement(T)}return T}var d={},n={},k=0,q=[],u=[],r=[],y={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var j;for(j=u.length;j--;)delete d[u[j].url];u=[];for(j=q.length;j--;)delete d[q[j].url];q=[]},get:function(j,w,T){var W=null;W=null;if((W=(W=d[j])?W.image:null)&&(W.getContext||W.complete&&W.width>0))return W;else w&&g(j,w,T);return null},load:g,newCanvas:b,reset:function(){d={}},
stats:function(){return{imageLoadingCount:u.length,queuedImageCount:q.length,imageCacheFullness:0}}};COG.observable(y);return y}(),Oa=function(){var c={};return{init:function(s,g){var b=c[s];if(!b)throw Error("Unable to locate requested generator: "+s);return new b(g)},register:function(s,g){c[s]=g},Template:function(){}}}(),Ya=function(){function c(k,q){d[k]=g(q);return k}function s(k){for(var q in k)c(q,k[q])}function g(k){function q(j){var w=k[j];typeof w!=="undefined"&&r.push(function(T){T[j]=
w})}function u(){r=[];for(var j in k)q(j)}k=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},k);var r=[],y={applyToContext:function(j){for(var w=r.length;w--;)r[w](j)},update:function(j,w){k[j]=w;u()}};u();return y}var b={},d={},n={apply:function(k,q){var u=d[q]?d[q]:d.basic,r;if(k&&k.canvas){r=b[k.canvas.id];b[k.canvas.id]=q}u.applyToContext(k);return r},define:c,
defineMany:s,get:function(k){return d[k]},init:g,load:function(k){COG.jsonp(k,function(q){s(q)})}};s({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return n}(),zb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},vb=function(c){function s(F,D,R,Z){La=hb;y(qa-D,ta-R,Z?c.panAnimationEasing:null,Z?c.panAnimationDuration:null);clearTimeout(ga);ga=setTimeout(g,100)}function g(){La=lb;va()}function b(F,D,R,Z){Wa(z(P(M+
Q(2,Z)-1,0.5),2))}function d(){var F=$(M)/Math.LN2>>0;if(F!==0){M=Q(2,F);F=N.init(ib-(x/M>>0),jb-(a/M>>0));if(!Da.trigger("scale",M,F).cancel){for(var D=S.length;D--;)S[D].trigger("scale",M,F);M=1;La=lb}}va()}function n(F){F||(F=N.init(x,a));h=N.init(qa,ta);i=N.offset(F,qa,ta);ib=i.x;jb=i.y}function k(F,D){var R,Z;Z=1/M;if(M!==1&&e){R=e.x1+F*Z;Z=e.y1+D*Z}else{R=F+qa;Z=D+ta}return N.init(R,Z)}function q(F,D,R){Za("doubleTap",D,R,k(R.x,R.y));if(c.scalable){COG.endTweens(function(Z){return Z.cancelOnInteract});
Wa(2,R,c.zoomAnimation,null,c.zoomDuration)}}function u(){clearTimeout(X);X=setTimeout(j,250)}function r(F,D,R){Za("tap",D,R,k(R.x,R.y))}function y(F,D,R,Z,ma){function Ma(){$a+=1;if($a>=2){g();ma&&ma()}}var $a=0,Sa=ra?N.offset(ra,-x,-a):null,ab=sa?N.offset(sa,-x,-a):null;if(Sa){F=F<Sa.x?Sa.x:F;D=D<Sa.y?Sa.y:D}if(ab){F=F>ab.x?ab.x:F;D=D>ab.y?ab.y:D}if(R){if((La&hb)===0){COG.tweenValue(qa,F,R,Z,function(cb,mb){qa=cb|0;(mb?Ma:va)();return!B});COG.tweenValue(ta,D,R,Z,function(cb,mb){ta=cb|0;(mb?Ma:va)();
return!B});La=hb|nb}}else{qa=F|0;ta=D|0;va();ma&&ma()}}function j(F,D){var R;if(za){Ha&&Ha.unbind();if(c.autoSize&&za.parentNode){F=za.parentNode.offsetWidth;D=za.parentNode.offsetHeight}try{if(!za.id)za.id=c.id+"_canvas";ca=za.getContext("2d")}catch(Z){COG.exception(Z);throw Error("Could not initialise canvas on specified view element");}if(F&&D&&(oa!==D||Ja!==F)){na=true;Ja=F;oa=D;x=Ja>>1;a=oa>>1;Da.trigger("resize",Ja,oa);for(R=Aa;R--;)S[R].trigger("resize",Ja,oa)}if(c.interactive){Ha=INTERACT.watch(za).pannable();
T()}for(R=Aa;R--;)S[R].trigger("contextChanged",ca);va()}}function w(F,D){D.setId(F);D.added=Y();D.bind("remove",function(){Da.removeLayer(F)});D.trigger("contextChanged",ca);D.setParent(Da);S.push(D);S.sort(function(R,Z){var ma=Z.zindex-R.zindex;if(ma===0)ma=Z.added-R.added;return ma});Aa=S.length;return D}function T(){if(Ha){if(c.pannable){Ha.bind("pan",s);Ha.bind("inertiaCancel",function(){va()})}if(c.scalable){Ha.bind("zoom",b);Ha.bind("doubleTap",q)}Ha.bind("tap",r)}}function W(){var F=bb?qa+
x:qa,D=Ta?ta+a:ta;if(Pa&&Pa>Ja)if(F+Ja>Pa)qa=bb?F-Pa>0?qa-Pa:qa:Pa-Ja;else if(F<0)qa=bb?qa+Pa:0;if(Qa&&Qa>oa)if(D+oa>Qa)ta=Ta?D-Qa>0?ta-Qa:ta:Qa-oa;else if(D<0)ta=Ta?ta+Qa:0}function ua(F,D,R,Z){var ma;ja.center(D);var Ma=0;e=ja.copy(D);e.scaleFactor=M;R||ca.clearRect(0,0,Ja,oa);ca.save();try{ca.globalCompositeOperation="source-over";if(M!==1){var $a=e,Sa=1/M;ib=i.x+(qa-h.x);jb=i.y+(ta-h.y);e=$a?ja.fromCenter(ib>>0,jb>>0,$a.width*Sa>>0,$a.height*Sa>>0):void 0;ca.scale(M,M)}ca.translate(-e.x1,-e.y1);
sa=ra=null;if(R){ca.beginPath();for(Ma=Aa;Ma--;)S[Ma].clip&&S[Ma].clip(ca,e,F,Da,Z);ca.closePath();ca.clip()}for(Ma=Aa;Ma--;){ma=S[Ma];var ab=ma.style,cb=ab?Ya.apply(ca,ab):null;if(ma.minXY)ra=ra?N.min(ra,ma.minXY):N.copy(ma.minXY);if(ma.maxXY)sa=sa?N.max(sa,ma.maxXY):N.copy(ma.maxXY);ma.draw(ca,e,F,Da,Z);cb&&Ya.apply(ca,cb)}}finally{ca.restore()}if(m){ca.globalCompositeOperation="source-over";ca.strokeStyle="#f00";ca.beginPath();ca.moveTo(x,0);ca.lineTo(x,oa);ca.moveTo(0,a);ca.lineTo(Ja,a);ca.stroke()}ob=
0;Za("drawComplete",D,Z)}function Ua(F){var D,R=false;if(ob){if(F-ha>Ab){if(M!==1)La|=ub;B=(D=(La&(ub|hb))!==0)&&(La&nb)===0;if(na&&za){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(za);za.width=Ja;za.height=oa;za.style.width=Ja+"px";za.style.height=oa+"px";na=false}if(Pa||Qa)W();db=eb();if(B){COG.endTweens(function(ma){return ma.cancelOnInteract});L=false;if(da!==0){clearTimeout(da);da=0}}for(var Z=Aa;Z--;){if(S[Z].animated)La|=nb;S[Z].cycle(F,db,La);S[Z].shouldDraw(La,db);R=S[Z].clip||
R}ua(La,db,pb&&R&&!D,F);F-V>qb&&kb();ha=F}COG.animFrame(Ua)}else gb=false}function va(){ob+=1;if(!gb){gb=true;COG.animFrame(Ua)}}function eb(){return ja.init(qa,ta,qa+Ja,ta+oa)}function kb(){V=(new Date).getTime();Za("refresh",Da,eb());va()}function Wa(F,D,R,Z,ma){if(R)COG.tweenValue(M,F,R,ma,function(Ma,$a){M=Ma;if($a){var Sa=pa($(M)/Math.LN2);M=Q(2,Sa);Z&&Z()}n(D);d()});else{M=F;n(D);d()}return Da}function Za(){for(var F=Da.trigger.apply(null,arguments).cancel,D=S.length;D--;)F=S[D].trigger.apply(null,
arguments).cancel||F;return!F}c=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,idleDelay:100,minRefresh:1E3,pannable:true,clipping:true,scalable:true,interactive:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25,zoomAnimation:COG.easing("quad.out"),zoomDuration:300},c);var S=[],Aa=0,za=document.getElementById(c.container),ca=null,Xa=typeof window.attachEvent!=
"undefined",qb=c.minRefresh,qa=0,ta=0,Pa=null,Qa=null,bb=false,Ta=false,pb=c.clipping,db=null,gb=false,e,m=c.guides,l=1,x=0,a=0,h=null,i=null,B=false,L=false,da=0,ga=0,ra=null,sa=null,V=0,O=0,X=0,M=1,ha=0,na=false,Ha=null,oa,Ja,Ab=1E3/c.fps|0,ob=0,ib,jb,lb=H("ACTIVE"),hb=H("PAN"),ub=H("ZOOM"),nb=H("ANIMATING"),La=lb,Da={id:c.id,deviceScaling:l,fastDraw:c.fastDraw||Ea().requireFastDraw,getDimensions:function(){return ya.init(Ja,oa)},getLayer:function(F){for(var D=0;D<Aa;D++)if(S[D].getId()==F)return S[D];
return null},setLayer:function(F,D){for(var R=0;R<Aa;R++)if(S[R].getId()===F){S.splice(R,1);break}if(D){w(F,D);D.trigger("refresh",Da,eb())}va();return D},eachLayer:function(F){for(var D=Aa;D--;)F(S[D])},invalidate:va,refresh:kb,resetScale:function(){M=1},resize:function(F,D){if(za){c.autoSize=false;if(Ja!==F||oa!==D)j(F,D)}},scale:Wa,triggerAll:Za,removeLayer:function(F){a:{for(var D=Aa;D--;)if(S[D].getId()==F){F=D;break a}F=-1}if(F>=0&&F<Aa){Da.trigger("layerRemoved",S[F]);S.splice(F,1);va()}Aa=
S.length},getOffset:function(){return N.init(qa,ta)},setMaxOffset:function(F,D,R,Z){Pa=F;Qa=D;bb=typeof R!="undefined"?R:false;Ta=typeof Z!="undefined"?Z:false},getViewRect:eb,updateOffset:y,pan:function(F,D,R,Z,ma){y(qa+F,ta+D,R,Z,ma)}};l=Ea().getScaling();Da.markers=w("markers",new rb);COG.observable(Da);Da.bind("invalidate",function(){va()});Da.bind("resync",function(){sa=ra=null});COG.configurable(Da,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(c,null,
{container:function(F,D){za=document.getElementById(D);j()},rotation:function(F,D){O=D}}),true);j();if(c.autoSize)Xa?window.attachEvent("onresize",u):window.addEventListener("resize",u,false);return Da},fb=function(c){c=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:H("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var s=null,g=false,b=false,d=c.supportFastDraw,n=c.id,k=H("ACTIVE"),q=c.validStates,u=0,r=0,y=COG.extend({addToView:function(j){j.setLayer(n,
y)},shouldDraw:function(j,w){return(b||u!==w.x1||r!==w.y1)&&(j&q)!==0&&(g?d:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){y.trigger("remove",y)},changed:function(){b=true;y.trigger("changed",y);s&&s.invalidate()},getId:function(){return n},setId:function(j){n=j},getParent:function(){return s},setParent:function(j){g=(s=j)?s.fastDraw&&displayState!==k:false;y.trigger("parentChange",s)}},c);COG.observable(y);y.bind("drawComplete",function(j,w){b=false;u=w.x1;r=w.y1});y.bind("resync",
function(j,w){if(w.syncXY){y.minXY&&w.syncXY(y.minXY);y.maxXY&&w.syncXY(y.maxXY)}});return y},sb=function(c){function s(u,r,y,j){b=u;d=r;n=y;k=j}c=COG.extend({xy:N.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var g=false,b=0,d=0,n=0,k=0,q=COG.extend(c,{isAnimating:function(){return g},draw:function(u,r,y,j,w){if(q.isNew&&c.tweenIn)COG.tweenValue(r.y1-20,q.xy.y,c.tweenIn,c.animationSpeed?c.animationSpeed:250+Math.random()*500,function(T,W){q.xy.y=T|0;g=!W;w.invalidate()});q.drawMarker(u,
r,q.xy.x,q.xy.y,y,j,w);q.isNew=false},drawMarker:function(u,r,y,j){u.beginPath();u.arc(y,j,4,0,Math.PI*2,false);u.fill();s(y-4,j-4,8,8)},hitTest:function(u,r){return u>=b&&u<=b+n&&r>=d&&r<=d+k},updateBounds:s});COG.observable(q);return q},rb=function(c){function s(){d.changed(true);d.trigger("markerUpdate",b)}function g(){var n=d.getParent();if(n&&n.syncXY)for(var k=b.length;k--;)n.syncXY([b[k].xy])}c=COG.extend({zindex:100,style:"basic"},c);var b=[],d=COG.extend(new fb(c),{draw:function(n,k,q,u){for(var r=
b.length;r--;)b[r].draw(n,k,q,d,u)},add:function(n){if(n&&typeof n.length!=="undefined")for(var k=n.length;k--;){if(n[k])b[b.length]=n[k]}else if(n)b[b.length]=n;s()},clear:function(n){if(n)for(var k=0;k<b.length;)if(n(b[k]))b.splice(k,1);else k+=1;else b=[];s()},each:function(n){if(n)for(var k=b.length;k--;)n(b[k])},find:function(n){for(var k=[],q=b.length;q--;)if(!n||n(b[q]))k[k.length]=b[q];return k}});d.bind("tap",function(n,k,q,u){var r=[],y=u.x;u=u.y;for(var j=b.length;j--;)if(b[j].hitTest(y,
u))r[r.length]=b[j];if(r.length>0)n.cancel=d.trigger("markerTap",k,q,r).cancel});d.bind("parentChange",g);d.bind("resync",g);d.bind("changed",g);return d},wb=function(c){function s(q,u,r){q.fillStyle="#FFFFFF";q.strokeStyle="#222222";q.beginPath();q.arc(r.x,r.y,4,0,Math.PI*2,false);q.stroke();q.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:H("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},c);var g=N.edges(c.path),b,d=null,n=0;COG.tweenValue(0,
g.total,c.easing,function(){k.remove()},c.duration).requestUpdates(function(q,u){n=q;u&&k.remove()});var k=COG.extend(new fb(c),{cycle:function(){for(var q=0;q<g.accrued.length&&g.accrued[q]<n;)q++;d=null;if(q<c.path.length-1){var u=n-(q>0?g.accrued[q-1]:0),r=c.path[q];b=N.theta(r,c.path[q+1],g.edges[q]);d=N.extendBy(r,b,u)}return d},draw:function(q,u){if(d)(c.drawIndicator?c.drawIndicator:s)(q,u,N.init(d.x,d.y),b)}});return k},xb=function(c){c=COG.extend({style:null,properties:{}},c);return COG.extend(c,
{rect:null,draw:function(){},resync:function(){}})},tb=function(c,s){s=COG.extend({fill:false,simplify:false},s);var g=false,b=s.fill,d=s.simplify,n=H("ZOOM"),k=[],q=COG.extend(new xb(s),{draw:function(u,r,y,j,w,T){if(g){r=true;y=(T&n)!==0;u.beginPath();for(T=k.length;T--;){y=k[T].x;j=k[T].y;if(r){u.moveTo(y,j);r=false}else u.lineTo(y,j);y=true}if(y){b&&u.fill();u.stroke()}}},resync:function(u){q.xy=u.syncXY(c);k=N.floor(d?N.simplify(c):c)}});g=c&&c.length>=2;return q},yb=function(c){function s(n){for(var k=
b.length;k--;)b[k].resync(n);b.sort(function(q,u){var r=u.xy.y-q.xy.y;if(r===0)r=u.xy.x-q.xy.y;return r});d.changed()}function g(n,k){k.syncXY&&s(k)}c=COG.extend({zindex:80},c);var b=[],d=COG.extend(new fb(c),{add:function(n){b[b.length]=n},each:function(n){for(var k=b.length;k--;)n(b[k])},draw:function(n,k,q){var u=k.x1,r=k.y1,y=k.width;k=k.height;for(var j=b.length;j--;){var w=b[j].style;w=w?Ya.apply(n,w):null;b[j].draw(n,u,r,y,k,q);w&&Ya.apply(n,w)}}});d.bind("parentChange",g);d.bind("resync",
g);return d},Bb=function(){return{tileSize:256,init:function(c,s,g,b,d){return COG.extend({x:c,y:s,width:g,height:b},d)}}}(),Va={ex:COG.extend,ticks:Y,getConfig:Ea,userMessage:function(c,s,g){Va.trigger("userMessage",c,s,g)},zoomable:K,XY:N,XYRect:ja,Dimensions:ya,Vector:A,D:ya,Images:Ga,Generator:Oa,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ya,viewState:H,View:vb,ViewLayer:fb,ImageLayer:function(c,s){function g(r,y,j){for(y=k.length;y--;){var w=k[y],T=w.x,
W=w.y,ua=ja.init(w.x,w.y,w.x+w.width,w.y+w.height);if(j&&ja.intersect(r,ua))(ua=Ga.get(w.url,function(){u.changed()},q))&&j(ua,T,W,w.width,w.height)}}function b(r){var y=++n,j=u.getParent();if(d){COG.info("generating: "+ja.toString(r)+", sequence = "+y);d.run(j,r,function(w){if(y==n){k=[].concat(w);u.changed()}})}}s=COG.extend({imageLoadArgs:{}},s);var d=c?Oa.init(c,s):null,n=0,k=[],q=s.imageLoadArgs,u=COG.extend(new fb(s),{changeGenerator:function(r,y){d=Oa.init(r,COG.extend({},s,y));k=null;b(u.getParent().getViewRect())},
clip:function(r,y,j){g(y,j,function(w,T,W,ua,Ua){r.rect(T,W,ua,Ua)})},draw:function(r,y,j){g(y,j,function(w,T,W,ua,Ua){u.drawImage(r,w,T,W,ua,Ua,y,j)})},drawImage:function(r,y,j,w){y&&r.drawImage(y,j,w,y.width,y.height)}});u.bind("refresh",function(r,y,j){b(j)});u.bind("tap",function(r,y,j,w){r=[];var T=w.x,W=w.y,ua,Ua;if(k)for(var va=k.length;va--;){ua=k[va];if(Ua=T>=ua.x&&T<=ua.x+ua.width&&W>=ua.y&&W<=ua.y+ua.height)r[r.length]=ua}r.length>0&&u.trigger("tapImage",r,y,j,w)});return u},ImageGenerator:function(c){c=
COG.extend({relative:false,padding:2},c);c={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(c);return c},Marker:sb,ImageMarker:function(c){c=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},c);var s=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,g=COG.extend(new sb(c),{drawMarker:function(b,d,n,k){if((d=g.isAnimating()&&g.animatingImage?g.animatingImage:g.image)&&d.width>0){s||
(s=N.init(-d.width>>1,-d.height>>1));var q=g.scale,u=n+~~(s.x*q),r=k+~~(s.y*q),y=~~(d.width*q),j=~~(d.height*q);g.updateBounds(u,r,y,y);if(g.rotation||g.opacity!==1){b.save();try{b.globalAlpha=g.opacity;b.translate(n,k);b.rotate(g.rotation);b.drawImage(d,s.x*q,s.y*q,y,j)}finally{b.restore()}}else b.drawImage(d,u,r,y,j)}}});if(!g.image)g.image=Ga.get(c.imageUrl,function(b){g.image=b});if(!g.animatingImage)g.animatingImage=Ga.get(c.animatingImageUrl,function(b){g.animatingImage=b});return g},MarkerLayer:rb,
PathLayer:function(c){function s(){var r=u.getParent();if(r&&r.syncXY){r.syncXY(d);n&&r.syncXY(n);u.trigger("tidy")}}c=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},c);var g=[],b=null,d=[],n=null,k=0,q=[],u=COG.extend(new fb(c),{getAnimation:function(r,y,j,w){var T="pathAnimation"+k++;q.push(T);return new wb({id:T,path:g,zindex:c.zindex+1,easing:r?r:COG.easing("sine.inout"),duration:y?y:5E3,drawIndicator:j,autoCenter:w?w:false})},draw:function(r){var y,j=g.length;r.save();try{Ya.apply(r,
c.style);if(j>0){r.beginPath();r.moveTo(g[j-1].x,g[j-1].y);for(y=j;y--;)r.lineTo(g[y].x,g[y].y);r.stroke();if(b){r.fillStyle=c.waypointFillStyle;for(y=b.length;y--;){r.beginPath();r.arc(b[y].x,b[y].y,2,0,Math.PI*2,false);r.stroke();r.fill()}}}}finally{r.restore()}},updateCoordinates:function(r,y){d=r;n=y;s()}});u.bind("tidy",function(){g=N.simplify(d,c.pixelGeneralization);b=N.simplify(n,c.pixelGeneralization);u.changed(true)});u.bind("resync",s);return u},AnimatedPathLayer:wb,Shape:xb,Arc:function(c,
s){s=COG.extend({size:4},s);var g=N.init(),b=COG.extend(s,{draw:function(d){d.beginPath();d.arc(g.x,g.y,b.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([c]);g=N.floor([c])[0]}});COG.info("created arc = ",c);return b},Poly:tb,ShapeLayer:yb,Tiling:Bb};COG.observable(Va);var Na=Va.Geo=function(){function c(e){for(var m=null,l=1;!m&&l<arguments.length;l++)m=n(e,arguments[l]);m=m?m:n(e);if(!m)throw Error("Unable to find GEO engine with "+e+" capability");return m}function s(e){e=
parseFloat(e)*w;e=ia(e);var m=va*e;return $((1+e)/(1-e)*Q((1-m)/(1+m),va))/2}function g(e){return parseFloat(e)*w}function b(e){e=Q(Math.E,-e);for(var m=f-2*Ba(e),l=k(m,e),x=0;x<kb&&t(m-l)>eb;){m=l;l=k(m,e);x++}return l*T}function d(e){return e%360*T}function n(e,m){var l=null;for(var x in Xa)if(m){if(x==m&&Xa[x][e]){l=Xa[x];break}}else if(Xa[x][e]){l=Xa[x];break}return l}function k(e,m){var l=va*ia(e);return f-2*Ba(m*Q((1-l)/(1+l),va/2))}function q(e,m,l,x){m=r(m);e.add(x.line(m,l));return m.length}
function u(e,m,l,x){m=r(m);e.add(x.poly(m,l));return m.length}function r(e){var m=e?e.length:0,l=Array(m);for(m=m;m--;)l[m]=Na.Position.init(e[m][1],e[m][0]);return Na.Position.vectorize(l,bb)}function y(e,m,l){return new db(e,m,l)}var j=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],w=Math.PI/180,T=180/Math.PI,W=f,ua=-W,Ua=-I,va=0.08181919084262157,eb=1.0E-7,kb=12,Wa=null,Za={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",
MWY:"MOTORWAY"},S=function(){function e(a){return a?l(a.lat,a.lon):null}function m(a){return!a||a.lat===0&&a.lon===0}function l(a,h){return{lat:parseFloat(a?a:0),lon:parseFloat(h?h:0)}}function x(a){if(a)if(typeof a.lat!=="undefined")return e(a);else{if(a.split)for(var h=[" ",","],i=0;i<h.length;i++){var B=a.split(h[i]);if(B.length===2)return l(B[0],B[1])}}else return l();return null}return{calcDistance:function(a,h){if(m(a)||m(h))return 0;var i=(h.lat-a.lat)*w>>1,B=(h.lon-a.lon)*w>>1;i=ia(i)*ia(i)+
Ia(a.lat*w)*Ia(h.lat*w)*ia(B)*ia(B);return 6371*2*Fa(ba(i),ba(1-i))},copy:e,empty:m,equal:function(a,h){return a&&h&&a.lat==h.lat&&a.lon==h.lon},fromMercatorPixels:function(a,h){return l(b(h),d(a))},generalize:function(a,h,i){var B=a.length,L=[],da=null;i||(i=250);i/=1E3;COG.info("generalizing positions, must include "+h.length+" positions");for(var ga=B;ga--;)if(ga===0)L.unshift(a[ga]);else{var ra=!da||S.inArray(a[ga],h)?i:S.calcDistance(da,a[ga]);if(a[ga]&&ra>=i){L.unshift(a[ga]);da=a[ga]}}COG.info("generalized "+
B+" positions into "+L.length+" positions");return L},inArray:function(a,h){for(var i=S.equal,B=h.length;B--;)if(i(a,h[B]))return true;return false},inBounds:function(a,h){var i=!(S.empty(a)||S.empty(h));return i=(i=i&&a.lat>=h.min.lat&&a.lat<=h.max.lat)&&a.lon>=h.min.lon&&a.lon<=h.max.lon},init:l,offset:function(a,h,i){var B=a.lat*w;a=a.lon*w;h=B+h/6371;i=xa(ia(i/6371)/Ia(B));i=a+i;h=(h+f)%Math.PI-f;i%=I;return l(h*T,i*T)},parse:x,parseArray:function(a){var h=a.length,i=Array(h);for(h=h;h--;)i[h]=
x(a[h]);return i},toMercatorPixels:function(a){return T5.XY.init(g(a.lon),s(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,h){function i(){for(var ga=0,ra=h.chunkSize,sa=B;sa--;){L[sa]=T5.GeoXY.init(a[sa]);ga+=1;if(ga>ra)break}B=sa;if(B<=0)h.callback&&h.callback(L);else COG.animFrame(i)}var B=a.length,L=Array(B);h=COG.extend({chunkSize:500,async:true,callback:null},h);if(!h.async){for(var da=B;da--;)L[da]=T5.GeoXY.init(a[da]);return L}COG.animFrame(i);return null}}}(),
Aa=function(){function e(a,h,i){var B=T5.XY.init(0,h.lat-a.lat);if(typeof i==="undefined")i=true;B.x=i&&a.lon>h.lon?360-a.lon+h.lon:h.lon-a.lon;return B}function m(a,h){return Aa.init(S.init(a.min.lat-h,a.min.lon-h%360),S.init(a.max.lat+h,a.max.lon+h%360))}function l(a){var h=e(a.min,a.max);return S.init(a.min.lat+(h.y>>1),a.min.lon+(h.x>>1))}function x(a,h){return{min:S.parse(a),max:S.parse(h)}}return{calcSize:e,createBoundsFromCenter:function(a,h){var i=h/6371,B=a.lat*w,L=a.lon*w,da=B-i,ga=B+i;
if(da>ua&&ga<W){B=xa(ia(i)/Ia(B));i=(L-B)%I;L=(L+B)%I}else{da=P(da,ua);ga=z(ga,W);i=Ua;L=I}return Aa.init(S.init(da*T,i*T),S.init(ga*T,L*T))},expand:m,forPositions:function(a,h){var i=null,B=T5.ticks();h||(h="auto");for(var L=a.length;L--;)if(i){var da=e(i.min,a[L],false),ga=e(a[L],i.max,false);if(da.x<0)i.min.lon=a[L].lon;if(da.y<0)i.min.lat=a[L].lat;if(ga.x<0)i.max.lon=a[L].lon;if(ga.y<0)i.max.lat=a[L].lat}else i=x(a[L],a[L]);if(h){if(h=="auto"){L=e(i.min,i.max);h=P(L.x,L.y)*0.3}i=m(i,h)}COG.trace("calculated bounds for "+
a.length+" positions",B);return i},getCenter:l,getGeoHash:function(a){var h=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+h+", max hash = "+a)},getZoomLevel:function(a,h){var i=l(a);i=z(pa(t(i.lat)*0.05),j.length);var B=j[i],L=e(a.min,a.max);i=v($(j[3]*h.height/L.y)/$(2));B=v($(B*h.width/L.x)/$(2));return z(isNaN(i)?1E3:i,isNaN(B)?1E3:B)},init:x,isEmpty:function(a){return!a||S.empty(a.min)||S.empty(a.max)},toString:function(a){return"min: "+
S.toString(a.min)+", max: "+S.toString(a.max)}}}(),za=function(){var e=/^(\d+).*$/,m=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(l,x){e.lastIndex=-1;if(e.test(l))for(var a=l.replace(e,"$1"),h=x.split(","),i=0;i<h.length;i++){m.lastIndex=-1;if(m.test(h[i])){var B=m.exec(h[i]);if(a>=parseInt(B[1],10)&&a<=parseInt(B[2],10))return true}else if(a==h[i])return true}return false},normalize:function(l){if(!l)return"";l=l.toUpperCase();if(!Wa){var x=[];for(var a in Za)x.push(a);Wa=RegExp("(\\s)("+x.join("|")+
")(\\s|$)","i")}Wa.lastIndex=-1;if(x=Wa.exec(l))l=l.replace(Wa,"$1"+Za[x[2]]);return l},toString:function(l){return l.streetDetails+" "+l.location}}}(),ca=Va.GeoXY=function(){function e(l,x){if(l.length){for(var a,h,i,B,L=l.length;L--;){e(l[L],x);a=typeof a==="undefined"||l.x<a?l.x:a;h=typeof h==="undefined"||l.y<h?l.y:h;i=typeof i==="undefined"||l.x>i?l.x:i;B=typeof B==="undefined"||l.y>B?l.y:B}return ja.init(a,h,B,B)}else if(l.mercXY){a=l.mercXY;l.x=(a.x+Math.PI)/x|0;l.y=(Math.PI-a.y)/x|0;l.rpp=
x}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return l}function m(l,x,a){l.pos=x;l.mercXY=S.toMercatorPixels(x);(a=typeof a!=="undefined"?a:l.rpp)&&e(l,a)}return{init:function(l,x){var a=N.init();m(a,l,x);return a},sync:e,toPos:function(l,x){x=x?x:self.rpp;return S.fromMercatorPixels(l.x*x-Math.PI,Math.PI-l.y*x)},updatePos:m}}(),Xa={},qb=function(){return{bestResults:function(e,m){m||(m=20);for(var l=e.length>0?e[0]:null,x=[],a=0;a<e.length;a++)if(l&&e[a]&&l.matchWeight-e[a].matchWeight<=
m)x.push(e[a]);else break;return x}}}(),qa=function(e){e=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},e);return COG.extend(e,{toString:function(){return e.caption+(e.matchWeight?" ("+e.matchWeight+")":"")}})},ta=function(){function e(a,h){var i=a.getDimensions();i=new gb({data:h,width:i.width,height:i.height});a.setLayer("route",i)}function m(a){for(var h=l.Unknown,i=x,B=0;B<i.length;B++){i[B].regex.lastIndex=-1;var L=i[B].regex.exec(a);if(L){h=i[B].customCheck?i[B].customCheck(a,
L):i[B].turnType;break}}return h}var l={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},x=function(){var a=[];a.push({regex:/continue/i,turnType:l.Continue});
a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(h,i){return/bear/i.test(i[1])?l.TurnLeftSlight:l.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(h,i){return/bear/i.test(i[1])?l.TurnRightSlight:l.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:l.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:l.Ramp});a.push({regex:/take.*?exit/i,turnType:l.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(h,i){return/right/i.test(i[1])?
l.UTurnRight:l.UTurnLeft}});a.push({regex:/proceed/i,turnType:l.Start});a.push({regex:/arrive/i,turnType:l.Arrive});a.push({regex:/fell\sthrough/i,turnType:l.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var h=c("route");h&&h.route(a,function(i){if(a.generalize)i.geometry=S.generalize(i.geometry,i.getInstructionPositions());if(a.map){e(a.map,i);a.autoFit&&a.map.gotoBounds(i.boundingBox)}a.success&&
a.success(i)})},createMapOverlay:e,parseTurnType:m,TurnType:l,Instruction:function(a){var h=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),i=a.description;i=i.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");h.description=i;if(!a.turnType)a.turnType=m(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Aa.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var h=
[],i=0;i<a.instructions.length;i++)a.instructions[i].position&&h.push(a.instructions[i].position);return h}},a)}}}(),Pa="featurecollection",Qa="feature",bb={async:false},Ta={processor:null,group:"shapes",layerClass:yb},pb={point:COG.extend({},Ta,{processor:function(e,m,l,x){m=r([m.coordinates],bb);if(m.length>0)if(l=x.marker(m[0],l)){e.add(l);return m.length}},group:"markers",layerClass:rb}),linestring:COG.extend({},Ta,{processor:function(e,m,l,x){m=r(m&&m.coordinates?m.coordinates:[]);return q(e,
m,l,x)}}),multilinestring:COG.extend({},Ta,{processor:function(e,m,l,x){m=m&&m.coordinates?m.coordinates:[];for(var a=0,h=m.length;h--;)a+=q(e,m[h],l,x);return a}}),polygon:COG.extend({},Ta,{processor:function(e,m,l,x){m=m&&m.coordinates?m.coordinates:[];if(m.length>0)return u(e,m[0],l,x);return 0}}),multipolygon:COG.extend({},Ta,{processor:function(e,m,l,x){m=m&&m.coordinates?m.coordinates:[];for(var a=0,h=0;h<m.length;h++)a+=u(e,m[h][0],l,x);return a}})},db=function(e,m,l,x){function a(X,M){var ha=
X.processor,na=da+X.group,Ha=COG.extend({},X,l,{properties:M.properties});if(ha){var oa=O[na];if(!oa){oa=new X.layerClass({id:na});O[na]=oa}globalLayers=O;return ha(oa,M.data,Ha,x)}return 0}function h(X,M){var ha=X&&X.type?X.type.toLowerCase():null;return ha&&ha===Qa?h(X.geometry,X.properties):{type:ha,isCollection:ha?ha===Pa:false,definition:pb[ha],data:X,properties:M?M:X.properties}}function i(){var X=0,M=ga;if(!sa){for(;M<ra;M++){var ha=h(L?L(e[M]):e[M]),na=null;if(ha.isCollection){V+=1;sa=y(ha.data.features,
function(Ha){sa=null;for(var oa in Ha)O[oa]=Ha[oa]},{layerPrefix:da+V+"-"});na+=1}else if(ha.definition)na=a(ha.definition,ha);X+=na?na:1;if(X>=B)break}ga=M+1;if(sa||ga<ra)COG.animFrame(i);else m&&m(O)}}l=COG.extend({vectorsPerCycle:Na.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},l);x=COG.extend({marker:function(X){return new sb({xy:X})},line:function(X,M){return new tb(X,M)},poly:function(X,M){return new tb(X,COG.extend({fill:true},M))}},x);var B=l.vectorsPerCycle,
L=l.rowPreParse,da=l.layerPrefix,ga=0,ra=0,sa=null,V=0,O={};if(e){if(typeof e.length==="undefined")e=[e];ra=e.length;COG.animFrame(i)}};Va.GeoJSON={parse:y};Va.Map=function(e){function m(O){try{var X=Na.Position.init(O.coords.latitude,O.coords.longitude),M=O.coords.accuracy/1E3;V.trigger("locationUpdate",O,M);if(ga){if(!L){L=new Na.UI.LocationOverlay({pos:X,accuracy:M});L.update(V.getTileLayer());V.setLayer("location",L)}var ha=Na.BoundingBox.createBoundsFromCenter(X,Math.max(M,1));V.gotoBounds(ha)}else{L.pos=
X;L.accuracy=M;L.update(V.getTileLayer());a(X,null,COG.easing("sine.out"))}ga=false}catch(na){COG.exception(na)}}function l(O){COG.info("caught location tracking error:",O)}function x(O,X,M){COG.endTweens();V.setZoomLevel(X);a(O,M)}function a(O,X,M,ha){O=ca.init(O,Na.radsPerPixel(V.getZoomLevel()));var na=V.getDimensions();V.updateOffset(O.x-(na.width>>1),O.y-(na.height>>1),M,ha,function(){V.refresh();V.trigger("boundsChange",V.getBoundingBox());X&&X(V)})}e=COG.extend({tapExtent:10,crosshair:false,
zoomLevel:0,boundsChangeThreshold:30},e);var h={NONE:0,SINGLE:1,WATCH:2},i=N.init(),B=h.NONE,L=null,da=0,ga=true,ra=0,sa=e.tapExtent;e.adjustScaleFactor=function(O){return Math.pow(2,(O<1?Math.floor:Math.ceil)(Math.log(O)))};var V=COG.extend(new vb(e),{getBoundingBox:function(){var O=V.getViewRect();return Na.BoundingBox.init(ca.toPos(N.init(O.x1,O.y2),ra),ca.toPos(N.init(O.x2,O.y1),ra))},getCenterPosition:function(){var O=V.getViewRect();if(O){O=N.init(O.x1+(O.width>>1),O.y1+(O.height>>1));return ca.toPos(O,
ra)}return null},gotoBounds:function(O,X){var M=Na.BoundingBox.getZoomLevel(O,V.getDimensions());x(Na.BoundingBox.getCenter(O),M,X)},gotoPosition:x,panToPosition:a,syncXY:function(O){return ca.sync(O,ra)},locate:function(){V.trackStart(h.SINGLE);setTimeout(V.trackCancel,1E4)},trackStart:function(O){if(navigator.geolocation&&!da){B=O?O:h.WATCH;ga=true;da=navigator.geolocation.watchPosition(m,l,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){da&&navigator.geolocation&&
navigator.geolocation.clearWatch(da);V.removeLayer("location");L=null;B=h.NONE;da=0},animateRoute:function(O,X,M,ha){var na=V.getLayer("route");if(na)(O=na.getAnimation(O,X,M,ha))&&O.addToView(V)}});V.bind("pan",function(){B===h.SINGLE&&V.trackCancel()});V.bind("tap",function(O,X,M,ha){var na=Na.radsPerPixel(V.getZoomLevel());O=ca.toPos(ha,na);var Ha=ca.toPos(N.offset(ha,-sa,sa),na);ha=ca.toPos(N.offset(ha,sa,-sa),na);V.trigger("geotap",X,M,O,Aa.init(Ha,ha))});V.bind("refresh",function(){if(N.absSize(N.diff(i,
V.getOffset()))>e.boundsChangeThreshold){i=N.copy(V.getOffset());V.trigger("boundsChange",V.getBoundingBox())}});K(V,e);V.bind("zoomLevelChange",function(O,X){var M;ra=Na.radsPerPixel(X);M=I/ra|0;V.setMaxOffset(M,M,true,false);Ga.cancelLoad();V.resetScale();V.triggerAll("resync",V);V.refresh()});return V};Va.GeoShape=function(e,m){m=COG.extend({autoParse:true},m);for(var l=Array(e.length),x=m.autoParse,a=T5.Geo.Position.parse,h=e.length;h--;)l[h]=T5.GeoXY.init(x?a(e[h]):e[h]);return new T5.Poly(l,
m)};var gb=Va.RouteOverlay=function(e){e=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},e);var m=[],l=[],x=new T5.PathLayer(e);(function(){if(e.data&&e.data.instructions){for(var a=e.data.instructions,h=Array(a.length),i=a.length;i--;)h[i]=a[i].position;S.vectorize(h).bind("complete",function(B,L){l=L})}e.data&&e.data.geometry&&S.vectorize(e.data.geometry).bind("complete",function(B,L){m=L;x.updateCoordinates(m,
l,true)})})();return x};Va.LocationOverlay=function(e){e=COG.extend({pos:null,accuracy:null,zindex:90},e);var m=new Image,l=T5.XY.init(),x=T5.XY.init(),a=null;m.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
m.onload=function(){l=T5.XY.init(m.width>>1,m.height>>1)};var h=COG.extend(new T5.ViewLayer(e),{pos:e.pos,accuracy:e.accuracy,drawAccuracyIndicator:false,draw:function(i,B){var L=x.x-B.x,da=x.y-B.y;if(a){i.fillStyle="rgba(30, 30, 30, 0.2)";i.beginPath();i.arc(L,da,a,0,Math.PI*2,false);i.fill()}m.complete&&m.width>0&&i.drawImage(m,L-l.x,da-l.y,m.width,m.height);h.changed()},update:function(i){if(i){a=i.getPixelDistance(h.accuracy)>>1;x=i.getGridXYForPosition(h.pos);h.changed()}}});h.bind("gridUpdate",
function(i,B){h.update(B)});return h};return{distanceToString:function(e){if(e>1E3)return~~(e/10)/100+" km";return e?e+" m":""},dist2rad:function(e){return e/6371},getEngine:c,lat2pix:s,lon2pix:g,pix2lat:b,pix2lon:d,radsPerPixel:function(e){return I/(256<<e)},Position:S,BoundingBox:Aa,Radius:function(e,m){return{distance:parseInt(e,10),uom:m}},Address:function(e){return e=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},e)},A:za,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(e){if(!e.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var m=COG.extend({remove:function(){delete Xa[m.id]}},e);return Xa[m.id]=m},Search:qb,GeoSearchResult:qa,LocationSearch:function(e){function m(i,B){navigator.geolocation.clearWatch(x);x=0;if(a){clearTimeout(a);a=0}B&&B([i],e)}function l(i){COG.info("caught location tracking error:",i)}e=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},e);var x=0,a=0,h=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(i,B){if(navigator.geolocation&&!x){x=navigator.geolocation.watchPosition(function(L){var da=S.init(L.coords.latitude,L.coords.longitude);L=new qa({id:1,caption:"Current Location",pos:da,accuracy:L.coords.accuracy/1E3,matchWeight:100});if(!h||L.accuracy<h.accuracy)h=L;if(!e.requiredAccuracy||h.accuracy<e.requiredAccuracy)m(h,B)},l,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(e.searchTimeout)a=
setTimeout(function(){h&&m(h,B)},e.searchTimeout)}}},e))},Routing:ta}}();return Va}();
