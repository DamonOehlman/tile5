T5.Geo.Bing=function(){function m(a,c,b){_log("attempting authentication, apikey = "+a+", style = "+c);if(i[c])b&&b();else _jsonp(n(c,a),function(f){var g=f.resourceSets[0].resources[0];i[c]=g.imageUrl;l=g.imageUrlSubdomains;T5.userMessage("ack","bing",f.copyright);b&&b()},"jsonp")}var i={},l=[],n=_formatter("http://dev.virtualearth.net/REST/V1/Imagery/Metadata/{0}?key={1}");T5.Registry.register("generator","bing",function(a){a=_extend({apikey:null,style:"Road",osmDataAck:false},a);var c="",b=0,f=
new T5.Geo.OSM.Generator(a),g=f.run;return _extend(f,{buildTileUrl:function(d,j,e){for(var h="",k=1;k<=e;k++)h+=(j>>e-k&1)<<1|d>>e-k&1;d=h;b=b?b%l.length+1:0;return c.replace("{quadkey}",d).replace("{culture}","").replace("{subdomain}",l[b])},run:function(d,j,e,h){i[a.style]?g(d,j,e,h):m(a.apikey,a.style,function(){c=i[a.style];g(d,j,e,h)})}})})}();
