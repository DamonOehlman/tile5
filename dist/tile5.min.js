COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var E=arguments[0]||{},Z,v=1,r=arguments.length;v<r;v++)if((Z=arguments[v])!==null)for(var k in Z){var l=Z[k];if(E!==l)if(l!==undefined)E[k]=l}return E};
(function(){var E=Object.prototype.hasOwnProperty,Z=0,v={};v.toID=function(r){return r.replace(/\s/g,"-")};v.objId=function(r){return(r?r:"obj")+Z++};v.isFunction=function(r){return toString.call(r)==="[object Function]"};v.isArray=function(r){return toString.call(r)==="[object Array]"};v.isPlainObject=function(r){if(!r||toString.call(r)!=="[object Object]"||r.nodeType||r.setInterval)return false;if(r.constructor&&!E.call(r,"constructor")&&!E.call(r.constructor.prototype,"isPrototypeOf"))return false;
var k;for(k in r);return k===undefined||E.call(r,k)};v.isEmptyObject=function(r){for(var k in r)return false;return true};v.isXmlDocument=function(r){return toString.call(r)==="[object Document]"};v.contains=function(r,k){var l=r,s=arguments,z=1;if(k&&module.isArray(k)){s=k;z=0}for(z=z;z<s;z++)l=l&&typeof foo[s[z]]!=="undefined";return l};v.formatStr=function(r){if(arguments.length<=1)return r;for(var k=arguments.length-2,l=0;l<=k;l++)r=r.replace(RegExp("\\{"+l+"\\}","gi"),arguments[l+1]);return r};
v.wordExists=function(r,k){var l="";if(k.toString)k=k.toString();for(var s=0;s<k.length;s++)l+=!/\w/.test(k[s])?"\\"+k[s]:k[s];return RegExp("(^|\\s|\\,)"+l+"(\\,|\\s|$)","i").test(r)};COG.extend(COG,v)})();
(function(){function E(l){return typeof console!=="undefined"?function(){console[l](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var Z=window.console&&window.console.markTimeline,v=E("error"),r=E("info"),k=function(){return Z?function(l,s){console.markTimeline(l+(s?": "+((new Date).getTime()-s)+"ms":""))}:function(){}}();COG.extend(COG,{trace:k,debug:E("debug"),info:r,warn:E("warn"),error:v,exception:function(l){if(v)for(var s in l)r("ERROR DETAIL: "+s+
": "+l[s])}})})();
(function(){function E(v,r){var k=v.hasOwnProperty("obsHandlers")?v.obsHandlers:null;k[r]||(k[r]=[]);return k[r]}var Z=0;COG.observable=function(v){if(!v)return null;if(!(v.hasOwnProperty("obsHandlers")?v.obsHandlers:null))v.obsHandlers={};if(!v.hasOwnProperty("bind")){v.bind=function(r,k){var l="callback"+Z++;E(v,r).unshift({fn:k,id:l});return l};v.triggerCustom=function(r,k){var l=E(v,r),s={cancel:false,name:r,source:this},z;k&&COG.extend(s,k);if(!l)return null;z=Array.prototype.slice.call(arguments,2);
v.eventInterceptor&&v.eventInterceptor(r,s,z);z.unshift(s);for(var T=l.length;T--&&!s.cancel;)l[T].fn.apply(this,z);return s};v.trigger=function(r){var k=Array.prototype.slice.call(arguments,1);k.splice(0,0,r,null);return v.triggerCustom.apply(this,k)};v.unbind=function(r,k){if(typeof r==="undefined")v.obsHandlers={};else for(var l=E(v,r),s=0;l&&s<l.length;s++)if(l[s].id===k){l.splice(s,1);break}return v}}return v}})();
(function(){function E(k,l){k[l]||(k[l]=function(s){return k.configure(l,s)})}function Z(k){k.gtConfId="configurable"+r++;k.gtConfig={};k.gtConfigFns=[];return k.gtConfig}var v={},r=0;COG.paramTweaker=function(k,l,s){return function(z,T){if(typeof T!=="undefined"){if(z in k)k[z]=T;s&&z in s&&s[z](z,T)}else return l&&z in l?l[z](z):k[z]}};COG.configurable=function(k,l,s,z){if(k){k.gtConfId||Z(k);var T=k.gtConfId,ka=k.gtConfig,p=k.gtConfigFns;v[T]=k;p.push(s);for(s=l.length;s--;){ka[l[s]]=true;z&&E(k,
l[s])}if(!k.configure)k.configure=function(B,j){if(ka[B]){for(var m=p.length;m--;){var w=p[m](B,j);if(typeof w!=="undefined")return w}return v[T]}return null}}}})();
(function(){function E(k){var l=document.createElement("script"),s=false;l.src=k;l.async=true;l.onload=l.onreadystatechange=function(){if(!s&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){s=true;l.onload=l.onreadystatechange=null;l&&l.parentNode&&l.parentNode.removeChild(l)}};v||(v=document.getElementsByTagName("head")[0]);v.appendChild(l)}var Z=0,v,r=this;COG.jsonp=function(k,l,s){k+=k.indexOf("?")>=0?"&":"?";var z="json"+ ++Z;r[z]=function(T){l(T);r[z]=null;try{delete r[z]}catch(ka){}};
E(k+(s?s:"callback")+"="+z);return z}})();
(function(){var E=1.70158,Z=Math.PI/2,v=Math.PI*2,r=1E3/60|0,k=Math.abs,l=Math.pow,s=Math.sin,z=Math.asin,T=Math.cos,ka={linear:function(p,B,j,m){return j*p/m+B},backin:function(p,B,j,m){return j*(p/=m)*p*((E+1)*p-E)+B},backout:function(p,B,j,m){return j*((p=p/m-1)*p*((E+1)*p+E)+1)+B},backinout:function(p,B,j,m){return(p/=m/2)<1?j/2*p*p*(((E*=1.525)+1)*p-E)+B:j/2*((p-=2)*p*(((E*=1.525)+1)*p+E)+2)+B},bouncein:function(p,B,j,m){return j-ka.bounceout(m-p,0,j,m)+B},bounceout:function(p,B,j,m){return(p/=
m)<1/2.75?j*7.5625*p*p+B:p<2/2.75?j*(7.5625*(p-=1.5/2.75)*p+0.75)+B:p<2.5/2.75?j*(7.5625*(p-=2.25/2.75)*p+0.9375)+B:j*(7.5625*(p-=2.625/2.75)*p+0.984375)+B},bounceinout:function(p,B,j,m){return p<m/2?ka.bouncein(p*2,0,j,m)/2+B:ka.bounceout(p*2-m,0,j,m)/2+j/2+B},cubicin:function(p,B,j,m){return j*(p/=m)*p*p+B},cubicout:function(p,B,j,m){return j*((p=p/m-1)*p*p+1)+B},cubicinout:function(p,B,j,m){if((p/=m/2)<1)return j/2*p*p*p+B;return j/2*((p-=2)*p*p+2)+B},elasticin:function(p,B,j,m,w,O){if(p==0)return B;
if((p/=m)==1)return B+j;O||(O=m*0.3);if(!w||w<k(j)){w=j;j=O/4}else j=O/v*z(j/w);return-(w*l(2,10*(p-=1))*s((p*m-j)*v/O))+B},elasticout:function(p,B,j,m,w,O){var L;if(p==0)return B;if((p/=m)==1)return B+j;O||(O=m*0.3);if(!w||w<k(j)){w=j;L=O/4}else L=O/v*z(j/w);return w*l(2,-10*p)*s((p*m-L)*v/O)+j+B},elasticinout:function(p,B,j,m,w,O){var L;if(p==0)return B;if((p/=m/2)==2)return B+j;O||(O=m*0.3*1.5);if(!w||w<k(j)){w=j;L=O/4}else L=O/v*z(j/w);if(p<1)return-0.5*w*l(2,10*(p-=1))*s((p*m-L)*v/O)+B;return w*
l(2,-10*(p-=1))*s((p*m-L)*v/O)*0.5+j+B},quadin:function(p,B,j,m){return j*(p/=m)*p+B},quadout:function(p,B,j,m){return-j*(p/=m)*(p-2)+B},quadinout:function(p,B,j,m){if((p/=m/2)<1)return j/2*p*p+B;return-j/2*(--p*(p-2)-1)+B},sinein:function(p,B,j,m){return-j*T(p/m*Z)+j+B},sineout:function(p,B,j,m){return j*s(p/m*Z)+B},sineinout:function(p,B,j,m){return-j/2*(T(Math.PI*p/m)-1)+B}};COG.tweenValue=function(p,B,j,m,w){function O(J){J=J?J:(new Date).getTime();if(na+r<J){var la=J-L,xa=j(la,p,ra,m),ua=L+m<=
J;J=!ua;if(w){la=w(xa,ua,la);J=typeof la!="undefined"?la&&J:J}J&&animFrame(O)}}var L=(new Date).getTime(),na=0,ra=B-p;animFrame(O);return{}};COG.easing=function(p){return ka[p.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(p,B){ka[p.replace(/[\-\_\s\.]/g,"").toLowerCase()]=B}})();
(function(){var E=/^P(\d+Y)?(\d+M)?(\d+D)?$/,Z=/^(\d+H)?(\d+M)?(\d+S)?$/,v={8601:function(k){k=k.split("T");var l=null;l=null;var s=0,z=0;E.lastIndex=-1;l=E.exec(k[0]);s+=l[3]?parseInt(l[3].slice(0,-1),10):0;Z.lastIndex=-1;l=Z.exec(k[1]);z+=l[1]?parseInt(l[1].slice(0,-1),10)*3600:0;z+=l[2]?parseInt(l[2].slice(0,-1),10)*60:0;z+=l[3]?parseInt(l[3].slice(0,-1),10):0;return new r(s,z)}},r=COG.Duration=function(k,l){return{days:k?k:0,seconds:l?l:0}};COG.addDuration=function(){for(var k=new r,l=arguments.length;l--;){k.days+=
arguments[l].days;k.seconds+=arguments[l].seconds}if(k.seconds>=86400){k.days+=~~(k.seconds/86400);k.seconds%=86400}return k};COG.formatDuration=function(k){var l,s,z="";if(k.days)z=k.days+" days ";if(k.seconds){k=k.seconds;if(k>=3600){l=~~(k/3600);k-=l*3600}if(k>=60){s=Math.round(k/60);k-=s*60}if(l)z=z+l+(l>1?" hrs ":" hr ")+(s?(s>10?s:"0"+s)+" min ":"");else if(s)z=z+s+" min";else if(k>0)z=z+(k>10?k:"0"+k)+" sec"}return z};COG.parseDuration=function(k,l){var s=l?v[l]:null;if(s)return s(k);COG.Log.warn("Could not find duration parser for specified format: "+
l);return new r}})();COG.ObjectStore=function(){var E={},Z={},v="obj_"+(new Date).getTime(),r=0,k=Object.prototype.hasOwnProperty;return{add:function(l,s){var z;s=s?s:"default";if(l&&l.constructor)if(!k.call(l,"id"))l.id=v+ ++r;z=Z[s]?Z[s]:Z[s]=[];E[l.id]=z.length;z[l.length]=l}}};var CANI={};
(function(E){var Z=[],v=0,r=false,k=E.register=function(l,s){Z.push({section:l,run:s})};E.init=function(l){function s(){if(v<Z.length){var T=Z[v++];z[T.section]||(z[T.section]={});T.run(z[T.section],s)}else{for(T in z)E[T]=z[T];r=true;l&&l(E)}}var z={};if(r&&l)l(E);else{v=0;s()}};k("canvas",function(l,s){function z(){var B,j=T.getContext("2d");j.save();try{j.translate(50,50);j.beginPath();j.rect(0,0,20,20);B=j.isPointInPath(10,10)}finally{j.restore()}return B}var T=document.createElement("canvas"),
ka=typeof FlashCanvas!="undefined",p=typeof G_vmlCanvasManager!="undefnined";T.width=200;T.height=200;l.pipTransformed=ka||p?false:z();s()})})(CANI);
INTERACT=function(){function E(j){return function(m,w){j.addEventListener(m,w,false)}}function Z(j){return function(m,w){j.removeEventListener(m,w,false)}}function v(j){return function(m,w){j.attachEvent("on"+m,w)}}function r(j,m){return{x:j?j:0,y:m?m:0,count:1}}function k(j,m){p.push(COG.extend({handler:null,checks:{},type:j},m))}function l(j){var m=0,w=0;if(j.offsetParent){do{m+=j.offsetLeft;w+=j.offsetTop;j=j.offsetParent}while(j)}return{left:m,top:w}}function s(j,m){return{source:j,target:m.target?
m.target:m.srcElement}}function z(j,m){for(var w=j.target?j.target:j.srcElement;w&&w!==m;)w=w.parentNode;return w&&w===m}function T(j,m){return{x:j.x-(m?m.left:0),y:j.y-(m?m.top:0)}}function ka(j,m){if(j.preventDefault){j.preventDefault();j.stopPropagation()}else if(typeof j.cancelBubble!="undefined")j.cancelBubble=true;m&&j.stopImmediatePropagation&&j.stopImmediatePropagation()}var p=[],B=function(j,m,w){function O(fa,ea,ga,P){var Q=0,ia=0,x=0;COG.tweenValue(0,fa,ga,P,function(M){x=Q;Q=M});COG.tweenValue(0,
ea,ga,P,function(M){L.trigger("pan",Q-x,M-ia);ia=M})}w=COG.extend({binder:null,unbinder:null,observable:null},w);for(var L=w.observable,na=null,ra=[],J=[],la,xa,ua={bind:function(){return L.bind.apply(null,arguments)},pannable:function(fa){na=COG.extend({inertia:true},fa);return ua},unbind:function(){L.unbind();for(Ca=0;Ca<ra.length;Ca++)ra[Ca].unbind();return ua}},Ca=0;Ca<m.length;Ca++)ra.push(m[Ca](j,L,w));L.bind("pointerDown",function(){J=[];xa=la=0});L.bind("pointerMove",function(fa,ea,ga,P){if(na){J[J.length]=
{ticks:(new Date).getTime(),x:P.x,y:P.y};L.trigger("pan",P.x,P.y)}la+=P.x?P.x:0;xa+=P.y?P.y:0});L.bind("pointerUp",function(fa,ea,ga){if(Math.abs(la)>20||Math.abs(xa)>20){if(na){ga=J.length;var P,Q;ea=0;for(Q=J.length;--Q>1&&ea<50;)ea+=J[Q].ticks-J[Q-1].ticks;if(ga-Q>1){fa=J[ga-1].x-J[Q].x;P=J[ga-1].y-J[Q].y;Q=Math.sqrt(fa*fa+P*P)|0;if(Q>15){fa=J[ga-1].x-J[0].x;P=J[ga-1].y-J[0].y;Q=Math.sqrt(fa*fa+P*P)|0;ga=Math.asin(P/Q);ea=Q*500/ea|0;ea=ea>300?300:ea;O(Math.cos(fa>0?ga:Math.PI-ga)*ea,Math.sin(ga)*
ea,COG.easing("sine.out"),500)}}}}else L.triggerCustom("tap",fa,ea,ga)});return ua};k("pointer",{handler:function(j,m,w){function O(x){if(x.pageX&&x.pageY)return r(x.pageX,x.pageY);else{var M=document.documentElement,W=document.body;return r(x.clientX+(M&&M.scrollLeft||W&&W.scrollLeft||0)-(M&&M.clientLeft||W&&W.clientLeft||0),x.clientY+(M&&M.scrollTop||W&&W.scrollTop||0)-(M&&M.clientTop||W&&W.clientTop||0))}}function L(x){if(z(x,j))if(fa=la(x)){var M=O(x);j.style.cursor="move";ka(x,true);Q=M.x;ia=
M.y;ea=r(Q,ia);m.triggerCustom("pointerDown",s("mouse",x),ea,T(ea,l(j)))}}function na(x){var M=O(x);ga=M.x;P=M.y;if(z(x,j))xa(x,fa?"pointerMove":"pointerHover")}function ra(x){if(fa&&la(x)){fa=false;if(z(x,j)){j.style.cursor="default";xa(x,"pointerUp")}}}function J(x){if(z(x,j)){var M;x=x||window.event;if(x.detail)M=x.axis===2?-x.detail*ua:0;else{M=x.wheelDeltaY?x.wheelDeltaY:x.wheelDelta;if(window.opera)M=-M}if(M!==0){var W=r(ga,P);m.triggerCustom("zoom",s("mouse",x),W,T(W,l(j)),M/Ca,"wheel");ka(x);
x.returnValue=false}}}function la(x){x=x||window.event;return(x.which||x.button)==1}function xa(x,M,W,sa,za){W=typeof W!="undefined"?W:ga;sa=typeof sa!="undefined"?sa:P;var H=W-Q,U=sa-ia,V=r(W,sa);m.triggerCustom(M,s("mouse",x),V,T(V,l(j)),r(H,U));if(typeof za=="undefined"||za){Q=W;ia=sa}}w=COG.extend({},w);var ua=120,Ca=ua*8,fa=false,ea,ga,P,Q,ia;w.binder("mousedown",L);w.binder("mousemove",na);w.binder("mouseup",ra);w.binder("dblclick",function(x){COG.info("captured double click");if(z(x,j)){var M=
O(x);m.triggerCustom("doubleTap",s("mouse",x),M,T(M,l(j)))}});w.binder("mousewheel",J);w.binder("DOMMouseScroll",J);return{unbind:function(){w.unbinder("mousedown",L);w.unbinder("mousemove",na);w.unbinder("mouseup",ra);w.unbinder("mousewheel",J);w.unbinder("DOMMouseScroll",J)}}},checks:{touch:false}});k("pointer",{handler:function(j,m,w){function O(H){if(H.count<2)return 0;var U=H.x-H.next.x;H=H.y-H.next.y;return~~Math.sqrt(U*U+H*H)}function L(H,U,V){U=U?U:0;V=V?V:0;for(var oa={x:H.x-U,y:H.y-V,id:H.id,
count:H.count},Da=oa;H.next;){H=H.next;Da=Da.next={x:H.x-U,y:H.y-V,id:H.id}}return oa}function na(H,U){var V=H[U?U:"touches"],oa,Da;if(V.length===0)return null;Da=oa={x:V[0].pageX,y:V[0].pageY,id:V[0].identifier,count:V.length};for(var Aa=1,Ta=V.length;Aa<Ta;Aa++)Da=Da.next={x:V[Aa].pageX,y:V[Aa].pageY,id:V[Aa].identifier};return oa}function ra(H){if(z(H,j)){P=l(j);var U=na(H,"changedTouches"),V=L(U,P.left,P.top);if(!ia){Q=fa;m.triggerCustom("pointerDown",s("touch",H),U,V)}sa&&m.triggerCustom("pointerDownMulti",
s("touch",H),U,V);ia=na(H);if(ia.count>1)M=O(ia);za=1;W=L(ia)}}function J(H){if(z(H,j)){ka(H);x=na(H);if(Q==fa)Q=Math.abs(ia.x-x.x)>ua||Math.abs(ia.y-x.y)>ua?Ca:fa;if(Q!=fa){Q=x.count>1?ga:ea;if(Q==ga)if(ia.count===1){ia=L(x);M=O(ia)}else{var U=O(x);if(Math.abs(M-U)<xa)Q=ea;else{var V;V=x.x;var oa=x.next.x,Da=x.y,Aa=x.next.y,Ta=Da<Aa?Da:Aa;V={x:(V<oa?V:oa)+(Math.abs(V-oa)>>1),y:Ta+(Math.abs(Da-Aa)>>1)};U=U/M;oa=U-za;m.triggerCustom("zoom",s("touch",H),V,T(V,P),oa,"pinch");za=U}}Q==ea&&m.triggerCustom("pointerMove",
s("touch",H),x,L(x,P.left,P.top),r(x.x-W.x,x.y-W.y));sa&&m.triggerCustom("pointerMoveMulti",s("touch",H),x,L(x,P.left,P.top))}W=L(x)}}function la(H){if(z(H,j)){var U=na(H,"changedTouches"),V=L(U,P.left,P.top);x=na(H);if(!x){m.triggerCustom("pointerUp",s("touch",H),U,V);ia=null}sa&&m.triggerCustom("pointerUpMulti",s("touch",H),U,V)}}w=COG.extend({detailed:false,inertia:false},w);var xa=20,ua=7,Ca=0,fa=1,ea=2,ga=3,P,Q,ia,x,M,W,sa=w.detailed,za=1;w.binder("touchstart",ra);w.binder("touchmove",J);w.binder("touchend",
la);COG.info("initialized touch handler");return{unbind:function(){w.unbinder("touchstart",ra);w.unbinder("touchmove",J);w.unbinder("touchend",la)}}},checks:{touch:true}});return{register:k,watch:function(j,m,w){m=COG.extend({bindTarget:null,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},m);capabilities=COG.extend({touch:"ontouchstart"in window},w);if(!m.observable){COG.info("creating observable");m.observable=COG.observable({});globalOpts=m}m.binder=(m.isIE?v:E)(m.bindTarget||
document);m.unbinder=(m.isIE?v:Z)(m.bindTarget||document);w=m.types;for(var O=capabilities,L=[],na=p.length;na--;){var ra=p[na],J=!w||w.indexOf(ra.type)>=0,la=true;for(var xa in ra.checks){var ua=ra.checks[xa];COG.info("checking "+xa+" capability. require: "+ua+", capability = "+O[xa]);la=la&&ua===O[xa]}if(J&&la)L[L.length]=ra.handler}return new B(j,L,m)}}}();var T5={};
(function(E){function Z(){return(new Date).getTime()}function v(b,d){d=Sb.call(d);if(d=="finite")return!Tb[Ub](+b);return d=="null"&&b===null||d==typeof b||d=="object"&&b===Object(b)||d=="array"&&Array.isArray&&Array.isArray(b)||Vb.call(b).slice(8,-1).toLowerCase()==d}function r(b,d){this.x=b||0;this.y=d||0}function k(b,d,e,f){this.x=b||0;this.y=d||0;this.w=e||0;this.h=f||0;this.x2=this.x+this.w;this.y2=this.y+this.h}function l(b){return new vb(Math.sqrt(256<<b)|0)}function s(b){b=b||(new Date).getTime();
for(var d=0;d<Ua.length;){var e=Ua[d],f=Pa[e],a=Pa[e].image&&(cb||Pa[e].image.complete&&Pa[e].image.width>0),c=b-f.start;c=a||c>=Wb;if(a){a=f.callbacks;wb[e]=f.image;for(var g=0;g<a.length;g++)a[g](f.image,true)}if(c){Ua.splice(d,1);delete Pa[e]}else d++}Ua.length>0&&animFrame(s)}function z(b,d){var e=b&&d?wb[b]:null;if(e&&e&&(cb||e.complete&&e.width>0))d(e);else{if(e=Pa[b])e.callbacks.push(d);else{e=new Image;e.id="_ldimg"+ ++Xb;Pa[b]={start:(new Date).getTime(),image:e,callbacks:[d]};e.src=b;Ua[Ua.length]=
b}animFrame(s)}}function T(b,d,e,f,a,c){this.x=b;this.y=d;this.w=f||256;this.h=f||256;this.x2=this.x+this.w;this.y2=this.y+this.h;this.url=e;this.id=c||b+"_"+d;this.loaded=false;this.image=null}function ka(){for(var b=0,d=arguments.length;d--;){var e=Yb[arguments[d].toUpperCase()];if(e)b|=e}return b}function p(b){b=b?b:(new Date).getTime();if(b-xb>Zb){for(var d=Za.splice(0),e=d.length;e--;)d[e](b);xb=b}Za.length&&animFrame(p)}function B(b){var d=Za.length==0;Za[Za.length]=b;d&&animFrame(p)}function j(b,
d,e,f,a){a=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},a);var c=(new Date).getTime(),g=b[d],h=d=="translate",i=a.autoInvalidate,n=e.length&&f.length&&e.length==f.length?e.length:0,o=Array(n),F=Array(n),I=COG.easing(a.easing),G=a.duration,t=a.progress,D=function(C){var K=C-c;C=c+G<=C;for(var X=b.layer?b.layer.view:null,ma,ja=n;ja--;){ma=I(K,e[ja],o[ja],G);F[ja]=h?ma|0:ma}g.apply(b,F);i&&X&&X.invalidate();if(t){K=[].concat(C?f:F);K.unshift(C);t.apply(b,
K)}if(C){b.animations--;g.apply(b,f);a.complete&&a.complete.apply(b,f)}else B(D)};if(g&&g.apply&&n>0){G=G?G:DEFAULT_DURATION;for(d=n;d--;)o[d]=f[d]-e[d];b.animations++;B(D)}}function m(b){b=COG.extend({fill:true,stroke:false,markerStyle:"simple",hoverStyle:"highlight",typeName:"Marker"},b);Ga.call(this,b)}function w(b,d){d=COG.extend({simplify:false,fill:true,typeName:"Poly"},d);var e=d.simplify;Ga.call(this,d);COG.extend(this,{resync:function(f){var a,c,g,h,i,n;f.syncXY(b);n=this.points=Qa.floor(e?
Qa.simplify(b):b);for(var o=n.length;o--;){f=n[o].x;a=n[o].y;h=v(h,ya)||f<h?f:h;i=v(i,ya)||a<i?a:i;c=v(c,ya)||f>c?f:c;g=v(g,ya)||a>g?a:g}this.updateBounds(new k(h,i,c-h,g-i),true)}});this.haveData=b&&b.length>=2}function O(b,d){d.fill=false;w.call(this,b,d)}function L(b){function d(){if(g&&g.width>0){if(!this.centerOffset)this.centerOffset=new r(-g.width>>1,-g.height>>1);this.updateBounds(new k(this.xy.x+this.centerOffset.x,this.xy.y+this.centerOffset.y,g.width,g.height),false)}}function e(i){if(this.imageUrl=
i){var n=this;z(this.imageUrl,function(o,F){g=o;if(F){var I=h.layer?h.layer.view:null;I&&I.invalidate()}d.apply(n)})}}b=COG.extend({image:null,imageUrl:null,centerOffset:null,typeName:"Image"},b);var f=Ga.prototype.resync,a=0,c=0,g=b.image;Ga.call(this,b);var h=COG.extend(this,{changeImage:e,getProps:function(){this.bounds||d(this,g);return{image:g,x:this.xy.x+a,y:this.xy.y+c}},resync:function(i){f.call(this,i);d.call(this)}});g||e.call(this,this.imageUrl);if(this.centerOffset){a=this.centerOffset.x;
c=this.centerOffset.y}}function na(b){b=COG.extend({imageAnchor:null},b);if(b.imageAnchor)b.centerOffset=Qa.invert(b.imageAnchor);L.call(this,b)}function ra(b){b=COG.extend({startAngle:0,endAngle:Math.PI*2,typeName:"Arc"},b);Ga.call(this,b)}function J(b){b=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,validStates:ka("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);this.view=null;this.visible=true;COG.observable(COG.extend(this,b))}function la(b){for(var d=null,e=
1;!d&&e<arguments.length;e++)d=Ca(b,arguments[e]);d=d?d:Ca(b);if(!d)throw Error("Unable to find GEO engine with "+b+" capability");return d}function xa(b){b=parseFloat(b)*Ha;b=oa(b);var d=db*b;return U((1+b)/(1-b)*za((1-d)/(1+d),db))/2}function ua(b){return Q/(256<<b)}function Ca(b,d){var e=null;for(var f in Ra)if(d){if(f==d&&Ra[f][b]){e=Ra[f];break}}else if(Ra[f][b]){e=Ra[f];break}return e}function fa(b,d){var e=db*oa(b);return ia-2*Ta(d*za((1-e)/(1+e),db/2))}function ea(b,d,e,f){d=ga(d);b.add(f(d,
e));return d.length}function ga(b){var d=b?b.length:0,e=Array(d);for(d=d;d--;)e[d]=ha.init(b[d][1],b[d][0]);return ha.vectorize(e,yb)}COG.observable(E);window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var P=Array.prototype.indexOf||function(b){for(var d=0;d<this.length;d++)if(this[d]===
b)return d;return-1},Q=Math.PI*2,ia=Math.PI/2,x=Math.abs,M=Math.ceil,W=Math.min,sa=Math.max,za=Math.pow,H=Math.sqrt,U=Math.log,V=Math.round,oa=Math.sin,Da=Math.asin,Aa=Math.cos,Ta=Math.atan,$b=Math.atan2,Ub="hasOwnProperty",Tb={NaN:1,Infinity:1,"-Infinity":1},Sb=String.prototype.toLowerCase,Vb=Object.prototype.toString,ya="undefined",zb="number",ac=typeof G_vmlCanvasManager!=ya,cb=typeof FlashCanvas!=ya,bc=T5.newCanvas=function(b,d){var e=document.createElement("canvas");e.width=b?b:0;e.height=d?
d:0;if(cb){document.body.appendChild(e);FlashCanvas.initElement(e)}ac&&G_vmlCanvasManager.initElement(e);return e},Ab=function(){var b={};return{init:function(d,e){var f=b[d];if(!f)throw Error("Unable to locate requested generator: "+d);return new f(e)},register:function(d,e){b[d]=e}}}();r.prototype={constructor:r};k.prototype={constructor:k};var Qa=function(){function b(f,a){return e(f.x-a.x,f.y-a.y)}function d(f,a){a=a||f.length;if(a<=1)return null;for(var c=Array(a-1),g=Array(a-1),h=0,i,n=0;n<
a-1;n++){i=b(f[n],f[n+1]);c[n]=H(i.x*i.x+i.y*i.y);g[n]=h+=c[n]}return{edges:c,accrued:g,tota:h}}function e(f,a){return new r(f,a)}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var f=0,a=0,c=arguments.length;c--;){f+=arguments[c].x;a+=arguments[c].y}return e(f,a)},absSize:function(f){return sa(x(f.x),x(f.y))},copy:function(f){return f?e(f.x,f.y):null},diff:b,distance:function(f,a){return d(f,a).total},edges:d,equals:function(f,a){return f.x===a.x&&f.y===a.y},extendBy:function(f,
a,c){var g=Aa(a)*c|0;a=oa(a)*c|0;return e(f.x-g,f.y-a)},floor:function(f){for(var a=Array(f.length),c=f.length;c--;)a[c]=e(~~f[c].x,~~f[c].y);return a},getRect:function(f){for(var a,c,g,h,i=f.length;i--;){var n=f[i];a=v(a,ya)||n.x<a?n.x:a;c=v(c,ya)||n.y<c?n.y:c;g=v(g,ya)||n.x>g?n.x:g;h=v(h,ya)||n.y>h?n.y:h}return new k(a,c,g-a,h-c)},init:e,invert:function(f){return e(-f.x,-f.y)},min:function(f,a){return e(f.x<a.x?f.x:a.x,f.y<a.y?f.y:a.y)},max:function(f,a){return e(f.x>a.x?f.x:a.x,f.y>a.y?f.y:a.y)},
offset:function(f,a,c){return e(f.x+a,f.y+(c||a))},scale:function(f,a){return e(f.x/a|0,f.y/a|0)},simplify:function(f,a){if(!f)return null;a=a?a:Qa.VECTOR_SIMPLIFICATION;for(var c=[],g=null,h=f.length;h--;){var i=f[h];if(include=!g||h===0||x(i.x-g.x)+x(i.y-g.y)>a){c.unshift(i);g=i}}return c},theta:function(f,a,c){c=Da((f.y-a.y)/c);return f.x>a.x?c:Math.PI-c},toString:function(f){return f?f.x+", "+f.y:""}}}(),ib=function(){return{dotProduct:function(b,d){return b.x*d.x+b.y*d.y}}}(),Va=function(){function b(e){return d(e.x,
e.y,e.x2,e.y2)}function d(e,f,a,c){return new k(e,f,(a||e)-e,(c||f)-f)}return{buffer:function(e,f,a){return Va.init(e.x-f,e.y-(a||f),e.x2+f,e.y2+(a||f))},center:function(e){return new r(e.x+(e.w>>1),e.y+(e.h>>1))},copy:b,diagonalSize:function(e){return H(e.w*e.w+e.h*e.h)},fromCenter:function(e,f,a,c){a=a>>1;c=c>>1;return d(e-a,f-c,e+a,f+c)},init:d,intersect:function(e,f){var a=sa(e.x,f.x),c=sa(e.y,f.y),g=W(e.x2,f.x2),h=W(e.y2,f.y2);a=d(a,c,g,h);return a.w>0&&a.h>0?a:null},toString:function(e){return e?
"["+e.x+", "+e.y+", "+e.x2+", "+e.y2+"]":""},union:function(e,f){if(e.w===0||e.h===0)return b(f);else if(f.w===0||f.h===0)return b(e);else{var a=W(e.x,f.x),c=W(e.y,f.y),g=sa(e.x2,f.x2),h=sa(e.y2,f.y2);a=d(a,c,g,h);return a.w>0&&a.h>0?a:null}}}}();Hits=function(){return{diffHits:function(b,d){var e=[],f={},a;for(a=d.length;a--;)f[d[a].target.id]=true;for(a=b.length;a--;)f[b[a].target.id]||(e[e.length]=b[a]);return e},init:function(b,d,e,f){return{type:b,x:f.x|0,y:f.y|0,elements:[],absXY:d,relXY:e}},
initHit:function(b,d,e){return{type:b,target:d,drag:e}},triggerEvent:function(b,d,e,f){d.triggerCustom(b.type+(e?e:"Hit"),{hitType:b.type},f?f:b.elements,b.absXY,b.relXY,new r(b.x,b.y))}}}();var vb=function(b){function d(a,c){var g=e[a],h;g||(g=e[a]=[]);(h=g[c])||(h=g[c]=[]);return h}b=b||128;var e=[],f={};return{insert:function(a,c,g){var h=a.x/b|0,i=a.y/b|0,n=(a.x+a.w)/b|0;a=(a.y+a.h)/b|0;g=g||c.id||COG.objId("spatial");f[g]=c;for(c=h;c<=n;c++)for(h=i;h<=a;h++)d(c,h).push(g)},remove:function(a,
c,g){g=g||c.id;if(f[g]){var h=a.x/b|0;c=a.y/b|0;var i=(a.x+a.w)/b|0;a=(a.y+a.h)/b|0;delete f[g];for(h=h;h<=i;h++)for(var n=c;n<=a;n++){var o=d(h,n),F=P.call(o,g);F>=0&&o.splice(F,1)}}},search:function(a){var c=a.y/b|0,g=(a.x+a.w)/b|0,h=(a.y+a.h)/b|0,i=[],n=[];for(a=a.x/b|0;a<=g;a++)for(var o=c;o<=h;o++)i=i.concat(d(a,o));i.sort();for(c=i.length;c--;){g=i[c];if(h=f[g])n[n.length]=h;for(;c>0&&i[c-1]==g;)c--}return n}}},Wb=3E4,wb={},Xb=0;(new Date).getTime();var Pa={},Ua=[];T.prototype={constructor:T,
load:function(b){var d=this;z(this.url,function(e){d.loaded=true;d.image=e;b&&b()})}};var cc=function(){return COG.observable({applyStyle:function(){},applyTransform:function(b,d,e){return{restore:null,x:d,y:e}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getOffset:function(){return new r},getViewport:function(){},hitTest:function(){return false},prepare:function(){},projectXY:null,render:function(){},reset:function(){}})},Bb={},Wa=E.registerRenderer=function(b,d){Bb[b]=
d},dc=E.attachRenderer=function(b,d,e,f){b=b.split("/");for(var a=new cc(d,e,f),c=0;c<b.length;c++){var g=Bb[b[c]];if(g)a=new g(d,e,f,a)}return a};Wa("canvas",function(b,d,e,f){function a(A,ba,R){var ca,$;G[ba]=function(N){for(ca=ma.length;ca--;)if($=R[ma[ca]])N[ja[ca]]=$}}function c(A,ba,R,ca){var $=false;if(ba)$=o.isPointInPath(D?ba.x-F:ba.relXY.x,D?ba.y-I:ba.relXY.y);return{draw:ca||X,viewport:A,state:R,hit:$,vpX:F,vpY:I,context:o}}e=COG.extend({},e);var g,h,i,n=false,o,F=0,I=0,G={},t=null,D=CANI.canvas.pipTransformed,
C={},K=function(){},X=function(){this.fill&&o.fill();this.stroke&&o.stroke()},ma=["fill","stroke","lineWidth","opacity"],ja=["fillStyle","strokeStyle","lineWidth","globalAlpha"];(function(){if(d){var A=d.tagName=="CANVAS",ba=A?d.parentNode:d;g=b.width=ba.offsetWidth;h=b.height=ba.offsetHeight;if(A){i=d;i.width=g;i.height=h;cb&&FlashCanvas.initElement(i)}else{i=bc(g,h);i.style.cssText="position: absolute; z-index: 1;";n=true;d.appendChild(i)}o=null}})();e=COG.extend(f,{applyStyle:function(A){var ba=
G[A],R=o&&o.canvas?o.canvas.id:"default",ca;C[R]||(C[R]=[]);ca=C[R].pop()||"basic";if(ba){C[R].push(A);ba(o);return ca}},applyTransform:function(A){if(A.translateX!==0||A.translateY!==0||A.scaling!==1||A.rotation!==0){o.save();t={undo:function(){o.restore();t=null},x:A.xy.x,y:A.xy.y};o.translate(A.xy.x-F+A.translateX,A.xy.y-I+A.translateY);A.rotation!==0&&o.rotate(A.rotation);A.scaling!==1&&o.scale(A.scaling,A.scaling)}return t},drawTiles:function(A,ba){for(var R,ca,$=F-256,N=I-256,Y=A.x2,ta=A.y2,
wa=ba.length;wa--;){R=ba[wa];if(ca=R.x>=$&&R.x<=Y&&R.y>=N&&R.y<=ta)R.loaded?o.drawImage(R.image,R.x-F,R.y-I):R.load(b.invalidate)}},prepare:function(A,ba){var R,ca=false,$=ba.scaled||ba,N=ba.scaleFactor;if(o)o.restore();else o=i.getContext("2d");for(R=A.length;R--;)ca=ca||A[R].clip;F=$.x;I=$.y;if(o){ca||o.clearRect(0,0,g,h);o.save();o.scale(N,N)}o.globalCompositeOperation="source-over";return o},prepArc:function(A,ba,R,ca){o.beginPath();o.arc(A.xy.x-(t?t.x:F),A.xy.y-(t?t.y:I),A.size>>1,A.startAngle,
A.endAngle,false);return c(ba,R,ca)},prepImage:function(A,ba,R,ca,$){var N=($.x||A.xy.x)-(t?t.x:F),Y=($.y||A.xy.y)-(t?t.y:I),ta=$.image||A.image;if(ta){o.beginPath();o.rect(N,Y,$.width||ta.width,$.height||ta.height);return c(ba,R,ca,function(){o.drawImage(ta,N,Y,$.width||ta.width,$.height||ta.height)})}},prepMarker:function(A,ba,R,ca){var $=A.xy.x-(t?t.x:F),N=A.xy.y-(t?t.y:I),Y=A.size,ta=undefined;o.beginPath();switch(A.markerStyle.toLowerCase()){case "image":ta=K;o.rect($-(Y>>1),N-(Y>>1),Y,Y);if(A.reset&&
A.image){A.image=null;A.reset=false}A.image?o.drawImage(A.image,$-(Y>>1),N-(Y>>1),Y,Y):z(A.imageUrl,function(wa){A.image=wa;o.drawImage(A.image,$-(Y>>1),N-(Y>>1),Y,Y)});break;default:o.moveTo($,N);o.lineTo($-(Y>>1),N-Y);o.lineTo($+(Y>>1),N-Y);o.lineTo($,N);break}return c(ba,R,ca,ta)},prepPoly:function(A,ba,R,ca,$){var N=true;A=$.points||A.points;$=t?t.x:F;var Y=t?t.y:I;o.beginPath();for(var ta=A.length;ta--;){var wa=A[ta].x-$,eb=A[ta].y-Y;if(N){o.moveTo(wa,eb);N=false}else o.lineTo(wa,eb)}return c(ba,
R,ca)},getContext:function(){return o},getDimensions:function(){return{width:g,height:h}},getOffset:function(){return new r(F,I)}});(function(){for(var A in T5.styles)a(null,A,T5.styles[A]);T5.bind("styleDefined",a)})();e.bind("detach",function(){n&&d.removeChild(i)});return e});var jb=E.styles={},ec=E.defineStyle=function(b,d){jb[b]=d;E.trigger("styleDefined",b,jb[b]);return b},Cb=E.defineStyles=function(b){for(var d in b)ec(d,b[d])};E.getStyle=function(b){return jb[b]};E.loadStyles=function(b){COG.jsonp(b,
function(d){Cb(d)})};Cb({basic:{fill:"#ffffff"},highlight:{fill:"#ff0000"},waypoints:{lineWidth:4,stroke:"#003377",fill:"#ffffff"},waypointsHover:{lineWidth:4,stroke:"#ff0000",fill:"#ffffff"}});var Yb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Lb=function(b){function d(q,u,y){if(!wa){ca(pa-u,qa-y);aa.trigger("pan",pa,qa)}}function e(q,u,y,S){A(W(sa(va+za(2,S)-1,0.5),2))}function f(){var q=U(va)/Math.LN2|0;if(q!==0){va=za(2,q);ba($a+q,fc,gc)}redraw=true}function a(q,u){var y=renderer&&
renderer.projectXY?renderer.projectXY(q,u):null;if(!y){y=aa.getViewport();var S=1/va;y=new r(y?y.x+q*S:q,y?y.y+u*S:u)}return y}function c(q,u,y){R("doubleTap",u,y,a(y.x,y.y));b.scalable&&A(2,a(y.x,y.y),b.zoomEasing,null,b.zoomDuration)}function g(q,u,y){wa=null;K("down",u,y)}function h(q,u,y){K("hover",u,y)}function i(q,u,y){D(u,y,false)}function n(q,u,y){D(u,y,true)}function o(){clearTimeout(Db);Db=setTimeout(function(){renderer.checkSize()},250)}function F(q,u,y){K("tap",u,y);R("tap",u,y,a(y.x,
y.y,true))}function I(q){renderer=dc(q||b.renderer,aa,ta,b);Eb=!renderer.preventPartialScale;t()}function G(q,u){u.id=q;u.added=Z();u.view=aa;u.trigger("parentChange",aa,ta,hc);N.push(u);N.sort(function(y,S){var da=S.zindex-y.zindex;if(da===0)da=S.added-y.added;return da});Y=N.length;return u}function t(){Ea&&Ea.unbind();if(renderer){Ea=INTERACT.watch(renderer.interactTarget||ta);b.pannable&&Ea.pannable().bind("pan",d);if(b.scalable){Ea.bind("zoom",e);Ea.bind("doubleTap",c)}Ea.bind("pointerDown",
g);Ea.bind("pointerMove",i);Ea.bind("pointerUp",n);b.captureHover&&Ea.bind("pointerHover",h);Ea.bind("tap",F)}}function D(q,u,y){if(wa){q=a(u.x,u.y);wa.drag.call(wa.target,wa,q.x,q.y,y)&&Ia++;if(y)wa=null}}function C(q){var u,y,S=false;q=q||(new Date).getTime();if(S=q-Fb>ic){var da=x(pa-kb),Ba=x(qa-lb);u=pa!==mb||qa!==nb;y=va!==Gb;if(u||y)Ia++;if(da>=Hb||Ba>=Hb)ja();y={index:eb++,draw:Ia};aa.trigger("enterFrame",q,y);Fb=q}if(renderer&&S&&y.draw){Ka=Ib|(va!==1?Jb:0)|(u?ob:0)|(pb?Kb:0);qb=(u=(Ka&(Jb|
ob))!==0)&&(Ka&Kb)===0;u=ma();renderer.trigger("predraw",u,Ka);if(renderer.prepare(N,u,Ka,q,Fa)){Ia=0;for(ii=Y;ii--;){S=N[ii];if(S.visible&&(Ka&S.validStates)!==0){y=S.style?renderer.applyStyle(S.style,true):null;S.draw(renderer,u,Ka,aa,q,Fa);y&&renderer.applyStyle(y)}}renderer.render(u);aa.trigger("drawComplete",u,q);mb=pa;nb=qa;Gb=va}if(Fa){q=Fa?Fa.elements:[];if(ab&&ab.type==="hover"){u=Hits.diffHits(ab.elements,q);u.length>0&&Hits.triggerEvent(ab,aa,"Out",u)}if(q.length>0){S=Fa.x;y=Fa.y;for(u=
q.length;u--;){da=q[u];Ba=S;var La=y,Ja=da&&da.drag&&(!da.canDrag||da.canDrag(da,Ba,La));if(Ja){wa=da;wa.startX=Ba;wa.startY=La}if(Ja)break}Hits.triggerEvent(Fa,aa)}ab=q.length>0?COG.extend({},Fa):null;Fa=null}}animFrame(C)}function K(q,u,y){Fa=Hits.init(q,u,y,a(y.x,y.y,true));for(q=Y;q--;)rb=rb||(N[q].hitGuess?N[q].hitGuess(Fa.x,Fa.y,Ka,aa):false);rb&&Ia++}function X(){Ia++}function ma(){var q=new k(pa,qa,aa.width,aa.height);q.scaleFactor=va;if(va!==1)q.scaled=Va.fromCenter(pa+(aa.width>>1),qa+(aa.height>>
1),aa.width/va|0,aa.height/va|0);return q}function ja(){var q=ma();if(q){if(Xa||Ya)if(q){var u=fb?pa+(q.w>>1):pa,y=gb?qa+(q.h>>1):qa,S=q.w,da=q.h;if(Xa&&Xa>S)if(u+S>Xa)pa=fb?pa:Xa-S;else if(u<0)pa=fb?pa:0;if(Ya&&Ya>da)if(y+da>Ya)qa=gb?qa:Ya-da;else if(y<0)qa=gb?qa:0}kb=pa;lb=qa;R("refresh",aa,q);Ia++}}function A(q,u,y,S,da){var Ba;if(!Eb){y=false;Ba=V(U(q)/Math.LN2);q=za(2,Ba)}if(y)COG.tweenValue(va,q,y,da,function(La,Ja){va=La;if(Ja){Ba=V(U(va)/Math.LN2);va=za(2,Ba);S&&S()}f()});else{va=q;f()}return aa}
function ba(q,u,y){q=sa(b.minZoom,W(b.maxZoom,q));if(q!==$a){var S=za(2,q-$a),da=aa.width>>1,Ba=aa.height>>1,La=da/S|0,Ja=Ba/S|0;$a=q;ca(((u?u:pa+da)-La)*S,((y?y:qa+Ba)-Ja)*S);mb=pa;nb=qa;lb=kb=0;R("zoomLevelChange",q);va=1;renderer.reset();ja()}}function R(){for(var q=aa.trigger.apply(null,arguments).cancel,u=N.length;u--;)q=N[u].trigger.apply(null,arguments).cancel||q;return!q}function ca(q,u,y,S,da){function Ba(){La+=1;if(La>=2){pb=false;da&&da()}}var La=0;if(y){if((Ka&ob)===0){COG.tweenValue(pa,
q,y,S,function(Ja,sb){pa=Ja|0;(sb?Ba:X)();return!qb});COG.tweenValue(qa,u,y,S,function(Ja,sb){qa=Ja|0;(sb?Ba:X)();return!qb});pb=true}}else{pa=q|0;qa=u|0;da&&da()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,inertia:true,refreshDistance:256,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,renderer:"canvas",
zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var $={},N=[],Y=0,ta=document.getElementById(b.container),wa=null,eb=0,hc=null,jc=!v(window.attachEvent,ya),rb=false,Hb=b.refreshDistance,pa=0,qa=0,kb=0,lb=0,mb=0,nb=0,Xa=null,Ya=null,fb=false,gb=false,Fa=null,qb=false,ab=null,Db=0,va=1,Gb=1,Fb=0,Ea=null,Eb=true,pb=false,ic=1E3/b.fps|0,Ia=0,fc,gc,$a=b.zoomLevel,Ib=ka("ACTIVE"),ob=ka("PAN"),Jb=ka("ZOOM"),Kb=ka("ANIMATING"),Ka=Ib,aa={id:b.id,detach:function(){renderer&&renderer.trigger("detach");
Ea&&Ea.unbind()},eachLayer:function(q){for(var u=Y;u--;)q(N[u])},getLayer:function(q){for(var u=0;u<Y;u++)if(N[u].id===q)return N[u];return null},getZoomLevel:function(){return $a},setLayer:function(q,u){for(var y=0;y<Y;y++)if(N[y].id===q){N.splice(y,1);break}if(u){G(q,u);u.trigger("refresh",aa,ma());aa.trigger("layerChange",aa,u)}Ia++;return u},invalidate:X,refresh:ja,resetScale:function(){va=1},scale:A,setZoomLevel:ba,syncXY:function(){},triggerAll:R,removeLayer:function(q){a:{for(var u=Y;u--;)if(N[u].id===
q){q=u;break a}q=-1}if(q>=0&&q<Y){aa.trigger("layerRemove",aa,N[q]);N.splice(q,1);Ia++}Y=N.length},getOffset:function(){return new r(pa,qa)},getRenderer:function(){return renderer},getScaleFactor:function(){return va},setMaxOffset:function(q,u,y,S){Xa=q;Ya=u;fb=y;gb=S},getViewport:ma,updateOffset:ca,pan:function(q,u,y,S,da){ca(pa+q,qa+u,y,S,da)}};COG.observable(aa);aa.bind("resync",function(){});COG.configurable(aa,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom",
"maxZoom","renderer","zoom"],COG.paramTweaker(b,null,{container:function(q,u){ta=document.getElementById(u);I()},inertia:t,captureHover:t,scalable:t,pannable:t,renderer:function(q,u){if(renderer){renderer.trigger("detach");renderer=null}I(u);Ia++}}),true);CANI.init(function(q){aa.markers=G("markers",new hb({zindex:20}));$=q;I();jc?window.attachEvent("onresize",o):window.addEventListener("resize",o,false)});animFrame(C);return aa},Ga=function(b){b=COG.extend({style:null,xy:null,size:10,fill:false,
stroke:true,draggable:false,observable:true,properties:{},typeName:"Shape"},b);COG.extend(this,b);this.id=COG.objId(this.typeName);this.view=this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};Ga.prototype={constructor:Ga,animate:function(b,d,e,f){j(this,b,d,e,f)},drag:null,draw:null,getProps:null,resync:function(b){if(this.xy){b.syncXY([this.xy]);this.size&&this.updateBounds(Va.fromCenter(this.xy.x,this.xy.y,this.size,
this.size))}},rotate:function(b){this.rotation=b},scale:function(b){this.scaling=b},translate:function(b,d){this.translateX=b;this.translateY=d},updateBounds:function(b,d){b&&(!this.bounds||b.x!=this.bounds.x||b.y!=this.bounds.y)&&this.trigger("move",this,b,this.bounds);this.bounds=b;if(d)this.xy=Va.center(this.bounds)}};var Zb=1E3/60|0,Za=[],xb=0;m.prototype=COG.extend(Ga.prototype,{constructor:m});w.prototype=COG.extend({},Ga.prototype,{constructor:w});O.prototype=COG.extend({},w.prototype);L.prototype=
COG.extend({},Ga.prototype,{constructor:L});na.prototype=COG.extend({},L.prototype,{constructor:na});ra.prototype=COG.extend(Ga.prototype,{constructor:ra});J.prototype={constructor:J,clip:null,cycle:function(){},draw:function(){},hitGuess:null};Wa=function(b,d){function e(h,i){var n=i&&i.getZoomLevel?i.getZoomLevel():0;c[n]||(c[n]=l(n));a=c[n]}d=COG.extend({imageLoadArgs:{}},d);var f=b?Ab.init(b,d).run:null,a=null,c=[],g=COG.extend(new J(d),{draw:function(h,i){h.drawTiles(i,a.search(Va.buffer(i,128)))}});
g.bind("refresh",function(h,i,n){var o=(new Date).getTime();a&&f(i,n,a,function(){i.invalidate();COG.info("GEN COMPLETED IN "+((new Date).getTime()-o)+" ms")})});g.bind("parentChange",e);g.bind("resync",e);return g};var Mb=function(b){function d(n,o,F,I){var G=this.dragOffset;if(!G)G=this.dragOffset=new r(n.startX-this.xy.x,n.startY-this.xy.y);this.xy.x=o-G.x;this.xy.y=F-G.y;if(I){delete this.dragOffset;if(n=i.view){n.syncXY([this.xy],true);n.invalidate()}this.trigger("dragDrop")}return true}function e(n){clearTimeout(h);
h=setTimeout(function(){c.sort(function(o,F){if(F.xy&&o.xy){var I=F.xy.y-o.xy.y;return I!=0?I:F.xy.x-o.xy.x}});n&&n.invalidate()},50)}function f(n,o,F,I){I&&g.remove(I,o);g.insert(F,o)}function a(n,o){g=l(o.getZoomLevel());for(var F=c.length;F--;)c[F].resync(o)}b=COG.extend({zindex:10},b);var c=[],g,h=0,i=COG.extend(new J(b),{itemCount:0,add:function(n,o){if(n){n.layer=i;if(o)c.unshift(n);else c[c.length]=n;var F=i.view;if(F){n.resync(F);g&&n.bounds&&g.insert(n.bounds,n);e(F)}n.bind("move",f)}i.itemCount=
c.length},clear:function(){g=new vb;c=[];i.itemCount=0},draw:function(n,o,F,I,G,t){I={};G=g&&o?g.search(o):[];for(var D=G.length;D--;){var C=G[D],K=C.style||i.style,X,ma=n.applyTransform(C),ja=C.getProps?C.getProps(n,F):I;if(ja=(X=n["prep"+C.typeName])?X.call(n,C,o,t,F,ja):null){if(t&&ja.hit){t.elements.push(Hits.initHit(C.type,C,C.draggable?d:null));X=t.type+"Style";K=C[X]||i[X]||K}K=K?n.applyStyle(K,true):null;(X=C.draw||ja.draw)&&X.call(C,ja);K&&n.applyStyle(K)}ma&&ma.undo&&ma.undo()}},find:function(){return[].concat(c)},
hitGuess:function(n,o){return g&&g.search({x:n-10,y:o-10,w:20,h:20}).length>0}});i.bind("parentChange",a);i.bind("resync",a);return i},hb=function(b){return new Mb(b)};COG.extend(E,{ex:COG.extend,is:v,ticks:Z,userMessage:function(b,d,e){E.trigger("userMessage",b,d,e)},indexOf:P,Rect:k,XY:Qa,XYRect:Va,Vector:ib,Hits:Hits,Generator:Ab,tweenValue:COG.tweenValue,easing:COG.easing,Tile:T,TileLayer:Wa,getImage:z,viewState:ka,View:Lb,ViewLayer:J,ImageLayer:Wa,Drawable:Ga,Marker:m,Poly:w,Line:O,Arc:ra,ImageDrawable:L,
ImageMarker:na,DrawLayer:Mb,ShapeLayer:hb});var tb=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],Ha=Math.PI/180,Oa=180/Math.PI,ub=ia,Nb=-ub,Ob=Q,kc=-Ob,db=0.08181919084262157,bb=null,Pb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ha=function(){function b(a){return a?e(a.lat,a.lon):null}function d(a){return!a||a.lat===0&&a.lon===0}function e(a,c){return{lat:parseFloat(a?a:0),lon:parseFloat(c?c:
0)}}function f(a){if(a)if(v(a.lat,zb))return b(a);else{if(a.split)for(var c=[" ",","],g=0;g<c.length;g++){var h=a.split(c[g]);if(h.length===2)return e(h[0],h[1])}}else return e();return null}return{calcDistance:function(a,c){if(d(a)||d(c))return 0;var g=(c.lat-a.lat)*Ha>>1,h=(c.lon-a.lon)*Ha>>1;g=oa(g)*oa(g)+Aa(a.lat*Ha)*Aa(c.lat*Ha)*oa(h)*oa(h);return 6371*2*$b(H(g),H(1-g))},copy:b,empty:d,equal:function(a,c){return a&&c&&a.lat==c.lat&&a.lon==c.lon},fromMercatorPixels:function(a,c){for(var g=za(Math.E,
-c),h=ia-2*Ta(g),i=fa(h,g),n=0;n<12&&x(h-i)>1.0E-7;){h=i;i=fa(h,g);n++}return e(i*Oa,a%360*Oa)},generalize:function(a,c,g){var h=a.length,i=[],n=null;g||(g=250);g/=1E3;COG.info("generalizing positions, must include "+c.length+" positions");for(var o=h;o--;)if(o===0)i.unshift(a[o]);else{var F=!n||ha.inArray(a[o],c)?g:ha.calcDistance(n,a[o]);if(a[o]&&F>=g){i.unshift(a[o]);n=a[o]}}COG.info("generalized "+h+" positions into "+i.length+" positions");return i},inArray:function(a,c){for(var g=ha.equal,h=
c.length;h--;)if(g(a,c[h]))return true;return false},inBounds:function(a,c){var g=!(ha.empty(a)||ha.empty(c));return g=(g=g&&a.lat>=c.min.lat&&a.lat<=c.max.lat)&&a.lon>=c.min.lon&&a.lon<=c.max.lon},init:e,offset:function(a,c,g){var h=a.lat*Ha;a=a.lon*Ha;c=h+c/6371;g=Da(oa(g/6371)/Aa(h));g=a+g;c=(c+ia)%Math.PI-ia;g%=Q;return e(c*Oa,g*Oa)},parse:f,parseArray:function(a){var c=a.length,g=Array(c);for(c=c;c--;)g[c]=f(a[c]);return g},toMercatorPixels:function(a){return T5.XY.init(parseFloat(a.lon)*Ha,
xa(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,c){function g(){for(var o=0,F=c.chunkSize,I=h;I--;){i[I]=T5.GeoXY.init(a[I]);o+=1;if(o>F)break}h=I;if(h<=0)c.callback&&c.callback(i);else animFrame(g)}var h=a.length,i=Array(h);c=COG.extend({chunkSize:500,async:true,callback:null},c);if(!c.async){for(var n=h;n--;)i[n]=T5.GeoXY.init(a[n]);return i}animFrame(g);return null}}}(),Ma=function(){function b(a,c,g){var h=new r(0,c.lat-a.lat);h.x=(g||v(g,ya))&&a.lon>c.lon?360-
a.lon+c.lon:c.lon-a.lon;return h}function d(a,c){return Ma.init(ha.init(a.min.lat-c,a.min.lon-c%360),ha.init(a.max.lat+c,a.max.lon+c%360))}function e(a){var c=b(a.min,a.max);return ha.init(a.min.lat+(c.y>>1),a.min.lon+(c.x>>1))}function f(a,c){return{min:ha.parse(a),max:ha.parse(c)}}return{calcSize:b,createBoundsFromCenter:function(a,c){var g=c/6371,h=a.lat*Ha,i=a.lon*Ha,n=h-g,o=h+g;if(n>Nb&&o<ub){h=Da(oa(g)/Aa(h));g=(i-h)%Q;i=(i+h)%Q}else{n=sa(n,Nb);o=W(o,ub);g=kc;i=Ob}return Ma.init(ha.init(n*Oa,
g*Oa),ha.init(o*Oa,i*Oa))},expand:d,forPositions:function(a,c){var g=null,h=T5.ticks();c||(c="auto");for(var i=a.length;i--;)if(g){var n=b(g.min,a[i],false),o=b(a[i],g.max,false);if(n.x<0)g.min.lon=a[i].lon;if(n.y<0)g.min.lat=a[i].lat;if(o.x<0)g.max.lon=a[i].lon;if(o.y<0)g.max.lat=a[i].lat}else g=f(a[i],a[i]);if(c){if(c=="auto"){i=b(g.min,g.max);c=sa(i.x,i.y)*0.3}g=d(g,c)}COG.trace("calculated bounds for "+a.length+" positions",h);return g},getCenter:e,getGeoHash:function(a){var c=T5.Geo.GeoHash.encode(a.min.lat,
a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+c+", max hash = "+a)},getZoomLevel:function(a,c){var g=e(a);g=W(V(x(g.lat)*0.05),tb.length);var h=tb[g],i=b(a.min,a.max);g=M(U(tb[3]*c.h/i.y)/U(2));h=M(U(h*c.w/i.x)/U(2));return W(isNaN(g)?1E3:g,isNaN(h)?1E3:h)},init:f,isEmpty:function(a){return!a||ha.empty(a.min)||ha.empty(a.max)},toString:function(a){return"min: "+ha.toString(a.min)+", max: "+ha.toString(a.max)}}}();ib=function(){var b=/^(\d+).*$/,d=/(\d+)\s?\-\s?(\d+)/;
return{buildingMatch:function(e,f){b.lastIndex=-1;if(b.test(e))for(var a=e.replace(b,"$1"),c=f.split(","),g=0;g<c.length;g++){d.lastIndex=-1;if(d.test(c[g])){var h=d.exec(c[g]);if(a>=parseInt(h[1],10)&&a<=parseInt(h[2],10))return true}else if(a==c[g])return true}return false},normalize:function(e){if(!e)return"";e=e.toUpperCase();if(!bb){var f=[];for(var a in Pb)f.push(a);bb=RegExp("(\\s)("+f.join("|")+")(\\s|$)","i")}bb.lastIndex=-1;if(f=bb.exec(e))e=e.replace(bb,"$1"+Pb[f[2]]);return e},toString:function(e){return e.streetDetails+
" "+e.location}}}();var Na=E.GeoXY=function(){function b(f,a){if(f.length){for(var c,g,h,i,n=f.length;n--;){b(f[n],a);c=v(c,ya)||f.x<c?f.x:c;g=v(g,ya)||f.y<g?f.y:g;h=v(h,ya)||f.x>h?f.x:h;i=v(i,ya)||f.y>i?f.y:i}return new k(c,g,h-c,i-g)}else if(f.mercXY){c=f.mercXY;f.x=(c.x+Math.PI)/a|0;f.y=(Math.PI-c.y)/a|0;f.rpp=a}return f}function d(f,a){if(f.length)for(var c=f.length;c--;)d(f[c],a);else{f.mercXY=new r(f.x*a-Math.PI,Math.PI-f.y*a);f.pos=ha.fromMercatorPixels(f.mercXY.x,f.mercXY.y)}return f}function e(f,
a,c){f.pos=a;f.mercXY=ha.toMercatorPixels(a);(c=v(c,zb)?c:f.rpp)&&b(f,c)}return{init:function(f,a){var c=new r;e(c,f,a);return c},sync:b,syncPos:d,toPos:function(f,a){a=a||f.rpp;return ha.fromMercatorPixels(f.x*a-Math.PI,Math.PI-f.y*a)},updatePos:e}}(),Ra={};Wa=function(){return{bestResults:function(b,d){d||(d=20);for(var e=b.length>0?b[0]:null,f=[],a=0;a<b.length;a++)if(e&&b[a]&&e.matchWeight-b[a].matchWeight<=d)f.push(b[a]);else break;return f}}}();var Qb=function(b){b=COG.extend({id:null,caption:"",
resultType:"",data:null,pos:null,matchWeight:0},b);return COG.extend(b,{toString:function(){return b.caption+(b.matchWeight?" ("+b.matchWeight+")":"")}})},lc=function(){function b(a,c){var g=new T5.ShapeLayer;c.geometry&&ha.vectorize(c.geometry,{callback:function(h){g.add(new T5.Line(h,{style:"waypoints",simplify:true}));a.setLayer("route",g)}})}function d(a){for(var c=e.Unknown,g=f,h=0;h<g.length;h++){g[h].regex.lastIndex=-1;var i=g[h].regex.exec(a);if(i){c=g[h].customCheck?g[h].customCheck(a,i):
g[h].turnType;break}}return c}var e={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},f=function(){var a=[];a.push({regex:/continue/i,turnType:e.Continue});
a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(c,g){return/bear/i.test(g[1])?e.TurnLeftSlight:e.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(c,g){return/bear/i.test(g[1])?e.TurnRightSlight:e.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:e.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:e.Ramp});a.push({regex:/take.*?exit/i,turnType:e.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(c,g){return/right/i.test(g[1])?
e.UTurnRight:e.UTurnLeft}});a.push({regex:/proceed/i,turnType:e.Start});a.push({regex:/arrive/i,turnType:e.Arrive});a.push({regex:/fell\sthrough/i,turnType:e.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var c=la("route");c&&c.route(a,function(g){if(a.generalize)g.geometry=ha.generalize(g.geometry,g.getInstructionPositions());if(a.map){b(a.map,g);a.autoFit&&a.map.gotoBounds(g.boundingBox)}a.success&&
a.success(g)})},createMapOverlay:b,parseTurnType:d,TurnType:e,Instruction:function(a){var c=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),g=a.description;g=g.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");c.description=g;if(!a.turnType)a.turnType=d(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Ma.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var c=
[],g=0;g<a.instructions.length;g++)a.instructions[g].position&&c.push(a.instructions[g].position);return c}},a)}}}(),mc="featurecollection",nc="feature",yb={async:false},Sa={processor:null,group:"shapes",layerClass:hb},oc={point:COG.extend({},Sa,{processor:function(b,d,e,f){d=ga([d.coordinates],yb);if(d.length>0)if(e=f.marker(d[0],e)){b.add(e);return d.length}},group:"markers",layerClass:hb}),linestring:COG.extend({},Sa,{processor:function(b,d,e,f){d=ga(d&&d.coordinates?d.coordinates:[]);return ea(b,
d,e,f.line)}}),multilinestring:COG.extend({},Sa,{processor:function(b,d,e,f){d=d&&d.coordinates?d.coordinates:[];for(var a=0,c=d.length;c--;)a+=ea(b,d[c],e,f.line);return a}}),polygon:COG.extend({},Sa,{processor:function(b,d,e,f){d=d&&d.coordinates?d.coordinates:[];if(d.length>0)return ea(b,d[0],e,f.poly);return 0}}),multipolygon:COG.extend({},Sa,{processor:function(b,d,e,f){d=d&&d.coordinates?d.coordinates:[];for(var a=0,c=0;c<d.length;c++)a+=ea(b,d[c][0],e,f.poly);return a}})},Rb=function(b,d,e,
f){function a(D,C){var K=D.processor,X=n+D.group,ma=COG.extend({},D,e,{properties:C.properties});if(K){var ja=t[X];if(!ja){ja=new D.layerClass({id:X});t[X]=ja}return K(ja,C.data,ma,f)}return 0}function c(D,C){var K=D&&D.type?D.type.toLowerCase():null;return K&&K===nc?c(D.geometry,D.properties):{type:K,isCollection:K?K===mc:false,definition:oc[K],data:D,properties:C?C:D.properties}}function g(D){var C=0,K=COG.extend({},e),X=o;D=D?D:(new Date).getTime();if(!I){for(;X<F;X++){D=c(i?i(b[X]):b[X]);var ma=
null;if(D.isCollection){K.layerPrefix=n+G++ +"-";I=new Rb(D.data.features,function(ja){I=null;for(var A in ja)t[A]=ja[A];o>=F&&d&&d(t)},K);ma+=1}else if(D.definition)ma=a(D.definition,D);C+=ma?ma:1;if(C>=h)break}o=X+1;if(I||o<F)animFrame(g);else d&&d(t)}}e=COG.extend({rowPreParse:null,simplify:false,layerPrefix:"geojson-"},e);f=COG.extend({marker:function(D){return new m({xy:D})},line:function(D,C){return new w(D,COG.extend({},e,C))},poly:function(D,C){return new w(D,COG.extend({fill:true},e,C))}},
f);var h=500,i=e.rowPreParse,n=e.layerPrefix,o=0,F=0,I=null,G=0,t={};if(b){v(b,"array")||(b=[b]);F=b.length;animFrame(g)}};Sa=E.GeoJSON={parse:function(b,d,e){return new Rb(b,d,e)}};E.Map=function(b){function d(t){try{var D=ha.init(t.coords.latitude,t.coords.longitude),C=t.coords.accuracy/1E3;G.trigger("locationUpdate",t,C);if(o){if(!i){i=new UI.LocationOverlay({pos:D,accuracy:C});i.update(G.getTileLayer());G.setLayer("location",i)}var K=Ma.createBoundsFromCenter(D,Math.max(C,1));G.gotoBounds(K)}else{i.pos=
D;i.accuracy=C;i.update(G.getTileLayer());a(D,null,COG.easing("sine.out"))}o=false}catch(X){COG.exception(X)}}function e(t){COG.info("caught location tracking error:",t)}function f(t,D,C){G.setZoomLevel(D);a(t,C)}function a(t,D,C,K){t=Na.init(t,ua(G.getZoomLevel()));G.updateOffset(t.x-(G.width>>1),t.y-(G.height>>1),C,K,function(){D&&D(G)})}b=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,minZoom:1,maxZoom:18,pannable:true,scalable:true},b);var c={NONE:0,SINGLE:1,WATCH:2},g=new r,h=c.NONE,i=
null,n=0,o=true,F=0,I=b.tapExtent;b.adjustScaleFactor=function(t){return Math.pow(2,(t<1?Math.floor:Math.ceil)(Math.log(t)))};var G=COG.extend(new Lb(b),{getBoundingBox:function(){var t=G.getViewport();return t?Ma.init(Na.toPos(new r(t.x,t.y2),F),Na.toPos(new r(t.x2,t.y),F)):null},getCenterPosition:function(){var t=G.getViewport();if(t){t=new r(t.x+(t.w>>1),t.y+(t.h>>1));return Na.toPos(t,F)}return null},gotoBounds:function(t,D){var C=Ma.getZoomLevel(t,G.getViewport());f(Ma.getCenter(t),C,D)},gotoPosition:f,
panToPosition:a,syncXY:function(t,D){return(D?Na.syncPos:Na.sync)(t,F)},locate:function(){G.trackStart(c.SINGLE);setTimeout(G.trackCancel,1E4)},trackStart:function(t){if(navigator.geolocation&&!n){h=t?t:c.WATCH;o=true;n=navigator.geolocation.watchPosition(d,e,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){n&&navigator.geolocation&&navigator.geolocation.clearWatch(n);G.removeLayer("location");i=null;h=c.NONE;n=0},animateRoute:function(t,D,C,K){var X=G.getLayer("route");
if(X)(t=X.getAnimation(t,D,C,K))&&t.addToView(G)}});G.bind("pan",function(){h===c.SINGLE&&G.trackCancel()});G.bind("tap",function(t,D,C,K){t=Na.toPos(K,F);var X=Na.toPos(Qa.offset(K,-I,I),F);K=Na.toPos(Qa.offset(K,I,-I),F);G.trigger("geotap",D,C,t,Ma.init(X,K))});G.bind("refresh",function(t,D,C){if(g.x!=C.x||g.y!=C.y){G.trigger("boundsChange",G.getBoundingBox());g.x=C.x;g.y=C.y}});G.bind("zoomLevelChange",function(t,D){var C;F=ua(D);C=Q/F|0;G.setMaxOffset(C,C,true,false);G.resetScale();G.triggerAll("resync",
G)});return G};E.GeoShape=function(b,d){d=COG.extend({autoParse:true},d);for(var e=Array(b.length),f=d.autoParse,a=T5.Geo.Position.parse,c=b.length;c--;)e[c]=T5.GeoXY.init(f?a(b[c]):b[c]);return new T5.Poly(e,d)};E.LocationOverlay=function(b){b=COG.extend({pos:null,accuracy:null,zindex:90},b);var d=new Image,e=T5.XY.init(),f=T5.XY.init(),a=null;d.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
d.onload=function(){e=T5.XY.init(d.width>>1,d.height>>1)};var c=COG.extend(new T5.ViewLayer(b),{pos:b.pos,accuracy:b.accuracy,drawAccuracyIndicator:false,draw:function(g,h){var i=f.x-h.x,n=f.y-h.y;if(a){g.fillStyle="rgba(30, 30, 30, 0.2)";g.beginPath();g.arc(i,n,a,0,Math.PI*2,false);g.fill()}d.complete&&d.width>0&&g.drawImage(d,i-e.x,n-e.y,d.width,d.height)},update:function(g){if(g){a=g.getPixelDistance(c.accuracy)>>1;f=g.getGridXYForPosition(c.pos)}}});c.bind("gridUpdate",function(g,h){c.update(h)});
return c};E.Geo={distanceToString:function(b){if(b>1E3)return~~(b/10)/100+" km";return b?b+" m":""},dist2rad:function(b){return b/6371},getEngine:la,radsPerPixel:ua,Position:ha,BoundingBox:Ma,Radius:function(b,d){return{distance:parseInt(b,10),uom:d}},Address:function(b){return b=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},b)},A:ib,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(b){if(!b.id)throw Error("A GEO.Engine cannot be registered without providing an id.");
var d=COG.extend({remove:function(){delete Ra[d.id]}},b);return Ra[d.id]=d},Search:Wa,GeoSearchResult:Qb,LocationSearch:function(b){function d(g,h){navigator.geolocation.clearWatch(f);f=0;if(a){clearTimeout(a);a=0}h&&h([g],b)}function e(g){COG.info("caught location tracking error:",g)}b=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},b);var f=0,a=0,c=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(g,h){if(navigator.geolocation&&!f){f=navigator.geolocation.watchPosition(function(i){var n=
ha.init(i.coords.latitude,i.coords.longitude);i=new Qb({id:1,caption:"Current Location",pos:n,accuracy:i.coords.accuracy/1E3,matchWeight:100});if(!c||i.accuracy<c.accuracy)c=i;if(!b.requiredAccuracy||c.accuracy<b.requiredAccuracy)d(c,h)},e,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(b.searchTimeout)a=setTimeout(function(){c&&d(c,h)},b.searchTimeout)}}},b))},Routing:lc,GeoJSON:Sa}})(T5);
