COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){var ka=arguments[0]||{},ta=Array.prototype.slice.call(arguments,1),J,F;for(F=ta.length;F--;)if((J=ta[F])!==null)for(var x in J){var z=J[x];if(ka!==z)if(z!==undefined)ka[x]=z}return ka};
(function(){var ka=Object.prototype.hasOwnProperty,ta=0,J={};J.toID=function(F){return F.replace(/\s/g,"-")};J.objId=function(F){return(F?F:"obj")+ta++};J.isFunction=function(F){return toString.call(F)==="[object Function]"};J.isArray=function(F){return toString.call(F)==="[object Array]"};J.isPlainObject=function(F){if(!F||toString.call(F)!=="[object Object]"||F.nodeType||F.setInterval)return false;if(F.constructor&&!ka.call(F,"constructor")&&!ka.call(F.constructor.prototype,"isPrototypeOf"))return false;
var x;for(x in F);return x===undefined||ka.call(F,x)};J.isEmptyObject=function(F){for(var x in F)return false;return true};J.isXmlDocument=function(F){return toString.call(F)==="[object Document]"};J.contains=function(F,x){var z=F,D=arguments,$=1;if(x&&module.isArray(x)){D=x;$=0}for($=$;$<D;$++)z=z&&typeof foo[D[$]]!=="undefined";return z};J.formatStr=function(F){if(arguments.length<=1)return F;for(var x=arguments.length-2,z=0;z<=x;z++)F=F.replace(RegExp("\\{"+z+"\\}","gi"),arguments[z+1]);return F};
J.wordExists=function(F,x){var z="";if(x.toString)x=x.toString();for(var D=0;D<x.length;D++)z+=!/\w/.test(x[D])?"\\"+x[D]:x[D];return RegExp("(^|\\s|\\,)"+z+"(\\,|\\s|$)","i").test(F)};COG.extend(COG,J)})();
(function(){function ka(z){return typeof console!=="undefined"?function(){console[z](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ta=window.console&&window.console.markTimeline,J=ka("error"),F=ka("info"),x=function(){return ta?function(z,D){console.markTimeline(z+(D?": "+((new Date).getTime()-D)+"ms":""))}:function(){}}();COG.extend(COG,{trace:x,debug:ka("debug"),info:F,warn:ka("warn"),error:J,exception:function(z){if(J)for(var D in z)F("ERROR DETAIL: "+
D+": "+z[D])}})})();
COG.Loopage=function(){function ka(K){return COG.extend({id:z++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},K)}function ta(K){$.push(K);J()}function J(){U&&clearTimeout(U);U=setTimeout(F,0);N=true}function F(){for(var K,ca=(new Date).getTime(),fa=D.length;$.length>0;){var ha=$.shift();for(K=fa;K--;)if(D[K].id===ha){D.splice(K,1);break}N=true;fa=D.length}if(N){E=x;for(K=fa;K--;)E=D[K].frequency<E?D[K].frequency:E}for(K=fa;K--;){ha=ca-D[K].lastTick;if(D[K].lastTick===0||ha>=D[K].frequency){D[K].execute(ca,
D[K]);D[K].lastTick=ca;D[K].single&&D[K].trigger("complete")}}U=fa?setTimeout(F,E):0}var x=6E4,z=0,D=[],$=[],U=0,E=x,N=true;return{join:function(K){var ca=new ka(K);if(ca.after>0)ca.lastTick=(new Date).getTime()+ca.after;COG.observable(ca);ca.bind("complete",function(){ta(ca.id)});D.unshift(ca);J();return ca},leave:ta}}();
(function(){function ka(J,F){var x=J.obsHandlers;x[F]||(x[F]=[]);return x[F]}var ta=0;COG.observable=function(J){if(!J)return null;if(!J.obsHandlers)J.obsHandlers={};if(!(J.bind||J.trigger||J.unbind)){J.bind=function(F,x){var z="callback"+ta++;ka(J,F).unshift({fn:x,id:z});return z};J.trigger=function(F){var x=ka(J,F),z={cancel:false,tickCount:(new Date).getTime()},D;if(!x)return null;D=Array.prototype.slice.call(arguments,1);D.unshift(z);for(var $=x.length;$--&&!z.cancel;)x[$].fn.apply(self,D);return z};
J.unbind=function(F,x){if(typeof F==="undefined")J.obsHandlers={};else for(var z=ka(J,F),D=0;z&&D<z.length;D++)if(z[D].id===x){z.splice(D,1);break}return J}}return J}})();
(function(){function ka(x,z){x[z]||(x[z]=function(D){return x.configure(z,D)})}function ta(x){x.gtConfId="configurable"+F++;x.gtConfig={};x.gtConfigFns=[];return x.gtConfig}var J={},F=0;COG.paramTweaker=function(x,z,D){return function($,U){if(typeof U!=="undefined"){if($ in x)x[$]=U;D&&$ in D&&D[$]($,U)}else return z&&$ in z?z[$]($):x[$]}};COG.configurable=function(x,z,D,$){if(x){x.gtConfId||ta(x);var U=x.gtConfId,E=x.gtConfig,N=x.gtConfigFns;J[U]=x;N.push(D);for(D=z.length;D--;){E[z[D]]=true;$&&
ka(x,z[D])}if(!x.configure)x.configure=function(K,ca){if(E[K]){for(var fa=N.length;fa--;){var ha=N[fa](K,ca);if(typeof ha!=="undefined")return ha}return J[U]}return null}}}})();
(function(){function ka(x){var z=document.createElement("script"),D=false;z.src=x;z.async=true;z.onload=z.onreadystatechange=function(){if(!D&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){D=true;z.onload=z.onreadystatechange=null;z&&z.parentNode&&z.parentNode.removeChild(z)}};J||(J=document.getElementsByTagName("head")[0]);J.appendChild(z)}var ta=0,J,F=this;COG.jsonp=function(x,z,D){x+=x.indexOf("?")>=0?"&":"?";var $="json"+ ++ta;F[$]=function(U){z(U);F[$]=null;try{delete F[$]}catch(E){}};
ka(x+(D?D:"callback")+"="+$);return $}})();
(function(){function ka(g){if(K)return E.length;K=true;try{for(var s=0;s<E.length;)if(E[s].isComplete()){E[s].triggerComplete(false);E.splice(s,1)}else{E[s].update(g);s++}}finally{K=false}E.length===0&&N.trigger("complete");return E.length}function ta(){if(!N){N=COG.Loopage.join({execute:ka,frequency:20});N.bind("complete",function(){N=null})}}var J=1.70158,F=Math.PI/2,x=Math.abs,z=Math.pow,D=Math.sin,$=Math.asin,U=Math.cos,E=[],N=null,K=false,ca={linear:function(g,s,v,A){return v*g/A+s},backin:function(g,
s,v,A){return v*(g/=A)*g*((J+1)*g-J)+s},backout:function(g,s,v,A){return v*((g=g/A-1)*g*((J+1)*g+J)+1)+s},backinout:function(g,s,v,A){return(g/=A/2)<1?v/2*g*g*(((J*=1.525)+1)*g-J)+s:v/2*((g-=2)*g*(((J*=1.525)+1)*g+J)+2)+s},bouncein:function(g,s,v,A){return v-ca.bounceout(A-g,0,v,A)+s},bounceout:function(g,s,v,A){return(g/=A)<1/2.75?v*7.5625*g*g+s:g<2/2.75?v*(7.5625*(g-=1.5/2.75)*g+0.75)+s:g<2.5/2.75?v*(7.5625*(g-=2.25/2.75)*g+0.9375)+s:v*(7.5625*(g-=2.625/2.75)*g+0.984375)+s},bounceinout:function(g,
s,v,A){return g<A/2?ca.bouncein(g*2,0,v,A)/2+s:ca.bounceout(g*2-A,0,v,A)/2+v/2+s},cubicin:function(g,s,v,A){return v*(g/=A)*g*g+s},cubicout:function(g,s,v,A){return v*((g=g/A-1)*g*g+1)+s},cubicinout:function(g,s,v,A){if((g/=A/2)<1)return v/2*g*g*g+s;return v/2*((g-=2)*g*g+2)+s},elasticin:function(g,s,v,A,S,ba){if(g==0)return s;if((g/=A)==1)return s+v;ba||(ba=A*0.3);if(!S||S<x(v)){S=v;v=ba/4}else v=ba/TWO_PI*$(v/S);return-(S*z(2,10*(g-=1))*D((g*A-v)*TWO_PI/ba))+s},elasticout:function(g,s,v,A,S,ba){var da;
if(g==0)return s;if((g/=A)==1)return s+v;ba||(ba=A*0.3);if(!S||S<x(v)){S=v;da=ba/4}else da=ba/TWO_PI*$(v/S);return S*z(2,-10*g)*D((g*A-da)*TWO_PI/ba)+v+s},elasticinout:function(g,s,v,A,S,ba){var da;if(g==0)return s;if((g/=A/2)==2)return s+v;ba||(ba=A*0.3*1.5);if(!S||S<x(v)){S=v;da=ba/4}else da=ba/TWO_PI*$(v/S);if(g<1)return-0.5*S*z(2,10*(g-=1))*D((g*A-da)*TWO_PI/ba)+s;return S*z(2,-10*(g-=1))*D((g*A-da)*TWO_PI/ba)*0.5+v+s},quadin:function(g,s,v,A){return v*(g/=A)*g+s},quadout:function(g,s,v,A){return-v*
(g/=A)*(g-2)+s},quadinout:function(g,s,v,A){if((g/=A/2)<1)return v/2*g*g+s;return-v/2*(--g*(g-2)-1)+s},sinein:function(g,s,v,A){return-v*U(g/A*F)+v+s},sineout:function(g,s,v,A){return v*D(g/A*F)+s},sineinout:function(g,s,v,A){return-v/2*(U(Math.PI*g/A)-1)+s}},fa=COG.Tween=function(g){g=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:ha("sine.out"),complete:null},g);var s=(new Date).getTime(),v=[],A=false,S=0,ba=0,da={isComplete:function(){return A},triggerComplete:function(la){g.complete&&
g.complete(la)},update:function(la){try{var na=g.tweenFn(la-s,S,ba,g.duration);if(g.target)g.target[g.property]=na;for(var va=v.length;va--;)v[va](na,void 0);if(A=s+g.duration<=la){if(g.target)g.target[g.property]=g.tweenFn(g.duration,S,ba,g.duration);for(var xa=v.length;xa--;)v[xa](na,true)}}catch(O){COG.exception(O)}},requestUpdates:function(la){v.push(la)}};S=g.target&&g.property&&g.target[g.property]?g.target[g.property]:g.startValue;if(typeof g.endValue!=="undefined")ba=g.endValue-S;if(ba==0)A=
true;ta();return da};COG.tweenValue=function(g,s,v,A,S){g=new fa({startValue:g,endValue:s,tweenFn:v,complete:A,duration:S});E.push(g);return g};COG.tween=function(g,s,v,A,S,ba){g=new fa({target:g,property:s,endValue:v,tweenFn:A,duration:ba,complete:S});E.push(g);return g};COG.endTweens=function(g){if(!K){K=true;try{for(var s=0;s<E.length;)if(!g||g(E[s])){E[s].triggerComplete(true);E.splice(s,1)}else s++}finally{K=false}}};COG.getTweens=function(){return[].concat(E)};var ha=COG.easing=function(g){return ca[g.replace(/[\-\_\s\.]/g,
"").toLowerCase()]};COG.registerEasingType=function(g,s){ca[g.replace(/[\-\_\s\.]/g,"").toLowerCase()]=s}})();
INTERACT=function(){function ka(U){return function(E,N,K){(K?K:U?document.body:document).addEventListener(E,N,false)}}function ta(U){return function(E,N,K){(K?K:U?document.body:document).removeEventListener(E,N,false)}}function J(U,E,N){(N?N:document).attachEvent("on"+U,E)}function F(U,E,N){(N?N:document).detachEvent("on"+U,E)}function x(U,E){D.push(COG.extend({handler:null,checks:{},type:U},E))}function z(U,E){return{x:U.x-(E?E.x:0),y:U.y-(E?E.y:0)}}var D=[],$=function(U,E,N){function K(s,v,A,S){ca.trigger("pan",
S.x,S.y)}N=COG.extend({binder:null,unbinder:null,observable:null},N);for(var ca=N.observable,fa=[],ha={bind:function(){return ca.bind.apply(null,arguments)},pannable:function(s){COG.extend({inertia:true},s);ca.bind("pointerMove",K);return ha},unbind:function(){ca.unbind();for(var s=0;s<fa.length;s++)fa[s].unbind();return ha}},g=0;g<E.length;g++)fa.push(E[g](U,ca,N));return ha};x("pointer",{handler:function(U,E,N){function K(O){var qa=O.target?O.target:O.srcElement;if(A||qa&&qa===U)if(S=O.button===
0){va=O.pageX?O.pageX:O.screenX;xa=O.pageY?O.pageY:O.screenY;ba={x:va?va:0,y:xa?xa:0};O=U;var R=qa=0;if(O.offsetParent){do{qa+=O.offsetLeft;R+=O.offsetTop;O=O.offsetParent}while(O)}da={x:qa,y:R};E.trigger("pointerDown",ba,z(ba,da))}}function ca(O){var qa=O.target?O.target:O.srcElement;la=O.pageX?O.pageX:O.screenX;na=O.pageY?O.pageY:O.screenY;if(S&&(A||qa&&qa===U))g("pointerMove")}function fa(O){var qa=O.target?O.target:O.srcElement;if(S&&O.button===0){S=false;if(A||qa&&qa===U)g("pointerUp")}}function ha(O){var qa=
O.target?O.target:O.srcElement;if(A||qa&&qa===U){qa=O.detail?O.axis===2?-O.detail*s:0:O.wheelDeltaY;if(qa!==0){var R={x:la?la:0,y:na?na:0};E.trigger("zoom",R,z(R,da),qa/v);if(O.preventDefault){O.preventDefault();O.stopPropagation()}else O.cancelBubble&&O.cancelBubble()}}}function g(O){var qa={x:la?la:0,y:na?na:0};E.trigger(O,qa,z(qa,da),{x:va-la?va-la:0,y:xa-na?xa-na:0});va=la;xa=na}var s=120,v=s*8,A=false,S=false,ba,da,la,na,va,xa;N.binder("mousedown",K,false);N.binder("mousemove",ca,false);N.binder("mouseup",
fa,false);N.binder("mousewheel",ha,window);N.binder("DOMMouseScroll",ha,window);return{unbind:function(){N.unbinder("mousedown",K,false);N.unbinder("mousemove",ca,false);N.unbinder("mouseup",fa,false);N.unbinder("mousewheel",ha,window);N.unbinder("DOMMouseScroll",ha,window)}}},checks:{touch:false}});x("pointer",{handler:function(U,E,N){function K(da,la,na){la=la[na?na:"touches"];na=la.length;var va=0;do{da.x=la[va].pageX;da.y=la[va].pageY;va+=1;if(va>=na){da.next=null;break}da=da.next={x:0,y:0}}while(1)}
function ca(da){var la=da.target?da.target:da.srcElement;if(la&&la===U){K(S,da);A=s}}function fa(da){var la=da.target?da.target:da.srcElement;if(la&&la===U){da.preventDefault();K(ba,da);if(A===s)A=Math.abs(S.x-ba.x)>g||Math.abs(S.y-ba.y)>g?v:s;A===v&&COG.info("moving")}}function ha(){}var g=7;E={x:0,y:0};var s=0,v=1,A,S=COG.extend({},E),ba=COG.extend({},E);N.binder("touchstart",ca,false);N.binder("touchmove",fa,false);N.binder("touchend",ha,false);COG.info("initialized touch handler");return{unbind:function(){N.unbinder("touchstart",
ca,false);N.unbinder("touchmove",fa,false);N.unbinder("touchend",ha,false)}}},checks:{touch:true}});return{register:x,watch:function(U,E,N){E=COG.extend({bindToBody:false,observable:null,isIE:false,types:null},E);capabilities=COG.extend({touch:"ontouchstart"in window},N);if(!E.observable){COG.info("creating observable");E.observable=COG.observable({});globalOpts=E}E.binder=E.isIE?J:ka(E.bindToBody);E.unbinder=E.isIE?F:ta(E.bindToBody);N=E.types;for(var K=capabilities,ca=[],fa=D.length;fa--;){var ha=
D[fa],g=!N||N.indexOf(ha.type)>=0,s=true;for(var v in ha.checks){var A=ha.checks[v];COG.info("checking "+v+" capability. require: "+A+", capability = "+K[v]);s=s&&A===K[v]}if(g&&s)ca[ca.length]=ha.handler}return new $(U,ca,E)}}}();
T5=function(){function ka(){return(new Date).getTime()}function ta(){for(;Za.length>0;){var b=Za.shift();document.location=b}$a=0}function J(b){for(var q=true,h=hb.length;h--;)q=q&&b!=hb[h];return q}function F(b,q){var h=[];for(var l in q)l&&h.push(l+"="+escape(q[l]));return"tile5://"+b+"/"+(h.length>0?"?"+h.join("&"):"")}function x(b,q){J(b)&&COG.info("would push url: "+F(b,q))}function z(b,q){if(J(b)){Za.push(F(b,q));$a||($a=setTimeout(ta,100))}}function D(b){return function(q,h,l){(l?l:b?document.body:
document).addEventListener(q,h,false)}}function $(b){return function(q,h,l){(l?l:b?document.body:document).removeEventListener(q,h,false)}}function U(b,q,h){(h?h:document).attachEvent("on"+b,q)}function E(b,q,h){(h?h:document).detachEvent("on"+b,q)}function N(){Ia={base:{name:"Unknown",bindEvent:D(),unbindEvent:$(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:x,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:U,unbindEvent:E,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:z,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:z},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:z},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:D(true),unbindEvent:$(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:z},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:z}};ab=[Ia.froyo,Ia.android,Ia.ipod,Ia.iphone,Ia.ipad,Ia.ie]}function K(){Ia||N();if(!Pa){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<ab.length;b++){var q=ab[b];if(q.regex&&q.regex.test(navigator.userAgent)){Pa=COG.extend({},Ia.base,q);COG.info("PLATFORM DETECTED AS: "+Pa.name);break}}if(!Pa){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Pa=Ia.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Pa}function ca(b,q){function h(c,e){if(c&&l!==c){var i=b.triggerAll("zoomLevelChange",c,e);if(i)l=c;return i}}q=COG.extend({initial:1,min:0,max:null,zoomAnimation:COG.easing("quad.out")},q);var l=q.initial;COG.extend(b,{getZoomLevel:function(){return l},setZoomLevel:h});b.bind("scale",function(c,e,i){var m=Math.log(e)/Math.LN2;COG.endTweens(function(t){return t.cancelOnInteract});c.cancel=!h(l+m,i);c.cancel||b.updateOffset(i.x*
e,i.y*e)});b.bind("doubleTap",function(c,e,i){if(b.scalable()){COG.endTweens(function(m){return m.cancelOnInteract});b.scale(2,R.init(i.x,i.y))}})}function fa(){for(var b=0,q=arguments.length;q--;){var h=qb[arguments[q].toUpperCase()];if(h)b|=h}return b}var ha=Math.PI*2,g=Math.PI/2,s=Math.abs,v=Math.min,A=Math.max,S=Math.pow,ba=Math.sqrt,da=Math.log,la=Math.round,na=Math.sin,va=Math.asin,xa=Math.cos,O=Math.atan,qa=Math.atan2,R=function(){function b(c,e){return h(c.x-e.x,c.y-e.y)}function q(c,e){if(!e)e=
c.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var i={edges:Array(e-1),accrued:Array(e-1),total:0},m=0;m<e-1;m++){var t=b(c[m],c[m+1]);i.edges[m]=ba(t.x*t.x+t.y*t.y);i.accrued[m]=i.total+i.edges[m];i.total+=i.edges[m]}return i}function h(c,e){return{x:c?c:0,y:e?e:0}}function l(c,e){return h(c.x>e.x?c.x:e.x,c.y>e.y?c.y:e.y)}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var c=0,e=0,i=arguments.length;i--;){c+=
arguments[i].x;e+=arguments[i].y}return h(c,e)},absSize:function(c){return l(s(c.x),s(c.y))},copy:function(c){return c?h(c.x,c.y):null},diff:b,distance:function(c,e){return q(c,e).total},edges:q,equals:function(c,e){return c.x===e.x&&c.y===e.y},extendBy:function(c,e,i){var m=xa(e)*i;e=na(e)*i;return h(c.x-m,c.y-e)},floor:function(c){for(var e=Array(c.length),i=c.length;i--;)e[i]=h(~~c[i].x,~~c[i].y);return e},getRect:function(c){for(var e,i,m,t,r=c.length;r--;){var p=c[r];e=typeof e==="undefined"||
p.x<e?p.x:e;i=typeof i==="undefined"||p.y<i?p.y:i;m=typeof m==="undefined"||p.x>m?p.x:m;t=typeof t==="undefined"||p.y>t?p.y:t}return Aa.init(e,i,m,t)},init:h,invert:function(c){return h(-c.x,-c.y)},min:function(c,e){return h(c.x<e.x?c.x:e.x,c.y<e.y?c.y:e.y)},max:l,offset:function(c,e,i){return h(c.x+e,c.y+(i?i:e))},simplify:function(c,e){if(!c)return null;e=e?e:R.VECTOR_SIMPLIFICATION;for(var i=[],m=null,t=c.length;t--;){var r=c[t];if(include=!m||t===0||s(r.x-m.x)+s(r.y-m.y)>e){i.unshift(r);m=r}}return i},
theta:function(c,e,i){i=va((c.y-e.y)/i);return c.x>e.x?i:Math.PI-i}}}(),rb=function(){return{dotProduct:function(b,q){return b.x*q.x+b.y*q.y}}}(),Aa=function(){function b(h){return q(h.x1,h.y1,h.x2,h.y2)}function q(h,l,c,e){h=h?h:0;l=l?l:0;c=typeof c!=="undefined"?c:h;e=typeof e!=="undefined "?e:e;return{x1:h,y1:l,x2:c,y2:e,width:c-h,height:e-l}}return{center:function(h){return R.init(h.x1+h.width/2,h.y1+h.height/2)},copy:b,diagonalSize:function(h){return ba(h.width*h.width+h.height*h.height)},fromCenter:function(h,
l,c,e){c=~~(c/2);e=~~(e/2);return q(h-c,l-e,h+c,l+e)},init:q,intersect:function(h,l){var c=A(h.x1,l.x1),e=A(h.y1,l.y1),i=v(h.x2,l.x2),m=v(h.y2,l.y2);c=q(c,e,i,m);return c.width>0&&c.height>0?c:null},union:function(h,l){if(h.width===0||h.height===0)return b(l);else if(l.width===0||l.height===0)return b(h);else{var c=v(h.x1,l.x1),e=v(h.y1,l.y1),i=A(h.x2,l.x2),m=A(h.y2,l.y2);c=q(c,e,i,m);return c.width>0&&c.height>0?c:null}}}}(),Qa=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/
b.height:1},getCenter:function(b){return R.init(b.width/2,b.height/2)},getSize:function(b){return ba(S(b.width,2)+S(b.height,2))},init:function(b,q){b=b?b:0;return{width:b,height:q?q:b}}}}(),Ia=null,ab=[],Pa=null,$a=0,Za=[],hb=["view.wake","tile.loaded"],Ua=function(){function b(){if(!T){var B=K().maxImageLoads;T=COG.Loopage.join({execute:function(X,H){if(!B||p.length<B){var M=r.shift();if(M){p[p.length]=M;M.image.onload=h;M.image.src=M.url;M.requested=T5.ticks()}else H.trigger("complete")}},frequency:10});
T.bind("complete",function(){T=null})}}function q(){V=true;try{var B=w.length/2>>0;if(B>0){w.sort(function(H,M){return H.created-M.created});for(var X=B;X--;)delete e[w[X].url];w.splice(0,B)}}finally{V=false}P.trigger("cacheCleared")}function h(){var B=m[this.id],X;if(B&&B.image.complete&&B.image.width>0){B.loaded=true;B.hitCount=1;for(X=p.length;X--;)if(p[X].image.src==this.src){p.splice(X,1);break}if(B.background||B.postProcess||B.drawBackground||B.customDraw)if(B.image){globalImageData=B;X=c(B.realSize?
B.realSize.width:B.image.width,B.realSize?B.realSize.height:B.image.height);var H=X.getContext("2d"),M=B.offset?B.offset:T5.XY.init();B.background&&H.drawImage(B.background,0,0);B.drawBackground&&B.drawBackground(H);B.customDraw?B.customDraw(H,B):H.drawImage(B.image,M.x,M.y);B.postProcess&&B.postProcess(H,B);B.image=X}for(X=B.callbacks.length;X--;)B.callbacks[X]&&B.callbacks[X](this,false);B.callbacks=[];w[w.length]={url:this.src,created:B.requested};delete m[this.id];b()}}function l(B,X,H){var M=
e[B];if(M){M.hitCount++;M.image.complete&&M.image.width>0&&X?X(M.image,true):M.callbacks.push(X)}else{M=COG.extend({url:B,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[X]},H);M.image.id="resourceLoaderImage"+t++;e[B]=M;m[M.image.id]=M;r[r.length]=M;b()}return M}function c(B,X){var H=document.createElement("canvas");H.width=B?B:0;H.height=X?X:0;if(typeof FlashCanvas!=="undefined"){H.id="tmpCanvas"+i++;H.style.cssText="position: absolute; top: -"+(X-1)+"px; left: -"+
(B-1)+"px;";document.body.appendChild(H);FlashCanvas.initElement(H)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(H);return H}var e={},i=0,m={},t=0,r=[],p=[],w=[],G=0,T=null,V=false,P={avgImageSize:25,loadTimeout:10,cancelLoad:function(){p=[]},get:function(B,X,H){var M=null,W=null;V||(M=e[B]);if((W=M?M.image:null)&&(W.getContext||W.complete&&W.width>0))return W;else X&&l(B,X,H);return null},load:l,newCanvas:c,reset:function(){e={}},stats:function(){return{imageLoadingCount:p.length,
queuedImageCount:r.length,imageCacheFullness:G}}};COG.observable(P);COG.Loopage.join({execute:function(B){for(var X=false,H=0,M=K();H<p.length;)if(B-p[H].requested>P.loadTimeout*1E3){p.splice(H,1);X=true}else H++;X&&b();if(M&&M.imageCacheMaxSize){G=w.length*P.avgImageSize/M.imageCacheMaxSize;G>=1&&q()}},frequency:2E4});return P}(),bb=function(){var b={};return{init:function(q,h){var l=b[q];if(!l)throw Error("Unable to locate requested generator: "+q);return new l(h)},register:function(q,h){b[q]=h},
Template:function(){}}}(),Ra=function(){function b(i,m){c[i]=h(m);return i}function q(i){for(var m in i)b(m,i[m])}function h(i){function m(w){var G=i[w];typeof G!=="undefined"&&r.push(function(T){T[w]=G})}function t(){r=[];for(var w in i)m(w)}i=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},i);var r=[],p={applyToContext:function(w){for(var G=r.length;G--;)r[G](w)},
update:function(w,G){i[w]=G;t()}};t();return p}var l={},c={},e={apply:function(i,m){var t=c[m]?c[m]:c.basic,r;if(i&&i.canvas){r=l[i.canvas.id];l[i.canvas.id]=m}t.applyToContext(i);return r},define:b,defineMany:q,get:function(i){return c[i]},init:h,load:function(i){COG.jsonp(i,function(m){q(m)})}};q({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return e}(),qb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},
lb=function(b){function q(u,y,Y,ga){Da=Ea;P();if(ga&&b.inertia)t(wa+y,ya+Y,b.panAnimationEasing,b.panAnimationDuration);else ga||t(wa+y,ya+Y)}function h(){Da=Ba;k=false;P()}function l(u,y,Y){ia||(ia=[].concat(Y));u=ib(ia);jb(u);y=kb(u);var ga=ib(Y);Y=jb(ga);ga=kb(ga);i(Y);aa=u&&y!==0?ga/y:1;e()}function c(u,y,Y,ga){oa.zoom(Qa.getCenter(Fa),ga)}function e(u){G();var y=R.init(ua-(La.width/(aa*2)>>0),pa-(La.height/(aa*2)>>0)),Y=Math.log(aa)/Math.LN2>>0;if(aa!==1)Da=Ca;COG.info("scale factor = "+aa+", exp = "+
Y);if(Y!==0){aa=Math.pow(2,Y);if(!oa.trigger("scale",aa,y).cancel){COG.info("ok to scale");for(u=H.length;u--;)H[u].trigger("scale",aa,y);aa=1;ia=null;Da=Ba;u=true}}P(u)}function i(u){Va=R.init(wa,ya);f=R.offset(u,wa,ya)}function m(){clearTimeout(ja);ja=setTimeout(r,50)}function t(u,y,Y,ga,ma){function ra(){za+=1;if(za>=2){h(0,0);ma&&ma()}}var za=0,Ma=a?R.offset(a,-Ka,-Wa):null,Na=j?R.offset(j,-Ka,-Wa):null;if(Ma){u=u<Ma.x?Ma.x:u;y=y<Ma.y?Ma.y:y}if(Na){u=u>Na.x?Na.x:u;y=y>Na.y?Na.y:y}if(Y){if(!k){u=
COG.tweenValue(wa,u,Y,ra,ga);y=COG.tweenValue(ya,y,Y,ra,ga);u.cancelOnInteract=true;u.requestUpdates(function(cb){wa=cb>>0;k=true;P()});y.cancelOnInteract=true;y.requestUpdates(function(cb){ya=cb>>0;k=true;P()})}}else{wa=u>>0;ya=y>>0}}function r(){var u;if(W){L&&L.unbind();if(b.autoSize&&W.parentNode){u=W.parentNode.getBoundingClientRect();if(u.height!==0&&u.width!==0){W.height=u.height;W.width=u.width}}try{if(!W.id)W.id=b.id+"_canvas";Q=W.getContext("2d")}catch(y){COG.exception(y);throw Error("Could not initialise canvas on specified view element");
}if(Fa.height!==W.height||Fa.width!==W.width){Fa=Qa.init(W.width,W.height);Ka=Fa.width/2>>0;Wa=Fa.height/2>>0;oa.trigger("resize",W.width,W.height);for(u=M;u--;)H[u].trigger("resize",W.width,W.height)}if(b.interactive)L=INTERACT.watch(W,{observable:oa}).pannable();for(u=M;u--;)H[u].trigger("contextChanged",Q);P()}}function p(u,y){y.setId(u);y.added=ka();y.bind("remove",function(){oa.removeLayer(u)});y.trigger("contextChanged",Q);y.setParent(oa);H.push(y);H.sort(function(Y,ga){var ma=ga.zindex-Y.zindex;
if(ma===0)ma=ga.added-Y.added;return ma});M=H.length;return y}function w(){X("idle",oa);d=true;o=0}function G(u){var y=1/aa;ua=f.x+(wa-Va.x);pa=f.y+(ya-Va.y);if(u)return Aa.fromCenter(ua>>0,pa>>0,u.width*y>>0,u.height*y>>0)}function T(u,y,Y,ga){var ma=Aa.copy(y),ra,za=0;Y&&Q.clearRect(0,0,W.width,W.height);Q.save();try{Q.globalCompositeOperation="source-over";if(aa!==1){ma=G(ma);Q.scale(aa,aa)}Q.translate(-ma.x1,-ma.y1);j=a=null;Q.beginPath();Ja=false;for(za=M;za--;)if(H[za].clip){H[za].clip(Q,ma,
u,oa,Y,ga);Ja=true}Q.closePath();Ja&&Q.clip();for(za=M;za--;){ra=H[za];var Ma=ra.style,Na=Ma?Ra.apply(Q,Ma):null;if(ra.minXY)a=a?R.min(a,ra.minXY):R.copy(ra.minXY);if(ra.maxXY)j=j?R.max(j,ra.maxXY):R.copy(ra.maxXY);ra.draw(Q,ma,u,oa,Y,ga);Na&&Ra.apply(Q,Na)}}finally{Q.restore()}if(db){Q.globalCompositeOperation="source-over";Q.strokeStyle="#f00";Q.beginPath();Q.moveTo(W.width/2,0);Q.lineTo(W.width/2,W.height);Q.moveTo(0,W.height/2);Q.lineTo(W.width,W.height/2);Q.stroke()}X("drawComplete",y,ga);COG.trace("draw complete",
ga)}function V(u,y){var Y=false,ga=C?C:k?Ea:Da,ma=!k&&(ga===Ca||ga===Ea),ra=I||ga===Ea||ga===Ca||COG.getTweens().length>0;La=B();if(ma){COG.endTweens(function(za){return za.cancelOnInteract});d=false;if(o!==0){clearTimeout(o);o=0}}for(ma=M;ma--;){if(H[ma].animated)Da|=Xa;H[ma].cycle(u,La,Da,ra);Y=H[ma].shouldDraw(Da,La,ra)||Y}ra=ra||(Da&Xa)!==0;if(Y=Y||ra||aa!==1&&aa!==Z){T(ga,La,ra,u);Z=aa;I=false}if(!Y&&Sa===0&&!sa){if(!d&&o===0)o=setTimeout(w,500);y.trigger("complete")}Sa=0;COG.trace("Completed draw cycle",
u)}function P(u){I=u?true:false;Sa+=1;if(!Oa){Oa=COG.Loopage.join({execute:V,frequency:ea});Oa.bind("complete",function(){Oa=null})}}function B(){return Aa.init(wa,ya,wa+Fa.width,ya+Fa.height)}function X(){for(var u=oa.trigger.apply(null,arguments).cancel,y=H.length;y--;)u=H[y].trigger.apply(null,arguments).cancel||u;return!u}b=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,interactive:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,
pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},b);var H=[],M=0,W=document.getElementById(b.container),Q=null,wa=0,ya=0,Ja=false,La=null,Oa=null,db=b.guides,Ya=1,Fa=Qa.init(),Sa=0,Ka=0,Wa=0,Va=null,f=null,d=false,k=false,o=0,a=null,j=null,n=0,C=null,I=false,ja=0,ia=null,aa=1,Z=0,L=null,sa=typeof FlashCanvas!=="undefined",ea=~~(1E3/b.fps),ua,pa,Ba=fa("ACTIVE"),Ea=fa("PAN"),Ca=fa("ZOOM"),Xa=fa("ANIMATING"),Da=Ba,ib=R.getRect,kb=Aa.diagonalSize,
jb=Aa.center,oa={id:b.id,deviceScaling:Ya,fastDraw:b.fastDraw||K().requireFastDraw,getDimensions:function(){return Fa},getLayer:function(u){for(var y=0;y<M;y++)if(H[y].getId()==u)return H[y];return null},setLayer:function(u,y){for(var Y=0;Y<M;Y++)if(H[Y].getId()===u){H.splice(Y,1);break}y&&p(u,y);P();return y},eachLayer:function(u){for(var y=M;y--;)u(H[y])},invalidate:P,resize:function(u,y){if(W){b.autoSize=false;W.width=u;W.height=y;r();oa.trigger("resize",W.width,W.height)}},scale:function(u,y,
Y,ga){function ma(){aa=Math.pow(2,Math.round(Math.log(aa)/Math.LN2));ga&&ga();e(true)}var ra=aa;y||(y=Qa.getCenter(Fa));i(y);if(Y)COG.tweenValue(0,u-ra,Y,ma,1E3).requestUpdates(function(za){aa=ra+za;e()});else{aa=u;ma()}return oa},triggerAll:X,removeLayer:function(u){a:{for(var y=M;y--;)if(H[y].getId()==u){u=y;break a}u=-1}if(u>=0&&u<M){oa.trigger("layerRemoved",H[u]);H.splice(u,1);P()}M=H.length},stateOverride:function(u){C=u},getOffset:function(){return R.init(wa,ya)},getViewRect:B,updateOffset:t,
pan:function(u,y,Y,ga,ma){t(wa+u,ya+y,Y,ga,ma)},zoom:function(u,y){i(u);k=false;aa=Math.max(aa+Math.pow(2,y)-1,0.25);COG.info("zooming, scale change = "+y+", targetXY = ",u);e()}};Ya=K().getScaling();oa.markers=p("markers",new eb);COG.observable(oa);oa.bind("invalidate",function(u,y){P(y)});if(b.pannable){oa.bind("pan",q);oa.bind("panEnd",h);oa.bind("inertiaCancel",function(){k=false;P()})}if(b.scalable){oa.bind("pinchZoom",l);oa.bind("zoom",c)}oa.bind("tap",function(u,y,Y){for(var ga=R.offset(Y,
wa,ya),ma=H.length;ma--;)u.cancel=u.cancel||H[ma].trigger("tap",y,Y,ga).cancel});oa.bind("resync",function(){j=a=null});COG.configurable(oa,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(b,null,{container:function(u,y){W=document.getElementById(y);r()},rotation:function(u,y){n=y}}),true);r();b.autoSize&&window.addEventListener("resize",m,false);return oa},Ta=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:fa("ACTIVE",
"ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var q=null,h=false,l=false,c=b.supportFastDraw,e=b.id,i=fa("ACTIVE"),m=b.validStates,t=0,r=0,p=COG.extend({addToView:function(w){w.setLayer(e,p)},shouldDraw:function(w,G,T){return(l||T||t!==G.x1||r!==G.y1)&&(w&m)!==0&&(h?c:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){p.trigger("remove",p)},changed:function(w){l=true;p.trigger("changed",p);q&&q.trigger("invalidate",w)},getId:function(){return e},setId:function(w){e=
w},getParent:function(){return q},setParent:function(w){h=(q=w)?q.fastDraw&&displayState!==i:false;p.trigger("parentChange",q)}},b);COG.observable(p);p.bind("drawComplete",function(w,G){l=false;t=G.x1;r=G.y1});p.bind("resync",function(w,G){if(G.syncXY){p.minXY&&G.syncXY(p.minXY);p.maxXY&&G.syncXY(p.maxXY)}});return p},fb=function(b){function q(t,r,p,w){l=t;c=r;e=p;i=w}b=COG.extend({xy:R.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},b);var h=false,l=0,c=0,e=0,i=0,m=COG.extend(b,{isAnimating:function(){return h},
draw:function(t,r,p,w,G){if(m.isNew&&b.tweenIn){var T=m.xy.y;m.xy.y=r.y1-20;h=true;COG.tween(m.xy,"y",T,b.tweenIn,function(){m.xy.y=T>>0;h=false},b.animationSpeed?b.animationSpeed:250+Math.random()*500)}m.drawMarker(t,r,m.xy.x,m.xy.y,p,w,G);m.isNew=false},drawMarker:function(t,r,p,w){t.beginPath();t.arc(p,w,4,0,Math.PI*2,false);t.fill();q(p-4,w-4,8,8)},hitTest:function(t,r){return t>=l&&t<=l+e&&r>=c&&r<=c+i},updateBounds:q});COG.observable(m);return m},eb=function(b){function q(){c.changed();c.trigger("markerUpdate",
l)}function h(){var e=c.getParent();if(e&&e.syncXY)for(var i=l.length;i--;)e.syncXY([l[i].xy])}b=COG.extend({zindex:100,style:"basic"},b);var l=[],c=COG.extend(new Ta(b),{draw:function(e,i,m,t){for(var r=l.length;r--;)l[r].draw(e,i,m,c,t)},add:function(e){if(e&&typeof e.length!=="undefined")for(var i=e.length;i--;){if(e[i])l[l.length]=e[i]}else if(e)l[l.length]=e;q()},clear:function(e){if(e)for(var i=0;i<l.length;i++)e(l[i])&&l.splice(i,1);else l=[];q()},each:function(e){if(e)for(var i=l.length;i--;)e(l[i])},
find:function(e){for(var i=[],m=l.length;m--;)if(!e||e(l[m]))i[i.length]=l[m];return i}});c.bind("tap",function(e,i,m){for(var t=[],r=m.x,p=m.y,w=l.length;w--;)if(l[w].hitTest(r,p))t[t.length]=l[w];if(t.length>0)e.cancel=c.trigger("markerTap",i,m,t).cancel});c.bind("parentChange",h);c.bind("resync",h);c.bind("changed",h);return c},mb=function(b){function q(m,t,r){m.fillStyle="#FFFFFF";m.strokeStyle="#222222";m.beginPath();m.arc(r.x,r.y,4,0,Math.PI*2,false);m.stroke();m.fill()}b=COG.extend({path:[],
id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:fa("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},b);var h=R.edges(b.path),l,c=null,e=0;COG.tweenValue(0,h.total,b.easing,function(){i.remove()},b.duration).requestUpdates(function(m,t){e=m;t&&i.remove()});var i=COG.extend(new Ta(b),{cycle:function(){for(var m=0;m<h.accrued.length&&h.accrued[m]<e;)m++;c=null;if(m<b.path.length-1){var t=e-(m>0?h.accrued[m-1]:0),r=b.path[m];l=R.theta(r,b.path[m+1],h.edges[m]);c=R.extendBy(r,
l,t)}return c},draw:function(m,t){if(c)(b.drawIndicator?b.drawIndicator:q)(m,t,R.init(c.x,c.y),l)}});return i},nb=function(b){b=COG.extend({style:null,properties:{}},b);return COG.extend(b,{rect:null,draw:function(){},resync:function(){}})},gb=function(b,q){q=COG.extend({fill:false,simplify:false},q);var h=false,l=q.fill,c=q.simplify,e=fa("ZOOM"),i=[],m=COG.extend(new nb(q),{draw:function(t,r,p,w,G,T){if(h){r=true;p=(T&e)!==0;t.beginPath();for(T=i.length;T--;){p=i[T].x;w=i[T].y;if(r){t.moveTo(p,w);
r=false}else t.lineTo(p,w);p=true}if(p){l&&t.fill();t.stroke()}}},resync:function(t){m.xy=t.syncXY(b);i=R.floor(c?R.simplify(b):b)}});h=b&&b.length>=2;return m},ob=function(b){function q(e){for(var i=l.length;i--;)l[i].resync(e);l.sort(function(m,t){var r=t.xy.y-m.xy.y;if(r===0)r=t.xy.x-m.xy.y;return r});c.changed()}function h(e,i){i.syncXY&&q(i)}b=COG.extend({zindex:80},b);var l=[],c=COG.extend(new Ta(b),{add:function(e){l[l.length]=e},each:function(e){for(var i=l.length;i--;)e(l[i])},draw:function(e,
i,m){var t=i.x1,r=i.y1,p=i.width;i=i.height;for(var w=l.length;w--;){var G=l[w].style;G=G?Ra.apply(e,G):null;l[w].draw(e,t,r,p,i,m);G&&Ra.apply(e,G)}}});c.bind("parentChange",h);c.bind("resync",h);return c},sb=function(){return{tileSize:256,init:function(b,q,h,l,c){return COG.extend({x:b,y:q,width:h,height:l},c)}}}(),pb=function(b){function q(V,P,B,X){function H(){if(T.initTileCreator){m=true;T.initTileCreator(V,P,B,X)}}T.prepTileCreator?T.prepTileCreator(V,P,B,H):H()}function h(V,P){for(var B=~~((V.x1-
e.x)/t),X=~~((V.y1-e.y)/r),H=[],M=-i;M<w;M++)for(var W=-i;W<G;W++){var Q=p(B+M,X+W);if(Q)H[H.length]=Q}P&&P(H);c=Aa.copy(V)}b=COG.extend({tileWidth:256,tileHeight:256,relative:false,padding:2},b);var l=null,c=null,e=R.init(),i=b.padding,m=false,t=b.tileWidth,r=b.tileHeight,p=null,w=0,G=0,T={bindToView:function(V){COG.info("initializing generator");l=V;T.trigger("bindView",V)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){p=
null;m=false;c=null},run:function(V,P){if(!c||Math.abs(V.x1-c.x1)>t||Math.abs(V.y1-c.y1)>r){if(!p&&!m||T.requireRefresh()){e=b.relative?R.init(V.x1,V.y1):R.init();w=Math.ceil(V.width/t)+i;G=Math.ceil(V.height/r)+i;q(t,r,T.getTileCreatorArgs?T.getTileCreatorArgs(l):{},function(B){p=B;m=false;h(V,P)})}p&&h(V,P)}}};COG.observable(T);T.bind("update",function(){COG.info("captured generator update");c=null});return T},Ga={ex:COG.extend,ticks:ka,getConfig:K,userMessage:function(b,q,h){Ga.trigger("userMessage",
b,q,h)},XY:R,XYRect:Aa,Dimensions:Qa,Vector:rb,D:Qa,Images:Ua,Generator:bb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ra,viewState:fa,View:lb,ViewLayer:Ta,ImageLayer:function(b,q){function h(r,p,w){for(p=e.length;p--;){var G=e[p],T=G.x,V=G.y,P=Aa.init(G.x,G.y,G.x+G.width,G.y+G.height);if(w&&Aa.intersect(r,P)){P=Ua.get(G.url,function(){t.changed()},m);w(P,T,V,G.width,G.height)}}}function l(r){c&&c.run(r,function(p){e=[].concat(p);t.changed()})}q=COG.extend({imageLoadArgs:{}},
q);var c=b?bb.init(b,q):null,e=[],i=Aa.init(),m=q.imageLoadArgs,t=COG.extend(new Ta(q),{changeGenerator:function(r,p){c=bb.init(r,COG.extend({},q,p));c.bindToView(t.getParent());e=null;l(i)},clip:function(r,p,w){h(p,w,function(G,T,V,P,B){G&&r.rect(T,V,P,B)})},cycle:function(r,p){l(p)},draw:function(r,p,w){h(p,w,function(G,T,V,P,B){t.drawImage(r,G,T,V,P,B,p,w)});i=Aa.copy(p)},drawImage:function(r,p,w,G){p&&r.drawImage(p,w,G,p.width,p.height)}});t.bind("idle",function(){l(i)});t.bind("parentChange",
function(r,p){c&&c.bindToView(p)});t.bind("tap",function(r,p,w,G){r=[];var T=G.x,V=G.y,P,B;if(e)for(var X=e.length;X--;){P=e[X];if(B=T>=P.x&&T<=P.x+P.width&&V>=P.y&&V<=P.y+P.height)r[r.length]=P}r.length>0&&t.trigger("tapImage",r,p,w,G)});return t},Marker:fb,ImageMarker:function(b){b=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},b);var q=b.imageAnchor?T5.XY.invert(b.imageAnchor):null,h=COG.extend(new fb(b),{drawMarker:function(l,
c,e,i){if((c=h.isAnimating()&&h.animatingImage?h.animatingImage:h.image)&&c.width>0){q||(q=R.init(-c.width>>1,-c.height>>1));var m=h.scale,t=e+~~(q.x*m),r=i+~~(q.y*m),p=~~(c.width*m),w=~~(c.height*m);h.updateBounds(t,r,p,p);if(h.rotation||h.opacity!==1){l.save();try{l.globalAlpha=h.opacity;l.translate(e,i);l.rotate(h.rotation);l.drawImage(c,q.x*m,q.y*m,p,w)}finally{l.restore()}}else l.drawImage(c,t,r,p,w)}}});if(!h.image)h.image=Ua.get(b.imageUrl,function(l){h.image=l});if(!h.animatingImage)h.animatingImage=
Ua.get(b.animatingImageUrl,function(l){h.animatingImage=l});return h},MarkerLayer:eb,PathLayer:function(b){b=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},b);var q=false,h=[],l=null,c=[],e=null,i=0,m=[],t=COG.extend(new Ta(b),{getAnimation:function(r,p,w,G){var T="pathAnimation"+i++;m.push(T);return new mb({id:T,path:h,zindex:b.zindex+1,easing:r?r:COG.easing("sine.inout"),duration:p?p:5E3,drawIndicator:w,autoCenter:G?G:false})},cycle:function(r,p,w,G){return G},draw:function(r){var p,
w=h.length;r.save();try{Ra.apply(r,b.style);if(w>0){r.beginPath();r.moveTo(h[w-1].x,h[w-1].y);for(p=w;p--;)r.lineTo(h[p].x,h[p].y);r.stroke();if(l){r.fillStyle=b.waypointFillStyle;for(p=l.length;p--;){r.beginPath();r.arc(l[p].x,l[p].y,2,0,Math.PI*2,false);r.stroke();r.fill()}}}}finally{r.restore()}q=false},updateCoordinates:function(r,p){c=r;e=p;var w=t.getParent();if(w&&w.syncXY){w.syncXY(c);e&&w.syncXY(e);t.trigger("tidy")}}});t.bind("tidy",function(){h=R.simplify(c,b.pixelGeneralization);l=R.simplify(e,
b.pixelGeneralization);q=true;t.changed()});return t},AnimatedPathLayer:mb,Shape:nb,Arc:function(b,q){q=COG.extend({size:4},q);var h=R.init(),l=COG.extend(q,{draw:function(c){c.beginPath();c.arc(h.x,h.y,l.size,0,Math.PI*2,false);c.fill();c.stroke()},resync:function(c){c.syncXY([b]);h=R.floor([b])[0]}});COG.info("created arc = ",b);return l},Poly:gb,ShapeLayer:ob,Tiling:sb,TileGenerator:pb};COG.observable(Ga);var Ha=Ga.Geo=function(){function b(f){f=parseFloat(f)*V;f=na(f);var d=B*f;return da((1+f)/
(1-f)*S((1-d)/(1+d),B))/2}function q(f){return parseFloat(f)*V}function h(f){f=S(Math.E,-f);for(var d=g-2*O(f),k=e(d,f),o=0;o<H&&s(d-k)>X;){d=k;k=e(d,f);o++}return k*P}function l(f){return f%360*P}function c(f,d){var k=null;for(var o in engines)if(d){if(o==d&&engines[o][f]){k=engines[o];break}}else if(engines[o][f]){k=engines[o];break}return k}function e(f,d){var k=B*na(f);return g-2*O(d*S((1-k)/(1+k),B/2))}function i(f,d,k,o){d=t(d);f.add(o.line(d,k));return d.length}function m(f,d,k,o){d=t(d);f.add(o.poly(d,
k));return d.length}function t(f){var d=f?f.length:0,k=Array(d);for(d=d;d--;)k[d]=Ha.Position.init(f[d][1],f[d][0]);return Ha.Position.vectorize(k,Sa)}function r(f,d,k){return new Va(f,d,k)}var p=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],w=-g,G=g,T=-ha,V=Math.PI/180,P=180/Math.PI,B=0.08181919084262157,X=1.0E-7,H=12,M=null,W={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},Q=function(){function f(a){return a?
k(a.lat,a.lon):null}function d(a){return!a||a.lat===0&&a.lon===0}function k(a,j){return{lat:parseFloat(a?a:0),lon:parseFloat(j?j:0)}}function o(a){if(a)if(typeof a.lat!=="undefined")return f(a);else{if(a.split)for(var j=[" ",","],n=0;n<j.length;n++){var C=a.split(j[n]);if(C.length===2)return k(C[0],C[1])}}else return k();return null}return{calcDistance:function(a,j){if(d(a)||d(j))return 0;var n=(j.lat-a.lat)*V/2,C=(j.lon-a.lon)*V/2;n=na(n)*na(n)+xa(a.lat*V)*xa(j.lat*V)*na(C)*na(C);return 6371*2*qa(ba(n),
ba(1-n))},copy:f,empty:d,equal:function(a,j){return a&&j&&a.lat==j.lat&&a.lon==j.lon},fromMercatorPixels:function(a,j){return k(h(j),l(a))},generalize:function(a,j,n){var C=a.length,I=[],ja=null;n||(n=250);n/=1E3;COG.info("generalizing positions, must include "+j.length+" positions");for(var ia=C;ia--;)if(ia===0)I.unshift(a[ia]);else{var aa=!ja||Q.inArray(a[ia],j)?n:Q.calcDistance(ja,a[ia]);if(a[ia]&&aa>=n){I.unshift(a[ia]);ja=a[ia]}}COG.info("generalized "+C+" positions into "+I.length+" positions");
return I},inArray:function(a,j){for(var n=Q.equal,C=j.length;C--;)if(n(a,j[C]))return true;return false},inBounds:function(a,j){var n=!(Q.empty(a)||Q.empty(j));return n=(n=n&&a.lat>=j.min.lat&&a.lat<=j.max.lat)&&a.lon>=j.min.lon&&a.lon<=j.max.lon},init:k,offset:function(a,j,n){var C=a.lat*V;a=a.lon*V;j=C+j/6371;n=va(na(n/6371)/xa(C));n=a+n;j=(j+g)%Math.PI-g;n%=ha;return k(j*P,n*P)},parse:o,parseArray:function(a){var j=a.length,n=Array(j);for(j=j;j--;)n[j]=o(a[j]);return n},toMercatorPixels:function(a){return T5.XY.init(q(a.lon),
b(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,j){var n=a.length,C=Array(n);j=COG.extend({chunkSize:500,async:true},j);if(!j.async){for(var I=n;I--;)C[I]=T5.GeoXY.init(a[I]);return C}return COG.Loopage.join({frequency:10,execute:function(ja,ia){for(var aa=0,Z=j.chunkSize,L=n;L--;){C[L]=T5.GeoXY.init(a[L]);aa+=1;if(aa>Z)break}n=L;n<=0&&ia.trigger("complete",C)}})}}}(),wa=function(){function f(a,j,n){var C=T5.XY.init(0,j.lat-a.lat);if(typeof n==="undefined")n=true;
C.x=n&&a.lon>j.lon?360-a.lon+j.lon:j.lon-a.lon;return C}function d(a,j){return wa.init(Q.init(a.min.lat-j,a.min.lon-j%360),Q.init(a.max.lat+j,a.max.lon+j%360))}function k(a){var j=f(a.min,a.max);return Q.init(a.min.lat+j.y/2,a.min.lon+j.x/2)}function o(a,j){return{min:Q.parse(a),max:Q.parse(j)}}return{calcSize:f,createBoundsFromCenter:function(a,j){var n=j/6371,C=a.lat*V,I=a.lon*V,ja=C-n,ia=C+n;if(ja>w&&ia<G){C=va(na(n)/xa(C));n=(I-C)%ha;I=(I+C)%ha}else{ja=A(ja,w);ia=v(ia,G);n=T;I=ha}return wa.init(Q.init(ja*
P,n*P),Q.init(ia*P,I*P))},expand:d,forPositions:function(a,j){var n=null,C=T5.ticks();j||(j="auto");for(var I=a.length;I--;)if(n){var ja=f(n.min,a[I],false),ia=f(a[I],n.max,false);if(ja.x<0)n.min.lon=a[I].lon;if(ja.y<0)n.min.lat=a[I].lat;if(ia.x<0)n.max.lon=a[I].lon;if(ia.y<0)n.max.lat=a[I].lat}else n=o(a[I],a[I]);if(j){if(j=="auto"){I=f(n.min,n.max);j=A(I.x,I.y)*0.3}n=d(n,j)}COG.trace("calculated bounds for "+a.length+" positions",C);return n},getCenter:k,getGeoHash:function(a){var j=T5.Geo.GeoHash.encode(a.min.lat,
a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+j+", max hash = "+a)},getZoomLevel:function(a,j){var n=k(a);n=v(la(s(n.lat)*0.05),p.length);var C=p[n],I=f(a.min,a.max);n=ceil(da(p[3]*j.height/I.y)/da(2));C=ceil(da(C*j.width/I.x)/da(2));return v(isNaN(n)?1E3:n,isNaN(C)?1E3:C)},init:o,isEmpty:function(a){return!a||Q.empty(a.min)||Q.empty(a.max)},toString:function(a){return"min: "+Q.toString(a.min)+", max: "+Q.toString(a.max)}}}(),ya=function(){var f=/^(\d+).*$/,d=/(\d+)\s?\-\s?(\d+)/;
return{buildingMatch:function(k,o){f.lastIndex=-1;if(f.test(k))for(var a=k.replace(f,"$1"),j=o.split(","),n=0;n<j.length;n++){d.lastIndex=-1;if(d.test(j[n])){var C=d.exec(j[n]);if(a>=parseInt(C[1],10)&&a<=parseInt(C[2],10))return true}else if(a==j[n])return true}return false},normalize:function(k){if(!k)return"";k=k.toUpperCase();if(!M){var o=[];for(var a in W)o.push(a);M=RegExp("(\\s)("+o.join("|")+")(\\s|$)","i")}M.lastIndex=-1;if(o=M.exec(k))k=k.replace(M,"$1"+W[o[2]]);return k},toString:function(k){return k.streetDetails+
" "+k.location}}}(),Ja=Ga.GeoXY=function(){function f(k,o){if(k.length){for(var a,j,n,C,I=k.length;I--;){f(k[I],o);a=typeof a==="undefined"||k.x<a?k.x:a;j=typeof j==="undefined"||k.y<j?k.y:j;n=typeof n==="undefined"||k.x>n?k.x:n;C=typeof C==="undefined"||k.y>C?k.y:C}return Aa.init(a,j,C,C)}else if(k.mercXY){a=k.mercXY;k.x=~~(a.x/o);k.y=~~((Math.PI-a.y)/o);k.rpp=o}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return k}function d(k,o,a){k.pos=o;k.mercXY=Q.toMercatorPixels(o);(a=typeof a!==
"undefined"?a:k.rpp)&&f(k,a)}return{init:function(k,o){var a=R.init();d(a,k,o);return a},sync:f,toPos:function(k,o){o=o?o:self.rpp;return Q.fromMercatorPixels(k.x*o,Math.PI-k.y*o)},updatePos:d}}();Ga.GeoVector=function(f){COG.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return Ja.init(f)};var La=function(){return{bestResults:function(f,d){d||(d=20);for(var k=f.length>0?f[0]:null,o=[],a=0;a<f.length;a++)if(k&&f[a]&&k.matchWeight-f[a].matchWeight<=d)o.push(f[a]);
else break;return o}}}(),Oa=function(f){f=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},f);return COG.extend(f,{toString:function(){return f.caption+(f.matchWeight?" ("+f.matchWeight+")":"")}})},db=function(){var f={calculate:function(d){d=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},d);var k=T5.Geo.getEngine("route");k&&k.route(d,function(o){if(d.generalize)o.geometry=T5.Geo.Position.generalize(o.geometry,o.getInstructionPositions());
if(d.map){f.createMapOverlay(d.map,o);d.autoFit&&d.map.gotoBounds(o.boundingBox)}d.success&&d.success(o)})},createMapOverlay:function(d,k){var o=d.getDimensions();o=new T5.Geo.UI.RouteOverlay({data:k,width:o.width,height:o.height});d.setLayer("route",o)},parseTurnType:function(d){for(var k=f.TurnType.Unknown,o=T5.Geo.Routing.TurnTypeRules,a=0;a<o.length;a++){o[a].regex.lastIndex=-1;var j=o[a].regex.exec(d);if(j){k=o[a].customCheck?o[a].customCheck(d,j):o[a].turnType;break}}return k},TurnType:{Unknown:"turn-unknown",
Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(d){var k=d=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,
turnType:null},d),o=d.description;o=o.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");k.description=o;if(!d.turnType)d.turnType=f.parseTurnType(d.description);return d},RouteData:function(d){d=COG.extend({geometry:[],instructions:[],boundingBox:null},d);if(!d.boundingBox)d.boundingBox=T5.Geo.BoundingBox.forPositions(d.geometry);return COG.extend({getInstructionPositions:function(){for(var k=[],o=0;o<d.instructions.length;o++)d.instructions[o].position&&k.push(d.instructions[o].position);return k}},d)}};return f}(),
Ya="featurecollection",Fa="feature",Sa={async:false},Ka={processor:null,group:"shapes",layerClass:ob},Wa={point:COG.extend({},Ka,{processor:function(f,d,k,o){d=t([d.coordinates],Sa);if(d.length>0)if(k=o.marker(d[0],k)){f.add(k);return d.length}},group:"markers",layerClass:eb}),linestring:COG.extend({},Ka,{processor:function(f,d,k,o){d=t(d&&d.coordinates?d.coordinates:[]);return i(f,d,k,o)}}),multilinestring:COG.extend({},Ka,{processor:function(f,d,k,o){d=d&&d.coordinates?d.coordinates:[];for(var a=
0,j=d.length;j--;)a+=i(f,d[j],k,o);return a}}),polygon:COG.extend({},Ka,{processor:function(f,d,k,o){d=d&&d.coordinates?d.coordinates:[];if(d.length>0)return m(f,d[0],k,o);return 0}}),multipolygon:COG.extend({},Ka,{processor:function(f,d,k,o){d=d&&d.coordinates?d.coordinates:[];for(var a=0,j=0;j<d.length;j++)a+=m(f,d[j][0],k,o);return a}})},Va=function(f,d,k,o){function a(ea,ua){var pa=ea.processor,Ba=I+ea.group,Ea=COG.extend({},ea,k,{properties:ua.properties});if(pa){var Ca=L[Ba];if(!Ca){Ca=new ea.layerClass({id:Ba});
L[Ba]=Ca}globalLayers=L;return pa(Ca,ua.data,Ea,o)}return 0}function j(ea,ua){var pa=ea&&ea.type?ea.type.toLowerCase():null;return pa&&pa===Fa?j(ea.geometry,ea.properties):{type:pa,isCollection:pa?pa===Ya:false,definition:Wa[pa],data:ea,properties:ua?ua:ea.properties}}k=COG.extend({vectorsPerCycle:Ha.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},k);o=COG.extend({marker:function(ea){return new fb({xy:ea})},line:function(ea,ua){return new gb(ea,ua)},poly:function(ea,ua){return new gb(ea,
COG.extend({fill:true},ua))}},o);var n=k.vectorsPerCycle,C=k.rowPreParse,I=k.layerPrefix,ja=0,ia=0,aa=null,Z=0,L={},sa;if(!f)return null;if(typeof f.length==="undefined")f=[f];ia=f.length;sa=COG.Loopage.join({frequency:10,execute:function(ea,ua){var pa=0,Ba=ja;if(!aa){for(;Ba<ia;Ba++){var Ea=j(C?C(f[Ba]):f[Ba]),Ca=null;if(Ea.isCollection){Z+=1;aa=r(Ea.data.features,function(Xa){aa=null;for(var Da in Xa)L[Da]=Xa[Da]},{layerPrefix:I+Z+"-"});Ca+=1}else if(Ea.definition)Ca=a(Ea.definition,Ea);pa+=Ca?
Ca:1;if(pa>=n)break}ja=Ba+1;!aa&&ja>=ia&&ua.trigger("complete")}}});sa.bind("complete",function(){d&&d(L)});return sa};Ga.GeoJSON={parse:r};Ga.Map=function(f){function d(L){try{var sa=Ha.Position.init(L.coords.latitude,L.coords.longitude),ea=L.coords.accuracy/1E3;Z.trigger("locationUpdate",L,ea);if(ia){if(!I){I=new Ha.UI.LocationOverlay({pos:sa,accuracy:ea});I.update(Z.getTileLayer());Z.setLayer("location",I)}var ua=Ha.BoundingBox.createBoundsFromCenter(sa,Math.max(ea,1));Z.gotoBounds(ua)}else{I.pos=
sa;I.accuracy=ea;I.update(Z.getTileLayer());a(sa,null,COG.easing("sine.out"))}ia=false}catch(pa){COG.exception(pa)}}function k(L){COG.info("caught location tracking error:",L)}function o(L,sa,ea){Z.setZoomLevel(sa);Ua.cancelLoad();COG.endTweens();a(L,ea)}function a(L,sa,ea,ua){L=Ja.init(L,Ha.radsPerPixel(Z.getZoomLevel()));var pa=Z.getDimensions();Z.updateOffset(L.x-pa.width/2,L.y-pa.height/2,ea,ua,sa);Z.trigger("wake");Z.trigger("boundsChange",Z.getBoundingBox());sa&&typeof ea==="undefined"&&sa(Z)}
f=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},f);var j={NONE:0,SINGLE:1,WATCH:2},n=R.init(),C=j.NONE,I=null,ja=0,ia=true,aa=0;f.adjustScaleFactor=function(L){return Math.pow(2,(L<1?Math.floor:Math.ceil)(Math.log(L)))};var Z=COG.extend(new lb(f),{getBoundingBox:function(){var L=Z.getViewRect();return Ha.BoundingBox.init(Ja.toPos(R.init(L.x1,L.y2),aa),Ja.toPos(R.init(L.x2,L.y1),aa))},getCenterPosition:function(){var L=Z.getViewRect();if(L){L=R.init(L.x1+L.width/2,
L.y1+L.height/2);return Ja.toPos(L,aa)}return null},gotoBounds:function(L,sa){var ea=Ha.BoundingBox.getZoomLevel(L,Z.getDimensions());o(Ha.BoundingBox.getCenter(L),ea,sa)},gotoPosition:o,panToPosition:a,syncXY:function(L){return Ja.sync(L,aa)},locate:function(){Z.trackStart(j.SINGLE);setTimeout(Z.trackCancel,1E4)},trackStart:function(L){if(navigator.geolocation&&!ja){C=L?L:j.WATCH;ia=true;ja=navigator.geolocation.watchPosition(d,k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){ja&&
navigator.geolocation&&navigator.geolocation.clearWatch(ja);Z.removeLayer("location");I=null;C=j.NONE;ja=0},animateRoute:function(L,sa,ea,ua){var pa=Z.getLayer("route");if(pa)(L=pa.getAnimation(L,sa,ea,ua))&&L.addToView(Z)}});Z.bind("pan",function(){C===j.SINGLE&&Z.trackCancel()});Z.bind("tap",function(){});Z.bind("idle",function(){if(R.absSize(R.diff(n,Z.getOffset()))>f.boundsChangeThreshold){n=R.copy(Z.getOffset());Z.trigger("boundsChange",Z.getBoundingBox())}});ca(Z,f);Z.bind("zoomLevelChange",
function(L,sa){aa=Ha.radsPerPixel(sa);Z.triggerAll("resync",Z)});return Z};Ga.MapTileGenerator=function(f){function d(j,n){var C=n>=a.minLevel&&(!a.maxLevel||n<=a.maxLevel);COG.info("new zoom level = "+n+", zoom ok = "+C);j.cancel=!C;if(C){k=n;a.reset()}}f=COG.extend({relative:true},f);var k=0,o=null,a=COG.extend(new pb(f),{minLevel:2,maxLevel:20,getTileCreatorArgs:function(j){o=j.getCenterPosition();return{zoomLevel:k,position:o}},requireRefresh:function(){return!o}});a.bind("bindView",function(j,
n){if(n.getZoomLevel){k=n.getZoomLevel();n.bind("zoomLevelChange",d)}});return a};Ga.GeoPoly=function(f,d){d=COG.extend({autoParse:true},d);for(var k=Array(f.length),o=d.autoParse,a=T5.Geo.Position.parse,j=f.length;j--;)k[j]=T5.GeoXY.init(o?a(f[j]):f[j]);return new T5.Poly(k,d)};Ga.RouteOverlay=function(f){f=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},f);var d=[],k=[],o=new T5.PathLayer(f);(function(){if(f.data&&
f.data.instructions){for(var a=f.data.instructions,j=Array(a.length),n=a.length;n--;)j[n]=a[n].position;T5.Geo.Position.vectorize(j).bind("complete",function(C,I){k=I})}f.data&&f.data.geometry&&T5.Geo.Position.vectorize(f.data.geometry).bind("complete",function(C,I){d=I;o.updateCoordinates(d,k,true)})})();return o};Ga.LocationOverlay=function(f){f=COG.extend({pos:null,accuracy:null,zindex:90},f);var d=new Image,k=T5.XY.init(),o=T5.XY.init(),a=null;d.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
d.onload=function(){k=T5.XY.init(d.width/2,d.height/2)};var j=COG.extend(new T5.ViewLayer(f),{pos:f.pos,accuracy:f.accuracy,drawAccuracyIndicator:false,draw:function(n,C){var I=o.x-C.x,ja=o.y-C.y;if(a){n.fillStyle="rgba(30, 30, 30, 0.2)";n.beginPath();n.arc(I,ja,a,0,Math.PI*2,false);n.fill()}d.complete&&d.width>0&&n.drawImage(d,I-k.x,ja-k.y,d.width,d.height);j.changed()},update:function(n){if(n){a=Math.floor(n.getPixelDistance(j.accuracy)*0.5);o=n.getGridXYForPosition(j.pos);j.changed()}}});j.bind("gridUpdate",
function(n,C){j.update(C)});return j};return{distanceToString:function(f){if(f>1E3)return~~(f/10)/100+" km";return f?f+" m":""},dist2rad:function(f){return f/6371},getEngine:function(f){for(var d=null,k=1;!d&&k<arguments.length;k++)d=c(f,arguments[k]);d=d?d:c(f);if(!d)throw Error("Unable to find GEO engine with "+f+" capability");return d},lat2pix:b,lon2pix:q,pix2lat:h,pix2lon:l,radsPerPixel:function(f){return ha/(256<<f)},Position:Q,BoundingBox:wa,Radius:function(f,d){return{distance:parseInt(f,
10),uom:d}},Address:function(f){return f=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},f)},A:ya,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(f){if(!f.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var d=COG.extend({remove:function(){delete engines[d.id]}},f);return engines[d.id]=d},Search:La,GeoSearchResult:Oa,LocationSearch:function(f){function d(n,C){navigator.geolocation.clearWatch(o);
o=0;if(a){clearTimeout(a);a=0}C&&C([n],f)}function k(n){COG.info("caught location tracking error:",n)}f=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},f);var o=0,a=0,j=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(n,C){if(navigator.geolocation&&!o){o=navigator.geolocation.watchPosition(function(I){var ja=Q.init(I.coords.latitude,I.coords.longitude);I=new Oa({id:1,caption:"Current Location",pos:ja,accuracy:I.coords.accuracy/1E3,matchWeight:100});
if(!j||I.accuracy<j.accuracy)j=I;if(!f.requiredAccuracy||j.accuracy<f.requiredAccuracy)d(j,C)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(f.searchTimeout)a=setTimeout(function(){j&&d(j,C)},f.searchTimeout)}}},f))},Routing:db}}();return Ga}();
