COG=function(){var g=/\$\{(.*?)\}/ig,k=Object.prototype.hasOwnProperty,h=0,d={id:"grunt.core",extend:function(){var b=arguments[0]||{},f=1,e=arguments.length,a=false,n,l,p,o;if(typeof b==="boolean"){a=b;b=arguments[1]||{};f=2}if(typeof b!=="object"&&!d.isFunction(b))b={};if(e===f){b=this;--f}for(;f<e;f++)if((n=arguments[f])!=null)for(l in n){p=b[l];o=n[l];if(b!==o)if(a&&o&&(d.isPlainObject(o)||d.isArray(o))){p=p&&(d.isPlainObject(p)||d.isArray(p))?p:d.isArray(o)?[]:{};b[l]=d.extend(a,p,o)}else if(o!==
undefined)b[l]=o}return b},isFunction:function(b){return toString.call(b)==="[object Function]"},isArray:function(b){return toString.call(b)==="[object Array]"},isPlainObject:function(b){if(!b||toString.call(b)!=="[object Object]"||b.nodeType||b.setInterval)return false;if(b.constructor&&!k.call(b,"constructor")&&!k.call(b.constructor.prototype,"isPrototypeOf"))return false;var f;for(f in b);return f===undefined||k.call(b,f)},isEmptyObject:function(b){for(var f in b)return false;return true},isXmlDocument:function(b){return toString.call(b)===
"[object Document]"},contains:function(b,f){var e=b,a=arguments,n=1;if(f&&d.isArray(f)){a=f;n=0}for(n=n;n<a;n++)e=e&&typeof foo[a[n]]!=="undefined";return e},newModule:function(b){b=d.extend({id:null,requires:[],parent:null},b);if(b.parent)b=d.extend({},b.parent,b);return b},toID:function(b){return b.replace(/\s/g,"-")},objId:function(b){return(b?b:"obj")+h++},formatStr:function(b){if(arguments.length<=1)return b;for(var f=arguments.length-2,e=0;e<=f;e++)b=b.replace(RegExp("\\{"+e+"\\}","gi"),arguments[e+
1]);return b},wordExists:function(b,f){var e="";if(f.toString)f=f.toString();for(var a=0;a<f.length;a++)e+=!/\w/.test(f[a])?"\\"+f[a]:f[a];return RegExp("(^|\\s|\\,)"+e+"(\\,|\\s|$)","i").test(b)},parseTemplate:function(b,f){for(var e=g.exec(b);e;){b=b.replace(e[0],COG.XPath.first(e[1],f));g.lastIndex=0;e=g.exec(b)}return b}};return d}();
COG.Log=function(){function g(f,e){var a,n=e&&e.length>0?e[0]:"";for(a=1;e&&a<e.length;a++)n+=" "+(h&&COG.isPlainObject(e[a])?JSON.stringify(e[a]):e[a]);typeof console!=="undefined"&&console[f](n);for(a=0;a<k.length;a++)k[a].call(b,n,f)}var k=[],h=typeof JSON!=="undefined",d=window.console&&window.console.markTimeline,b={id:"grunt.log",getTraceTicks:function(){return d?(new Date).getTime():null},trace:function(f,e){if(d)console.markTimeline(f+(e?": "+(b.getTraceTicks()-e)+"ms":""))},debug:function(){g("debug",
arguments)},info:function(){g("info",arguments)},warn:function(){g("warn",arguments)},error:function(){g("error",arguments)},exception:function(f){b.error(arguments);for(var e in f)b.info("ERROR DETAIL: "+e+": "+f[e])},watch:function(f,e){try{e()}catch(a){b.exception(a,f)}},throwError:function(f){b.error(f);throw Error(f);},requestUpdates:function(f){k.push(f)}};return b}();
(function(){function g(d,b){d[b]||(d[b]=function(f){return d.configure(b,f)})}function k(d){d.gtConfId=COG.objId("configurable");d.gtConfig={};d.gtConfigFns=[];return d.gtConfig}var h={};COG.paramTweaker=function(d,b,f){return function(e,a){if(typeof a!=="undefined"){if(e in d)d[e]=a;f&&e in f&&f[e](e,a)}else return b&&e in b?b[e](e):d[e]}};COG.configurable=function(d,b,f,e){if(d){d.gtConfId||k(d);var a=d.gtConfId,n=d.gtConfig,l=d.gtConfigFns;h[a]=d;l.push(f);for(f=b.length;f--;){n[b[f]]=true;e&&
g(d,b[f])}if(!d.configure)d.configure=function(p,o){if(n[p]){for(var m=l.length;m--;){var t=l[m](p,o);if(typeof t!=="undefined")return t}return h[a]}return null}}}})();
(function(){function g(k,h){var d=k.gtObsHandlers;d[h]||(d[h]=[]);return d[h]}COG.observable=function(k){if(k){if(!k.gtObsHandlers)k.gtObsHandlers={};if(!(k.bind||k.trigger||k.unbind)){k.bind=function(h,d){var b=COG.objId("callback");g(k,h).unshift({fn:d,id:b});return b};k.trigger=function(h){var d=g(k,h),b={cancel:false,tickCount:(new Date).getTime()},f;if(!d)return null;f=Array.prototype.slice.call(arguments,1);f.unshift(b);for(var e=d.length;e--&&!b.cancel;)d[e].fn.apply(self,f);return b};k.unbind=
function(h,d){for(var b=g(k,h),f=0;b&&f<b.length;f++)if(b[f].id===d){b.splice(f,1);break}return k}}}}})();(function(){var g={},k=[];COG.addPipe=function(h){h("pipe.test",{});k.push(h)};COG.listen=function(h,d){g[h]||(g[h]=[]);d&&g[h].push(d)};COG.say=function(h,d){var b;for(b=k.length;b--;)k[b](h,d);if(g[h])for(b=g[h].length;b--;)g[h][b](d)}})();
COG.Loopage=function(){function g(o){return COG.extend({id:f++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},o)}function k(o){a.push(o);h()}function h(){n&&clearTimeout(n);n=setTimeout(d,0);p=true}function d(){for(var o,m=(new Date).getTime(),t=e.length;a.length>0;){var y=a.shift();for(o=t;o--;)if(e[o].id===y){e.splice(o,1);break}p=true;t=e.length}if(p){l=b;for(o=t;o--;)l=e[o].frequency<l?e[o].frequency:l}for(o=t;o--;){y=m-e[o].lastTick;if(e[o].lastTick===0||y>=e[o].frequency){e[o].execute(m,
e[o]);e[o].lastTick=m;e[o].single&&e[o].trigger("complete")}}n=t?setTimeout(d,l):0}var b=6E4,f=0,e=[],a=[],n=0,l=b,p=true;return{join:function(o){var m=new g(o);if(m.after>0)m.lastTick=(new Date).getTime()+m.after;COG.observable(m);m.bind("complete",function(){k(m.id)});e.unshift(m);h();return m},leave:k}}();if(!this.JSON)this.JSON={};
(function(){function g(l){return l<10?"0"+l:l}function k(l){b.lastIndex=0;return b.test(l)?'"'+l.replace(b,function(p){var o=a[p];return typeof o==="string"?o:"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+l+'"'}function h(l,p){var o,m,t,y,A=f,u,v=p[l];if(v&&typeof v==="object"&&typeof v.toJSON==="function")v=v.toJSON(l);if(typeof n==="function")v=n.call(p,l,v);switch(typeof v){case "string":return k(v);case "number":return isFinite(v)?String(v):"null";case "boolean":case "null":return String(v);
case "object":if(!v)return"null";f+=e;u=[];if(Object.prototype.toString.apply(v)==="[object Array]"){y=v.length;for(o=0;o<y;o+=1)u[o]=h(o,v)||"null";t=u.length===0?"[]":f?"[\n"+f+u.join(",\n"+f)+"\n"+A+"]":"["+u.join(",")+"]";f=A;return t}if(n&&typeof n==="object"){y=n.length;for(o=0;o<y;o+=1){m=n[o];if(typeof m==="string")if(t=h(m,v))u.push(k(m)+(f?": ":":")+t)}}else for(m in v)if(Object.hasOwnProperty.call(v,m))if(t=h(m,v))u.push(k(m)+(f?": ":":")+t);t=u.length===0?"{}":f?"{\n"+f+u.join(",\n"+f)+
"\n"+A+"}":"{"+u.join(",")+"}";f=A;return t}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+g(this.getUTCMonth()+1)+"-"+g(this.getUTCDate())+"T"+g(this.getUTCHours())+":"+g(this.getUTCMinutes())+":"+g(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,e,a={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},n;if(typeof JSON.stringify!=="function")JSON.stringify=function(l,p,o){var m;e=f="";if(typeof o==="number")for(m=0;m<o;m+=1)e+=" ";else if(typeof o==="string")e=o;if((n=p)&&typeof p!=="function"&&(typeof p!=="object"||typeof p.length!=="number"))throw Error("JSON.stringify");return h("",
{"":l})};if(typeof JSON.parse!=="function")JSON.parse=function(l,p){function o(t,y){var A,u,v=t[y];if(v&&typeof v==="object")for(A in v)if(Object.hasOwnProperty.call(v,A)){u=o(v,A);if(u!==undefined)v[A]=u;else delete v[A]}return p.call(t,y,v)}var m;l=String(l);d.lastIndex=0;if(d.test(l))l=l.replace(d,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=eval("("+l+")");return typeof p==="function"?o({"":m},""):m}throw new SyntaxError("JSON.parse");}})();
(function(){function g(h,d){var b=h.split("|"),f={};for(var e in d){var a=d[e];f[e]=b.length>a?b[a]:null}return f}var k={JSON:{parse:function(h){return JSON.parse(h)}},PDON:{parse:function(h){var d=null,b=[];h=h.split("\n");for(var f=0;f<h.length;f++){var e=h[f];if(d)b.push(g(e,d));else if(e){d=e.split("|");e={};for(var a=0;a<d.length;a++)e[d[a]]=a;d=e}else d=null}return b}}};COG.parseData=function(h,d){d=d?d.toUpperCase():"JSON";if(!k[d])throw Error("Unsupported data format: "+d);try{return k[d].parse(h)}catch(b){COG.Log.exception(b)}return{}}})();
COG.XPath=function(){function g(b){for(var f=null,e=0;e<k.length;e++)if(f=k[e](b))break;return f}var k=[],h=[null,function(b){return b.numberValue},function(b){return b.stringValue},function(b){return b.booleanValue},null,null,null,null,function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null},function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var d={SearchResult:function(b){return{toString:function(){var f=
null;if(b){var e=null;if(b.resultType>=0&&b.resultType<h.length)e=h[b.resultType];if(e)f=e(b)}return f?f:""}}},first:function(b,f){var e=d.SearchResult,a;var n=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!n)n=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(f))a=f.evaluate(b,f,g,n,null);else{COG.Log.warn("attempted xpath expression: "+b+" on a non-xml document");a=null}}catch(l){COG.Log.warn("invalid xpath expression: "+b+" on node: "+f);a=null}return new e(a)},registerResolver:function(b){k.push(b)}};return d}();
COG.Storage=function(){function g(k){if(k&&k=="session")return sessionStorage;return localStorage}return{get:function(k,h){var d=g(h).getItem(k);return/^(\{|\[).*(\}|\])$/.test(d)?JSON.parse(d):d},set:function(k,h,d){h=jQuery.isArray(h)||jQuery.isPlainObject(h)?JSON.stringify(h):h;g(d).setItem(k,h)},remove:function(k,h){g(h).removeItem(k)}}}();
COG.ParseRules=function(){var g=[];return{add:function(k,h){g.push({regex:k,handler:h})},each:function(k,h,d){function b(){f++;d&&f>=g.length&&d(h)}for(var f=0,e=0;e<g.length;e++){var a=g[e].regex,n=g[e].handler,l=false;if(a){a.lastIndex=-1;if((a=a.exec(k))&&n){l=true;n(a,h,b)&&b()}}l||b()}}}};
(function(){function g(a){var n=[],l=function(o,m){m=COG.isFunction(m)?m():m;n[n.length]=encodeURIComponent(o)+"="+encodeURIComponent(m)};if(COG.isArray(a))for(var p=0;p<a.length;p++)l(a[p].name,a[p].value);else for(p in a)l(p,a[p]);return n.join("&").replace(/%20/g,"+")}var k={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},h={JSON:["json"],PDON:["pdon.txt"]},d=["TEXT","STREAM"],b=/^(\w+:)?\/\/([^\/?#]+)/,f={XML:function(a){return a.responseXML},JSON:function(a){return COG.parseData(a.responseText)},
PDON:function(a){return COG.parseData(a.responseText,"PDON")},DEFAULT:function(a){return a.responseText}},e={CONTENT_TYPE:"Content-Type"};COG.xhr=function(a){function n(){if(this.readyState===4){var m=null,t=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(t)if(a.handleResponse)a.handleResponse(this);else{var y=a,A=this.getResponseHeader(e.CONTENT_TYPE),u,v=false;for(u in k)if(A&&A.indexOf(k[u])>=0){v=true;
break}A=!v;for(v=0;v<d.length;v++)A=A||d[v]==u;if(A)b:{A=u;for(var D in h)for(v=0;v<h[D].length;v++)if(RegExp(h[D][v]+"$","i").test(y.url)){u=D;break b}u=A?A:"DEFAULT"}try{m=f[u](this,y)}catch(B){m=f.DEFAULT(this,y)}}else a.error&&a.error(this)}catch(T){COG.Log.exception(T,"PROCESSING AJAX RESPONSE")}t&&m&&a.success&&a.success.call(this,m)}}try{a=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},a);var l=
b.exec(a.url),p=l&&(l[1]&&l[1]!==location.protocol||l[2]!==location.host);if(a.data)a.method="POST";if(a.url){l=null;if(a.xhr)l=a.xhr(a);l||(l=new XMLHttpRequest);l.open(a.method,a.url,a.async);a.data&&l.setRequestHeader("Content-Type",a.contentType);p||l.setRequestHeader("X-Requested-With","XMLHttpRequest");l.onreadystatechange=n;l.send(a.method=="POST"?g(a.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(o){COG.Log.exception(o)}}})();
(function(){function g(b){var f=document.createElement("script"),e=false;f.src=b;f.async=true;f.onload=f.onreadystatechange=function(){if(!e&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){e=true;f.onload=f.onreadystatechange=null;f&&f.parentNode&&f.parentNode.removeChild(f)}};h||(h=document.getElementsByTagName("head")[0]);h.appendChild(f)}var k=0,h,d=this;COG.jsonp=function(b,f,e){b+=b.indexOf("?")>=0?"&":"?";var a="json"+ ++k;d[a]=function(n){f(n);d[a]=null;try{delete d[a]}catch(l){}};
g(b+(e?e:"callback")+"="+a);return a}})();
COG.Touch=function(){function g(r,q){return{x:r.x-q.x,y:r.y-q.y}}function k(r,q){var s=g(r,q);return Math.sqrt(s.x*s.x+s.y*s.y)}function h(r){if(r.count>1)return k(r.touches[0],r.touches[1]);return 0}function d(r,q){var s=r&&r.count>0?r.touches[0]:null;if(s&&q&&q.count>0)return g(s,q.touches[0]);return null}function b(r,q){r.count=q.count;for(var s=l;s--;){r.touches[s].x=q.touches[s].x;r.touches[s].y=q.touches[s].y}}function f(){for(var r={count:0,touches:Array(l)},q=l;q--;)r.touches[q]=n();return r}
function e(r){if(r.preventDefault){r.preventDefault();r.stopPropagation()}else r.cancelBubble&&r.cancelBubble()}function a(r,q,s){if(L){q=q[s?s:"touches"];s=q.length;for(s=r.count=s;s--;){r.touches[s].x=q[s].pageX;r.touches[s].y=q[s].pageY}}else if(q.button===0){r.count=1;r.touches[0].x=q.pageX?q.pageX:q.screenX;r.touches[0].y=q.pageY?q.pageY:q.screenY}else r.count=0}function n(r,q){return{x:r?r:0,y:q?q:0}}var l=10,p=120,o=100,m=250,t=300,y=5,A=0,u=1,v=2,D=7,B=0,T=0,L=undefined,Y=function(r){function q(G,
M,I,z){var F=Math.asin((G.y-M.y)/I);I=I*(sa/z)>>0;I=I>oa?oa:I;F=M.x>G.x?F:Math.PI-F;C("pan",Math.cos(F)*-I,Math.sin(F)*I,true)}function s(G,M){var I,z;if(L){I=M-ka;if(I<m){z=k(Q.touches[0],G);z>r.inertiaTrigger&&q(Q.touches[0],G,z,I)}}else{ca.x=G.x;ca.y=G.y;COG.Loopage.join({execute:function(F,K){I=F-M;z=k(G,ca);if(I<o&&z>r.inertiaTrigger){K.trigger("complete");q(G,ca,z,I)}else I>o&&K.trigger("complete")},frequency:10})}}function x(G){var M=0,I=0;if(G.offsetParent){do{M+=G.offsetLeft;I+=G.offsetTop;
G=G.offsetParent}while(G)}return n(M,I)}function w(G){var M=G.count,I=Array(M),z=x(ea);for(M=M;M--;)I[M]=n(G.touches[M].x-z.x,G.touches[M].y-z.y);return I}function C(){qa&&qa.trigger.apply(null,arguments)}function E(G){var M=G.target?G.target:G.srcElement;if(Z||M&&M===ea){a(Q,G);if(Q.count!==0){aa=null;ba.x=0;ba.y=0;la=true;P=false;ka=(new Date).getTime();e(G);M.style.cursor="move";C("inertiaCancel");ma=ka;if(G=Q.count>0?Q.touches[0]:null){C("touchStart",G.x,G.y);if(ma-pa<t)if((G=g(Q.touches[0],da.touches[0]))&&
Math.abs(G.x)<r.maxDistDoubleTap&&Math.abs(G.y)<r.maxDistDoubleTap)P=true;O=A;b(da,Q)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function H(G){var M=G.target?G.target:G.srcElement,I=0;if(Z||M&&M===ea){a(X,G);if(X.count>0){ca.x=X.touches[0].x;ca.y=X.touches[0].y}if(la){L&&e(G);if(X.count>1){Q.count===1&&b(Q,X);I=h(Q)-h(X)}if(O===A)if((G=d(X,Q))&&(Math.abs(G.x)>=D||Math.abs(G.y)>=D))O=u;if(O!==A)if(!I||Math.abs(I)<y){if(aa=d(X,da)){ba.x-=aa.x;ba.y-=aa.y;ha.x-=aa.x;ha.y-=aa.y}C("pan",
ha.x,ha.y);ha.x=0;ha.y=0;O=u}else{C("pinchZoom",w(Q),w(X));O=v}b(da,X)}}}function J(G){var M=G.target?G.target:G.srcElement;if(la&&(Z||M&&M===ea)){a($,G,"changedTouches");var I=$.touches[0];L&&e(G);G=(new Date).getTime();pa=ma;if(O===A)W||(W=setTimeout(function(){W=0;var z=P?"doubleTap":"tap",F=Q.touches[0],K=x(ea);K=n(F.x-K.x,F.y-K.y);C(z,F,K)},t+50));else if(O==u){C("panEnd",ba.x,ba.y);ra&&s(I,G)}else O==v&&C("pinchZoomEnd",w(Q),w(da),G-ka);M.style.cursor="default";la=false}}function R(G){var M=
G.target?G.target:G.srcElement;if(Z||M&&M===ea){if(G.detail){M=-G.detail*p;M=n(G.axis===1?M:0,G.axis===2?M:0)}else M=n(G.wheelDeltaX,G.wheelDeltaY);var I=M.y!==0?Math.abs(M.y/p):0;if(ca&&I!==0){var z=n(ca.x-ea.offsetLeft,ca.y-ea.offsetTop);C("wheelZoom",z,Math.pow(2,M.y>0?I:-I))}e(G)}}r=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,
wheelZoomHandler:null},r);var P=false,W=0,U=T5.getConfig(),Q=f(),X=f(),da=f(),$=f(),aa=null,ba=n(),ha=n(),O=null,la=false,ka=0,ia=[],ca=n(),ra=false,sa,oa,ma=0,pa=0,ea=r.element,qa=r.observable,Z=typeof FlashCanvas!=="undefined",ta={supportsTouch:L,addListeners:function(G){ia.push(G)},decoupleListeners:function(G){for(var M=0;G&&M<ia.length;M++)if(ia[M].listenerId===G){ia.splice(M,1);break}},release:function(){U.unbindEvent(L?"touchstart":"mousedown",E,false);U.unbindEvent(L?"touchmove":"mousemove",
H,false);U.unbindEvent(L?"touchend":"mouseup",J,false);if(!L){window.removeEventListener("mousewheel",R,false);window.removeEventListener("DOMMouseScroll",R,false)}},inertiaEnable:function(G,M){ra=true;sa=G;oa=M?Math.min(M.width,M.height):500},inertiaDisable:function(){ra=false}};if(typeof L==="undefined")L=T5.getConfig().supportsTouch;U.bindEvent(L?"touchstart":"mousedown",E,false);U.bindEvent(L?"touchmove":"mousemove",H,false);U.bindEvent(L?"touchend":"mouseup",J,false);if(!L){U.bindEvent("mousewheel",
R,window);U.bindEvent("DOMMouseScroll",R,window)}return ta},S=[];return{capture:function(r,q){if(!r)throw Error("Unable to capture touch of null element");if(!r.id)r.id="touchable_"+B++;var s=S[r.id];if(!s){s=new Y(COG.extend({element:r},q));S[r.id]=s}if(q){q.listenerId&&s.decoupleListeners(q.listenerId);q.listenerId=++T;s.addListeners(q)}return s},release:function(r){if(r&&r.id&&S[r.id]){S[r.id].release();delete S[r.id]}}}}();
T5=function(){var g=function(e,a){return{x:e?e:0,y:a?a:0}},k=function(){function e(a,n){if(!n)n=a.length;if(n<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var l={edges:Array(n-1),accrued:Array(n-1),total:0},p=k.diff,o=0;o<n-1;o++){var m=p(a[o],a[o+1]);l.edges[o]=Math.sqrt(m.x*m.x+m.y*m.y);l.accrued[o]=l.total+l.edges[o];l.total+=l.edges[o]}return l}return{VECTOR_SIMPLIFICATION:4,create:function(a,n){return new g(a,n)},add:function(){for(var a=new g,n=
arguments.length;n--;){a.x+=arguments[n].x;a.y+=arguments[n].y}return a},absSize:function(a){return Math.max(Math.abs(a.x),Math.abs(a.y))},diff:function(a,n){return new g(a.x-n.x,a.y-n.y)},copy:function(a){return a?new g(a.x,a.y):null},invert:function(a){return new g(-a.x,-a.y)},offset:function(a,n,l){return new g(a.x+n,a.y+(l?l:n))},edges:e,distance:function(a,n){return e(a,n).total},simplify:function(a,n){if(!a)return null;n=n?n:k.VECTOR_SIMPLIFICATION;for(var l=[],p=null,o=a.length;o--;){var m=
a[o];if(include=!p||o===0||Math.abs(m.x-p.x)+Math.abs(m.y-p.y)>n){l.unshift(m);p=m}}return l},theta:function(a,n,l){l=Math.asin((a.y-n.y)/l);return a.x>n.x?l:Math.PI-l},pointOnEdge:function(a,n,l,p){n=new g(Math.cos(l)*p,Math.sin(l)*p);return new g(a.x-n.x,a.y-n.y)},getRect:function(a){var n=a.length;if(n>1)return new h(Math.min(a[0].x,a[n-1].x),Math.min(a[0].y,a[n-1].y),Math.abs(a[0].x-a[n-1].x),Math.abs(a[0].y-a[n-1].y))},toString:function(a){return a.x+", "+a.y}}}(),h=function(e,a,n,l){return{origin:new g(e,
a),dimensions:new b(n,l),invalid:false}},d=function(){return{bottomRight:function(e){return k.offset(e.origin,e.dimensions.width,e.dimensions.height)},empty:function(){return new h(0,0,0,0)},copy:function(e){return e?new h(e.origin.x,e.origin.y,e.dimensions.width,e.dimensions.height):null},getCenter:function(e){return new g(e.origin.x+e.dimensions.width/2,e.origin.y+e.dimensions.height/2)},isEmpty:function(e){return e.dimensions.width===0||e.dimensions.height===0},union:function(){if(!(arguments.length<
2)){for(var e=arguments[0].origin.y,a=arguments[0].origin.x,n=e+arguments[0].dimensions.height,l=a+arguments[0].dimensions.width,p=Array.prototype.slice.call(arguments,1),o=p.length;o--;){var m=p[o].origin.y,t=p[o].origin.x,y=m+p[o].dimensions.height,A=t+p[o].dimensions.width;e=e<m?e:m;a=a<t?a:t;n=n>y?n:y;l=l>A?l:A}arguments[0].origin.x=a;arguments[0].origin.y=e;arguments[0].dimensions.width=l-a;arguments[0].dimensions.height=n-e}}}}(),b=function(e,a){return{width:e?e:0,height:a?a:0}},f=function(){return{getAspectRatio:function(e){return e.height!==
0?e.width/e.height:1},getCenter:function(e){return new g(e.width/2,e.height/2)},getSize:function(e){return Math.sqrt(Math.pow(e.width,2)+Math.pow(e.height,2))}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},Vector:g,V:k,Dimensions:b,D:f,Rect:h,R:d}}();
(function(){function g(){for(;y.length>0;){var u=y.shift();document.location=u}t=0}function k(u){for(var v=true,D=A.length;D--;)v=v&&u!=A[D];return v}function h(u,v){var D=[];for(var B in v)B&&D.push(B+"="+escape(v[B]));return"tile5://"+u+"/"+(D.length>0?"?"+D.join("&"):"")}function d(u,v){k(u)&&COG.Log.info("would push url: "+h(u,v))}function b(u,v){if(k(u)){y.push(h(u,v));t||(t=setTimeout(g,100))}}function f(u){return function(v,D,B){(B?B:u?document.body:document).addEventListener(v,D,false)}}function e(u){return function(v,
D,B){(B?B:u?document.body:document).removeEventListener(v,D,false)}}function a(u,v,D){(D?D:document).attachEvent("on"+u,v)}function n(u,v,D){(D?D:document).detachEvent("on"+u,v)}function l(){p={base:{name:"Unknown",bindEvent:f(),unbindEvent:e(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:d,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:a,unbindEvent:n,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:b,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:b},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:b},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:f(true),unbindEvent:e(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:b},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:b}};o=[p.froyo,p.android,p.ipod,p.iphone,p.ipad,p.ie]}var p=null,o=[],m=null,t=0,y=[],A=["view.wake","tile.loaded"];T5.getConfig=function(){p||l();if(!m){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var u=0;u<o.length;u++){var v=o[u];if(v.regex&&v.regex.test(navigator.userAgent)){m=T5.ex({},p.base,v);COG.Log.info("PLATFORM DETECTED AS: "+m.name);break}}if(!m){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
m=p.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return m}})();
T5.Dispatcher=function(){var g=[],k={execute:function(h){var d=k.findAction(h);d&&d.execute.apply(d,Array.prototype.slice.call(arguments,1))},findAction:function(h){for(var d=g.length;d--;)if(g[d].id==h)return g[d];return null},getRegisteredActions:function(){return[].concat(g)},getRegisteredActionIds:function(){for(var h=[],d=g.length;d--;)g[d].id&&h.push(g[d].id);return h},registerAction:function(h){h&&h.id&&g.push(h)},Action:function(h){h=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},h);var d={id:h.id,execute:function(){h.execute&&h.execute.apply(this,arguments)},getParam:function(b){return h[b]?h[b]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",d.id,h.title,h.icon)}};h.autoRegister&&k.registerAction(d);return d},Agent:function(h){h=COG.extend({name:"Untitled",translator:null,execute:null},h);var d={getName:function(){return h.name},getParam:function(b){return h[b]},getId:function(){return COG.toID(d.getName())},run:function(b,f){if(h.execute){var e=
h.translator?h.translator(b):b;h.execute.call(d,e,function(a,n){f&&f(a,n,e)})}}};return d},runAgents:function(h,d,b){for(var f=0;f<h.length;f++)h[f].run(d,b)}};return k}();
T5.Resources=function(){var g="",k={},h={getPath:function(d){return/^(file|https?|\/)/.test(d)?d:g+d},setBasePath:function(d){g=d},loadResource:function(d){d=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},d);var b=function(f){d.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){d.callback(f)})};d.cacheable&&k[d.filename]?b(k[d.filename]):COG.xhr({url:h.getPath(d.filename),dataType:d.dataType,success:function(f){if(d.cacheable)k[d.filename]=f;b(f)},error:function(f,e,a){COG.Log.error("error loading resource ["+
d.filename+"], error = "+a)}})},loadSnippet:function(d,b){/\.\w+$/.test(d)||(d+=".html");h.loadResource({filename:"snippets/"+d,callback:b,dataType:"html"})}};return h}();
T5.Images=function(){function g(){if(!t){var u=T5.getConfig().maxImageLoads;t=COG.Loopage.join({execute:function(v,D){if(!u||p.length<u){var B=l.shift();if(B){p[p.length]=B;B.image.onload=h;B.image.src=T5.Resources.getPath(B.url);B.requested=T5.ticks()}else D.trigger("complete")}},frequency:10});t.bind("complete",function(){t=null})}}function k(){y=true;try{var u=o.length/2>>0;if(u>0){o.sort(function(D,B){return D.created-B.created});for(var v=u;v--;)delete f[o[v].url];o.splice(0,u)}}finally{y=false}COG.say("imagecache.cleared")}
function h(){var u=a[this.id];if(u&&u.image.complete&&u.image.width>0){u.loaded=true;u.hitCount=1;for(var v=p.length;v--;)if(p[v].image.src==this.src){p.splice(v,1);break}if(u.background||u.postProcess||u.drawBackground||u.customDraw)if(u.image){v=b(u.realSize?u.realSize.width:image.width,u.realSize?u.realSize.height:image.height);var D=v.getContext("2d"),B=u.offset?u.offset:new T5.Vector;u.background&&D.drawImage(u.background,0,0);u.drawBackground&&u.drawBackground(D);u.customDraw?u.customDraw(D,
u):D.drawImage(u.image,B.x,B.y);u.postProcess&&u.postProcess(D,u);u.image=v}u.loadCallback&&u.loadCallback(this,false);o[o.length]={url:this.src,created:u.requested};delete a[this.id];g()}}function d(u,v,D){var B=f[u];if(B){B.hitCount++;B.image.complete&&v&&v(B.image,true)}else{B=T5.ex({url:u,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,loadCallback:v},D);B.image.id="resourceLoaderImage"+n++;f[u]=B;a[B.image.id]=B;l[l.length]=B;g()}return B}function b(u,v){var D=document.createElement("canvas");
D.width=u?u:0;D.height=v?v:0;if(typeof FlashCanvas!=="undefined"){D.id="tmpCanvas"+e++;D.style.cssText="position: absolute; top: -"+(v-1)+"px; left: -"+(u-1)+"px;";document.body.appendChild(D);FlashCanvas.initElement(D)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(D);return D}var f={},e=0,a={},n=0,l=[],p=[],o=[],m=0,t=null,y=false,A={avgImageSize:25,loadTimeout:10,cancelLoad:function(){p=[]},get:function(u,v){var D=null,B=null;y||(D=f[u]);if((B=D?D.image:null)&&(B.getContext||
B.complete&&B.width>0))return B;else v&&d(u,v);return null},load:d,newCanvas:b,stats:function(){return{imageLoadingCount:p.length,queuedImageCount:l.length,imageCacheFullness:m}}};COG.Loopage.join({execute:function(u){for(var v=false,D=0,B=T5.getConfig();D<p.length;)if(u-p[D].requested>A.loadTimeout*1E3){p.splice(D,1);v=true}else D++;v&&g();if(B&&B.imageCacheMaxSize){m=o.length*A.avgImageSize/B.imageCacheMaxSize;m>=1&&k()}},frequency:2E4});return A}();
T5.TimeLord=function(){var g=/^P(\d+Y)?(\d+M)?(\d+D)?$/,k=/^(\d+H)?(\d+M)?(\d+S)?$/,h=function(b,f){return{days:b?b:0,seconds:f?f:0}},d={8601:function(b){b=b.split("T");var f=null;f=null;var e=0,a=0;g.lastIndex=-1;f=g.exec(b[0]);e+=f[3]?parseInt(f[3].slice(0,-1),10):0;k.lastIndex=-1;f=k.exec(b[1]);a+=f[1]?parseInt(f[1].slice(0,-1),10)*3600:0;a+=f[2]?parseInt(f[2].slice(0,-1),10)*60:0;a+=f[3]?parseInt(f[3].slice(0,-1),10):0;return new h(e,a)}};return{Duration:h,addDuration:function(){for(var b=new h,
f=arguments.length;f--;){b.days+=arguments[f].days;b.seconds+=arguments[f].seconds}if(b.seconds>=86400){b.days+=~~(b.seconds/86400);b.seconds%=86400}return b},parseDuration:function(b,f){var e=f?d[f]:null;if(e)return e(b);COG.Log.warn("Could not find duration parser for specified format: "+f);return new h},formatDuration:function(b){var f,e,a="";if(b.days)a=b.days+" days ";if(b.seconds){b=b.seconds;if(b>=3600){f=~~(b/3600);b-=f*3600}if(b>=60){e=Math.round(b/60);b-=e*60}if(f)a=a+f+(f>1?" hrs ":" hr ")+
(e?(e>10?e:"0"+e)+" min ":"");else if(e)a=a+e+" min";else if(b>0)a=a+(b>10?b:"0"+b)+" sec"}return a}}}();
(function(){var g=Math.PI*2,k=Math.PI/2,h=Math.abs,d=Math.pow,b=Math.sin,f=Math.asin,e=Math.cos,a=1.70158,n={linear:function(l,p,o,m){return o*l/m+p},backin:function(l,p,o,m){return o*(l/=m)*l*((a+1)*l-a)+p},backout:function(l,p,o,m){return o*((l=l/m-1)*l*((a+1)*l+a)+1)+p},backinout:function(l,p,o,m){return(l/=m/2)<1?o/2*l*l*(((a*=1.525)+1)*l-a)+p:o/2*((l-=2)*l*(((a*=1.525)+1)*l+a)+2)+p},bouncein:function(l,p,o,m){return o-n.bounceout(m-l,0,o,m)+p},bounceout:function(l,p,o,m){return(l/=m)<1/2.75?
o*7.5625*l*l+p:l<2/2.75?o*(7.5625*(l-=1.5/2.75)*l+0.75)+p:l<2.5/2.75?o*(7.5625*(l-=2.25/2.75)*l+0.9375)+p:o*(7.5625*(l-=2.625/2.75)*l+0.984375)+p},bounceinout:function(l,p,o,m){return l<m/2?n.bouncein(l*2,0,o,m)/2+p:n.bounceout(l*2-m,0,o,m)/2+o/2+p},cubicin:function(l,p,o,m){return o*(l/=m)*l*l+p},cubicout:function(l,p,o,m){return o*((l=l/m-1)*l*l+1)+p},cubicinout:function(l,p,o,m){if((l/=m/2)<1)return o/2*l*l*l+p;return o/2*((l-=2)*l*l+2)+p},elasticin:function(l,p,o,m,t,y){if(l==0)return p;if((l/=
m)==1)return p+o;y||(y=m*0.3);if(!t||t<h(o)){t=o;o=y/4}else o=y/g*f(o/t);return-(t*d(2,10*(l-=1))*b((l*m-o)*g/y))+p},elasticout:function(l,p,o,m,t,y){var A;if(l==0)return p;if((l/=m)==1)return p+o;y||(y=m*0.3);if(!t||t<h(o)){t=o;A=y/4}else A=y/g*f(o/t);return t*d(2,-10*l)*b((l*m-A)*g/y)+o+p},elasticinout:function(l,p,o,m,t,y){var A;if(l==0)return p;if((l/=m/2)==2)return p+o;y||(y=m*0.3*1.5);if(!t||t<h(o)){t=o;A=y/4}else A=y/g*f(o/t);if(l<1)return-0.5*t*d(2,10*(l-=1))*b((l*m-A)*g/y)+p;return t*d(2,
-10*(l-=1))*b((l*m-A)*g/y)*0.5+o+p},quadin:function(l,p,o,m){return o*(l/=m)*l+p},quadout:function(l,p,o,m){return-o*(l/=m)*(l-2)+p},quadinout:function(l,p,o,m){if((l/=m/2)<1)return o/2*l*l+p;return-o/2*(--l*(l-2)-1)+p},sinein:function(l,p,o,m){return-o*e(l/m*k)+o+p},sineout:function(l,p,o,m){return o*b(l/m*k)+p},sineinout:function(l,p,o,m){return-o/2*(e(Math.PI*l/m)-1)+p}};T5.easing=function(l){return n[l.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(l,p){n[l.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=p}})();
T5.Tween=function(g){g=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},g);var k=T5.ticks(),h=[],d=false,b=0,f=0,e={cancelOnInteract:g.cancelOnInteract,isComplete:function(){return d},triggerComplete:function(a){g.complete&&g.complete(a)},update:function(a){try{var n=g.tweenFn(a-k,b,f,g.duration);if(g.target)g.target[g.property]=n;for(var l=h.length;l--;)h[l](n,void 0);if(d=k+g.duration<=a){if(g.target)g.target[g.property]=
g.tweenFn(g.duration,b,f,g.duration);for(var p=h.length;p--;)h[p](n,true)}}catch(o){COG.Log.exception(o)}},requestUpdates:function(a){h.push(a)}};b=g.target&&g.property&&g.target[g.property]?g.target[g.property]:g.startValue;if(typeof g.endValue!=="undefined")f=g.endValue-b;if(f==0)d=true;T5.wakeTweens();return e};
(function(){function g(b){if(d)return k.length;d=true;try{for(var f=0;f<k.length;)if(k[f].isComplete()){k[f].triggerComplete(false);k.splice(f,1)}else{k[f].update(b);f++}}finally{d=false}k.length===0&&h.trigger("complete");return k.length}var k=[],h=null,d=false;T5.tweenValue=function(b,f,e,a,n){b=new T5.Tween({startValue:b,endValue:f,tweenFn:e,complete:a,duration:n});k.push(b);return b};T5.tween=function(b,f,e,a,n,l){b=new T5.Tween({target:b,property:f,endValue:e,tweenFn:a,duration:l,complete:n});
k.push(b);return b};T5.tweenVector=function(b,f,e,a,n,l){var p=[];if(b){var o=b.x==f,m=b.y==e;o||p.push(T5.tween(b,"x",f,a,function(){(o=true)&&m&&n()},l));m||p.push(T5.tween(b,"y",e,a,function(){m=true;o&&m&&n()},l))}return p};T5.cancelAnimation=function(b){if(!d){d=true;try{for(var f=0;f<k.length;)if(!b||b(k[f])){k[f].triggerComplete(true);k.splice(f,1)}else f++}finally{d=false}}};T5.isTweening=function(){return k.length>0};T5.wakeTweens=function(){if(!h){h=COG.Loopage.join({execute:g,frequency:20});
h.bind("complete",function(){h=null})}}})();(function(){var g={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,PINCH:16,FREEZE:128};T5.viewState=function(){for(var k=0,h=arguments.length;h--;){var d=g[arguments[h].toUpperCase()];if(d)k|=d}return k}})();
T5.ViewLayer=function(g){g=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","PINCH")},g);var k=null,h=false,d=false,b=g.supportFastDraw,f=g.id,e=T5.viewState("ACTIVE"),a=g.validStates,n=0,l=0,p=T5.ex({addToView:function(o){o.setLayer(f,p)},shouldDraw:function(o,m,t){o=(o&a)!==0&&(h?b:true);return o=d||t||n!==m.x||l!==m.y},cycle:function(){},draw:function(){},remove:function(){COG.say("layer.remove",{id:f})},changed:function(){d=true;p.trigger("changed",
p);k&&k.trigger("invalidate")},getId:function(){return f},setId:function(o){f=o},getParent:function(){return k},setParent:function(o){h=(k=o)?k.fastDraw&&displayState!==e:false;p.trigger("parentChange",k)}},g);COG.observable(p);p.bind("drawComplete",function(o,m){d=false;n=m.x;l=m.y});return p};
T5.View=function(g){function k(z,F,K,N){Z=pa;D();if(N&&g.inertia){P=true;l(S+F,r+K,g.panAnimationEasing,g.panAnimationDuration)}else N||l(S+F,r+K)}function h(){Z=ma;P=false;COG.Loopage.join({execute:D,after:50,single:true})}function d(z,F){$=ta(z);aa=ta(F);var K=G($.dimensions),N=G(aa.dimensions);ca=M($);J=M(aa);O=$&&K!==0?N/K:1}function b(z,F,K){d(F,K);if(da=O!==1){Z=ea;D()}}function f(z,F,K,N){d(F,K);if(g.adjustScaleFactor){O=g.adjustScaleFactor(O);COG.Log.info("scale factor adjusted to: "+O)}if(N<
g.pinchZoomAnimateTrigger){m(ka,O,ca,t(),T5.easing("sine.out"),function(){a();O=1},300);O=ka}else{a();O=1}}function e(z,F,K){I.zoom(F,Math.min(Math.pow(2,Math.round(Math.log(K))),8),500)}function a(){da=false;I.trigger("scale",O,$?t():J);Z=ma;D()}function n(){clearTimeout(ha);ha=setTimeout(p,50)}function l(z,F,K,N,V){function fa(){ga+=1;if(ga>=2){h(0,0);V&&V()}}var ga=0;if(K){z=T5.tweenValue(S,z,K,fa,N);F=T5.tweenValue(r,F,K,fa,N);z.cancelOnInteract=true;z.requestUpdates(function(ja){S=ja;P=true;
D()});F.cancelOnInteract=true;F.requestUpdates(function(ja){r=ja;P=true;D()})}else{S=z;r=F}}function p(){var z;if(L){COG.Touch.release(L);if(g.autoSize&&L.parentNode){z=L.parentNode.getBoundingClientRect();if(z.height!==0&&z.width!==0){L.height=z.height;L.width=z.width}}try{if(!L.id)L.id=g.id+"_canvas";Y=L.getContext("2d");Y.clearRect(0,0,L.width,L.height)}catch(F){COG.Log.exception(F);throw Error("Could not initialise canvas on specified view element");}oa=COG.Touch.capture(L,{observable:I});if(E.height!==
L.height||E.width!==L.width){E=new T5.Dimensions(L.width,L.height);I.trigger("resize",L.width,L.height);for(z=T;z--;)B[z].trigger("resize",L.width,L.height)}g.inertia&&oa.inertiaEnable(g.panAnimationDuration,E);for(z=T;z--;)B[z].trigger("contextChanged",Y);v()}}function o(z,F){F.setId(z);F.added=T5.ticks();F.trigger("contextChanged",Y);F.setParent(I);B.push(F);B.sort(function(K,N){var V=N.zindex-K.zindex;if(V===0)V=N.added-K.added;return V});T=B.length;return F}function m(z,F,K,N,V,fa,ga){function ja(){fa&&
fa();a();O=1;ia=null}da=true;ca=T5.V.copy(K);J=T5.V.copy(N);$=null;if(V)T5.tweenValue(0,F-z,V,ja,ga?ga:1E3).requestUpdates(function(na){ia=na/(F-z);O=z+na;Z=ea;D();I.trigger("animate")});else{O=targetScaleFactor;ja()}}function t(){var z=T5.D.getCenter(E),F=T5.V.distance([J,z]),K=T5.V.theta(J,z,F),N=T5.V.diff(ca,J);z=T5.V.pointOnEdge(J,z,K,F/O);z.x+=N.x;z.y+=N.y;return z}function y(){I.trigger("idle");R=true;W=0}function A(z,F,K,N){var V=P?pa:w?T5.viewState("FROZEN"):Z,fa=(V&ea)!==0,ga=0;if(s||fa){z.clearRect(0,
0,L.width,L.height);s=false}if(fa){T5.D.getCenter(E);var ja=(ia?ia:1)/2,na=T5.V.diff(ca,J);if($){Q.x=J.x+na.x;Q.y=J.y+na.y}else{Q.x=J.x-na.x*ja;Q.y=J.y-na.y*ja}F=T5.V.offset(F,Q.x,Q.y)}z.save();try{ka=O;if(C!==1)z.scale(C,C);else if(fa){z.translate(J.x,J.y);z.scale(O,O)}for(ga=T;ga--;)if(B[ga].shouldDraw(V,F,K)){B[ga].draw(z,F,E,V,I,K,N);B[ga].trigger("drawComplete",F,N)}}finally{z.restore()}I.trigger("drawComplete",F,N);COG.Log.trace("draw complete",N)}function u(z,F){var K=false,N=!P&&(Z===ea||
Z===pa),V=ba||Z===T5.viewState("PAN")||Z===T5.viewState("PINCH")||T5.isTweening();q.x=S>>0;q.y=r>>0;if(N){T5.cancelAnimation(function(fa){return fa.cancelOnInteract});R=false;if(W!==0){clearTimeout(W);W=0}}for(N=T;N--;){if(B[N].animated)Z|=qa;K=B[N].cycle(z,q,Z,V)||K}V=V||(Z&qa)!==0;if(K=K||V||O!==1&&O!==la){A(Y,q,V,z);la=O;ba=false}if(!K&&H===0&&!ra){if(!R&&W===0)W=setTimeout(y,500);F.trigger("complete")}H=0;COG.Log.trace("Completed draw cycle",z)}function v(){ba=true;D()}function D(){H+=1;if(!(w||
x)){x=COG.Loopage.join({execute:u,frequency:sa});x.bind("complete",function(){x=null})}}g=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},g);var B=[],T=0,L=document.getElementById(g.container),Y=null,S=0,r=0,q=new T5.Vector,s=false,x=null,w=false,C=1,E=new T5.Dimensions,H=0,J=null,R=false,P=false,W=
0,U=0,Q=new T5.Vector,X=0,da=false,$=null,aa=null,ba=false,ha=0,O=1,la=0,ka=1,ia=null,ca=null,ra=typeof FlashCanvas!=="undefined",sa=~~(1E3/g.fps),oa=null,ma=T5.viewState("ACTIVE"),pa=T5.viewState("PAN"),ea=T5.viewState("PINCH"),qa=T5.viewState("ANIMATING"),Z=ma,ta=T5.V.getRect,G=T5.D.getSize,M=T5.R.getCenter,I={id:g.id,deviceScaling:C,fastDraw:g.fastDraw||T5.getConfig().requireFastDraw,animate:function(z,F,K,N,V){m(O,z,F,K,N,V)},centerOn:function(z){S=z.x-L.width/2;r=z.y-L.height/2},getDimensions:function(){return E},
getZoomCenter:function(){return Q},getLayer:function(z){for(var F=0;F<T;F++)if(B[F].getId()==z)return B[F];return null},setLayer:function(z,F){for(var K=0;K<T;K++)if(B[K].getId()===z){B.splice(K,1);break}F&&o(z,F);v()},eachLayer:function(z){for(var F=T;F--;)z(B[F])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");s=true;v()},invalidate:v,freeze:function(){w=true},unfreeze:function(){w=false;D()},resize:function(z,F){if(L){g.autoSize=false;L.width=z;L.height=F;
p();I.trigger("resize",L.width,L.height)}},scale:function(z,F,K,N,V){N||(N=T5.D.getCenter(E));V||(V=T5.D.getCenter(E));I.animate(z,N,V,F,K);return I},removeLayer:function(z){a:{for(var F=T;F--;)if(B[F].getId()==z){z=F;break a}z=-1}if(z>=0&&z<T){COG.say("layer.removed",{layer:B[z]});B.splice(z,1);v()}T=B.length},getOffset:function(){return q},updateOffset:l,zoom:function(z,F,K){P=false;O=F;da=O!==1;ca=T5.D.getCenter(E);J=O>1?T5.V.copy(z):T5.D.getCenter(E);$=null;clearTimeout(U);if(da){Z=ea;D();if(K)U=
setTimeout(function(){a();O=1},parseInt(K,10))}}};COG.listen("layer.remove",function(z){z.id&&I.removeLayer(z.id)});C=T5.getConfig().getScaling();I.markers=o("markers",new T5.MarkerLayer);COG.observable(I);I.bind("wake",D);I.bind("invalidate",v);if(g.pannable){I.bind("pan",k);I.bind("panEnd",h);I.bind("inertiaCancel",function(){P=false;D()})}if(g.scalable){I.bind("pinchZoom",b);I.bind("pinchZoomEnd",f);I.bind("wheelZoom",e)}I.bind("tap",function(z,F,K){for(var N=T5.V.offset(K,S,r),V=B.length;V--;)z.cancel=
z.cancel||B[V].trigger("tap",F,K,N).cancel});COG.configurable(I,["inertia","container","rotation","tapExtent"],COG.paramTweaker(g,null,{container:function(z,F){L=document.getElementById(F);p()},rotation:function(z,F){X=F}}),true);p();g.autoSize&&window.addEventListener("resize",n,false);return I};
T5.PathLayer=function(g){function k(p){p.syncVectors(f);e&&p.syncVectors(e);l.trigger("tidy")}g=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},g);var h=false,d=[],b=null,f=[],e=null,a=0,n=[],l=T5.ex(new T5.ViewLayer(g),{getAnimation:function(p,o,m,t){var y="pathAnimation"+a++;n.push(y);return new T5.AnimatedPathLayer({id:y,path:d,zindex:g.zindex+1,easing:p?p:T5.easing("sine.inout"),duration:o?o:5E3,drawIndicator:m,autoCenter:t?t:false})},cycle:function(p,o,m,t){return t},draw:function(p,
o){var m,t=d.length;p.save();try{T5.applyStyle(p,g.style);if(t>0){p.beginPath();p.moveTo(d[t-1].x-o.x,d[t-1].y-o.y);for(m=t;m--;)p.lineTo(d[m].x-o.x,d[m].y-o.y);p.stroke();if(b){p.fillStyle=g.waypointFillStyle;for(m=b.length;m--;){p.beginPath();p.arc(b[m].x-o.x,b[m].y-o.y,2,0,Math.PI*2,false);p.stroke();p.fill()}}}}finally{p.restore()}h=false},updateCoordinates:function(p,o){var m=l.getParent();m=m?m.getTileLayer():null;f=p;e=o;COG.Log.info("updating coordinates, grid = "+m);m&&k(m)}});l.bind("gridUpdate",
function(p,o){k(o);for(var m=n.length;m--;)COG.say("layer.remove",{id:n[m]});n=[]});l.bind("tidy",function(){d=T5.V.simplify(f,g.pixelGeneralization);b=T5.V.simplify(e,g.pixelGeneralization);h=true;l.changed()});return l};
T5.Poly=function(g,k){k=T5.ex({fill:false,style:null},k);var h=false,d=k.fill,b=k.style,f=[],e={draw:function(a,n,l){if(h){var p=true,o=b?T5.applyStyle(a,k.style):null;a.beginPath();for(var m=f.length;m--;){var t=f[m].x-n,y=f[m].y-l;if(p){a.moveTo(t,y);p=false}else a.lineTo(t,y)}d&&a.fill();a.stroke();o&&T5.applyStyle(a,o)}},resync:function(a){a.syncVectors(g);f=g.length<=3?g:T5.V.simplify(g)}};h=g&&g.length>=2;return e};
T5.PolyLayer=function(g){g=T5.ex({zindex:80,style:null},g);var k=[],h=false,d=T5.ex(new T5.ViewLayer(g),{add:function(b){k.unshift(b)},cycle:function(){return h},draw:function(b,f,e,a){e=f.x;f=f.y;b.save();try{T5.applyStyle(b,g.style);for(var n=k.length;n--;)k[n].draw(b,e,f,a)}finally{b.restore()}h=false}});d.bind("gridUpdate",function(b,f){for(var e=k.length;e--;)k[e].resync(f);h=true;d.changed()});d.bind("parentChange",function(b,f){var e=f?f.getTileLayer():null;if(e)for(var a=k.length;a--;)k[a].resync(e)});
COG.configurable(d,["style"],COG.paramTweaker(g,null,null),true);return d};
T5.AnimatedPathLayer=function(g){function k(a,n,l){a.fillStyle="#FFFFFF";a.strokeStyle="#222222";a.beginPath();a.arc(l.x,l.y,4,0,Math.PI*2,false);a.stroke();a.fill()}g=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","PINCH"),drawIndicator:null,duration:2E3,autoCenter:false},g);var h=T5.V.edges(g.path),d,b=null,f=0;T5.tweenValue(0,h.total,g.easing,function(){e.remove()},g.duration).requestUpdates(function(a,n){f=a;n&&e.remove()});var e=
T5.ex(new T5.ViewLayer(g),{cycle:function(){for(var a=0;a<h.accrued.length&&h.accrued[a]<f;)a++;b=null;if(a<g.path.length-1){var n=f-(a>0?h.accrued[a-1]:0),l=g.path[a],p=g.path[a+1];d=T5.V.theta(l,p,h.edges[a]);b=T5.V.pointOnEdge(l,p,d,n);if(g.autoCenter)(a=e.getParent())&&a.centerOn(b)}return b},draw:function(a,n){if(b)(g.drawIndicator?g.drawIndicator:k)(a,n,new T5.Vector(b.x-n.x,b.y-n.y),d)}});return e};
T5.Marker=function(g){g=T5.ex({xy:new T5.Vector,tweenIn:null,animationSpeed:null},g);var k=false,h=T5.ex(g,{isNew:true,isAnimating:function(){return k},draw:function(d,b,f,e,a){if(h.isNew&&g.tweenIn){var n=h.xy.y;h.xy.y=b.y-20;k=true;T5.tween(h.xy,"y",n,g.tweenIn,function(){h.xy.y=n;k=false},g.animationSpeed?g.animationSpeed:250+Math.random()*500)}h.drawMarker(d,b,h.xy.x-b.x,h.xy.y-b.y,f,e,a);h.isNew=false},drawMarker:function(d,b,f,e){d.beginPath();d.arc(f,e,4,0,Math.PI*2,false);d.fill()},hitTest:function(d,
b){return Math.abs(d-h.xy.x)<=4&&Math.abs(b-h.xy.y)<=4}});COG.observable(h);return h};
T5.ImageMarker=function(g){g=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},g);var k=g.imageAnchor?T5.V.invert(g.imageAnchor):null,h=g.image,d=g.animatingImage;h||(h=T5.Images.get(g.imageUrl,function(f){h=f}));d||(d=T5.Images.get(g.imageUrl,function(f){d=f}));var b=T5.ex(new T5.Marker(g),{drawMarker:function(f,e,a,n){if((e=b.isAnimating()&&d?d:h)&&e.complete&&e.width>0){k||(k=new T5.Vector(-e.width>>1,-e.height>>1));if(b.rotation||
b.scale!==1||b.opacity!==1){f.save();try{f.globalAlpha=b.opacity;f.translate(a,n);f.rotate(b.rotation);f.drawImage(e,k.x*b.scale,k.y*b.scale,e.width*b.scale,e.height*b.scale)}finally{f.restore()}}else f.drawImage(e,a+k.x,n+k.y,e.width,e.height)}},hitTest:function(f,e){var a=b.xy.x,n=b.xy.y;return f>=a+k.x&&f<=a+(h.width+k.x)&&e>=n+k.y&&e<=n+(h.height+k.y)}});return b};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(g){function k(e,a){for(var n=d.length;n--;)a.syncVectors([d[n].xy])}function h(){f.changed();f.trigger("markerUpdate",d)}g=T5.ex({zindex:100},g);var d=[],b=false,f=T5.ex(new T5.ViewLayer(g),{cycle:function(){return b},draw:function(e,a,n,l,p){b=false;for(n=d.length;n--;){d[n].draw(e,a,l,f,p);b=b||d[n].isAnimating()}return b?1:0},add:function(e){if(e&&typeof e.length!=="undefined")for(var a=e.length;a--;){if(e[a])d[d.length]=e[a]}else if(e)d[d.length]=e;h()},clear:function(e){if(e)for(var a=
0;a<d.length;a++)e(d[a])&&d.splice(a,1);else d=[];h()},find:function(e){var a=[];if(e)for(var n=d.length;n--;)if(e(d[n]))a[a.length]=d[n];return a}});f.bind("tap",function(e,a,n,l){var p=[],o=l.x;l=l.y;for(var m=d.length;m--;)if(d[m].hitTest(o,l))p[p.length]=d[m];if(p.length>0)e.cancel=f.trigger("markerTap",a,n,p).cancel});f.bind("gridUpdate",k);f.bind("changed",function(){var e=f.getParent().getTileLayer();e&&k(null,e)});return f};
T5.Style=function(g){function k(f){var e=g[f];typeof e!=="undefined"&&h.push(function(a){a[f]=e})}g=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var h=[],d={applyToContext:function(f){for(var e=h.length;e--;)h[e](f)}};for(var b in g)k(b);return d};
(function(){var g={},k={basic:new T5.Style({lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),waypoints:new T5.Style({lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"})};T5.applyStyle=function(h,d){var b=T5.styles[d]?T5.styles[d]:T5.styles.basic,f;if(h&&h.canvas){f=g[h.canvas.id];g[h.canvas.id]=d}b.applyToContext(h);return f};T5.loadStyles=function(h){COG.jsonp(h,function(d){T5.resetStyles(d)})};T5.resetStyles=function(h){var d={};for(var b in h)d[b]=new T5.Style(h[b]);T5.styles=T5.ex({},
k,d)};T5.styles=k})();(function(){T5.tileSize=256;T5.Tile=function(g){return g=T5.ex({x:0,y:0,gridX:0,gridY:0,dirty:true},g)};T5.EmptyTile=function(g){g=new T5.Tile(g);g.empty=true;return g};T5.ImageTile=function(g){g=T5.ex({url:"",sessionParamRegex:null,loading:false,loaded:false},g);return new T5.Tile(g)}})();
T5.TileGrid=function(g){function k(w,C){var E=T5.Vector(w*a-p.x,C*a-p.y);return new T5.EmptyTile({gridX:E.x,gridY:E.y,empty:true})}function h(w,C,E,H){var J=e*0.2>>0,R=new T5.Vector;if(w<0||w+E>e)R.x=w<0?-J:J;if(C<0||C+H>e)R.y=C<0?-J:J;return R}function d(w,C,E){var H=COG.Log.getTraceTicks(),J=0;new T5.Vector(e/2,e/2);if(E)f=[];if(w)for(E=0;E<e;E++)for(var R=0;R<e;R++){if(!f[J]){var P=w(R,E,n,e);P.gridX=R*a-p.x;P.gridY=E*a-p.y;f[J]=P}J++}l=w;m=C;COG.Log.trace("tile grid populated",H);x.changed()}
function b(w,C,E,H){var J,R=[],P=false;w=new T5.Vector((w.x+p.x)*A>>0,(w.y+p.y)*A>>0);tilesNeeded=false;if(!r){J=x.getParent().getDimensions();Y=Math.ceil(J.width*A)+1;S=Math.ceil(J.height*A)+1;r=new T5.Vector((Y-1)/2>>0,(S-1)/2>>0)}for(var W=S;W--;)for(var U=Y;U--;){J=U+w.x>=0&&U+w.x<e?f[(W+w.y)*e+(U+w.x)]:null;var Q=new T5.Vector(U-r.x,W-r.y);if(!J){T=h(w.x,w.y,Y,S);J=k(U+w.x,W+w.y)}P=J?(J.dirty=E||J.dirty)||P:P;R[R.length]={tile:J,centerness:T5.V.absSize(Q)}}R.sort(function(X,da){return da.centerness-
X.centerness});v||(v=Array(R.length));for(E=R.length;E--;){v[E]=R[E].tile;x.prepTile(v[E],C)}B=H;return P}g=T5.ex({tileSize:T5.tileSize,center:new T5.Vector,gridSize:25,shiftOrigin:null,supportFastDraw:true,allowShift:true},g);var f=Array(Math.pow(g.gridSize,2)),e=g.gridSize,a=g.tileSize,n=T5.V.offset(g.center,-Math.ceil(g.gridSize>>1)),l=null,p=new T5.Vector,o=false,m=null,t=Math.round(a/2),y=false,A=a?1/a:0,u=true,v=null,D=false,B=0;new T5.Vector;var T=new T5.Vector;T5.getConfig();var L=e*a,Y,S,
r,q=T5.viewState("ANIMATING"),s=T5.viewState("PINCH"),x=T5.ex(new T5.ViewLayer(g),{gridDimensions:new T5.Dimensions(L,L),cycle:function(w,C,E,H){if(T.x!==0||T.y!==0){H=T;var J=g.shiftOrigin;if(!(!g.allowShift||H.x===0&&H.y===0)){var R=COG.Log.getTraceTicks(),P=Array(f.length);P.length=f.length;for(var W=0;W<e;W++)for(var U=0;U<e;U++)P[U*e+W]=W+H.x>=0&&W+H.x<e?f[(U+H.y)*e+(W+H.x)]:null;f=P;n=J?J(n,H):T5.V.add(n,H);p.x+=-H.x*a;p.y+=-H.y*a;COG.Log.trace("tile storage shifted",R);d(l,m)}T=new T5.Vector;
H=true}if(!y&&(E&s)===0)y=b(C,E,H,w);o=(E&q)!==0||T5.isTweening();return y},deactivate:function(){u=false},find:function(w){if(!w)return null;for(var C=f.length;C--;){var E=f[C];if(E&&w(E))return E}return null},prepTile:function(){},drawTile:function(){return false},getTileSize:function(){return a},clearTileRect:function(w,C,E,H){w.clearRect(C,E,H,H)},draw:function(w,C,E,H,J,R,P){if(u){var W=C.x;C=C.y;var U=E.width,Q=E.height,X=true;if(v){for(var da=v.length;da--;){var $=v[da],aa=$.gridX-W,ba=$.gridY-
C;$.x=aa;$.y=ba;if($.empty){COG.Log.info("empty tile @ x: "+aa+", y: "+ba);x.clearTileRect(w,aa,ba,a,H);X=false}else if(R||$.dirty){o&&x.clearTileRect(w,aa,ba,a,H);X=x.drawTile(w,$,aa,ba,H,R,P)&&X}U=aa<U?aa:U;Q=ba<Q?ba:Q}U>0&&w.clearRect(0,0,U,E.height);Q>0&&w.clearRect(0,0,E.width,Q);X&&!D&&J.trigger("tileDrawComplete");y=false;D=X}}},getTileAtXY:function(w,C){for(var E=null,H=v?v.length:0;H--;){var J=v[H];if(J&&w>=J.x&&C>=J.y)if(w<=J.x+a&&C<=J.y+a){E=J;break}}COG.Log.info("looking for tile @ x: "+
w+", y: "+C+", found: "+E);return E},getTileVirtualXY:function(w,C,E){w=T5.V.add(new T5.Vector(w,C),T5.V.invert(n),p);w=new T5.Vector(w.x*a,w.y*a);if(E){w.x+=t;w.y+=t}return w},populate:function(w){d(w,null,true)},syncVectors:function(){}});x.bind("resize",function(){COG.Log.info("captured resize");r=null});COG.listen("imagecache.cleared",function(){for(var w=f.length;w--;)if(f[w])f[w].loaded=false});COG.listen("tiler.repaint",function(){for(var w=f.length;w--;)if(f[w]){f[w].x=null;f[w].y=null}});
return x};
T5.ImageTileGrid=function(g){function k(m){function t(){var y=T5.Images.newCanvas(32,32),A=y.getContext("2d");A.fillStyle="#BBBBBB";A.fillRect(0,0,32,32);A.fillStyle="#C3C3C3";A.fillRect(0,0,16,16);A.fillRect(16,16,16,16);return y}if(!d||m!==d.width){d=T5.Images.newCanvas(m,m);m=d.getContext("2d");m.fillStyle=typeof FlashCanvas!=="undefined"?"#666666":m.createPattern(t(),"repeat");m.fillRect(0,0,d.width,d.height)}return d}g=T5.ex({emptyTile:function(m){if(!h||m!==h.width){h=T5.Images.newCanvas(m,m);
m=h.getContext("2d");m.fillStyle="rgba(150, 150, 150, 0.1)";m.fillRect(0,0,h.width,h.height)}return h}(T5.tileSize),panningTile:null,tileOffset:new T5.Vector,tileDrawArgs:{}},g);var h=g.emptyTile,d=g.panningTile?g.panningTile:k(T5.tileSize),b=T5.viewState("ACTIVE"),f=T5.viewState("PAN"),e=T5.getConfig().requireFastDraw,a=g.tileSize?g.tileSize:T5.tileSize,n=T5.Images.get,l=T5.Images.load,p=T5.ex({background:null,overlay:null,offset:new T5.Vector,realSize:new T5.Dimensions(a,a)},g.tileDrawArgs),o=T5.ex(new T5.TileGrid(g),
{clearTileRect:function(m,t,y,A,u){(u&f)===0&&m.clearRect(t,y,A,A)},drawTile:function(m,t,y,A,u,v){var D=t.url?n(t.url):null,B=false;if(D){m.drawImage(D,y,A);B=true}else if(v||(u&f)!==0)m.drawImage(d,y,A);else if(h&&!t.drawnEmpty){m.drawImage(h,y,A);t.drawnEmpty=true}t.dirty=false;return B},initTileUrl:function(){},prepTile:function(m,t){if(m&&!m.loading&&(!e||t===b)){m.url||o.initTileUrl(m);if(!n(m.url)){m.loading=true;l(m.url,function(){m.loaded=true;m.dirty=true;o.changed()},p)}}}});return o};
T5.Tiler=function(g){g=T5.ex({container:"",drawCenter:false,datasources:{},tileLoadThreshold:"first"},g);var k=T5.ex(new T5.View(g),{getTileLayer:function(){return k.getLayer("grid0")},setTileLayer:function(h){k.setLayer("grid0",h);k.trigger("gridUpdate",h);k.eachLayer(function(d){d.trigger("gridUpdate",h)})},viewPixToGridPix:function(h){var d=k.getOffset();return new T5.Vector(h.x+d.x,h.y+d.y)},centerOn:function(h,d,b,f){var e=k.getTileLayer(),a=k.getDimensions();(e=e?e.getTileSize():0)&&k.updateOffset(h.gridX-
(a.width-e)*0.5>>0,h.gridY-(a.height-e)*0.5>>0,d,b,f)},cleanup:function(){k.removeLayer("grid0")},repaint:function(){COG.say("tiler.repaint");k.trigger("wake")},select:function(h){k.trigger("selectTile",h)}});k.bind("tap",function(h,d,b){if(h=k.getTileLayer())(b=h.getTileAtXY(b.x,b.y))&&k.trigger("selectTile",b)});return k};
T5.Geo=function(){function g(r,q){var s=null;for(var x in Y)if(q){if(x==q&&Y[x][r]){s=Y[x];break}}else if(Y[x][r]){s=Y[x];break}return s}function k(r,q){var s=o*Math.sin(r);return b-2*Math.atan(q*Math.pow((1-s)/(1+s),o/2))}function h(r,q,s,x){var w=0;r=r.toUpperCase();for(var C in x){var E=q[C];if(E){var H=s[C];E=H?H(r,E):COG.wordExists(r,E)?1:0;w+=E*x[C]}}return w}var d=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],b=Math.PI/2,f=Math.PI*2,e=-b,a=b,n=
-f,l=Math.PI/180,p=180/Math.PI,o=0.08181919084262157,m=null,t={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},y={VECTORIZE_PER_CYCLE:500},A={getEngine:function(r){for(var q=null,s=1;!q&&s<arguments.length;s++)q=g(r,arguments[s]);q=q?q:g(r);if(!q)throw Error("Unable to find GEO engine with "+r+" capability");return q},rankGeocodeResponses:function(r,q,s){var x=[],w=S.AddressCompareFns;if(s&&s.compareFns)w=T5.ex({},w,s.compareFns);for(s=0;s<q.length;s++)x.push(new S.GeoSearchResult({caption:L.toString(q[s]),
data:q[s],pos:q[s].pos,matchWeight:h(r,q[s],w,S.GeocodeFieldWeights)}));x.sort(function(C,E){return E.matchWeight-C.matchWeight});return x},distanceToString:function(r){if(r>1E3)return~~(r/10)/100+" km";return r?r+" m":""},dist2rad:function(r){return r/6371},lat2pix:function(r){r=parseFloat(r)*l;r=Math.sin(r);var q=o*r;return Math.log((1+r)/(1-r)*Math.pow((1-q)/(1+q),o))/2},lon2pix:function(r){return parseFloat(r)*l},pix2lon:function(r){return S.normalizeLon(r)*p},pix2lat:function(r){r=Math.pow(Math.E,
-r);for(var q=b-2*Math.atan(r),s=k(q,r),x=0;x<12&&Math.abs(q-s)>1.0E-7;){q=s;s=k(q,r);x++}return s*p},normalizeLon:function(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}},u=function(r,q){return{lat:parseFloat(r?r:0),lon:parseFloat(q?q:0)}},v=function(r,q){return{min:B.parse(r),max:B.parse(q)}},D=function(r){return r=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},r)},B=function(){var r={calcDistance:function(q,s){if(r.empty(q)||r.empty(s))return 0;var x=
(s.lat-q.lat)*l/2,w=(s.lon-q.lon)*l/2;x=Math.sin(x)*Math.sin(x)+Math.cos(q.lat*l)*Math.cos(s.lat*l)*Math.sin(w)*Math.sin(w);return 6371*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x))},copy:function(q){return q?new u(q.lat,q.lon):null},empty:function(q){return!q||q.lat===0&&q.lon===0},equal:function(q,s){return q&&s&&q.lat==s.lat&&q.lon==s.lon},inArray:function(q,s){for(var x=B.equal,w=s.length;w--;)if(x(q,s[w]))return true;return false},inBounds:function(q,s){var x=!(B.empty(q)||B.empty(s));return x=(x=
x&&q.lat>=s.min.lat&&q.lat<=s.max.lat)&&q.lon>=s.min.lon&&q.lon<=s.max.lon},offset:function(q,s,x){var w=q.lat*l;s=w+s/6371;for(q=q.lon*l+Math.asin(Math.sin(x/6371)/Math.cos(w));s<e;)s+=Math.PI;for(;s>a;)s-=Math.PI;for(;q>f;)q-=2*Math.PI;return new u(s*p,q*p)},parse:function(q){if(q)if(typeof q.lat!=="undefined")return r.copy(q);else{if(q.split)for(var s=[" ",","],x=0;x<s.length;x++){var w=q.split(s[x]);if(w.length===2)return new u(w[0],w[1])}}else return new u;return null},parseArray:function(q){var s=
q.length,x=Array(s);for(s=s;s--;)x[s]=r.parse(q[s]);return x},fromMercatorPixels:function(q,s){return new u(T5.Geo.pix2lat(s),T5.Geo.normalizeLon(T5.Geo.pix2lon(q)))},toMercatorPixels:function(q){return new T5.Vector(T5.Geo.lon2pix(q.lon),T5.Geo.lat2pix(q.lat))},generalize:function(q,s,x){var w=q.length,C=[],E=null;x||(x=250);x/=1E3;COG.Log.info("generalizing positions, must include "+s.length+" positions");for(var H=w;H--;)if(H===0)C.unshift(q[H]);else{var J=!E||B.inArray(q[H],s)?x:B.calcDistance(E,
q[H]);if(q[H]&&J>=x){C.unshift(q[H]);E=q[H]}}COG.Log.info("generalized "+w+" positions into "+C.length+" positions");return C},vectorize:function(q,s){var x=q.length,w=Array(x);s=T5.ex({chunkSize:y.VECTORIZE_PER_CYCLE,async:true},s);if(!s.async){for(var C=x;C--;)w[C]=new T5.Geo.GeoVector(q[C]);return w}return COG.Loopage.join({frequency:10,execute:function(E,H){for(var J=0,R=s.chunkSize,P=x;P--;){w[P]=new T5.Geo.GeoVector(q[P]);J+=1;if(J>R)break}x=P;x<=0&&H.trigger("complete",w)}})},toString:function(q){return q?
q.lat+" "+q.lon:""}};return r}(),T=function(){var r={calcSize:function(q,s,x){var w=new T5.Vector(0,s.lat-q.lat);if(typeof x==="undefined")x=true;w.x=x&&q.lon>s.lon?360-q.lon+s.lon:s.lon-q.lon;return w},createBoundsFromCenter:function(q,s){var x=s/6371,w=q.lat*l,C=q.lon*l,E=w-x,H=w+x;if(E>e&&H<a){w=Math.asin(Math.sin(x)/Math.cos(w));x=C-w;if(x<n)x+=2*Math.PI;C=C+w;if(C>f)C-=2*Math.PI}else{E=Math.max(E,e);H=Math.min(H,a);x=n;C=f}return new v(new u(E*p,x*p),new u(H*p,C*p))},expand:function(q,s){return new v(new u(q.min.lat-
s,q.min.lon-S.normalizeLon(s)),new u(q.max.lat+s,q.max.lon+S.normalizeLon(s)))},forPositions:function(q,s){var x=null,w=T5.ticks();s||(s="auto");for(var C=q.length;C--;)if(x){var E=r.calcSize(x.min,q[C],false),H=r.calcSize(q[C],x.max,false);if(E.x<0)x.min.lon=q[C].lon;if(E.y<0)x.min.lat=q[C].lat;if(H.x<0)x.max.lon=q[C].lon;if(H.y<0)x.max.lat=q[C].lat}else x=new T5.Geo.BoundingBox(q[C],q[C]);if(s){if(s=="auto"){C=r.calcSize(x.min,x.max);s=Math.max(C.x,C.y)*0.3}x=r.expand(x,s)}COG.Log.trace("calculated bounds for "+
q.length+" positions",w);return x},getCenter:function(q){var s=T.calcSize(q.min,q.max);return new T5.Geo.Position(q.min.lat+s.y/2,q.min.lon+s.x/2)},getGeoHash:function(q){var s=T5.Geo.GeoHash.encode(q.min.lat,q.min.lon);q=T5.Geo.GeoHash.encode(q.max.lat,q.max.lon);COG.Log.info("min hash = "+s+", max hash = "+q)},getZoomLevel:function(q,s){var x=r.getCenter(q),w=d[Math.min(Math.round(Math.abs(x.lat)*0.05),d.length)],C=r.calcSize(q.min,q.max);x=Math.ceil(Math.log(d[3]*s.height/C.y)/Math.log(2));w=Math.ceil(Math.log(w*
s.width/C.x)/Math.log(2));return Math.min(isNaN(x)?1E3:x,isNaN(w)?1E3:w)},isEmpty:function(q){return!q||B.empty(q.min)||B.empty(q.max)},toString:function(q){return"min: "+B.toString(q.min)+", max: "+B.toString(q.max)}};return r}(),L=function(){var r=/^(\d+).*$/,q=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(s,x){r.lastIndex=-1;if(r.test(s))for(var w=s.replace(r,"$1"),C=x.split(","),E=0;E<C.length;E++){q.lastIndex=-1;if(q.test(C[E])){var H=q.exec(C[E]);if(w>=parseInt(H[1],10)&&w<=parseInt(H[2],
10))return true}else if(w==C[E])return true}return false},normalize:function(s){if(!s)return"";s=s.toUpperCase();if(!m){var x=[];for(var w in t)x.push(w);m=RegExp("(\\s)("+x.join("|")+")(\\s|$)","i")}m.lastIndex=-1;if(x=m.exec(s))s=s.replace(m,"$1"+t[x[2]]);return s},toString:function(s){return s.streetDetails+" "+s.location}}}(),Y={},S={P:B,B:T,A:L,Radius:function(r,q){return{distance:parseInt(r,10),uom:q}},Position:u,BoundingBox:v,GeoVector:function(r){function q(x){s.pos=x;s.mercXY=B.toMercatorPixels(x)}
var s=new T5.Vector;T5.ex(s,{radsPerPixel:null,setRadsPerPixel:function(x,w,C){var E=s.mercXY;s.x=Math.abs((E.x/x>>0)+(w?w:0));s.y=Math.abs((E.y/x>>0)+(C?C:0));s.radsPerPixel=x},updatePos:q});q(r);return s},Address:D,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(r){if(!r.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var q=T5.ex({remove:function(){delete Y[q.id]}},r);return Y[q.id]=q},GeoSearchResult:function(r){r=T5.ex({id:null,
caption:"",resultType:"",data:null,pos:null,matchWeight:0},r);return T5.ex(r,{toString:function(){return r.caption+(r.matchWeight?" ("+r.matchWeight+")":"")}})},GeoSearchAgent:function(r){return new T5.Dispatcher.Agent(r)},GeocodingAgent:function(r){r=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(q,s){try{if(!q.reverse&&!q.freeform)address=new D(q);var x=S.getEngine("geocode");if(x)x.geocode({addresses:[q.freeform?q.freeform:address],complete:function(C,E){if(s){var H=
E;if(q.freeform)H=S.rankGeocodeResponses(q.freeform,H,S.getEngine("geocode"));s(H,r)}}})}catch(w){COG.Log.exception(w)}}},r);return new S.GeoSearchAgent(r)}};return T5.ex(S,y,A)}();
T5.Geo.GeoHash=function(){function g(k,h,d){if(h&d)k[0]=(k[0]+k[1])/2;else k[1]=(k[0]+k[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(k){var h=1,d=[],b=[];d[0]=-90;d[1]=90;b[0]=-180;b[1]=180;lat_err=90;lon_err=180;for(i=0;i<k.length;i++){c=k[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(h){lon_err/=2;g(b,cd,mask)}else{lat_err/=2;g(d,cd,mask)}h=!h}}d[2]=(d[0]+
d[1])/2;b[2]=(b[0]+b[1])/2;return{latitude:d,longitude:b}},encode:function(k,h,d){var b=1,f=[],e=[],a=0,n=0;d=d?d:12;geohash="";f[0]=-90;f[1]=90;e[0]=-180;for(e[1]=180;geohash.length<d;){if(b){mid=(e[0]+e[1])/2;if(h>mid){n|=BITS[a];e[0]=mid}else e[1]=mid}else{mid=(f[0]+f[1])/2;if(k>mid){n|=BITS[a];f[0]=mid}else f[1]=mid}b=!b;if(a<4)a++;else{geohash+=BASE32[n];n=a=0}}return geohash}}}();
T5.Geo.JSON=function(){function g(e,a){var n=h(a);e.add(new T5.Poly(n))}function k(e,a){var n=h(a[0]);e.add(new T5.Poly(n,{fill:true}))}function h(e){var a=e.length,n=Array(a);for(a=a;a--;)n[a]=new T5.Geo.Position(e[a][1],e[a][0]);return T5.Geo.P.vectorize(n,d)}var d={async:false},b={linestring:g,multilinestring:function(e,a){for(var n=0;n<a.length;n++)g(e,a[n])},polygon:k,multipolygon:function(e,a){for(var n=0;n<a.length;n++)k(e,a[n])}},f=function(e,a,n){n=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,
rowPreParse:null,targetLayer:null},n);var l=n.vectorsPerCycle,p=n.targetLayer,o=n.rowPreParse,m=0,t=0;if(!e)return null;if(typeof e.length==="undefined")e=[e];t=e.length;p||(p=new T5.PolyLayer);n=COG.Loopage.join({frequency:10,execute:function(y,A){for(var u=0,v=m;v<t;v++){var D=o?o(e[v]):e[v],B=D.type?D.type.toLowerCase():null;B=b[B];var T=null;if(B)T=B(p,D.coordinates);u+=T?T:1;if(u>=l)break}m=v+1;m>=t&&A.trigger("complete")}});n.bind("complete",function(){a&&a(p)});return n};return{parse:function(e,
a,n){return new f(e,a,n)}}}();
T5.Geo.LocationSearch=function(g){function k(e,a){navigator.geolocation.clearWatch(d);d=0;if(b){clearTimeout(b);b=0}a&&a([e],g)}function h(e){COG.Log.info("caught location tracking error:",e)}g=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},g);var d=0,b=0,f=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(e,a){if(navigator.geolocation&&!d){d=navigator.geolocation.watchPosition(function(n){var l=new T5.Geo.Position(n.coords.latitude,n.coords.longitude);
n=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:l,accuracy:n.coords.accuracy/1E3,matchWeight:100});if(!f||n.accuracy<f.accuracy)f=n;if(!g.requiredAccuracy||f.accuracy<g.requiredAccuracy)k(f,a)},h,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)b=setTimeout(function(){f&&k(f,a)},g.searchTimeout)}}},g))};
T5.Map=function(g){function k(t){try{var y=new T5.Geo.Position(t.coords.latitude,t.coords.longitude),A=t.coords.accuracy/1E3;m.trigger("locationUpdate",t,A);if(p){if(!n){n=new T5.Geo.UI.LocationOverlay({pos:y,accuracy:A});n.update(m.getTileLayer());m.setLayer("location",n)}var u=T5.Geo.B.createBoundsFromCenter(y,Math.max(A,1));m.gotoBounds(u)}else{n.pos=y;n.accuracy=A;n.update(m.getTileLayer());m.panToPosition(y,null,T5.easing("sine.out"))}p=false}catch(v){COG.Log.exception(v)}}function h(t){COG.Log.info("caught location tracking error:",
t)}g=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,zoomAnimation:T5.easing("quad.out")},g);var d={NONE:0,SINGLE:1,WATCH:2},b=new T5.Vector,f=d.NONE,e=false,a=null,n=null,l=0,p=true,o=g.zoomLevel;if(!g.provider)g.provider=new T5.Geo.MapProvider;g.adjustScaleFactor=function(t){return Math.pow(2,(t<1?Math.floor:Math.ceil)(Math.log(t)))};var m=T5.ex({},new T5.Tiler(g),{annotations:null,getBoundingBox:function(){var t=m.getTileLayer(),y=m.getOffset(),A=m.getDimensions();
if(t)return t.getBoundingBox(y.x,y.y,A.width,A.height);return null},getCenterPosition:function(){return m.getXYPosition(T5.D.getCenter(m.getDimensions()))},getXYPosition:function(t){return m.getTileLayer().pixelsToPos(m.viewPixToGridPix(t))},gotoBounds:function(t,y){var A=T5.Geo.B.getZoomLevel(t,m.getDimensions());m.gotoPosition(T5.Geo.B.getCenter(t),A,y)},gotoPosition:function(t,y,A){function u(T){m.setTileLayer(T);m.panToPosition(t,function(){m.unfreeze();m.trigger("zoomLevelChange",o);A&&A()});
e=true}var v=o,D=!e,B=m.getBoundingBox();if(B)D=D||!T5.Geo.P.inBounds(t,B);o=y?y:o;if(!o)throw Error("Zoom level required to goto a position.");if(g.provider)o=g.provider.checkZoomLevel(o);if(D||o!==v){T5.Images.cancelLoad();(y=m.getTileLayer())&&y.deactivate();T5.cancelAnimation();e&&m.freeze();g.provider.zoomLevel=o;g.provider.getMapTiles(m,t,u)}else m.panToPosition(t,A)},panToPosition:function(t,y,A,u){var v=m.getTileLayer();if(v){t=v.getGridXYForPosition(t);v=m.getDimensions();t.x-=v.width/2;
t.y-=v.height/2;if(a)a=null;m.updateOffset(t.x,t.y,A,u,y);m.trigger("wake");m.trigger("boundsChange",m.getBoundingBox());y&&typeof A==="undefined"&&y(m)}},locate:function(){m.trackStart(d.SINGLE);setTimeout(m.trackCancel,1E4)},trackStart:function(t){if(navigator.geolocation&&!l){f=t?t:d.WATCH;p=true;l=navigator.geolocation.watchPosition(k,h,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){l&&navigator.geolocation&&navigator.geolocation.clearWatch(l);m.removeLayer("location");
n=null;f=d.NONE;l=0},getZoomLevel:function(){return o},setZoomLevel:function(t){try{m.gotoPosition(m.getCenterPosition(),t)}catch(y){COG.Log.exception(y)}},zoomIn:function(){m.scale(2,T5.easing("sine.out"))||m.setZoomLevel(o+1)},zoomOut:function(){m.scale(0.5,T5.easing("sine.out"))||m.setZoomLevel(o-1)},animateRoute:function(t,y,A,u){var v=m.getLayer("route");if(v)(t=v.getAnimation(t,y,A,u))&&t.addToView(m)}});m.bind("pan",function(){f===d.SINGLE&&m.trackCancel()});m.bind("tap",function(t,y,A){var u=
m.getTileLayer(),v=null;if(u){var D=m.viewPixToGridPix(new T5.Vector(A.x,A.y));t=u.pixelsToPos(D);v=u.pixelsToPos(T5.V.offset(D,-g.tapExtent,g.tapExtent));u=u.pixelsToPos(T5.V.offset(D,g.tapExtent,-g.tapExtent));v=new T5.Geo.BoundingBox(v,u);m.trigger("geotap",y,A,t,v)}});m.bind("doubleTap",function(t,y,A){m.animate(2,T5.D.getCenter(m.getDimensions()),new T5.Vector(A.x,A.y),g.zoomAnimation)});m.bind("scale",function(t,y,A){t=0;y=Math.sqrt(y);if(y<1)t=-(0.5/y);else if(y>1)t=y;m.gotoPosition(m.getXYPosition(A),
o+t>>0)});g.crosshair&&m.setLayer("crosshair",new CrosshairOverlay);m.bind("idle",function(){if(T5.V.absSize(T5.V.diff(b,m.getOffset()))>g.boundsChangeThreshold){b=T5.V.copy(m.getOffset());m.trigger("boundsChange",m.getBoundingBox())}});COG.configurable(m,["provider"],COG.paramTweaker(g,null,{provider:function(){m.cleanup();e=false}}),true);return m};
T5.Geo.MapProvider=function(){var g=1,k=20;return{zoomLevel:0,checkZoomLevel:function(h){return Math.min(Math.max(h,g),k)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:g,max:k}},setZoomRange:function(h,d){g=h;k=d}}};
T5.Geo.Routing=function(){var g={calculate:function(k){k=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},k);var h=T5.Geo.getEngine("route");h&&h.route(k,function(d){if(k.generalize)d.geometry=T5.Geo.P.generalize(d.geometry,d.getInstructionPositions());if(k.map){g.createMapOverlay(k.map,d);k.autoFit&&k.map.gotoBounds(d.boundingBox)}k.success&&k.success(d)})},createMapOverlay:function(k,h){var d=k.getDimensions();d=new T5.Geo.UI.RouteOverlay({data:h,width:d.width,
height:d.height});k.setLayer("route",d)},parseTurnType:function(k){for(var h=g.TurnType.Unknown,d=T5.Geo.Routing.TurnTypeRules,b=0;b<d.length;b++){d[b].regex.lastIndex=-1;var f=d[b].regex.exec(k);if(f){h=d[b].customCheck?d[b].customCheck(k,f):d[b].turnType;break}}return h},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(k){var h=k=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},k),d=k.description;d=d.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");h.description=d;if(!k.turnType)k.turnType=g.parseTurnType(k.description);return k},RouteData:function(k){k=T5.ex({geometry:[],instructions:[],boundingBox:null},
k);if(!k.boundingBox)k.boundingBox=T5.Geo.B.forPositions(k.geometry);return T5.ex({getInstructionPositions:function(){for(var h=[],d=0;d<k.instructions.length;d++)k.instructions[d].position&&h.push(k.instructions[d].position);return h}},k)}};return g}();T5.Geo.Search=function(){return{bestResults:function(g,k){k||(k=20);for(var h=g.length>0?g[0]:null,d=[],b=0;b<g.length;b++)if(h&&g[b]&&h.matchWeight-g[b].matchWeight<=k)d.push(g[b]);else break;return d}}}();
T5.Geo.UI=function(){var g={AnnotationTween:null,GeoTileGrid:function(k){k=T5.ex({grid:null,centerPos:new T5.Geo.Position,centerXY:new T5.Vector,radsPerPixel:0},k);var h=k.radsPerPixel,d=T5.Geo.P.toMercatorPixels(k.centerPos),b=d.x/h-k.centerXY.x>>0,f=d.y/h-k.centerXY.y>>0,e=null,a=T5.ex({},k.grid,{getBoundingBox:function(n,l,p,o){return new T5.Geo.BoundingBox(a.pixelsToPos(new T5.Vector(n,l+o)),a.pixelsToPos(new T5.Vector(n+p,l)))},getGridXYForPosition:function(n){n=new T5.Geo.GeoVector(n);a.syncVectors([n]);
return n},syncVectors:function(n){for(var l=n.length;l--;)n[l]&&n[l].setRadsPerPixel&&n[l].setRadsPerPixel(h,-b,-e)},getPixelDistance:function(n){return T5.Geo.dist2rad(n)/h>>0},pixelsToPos:function(n){return T5.Geo.P.fromMercatorPixels((b+n.x)*h,(f+a.gridDimensions.height-n.y)*h)}});e=f+a.gridDimensions.height;return a},RouteOverlay:function(k){k=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},k);var h=
[],d=[],b=new T5.PathLayer(k);(function(){if(k.data&&k.data.instructions){for(var f=k.data.instructions,e=Array(f.length),a=f.length;a--;)e[a]=f[a].position;T5.Geo.P.vectorize(e).bind("complete",function(n,l){d=l})}k.data&&k.data.geometry&&T5.Geo.P.vectorize(k.data.geometry).bind("complete",function(n,l){h=l;b.updateCoordinates(h,d,true)})})();return b},Poly:function(k,h){h=T5.ex({autoParse:true},h);for(var d=Array(k.length),b=h.autoParse,f=T5.Geo.GeoVector,e=T5.Geo.P.parse,a=k.length;a--;)d[a]=new f(b?
e(k[a]):k[a]);return new T5.Poly(d,h)},Annotation:function(k){k=T5.ex({pos:null},k);k.xy=new T5.Geo.GeoVector(k.pos);return new T5.ImageAnnotation(k)},LocationOverlay:function(k){k=T5.ex({pos:null,accuracy:null,zindex:90},k);var h=new Image,d=new T5.Vector,b=new T5.Vector,f=null;h.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
h.onload=function(){d=new T5.Vector(h.width/2,h.height/2)};var e=T5.ex(new T5.ViewLayer(k),{pos:k.pos,accuracy:k.accuracy,drawAccuracyIndicator:false,draw:function(a,n){var l=b.x-n.x,p=b.y-n.y;if(f){a.fillStyle="rgba(30, 30, 30, 0.2)";a.beginPath();a.arc(l,p,f,0,Math.PI*2,false);a.fill()}h.complete&&h.width>0&&a.drawImage(h,l-d.x,p-d.y,h.width,h.height);e.changed()},update:function(a){if(a){f=Math.floor(a.getPixelDistance(e.accuracy)*0.5);b=a.getGridXYForPosition(e.pos);e.changed()}}});e.bind("gridUpdate",
function(a,n){e.update(n)});return e},AnnotationsOverlay:function(k){function h(a,n){var l=a.length,p=e.getParent();if(n=n?n:p?p.getTileLayer():null)for(l=l;l--;)n.syncVectors([a[l].xy]);a.sort(function(o,m){var t=m.xy.y-o.xy.y;if(t===0)t=m.xy.x-o.xy.x;return t})}k=T5.ex({pois:null,map:null,zindex:100},k);var d=[],b=false,f=[],e=T5.ex(new T5.ViewLayer(k),{cycle:function(){return b},draw:function(a,n,l,p,o){b=false;a.fillStyle="rgba(255, 0, 0, 0.75)";a.globalCompositeOperation="source-over";for(l=
d.length;l--;){d[l].draw(a,n,p,e,o);b=b||d[l].isAnimating()}for(l=f.length;l--;){f[l].draw(a,n,p,e,o);b=b||f[l].isAnimating()}return b?1:0},add:function(a){if(a&&a.length)for(var n=a.length;n--;)f[f.length]=a[n];else if(a)f[f.length]=a;h(f);e.changed()},clear:function(a){f=[];h(f);if(a){d=[];h(d)}e.changed()}});COG.listen("geo.pois-updated",function(a){if(k.pois&&k.pois.id==a.srcID){a=a.pois;try{d=[];for(var n=0;n<a.length;n++)if(a[n].pos){var l;var p=a[n];if(p&&p.pos){var o={poi:p,annotation:null};
k.map&&k.map.trigger("getAnnotationForPOI",o);if(!o.annotation)o.annotation=new T5.Annotation({xy:new T5.Geo.GeoVector(p.pos)});if(o.annotation){o.annotation.isNew=p.isNew;p.isNew=false}l=o.annotation}else l=void 0;l&&d.push(l)}h(d)}catch(m){COG.Log.exception(m)}e.changed()}});e.bind("gridUpdate",function(a,n){h(d,n);h(f,n);e.changed()});return e}};g.ImageAnnotation=g.Annotation;return g}();
T5.Geo.Routing.TurnTypeRules=function(){var g=T5.Geo.Routing.TurnType,k=[];k.push({regex:/continue/i,turnType:g.Continue});k.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(h,d){return/bear/i.test(d[1])?g.TurnLeftSlight:g.TurnLeft}});k.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(h,d){return/bear/i.test(d[1])?g.TurnRightSlight:g.TurnRight}});k.push({regex:/enter\s(roundabout|rotaty)/i,turnType:g.EnterRoundabout});k.push({regex:/take.*?ramp/i,turnType:g.Ramp});k.push({regex:/take.*?exit/i,
turnType:g.RampExit});k.push({regex:/make(.*?)u\-turn/i,customCheck:function(h,d){return/right/i.test(d[1])?g.UTurnRight:g.UTurnLeft}});k.push({regex:/proceed/i,turnType:g.Start});k.push({regex:/arrive/i,turnType:g.Arrive});k.push({regex:/fell\sthrough/i,turnType:g.Merge});return k}();
