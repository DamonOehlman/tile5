COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var G=arguments[0]||{},V,u=1,s=arguments.length;u<s;u++)if((V=arguments[u])!==null)for(var j in V){var l=V[j];if(G!==l)if(l!==undefined)G[j]=l}return G};
(function(){var G=Object.prototype.hasOwnProperty,V=0,u={};u.toID=function(s){return s.replace(/\s/g,"-")};u.objId=function(s){return(s?s:"obj")+V++};u.isFunction=function(s){return toString.call(s)==="[object Function]"};u.isArray=function(s){return toString.call(s)==="[object Array]"};u.isPlainObject=function(s){if(!s||toString.call(s)!=="[object Object]"||s.nodeType||s.setInterval)return false;if(s.constructor&&!G.call(s,"constructor")&&!G.call(s.constructor.prototype,"isPrototypeOf"))return false;
var j;for(j in s);return j===undefined||G.call(s,j)};u.isEmptyObject=function(s){for(var j in s)return false;return true};u.isXmlDocument=function(s){return toString.call(s)==="[object Document]"};u.contains=function(s,j){var l=s,q=arguments,z=1;if(j&&module.isArray(j)){q=j;z=0}for(z=z;z<q;z++)l=l&&typeof foo[q[z]]!=="undefined";return l};u.formatStr=function(s){if(arguments.length<=1)return s;for(var j=arguments.length-2,l=0;l<=j;l++)s=s.replace(RegExp("\\{"+l+"\\}","gi"),arguments[l+1]);return s};
u.wordExists=function(s,j){var l="";if(j.toString)j=j.toString();for(var q=0;q<j.length;q++)l+=!/\w/.test(j[q])?"\\"+j[q]:j[q];return RegExp("(^|\\s|\\,)"+l+"(\\,|\\s|$)","i").test(s)};COG.extend(COG,u)})();
(function(){function G(l){return typeof console!=="undefined"?function(){console[l](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var V=window.console&&window.console.markTimeline,u=G("error"),s=G("info"),j=function(){return V?function(l,q){console.markTimeline(l+(q?": "+((new Date).getTime()-q)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:G("debug"),info:s,warn:G("warn"),error:u,exception:function(l){if(u)for(var q in l)s("ERROR DETAIL: "+q+
": "+l[q])}})})();
(function(){function G(u,s){var j=u.hasOwnProperty("obsHandlers")?u.obsHandlers:null;j[s]||(j[s]=[]);return j[s]}var V=0;COG.observable=function(u){if(!u)return null;if(!(u.hasOwnProperty("obsHandlers")?u.obsHandlers:null))u.obsHandlers={};if(!u.hasOwnProperty("bind")){u.bind=function(s,j){var l="callback"+V++;G(u,s).unshift({fn:j,id:l});return l};u.triggerCustom=function(s,j){var l=G(u,s),q={cancel:false,name:s,source:this},z;j&&COG.extend(q,j);if(!l)return null;z=Array.prototype.slice.call(arguments,2);
u.eventInterceptor&&u.eventInterceptor(s,q,z);z.unshift(q);for(var O=l.length;O--&&!q.cancel;)l[O].fn.apply(this,z);return q};u.trigger=function(s){var j=Array.prototype.slice.call(arguments,1);j.splice(0,0,s,null);return u.triggerCustom.apply(this,j)};u.unbind=function(s,j){if(typeof s==="undefined")u.obsHandlers={};else for(var l=G(u,s),q=0;l&&q<l.length;q++)if(l[q].id===j){l.splice(q,1);break}return u}}return u}})();
(function(){function G(j,l){j[l]||(j[l]=function(q){return j.configure(l,q)})}function V(j){j.gtConfId="configurable"+s++;j.gtConfig={};j.gtConfigFns=[];return j.gtConfig}var u={},s=0;COG.paramTweaker=function(j,l,q){return function(z,O){if(typeof O!=="undefined"){if(z in j)j[z]=O;q&&z in q&&q[z](z,O)}else return l&&z in l?l[z](z):j[z]}};COG.configurable=function(j,l,q,z){if(j){j.gtConfId||V(j);var O=j.gtConfId,ha=j.gtConfig,o=j.gtConfigFns;u[O]=j;o.push(q);for(q=l.length;q--;){ha[l[q]]=true;z&&G(j,
l[q])}if(!j.configure)j.configure=function(D,y){if(ha[D]){for(var n=o.length;n--;){var r=o[n](D,y);if(typeof r!=="undefined")return r}return u[O]}return null}}}})();
(function(){function G(j){var l=document.createElement("script"),q=false;l.src=j;l.async=true;l.onload=l.onreadystatechange=function(){if(!q&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){q=true;l.onload=l.onreadystatechange=null;l&&l.parentNode&&l.parentNode.removeChild(l)}};u||(u=document.getElementsByTagName("head")[0]);u.appendChild(l)}var V=0,u,s=this;COG.jsonp=function(j,l,q){j+=j.indexOf("?")>=0?"&":"?";var z="json"+ ++V;s[z]=function(O){l(O);s[z]=null;try{delete s[z]}catch(ha){}};
G(j+(q?q:"callback")+"="+z);return z}})();
(function(){var G=1.70158,V=Math.PI/2,u=Math.PI*2,s=1E3/60|0,j=Math.abs,l=Math.pow,q=Math.sin,z=Math.asin,O=Math.cos,ha={linear:function(o,D,y,n){return y*o/n+D},backin:function(o,D,y,n){return y*(o/=n)*o*((G+1)*o-G)+D},backout:function(o,D,y,n){return y*((o=o/n-1)*o*((G+1)*o+G)+1)+D},backinout:function(o,D,y,n){return(o/=n/2)<1?y/2*o*o*(((G*=1.525)+1)*o-G)+D:y/2*((o-=2)*o*(((G*=1.525)+1)*o+G)+2)+D},bouncein:function(o,D,y,n){return y-ha.bounceout(n-o,0,y,n)+D},bounceout:function(o,D,y,n){return(o/=
n)<1/2.75?y*7.5625*o*o+D:o<2/2.75?y*(7.5625*(o-=1.5/2.75)*o+0.75)+D:o<2.5/2.75?y*(7.5625*(o-=2.25/2.75)*o+0.9375)+D:y*(7.5625*(o-=2.625/2.75)*o+0.984375)+D},bounceinout:function(o,D,y,n){return o<n/2?ha.bouncein(o*2,0,y,n)/2+D:ha.bounceout(o*2-n,0,y,n)/2+y/2+D},cubicin:function(o,D,y,n){return y*(o/=n)*o*o+D},cubicout:function(o,D,y,n){return y*((o=o/n-1)*o*o+1)+D},cubicinout:function(o,D,y,n){if((o/=n/2)<1)return y/2*o*o*o+D;return y/2*((o-=2)*o*o+2)+D},elasticin:function(o,D,y,n,r,x){if(o==0)return D;
if((o/=n)==1)return D+y;x||(x=n*0.3);if(!r||r<j(y)){r=y;y=x/4}else y=x/u*z(y/r);return-(r*l(2,10*(o-=1))*q((o*n-y)*u/x))+D},elasticout:function(o,D,y,n,r,x){var Q;if(o==0)return D;if((o/=n)==1)return D+y;x||(x=n*0.3);if(!r||r<j(y)){r=y;Q=x/4}else Q=x/u*z(y/r);return r*l(2,-10*o)*q((o*n-Q)*u/x)+y+D},elasticinout:function(o,D,y,n,r,x){var Q;if(o==0)return D;if((o/=n/2)==2)return D+y;x||(x=n*0.3*1.5);if(!r||r<j(y)){r=y;Q=x/4}else Q=x/u*z(y/r);if(o<1)return-0.5*r*l(2,10*(o-=1))*q((o*n-Q)*u/x)+D;return r*
l(2,-10*(o-=1))*q((o*n-Q)*u/x)*0.5+y+D},quadin:function(o,D,y,n){return y*(o/=n)*o+D},quadout:function(o,D,y,n){return-y*(o/=n)*(o-2)+D},quadinout:function(o,D,y,n){if((o/=n/2)<1)return y/2*o*o+D;return-y/2*(--o*(o-2)-1)+D},sinein:function(o,D,y,n){return-y*O(o/n*V)+y+D},sineout:function(o,D,y,n){return y*q(o/n*V)+D},sineinout:function(o,D,y,n){return-y/2*(O(Math.PI*o/n)-1)+D}};COG.tweenValue=function(o,D,y,n,r){function x(W){W=W?W:(new Date).getTime();if(aa+s<W){var S=W-Q,pa=y(S,o,ia,n),ja=Q+n<=
W;W=!ja;if(r){S=r(pa,ja,S);W=typeof S!="undefined"?S&&W:W}W&&animFrame(x)}}var Q=(new Date).getTime(),aa=0,ia=D-o;animFrame(x);return{}};COG.easing=function(o){return ha[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(o,D){ha[o.replace(/[\-\_\s\.]/g,"").toLowerCase()]=D}})();
(function(){var G=/^P(\d+Y)?(\d+M)?(\d+D)?$/,V=/^(\d+H)?(\d+M)?(\d+S)?$/,u={8601:function(j){j=j.split("T");var l=null;l=null;var q=0,z=0;G.lastIndex=-1;l=G.exec(j[0]);q+=l[3]?parseInt(l[3].slice(0,-1),10):0;V.lastIndex=-1;l=V.exec(j[1]);z+=l[1]?parseInt(l[1].slice(0,-1),10)*3600:0;z+=l[2]?parseInt(l[2].slice(0,-1),10)*60:0;z+=l[3]?parseInt(l[3].slice(0,-1),10):0;return new s(q,z)}},s=COG.Duration=function(j,l){return{days:j?j:0,seconds:l?l:0}};COG.addDuration=function(){for(var j=new s,l=arguments.length;l--;){j.days+=
arguments[l].days;j.seconds+=arguments[l].seconds}if(j.seconds>=86400){j.days+=~~(j.seconds/86400);j.seconds%=86400}return j};COG.formatDuration=function(j){var l,q,z="";if(j.days)z=j.days+" days ";if(j.seconds){j=j.seconds;if(j>=3600){l=~~(j/3600);j-=l*3600}if(j>=60){q=Math.round(j/60);j-=q*60}if(l)z=z+l+(l>1?" hrs ":" hr ")+(q?(q>10?q:"0"+q)+" min ":"");else if(q)z=z+q+" min";else if(j>0)z=z+(j>10?j:"0"+j)+" sec"}return z};COG.parseDuration=function(j,l){var q=l?u[l]:null;if(q)return q(j);COG.Log.warn("Could not find duration parser for specified format: "+
l);return new s}})();COG.ObjectStore=function(){var G={},V={},u="obj_"+(new Date).getTime(),s=0,j=Object.prototype.hasOwnProperty;return{add:function(l,q){var z;q=q?q:"default";if(l&&l.constructor)if(!j.call(l,"id"))l.id=u+ ++s;z=V[q]?V[q]:V[q]=[];G[l.id]=z.length;z[l.length]=l}}};var CANI={};
(function(G){var V=[],u=0,s=false,j=G.register=function(l,q){V.push({section:l,run:q})};G.init=function(l){function q(){if(u<V.length){var O=V[u++];z[O.section]||(z[O.section]={});O.run(z[O.section],q)}else{for(O in z)G[O]=z[O];s=true;l&&l(G)}}var z={};if(s&&l)l(G);else{u=0;q()}};j("canvas",function(l,q){function z(){var D,y=O.getContext("2d");y.save();try{y.translate(50,50);y.beginPath();y.rect(0,0,20,20);D=y.isPointInPath(10,10)}finally{y.restore()}return D}var O=document.createElement("canvas"),
ha=typeof FlashCanvas!="undefined",o=typeof G_vmlCanvasManager!="undefnined";O.width=200;O.height=200;l.pipTransformed=ha||o?false:z();q()})})(CANI);
INTERACT=function(){function G(n){return function(r,x,Q){(Q?Q:n?document.body:document).addEventListener(r,x,false)}}function V(n){return function(r,x,Q){(Q?Q:n?document.body:document).removeEventListener(r,x,false)}}function u(n,r,x){(x?x:document).attachEvent("on"+n,r)}function s(n,r,x){(x?x:document).detachEvent("on"+n,r)}function j(n,r){return{x:n?n:0,y:r?r:0,count:1}}function l(n,r){D.push(COG.extend({handler:null,checks:{},type:n},r))}function q(n){var r=0,x=0;if(n.offsetParent){do{r+=n.offsetLeft;
x+=n.offsetTop;n=n.offsetParent}while(n)}return{left:r,top:x}}function z(n,r){return{source:n,target:r.target?r.target:r.srcElement}}function O(n,r){for(var x=n.target?n.target:n.srcElement;x&&x!==r&&x.nodeName&&x.nodeName.toUpperCase()!="CANVAS";)x=x.parentNode;return x&&x===r}function ha(n,r){return{x:n.x-(r?r.left:0),y:n.y-(r?r.top:0)}}function o(n){if(n.preventDefault){n.preventDefault();n.stopPropagation()}else n.cancelBubble&&n.cancelBubble()}var D=[],y=function(n,r,x){function Q(Y,da,ga,N){var R=
0,ba=0,C=0;COG.tweenValue(0,Y,ga,N,function(K){C=R;R=K});COG.tweenValue(0,da,ga,N,function(K){aa.trigger("pan",R-C,K-ba);ba=K})}x=COG.extend({binder:null,unbinder:null,observable:null},x);for(var aa=x.observable,ia=null,W=[],S=[],pa,ja,ta={bind:function(){return aa.bind.apply(null,arguments)},pannable:function(Y){ia=COG.extend({inertia:true},Y);return ta},unbind:function(){aa.unbind();for(var Y=0;Y<W.length;Y++)W[Y].unbind();return ta}},Ca=0;Ca<r.length;Ca++)W.push(r[Ca](n,aa,x));aa.bind("pointerDown",
function(){S=[];ja=pa=0});aa.bind("pointerMove",function(Y,da,ga,N){if(ia){S[S.length]={ticks:(new Date).getTime(),x:N.x,y:N.y};aa.trigger("pan",N.x,N.y)}pa+=N.x?N.x:0;ja+=N.y?N.y:0});aa.bind("pointerUp",function(Y,da,ga){if(Math.abs(pa)>20||Math.abs(ja)>20){if(ia){ga=S.length;var N,R;da=0;for(R=S.length;--R>1&&da<50;)da+=S[R].ticks-S[R-1].ticks;if(ga-R>1){Y=S[ga-1].x-S[R].x;N=S[ga-1].y-S[R].y;R=Math.sqrt(Y*Y+N*N)|0;if(R>15){Y=S[ga-1].x-S[0].x;N=S[ga-1].y-S[0].y;R=Math.sqrt(Y*Y+N*N)|0;ga=Math.asin(N/
R);da=R*500/da|0;da=da>300?300:da;Q(Math.cos(Y>0?ga:Math.PI-ga)*da,Math.sin(ga)*da,COG.easing("sine.out"),500)}}}}else aa.trigger("tap",da,ga)});return ta};l("pointer",{handler:function(n,r,x){function Q(C){if(C.pageX&&C.pageY)return j(C.pageX,C.pageY);else{var K=document.documentElement,U=document.body;return j(C.clientX+(K&&K.scrollLeft||U&&U.scrollLeft||0)-(K&&K.clientLeft||U&&U.clientLeft||0),C.clientY+(K&&K.scrollTop||U&&U.scrollTop||0)-(K&&K.clientTop||U&&U.clientTop||0))}}function aa(C){if(O(C,
n))if(Y=pa(C)){var K=Q(C);n.style.cursor="move";o(C);R=K.x;ba=K.y;da=j(R,ba);r.triggerCustom("pointerDown",z("mouse",C),da,ha(da,q(n)))}}function ia(C){var K=Q(C);ga=K.x;N=K.y;if(O(C,n))ja(C,Y?"pointerMove":"pointerHover")}function W(C){if(Y&&pa(C)){Y=false;if(O(C,n)){n.style.cursor="default";ja(C,"pointerUp")}}}function S(C){if(O(C,n)){var K;C=C||window.event;if(C.detail)K=C.axis===2?-C.detail*ta:0;else{K=C.wheelDeltaY?C.wheelDeltaY:C.wheelDelta;if(window.opera)K=-K}if(K!==0){var U=j(ga,N);r.triggerCustom("zoom",
z("mouse",C),U,ha(U,q(n)),K/Ca,"wheel");o(C);C.returnValue=false}}}function pa(C){C=C||window.event;return(C.which||C.button)==1}function ja(C,K,U,ma,Aa){U=typeof U!="undefined"?U:ga;ma=typeof ma!="undefined"?ma:N;var I=U-R,Z=ma-ba,M=j(U,ma);r.triggerCustom(K,z("mouse",C),M,ha(M,q(n)),j(I,Z));if(typeof Aa=="undefined"||Aa){R=U;ba=ma}}x=COG.extend({},x);var ta=120,Ca=ta*8,Y=false,da,ga,N,R,ba;x.binder("mousedown",aa,false);x.binder("mousemove",ia,false);x.binder("mouseup",W,false);x.binder("dblclick",
function(C){COG.info("captured double click");if(O(C,n)){var K=Q(C);r.triggerCustom("doubleTap",z("mouse",C),K,ha(K,q(n)))}},false);x.binder("mousewheel",S,document);x.binder("DOMMouseScroll",S,document);return{unbind:function(){x.unbinder("mousedown",aa,false);x.unbinder("mousemove",ia,false);x.unbinder("mouseup",W,false);x.unbinder("mousewheel",S,document);x.unbinder("DOMMouseScroll",S,document)}}},checks:{touch:false}});l("pointer",{handler:function(n,r,x){function Q(I){if(I.count<2)return 0;var Z=
I.x-I.next.x;I=I.y-I.next.y;return~~Math.sqrt(Z*Z+I*I)}function aa(I,Z,M){Z=Z?Z:0;M=M?M:0;for(var ua={x:I.x-Z,y:I.y-M,id:I.id,count:I.count},sa=ua;I.next;){I=I.next;sa=sa.next={x:I.x-Z,y:I.y-M,id:I.id}}return ua}function ia(I,Z){var M=I[Z?Z:"touches"],ua,sa;if(M.length===0)return null;sa=ua={x:M[0].pageX,y:M[0].pageY,id:M[0].identifier,count:M.length};for(var ya=1,Xa=M.length;ya<Xa;ya++)sa=sa.next={x:M[ya].pageX,y:M[ya].pageY,id:M[ya].identifier};return ua}function W(I){if(O(I,n)){N=q(n);var Z=ia(I,
"changedTouches"),M=aa(Z,N.left,N.top);if(!ba){R=Y;r.triggerCustom("pointerDown",z("touch",I),Z,M)}ma&&r.triggerCustom("pointerDownMulti",z("touch",I),Z,M);ba=ia(I);if(ba.count>1)K=Q(ba);Aa=1;U=aa(ba)}}function S(I){if(O(I,n)){I.preventDefault();C=ia(I);if(R==Y)R=Math.abs(ba.x-C.x)>ta||Math.abs(ba.y-C.y)>ta?Ca:Y;if(R!=Y){R=C.count>1?ga:da;if(R==ga)if(ba.count===1){ba=aa(C);K=Q(ba)}else{var Z=Q(C);if(Math.abs(K-Z)<ja)R=da;else{var M;M=C.x;var ua=C.next.x,sa=C.y,ya=C.next.y,Xa=sa<ya?sa:ya;M={x:(M<ua?
M:ua)+(Math.abs(M-ua)>>1),y:Xa+(Math.abs(sa-ya)>>1)};Z=Z/K;ua=Z-Aa;r.triggerCustom("zoom",z("touch",I),M,ha(M,N),ua,"pinch");Aa=Z}}R==da&&r.triggerCustom("pointerMove",z("touch",I),C,aa(C,N.left,N.top),j(C.x-U.x,C.y-U.y));ma&&r.triggerCustom("pointerMoveMulti",z("touch",I),C,aa(C,N.left,N.top))}U=aa(C)}}function pa(I){if(O(I,n)){var Z=ia(I,"changedTouches"),M=aa(Z,N.left,N.top);C=ia(I);if(!C){r.triggerCustom("pointerUp",z("touch",I),Z,M);ba=null}ma&&r.triggerCustom("pointerUpMulti",z("touch",I),Z,
M)}}x=COG.extend({detailed:false,inertia:false},x);var ja=20,ta=7,Ca=0,Y=1,da=2,ga=3,N,R,ba,C,K,U,ma=x.detailed,Aa=1;x.binder("touchstart",W,false);x.binder("touchmove",S,false);x.binder("touchend",pa,false);COG.info("initialized touch handler");return{unbind:function(){x.unbinder("touchstart",W,false);x.unbinder("touchmove",S,false);x.unbinder("touchend",pa,false)}}},checks:{touch:true}});return{register:l,watch:function(n,r,x){r=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},r);capabilities=COG.extend({touch:"ontouchstart"in window},x);if(!r.observable){COG.info("creating observable");r.observable=COG.observable({});globalOpts=r}r.binder=r.isIE?u:G(r.bindToBody);r.unbinder=r.isIE?s:V(r.bindToBody);x=r.types;for(var Q=capabilities,aa=[],ia=D.length;ia--;){var W=D[ia],S=!x||x.indexOf(W.type)>=0,pa=true;for(var ja in W.checks){var ta=W.checks[ja];COG.info("checking "+ja+" capability. require: "+ta+", capability = "+Q[ja]);pa=pa&&ta===Q[ja]}if(S&&
pa)aa[aa.length]=W.handler}return new y(n,aa,r)}}}();var T5={};
(function(G){function V(){return(new Date).getTime()}function u(b,d){d=Rb.call(d);if(d=="finite")return!Sb[Tb](+b);return d=="null"&&b===null||d==typeof b||d=="object"&&b===Object(b)||d=="array"&&Array.isArray&&Array.isArray(b)||Ub.call(b).slice(8,-1).toLowerCase()==d}function s(b,d){this.x=b||0;this.y=d||0}function j(b,d,f,e){this.x=b||0;this.y=d||0;this.w=f||0;this.h=e||0;this.x2=this.x+this.w;this.y2=this.y+this.h}function l(b){b=b||(new Date).getTime();for(var d=0;d<Sa.length;){var f=Sa[d],e=
Na[f],a=Na[f].image&&(bb||Na[f].image.complete&&Na[f].image.width>0),c=b-e.start;c=a||c>=Vb;if(a){a=e.callbacks;ub[f]=e.image;for(var g=0;g<a.length;g++)a[g](e.image,true)}if(c){Sa.splice(d,1);delete Na[f]}else d++}Sa.length>0&&animFrame(l)}function q(b,d){var f=b&&d?ub[b]:null;if(f&&f&&(bb||f.complete&&f.width>0))d(f);else{if(f=Na[b])f.callbacks.push(d);else{f=new Image;f.id="_ldimg"+ ++Wb;Na[b]={start:(new Date).getTime(),image:f,callbacks:[d]};f.src=b;Sa[Sa.length]=b}animFrame(l)}}function z(b,
d,f,e,a,c){this.x=b;this.y=d;this.w=e||256;this.h=e||256;this.x2=this.x+this.w;this.y2=this.y+this.h;this.url=f;this.id=c||b+"_"+d;this.loaded=false;this.image=null}function O(b){function d(c){var g=b[c];u(g,qa)||e.push(function(i){i[c]=g})}function f(){e=[];for(var c in b)d(c)}b=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},b);var e=[],a={applyToContext:function(c){for(var g=
e.length;g--;)e[g](c)},update:function(c,g){b[c]=g;f()}};f();return a}function ha(){for(var b=0,d=arguments.length;d--;){var f=Xb[arguments[d].toUpperCase()];if(f)b|=f}return b}function o(b){b=b?b:(new Date).getTime();if(b-vb>Yb){for(var d=Ya.splice(0),f=d.length;f--;)d[f](b);vb=b}Ya.length&&animFrame(o)}function D(b){var d=Ya.length==0;Ya[Ya.length]=b;d&&animFrame(o)}function y(b,d,f,e,a){a=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},a);var c=(new Date).getTime(),
g=b[d],i=d=="translate",h=a.autoInvalidate,m=f.length&&e.length&&f.length==e.length?f.length:0,t=Array(m),E=Array(m),X=COG.easing(a.easing),H=a.duration,F=a.progress,k=function(w){var B=w-c;w=c+H<=w;for(var L=b.layer?b.layer.view:null,J,T=m;T--;){J=X(B,f[T],t[T],H);E[T]=i?J|0:J}g.apply(b,E);h&&L&&L.invalidate();if(F){B=[].concat(w?e:E);B.unshift(w);F.apply(b,B)}if(w){b.animations--;g.apply(b,e);a.complete&&a.complete.apply(b,e)}else D(k)};if(g&&g.apply&&m>0){H=H?H:DEFAULT_DURATION;for(d=m;d--;)t[d]=
e[d]-f[d];b.animations++;D(k)}}function n(b){b=COG.extend({fill:true,stroke:false,markerStyle:"simple",hoverStyle:"highlight",typeName:"Marker"},b);za.call(this,b)}function r(b,d){d=COG.extend({simplify:false,typeName:"Poly"},d);var f=d.simplify;za.call(this,d);COG.extend(this,{resync:function(e){var a,c,g,i,h,m;e.syncXY(b);m=this.points=Oa.floor(f?Oa.simplify(b):b);for(var t=m.length;t--;){e=m[t].x;a=m[t].y;i=u(i,qa)||e<i?e:i;h=u(h,qa)||a<h?a:h;c=u(c,qa)||e>c?e:c;g=u(g,qa)||a>g?a:g}this.updateBounds(new j(i,
h,c-i,g-h),true)}});this.haveData=b&&b.length>=2}function x(b,d){d.fill=false;r.call(this,b,d)}function Q(b){function d(){if(i&&i.width>0){if(!this.centerOffset)this.centerOffset=new s(-i.width>>1,-i.height>>1);this.updateBounds(new j(this.xy.x+this.centerOffset.x,this.xy.y+this.centerOffset.y,i.width,i.height),false)}}function f(m){if(this.imageUrl=m){var t=this;q(this.imageUrl,function(E,X){i=E;if(X){var H=h.layer?h.layer.view:null;H&&H.invalidate()}d.apply(t)})}}b=COG.extend({image:null,imageUrl:null,
centerOffset:null,typeName:"Image"},b);var e=null,a=za.prototype.resync,c=0,g=0,i=b.image;za.call(this,b);var h=COG.extend(this,{changeImage:f,drag:function(m,t,E,X){e||(e=new s(m.startX-this.xy.x,m.startY-this.xy.y));this.xy.x=t-e.x;this.xy.y=E-e.y;if(X){e=null;if(this.layer)if(m=this.layer.view){m.syncXY([this.xy],true);m.invalidate()}this.trigger("dragDrop")}return true},getProps:function(){this.bounds||d(this,i);return{image:i,x:this.xy.x+c,y:this.xy.y+g}},resync:function(m){a.call(this,m);d.call(this)}});
i||f.call(this,this.imageUrl);if(this.centerOffset){c=this.centerOffset.x;g=this.centerOffset.y}}function aa(b){b=COG.extend({imageAnchor:null},b);if(b.imageAnchor)b.centerOffset=Oa.invert(b.imageAnchor);Q.call(this,b)}function ia(b){b=COG.extend({startAngle:0,endAngle:Math.PI*2,typeName:"Arc"},b);za.call(this,b)}function W(b){b=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,validStates:ha("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);this.view=null;this.visible=
true;COG.observable(COG.extend(this,b))}function S(b){for(var d=null,f=1;!d&&f<arguments.length;f++)d=ta(b,arguments[f]);d=d?d:ta(b);if(!d)throw Error("Unable to find GEO engine with "+b+" capability");return d}function pa(b){b=parseFloat(b)*Da;b=M(b);var d=cb*b;return I((1+b)/(1-b)*ma((1-d)/(1+d),cb))/2}function ja(b){return N/(256<<b)}function ta(b,d){var f=null;for(var e in Pa)if(d){if(e==d&&Pa[e][b]){f=Pa[e];break}}else if(Pa[e][b]){f=Pa[e];break}return f}function Ca(b,d){var f=cb*M(b);return R-
2*ya(d*ma((1-f)/(1+f),cb/2))}function Y(b,d,f,e){d=da(d);b.add(e(d,f));return d.length}function da(b){var d=b?b.length:0,f=Array(d);for(d=d;d--;)f[d]=ea.init(b[d][1],b[d][0]);return ea.vectorize(f,wb)}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var ga=Array.prototype.indexOf||
function(b){for(var d=0;d<this.length;d++)if(this[d]===b)return d;return-1},N=Math.PI*2,R=Math.PI/2,ba=Math.abs,C=Math.ceil,K=Math.min,U=Math.max,ma=Math.pow,Aa=Math.sqrt,I=Math.log,Z=Math.round,M=Math.sin,ua=Math.asin,sa=Math.cos,ya=Math.atan,Xa=Math.atan2,Tb="hasOwnProperty",Sb={NaN:1,Infinity:1,"-Infinity":1},Rb=String.prototype.toLowerCase,Ub=Object.prototype.toString,qa="undefined",xb="number",Zb=typeof G_vmlCanvasManager!=qa,bb=typeof FlashCanvas!=qa,$b=T5.newCanvas=function(b,d){var f=document.createElement("canvas");
f.width=b?b:0;f.height=d?d:0;if(bb){document.body.appendChild(f);FlashCanvas.initElement(f)}Zb&&G_vmlCanvasManager.initElement(f);return f},yb=function(){var b={};return{init:function(d,f){var e=b[d];if(!e)throw Error("Unable to locate requested generator: "+d);return new e(f)},register:function(d,f){b[d]=f}}}();s.prototype={constructor:s};j.prototype={constructor:j};var Oa=function(){function b(e,a){return f(e.x-a.x,e.y-a.y)}function d(e,a){a=a||e.length;if(a<=1)return null;for(var c=Array(a-1),
g=Array(a-1),i=0,h,m=0;m<a-1;m++){h=b(e[m],e[m+1]);c[m]=Aa(h.x*h.x+h.y*h.y);g[m]=i+=c[m]}return{edges:c,accrued:g,tota:i}}function f(e,a){return new s(e,a)}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var e=0,a=0,c=arguments.length;c--;){e+=arguments[c].x;a+=arguments[c].y}return f(e,a)},absSize:function(e){return U(ba(e.x),ba(e.y))},copy:function(e){return e?f(e.x,e.y):null},diff:b,distance:function(e,a){return d(e,a).total},edges:d,equals:function(e,a){return e.x===
a.x&&e.y===a.y},extendBy:function(e,a,c){var g=sa(a)*c|0;a=M(a)*c|0;return f(e.x-g,e.y-a)},floor:function(e){for(var a=Array(e.length),c=e.length;c--;)a[c]=f(~~e[c].x,~~e[c].y);return a},getRect:function(e){for(var a,c,g,i,h=e.length;h--;){var m=e[h];a=u(a,qa)||m.x<a?m.x:a;c=u(c,qa)||m.y<c?m.y:c;g=u(g,qa)||m.x>g?m.x:g;i=u(i,qa)||m.y>i?m.y:i}return new j(a,c,g-a,i-c)},init:f,invert:function(e){return f(-e.x,-e.y)},min:function(e,a){return f(e.x<a.x?e.x:a.x,e.y<a.y?e.y:a.y)},max:function(e,a){return f(e.x>
a.x?e.x:a.x,e.y>a.y?e.y:a.y)},offset:function(e,a,c){return f(e.x+a,e.y+(c||a))},scale:function(e,a){return f(e.x/a|0,e.y/a|0)},simplify:function(e,a){if(!e)return null;a=a?a:Oa.VECTOR_SIMPLIFICATION;for(var c=[],g=null,i=e.length;i--;){var h=e[i];if(include=!g||i===0||ba(h.x-g.x)+ba(h.y-g.y)>a){c.unshift(h);g=h}}return c},theta:function(e,a,c){c=ua((e.y-a.y)/c);return e.x>a.x?c:Math.PI-c},toString:function(e){return e?e.x+", "+e.y:""}}}(),gb=function(){return{dotProduct:function(b,d){return b.x*
d.x+b.y*d.y}}}(),Ta=function(){function b(f){return d(f.x,f.y,f.x2,f.y2)}function d(f,e,a,c){return new j(f,e,(a||f)-f,(c||e)-e)}return{buffer:function(f,e,a){return Ta.init(f.x-e,f.y-(a||e),f.x+e,f.y+(a||e))},center:function(f){return new s(f.x+(f.w>>1),f.y+(f.h>>1))},copy:b,diagonalSize:function(f){return Aa(f.w*f.w+f.h*f.h)},fromCenter:function(f,e,a,c){a=a>>1;c=c>>1;return d(f-a,e-c,f+a,e+c)},init:d,intersect:function(f,e){var a=U(f.x,e.x),c=U(f.y,e.y),g=K(f.x2,e.x2),i=K(f.y2,e.y2);a=d(a,c,g,
i);return a.w>0&&a.h>0?a:null},toString:function(f){return f?"["+f.x+", "+f.y+", "+f.x2+", "+f.y2+"]":""},union:function(f,e){if(f.w===0||f.h===0)return b(e);else if(e.w===0||e.h===0)return b(f);else{var a=K(f.x,e.x),c=K(f.y,e.y),g=U(f.x2,e.x2),i=U(f.y2,e.y2);a=d(a,c,g,i);return a.w>0&&a.h>0?a:null}}}}();Hits=function(){return{diffHits:function(b,d){var f=[],e={},a;for(a=d.length;a--;)e[d[a].target.id]=true;for(a=b.length;a--;)e[b[a].target.id]||(f[f.length]=b[a]);return f},init:function(b,d,f,e){return{type:b,
x:e.x|0,y:e.y|0,elements:[],absXY:d,relXY:f}},initHit:function(b,d,f){return{type:b,target:d,drag:f}},triggerEvent:function(b,d,f,e){d.triggerCustom(b.type+(f?f:"Hit"),{hitType:b.type},e?e:b.elements,b.absXY,b.relXY,new s(b.x,b.y))}}}();var hb=function(b){function d(a,c){var g=f[a],i;g||(g=f[a]=[]);(i=g[c])||(i=g[c]=[]);return i}b=b||128;var f=[],e={};return{insert:function(a,c,g){var i=a.x/b|0,h=a.y/b|0,m=(a.x+a.w)/b|0;a=(a.y+a.h)/b|0;g=g||c.id||COG.objId("spatial");e[g]=c;for(c=i;c<=m;c++)for(i=
h;i<=a;i++)d(c,i).push(g)},remove:function(a,c,g){var i=a.x/b|0,h=a.y/b|0,m=(a.x+a.w)/b|0;a=(a.y+a.h)/b|0;g=g||c.id;delete e[g];for(c=i;c<=m;c++)for(i=h;i<=a;i++){var t=d(c,i),E=ga.call(t,g);E>=0&&t.splice(E,1)}},search:function(a){var c=a.y/b|0,g=(a.x+a.w)/b|0,i=(a.y+a.h)/b|0,h=[],m=[];for(a=a.x/b|0;a<=g;a++)for(var t=c;t<=i;t++)h=h.concat(d(a,t));h.sort();for(c=h.length;c--;){g=h[c];if(i=e[g])m[m.length]=i;for(;c>0&&h[c-1]==g;)c--}return m}}},Vb=3E4,ub={},Wb=0;(new Date).getTime();var Na={},Sa=
[];z.prototype={constructor:z,load:function(b){var d=this;q(this.url,function(f){d.loaded=true;d.image=f;b&&b()})}};var ac=function(){return{applyStyle:function(){},applyTransform:function(b,d,f){return{restore:null,x:d,y:f}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getOffset:function(){return new s},getViewport:function(){},hitTest:function(){return false},prepare:function(){},projectXY:null,render:function(){},reset:function(){}}},zb={},Ua=G.registerRenderer=function(b,
d){zb[b]=d},bc=G.attachRenderer=function(b,d,f,e){b=b.split("/");for(var a=new ac(d,f,e),c=0;c<b.length;c++){var g=zb[b[c]];if(g)a=new g(d,f,e,a)}return a};Ua("canvas",function(b,d,f,e){function a(k,w,B,L){var J=false;if(w)J=h.isPointInPath(X?w.x-m:w.relXY.x,X?w.y-t:w.relXY.y);return{draw:L||F,viewport:k,state:B,hit:J,vpX:m,vpY:t,context:h}}f=COG.extend({},f);var c,g,i,h,m=0,t=0,E=null,X=CANI.canvas.pipTransformed,H={},F=function(){this.fill&&h.fill();this.stroke&&h.stroke()};(function(){if(d){var k=
d.tagName=="CANVAS",w=k?d.parentNode:d;c=b.width=w.offsetWidth;g=b.height=w.offsetHeight;if(k){i=d;i.width=c;i.height=g;bb&&FlashCanvas.initElement(i)}else{i=$b(c,g);i.style.cssText="position: absolute; z-index: 1;";d.appendChild(i)}h=null}})();return COG.extend(e,{interactTarget:i,applyStyle:function(k){var w=cc(k),B=h&&h.canvas?h.canvas.id:"default",L;H[B]||(H[B]=[]);L=H[B].pop()||"basic";if(w){H[B].push(k);w.applyToContext(h);return L}},applyTransform:function(k){if(k.translateX!==0||k.translateY!==
0||k.scaling!==1||k.rotation!==0){h.save();E={undo:function(){h.restore();E=null},x:k.xy.x,y:k.xy.y};h.translate(k.xy.x-m+k.translateX,k.xy.y-t+k.translateY);k.rotation!==0&&h.rotate(k.rotation);k.scaling!==1&&h.scale(k.scaling,k.scaling)}return E},drawTiles:function(k,w){for(var B,L,J=m-256,T=t-256,fa=k.x2,ra=k.y2,Ba=w.length;Ba--;){B=w[Ba];if(L=B.x>=J&&B.x<=fa&&B.y>=T&&B.y<=ra)B.loaded?h.drawImage(B.image,B.x-m,B.y-t):B.load(b.invalidate)}},hitTest:function(k,w,B){return h.isPointInPath(w,B)},prepare:function(k,
w){var B,L=false,J=w.scaled||w,T=w.scaleFactor;if(h)h.restore();else h=i.getContext("2d");for(B=k.length;B--;)L=L||k[B].clip;m=J.x;t=J.y;if(h){L||h.clearRect(0,0,c,g);h.save();h.scale(T,T)}h.globalCompositeOperation="source-over";return h},prepArc:function(k,w,B,L){h.beginPath();h.arc(k.xy.x-(E?E.x:m),k.xy.y-(E?E.y:t),k.size>>1,k.startAngle,k.endAngle,false);return a(w,B,L)},prepImage:function(k,w,B,L,J){var T=(J.x||k.xy.x)-(E?E.x:m),fa=(J.y||k.xy.y)-(E?E.y:t),ra=J.image||k.image;if(ra){h.beginPath();
h.rect(T,fa,J.width||ra.width,J.height||ra.height);return a(w,B,L,function(){h.drawImage(ra,T,fa,J.width||ra.width,J.height||ra.height)})}},prepMarker:function(k,w,B,L){var J=k.xy.x-(E?E.x:m),T=k.xy.y-(E?E.y:t),fa=k.size;h.beginPath();switch(k.markerStyle.toLowerCase()){case "simple":h.moveTo(J,T);h.lineTo(J-(fa>>1),T-fa);h.lineTo(J+(fa>>1),T-fa);h.lineTo(J,T);break;case "image":k.image?h.drawImage(k.image,J-(fa>>1),T-(fa>>1),fa,fa):q(k.imageUrl,function(ra){k.image=ra;h.drawImage(k.image,J-(fa>>
1),T-(fa>>1),fa,fa)});break}return a(w,B,L)},prepPoly:function(k,w,B,L,J){var T=true;k=J.points||k.points;J=E?E.x:m;var fa=E?E.y:t;h.beginPath();for(var ra=k.length;ra--;){var Ba=k[ra].x-J,Qa=k[ra].y-fa;if(T){h.moveTo(Ba,Qa);T=false}else h.lineTo(Ba,Qa)}return a(w,B,L)},getContext:function(){return h},getDimensions:function(){return{width:c,height:g}},getOffset:function(){return new s(m,t)}})});var Ab={},dc=G.defineStyle=function(b,d){Ab[b]=O(d);return b},Bb=G.defineStyles=function(b){for(var d in b)dc(d,
b[d])},cc=G.getStyle=function(b){return Ab[b]};G.loadStyles=function(b){COG.jsonp(b,function(d){Bb(d)})};Bb({basic:{fillStyle:"#000"},highlight:{fillStyle:"#f00"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});var Xb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Kb=function(b){function d(p,v,A){Ea||Qa(ka-v,la-A)}function f(p,v,A,P){fa(K(U(na+ma(2,P)-1,0.5),2))}function e(){var p=I(na)/Math.LN2|
0;if(p!==0){na=ma(2,p);ra(Za+p,ec,fc)}redraw=true}function a(p,v){var A=renderer&&renderer.projectXY?renderer.projectXY(p,v):null;if(!A){A=$.getViewport();var P=1/na;A=new s(A?A.x+p*P:p,A?A.y+v*P:v)}return A}function c(p,v,A){Ba("doubleTap",v,A,a(A.x,A.y));b.scalable&&fa(2,a(A.x,A.y),b.zoomEasing,null,b.zoomDuration)}function g(p,v,A){Ea=null;B("down",v,A)}function i(p,v,A){B("hover",v,A)}function h(p,v,A){k(v,A,false)}function m(p,v,A){k(v,A,true)}function t(){clearTimeout(Cb);Cb=setTimeout(function(){renderer.checkSize()},
250)}function E(p,v,A){B("tap",v,A);Ba("tap",v,A,a(A.x,A.y,true))}function X(){renderer=bc(b.renderer,$,ib);Db=!renderer.preventPartialScale;F()}function H(p,v){v.id=p;v.added=V();v.view=$;v.trigger("parentChange",$,ib,gc);oa.push(v);oa.sort(function(A,P){var ca=P.zindex-A.zindex;if(ca===0)ca=P.added-A.added;return ca});Ga=oa.length;return v}function F(){wa&&wa.unbind();if(renderer){wa=INTERACT.watch(renderer.interactTarget);b.pannable&&wa.pannable().bind("pan",d);if(b.scalable){wa.bind("zoom",f);
wa.bind("doubleTap",c)}wa.bind("pointerDown",g);wa.bind("pointerMove",h);wa.bind("pointerUp",m);b.captureHover&&wa.bind("pointerHover",i);wa.bind("tap",E)}}function k(p,v,A){if(Ea){p=a(v.x,v.y);if(Ea.drag.call(Ea.target,Ea,p.x,p.y,A))redraw=true;if(A)Ea=null}}function w(p){var v,A,P=false;p=p||(new Date).getTime();if(P=p-Eb>hc){var ca=ba(ka-jb),va=ba(la-kb);v=ka!==lb||la!==mb;A=na!==Fb;if(v||A)Ka++;if(ca>=Gb||va>=Gb)T();A={index:ic++,draw:Ka};$.trigger("enterFrame",p,A);Eb=p}if(P&&A.draw){La=Hb|(na!==
1?Ib:0)|(v?nb:0)|(ob?Jb:0);pb=(v=(La&(Ib|nb))!==0)&&(La&Jb)===0;v=J();if(renderer.prepare(oa,v,La,p,xa)){Ka=0;for(ii=Ga;ii--;){P=oa[ii];if(P.visible&&(La&P.validStates)!==0){A=P.style?renderer.applyStyle(P.style,true):null;P.draw(renderer,v,La,$,p,xa);A&&renderer.applyStyle(A)}}renderer.render(v);$.trigger("drawComplete",v,p);lb=ka;mb=la;Fb=na}if(xa){p=xa?xa.elements:[];if($a&&$a.type==="hover"){v=Hits.diffHits($a.elements,p);v.length>0&&Hits.triggerEvent($a,$,"Out",v)}if(p.length>0){P=xa.x;A=xa.y;
for(v=p.length;v--;){ca=p[v];va=P;var Ha=A,Fa=ca&&ca.drag&&(!ca.canDrag||ca.canDrag(ca,va,Ha));if(Fa){Ea=ca;Ea.startX=va;Ea.startY=Ha}if(Fa)break}Hits.triggerEvent(xa,$)}$a=p.length>0?COG.extend({},xa):null;xa=null}}animFrame(w)}function B(p,v,A){xa=Hits.init(p,v,A,a(A.x,A.y,true));for(p=Ga;p--;)qb=qb||(oa[p].hitGuess?oa[p].hitGuess(xa.x,xa.y,La,$):false);qb&&Ka++}function L(){Ka++}function J(){var p=new j(ka,la,$.width,$.height);p.scaleFactor=na;if(na!==1)p.scaled=Ta.fromCenter(ka+($.width>>1),la+
($.height>>1),$.width/na|0,$.height/na|0);return p}function T(){var p=J();if(p){if(Va||Wa)if(p){var v=db?ka+(p.w>>1):ka,A=eb?la+(p.h>>1):la,P=p.w,ca=p.h;if(Va&&Va>P)if(v+P>Va)ka=db?ka:Va-P;else if(v<0)ka=db?ka:0;if(Wa&&Wa>ca)if(A+ca>Wa)la=eb?la:Wa-ca;else if(A<0)la=eb?la:0}jb=ka;kb=la;Ba("refresh",$,p);Ka++}}function fa(p,v,A,P,ca){var va;if(!Db){A=false;va=Z(I(p)/Math.LN2);p=ma(2,va)}if(A)COG.tweenValue(na,p,A,ca,function(Ha,Fa){na=Ha;if(Fa){va=Z(I(na)/Math.LN2);na=ma(2,va);P&&P()}e()});else{na=
p;e()}return $}function ra(p,v,A){p=U(b.minZoom,K(b.maxZoom,p));if(p!==Za){var P=ma(2,p-Za),ca=$.width>>1,va=$.height>>1,Ha=ca/P|0,Fa=va/P|0;Za=p;Qa(((v?v:ka+ca)-Ha)*P,((A?A:la+va)-Fa)*P);lb=ka;mb=la;kb=jb=0;Ba("zoomLevelChange",p);na=1;renderer.reset();T()}}function Ba(){for(var p=$.trigger.apply(null,arguments).cancel,v=oa.length;v--;)p=oa[v].trigger.apply(null,arguments).cancel||p;return!p}function Qa(p,v,A,P,ca){function va(){Ha+=1;if(Ha>=2){ob=false;ca&&ca()}}var Ha=0;if(A){if((La&nb)===0){COG.tweenValue(ka,
p,A,P,function(Fa,rb){ka=Fa|0;(rb?va:L)();return!pb});COG.tweenValue(la,v,A,P,function(Fa,rb){la=Fa|0;(rb?va:L)();return!pb});ob=true}}else{ka=p|0;la=v|0;ca&&ca()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,inertia:true,refreshDistance:256,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,renderer:"canvas",
zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var jc={},oa=[],Ga=0,ib=document.getElementById(b.container),Ea=null,ic=0,gc=null,kc=!u(window.attachEvent,qa),qb=false,Gb=b.refreshDistance,ka=0,la=0,jb=0,kb=0,lb=0,mb=0,Va=null,Wa=null,db=false,eb=false,xa=null,pb=false,$a=null,Cb=0,na=1,Fb=1,Eb=0,wa=null,Db=true,ob=false,hc=1E3/b.fps|0,Ka=0,ec,fc,Za=b.zoomLevel,Hb=ha("ACTIVE"),nb=ha("PAN"),Ib=ha("ZOOM"),Jb=ha("ANIMATING"),La=Hb,$={id:b.id,detach:function(){wa&&wa.unbind()},eachLayer:function(p){for(var v=
Ga;v--;)p(oa[v])},getLayer:function(p){for(var v=0;v<Ga;v++)if(oa[v].id===p)return oa[v];return null},getZoomLevel:function(){return Za},setLayer:function(p,v){for(var A=0;A<Ga;A++)if(oa[A].id===p){oa.splice(A,1);break}if(v){H(p,v);v.trigger("refresh",$,J());$.trigger("layerChange",$,v)}Ka++;return v},invalidate:L,refresh:T,resetScale:function(){na=1},scale:fa,setZoomLevel:ra,syncXY:function(){},triggerAll:Ba,removeLayer:function(p){a:{for(var v=Ga;v--;)if(oa[v].id===p){p=v;break a}p=-1}if(p>=0&&
p<Ga){$.trigger("layerRemove",$,oa[p]);oa.splice(p,1);Ka++}Ga=oa.length},getOffset:function(){return new s(ka,la)},getRenderer:function(){return renderer},getScaleFactor:function(){return na},setMaxOffset:function(p,v,A,P){Va=p;Wa=v;db=A;eb=P},getViewport:J,updateOffset:Qa,pan:function(p,v,A,P,ca){Qa(ka+p,la+v,A,P,ca)}};COG.observable($);$.bind("resync",function(){});COG.configurable($,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,
null,{container:function(p,v){ib=document.getElementById(v);X()},inertia:F,captureHover:F,scalable:F,pannable:F}),true);CANI.init(function(p){$.markers=H("markers",new fb({zindex:20}));jc=p;X();kc?window.attachEvent("onresize",t):window.addEventListener("resize",t,false)});animFrame(w);return $},za=function(b){b=COG.extend({style:null,xy:null,size:10,fill:false,stroke:true,draggable:false,observable:true,properties:{},typeName:"Shape"},b);COG.extend(this,b);this.id=COG.objId(this.typeName);this.view=
this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};za.prototype={constructor:za,animate:function(b,d,f,e){y(this,b,d,f,e)},drag:null,draw:null,getProps:null,resync:function(b){if(this.xy){b.syncXY([this.xy]);this.size&&this.updateBounds(Ta.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},rotate:function(b){this.rotation=b},scale:function(b){this.scaling=b},translate:function(b,d){this.translateX=b;this.translateY=
d},updateBounds:function(b,d){b&&(!this.bounds||b.x!=this.bounds.x||b.y!=this.bounds.y)&&this.trigger("move",this,b,this.bounds);this.bounds=b;if(d)this.xy=Ta.center(this.bounds)}};var Yb=1E3/60|0,Ya=[],vb=0;n.prototype=COG.extend(za.prototype,{constructor:n});r.prototype=COG.extend({},za.prototype,{constructor:r});x.prototype=COG.extend({},r.prototype);Q.prototype=COG.extend({},za.prototype,{constructor:Q});aa.prototype=COG.extend({},Q.prototype,{constructor:aa});ia.prototype=COG.extend(za.prototype,
{constructor:ia});W.prototype={constructor:W,clip:null,cycle:function(){},draw:function(){},hitGuess:null};Ua=function(b,d){function f(m,t){if(a&&i){g=a.search(i);i=null}var E=t&&t.getZoomLevel?t.getZoomLevel():0;c[E]||(c[E]=new hb);a=c[E]}d=COG.extend({imageLoadArgs:{}},d);var e=b?yb.init(b,d).run:null,a=null,c=[],g=[],i=null,h=COG.extend(new W(d),{draw:function(m,t){m.drawTiles(t,a.search(t))}});h.bind("refresh",function(m,t,E){var X=(new Date).getTime();if(a){g=i?a.search(i):[];e(t,E,a,function(){t.invalidate();
COG.info("GEN COMPLETED IN "+((new Date).getTime()-X)+" ms")});i=Ta.copy(E)}});h.bind("parentChange",f);h.bind("resync",f);return h};var Lb=function(b){function d(h){clearTimeout(g);g=setTimeout(function(){a.sort(function(m,t){if(t.xy&&m.xy){var E=t.xy.y-m.xy.y;return E!=0?E:t.xy.x-m.xy.x}});h&&h.invalidate()},50)}function f(h,m,t,E){E&&c.remove(E,m);c.insert(t,m)}function e(h,m){for(var t=a.length;t--;)a[t].resync(m)}b=COG.extend({zindex:10},b);var a=[],c=new hb,g=0,i=COG.extend(new W(b),{itemCount:0,
add:function(h,m){if(h){h.layer=i;if(m)a.unshift(h);else a[a.length]=h;var t=i.view;if(t){h.resync(t);c&&h.bounds&&c.insert(h.bounds,h);d(t)}h.bind("move",f)}i.itemCount=a.length},clear:function(){c=new hb;a=[];i.itemCount=0},draw:function(h,m,t,E,X,H){E={};X=c&&m?c.search(m):[];for(var F=X.length;F--;){var k=X[F],w=k.style||i.style,B,L=h.applyTransform(k),J=k.getProps?k.getProps(h,t):E;if(J=(B=h["prep"+k.typeName])?B.call(h,k,m,H,t,J):null){if(J.hit){H.elements.push(Hits.initHit(k.type,k,k.draggable?
k.drag:null));B=H.type+"Style";w=k[B]||i[B]||w}w=w?h.applyStyle(w,true):null;(B=k.draw||J.draw)&&B.call(k,J);w&&h.applyStyle(w)}L&&L.undo&&L.undo()}},find:function(){return[].concat(a)},hitGuess:function(h,m){return c&&c.search({x:h-10,y:m-10,w:20,h:20}).length>0}});i.bind("parentChange",e);i.bind("resync",e);return i},fb=function(b){return new Lb(b)};COG.extend(G,{ex:COG.extend,is:u,ticks:V,userMessage:function(b,d,f){G.trigger("userMessage",b,d,f)},indexOf:ga,Rect:j,XY:Oa,XYRect:Ta,Vector:gb,Hits:Hits,
Generator:yb,tweenValue:COG.tweenValue,easing:COG.easing,Tile:z,TileLayer:Ua,getImage:q,viewState:ha,View:Kb,ViewLayer:W,ImageLayer:Ua,Drawable:za,Marker:n,Poly:r,Line:x,Arc:ia,ImageDrawable:Q,ImageMarker:aa,DrawLayer:Lb,ShapeLayer:fb});COG.observable(G);var sb=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],Da=Math.PI/180,Ma=180/Math.PI,tb=R,Mb=-tb,Nb=N,lc=-Nb,cb=0.08181919084262157,ab=null,Ob={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",
LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ea=function(){function b(a){return a?f(a.lat,a.lon):null}function d(a){return!a||a.lat===0&&a.lon===0}function f(a,c){return{lat:parseFloat(a?a:0),lon:parseFloat(c?c:0)}}function e(a){if(a)if(u(a.lat,xb))return b(a);else{if(a.split)for(var c=[" ",","],g=0;g<c.length;g++){var i=a.split(c[g]);if(i.length===2)return f(i[0],i[1])}}else return f();return null}return{calcDistance:function(a,c){if(d(a)||d(c))return 0;var g=(c.lat-a.lat)*Da>>1,i=(c.lon-a.lon)*Da>>1;
g=M(g)*M(g)+sa(a.lat*Da)*sa(c.lat*Da)*M(i)*M(i);return 6371*2*Xa(Aa(g),Aa(1-g))},copy:b,empty:d,equal:function(a,c){return a&&c&&a.lat==c.lat&&a.lon==c.lon},fromMercatorPixels:function(a,c){for(var g=ma(Math.E,-c),i=R-2*ya(g),h=Ca(i,g),m=0;m<12&&ba(i-h)>1.0E-7;){i=h;h=Ca(i,g);m++}return f(h*Ma,a%360*Ma)},generalize:function(a,c,g){var i=a.length,h=[],m=null;g||(g=250);g/=1E3;COG.info("generalizing positions, must include "+c.length+" positions");for(var t=i;t--;)if(t===0)h.unshift(a[t]);else{var E=
!m||ea.inArray(a[t],c)?g:ea.calcDistance(m,a[t]);if(a[t]&&E>=g){h.unshift(a[t]);m=a[t]}}COG.info("generalized "+i+" positions into "+h.length+" positions");return h},inArray:function(a,c){for(var g=ea.equal,i=c.length;i--;)if(g(a,c[i]))return true;return false},inBounds:function(a,c){var g=!(ea.empty(a)||ea.empty(c));return g=(g=g&&a.lat>=c.min.lat&&a.lat<=c.max.lat)&&a.lon>=c.min.lon&&a.lon<=c.max.lon},init:f,offset:function(a,c,g){var i=a.lat*Da;a=a.lon*Da;c=i+c/6371;g=ua(M(g/6371)/sa(i));g=a+g;
c=(c+R)%Math.PI-R;g%=N;return f(c*Ma,g*Ma)},parse:e,parseArray:function(a){var c=a.length,g=Array(c);for(c=c;c--;)g[c]=e(a[c]);return g},toMercatorPixels:function(a){return T5.XY.init(parseFloat(a.lon)*Da,pa(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,c){function g(){for(var t=0,E=c.chunkSize,X=i;X--;){h[X]=T5.GeoXY.init(a[X]);t+=1;if(t>E)break}i=X;if(i<=0)c.callback&&c.callback(h);else animFrame(g)}var i=a.length,h=Array(i);c=COG.extend({chunkSize:500,async:true,
callback:null},c);if(!c.async){for(var m=i;m--;)h[m]=T5.GeoXY.init(a[m]);return h}animFrame(g);return null}}}(),Ia=function(){function b(a,c,g){var i=new s(0,c.lat-a.lat);i.x=(g||u(g,qa))&&a.lon>c.lon?360-a.lon+c.lon:c.lon-a.lon;return i}function d(a,c){return Ia.init(ea.init(a.min.lat-c,a.min.lon-c%360),ea.init(a.max.lat+c,a.max.lon+c%360))}function f(a){var c=b(a.min,a.max);return ea.init(a.min.lat+(c.y>>1),a.min.lon+(c.x>>1))}function e(a,c){return{min:ea.parse(a),max:ea.parse(c)}}return{calcSize:b,
createBoundsFromCenter:function(a,c){var g=c/6371,i=a.lat*Da,h=a.lon*Da,m=i-g,t=i+g;if(m>Mb&&t<tb){i=ua(M(g)/sa(i));g=(h-i)%N;h=(h+i)%N}else{m=U(m,Mb);t=K(t,tb);g=lc;h=Nb}return Ia.init(ea.init(m*Ma,g*Ma),ea.init(t*Ma,h*Ma))},expand:d,forPositions:function(a,c){var g=null,i=T5.ticks();c||(c="auto");for(var h=a.length;h--;)if(g){var m=b(g.min,a[h],false),t=b(a[h],g.max,false);if(m.x<0)g.min.lon=a[h].lon;if(m.y<0)g.min.lat=a[h].lat;if(t.x<0)g.max.lon=a[h].lon;if(t.y<0)g.max.lat=a[h].lat}else g=e(a[h],
a[h]);if(c){if(c=="auto"){h=b(g.min,g.max);c=U(h.x,h.y)*0.3}g=d(g,c)}COG.trace("calculated bounds for "+a.length+" positions",i);return g},getCenter:f,getGeoHash:function(a){var c=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+c+", max hash = "+a)},getZoomLevel:function(a,c){var g=f(a);g=K(Z(ba(g.lat)*0.05),sb.length);var i=sb[g],h=b(a.min,a.max);g=C(I(sb[3]*c.h/h.y)/I(2));i=C(I(i*c.w/h.x)/I(2));return K(isNaN(g)?1E3:g,isNaN(i)?1E3:i)},
init:e,isEmpty:function(a){return!a||ea.empty(a.min)||ea.empty(a.max)},toString:function(a){return"min: "+ea.toString(a.min)+", max: "+ea.toString(a.max)}}}();gb=function(){var b=/^(\d+).*$/,d=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(f,e){b.lastIndex=-1;if(b.test(f))for(var a=f.replace(b,"$1"),c=e.split(","),g=0;g<c.length;g++){d.lastIndex=-1;if(d.test(c[g])){var i=d.exec(c[g]);if(a>=parseInt(i[1],10)&&a<=parseInt(i[2],10))return true}else if(a==c[g])return true}return false},normalize:function(f){if(!f)return"";
f=f.toUpperCase();if(!ab){var e=[];for(var a in Ob)e.push(a);ab=RegExp("(\\s)("+e.join("|")+")(\\s|$)","i")}ab.lastIndex=-1;if(e=ab.exec(f))f=f.replace(ab,"$1"+Ob[e[2]]);return f},toString:function(f){return f.streetDetails+" "+f.location}}}();var Ja=G.GeoXY=function(){function b(e,a){if(e.length){for(var c,g,i,h,m=e.length;m--;){b(e[m],a);c=u(c,qa)||e.x<c?e.x:c;g=u(g,qa)||e.y<g?e.y:g;i=u(i,qa)||e.x>i?e.x:i;h=u(h,qa)||e.y>h?e.y:h}return new j(c,g,i-c,h-g)}else if(e.mercXY){c=e.mercXY;e.x=(c.x+Math.PI)/
a|0;e.y=(Math.PI-c.y)/a|0;e.rpp=a}return e}function d(e,a){if(e.length)for(var c=e.length;c--;)d(e[c],a);else{e.mercXY=new s(e.x*a-Math.PI,Math.PI-e.y*a);e.pos=ea.fromMercatorPixels(e.mercXY.x,e.mercXY.y)}return e}function f(e,a,c){e.pos=a;e.mercXY=ea.toMercatorPixels(a);(c=u(c,xb)?c:e.rpp)&&b(e,c)}return{init:function(e,a){var c=new s;f(c,e,a);return c},sync:b,syncPos:d,toPos:function(e,a){a=a||e.rpp;return ea.fromMercatorPixels(e.x*a-Math.PI,Math.PI-e.y*a)},updatePos:f}}(),Pa={};Ua=function(){return{bestResults:function(b,
d){d||(d=20);for(var f=b.length>0?b[0]:null,e=[],a=0;a<b.length;a++)if(f&&b[a]&&f.matchWeight-b[a].matchWeight<=d)e.push(b[a]);else break;return e}}}();var Pb=function(b){b=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},b);return COG.extend(b,{toString:function(){return b.caption+(b.matchWeight?" ("+b.matchWeight+")":"")}})},mc=function(){function b(a,c){var g=new T5.ShapeLayer;c.geometry&&ea.vectorize(c.geometry,{callback:function(i){g.add(new T5.Line(i,{style:"waypoints",
simplify:true}));a.setLayer("route",g)}})}function d(a){for(var c=f.Unknown,g=e,i=0;i<g.length;i++){g[i].regex.lastIndex=-1;var h=g[i].regex.exec(a);if(h){c=g[i].customCheck?g[i].customCheck(a,h):g[i].turnType;break}}return c}var f={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",
Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},e=function(){var a=[];a.push({regex:/continue/i,turnType:f.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(c,g){return/bear/i.test(g[1])?f.TurnLeftSlight:f.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(c,g){return/bear/i.test(g[1])?f.TurnRightSlight:f.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:f.EnterRoundabout});
a.push({regex:/take.*?ramp/i,turnType:f.Ramp});a.push({regex:/take.*?exit/i,turnType:f.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(c,g){return/right/i.test(g[1])?f.UTurnRight:f.UTurnLeft}});a.push({regex:/proceed/i,turnType:f.Start});a.push({regex:/arrive/i,turnType:f.Arrive});a.push({regex:/fell\sthrough/i,turnType:f.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var c=
S("route");c&&c.route(a,function(g){if(a.generalize)g.geometry=ea.generalize(g.geometry,g.getInstructionPositions());if(a.map){b(a.map,g);a.autoFit&&a.map.gotoBounds(g.boundingBox)}a.success&&a.success(g)})},createMapOverlay:b,parseTurnType:d,TurnType:f,Instruction:function(a){var c=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),g=a.description;g=g.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");c.description=g;if(!a.turnType)a.turnType=d(a.description);
return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Ia.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var c=[],g=0;g<a.instructions.length;g++)a.instructions[g].position&&c.push(a.instructions[g].position);return c}},a)}}}(),nc="featurecollection",oc="feature",wb={async:false},Ra={processor:null,group:"shapes",layerClass:fb},pc={point:COG.extend({},Ra,{processor:function(b,d,f,e){d=da([d.coordinates],
wb);if(d.length>0)if(f=e.marker(d[0],f)){b.add(f);return d.length}},group:"markers",layerClass:fb}),linestring:COG.extend({},Ra,{processor:function(b,d,f,e){d=da(d&&d.coordinates?d.coordinates:[]);return Y(b,d,f,e.line)}}),multilinestring:COG.extend({},Ra,{processor:function(b,d,f,e){d=d&&d.coordinates?d.coordinates:[];for(var a=0,c=d.length;c--;)a+=Y(b,d[c],f,e.line);return a}}),polygon:COG.extend({},Ra,{processor:function(b,d,f,e){d=d&&d.coordinates?d.coordinates:[];if(d.length>0)return Y(b,d[0],
f,e.poly);return 0}}),multipolygon:COG.extend({},Ra,{processor:function(b,d,f,e){d=d&&d.coordinates?d.coordinates:[];for(var a=0,c=0;c<d.length;c++)a+=Y(b,d[c][0],f,e.poly);return a}})},Qb=function(b,d,f,e){function a(k,w){var B=k.processor,L=m+k.group,J=COG.extend({},k,f,{properties:w.properties});if(B){var T=F[L];if(!T){T=new k.layerClass({id:L});F[L]=T}return B(T,w.data,J,e)}return 0}function c(k,w){var B=k&&k.type?k.type.toLowerCase():null;return B&&B===oc?c(k.geometry,k.properties):{type:B,isCollection:B?
B===nc:false,definition:pc[B],data:k,properties:w?w:k.properties}}function g(k){var w=0,B=COG.extend({},f),L=t;k=k?k:(new Date).getTime();if(!X){for(;L<E;L++){k=c(h?h(b[L]):b[L]);var J=null;if(k.isCollection){B.layerPrefix=m+H++ +"-";X=new Qb(k.data.features,function(T){X=null;for(var fa in T)F[fa]=T[fa];t>=E&&d&&d(F)},B);J+=1}else if(k.definition)J=a(k.definition,k);w+=J?J:1;if(w>=i)break}t=L+1;if(X||t<E)animFrame(g);else d&&d(F)}}f=COG.extend({rowPreParse:null,simplify:false,layerPrefix:"geojson-"},
f);e=COG.extend({marker:function(k){return new n({xy:k})},line:function(k,w){return new r(k,COG.extend({},f,w))},poly:function(k,w){return new r(k,COG.extend({fill:true},f,w))}},e);var i=500,h=f.rowPreParse,m=f.layerPrefix,t=0,E=0,X=null,H=0,F={};if(b){u(b,"array")||(b=[b]);E=b.length;animFrame(g)}};Ra=G.GeoJSON={parse:function(b,d,f){return new Qb(b,d,f)}};G.Map=function(b){function d(F){try{var k=ea.init(F.coords.latitude,F.coords.longitude),w=F.coords.accuracy/1E3;H.trigger("locationUpdate",F,
w);if(t){if(!h){h=new UI.LocationOverlay({pos:k,accuracy:w});h.update(H.getTileLayer());H.setLayer("location",h)}var B=Ia.createBoundsFromCenter(k,Math.max(w,1));H.gotoBounds(B)}else{h.pos=k;h.accuracy=w;h.update(H.getTileLayer());a(k,null,COG.easing("sine.out"))}t=false}catch(L){COG.exception(L)}}function f(F){COG.info("caught location tracking error:",F)}function e(F,k,w){H.setZoomLevel(k);a(F,w)}function a(F,k,w,B){F=Ja.init(F,ja(H.getZoomLevel()));H.updateOffset(F.x-(H.width>>1),F.y-(H.height>>
1),w,B,function(){k&&k(H)})}b=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,minZoom:1,maxZoom:18,pannable:true,scalable:true},b);var c={NONE:0,SINGLE:1,WATCH:2},g=new s,i=c.NONE,h=null,m=0,t=true,E=0,X=b.tapExtent;b.adjustScaleFactor=function(F){return Math.pow(2,(F<1?Math.floor:Math.ceil)(Math.log(F)))};var H=COG.extend(new Kb(b),{getBoundingBox:function(){var F=H.getViewport();return F?Ia.init(Ja.toPos(new s(F.x,F.y2),E),Ja.toPos(new s(F.x2,F.y),E)):null},getCenterPosition:function(){var F=
H.getViewport();if(F){F=new s(F.x+(F.w>>1),F.y+(F.h>>1));return Ja.toPos(F,E)}return null},gotoBounds:function(F,k){var w=Ia.getZoomLevel(F,H.getViewport());e(Ia.getCenter(F),w,k)},gotoPosition:e,panToPosition:a,syncXY:function(F,k){return(k?Ja.syncPos:Ja.sync)(F,E)},locate:function(){H.trackStart(c.SINGLE);setTimeout(H.trackCancel,1E4)},trackStart:function(F){if(navigator.geolocation&&!m){i=F?F:c.WATCH;t=true;m=navigator.geolocation.watchPosition(d,f,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},
trackCancel:function(){m&&navigator.geolocation&&navigator.geolocation.clearWatch(m);H.removeLayer("location");h=null;i=c.NONE;m=0},animateRoute:function(F,k,w,B){var L=H.getLayer("route");if(L)(F=L.getAnimation(F,k,w,B))&&F.addToView(H)}});H.bind("pan",function(){i===c.SINGLE&&H.trackCancel()});H.bind("tap",function(F,k,w,B){F=Ja.toPos(B,E);var L=Ja.toPos(Oa.offset(B,-X,X),E);B=Ja.toPos(Oa.offset(B,X,-X),E);H.trigger("geotap",k,w,F,Ia.init(L,B))});H.bind("refresh",function(F,k,w){if(g.x!=w.x||g.y!=
w.y){H.trigger("boundsChange",H.getBoundingBox());g.x=w.x;g.y=w.y}});H.bind("zoomLevelChange",function(F,k){var w;E=ja(k);w=N/E|0;H.setMaxOffset(w,w,true,false);H.resetScale();H.triggerAll("resync",H)});return H};G.GeoShape=function(b,d){d=COG.extend({autoParse:true},d);for(var f=Array(b.length),e=d.autoParse,a=T5.Geo.Position.parse,c=b.length;c--;)f[c]=T5.GeoXY.init(e?a(b[c]):b[c]);return new T5.Poly(f,d)};G.LocationOverlay=function(b){b=COG.extend({pos:null,accuracy:null,zindex:90},b);var d=new Image,
f=T5.XY.init(),e=T5.XY.init(),a=null;d.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
d.onload=function(){f=T5.XY.init(d.width>>1,d.height>>1)};var c=COG.extend(new T5.ViewLayer(b),{pos:b.pos,accuracy:b.accuracy,drawAccuracyIndicator:false,draw:function(g,i){var h=e.x-i.x,m=e.y-i.y;if(a){g.fillStyle="rgba(30, 30, 30, 0.2)";g.beginPath();g.arc(h,m,a,0,Math.PI*2,false);g.fill()}d.complete&&d.width>0&&g.drawImage(d,h-f.x,m-f.y,d.width,d.height)},update:function(g){if(g){a=g.getPixelDistance(c.accuracy)>>1;e=g.getGridXYForPosition(c.pos)}}});c.bind("gridUpdate",function(g,i){c.update(i)});
return c};G.Geo={distanceToString:function(b){if(b>1E3)return~~(b/10)/100+" km";return b?b+" m":""},dist2rad:function(b){return b/6371},getEngine:S,radsPerPixel:ja,Position:ea,BoundingBox:Ia,Radius:function(b,d){return{distance:parseInt(b,10),uom:d}},Address:function(b){return b=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},b)},A:gb,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(b){if(!b.id)throw Error("A GEO.Engine cannot be registered without providing an id.");
var d=COG.extend({remove:function(){delete Pa[d.id]}},b);return Pa[d.id]=d},Search:Ua,GeoSearchResult:Pb,LocationSearch:function(b){function d(g,i){navigator.geolocation.clearWatch(e);e=0;if(a){clearTimeout(a);a=0}i&&i([g],b)}function f(g){COG.info("caught location tracking error:",g)}b=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},b);var e=0,a=0,c=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(g,i){if(navigator.geolocation&&!e){e=navigator.geolocation.watchPosition(function(h){var m=
ea.init(h.coords.latitude,h.coords.longitude);h=new Pb({id:1,caption:"Current Location",pos:m,accuracy:h.coords.accuracy/1E3,matchWeight:100});if(!c||h.accuracy<c.accuracy)c=h;if(!b.requiredAccuracy||c.accuracy<b.requiredAccuracy)d(c,i)},f,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(b.searchTimeout)a=setTimeout(function(){c&&d(c,i)},b.searchTimeout)}}},b))},Routing:mc,GeoJSON:Ra}})(T5);
