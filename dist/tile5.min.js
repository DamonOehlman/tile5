COG=function(){var k=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,l=0,d={id:"grunt.core",extend:function(){var a=arguments[0]||{},e=1,f=arguments.length,b=false,o,g,n,h;if(typeof a==="boolean"){b=a;a=arguments[1]||{};e=2}if(typeof a!=="object"&&!d.isFunction(a))a={};if(f===e){a=this;--e}for(;e<f;e++)if((o=arguments[e])!=null)for(g in o){n=a[g];h=o[g];if(a!==h)if(b&&h&&(d.isPlainObject(h)||d.isArray(h))){n=n&&(d.isPlainObject(n)||d.isArray(n))?n:d.isArray(h)?[]:{};a[g]=d.extend(b,n,h)}else if(h!==
undefined)a[g]=h}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var e;for(e in a);return e===undefined||m.call(a,e)},isEmptyObject:function(a){for(var e in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,e){var f=a,b=arguments,o=1;if(e&&d.isArray(e)){b=e;o=0}for(o=o;o<b;o++)f=f&&typeof foo[b[o]]!=="undefined";return f},newModule:function(a){a=d.extend({id:null,requires:[],parent:null},a);if(a.parent)a=d.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+l++},formatStr:function(a){if(arguments.length<=1)return a;for(var e=arguments.length-2,f=0;f<=e;f++)a=a.replace(RegExp("\\{"+f+"\\}","gi"),arguments[f+
1]);return a},wordExists:function(a,e){var f="";if(e.toString)e=e.toString();for(var b=0;b<e.length;b++)f+=!/\w/.test(e[b])?"\\"+e[b]:e[b];return RegExp("(^|\\s|\\,)"+f+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,e){for(var f=k.exec(a);f;){a=a.replace(f[0],COG.XPath.first(f[1],e));k.lastIndex=0;f=k.exec(a)}return a}};return d}();
COG.Log=function(){function k(e,f){var b,o=f&&f.length>0?f[0]:"";for(b=1;f&&b<f.length;b++)o+=" "+(l&&COG.isPlainObject(f[b])?JSON.stringify(f[b]):f[b]);typeof console!=="undefined"&&console[e](o);for(b=0;b<m.length;b++)m[b].call(a,o,e)}var m=[],l=typeof JSON!=="undefined",d=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return d?(new Date).getTime():null},trace:function(e,f){if(d)console.markTimeline(e+(f?": "+(a.getTraceTicks()-f)+"ms":""))},debug:function(){k("debug",
arguments)},info:function(){k("info",arguments)},warn:function(){k("warn",arguments)},error:function(){k("error",arguments)},exception:function(e){a.error(arguments);for(var f in e)a.info("ERROR DETAIL: "+f+": "+e[f])},watch:function(e,f){try{f()}catch(b){a.exception(b,e)}},throwError:function(e){a.error(e);throw Error(e);},requestUpdates:function(e){m.push(e)}};return a}();
(function(){function k(d,a){d[a]||(d[a]=function(e){return d.configure(a,e)})}function m(d){d.gtConfId=COG.objId("configurable");d.gtConfig={};d.gtConfigFns=[];return d.gtConfig}var l={};COG.paramTweaker=function(d,a,e){return function(f,b){if(typeof b!=="undefined"){if(f in d)d[f]=b;e&&f in e&&e[f](f,b)}else return a&&f in a?a[f](f):d[f]}};COG.configurable=function(d,a,e,f){if(d){d.gtConfId||m(d);var b=d.gtConfId,o=d.gtConfig,g=d.gtConfigFns;l[b]=d;g.push(e);for(e=a.length;e--;){o[a[e]]=true;f&&
k(d,a[e])}if(!d.configure)d.configure=function(n,h){if(o[n]){for(var p=g.length;p--;){var v=g[p](n,h);if(typeof v!=="undefined")return v}return l[b]}return null}}}})();
(function(){function k(m,l){var d=m.gtObsHandlers;d[l]||(d[l]=[]);return d[l]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(l,d){var a=COG.objId("callback");k(m,l).unshift({fn:d,id:a});return a};m.trigger=function(l){var d=k(m,l),a={cancel:false,tickCount:(new Date).getTime()},e;if(!d)return null;e=Array.prototype.slice.call(arguments,1);e.unshift(a);for(var f=d.length;f--&&!a.cancel;)d[f].fn.apply(self,e);return a};m.unbind=
function(l,d){for(var a=k(m,l),e=0;a&&e<a.length;e++)if(a[e].id===d){a.splice(e,1);break}return m}}}}})();(function(){var k={},m=[];COG.addPipe=function(l){l("pipe.test",{});m.push(l)};COG.listen=function(l,d){k[l]||(k[l]=[]);d&&k[l].push(d)};COG.say=function(l,d){var a;for(a=m.length;a--;)m[a](l,d);if(k[l])for(a=k[l].length;a--;)k[l][a](d)}})();
COG.Loopage=function(){function k(h){return COG.extend({id:e++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},h)}function m(h){b.push(h);l()}function l(){o&&clearTimeout(o);o=setTimeout(d,0);n=true}function d(){for(var h,p=(new Date).getTime(),v=f.length;b.length>0;){var y=b.shift();for(h=v;h--;)if(f[h].id===y){f.splice(h,1);break}n=true;v=f.length}if(n){g=a;for(h=v;h--;)g=f[h].frequency<g?f[h].frequency:g}for(h=v;h--;){y=p-f[h].lastTick;if(f[h].lastTick===0||y>=f[h].frequency){f[h].execute(p,
f[h]);f[h].lastTick=p;f[h].single&&f[h].trigger("complete")}}o=v?setTimeout(d,g):0}var a=6E4,e=0,f=[],b=[],o=0,g=a,n=true;return{join:function(h){var p=new k(h);if(p.after>0)p.lastTick=(new Date).getTime()+p.after;COG.observable(p);p.bind("complete",function(){m(p.id)});f.unshift(p);l();return p},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function k(g){return g<10?"0"+g:g}function m(g){a.lastIndex=0;return a.test(g)?'"'+g.replace(a,function(n){var h=b[n];return typeof h==="string"?h:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+g+'"'}function l(g,n){var h,p,v,y,x=e,u,t=n[g];if(t&&typeof t==="object"&&typeof t.toJSON==="function")t=t.toJSON(g);if(typeof o==="function")t=o.call(n,g,t);switch(typeof t){case "string":return m(t);case "number":return isFinite(t)?String(t):"null";case "boolean":case "null":return String(t);
case "object":if(!t)return"null";e+=f;u=[];if(Object.prototype.toString.apply(t)==="[object Array]"){y=t.length;for(h=0;h<y;h+=1)u[h]=l(h,t)||"null";v=u.length===0?"[]":e?"[\n"+e+u.join(",\n"+e)+"\n"+x+"]":"["+u.join(",")+"]";e=x;return v}if(o&&typeof o==="object"){y=o.length;for(h=0;h<y;h+=1){p=o[h];if(typeof p==="string")if(v=l(p,t))u.push(m(p)+(e?": ":":")+v)}}else for(p in t)if(Object.hasOwnProperty.call(t,p))if(v=l(p,t))u.push(m(p)+(e?": ":":")+v);v=u.length===0?"{}":e?"{\n"+e+u.join(",\n"+e)+
"\n"+x+"}":"{"+u.join(",")+"}";e=x;return v}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+k(this.getUTCMonth()+1)+"-"+k(this.getUTCDate())+"T"+k(this.getUTCHours())+":"+k(this.getUTCMinutes())+":"+k(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,f,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;if(typeof JSON.stringify!=="function")JSON.stringify=function(g,n,h){var p;f=e="";if(typeof h==="number")for(p=0;p<h;p+=1)f+=" ";else if(typeof h==="string")f=h;if((o=n)&&typeof n!=="function"&&(typeof n!=="object"||typeof n.length!=="number"))throw Error("JSON.stringify");return l("",
{"":g})};if(typeof JSON.parse!=="function")JSON.parse=function(g,n){function h(v,y){var x,u,t=v[y];if(t&&typeof t==="object")for(x in t)if(Object.hasOwnProperty.call(t,x)){u=h(t,x);if(u!==undefined)t[x]=u;else delete t[x]}return n.call(v,y,t)}var p;g=String(g);d.lastIndex=0;if(d.test(g))g=g.replace(d,function(v){return"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(g.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){p=eval("("+g+")");return typeof n==="function"?h({"":p},""):p}throw new SyntaxError("JSON.parse");}})();
(function(){function k(l,d){var a=l.split("|"),e={};for(var f in d){var b=d[f];e[f]=a.length>b?a[b]:null}return e}var m={JSON:{parse:function(l){return JSON.parse(l)}},PDON:{parse:function(l){var d=null,a=[];l=l.split("\n");for(var e=0;e<l.length;e++){var f=l[e];if(d)a.push(k(f,d));else if(f){d=f.split("|");f={};for(var b=0;b<d.length;b++)f[d[b]]=b;d=f}else d=null}return a}}};COG.parseData=function(l,d){d=d?d.toUpperCase():"JSON";if(!m[d])throw Error("Unsupported data format: "+d);try{return m[d].parse(l)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function k(a){for(var e=null,f=0;f<m.length;f++)if(e=m[f](a))break;return e}var m=[],l=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var d={SearchResult:function(a){return{toString:function(){var e=
null;if(a){var f=null;if(a.resultType>=0&&a.resultType<l.length)f=l[a.resultType];if(f)e=f(a)}return e?e:""}}},first:function(a,e){var f=d.SearchResult,b;var o=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!o)o=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(e))b=e.evaluate(a,e,k,o,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(g){COG.Log.warn("invalid xpath expression: "+a+" on node: "+e);b=null}return new f(b)},registerResolver:function(a){m.push(a)}};return d}();
COG.Storage=function(){function k(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,l){var d=k(l).getItem(m);return/^(\{|\[).*(\}|\])$/.test(d)?JSON.parse(d):d},set:function(m,l,d){l=jQuery.isArray(l)||jQuery.isPlainObject(l)?JSON.stringify(l):l;k(d).setItem(m,l)},remove:function(m,l){k(l).removeItem(m)}}}();
COG.ParseRules=function(){var k=[];return{add:function(m,l){k.push({regex:m,handler:l})},each:function(m,l,d){function a(){e++;d&&e>=k.length&&d(l)}for(var e=0,f=0;f<k.length;f++){var b=k[f].regex,o=k[f].handler,g=false;if(b){b.lastIndex=-1;if((b=b.exec(m))&&o){g=true;o(b,l,a)&&a()}}g||a()}}}};
(function(){function k(b){var o=[],g=function(h,p){p=COG.isFunction(p)?p():p;o[o.length]=encodeURIComponent(h)+"="+encodeURIComponent(p)};if(COG.isArray(b))for(var n=0;n<b.length;n++)g(b[n].name,b[n].value);else for(n in b)g(n,b[n]);return o.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},l={JSON:["json"],PDON:["pdon.txt"]},d=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,e={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},f={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function o(){if(this.readyState===4){var p=null,v=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(v)if(b.handleResponse)b.handleResponse(this);else{var y=b,x=this.getResponseHeader(f.CONTENT_TYPE),u,t=false;for(u in m)if(x&&x.indexOf(m[u])>=0){t=true;
break}x=!t;for(t=0;t<d.length;t++)x=x||d[t]==u;if(x)b:{x=u;for(var E in l)for(t=0;t<l[E].length;t++)if(RegExp(l[E][t]+"$","i").test(y.url)){u=E;break b}u=x?x:"DEFAULT"}try{p=e[u](this,y)}catch(z){p=e.DEFAULT(this,y)}}else b.error&&b.error(this)}catch(R){COG.Log.exception(R,"PROCESSING AJAX RESPONSE")}v&&p&&b.success&&b.success.call(this,p)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var g=
a.exec(b.url),n=g&&(g[1]&&g[1]!==location.protocol||g[2]!==location.host);if(b.data)b.method="POST";if(b.url){g=null;if(b.xhr)g=b.xhr(b);g||(g=new XMLHttpRequest);g.open(b.method,b.url,b.async);b.data&&g.setRequestHeader("Content-Type",b.contentType);n||g.setRequestHeader("X-Requested-With","XMLHttpRequest");g.onreadystatechange=o;g.send(b.method=="POST"?k(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(h){COG.Log.exception(h)}}})();
(function(){function k(a){var e=document.createElement("script"),f=false;e.src=a;e.async=true;e.onload=e.onreadystatechange=function(){if(!f&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f=true;e.onload=e.onreadystatechange=null;e&&e.parentNode&&e.parentNode.removeChild(e)}};l||(l=document.getElementsByTagName("head")[0]);l.appendChild(e)}var m=0,l,d=this;COG.jsonp=function(a,e,f){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++m;d[b]=function(o){e(o);d[b]=null;try{delete d[b]}catch(g){}};
k(a+(f?f:"callback")+"="+b);return b}})();
COG.Touch=function(){function k(s,q){return{x:s.x-q.x,y:s.y-q.y}}function m(s,q){var r=k(s,q);return Math.sqrt(r.x*r.x+r.y*r.y)}function l(s){if(s.count>1)return m(s.touches[0],s.touches[1]);return 0}function d(s,q){var r=s&&s.count>0?s.touches[0]:null;if(r&&q&&q.count>0)return k(r,q.touches[0]);return null}function a(s,q){s.count=q.count;for(var r=g;r--;){s.touches[r].x=q.touches[r].x;s.touches[r].y=q.touches[r].y}}function e(){for(var s={count:0,touches:Array(g)},q=g;q--;)s.touches[q]=o();return s}
function f(s){if(s.preventDefault){s.preventDefault();s.stopPropagation()}else s.cancelBubble&&s.cancelBubble()}function b(s,q,r){if(H){q=q[r?r:"touches"];r=q.length;for(r=s.count=r;r--;){s.touches[r].x=q[r].pageX;s.touches[r].y=q[r].pageY}}else if(q.button===0){s.count=1;s.touches[0].x=q.pageX?q.pageX:q.screenX;s.touches[0].y=q.pageY?q.pageY:q.screenY}else s.count=0}function o(s,q){return{x:s?s:0,y:q?q:0}}var g=10,n=120,h=100,p=250,v=300,y=5,x=0,u=1,t=2,E=7,z=0,R=0,H=undefined,M=function(s){function q(C,
I,L,Z){var O=Math.asin((C.y-I.y)/L);L=L*(ka/Z)>>0;L=L>ta?ta:L;O=I.x>C.x?O:Math.PI-O;F("pan",Math.cos(O)*-L,Math.sin(O)*L,true)}function r(C,I){var L,Z;if(H){L=I-Q;if(L<p){Z=m(U.touches[0],C);Z>s.inertiaTrigger&&q(U.touches[0],C,Z,L)}}else{ca.x=C.x;ca.y=C.y;COG.Loopage.join({execute:function(O,A){L=O-I;Z=m(C,ca);if(L<h&&Z>s.inertiaTrigger){A.trigger("complete");q(C,ca,Z,L)}else L>h&&A.trigger("complete")},frequency:10})}}function w(C){var I=0,L=0;if(C.offsetParent){do{I+=C.offsetLeft;L+=C.offsetTop;
C=C.offsetParent}while(C)}return o(I,L)}function B(C){var I=C.count,L=Array(I),Z=w(ea);for(I=I;I--;)L[I]=o(C.touches[I].x-Z.x,C.touches[I].y-Z.y);return L}function F(){oa&&oa.trigger.apply(null,arguments)}function G(C,I){var L=w(ea);L=o(I.x-L.x,I.y-L.y);F(C,I,L)}function K(C){var I=C.target?C.target:C.srcElement;if(fa||I&&I===ea){b(U,C);if(U.count!==0){aa=null;ga.x=0;ga.y=0;pa=true;ha=false;Q=(new Date).getTime();f(C);I.style.cursor="move";F("inertiaCancel");ua=Q;if(C=U.count>0?U.touches[0]:null){F("touchStart",
C.x,C.y);if(ua-va<v)if((C=k(U.touches[0],qa.touches[0]))&&Math.abs(C.x)<s.maxDistDoubleTap&&Math.abs(C.y)<s.maxDistDoubleTap)ha=true;da=x;a(qa,U)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function S(C){var I=C.target?C.target:C.srcElement,L=0;if(fa||I&&I===ea){b(V,C);if(V.count>0){ca.x=V.touches[0].x;ca.y=V.touches[0].y}if(pa){H&&f(C);if(V.count>1){U.count===1&&a(U,V);L=l(U)-l(V)}if(da===x)if((C=d(V,U))&&(Math.abs(C.x)>=E||Math.abs(C.y)>=E))da=u;if(da!==x)if(!L||Math.abs(L)<
y){if(aa=d(V,qa)){ga.x-=aa.x;ga.y-=aa.y;ia.x-=aa.x;ia.y-=aa.y}F("pan",ia.x,ia.y);ia.x=0;ia.y=0;da=u}else{F("pinchZoom",B(U),B(V));da=t}a(qa,V)}}}function la(C){var I=C.target?C.target:C.srcElement;if(pa&&(fa||I&&I===ea)){b(ma,C,"changedTouches");var L=ma.touches[0];H&&f(C);C=(new Date).getTime();va=ua;if(da===x){G("tap",U.touches[0]);sa||(sa=setTimeout(function(){sa=0;ha&&G("doubleTap",U.touches[0])},v+50))}else if(da==u){F("panEnd",ga.x,ga.y);na&&r(L,C)}else da==t&&F("pinchZoomEnd",B(U),B(qa),C-
Q);I.style.cursor="default";pa=false}}function X(C){var I=C.target?C.target:C.srcElement;if(fa||I&&I===ea){if(C.detail){I=-C.detail*n;I=o(C.axis===1?I:0,C.axis===2?I:0)}else I=o(C.wheelDeltaX,C.wheelDeltaY);var L=I.y!==0?Math.abs(I.y/n):0;if(ca&&L!==0){var Z=o(ca.x-ea.offsetLeft,ca.y-ea.offsetTop);F("wheelZoom",Z,Math.pow(2,I.y>0?L:-L))}f(C)}}s=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,
pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},s);var ha=false,sa=0,ba=T5.getConfig(),U=e(),V=e(),qa=e(),ma=e(),aa=null,ga=o(),ia=o(),da=null,pa=false,Q=0,ra=[],ca=o(),na=false,ka,ta,ua=0,va=0,ea=s.element,oa=s.observable,fa=typeof FlashCanvas!=="undefined",xa={supportsTouch:H,addListeners:function(C){ra.push(C)},decoupleListeners:function(C){for(var I=0;C&&I<ra.length;I++)if(ra[I].listenerId===C){ra.splice(I,1);break}},release:function(){ba.unbindEvent(H?"touchstart":
"mousedown",K,false);ba.unbindEvent(H?"touchmove":"mousemove",S,false);ba.unbindEvent(H?"touchend":"mouseup",la,false);if(!H){window.removeEventListener("mousewheel",X,false);window.removeEventListener("DOMMouseScroll",X,false)}},inertiaEnable:function(C,I){na=true;ka=C;ta=I?Math.min(I.width,I.height):500},inertiaDisable:function(){na=false}};if(typeof H==="undefined")H=T5.getConfig().supportsTouch;ba.bindEvent(H?"touchstart":"mousedown",K,false);ba.bindEvent(H?"touchmove":"mousemove",S,false);ba.bindEvent(H?
"touchend":"mouseup",la,false);if(!H){ba.bindEvent("mousewheel",X,window);ba.bindEvent("DOMMouseScroll",X,window)}return xa},N=[];return{capture:function(s,q){if(!s)throw Error("Unable to capture touch of null element");if(!s.id)s.id="touchable_"+z++;var r=N[s.id];if(!r){r=new M(COG.extend({element:s},q));N[s.id]=r}if(q){q.listenerId&&r.decoupleListeners(q.listenerId);q.listenerId=++R;r.addListeners(q)}return r},release:function(s){if(s&&s.id&&N[s.id]){N[s.id].release();delete N[s.id]}}}}();
T5=function(){var k=function(){function a(b,o){return f(b.x-o.x,b.y-o.y)}function e(b,o){if(!o)o=b.length;if(o<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var g={edges:Array(o-1),accrued:Array(o-1),total:0},n=0;n<o-1;n++){var h=a(b[n],b[n+1]);g.edges[n]=Math.sqrt(h.x*h.x+h.y*h.y);g.accrued[n]=g.total+g.edges[n];g.total+=g.edges[n]}return g}function f(b,o){return{x:b?b:0,y:o?o:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,o=0,g=arguments.length;g--;){b+=arguments[g].x;o+=arguments[g].y}return f(b,o)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?f(b.x,b.y):null},diff:a,distance:function(b,o){return e(b,o).total},edges:e,equals:function(b,o){return b.x===o.x&&b.y===o.y},extendBy:function(b,o,g){return f(b.x-Math.cos(o)*g,b.y-Math.sin(o)*g)},floor:function(b){for(var o=Array(b.length),g=b.length;g--;)o[g]=f(~~b[g].x,~~b[g].y);return o},getRect:function(b){for(var o,g,n,
h,p=b.length;p--;){var v=b[p];o=typeof o==="undefined"||v.x<o?v.x:o;g=typeof g==="undefined"||v.y<g?v.y:g;n=typeof n==="undefined"||v.x>n?v.x:n;h=typeof h==="undefined"||v.y>h?v.y:h}return l.init(o,g,h,h)},init:f,invert:function(b){return f(-b.x,-b.y)},min:function(b,o){return f(b.x<o.x?b.x:o.x,b.y<o.y?b.y:o.y)},max:function(b,o){return f(b.x>o.x?b.x:o.x,b.y>o.y?b.y:o.y)},offset:function(b,o,g){return f(b.x+o,b.y+(g?g:o))},simplify:function(b,o){if(!b)return null;o=o?o:k.VECTOR_SIMPLIFICATION;for(var g=
[],n=null,h=b.length;h--;){var p=b[h];if(include=!n||h===0||Math.abs(p.x-n.x)+Math.abs(p.y-n.y)>o){g.unshift(p);n=p}}return g},theta:function(b,o,g){g=Math.asin((b.y-o.y)/g);return b.x>o.x?g:Math.PI-g}}}(),m=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),l=function(){function a(f){return e(f.x1,f.y1,f.x2,f.y2)}function e(f,b,o,g){f=f?f:0;b=b?b:0;o=typeof o!=="undefined"?o:f;g=typeof g!=="undefined "?g:g;return{x1:f,y1:b,x2:o,y2:g,width:o-f,height:g-b}}return{center:function(f){return k.init(f.x1+
f.width/2,f.y1+f.height/2)},copy:a,diagonalSize:function(f){return Math.sqrt(f.width*f.width+f.height*f.height)},fromCenter:function(f,b,o,g){o=~~(o/2);g=~~(g/2);return e(f-o,b-g,f+o,b+g)},init:e,intersect:function(f,b){var o=e(Math.max(f.x1,b.x1),Math.max(f.y1,b.y1),Math.min(f.x2,b.x2),Math.min(f.y2,b.y2));return o.width>0&&o.height>0?o:null},union:function(f,b){if(f.width===0||f.height===0)return a(b);else if(b.width===0||b.height===0)return a(f);else{var o=e(Math.min(f.x1,b.x1),Math.min(f.y1,b.y1),
Math.max(f.x2,b.x2),Math.max(f.y2,b.y2));return o.width>0&&o.height>0?o:null}}}}(),d=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return k.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,height:e?e:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:k,XYRect:l,Vector:function(a,e){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return k.init(a,e)},V:COG.extend(k,m),D:d}}();
(function(){function k(){for(;y.length>0;){var u=y.shift();document.location=u}v=0}function m(u){for(var t=true,E=x.length;E--;)t=t&&u!=x[E];return t}function l(u,t){var E=[];for(var z in t)z&&E.push(z+"="+escape(t[z]));return"tile5://"+u+"/"+(E.length>0?"?"+E.join("&"):"")}function d(u,t){m(u)&&COG.Log.info("would push url: "+l(u,t))}function a(u,t){if(m(u)){y.push(l(u,t));v||(v=setTimeout(k,100))}}function e(u){return function(t,E,z){(z?z:u?document.body:document).addEventListener(t,E,false)}}function f(u){return function(t,
E,z){(z?z:u?document.body:document).removeEventListener(t,E,false)}}function b(u,t,E){(E?E:document).attachEvent("on"+u,t)}function o(u,t,E){(E?E:document).detachEvent("on"+u,t)}function g(){n={base:{name:"Unknown",bindEvent:e(),unbindEvent:f(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:d,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:o,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:e(true),unbindEvent:f(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};h=[n.froyo,n.android,n.ipod,n.iphone,n.ipad,n.ie]}var n=null,h=[],p=null,v=0,y=[],x=["view.wake","tile.loaded"];T5.getConfig=function(){n||g();if(!p){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var u=0;u<h.length;u++){var t=h[u];if(t.regex&&t.regex.test(navigator.userAgent)){p=T5.ex({},n.base,t);COG.Log.info("PLATFORM DETECTED AS: "+p.name);break}}if(!p){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
p=n.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return p}})();
T5.Dispatcher=function(){var k=[],m={execute:function(l){var d=m.findAction(l);d&&d.execute.apply(d,Array.prototype.slice.call(arguments,1))},findAction:function(l){for(var d=k.length;d--;)if(k[d].id==l)return k[d];return null},getRegisteredActions:function(){return[].concat(k)},getRegisteredActionIds:function(){for(var l=[],d=k.length;d--;)k[d].id&&l.push(k[d].id);return l},registerAction:function(l){l&&l.id&&k.push(l)},Action:function(l){l=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},l);var d={id:l.id,execute:function(){l.execute&&l.execute.apply(this,arguments)},getParam:function(a){return l[a]?l[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",d.id,l.title,l.icon)}};l.autoRegister&&m.registerAction(d);return d},Agent:function(l){l=COG.extend({name:"Untitled",translator:null,execute:null},l);var d={getName:function(){return l.name},getParam:function(a){return l[a]},getId:function(){return COG.toID(d.getName())},run:function(a,e){if(l.execute){var f=
l.translator?l.translator(a):a;l.execute.call(d,f,function(b,o){e&&e(b,o,f)})}}};return d},runAgents:function(l,d,a){for(var e=0;e<l.length;e++)l[e].run(d,a)}};return m}();
T5.Resources=function(){var k="",m={},l={getPath:function(d){return/^(file|https?|\/)/.test(d)?d:k+d},setBasePath:function(d){k=d},loadResource:function(d){d=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},d);var a=function(e){d.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){d.callback(e)})};d.cacheable&&m[d.filename]?a(m[d.filename]):COG.xhr({url:l.getPath(d.filename),dataType:d.dataType,success:function(e){if(d.cacheable)m[d.filename]=e;a(e)},error:function(e,f,b){COG.Log.error("error loading resource ["+
d.filename+"], error = "+b)}})},loadSnippet:function(d,a){/\.\w+$/.test(d)||(d+=".html");l.loadResource({filename:"snippets/"+d,callback:a,dataType:"html"})}};return l}();
T5.Images=function(){function k(){if(!v){var u=T5.getConfig().maxImageLoads;v=COG.Loopage.join({execute:function(t,E){if(!u||n.length<u){var z=g.shift();if(z){n[n.length]=z;z.image.onload=l;z.image.src=T5.Resources.getPath(z.url);z.requested=T5.ticks()}else E.trigger("complete")}},frequency:10});v.bind("complete",function(){v=null})}}function m(){y=true;try{var u=h.length/2>>0;if(u>0){h.sort(function(E,z){return E.created-z.created});for(var t=u;t--;)delete e[h[t].url];h.splice(0,u)}}finally{y=false}COG.say("imagecache.cleared")}
function l(){var u=b[this.id],t;if(u&&u.image.complete&&u.image.width>0){u.loaded=true;u.hitCount=1;for(t=n.length;t--;)if(n[t].image.src==this.src){n.splice(t,1);break}if(u.background||u.postProcess||u.drawBackground||u.customDraw)if(u.image){globalImageData=u;t=a(u.realSize?u.realSize.width:u.image.width,u.realSize?u.realSize.height:u.image.height);var E=t.getContext("2d"),z=u.offset?u.offset:T5.XY.init();u.background&&E.drawImage(u.background,0,0);u.drawBackground&&u.drawBackground(E);u.customDraw?
u.customDraw(E,u):E.drawImage(u.image,z.x,z.y);u.postProcess&&u.postProcess(E,u);u.image=t}for(t=u.callbacks.length;t--;)u.callbacks[t]&&u.callbacks[t](this,false);u.callbacks=[];h[h.length]={url:this.src,created:u.requested};delete b[this.id];k()}}function d(u,t,E){var z=e[u];if(z){z.hitCount++;z.image.complete&&z.image.width>0&&t?t(z.image,true):z.callbacks.push(t)}else{z=T5.ex({url:u,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[t]},E);z.image.id="resourceLoaderImage"+
o++;e[u]=z;b[z.image.id]=z;g[g.length]=z;k()}return z}function a(u,t){var E=document.createElement("canvas");E.width=u?u:0;E.height=t?t:0;if(typeof FlashCanvas!=="undefined"){E.id="tmpCanvas"+f++;E.style.cssText="position: absolute; top: -"+(t-1)+"px; left: -"+(u-1)+"px;";document.body.appendChild(E);FlashCanvas.initElement(E)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(E);return E}var e={},f=0,b={},o=0,g=[],n=[],h=[],p=0,v=null,y=false,x={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){n=[]},get:function(u,t,E){var z=null,R=null;y||(z=e[u]);if((R=z?z.image:null)&&(R.getContext||R.complete&&R.width>0))return R;else t&&d(u,t,E);return null},load:d,newCanvas:a,reset:function(){e={}},stats:function(){return{imageLoadingCount:n.length,queuedImageCount:g.length,imageCacheFullness:p}}};COG.Loopage.join({execute:function(u){for(var t=false,E=0,z=T5.getConfig();E<n.length;)if(u-n[E].requested>x.loadTimeout*1E3){n.splice(E,1);t=true}else E++;t&&k();if(z&&z.imageCacheMaxSize){p=
h.length*x.avgImageSize/z.imageCacheMaxSize;p>=1&&m()}},frequency:2E4});return x}();T5.Generator=function(){var k={};return{init:function(m,l){var d=k[m];if(!d)throw Error("Unable to locate requested generator: "+m);return new d(l)},register:function(m,l){k[m]=l},Template:function(){}}}();
T5.TimeLord=function(){var k=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,l=function(a,e){return{days:a?a:0,seconds:e?e:0}},d={8601:function(a){a=a.split("T");var e=null;e=null;var f=0,b=0;k.lastIndex=-1;e=k.exec(a[0]);f+=e[3]?parseInt(e[3].slice(0,-1),10):0;m.lastIndex=-1;e=m.exec(a[1]);b+=e[1]?parseInt(e[1].slice(0,-1),10)*3600:0;b+=e[2]?parseInt(e[2].slice(0,-1),10)*60:0;b+=e[3]?parseInt(e[3].slice(0,-1),10):0;return new l(f,b)}};return{Duration:l,addDuration:function(){for(var a=new l,
e=arguments.length;e--;){a.days+=arguments[e].days;a.seconds+=arguments[e].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,e){var f=e?d[e]:null;if(f)return f(a);COG.Log.warn("Could not find duration parser for specified format: "+e);return new l},formatDuration:function(a){var e,f,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){e=~~(a/3600);a-=e*3600}if(a>=60){f=Math.round(a/60);a-=f*60}if(e)b=b+e+(e>1?" hrs ":" hr ")+
(f?(f>10?f:"0"+f)+" min ":"");else if(f)b=b+f+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
T5.zoomable=function(k,m){function l(a,e){if(a&&d!==a){d=a;k.triggerAll("zoomLevelChange",d,e)}}m=T5.ex({initial:0,min:0,max:null,zoomAnimation:T5.easing("quad.out")},m);var d=m.initial;T5.ex(k,{getZoomLevel:function(){return d},setZoomLevel:l,zoomIn:function(){k.scale(2,T5.easing("sine.out"))||k.setZoomLevel(d+1)},zoomOut:function(){k.scale(0.5,T5.easing("sine.out"))||k.setZoomLevel(d-1)}});k.bind("scale",function(a,e,f){a=0;e=Math.sqrt(e);if(e<1)a=-(0.5/e);else if(e>1)a=e;T5.cancelAnimation();l(d+
a>>0,f)});k.bind("doubleTap",function(a,e,f){if(k.scalable()){T5.cancelAnimation();k.animate(2,T5.D.getCenter(k.getDimensions()),T5.XY.init(f.x,f.y),m.zoomAnimation)}})};
(function(){var k=Math.PI*2,m=Math.PI/2,l=Math.abs,d=Math.pow,a=Math.sin,e=Math.asin,f=Math.cos,b=1.70158,o={linear:function(g,n,h,p){return h*g/p+n},backin:function(g,n,h,p){return h*(g/=p)*g*((b+1)*g-b)+n},backout:function(g,n,h,p){return h*((g=g/p-1)*g*((b+1)*g+b)+1)+n},backinout:function(g,n,h,p){return(g/=p/2)<1?h/2*g*g*(((b*=1.525)+1)*g-b)+n:h/2*((g-=2)*g*(((b*=1.525)+1)*g+b)+2)+n},bouncein:function(g,n,h,p){return h-o.bounceout(p-g,0,h,p)+n},bounceout:function(g,n,h,p){return(g/=p)<1/2.75?
h*7.5625*g*g+n:g<2/2.75?h*(7.5625*(g-=1.5/2.75)*g+0.75)+n:g<2.5/2.75?h*(7.5625*(g-=2.25/2.75)*g+0.9375)+n:h*(7.5625*(g-=2.625/2.75)*g+0.984375)+n},bounceinout:function(g,n,h,p){return g<p/2?o.bouncein(g*2,0,h,p)/2+n:o.bounceout(g*2-p,0,h,p)/2+h/2+n},cubicin:function(g,n,h,p){return h*(g/=p)*g*g+n},cubicout:function(g,n,h,p){return h*((g=g/p-1)*g*g+1)+n},cubicinout:function(g,n,h,p){if((g/=p/2)<1)return h/2*g*g*g+n;return h/2*((g-=2)*g*g+2)+n},elasticin:function(g,n,h,p,v,y){if(g==0)return n;if((g/=
p)==1)return n+h;y||(y=p*0.3);if(!v||v<l(h)){v=h;h=y/4}else h=y/k*e(h/v);return-(v*d(2,10*(g-=1))*a((g*p-h)*k/y))+n},elasticout:function(g,n,h,p,v,y){var x;if(g==0)return n;if((g/=p)==1)return n+h;y||(y=p*0.3);if(!v||v<l(h)){v=h;x=y/4}else x=y/k*e(h/v);return v*d(2,-10*g)*a((g*p-x)*k/y)+h+n},elasticinout:function(g,n,h,p,v,y){var x;if(g==0)return n;if((g/=p/2)==2)return n+h;y||(y=p*0.3*1.5);if(!v||v<l(h)){v=h;x=y/4}else x=y/k*e(h/v);if(g<1)return-0.5*v*d(2,10*(g-=1))*a((g*p-x)*k/y)+n;return v*d(2,
-10*(g-=1))*a((g*p-x)*k/y)*0.5+h+n},quadin:function(g,n,h,p){return h*(g/=p)*g+n},quadout:function(g,n,h,p){return-h*(g/=p)*(g-2)+n},quadinout:function(g,n,h,p){if((g/=p/2)<1)return h/2*g*g+n;return-h/2*(--g*(g-2)-1)+n},sinein:function(g,n,h,p){return-h*f(g/p*m)+h+n},sineout:function(g,n,h,p){return h*a(g/p*m)+n},sineinout:function(g,n,h,p){return-h/2*(f(Math.PI*g/p)-1)+n}};T5.easing=function(g){return o[g.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(g,n){o[g.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=n}})();
T5.Tween=function(k){k=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},k);var m=T5.ticks(),l=[],d=false,a=0,e=0,f={cancelOnInteract:k.cancelOnInteract,isComplete:function(){return d},triggerComplete:function(b){k.complete&&k.complete(b)},update:function(b){try{var o=k.tweenFn(b-m,a,e,k.duration);if(k.target)k.target[k.property]=o;for(var g=l.length;g--;)l[g](o,void 0);if(d=m+k.duration<=b){if(k.target)k.target[k.property]=
k.tweenFn(k.duration,a,e,k.duration);for(var n=l.length;n--;)l[n](o,true)}}catch(h){COG.Log.exception(h)}},requestUpdates:function(b){l.push(b)}};a=k.target&&k.property&&k.target[k.property]?k.target[k.property]:k.startValue;if(typeof k.endValue!=="undefined")e=k.endValue-a;if(e==0)d=true;T5.wakeTweens();return f};
(function(){function k(a){if(d)return m.length;d=true;try{for(var e=0;e<m.length;)if(m[e].isComplete()){m[e].triggerComplete(false);m.splice(e,1)}else{m[e].update(a);e++}}finally{d=false}m.length===0&&l.trigger("complete");return m.length}var m=[],l=null,d=false;T5.tweenValue=function(a,e,f,b,o){a=new T5.Tween({startValue:a,endValue:e,tweenFn:f,complete:b,duration:o});m.push(a);return a};T5.tween=function(a,e,f,b,o,g){a=new T5.Tween({target:a,property:e,endValue:f,tweenFn:b,duration:g,complete:o});
m.push(a);return a};T5.tweenVector=function(a,e,f,b,o,g){var n=[];if(a){var h=a.x==e,p=a.y==f;h||n.push(T5.tween(a,"x",e,b,function(){(h=true)&&p&&o()},g));p||n.push(T5.tween(a,"y",f,b,function(){p=true;h&&p&&o()},g))}return n};T5.cancelAnimation=function(a){if(!d){d=true;try{for(var e=0;e<m.length;)if(!a||a(m[e])){m[e].triggerComplete(true);m.splice(e,1)}else e++}finally{d=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!l){l=COG.Loopage.join({execute:k,frequency:20});
l.bind("complete",function(){l=null})}}})();(function(){var k={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,l=arguments.length;l--;){var d=k[arguments[l].toUpperCase()];if(d)m|=d}return m}})();
T5.ViewLayer=function(k){k=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},k);var m=null,l=false,d=false,a=k.supportFastDraw,e=k.id,f=T5.viewState("ACTIVE"),b=k.validStates,o=0,g=0,n=T5.ex({addToView:function(h){h.setLayer(e,n)},shouldDraw:function(h,p,v){return(d||v||o!==p.x1||g!==p.y1)&&(h&b)!==0&&(l?a:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){n.trigger("remove",
n)},changed:function(h){d=true;n.trigger("changed",n);m&&m.trigger("invalidate",h)},getId:function(){return e},setId:function(h){e=h},getParent:function(){return m},setParent:function(h){l=(m=h)?m.fastDraw&&displayState!==f:false;n.trigger("parentChange",m)}},k);COG.observable(n);n.bind("drawComplete",function(h,p){d=false;o=p.x1;g=p.y1});n.bind("resync",function(h,p){if(p.syncXY){n.minXY&&p.syncXY(n.minXY);n.maxXY&&p.syncXY(n.maxXY)}});return n};
T5.View=function(k){function m(A,D,J,P){C=oa;t();if(P&&k.inertia){X=true;g(N+D,s+J,k.panAnimationEasing,k.panAnimationDuration)}else P||g(N+D,s+J)}function l(){C=ea;X=false;COG.Loopage.join({execute:t,after:50,single:true})}function d(A,D){aa=I(A);ga=I(D);var J=L(aa),P=L(ga);ka=Z(aa);S=Z(ga);Q=aa&&J!==0?P/J:1}function a(A,D,J){d(D,J);if(ma=Q!==1){C=fa;t()}}function e(A,D,J,P){d(D,J);if(k.adjustScaleFactor){Q=k.adjustScaleFactor(Q);COG.Log.info("scale factor adjusted to: "+Q)}if(P<k.pinchZoomAnimateTrigger){p(ca,
Q,ka,v(),T5.easing("sine.out"),function(){b();Q=1},300);Q=ca}else{b();Q=1}}function f(A,D,J){O.zoom(D,Math.min(Math.pow(2,Math.round(Math.log(J))),8),500)}function b(){var A=aa?v():S;Q=Math.round(Q*10)/10;ma=false;for(var D=z.length;D--;)z[D].trigger("scale",Q,A);O.trigger("scale",Q,A);C=ea;t()}function o(){clearTimeout(pa);pa=setTimeout(n,50)}function g(A,D,J,P,T){function W(){$+=1;if($>=2){l(0,0);T&&T()}}var $=0;if(U){A=A<U.x?U.x:A;D=D<U.y?U.y:D}if(V){A=A>V.x?V.x:A;D=D>V.y?V.y:D}if(J){A=T5.tweenValue(N,
A,J,W,P);D=T5.tweenValue(s,D,J,W,P);A.cancelOnInteract=true;A.requestUpdates(function(Y){N=Y;X=true;t()});D.cancelOnInteract=true;D.requestUpdates(function(Y){s=Y;X=true;t()})}else{N=A;s=D}}function n(){var A;if(H){COG.Touch.release(H);if(k.autoSize&&H.parentNode){A=H.parentNode.getBoundingClientRect();if(A.height!==0&&A.width!==0){H.height=A.height;H.width=A.width}}try{if(!H.id)H.id=k.id+"_canvas";M=H.getContext("2d")}catch(D){COG.Log.exception(D);throw Error("Could not initialise canvas on specified view element");
}va=COG.Touch.capture(H,{observable:O});if(G.height!==H.height||G.width!==H.width){G=T5.D.init(H.width,H.height);O.trigger("resize",H.width,H.height);for(A=R;A--;)z[A].trigger("resize",H.width,H.height)}k.inertia&&va.inertiaEnable(k.panAnimationDuration,G);for(A=R;A--;)z[A].trigger("contextChanged",M);t()}}function h(A,D){D.setId(A);D.added=T5.ticks();D.bind("remove",function(){O.removeLayer(A)});D.trigger("contextChanged",M);D.setParent(O);z.push(D);z.sort(function(J,P){var T=P.zindex-J.zindex;if(T===
0)T=P.added-J.added;return T});R=z.length;return D}function p(A,D,J,P,T,W,$){function Y(){W&&W();b();Q=1;na=null}ma=true;ka=T5.XY.offset(J,r.x1,r.y1);S=T5.XY.offset(P,r.x1,r.y1);aa=null;if(T)T5.tweenValue(0,D-A,T,Y,$?$:1E3).requestUpdates(function(ja){na=ja/(D-A);Q=A+ja;C=fa;t();O.trigger("animate")});else{Q=D;Y()}}function v(){var A=T5.D.getCenter(G),D=T5.XY.distance([S,A]);A=T5.XY.theta(S,A,D);var J=T5.XY.diff(ka,S);A=T5.XY.extendBy(S,A,D/Q);A.x+=J.x;A.y+=J.y;return A}function y(){E("idle",O);la=
true;ha=0}function x(A,D,J,P){var T=false,W=(A&fa)!==0,$=T5.XYRect.copy(D),Y,ja=0;J&&M.clearRect(0,0,H.width,H.height);if(W){T5.D.getCenter(G);var wa=(na?na:1)/2,ya=T5.XY.diff(ka,S);if(aa){ba.x=S.x+ya.x;ba.y=S.y+ya.y}else{ba.x=S.x-ya.x*wa;ba.y=S.y-ya.y*wa}}M.save();try{ca=Q;M.globalCompositeOperation="source-over";if(W){W=1/Q;wa=(W-0.5)/0.5;$=T5.XYRect.fromCenter(S.x-(S.x-N)*wa,S.y-(S.y-s)*wa,~~($.width*W),~~($.height*W));M.scale(Q,Q)}M.translate(-$.x1,-$.y1);V=U=null;M.beginPath();for(ja=R;ja--;)if(z[ja].clip){z[ja].clip(M,
$,A,O,J,P);T=true}M.closePath();T&&M.clip();for(ja=R;ja--;){Y=z[ja];var za=Y.style,Aa=za?T5.Style.apply(M,za):null;if(Y.minXY)U=U?T5.XY.min(U,Y.minXY):T5.XY.copy(Y.minXY);if(Y.maxXY)V=V?T5.XY.max(V,Y.maxXY):T5.XY.copy(Y.maxXY);Y.draw(M,$,A,O,J,P);Aa&&T5.Style.apply(M,Aa);Y.trigger("drawComplete",$,P)}}finally{M.restore()}if(B){M.globalCompositeOperation="source-over";M.strokeStyle="#f00";M.beginPath();M.moveTo(H.width/2,0);M.lineTo(H.width/2,H.height);M.moveTo(0,H.height/2);M.lineTo(H.width,H.height/
2);M.stroke()}O.trigger("drawComplete",D,P);COG.Log.trace("draw complete",P)}function u(A,D){var J=false,P=ia?ia:X?oa:C,T=!X&&(P===fa||P===oa),W=da||P===oa||P===fa||T5.isTweening();q=T5.XY.init(N>>0,s>>0);r=T5.XYRect.fromCenter(q.x,q.y,G.width,G.height);if(T){T5.cancelAnimation(function($){return $.cancelOnInteract});la=false;if(ha!==0){clearTimeout(ha);ha=0}}for(T=R;T--;){if(z[T].animated)C|=xa;z[T].cycle(A,r,C,W);J=z[T].shouldDraw(C,r,W)||J}W=W||(C&xa)!==0;if(J=J||W||Q!==1&&Q!==ra){x(P,r,W,A);ra=
Q;da=false}if(!J&&K===0&&!ta){if(!la&&ha===0)ha=setTimeout(y,500);D.trigger("complete")}K=0;COG.Log.trace("Completed draw cycle",A)}function t(A){da=A?true:false;K+=1;if(!w){w=COG.Loopage.join({execute:u,frequency:ua});w.bind("complete",function(){w=null})}}function E(){O.trigger.apply(null,arguments);for(var A=z.length;A--;)z[A].trigger.apply(null,arguments)}k=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),
panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},k);var z=[],R=0,H=document.getElementById(k.container),M=null,N=0,s=0,q=null,r=null,w=null,B=k.guides,F=1,G=T5.D.init(),K=0,S=null,la=false,X=false,ha=0,sa=0,ba=T5.XY.init(),U=null,V=null,qa=0,ma=false,aa=null,ga=null,ia=null,da=false,pa=0,Q=1,ra=0,ca=1,na=null,ka=null,ta=typeof FlashCanvas!=="undefined",ua=~~(1E3/k.fps),va=null,ea=T5.viewState("ACTIVE"),oa=T5.viewState("PAN"),
fa=T5.viewState("ZOOM"),xa=T5.viewState("ANIMATING"),C=ea,I=T5.XY.getRect,L=T5.XYRect.diagonalSize,Z=T5.XYRect.center,O={id:k.id,deviceScaling:F,fastDraw:k.fastDraw||T5.getConfig().requireFastDraw,animate:function(A,D,J,P,T){p(Q,A,D,J,P,T)},centerOn:function(A){N=A.x-H.width/2;s=A.y-H.height/2},getDimensions:function(){return G},getZoomCenter:function(){return ba},getLayer:function(A){for(var D=0;D<R;D++)if(z[D].getId()==A)return z[D];return null},setLayer:function(A,D){for(var J=0;J<R;J++)if(z[J].getId()===
A){z.splice(J,1);break}D&&h(A,D);t();return D},eachLayer:function(A){for(var D=R;D--;)A(z[D])},invalidate:t,resize:function(A,D){if(H){k.autoSize=false;H.width=A;H.height=D;n();O.trigger("resize",H.width,H.height)}},scale:function(A,D,J,P,T){P||(P=T5.D.getCenter(G));T||(T=T5.D.getCenter(G));O.animate(A,P,T,D,J);return O},triggerAll:E,removeLayer:function(A){a:{for(var D=R;D--;)if(z[D].getId()==A){A=D;break a}A=-1}if(A>=0&&A<R){COG.say("layer.removed",{layer:z[A]});z.splice(A,1);t()}R=z.length},stateOverride:function(A){ia=
A},getOffset:function(){return q?q:T5.XY.init(N,s)},getViewRect:function(){return r?r:T5.XYRect.fromCenter(N,s,G.width,G.height)},updateOffset:g,pan:function(A,D,J,P,T){g(N+A,s+D,J,P,T)},zoom:function(A,D,J){X=false;Q=D;ma=Q!==1;ka=T5.D.getCenter(G);S=T5.XY.offset(Q>1?T5.XY.copy(A):T5.D.getCenter(G),r.x1,r.y1);aa=null;clearTimeout(sa);if(ma){C=fa;t();if(J)sa=setTimeout(function(){b();Q=1},parseInt(J,10))}}};F=T5.getConfig().getScaling();O.markers=h("markers",new T5.MarkerLayer);COG.observable(O);
O.bind("invalidate",function(A,D){t(D)});if(k.pannable){O.bind("pan",m);O.bind("panEnd",l);O.bind("inertiaCancel",function(){X=false;t()})}if(k.scalable){O.bind("pinchZoom",a);O.bind("pinchZoomEnd",e);O.bind("wheelZoom",f)}O.bind("tap",function(A,D,J){for(var P=T5.XY.offset(J,N,s),T=z.length;T--;)A.cancel=A.cancel||z[T].trigger("tap",D,J,P).cancel});O.bind("resync",function(){V=U=null});COG.configurable(O,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(k,null,
{container:function(A,D){H=document.getElementById(D);n()},rotation:function(A,D){qa=D}}),true);n();k.autoSize&&window.addEventListener("resize",o,false);return O};
T5.PathLayer=function(k){k=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},k);var m=false,l=[],d=null,a=[],e=null,f=0,b=[],o=T5.ex(new T5.ViewLayer(k),{getAnimation:function(g,n,h,p){var v="pathAnimation"+f++;b.push(v);return new T5.AnimatedPathLayer({id:v,path:l,zindex:k.zindex+1,easing:g?g:T5.easing("sine.inout"),duration:n?n:5E3,drawIndicator:h,autoCenter:p?p:false})},cycle:function(g,n,h,p){return p},draw:function(g){var n,h=l.length;g.save();try{T5.Style.apply(g,k.style);if(h>0){g.beginPath();
g.moveTo(l[h-1].x,l[h-1].y);for(n=h;n--;)g.lineTo(l[n].x,l[n].y);g.stroke();if(d){g.fillStyle=k.waypointFillStyle;for(n=d.length;n--;){g.beginPath();g.arc(d[n].x,d[n].y,2,0,Math.PI*2,false);g.stroke();g.fill()}}}}finally{g.restore()}m=false},updateCoordinates:function(g,n){a=g;e=n;var h=o.getParent();if(h&&h.syncXY){h.syncXY(a);e&&h.syncXY(e);o.trigger("tidy")}}});o.bind("tidy",function(){l=T5.XY.simplify(a,k.pixelGeneralization);d=T5.XY.simplify(e,k.pixelGeneralization);m=true;o.changed()});return o};
T5.ShapeLayer=function(k){function m(e){for(var f=d.length;f--;)d[f].resync(e);d.sort(function(b,o){var g=o.xy.y-b.xy.y;if(g===0)g=o.xy.x-b.xy.y;return g});a.changed()}function l(e,f){f.syncXY&&m(f)}k=T5.ex({zindex:80},k);var d=[],a=T5.ex(new T5.ViewLayer(k),{add:function(e){d[d.length]=e},each:function(e){for(var f=d.length;f--;)e(d[f])},draw:function(e,f,b){var o=f.x1,g=f.y1,n=f.width;f=f.height;for(var h=d.length;h--;){var p=d[h].style;p=p?T5.Style.apply(e,p):null;d[h].draw(e,o,g,n,f,b);p&&T5.Style.apply(e,
p)}}});a.bind("parentChange",l);a.bind("resync",l);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(k){k=T5.ex({style:null,properties:{}},k);return T5.ex(k,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(k,m){m=T5.ex({size:4},m);var l=T5.XY.init(),d=T5.ex(m,{draw:function(a){a.beginPath();a.arc(l.x,l.y,d.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([k]);l=T5.XY.floor([k])[0]}});COG.Log.info("created arc = ",k);return d};
T5.Poly=function(k,m){m=T5.ex({fill:false,simplify:false},m);var l=false,d=m.fill,a=m.simplify,e=T5.viewState("ZOOM"),f=[],b=T5.ex(new T5.Shape(m),{draw:function(o,g,n,h,p,v){if(l){g=true;n=(v&e)!==0;o.beginPath();for(v=f.length;v--;){n=f[v].x;h=f[v].y;if(g){o.moveTo(n,h);g=false}else o.lineTo(n,h);n=true}if(n){d&&o.fill();o.stroke()}}},resync:function(o){b.xy=o.syncXY(k);f=T5.XY.floor(a?T5.XY.simplify(k):k)}});l=k&&k.length>=2;return b};
T5.AnimatedPathLayer=function(k){function m(b,o,g){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(g.x,g.y,4,0,Math.PI*2,false);b.stroke();b.fill()}k=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},k);var l=T5.XY.edges(k.path),d,a=null,e=0;T5.tweenValue(0,l.total,k.easing,function(){f.remove()},k.duration).requestUpdates(function(b,o){e=b;o&&f.remove()});var f=
T5.ex(new T5.ViewLayer(k),{cycle:function(){for(var b=0;b<l.accrued.length&&l.accrued[b]<e;)b++;a=null;if(b<k.path.length-1){var o=e-(b>0?l.accrued[b-1]:0),g=k.path[b];d=T5.XY.theta(g,k.path[b+1],l.edges[b]);a=T5.XY.extendBy(g,d,o);if(k.autoCenter)(b=f.getParent())&&b.centerOn(a)}return a},draw:function(b,o){if(a)(k.drawIndicator?k.drawIndicator:m)(b,o,T5.XY.init(a.x,a.y),d)}});return f};
T5.Marker=function(k){function m(o,g,n,h){d=o;a=g;e=n;f=h}k=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},k);var l=false,d=0,a=0,e=0,f=0,b=T5.ex(k,{isNew:true,isAnimating:function(){return l},draw:function(o,g,n,h,p){if(b.isNew&&k.tweenIn){var v=b.xy.y;b.xy.y=g.y1-20;l=true;T5.tween(b.xy,"y",v,k.tweenIn,function(){b.xy.y=v;l=false},k.animationSpeed?k.animationSpeed:250+Math.random()*500)}b.drawMarker(o,g,b.xy.x,b.xy.y,n,h,p);b.isNew=false},drawMarker:function(o,g,n,h){o.beginPath();
o.arc(n,h,4,0,Math.PI*2,false);o.fill();m(n-4,h-4,8,8)},hitTest:function(o,g){return o>=d&&o<=d+e&&g>=a&&g<=a+f},updateBounds:m});COG.observable(b);return b};
T5.ImageMarker=function(k){k=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},k);var m=k.imageAnchor?T5.XY.invert(k.imageAnchor):null,l=T5.ex(new T5.Marker(k),{drawMarker:function(d,a,e,f){if((a=l.isAnimating()&&l.animatingImage?l.animatingImage:l.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var b=l.scale,o=e+~~(m.x*b),g=f+~~(m.y*b),n=~~(a.width*b),h=~~(a.height*b);l.updateBounds(o,g,n,n);if(l.rotation||
l.opacity!==1){d.save();try{d.globalAlpha=l.opacity;d.translate(e,f);d.rotate(l.rotation);d.drawImage(a,m.x*b,m.y*b,n,h)}finally{d.restore()}}else d.drawImage(a,o,g,n,h)}}});if(!l.image)l.image=T5.Images.get(k.imageUrl,function(d){COG.Log.info("updating marker image to: "+d.src);l.image=d});if(!l.animatingImage)l.animatingImage=T5.Images.get(k.animatingImageUrl,function(d){l.animatingImage=d});return l};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(k){function m(){a.changed();a.trigger("markerUpdate",d)}function l(){var e=a.getParent();if(e&&e.syncXY)for(var f=d.length;f--;)e.syncXY([d[f].xy])}k=T5.ex({zindex:100,style:"basic"},k);var d=[],a=T5.ex(new T5.ViewLayer(k),{draw:function(e,f,b,o){for(var g=d.length;g--;)d[g].draw(e,f,b,a,o)},add:function(e){if(e&&typeof e.length!=="undefined")for(var f=e.length;f--;){if(e[f])d[d.length]=e[f]}else if(e)d[d.length]=e;m()},clear:function(e){if(e)for(var f=0;f<d.length;f++)e(d[f])&&
d.splice(f,1);else d=[];m()},find:function(e){for(var f=[],b=d.length;b--;)if(!e||e(d[b]))f[f.length]=d[b];return f}});a.bind("tap",function(e,f,b){for(var o=[],g=b.x,n=b.y,h=d.length;h--;)if(d[h].hitTest(g,n))o[o.length]=d[h];if(o.length>0)e.cancel=a.trigger("markerTap",f,b,o).cancel});a.bind("parentChange",l);a.bind("resync",l);a.bind("changed",l);return a};
T5.ImageLayer=function(k,m){function l(h,p,v){if(f)for(var y=f.length;y--;){var x=f[y],u=x.x,t=x.y,E=T5.XYRect.init(x.x,x.y,x.x+x.width,x.y+x.height);if(v&&T5.XYRect.intersect(h,E)){E=T5.Images.get(x.url,(p&g)===0?a:null,o);v(E,u,t,x.width,x.height)}}}function d(h){e&&e.run(h,function(p){f=p;n.changed()})}function a(){n.changed()}m=T5.ex({imageLoadArgs:{}},m);var e=k?T5.Generator.init(k,m):null,f=null,b=T5.XYRect.init(),o=m.imageLoadArgs,g=T5.viewState("ZOOM"),n=T5.ex(new T5.ViewLayer(m),{changeGenerator:function(h,
p){e=T5.Generator.init(h,T5.ex({},m,p));e.bindToView(n.getParent());f=null;d(b)},clip:function(h,p,v){l(p,v,function(y,x,u,t,E){y&&h.rect(x,u,t,E)})},cycle:function(h,p){d(p)},draw:function(h,p,v){l(p,v,function(y,x,u,t,E){n.drawImage(h,y,x,u,t,E,p,v)});b=T5.XYRect.copy(p)},drawImage:function(h,p,v,y){p&&h.drawImage(p,v,y,p.width,p.height)}});n.bind("idle",function(){d(b)});n.bind("parentChange",function(h,p){e&&e.bindToView(p)});n.bind("tap",function(h,p,v,y){h=[];var x=y.x,u=y.y,t,E;if(f)for(var z=
f.length;z--;){t=f[z];if(E=x>=t.x&&x<=t.x+t.width&&u>=t.y&&u<=t.y+t.height)h[h.length]=t}h.length>0&&n.trigger("tapImage",h,p,v,y)});return n};
T5.Style=function(){function k(f,b){a[f]=l(b);return f}function m(f){for(var b in f)k(b,f[b])}function l(f){function b(h){var p=f[h];typeof p!=="undefined"&&g.push(function(v){v[h]=p})}function o(){g=[];for(var h in f)b(h)}f=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var g=[],n={applyToContext:function(h){for(var p=g.length;p--;)g[p](h)},update:function(h,
p){f[h]=p;o()}};o();return n}var d={},a={},e={apply:function(f,b){var o=a[b]?a[b]:a.basic,g;if(f&&f.canvas){g=d[f.canvas.id];d[f.canvas.id]=b}o.applyToContext(f);return g},define:k,defineMany:m,get:function(f){return a[f]},init:l,load:function(f){COG.jsonp(f,function(b){T5.resetStyles(b)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return e}();
T5.Tiling=function(){return{tileSize:256,init:function(k,m,l,d,a){return T5.ex({x:k,y:m,width:l,height:d},a)}}}();
T5.TileGenerator=function(k){function m(v,y,x,u){function t(){if(p.initTileCreator){f=true;p.initTileCreator(v,y,x,u)}}p.prepTileCreator?p.prepTileCreator(v,y,x,t):t()}function l(v,y){for(var x=~~((v.x1-e.x)/b),u=~~((v.y1-e.y)/o),t=[],E=-n;E<n;E++)for(var z=-h;z<h;z++){var R=g(x+E,u+z);if(R)t[t.length]=R}y&&y(t);a=T5.XYRect.copy(v)}k=T5.ex({tileWidth:256,tileHeight:256},k);var d=null,a=null,e=T5.XY.init(),f=false,b=k.tileWidth,o=k.tileHeight,g=null,n=0,h=0,p={bindToView:function(v){COG.Log.info("initializing generator");
d=v;p.trigger("bindView",v)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){g=null;f=false;a=null},run:function(v,y){if(!a||Math.abs(v.x1-a.x1)>b||Math.abs(v.y1-a.y1)>o){if(!g&&!f||p.requireRefresh()){COG.Log.info("generating tiles, view rect = ",v);e=T5.XY.init(v.x1,v.y1);n=Math.ceil(v.width/b)+1;h=Math.ceil(v.height/o)+1;m(b,o,p.getTileCreatorArgs?p.getTileCreatorArgs(d):{},function(x){g=x;f=false;l(v,y)})}g&&l(v,y)}}};
COG.observable(p);p.bind("update",function(){COG.Log.info("captured generator update");a=null});return p};
T5.Geo=function(){function k(s,q){var r=null;for(var w in M)if(q){if(w==q&&M[w][s]){r=M[w];break}}else if(M[w][s]){r=M[w];break}return r}function m(s,q){var r=h*Math.sin(s);return a-2*Math.atan(q*Math.pow((1-r)/(1+r),h/2))}function l(s,q,r,w){var B=0;s=s.toUpperCase();for(var F in w){var G=q[F];if(G){var K=r[F];G=K?K(s,G):COG.wordExists(s,G)?1:0;B+=G*w[F]}}return B}var d=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],a=Math.PI/2,e=Math.PI*2,f=-a,b=a,o=
-e,g=Math.PI/180,n=180/Math.PI,h=0.08181919084262157,p=null,v={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},y={VECTORIZE_PER_CYCLE:500},x={getEngine:function(s){for(var q=null,r=1;!q&&r<arguments.length;r++)q=k(s,arguments[r]);q=q?q:k(s);if(!q)throw Error("Unable to find GEO engine with "+s+" capability");return q},rankGeocodeResponses:function(s,q,r){var w=[],B=N.AddressCompareFns;if(r&&r.compareFns)B=T5.ex({},B,r.compareFns);for(r=0;r<q.length;r++)w.push(new N.GeoSearchResult({caption:H.toString(q[r]),
data:q[r],pos:q[r].pos,matchWeight:l(s,q[r],B,N.GeocodeFieldWeights)}));w.sort(function(F,G){return G.matchWeight-F.matchWeight});return w},distanceToString:function(s){if(s>1E3)return~~(s/10)/100+" km";return s?s+" m":""},dist2rad:function(s){return s/6371},lat2pix:function(s){s=parseFloat(s)*g;s=Math.sin(s);var q=h*s;return Math.log((1+s)/(1-s)*Math.pow((1-q)/(1+q),h))/2},lon2pix:function(s){return parseFloat(s)*g},pix2lon:function(s){return N.normalizeLon(s)*n},pix2lat:function(s){s=Math.pow(Math.E,
-s);for(var q=a-2*Math.atan(s),r=m(q,s),w=0;w<12&&Math.abs(q-r)>1.0E-7;){q=r;r=m(q,s);w++}return r*n},normalizeLon:function(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s},radsPerPixel:function(s){return 2*Math.PI/(256<<s)}},u=function(s,q){return{lat:parseFloat(s?s:0),lon:parseFloat(q?q:0)}},t=function(s,q){return{min:z.parse(s),max:z.parse(q)}},E=function(s){return s=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},s)},z=function(){var s={calcDistance:function(q,
r){if(s.empty(q)||s.empty(r))return 0;var w=(r.lat-q.lat)*g/2,B=(r.lon-q.lon)*g/2;w=Math.sin(w)*Math.sin(w)+Math.cos(q.lat*g)*Math.cos(r.lat*g)*Math.sin(B)*Math.sin(B);return 6371*2*Math.atan2(Math.sqrt(w),Math.sqrt(1-w))},copy:function(q){return q?new u(q.lat,q.lon):null},empty:function(q){return!q||q.lat===0&&q.lon===0},equal:function(q,r){return q&&r&&q.lat==r.lat&&q.lon==r.lon},inArray:function(q,r){for(var w=z.equal,B=r.length;B--;)if(w(q,r[B]))return true;return false},inBounds:function(q,r){var w=
!(z.empty(q)||z.empty(r));return w=(w=w&&q.lat>=r.min.lat&&q.lat<=r.max.lat)&&q.lon>=r.min.lon&&q.lon<=r.max.lon},offset:function(q,r,w){var B=q.lat*g;r=B+r/6371;for(q=q.lon*g+Math.asin(Math.sin(w/6371)/Math.cos(B));r<f;)r+=Math.PI;for(;r>b;)r-=Math.PI;for(;q>e;)q-=2*Math.PI;return new u(r*n,q*n)},parse:function(q){if(q)if(typeof q.lat!=="undefined")return s.copy(q);else{if(q.split)for(var r=[" ",","],w=0;w<r.length;w++){var B=q.split(r[w]);if(B.length===2)return new u(B[0],B[1])}}else return new u;
return null},parseArray:function(q){var r=q.length,w=Array(r);for(r=r;r--;)w[r]=s.parse(q[r]);return w},fromMercatorPixels:function(q,r){return new u(T5.Geo.pix2lat(r),T5.Geo.normalizeLon(T5.Geo.pix2lon(q)))},toMercatorPixels:function(q){return T5.XY.init(T5.Geo.lon2pix(q.lon),T5.Geo.lat2pix(q.lat))},generalize:function(q,r,w){var B=q.length,F=[],G=null;w||(w=250);w/=1E3;COG.Log.info("generalizing positions, must include "+r.length+" positions");for(var K=B;K--;)if(K===0)F.unshift(q[K]);else{var S=
!G||z.inArray(q[K],r)?w:z.calcDistance(G,q[K]);if(q[K]&&S>=w){F.unshift(q[K]);G=q[K]}}COG.Log.info("generalized "+B+" positions into "+F.length+" positions");return F},vectorize:function(q,r){var w=q.length,B=Array(w);r=T5.ex({chunkSize:y.VECTORIZE_PER_CYCLE,async:true},r);if(!r.async){for(var F=w;F--;)B[F]=T5.GeoXY.init(q[F]);return B}return COG.Loopage.join({frequency:10,execute:function(G,K){for(var S=0,la=r.chunkSize,X=w;X--;){B[X]=T5.GeoXY.init(q[X]);S+=1;if(S>la)break}w=X;w<=0&&K.trigger("complete",
B)}})},toString:function(q){return q?q.lat+" "+q.lon:""}};return s}(),R=function(){var s={calcSize:function(q,r,w){var B=T5.XY.init(0,r.lat-q.lat);if(typeof w==="undefined")w=true;B.x=w&&q.lon>r.lon?360-q.lon+r.lon:r.lon-q.lon;return B},createBoundsFromCenter:function(q,r){var w=r/6371,B=q.lat*g,F=q.lon*g,G=B-w,K=B+w;if(G>f&&K<b){B=Math.asin(Math.sin(w)/Math.cos(B));w=F-B;if(w<o)w+=2*Math.PI;F=F+B;if(F>e)F-=2*Math.PI}else{G=Math.max(G,f);K=Math.min(K,b);w=o;F=e}return new t(new u(G*n,w*n),new u(K*
n,F*n))},expand:function(q,r){return new t(new u(q.min.lat-r,q.min.lon-N.normalizeLon(r)),new u(q.max.lat+r,q.max.lon+N.normalizeLon(r)))},forPositions:function(q,r){var w=null,B=T5.ticks();r||(r="auto");for(var F=q.length;F--;)if(w){var G=s.calcSize(w.min,q[F],false),K=s.calcSize(q[F],w.max,false);if(G.x<0)w.min.lon=q[F].lon;if(G.y<0)w.min.lat=q[F].lat;if(K.x<0)w.max.lon=q[F].lon;if(K.y<0)w.max.lat=q[F].lat}else w=new T5.Geo.BoundingBox(q[F],q[F]);if(r){if(r=="auto"){F=s.calcSize(w.min,w.max);r=
Math.max(F.x,F.y)*0.3}w=s.expand(w,r)}COG.Log.trace("calculated bounds for "+q.length+" positions",B);return w},getCenter:function(q){var r=R.calcSize(q.min,q.max);return new T5.Geo.Position(q.min.lat+r.y/2,q.min.lon+r.x/2)},getGeoHash:function(q){var r=T5.Geo.GeoHash.encode(q.min.lat,q.min.lon);q=T5.Geo.GeoHash.encode(q.max.lat,q.max.lon);COG.Log.info("min hash = "+r+", max hash = "+q)},getZoomLevel:function(q,r){var w=s.getCenter(q),B=d[Math.min(Math.round(Math.abs(w.lat)*0.05),d.length)],F=s.calcSize(q.min,
q.max);w=Math.ceil(Math.log(d[3]*r.height/F.y)/Math.log(2));B=Math.ceil(Math.log(B*r.width/F.x)/Math.log(2));return Math.min(isNaN(w)?1E3:w,isNaN(B)?1E3:B)},isEmpty:function(q){return!q||z.empty(q.min)||z.empty(q.max)},toString:function(q){return"min: "+z.toString(q.min)+", max: "+z.toString(q.max)}};return s}(),H=function(){var s=/^(\d+).*$/,q=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(r,w){s.lastIndex=-1;if(s.test(r))for(var B=r.replace(s,"$1"),F=w.split(","),G=0;G<F.length;G++){q.lastIndex=
-1;if(q.test(F[G])){var K=q.exec(F[G]);if(B>=parseInt(K[1],10)&&B<=parseInt(K[2],10))return true}else if(B==F[G])return true}return false},normalize:function(r){if(!r)return"";r=r.toUpperCase();if(!p){var w=[];for(var B in v)w.push(B);p=RegExp("(\\s)("+w.join("|")+")(\\s|$)","i")}p.lastIndex=-1;if(w=p.exec(r))r=r.replace(p,"$1"+v[w[2]]);return r},toString:function(r){return r.streetDetails+" "+r.location}}}(),M={},N={P:z,B:R,A:H,Radius:function(s,q){return{distance:parseInt(s,10),uom:q}},Position:u,
BoundingBox:t,Address:E,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(s){if(!s.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var q=T5.ex({remove:function(){delete M[q.id]}},s);return M[q.id]=q},GeoSearchResult:function(s){s=T5.ex({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},s);return T5.ex(s,{toString:function(){return s.caption+(s.matchWeight?" ("+s.matchWeight+")":"")}})},GeoSearchAgent:function(s){return new T5.Dispatcher.Agent(s)},
GeocodingAgent:function(s){s=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(q,r){try{if(!q.reverse&&!q.freeform)address=new E(q);var w=N.getEngine("geocode");if(w)w.geocode({addresses:[q.freeform?q.freeform:address],complete:function(F,G){if(r){var K=G;if(q.freeform)K=N.rankGeocodeResponses(q.freeform,K,N.getEngine("geocode"));r(K,s)}}})}catch(B){COG.Log.exception(B)}}},s);return new N.GeoSearchAgent(s)}};T5.GeoXY=function(){function s(r,w){if(r.length){for(var B,F,G,K,
S=r.length;S--;){s(r[S],w);B=typeof B==="undefined"||r.x<B?r.x:B;F=typeof F==="undefined"||r.y<F?r.y:F;G=typeof G==="undefined"||r.x>G?r.x:G;K=typeof K==="undefined"||r.y>K?r.y:K}return T5.XYRect.init(B,F,K,K)}else if(r.mercXY){B=r.mercXY;r.x=~~(B.x/w);r.y=~~((Math.PI-B.y)/w);r.radsPerPixel=w}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");return r}function q(r,w,B){r.pos=w;r.mercXY=z.toMercatorPixels(w);(B=typeof B!=="undefined"?B:r.radsPerPixel)&&s(r,B)}return{init:function(r,
w){var B=T5.XY.init();q(B,r,w);return B},sync:s,toPos:function(r,w){w=w?w:self.radsPerPixel;return z.fromMercatorPixels(r.x*w,Math.PI-r.y*w)},updatePos:q}}();N.GeoVector=function(s){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return T5.GeoXY.init(s)};return T5.ex(N,y,x)}();
T5.Geo.GeoHash=function(){function k(m,l,d){if(l&d)m[0]=(m[0]+m[1])/2;else m[1]=(m[0]+m[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(m){var l=1,d=[],a=[];d[0]=-90;d[1]=90;a[0]=-180;a[1]=180;lat_err=90;lon_err=180;for(i=0;i<m.length;i++){c=m[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(l){lon_err/=2;k(a,cd,mask)}else{lat_err/=2;k(d,cd,mask)}l=!l}}d[2]=(d[0]+
d[1])/2;a[2]=(a[0]+a[1])/2;return{latitude:d,longitude:a}},encode:function(m,l,d){var a=1,e=[],f=[],b=0,o=0;d=d?d:12;geohash="";e[0]=-90;e[1]=90;f[0]=-180;for(f[1]=180;geohash.length<d;){if(a){mid=(f[0]+f[1])/2;if(l>mid){o|=BITS[b];f[0]=mid}else f[1]=mid}else{mid=(e[0]+e[1])/2;if(m>mid){o|=BITS[b];e[0]=mid}else e[1]=mid}a=!a;if(b<4)b++;else{geohash+=BASE32[o];o=b=0}}return geohash}}}();
T5.Geo.JSON=function(){function k(n,h,p,v){h=l(h);n.add(v.line(h,p));return h.length}function m(n,h,p,v){h=l(h);n.add(v.poly(h,p));return h.length}function l(n){var h=n?n.length:0,p=Array(h);for(h=h;h--;)p[h]=new T5.Geo.Position(n[h][1],n[h][0]);return T5.Geo.P.vectorize(p,f)}function d(n,h,p){return new g(n,h,p)}var a="featurecollection",e="feature",f={async:false},b={processor:null,group:"shapes",layerClass:T5.ShapeLayer},o={point:T5.ex({},b,{processor:function(n,h,p,v){h=l([h.coordinates],f);if(h.length>
0)if(p=v.marker(h[0],p)){n.add(p);return h.length}},group:"markers",layerClass:T5.MarkerLayer}),linestring:T5.ex({},b,{processor:function(n,h,p,v){h=l(h&&h.coordinates?h.coordinates:[]);return k(n,h,p,v)}}),multilinestring:T5.ex({},b,{processor:function(n,h,p,v){h=h&&h.coordinates?h.coordinates:[];for(var y=0,x=h.length;x--;)y+=k(n,h[x],p,v);return y}}),polygon:T5.ex({},b,{processor:function(n,h,p,v){h=h&&h.coordinates?h.coordinates:[];if(h.length>0)return m(n,h[0],p,v);return 0}}),multipolygon:T5.ex({},
b,{processor:function(n,h,p,v){h=h&&h.coordinates?h.coordinates:[];for(var y=0,x=0;x<h.length;x++)y+=m(n,h[x][0],p,v);return y}})},g=function(n,h,p,v){function y(q,r){var w=q.processor,B=E+q.group,F=T5.ex({},q,p,{properties:r.properties});if(w){var G=N[B];if(!G){G=new q.layerClass({id:B});N[B]=G}globalLayers=N;return w(G,r.data,F,v)}return 0}function x(q,r){var w=q&&q.type?q.type.toLowerCase():null;return w&&w===e?x(q.geometry,q.properties):{type:w,isCollection:w?w===a:false,definition:o[w],data:q,
properties:r?r:q.properties}}p=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},p);v=T5.ex({marker:function(q){return new T5.Marker({xy:q})},line:function(q,r){return new T5.Poly(q,r)},poly:function(q,r){return new T5.Poly(q,T5.ex({fill:true},r))}},v);var u=p.vectorsPerCycle,t=p.rowPreParse,E=p.layerPrefix,z=0,R=0,H=null,M=0,N={},s;if(!n)return null;if(typeof n.length==="undefined")n=[n];R=n.length;s=COG.Loopage.join({frequency:10,execute:function(q,
r){var w=0,B=z;if(!H){for(;B<R;B++){var F=x(t?t(n[B]):n[B]),G=null;if(F.isCollection){M+=1;H=d(F.data.features,function(K){H=null;for(var S in K)N[S]=K[S]},{layerPrefix:E+M+"-"});G+=1}else if(F.definition)G=y(F.definition,F);w+=G?G:1;if(w>=u)break}z=B+1;!H&&z>=R&&r.trigger("complete")}}});s.bind("complete",function(){h&&h(N)});return s};return{parse:d}}();
T5.Geo.LocationSearch=function(k){function m(f,b){navigator.geolocation.clearWatch(d);d=0;if(a){clearTimeout(a);a=0}b&&b([f],k)}function l(f){COG.Log.info("caught location tracking error:",f)}k=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},k);var d=0,a=0,e=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(f,b){if(navigator.geolocation&&!d){d=navigator.geolocation.watchPosition(function(o){var g=new T5.Geo.Position(o.coords.latitude,o.coords.longitude);
o=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:g,accuracy:o.coords.accuracy/1E3,matchWeight:100});if(!e||o.accuracy<e.accuracy)e=o;if(!k.requiredAccuracy||e.accuracy<k.requiredAccuracy)m(e,b)},l,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(k.searchTimeout)a=setTimeout(function(){e&&m(e,b)},k.searchTimeout)}}},k))};
T5.Map=function(k){function m(x){try{var u=new T5.Geo.Position(x.coords.latitude,x.coords.longitude),t=x.coords.accuracy/1E3;y.trigger("locationUpdate",x,t);if(p){if(!n){n=new T5.Geo.UI.LocationOverlay({pos:u,accuracy:t});n.update(y.getTileLayer());y.setLayer("location",n)}var E=T5.Geo.B.createBoundsFromCenter(u,Math.max(t,1));y.gotoBounds(E)}else{n.pos=u;n.accuracy=t;n.update(y.getTileLayer());e(u,null,T5.easing("sine.out"))}p=false}catch(z){COG.Log.exception(z)}}function l(x){COG.Log.info("caught location tracking error:",
x)}function d(){var x=y.getViewRect();if(x){x=T5.XY.init(x.x1+x.width/2,x.y1+x.height/2);return T5.GeoXY.toPos(x,v)}return null}function a(x,u,t){y.setZoomLevel(u);T5.Images.cancelLoad();T5.cancelAnimation();e(x,t)}function e(x,u,t,E){x=T5.GeoXY.init(x,T5.Geo.radsPerPixel(y.getZoomLevel()));y.updateOffset(x.x,x.y,t,E,u);y.trigger("wake");y.trigger("boundsChange",y.getBoundingBox());u&&typeof t==="undefined"&&u(y)}k=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},
k);var f={NONE:0,SINGLE:1,WATCH:2},b=T5.XY.init(),o=f.NONE,g=false,n=null,h=0,p=true,v=0;if(!k.provider)k.provider=new T5.Geo.MapProvider;k.adjustScaleFactor=function(x){return Math.pow(2,(x<1?Math.floor:Math.ceil)(Math.log(x)))};var y=T5.ex(new T5.View(k),{getBoundingBox:function(){var x=y.getViewRect();return new T5.Geo.BoundingBox(T5.GeoXY.toPos(T5.XY.init(x.x1,x.y2),v),T5.GeoXY.toPos(T5.XY.init(x.x2,x.y1),v))},getCenterPosition:d,gotoBounds:function(x,u){var t=T5.Geo.B.getZoomLevel(x,y.getDimensions());
a(T5.Geo.B.getCenter(x),t,u)},gotoPosition:a,panToPosition:e,syncXY:function(x){return T5.GeoXY.sync(x,v)},locate:function(){y.trackStart(f.SINGLE);setTimeout(y.trackCancel,1E4)},trackStart:function(x){if(navigator.geolocation&&!h){o=x?x:f.WATCH;p=true;h=navigator.geolocation.watchPosition(m,l,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){h&&navigator.geolocation&&navigator.geolocation.clearWatch(h);y.removeLayer("location");n=null;o=f.NONE;h=0},animateRoute:function(x,
u,t,E){var z=y.getLayer("route");if(z)(x=z.getAnimation(x,u,t,E))&&x.addToView(y)}});y.bind("pan",function(){o===f.SINGLE&&y.trackCancel()});y.bind("tap",function(){});y.bind("idle",function(){if(T5.XY.absSize(T5.XY.diff(b,y.getOffset()))>k.boundsChangeThreshold){b=T5.XY.copy(y.getOffset());y.trigger("boundsChange",y.getBoundingBox())}});T5.zoomable(y,k);y.bind("zoomLevelChange",function(x,u,t){x=t?T5.GeoXY.toPos(t,v):d();v=T5.Geo.radsPerPixel(u);y.triggerAll("resync",y);e(x)});COG.configurable(y,
["provider"],COG.paramTweaker(k,null,{provider:function(){y.cleanup();g=false}}),true);return y};
T5.Geo.MapProvider=function(){var k=1,m=20;return{zoomLevel:0,checkZoomLevel:function(l){return Math.min(Math.max(l,k),m)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:k,max:m}},prepTileGridArgs:function(l,d,a,e,f){var b=null;if(f.tileBackgroundColor){b=T5.Images.newCanvas(a,a);var o=b.getContext("2d");o.fillStyle=f.tileBackgroundColor;o.fillRect(0,0,a,a)}return T5.ex({tileSize:a,width:l,height:d,center:e,tileDrawArgs:{background:b}},
f)},setZoomRange:function(l,d){k=l;m=d}}};T5.MapTileGenerator=function(k){function m(e,f){l=f;a.reset()}var l=0,d=null,a=T5.ex(new T5.TileGenerator(k),{getTileCreatorArgs:function(e){d=e.getCenterPosition();return{zoomLevel:l,position:d}},requireRefresh:function(){return!d}});a.bind("bindView",function(e,f){if(f.getZoomLevel){l=f.getZoomLevel();f.bind("zoomLevelChange",m)}});return a};
T5.Geo.Routing=function(){var k={calculate:function(m){m=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},m);var l=T5.Geo.getEngine("route");l&&l.route(m,function(d){if(m.generalize)d.geometry=T5.Geo.P.generalize(d.geometry,d.getInstructionPositions());if(m.map){k.createMapOverlay(m.map,d);m.autoFit&&m.map.gotoBounds(d.boundingBox)}m.success&&m.success(d)})},createMapOverlay:function(m,l){var d=m.getDimensions();d=new T5.Geo.UI.RouteOverlay({data:l,width:d.width,
height:d.height});m.setLayer("route",d)},parseTurnType:function(m){for(var l=k.TurnType.Unknown,d=T5.Geo.Routing.TurnTypeRules,a=0;a<d.length;a++){d[a].regex.lastIndex=-1;var e=d[a].regex.exec(m);if(e){l=d[a].customCheck?d[a].customCheck(m,e):d[a].turnType;break}}return l},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(m){var l=m=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},m),d=m.description;d=d.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");l.description=d;if(!m.turnType)m.turnType=k.parseTurnType(m.description);return m},RouteData:function(m){m=T5.ex({geometry:[],instructions:[],boundingBox:null},
m);if(!m.boundingBox)m.boundingBox=T5.Geo.B.forPositions(m.geometry);return T5.ex({getInstructionPositions:function(){for(var l=[],d=0;d<m.instructions.length;d++)m.instructions[d].position&&l.push(m.instructions[d].position);return l}},m)}};return k}();T5.Geo.Search=function(){return{bestResults:function(k,m){m||(m=20);for(var l=k.length>0?k[0]:null,d=[],a=0;a<k.length;a++)if(l&&k[a]&&l.matchWeight-k[a].matchWeight<=m)d.push(k[a]);else break;return d}}}();
T5.Geo.UI=function(){var k={AnnotationTween:null,RouteOverlay:function(m){m=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},m);var l=[],d=[],a=new T5.PathLayer(m);(function(){if(m.data&&m.data.instructions){for(var e=m.data.instructions,f=Array(e.length),b=e.length;b--;)f[b]=e[b].position;T5.Geo.P.vectorize(f).bind("complete",function(o,g){d=g})}m.data&&m.data.geometry&&T5.Geo.P.vectorize(m.data.geometry).bind("complete",
function(o,g){l=g;a.updateCoordinates(l,d,true)})})();return a},Poly:function(m,l){l=T5.ex({autoParse:true},l);for(var d=Array(m.length),a=l.autoParse,e=T5.Geo.P.parse,f=m.length;f--;)d[f]=T5.GeoXY.init(a?e(m[f]):m[f]);return new T5.Poly(d,l)},Annotation:function(m){m=T5.ex({pos:null},m);m.xy=T5.GeoXY.init(m.pos);return new T5.ImageAnnotation(m)},LocationOverlay:function(m){m=T5.ex({pos:null,accuracy:null,zindex:90},m);var l=new Image,d=T5.XY.init(),a=T5.XY.init(),e=null;l.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
l.onload=function(){d=T5.XY.init(l.width/2,l.height/2)};var f=T5.ex(new T5.ViewLayer(m),{pos:m.pos,accuracy:m.accuracy,drawAccuracyIndicator:false,draw:function(b,o){var g=a.x-o.x,n=a.y-o.y;if(e){b.fillStyle="rgba(30, 30, 30, 0.2)";b.beginPath();b.arc(g,n,e,0,Math.PI*2,false);b.fill()}l.complete&&l.width>0&&b.drawImage(l,g-d.x,n-d.y,l.width,l.height);f.changed()},update:function(b){if(b){e=Math.floor(b.getPixelDistance(f.accuracy)*0.5);a=b.getGridXYForPosition(f.pos);f.changed()}}});f.bind("gridUpdate",
function(b,o){f.update(o)});return f},AnnotationsOverlay:function(m){function l(b,o){var g=b.length,n=f.getParent();if(o=o?o:n?n.getTileLayer():null)for(g=g;g--;)o.syncVectors([b[g].xy]);b.sort(function(h,p){var v=p.xy.y-h.xy.y;if(v===0)v=p.xy.x-h.xy.x;return v})}m=T5.ex({pois:null,map:null,zindex:100},m);var d=[],a=false,e=[],f=T5.ex(new T5.ViewLayer(m),{cycle:function(){return a},draw:function(b,o,g,n,h){a=false;b.fillStyle="rgba(255, 0, 0, 0.75)";b.globalCompositeOperation="source-over";for(g=
d.length;g--;){d[g].draw(b,o,n,f,h);a=a||d[g].isAnimating()}for(g=e.length;g--;){e[g].draw(b,o,n,f,h);a=a||e[g].isAnimating()}return a?1:0},add:function(b){if(b&&b.length)for(var o=b.length;o--;)e[e.length]=b[o];else if(b)e[e.length]=b;l(e);f.changed()},clear:function(b){e=[];l(e);if(b){d=[];l(d)}f.changed()}});COG.listen("geo.pois-updated",function(b){if(m.pois&&m.pois.id==b.srcID){b=b.pois;try{d=[];for(var o=0;o<b.length;o++)if(b[o].pos){var g;var n=b[o];if(n&&n.pos){var h={poi:n,annotation:null};
m.map&&m.map.trigger("getAnnotationForPOI",h);if(!h.annotation)h.annotation=new T5.Annotation({xy:T5.GeoXY.init(n.pos)});if(h.annotation){h.annotation.isNew=n.isNew;n.isNew=false}g=h.annotation}else g=void 0;g&&d.push(g)}l(d)}catch(p){COG.Log.exception(p)}f.changed()}});f.bind("gridUpdate",function(b,o){l(d,o);l(e,o);f.changed()});return f}};k.ImageAnnotation=k.Annotation;return k}();
T5.Geo.Routing.TurnTypeRules=function(){var k=T5.Geo.Routing.TurnType,m=[];m.push({regex:/continue/i,turnType:k.Continue});m.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(l,d){return/bear/i.test(d[1])?k.TurnLeftSlight:k.TurnLeft}});m.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(l,d){return/bear/i.test(d[1])?k.TurnRightSlight:k.TurnRight}});m.push({regex:/enter\s(roundabout|rotaty)/i,turnType:k.EnterRoundabout});m.push({regex:/take.*?ramp/i,turnType:k.Ramp});m.push({regex:/take.*?exit/i,
turnType:k.RampExit});m.push({regex:/make(.*?)u\-turn/i,customCheck:function(l,d){return/right/i.test(d[1])?k.UTurnRight:k.UTurnLeft}});m.push({regex:/proceed/i,turnType:k.Start});m.push({regex:/arrive/i,turnType:k.Arrive});m.push({regex:/fell\sthrough/i,turnType:k.Merge});return m}();
