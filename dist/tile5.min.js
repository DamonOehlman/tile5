COG=function(){var l=/\$\{(.*?)\}/ig,n=Object.prototype.hasOwnProperty,m=0,d={id:"grunt.core",extend:function(){var a=arguments[0]||{},e=1,g=arguments.length,b=false,o,f,k,h;if(typeof a==="boolean"){b=a;a=arguments[1]||{};e=2}if(typeof a!=="object"&&!d.isFunction(a))a={};if(g===e){a=this;--e}for(;e<g;e++)if((o=arguments[e])!=null)for(f in o){k=a[f];h=o[f];if(a!==h)if(b&&h&&(d.isPlainObject(h)||d.isArray(h))){k=k&&(d.isPlainObject(k)||d.isArray(k))?k:d.isArray(h)?[]:{};a[f]=d.extend(b,k,h)}else if(h!==
undefined)a[f]=h}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return false;var e;for(e in a);return e===undefined||n.call(a,e)},isEmptyObject:function(a){for(var e in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,e){var g=a,b=arguments,o=1;if(e&&d.isArray(e)){b=e;o=0}for(o=o;o<b;o++)g=g&&typeof foo[b[o]]!=="undefined";return g},newModule:function(a){a=d.extend({id:null,requires:[],parent:null},a);if(a.parent)a=d.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+m++},formatStr:function(a){if(arguments.length<=1)return a;for(var e=arguments.length-2,g=0;g<=e;g++)a=a.replace(RegExp("\\{"+g+"\\}","gi"),arguments[g+
1]);return a},wordExists:function(a,e){var g="";if(e.toString)e=e.toString();for(var b=0;b<e.length;b++)g+=!/\w/.test(e[b])?"\\"+e[b]:e[b];return RegExp("(^|\\s|\\,)"+g+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,e){for(var g=l.exec(a);g;){a=a.replace(g[0],COG.XPath.first(g[1],e));l.lastIndex=0;g=l.exec(a)}return a}};return d}();
COG.Log=function(){function l(e,g){var b,o=g&&g.length>0?g[0]:"";for(b=1;g&&b<g.length;b++)o+=" "+(m&&COG.isPlainObject(g[b])?JSON.stringify(g[b]):g[b]);typeof console!=="undefined"&&console[e](o);for(b=0;b<n.length;b++)n[b].call(a,o,e)}var n=[],m=typeof JSON!=="undefined",d=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return d?(new Date).getTime():null},trace:function(e,g){if(d)console.markTimeline(e+(g?": "+(a.getTraceTicks()-g)+"ms":""))},debug:function(){l("debug",
arguments)},info:function(){l("info",arguments)},warn:function(){l("warn",arguments)},error:function(){l("error",arguments)},exception:function(e){a.error(arguments);for(var g in e)a.info("ERROR DETAIL: "+g+": "+e[g])},watch:function(e,g){try{g()}catch(b){a.exception(b,e)}},throwError:function(e){a.error(e);throw Error(e);},requestUpdates:function(e){n.push(e)}};return a}();
(function(){function l(d,a){d[a]||(d[a]=function(e){return d.configure(a,e)})}function n(d){d.gtConfId=COG.objId("configurable");d.gtConfig={};d.gtConfigFns=[];return d.gtConfig}var m={};COG.paramTweaker=function(d,a,e){return function(g,b){if(typeof b!=="undefined"){if(g in d)d[g]=b;e&&g in e&&e[g](g,b)}else return a&&g in a?a[g](g):d[g]}};COG.configurable=function(d,a,e,g){if(d){d.gtConfId||n(d);var b=d.gtConfId,o=d.gtConfig,f=d.gtConfigFns;m[b]=d;f.push(e);for(e=a.length;e--;){o[a[e]]=true;g&&
l(d,a[e])}if(!d.configure)d.configure=function(k,h){if(o[k]){for(var q=f.length;q--;){var t=f[q](k,h);if(typeof t!=="undefined")return t}return m[b]}return null}}}})();
(function(){function l(n,m){var d=n.gtObsHandlers;d[m]||(d[m]=[]);return d[m]}COG.observable=function(n){if(n){if(!n.gtObsHandlers)n.gtObsHandlers={};if(!(n.bind||n.trigger||n.unbind)){n.bind=function(m,d){var a=COG.objId("callback");l(n,m).unshift({fn:d,id:a});return a};n.trigger=function(m){var d=l(n,m),a={cancel:false,tickCount:(new Date).getTime()},e;if(!d)return null;e=Array.prototype.slice.call(arguments,1);e.unshift(a);for(var g=d.length;g--&&!a.cancel;)d[g].fn.apply(self,e);return a};n.unbind=
function(m,d){for(var a=l(n,m),e=0;a&&e<a.length;e++)if(a[e].id===d){a.splice(e,1);break}return n}}}}})();(function(){var l={},n=[];COG.addPipe=function(m){m("pipe.test",{});n.push(m)};COG.listen=function(m,d){l[m]||(l[m]=[]);d&&l[m].push(d)};COG.say=function(m,d){var a;for(a=n.length;a--;)n[a](m,d);if(l[m])for(a=l[m].length;a--;)l[m][a](d)}})();
COG.Loopage=function(){function l(h){return COG.extend({id:e++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},h)}function n(h){b.push(h);m()}function m(){o&&clearTimeout(o);o=setTimeout(d,0);k=true}function d(){for(var h,q=(new Date).getTime(),t=g.length;b.length>0;){var y=b.shift();for(h=t;h--;)if(g[h].id===y){g.splice(h,1);break}k=true;t=g.length}if(k){f=a;for(h=t;h--;)f=g[h].frequency<f?g[h].frequency:f}for(h=t;h--;){y=q-g[h].lastTick;if(g[h].lastTick===0||y>=g[h].frequency){g[h].execute(q,
g[h]);g[h].lastTick=q;g[h].single&&g[h].trigger("complete")}}o=t?setTimeout(d,f):0}var a=6E4,e=0,g=[],b=[],o=0,f=a,k=true;return{join:function(h){var q=new l(h);if(q.after>0)q.lastTick=(new Date).getTime()+q.after;COG.observable(q);q.bind("complete",function(){n(q.id)});g.unshift(q);m();return q},leave:n}}();if(!this.JSON)this.JSON={};
(function(){function l(f){return f<10?"0"+f:f}function n(f){a.lastIndex=0;return a.test(f)?'"'+f.replace(a,function(k){var h=b[k];return typeof h==="string"?h:"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function m(f,k){var h,q,t,y,x=e,u,v=k[f];if(v&&typeof v==="object"&&typeof v.toJSON==="function")v=v.toJSON(f);if(typeof o==="function")v=o.call(k,f,v);switch(typeof v){case "string":return n(v);case "number":return isFinite(v)?String(v):"null";case "boolean":case "null":return String(v);
case "object":if(!v)return"null";e+=g;u=[];if(Object.prototype.toString.apply(v)==="[object Array]"){y=v.length;for(h=0;h<y;h+=1)u[h]=m(h,v)||"null";t=u.length===0?"[]":e?"[\n"+e+u.join(",\n"+e)+"\n"+x+"]":"["+u.join(",")+"]";e=x;return t}if(o&&typeof o==="object"){y=o.length;for(h=0;h<y;h+=1){q=o[h];if(typeof q==="string")if(t=m(q,v))u.push(n(q)+(e?": ":":")+t)}}else for(q in v)if(Object.hasOwnProperty.call(v,q))if(t=m(q,v))u.push(n(q)+(e?": ":":")+t);t=u.length===0?"{}":e?"{\n"+e+u.join(",\n"+e)+
"\n"+x+"}":"{"+u.join(",")+"}";e=x;return t}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,g,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;if(typeof JSON.stringify!=="function")JSON.stringify=function(f,k,h){var q;g=e="";if(typeof h==="number")for(q=0;q<h;q+=1)g+=" ";else if(typeof h==="string")g=h;if((o=k)&&typeof k!=="function"&&(typeof k!=="object"||typeof k.length!=="number"))throw Error("JSON.stringify");return m("",
{"":f})};if(typeof JSON.parse!=="function")JSON.parse=function(f,k){function h(t,y){var x,u,v=t[y];if(v&&typeof v==="object")for(x in v)if(Object.hasOwnProperty.call(v,x)){u=h(v,x);if(u!==undefined)v[x]=u;else delete v[x]}return k.call(t,y,v)}var q;f=String(f);d.lastIndex=0;if(d.test(f))f=f.replace(d,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){q=eval("("+f+")");return typeof k==="function"?h({"":q},""):q}throw new SyntaxError("JSON.parse");}})();
(function(){function l(m,d){var a=m.split("|"),e={};for(var g in d){var b=d[g];e[g]=a.length>b?a[b]:null}return e}var n={JSON:{parse:function(m){return JSON.parse(m)}},PDON:{parse:function(m){var d=null,a=[];m=m.split("\n");for(var e=0;e<m.length;e++){var g=m[e];if(d)a.push(l(g,d));else if(g){d=g.split("|");g={};for(var b=0;b<d.length;b++)g[d[b]]=b;d=g}else d=null}return a}}};COG.parseData=function(m,d){d=d?d.toUpperCase():"JSON";if(!n[d])throw Error("Unsupported data format: "+d);try{return n[d].parse(m)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function l(a){for(var e=null,g=0;g<n.length;g++)if(e=n[g](a))break;return e}var n=[],m=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var d={SearchResult:function(a){return{toString:function(){var e=
null;if(a){var g=null;if(a.resultType>=0&&a.resultType<m.length)g=m[a.resultType];if(g)e=g(a)}return e?e:""}}},first:function(a,e){var g=d.SearchResult,b;var o=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!o)o=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(e))b=e.evaluate(a,e,l,o,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(f){COG.Log.warn("invalid xpath expression: "+a+" on node: "+e);b=null}return new g(b)},registerResolver:function(a){n.push(a)}};return d}();
COG.Storage=function(){function l(n){if(n&&n=="session")return sessionStorage;return localStorage}return{get:function(n,m){var d=l(m).getItem(n);return/^(\{|\[).*(\}|\])$/.test(d)?JSON.parse(d):d},set:function(n,m,d){m=jQuery.isArray(m)||jQuery.isPlainObject(m)?JSON.stringify(m):m;l(d).setItem(n,m)},remove:function(n,m){l(m).removeItem(n)}}}();
COG.ParseRules=function(){var l=[];return{add:function(n,m){l.push({regex:n,handler:m})},each:function(n,m,d){function a(){e++;d&&e>=l.length&&d(m)}for(var e=0,g=0;g<l.length;g++){var b=l[g].regex,o=l[g].handler,f=false;if(b){b.lastIndex=-1;if((b=b.exec(n))&&o){f=true;o(b,m,a)&&a()}}f||a()}}}};
(function(){function l(b){var o=[],f=function(h,q){q=COG.isFunction(q)?q():q;o[o.length]=encodeURIComponent(h)+"="+encodeURIComponent(q)};if(COG.isArray(b))for(var k=0;k<b.length;k++)f(b[k].name,b[k].value);else for(k in b)f(k,b[k]);return o.join("&").replace(/%20/g,"+")}var n={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},m={JSON:["json"],PDON:["pdon.txt"]},d=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,e={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},g={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function o(){if(this.readyState===4){var q=null,t=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(t)if(b.handleResponse)b.handleResponse(this);else{var y=b,x=this.getResponseHeader(g.CONTENT_TYPE),u,v=false;for(u in n)if(x&&x.indexOf(n[u])>=0){v=true;
break}x=!v;for(v=0;v<d.length;v++)x=x||d[v]==u;if(x)b:{x=u;for(var B in m)for(v=0;v<m[B].length;v++)if(RegExp(m[B][v]+"$","i").test(y.url)){u=B;break b}u=x?x:"DEFAULT"}try{q=e[u](this,y)}catch(D){q=e.DEFAULT(this,y)}}else b.error&&b.error(this)}catch(K){COG.Log.exception(K,"PROCESSING AJAX RESPONSE")}t&&q&&b.success&&b.success.call(this,q)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var f=
a.exec(b.url),k=f&&(f[1]&&f[1]!==location.protocol||f[2]!==location.host);if(b.data)b.method="POST";if(b.url){f=null;if(b.xhr)f=b.xhr(b);f||(f=new XMLHttpRequest);f.open(b.method,b.url,b.async);b.data&&f.setRequestHeader("Content-Type",b.contentType);k||f.setRequestHeader("X-Requested-With","XMLHttpRequest");f.onreadystatechange=o;f.send(b.method=="POST"?l(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(h){COG.Log.exception(h)}}})();
(function(){function l(a){var e=document.createElement("script"),g=false;e.src=a;e.async=true;e.onload=e.onreadystatechange=function(){if(!g&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){g=true;e.onload=e.onreadystatechange=null;e&&e.parentNode&&e.parentNode.removeChild(e)}};m||(m=document.getElementsByTagName("head")[0]);m.appendChild(e)}var n=0,m,d=this;COG.jsonp=function(a,e,g){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++n;d[b]=function(o){e(o);d[b]=null;try{delete d[b]}catch(f){}};
l(a+(g?g:"callback")+"="+b);return b}})();
COG.Touch=function(){function l(s,p){return{x:s.x-p.x,y:s.y-p.y}}function n(s,p){var r=l(s,p);return Math.sqrt(r.x*r.x+r.y*r.y)}function m(s){if(s.count>1)return n(s.touches[0],s.touches[1]);return 0}function d(s,p){var r=s&&s.count>0?s.touches[0]:null;if(r&&p&&p.count>0)return l(r,p.touches[0]);return null}function a(s,p){s.count=p.count;for(var r=f;r--;){s.touches[r].x=p.touches[r].x;s.touches[r].y=p.touches[r].y}}function e(){for(var s={count:0,touches:Array(f)},p=f;p--;)s.touches[p]=o();return s}
function g(s){if(s.preventDefault){s.preventDefault();s.stopPropagation()}else s.cancelBubble&&s.cancelBubble()}function b(s,p,r){if(N){p=p[r?r:"touches"];r=p.length;for(r=s.count=r;r--;){s.touches[r].x=p[r].pageX;s.touches[r].y=p[r].pageY}}else if(p.button===0){s.count=1;s.touches[0].x=p.pageX?p.pageX:p.screenX;s.touches[0].y=p.pageY?p.pageY:p.screenY}else s.count=0}function o(s,p){return{x:s?s:0,y:p?p:0}}var f=10,k=120,h=100,q=250,t=300,y=5,x=0,u=1,v=2,B=7,D=0,K=0,N=undefined,L=function(s){function p(E,
G,M,Z){var ka=Math.asin((E.y-G.y)/M);M=M*(qa/Z)>>0;M=M>ha?ha:M;ka=G.x>E.x?ka:Math.PI-ka;F("pan",Math.cos(ka)*-M,Math.sin(ka)*M,true)}function r(E,G){var M,Z;if(N){M=G-ra;if(M<q){Z=n(U.touches[0],E);Z>s.inertiaTrigger&&p(U.touches[0],E,Z,M)}}else{ea.x=E.x;ea.y=E.y;COG.Loopage.join({execute:function(ka,Q){M=ka-G;Z=n(E,ea);if(M<h&&Z>s.inertiaTrigger){Q.trigger("complete");p(E,ea,Z,M)}else M>h&&Q.trigger("complete")},frequency:10})}}function w(E){var G=0,M=0;if(E.offsetParent){do{G+=E.offsetLeft;M+=E.offsetTop;
E=E.offsetParent}while(E)}return o(G,M)}function A(E){var G=E.count,M=Array(G),Z=w(ia);for(G=G;G--;)M[G]=o(E.touches[G].x-Z.x,E.touches[G].y-Z.y);return M}function F(){ta&&ta.trigger.apply(null,arguments)}function J(E,G){var M=w(ia);M=o(G.x-M.x,G.y-M.y);F(E,G,M)}function H(E){var G=E.target?E.target:E.srcElement;if(na||G&&G===ia){b(U,E);if(U.count!==0){fa=null;aa.x=0;aa.y=0;oa=true;ga=false;ra=(new Date).getTime();g(E);G.style.cursor="move";F("inertiaCancel");va=ra;if(E=U.count>0?U.touches[0]:null){F("touchStart",
E.x,E.y);if(va-xa<t)if((E=l(U.touches[0],$.touches[0]))&&Math.abs(E.x)<s.maxDistDoubleTap&&Math.abs(E.y)<s.maxDistDoubleTap)ga=true;ca=x;a($,U)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function Y(E){var G=E.target?E.target:E.srcElement,M=0;if(na||G&&G===ia){b(V,E);if(V.count>0){ea.x=V.touches[0].x;ea.y=V.touches[0].y}if(oa){N&&g(E);if(V.count>1){U.count===1&&a(U,V);M=m(U)-m(V)}if(ca===x)if((E=d(V,U))&&(Math.abs(E.x)>=B||Math.abs(E.y)>=B))ca=u;if(ca!==x)if(!M||Math.abs(M)<
y){if(fa=d(V,$)){aa.x-=fa.x;aa.y-=fa.y;la.x-=fa.x;la.y-=fa.y}F("pan",la.x,la.y);la.x=0;la.y=0;ca=u}else{F("pinchZoom",A(U),A(V));ca=v}a($,V)}}}function T(E){var G=E.target?E.target:E.srcElement;if(oa&&(na||G&&G===ia)){b(ya,E,"changedTouches");var M=ya.touches[0];N&&g(E);E=(new Date).getTime();xa=va;if(ca===x){J("tap",U.touches[0]);ma||(ma=setTimeout(function(){ma=0;ga&&J("doubleTap",U.touches[0])},t+50))}else if(ca==u){F("panEnd",aa.x,aa.y);sa&&r(M,E)}else ca==v&&F("pinchZoomEnd",A(U),A($),E-ra);
G.style.cursor="default";oa=false}}function da(E){var G=E.target?E.target:E.srcElement;if(na||G&&G===ia){if(E.detail){G=-E.detail*k;G=o(E.axis===1?G:0,E.axis===2?G:0)}else G=o(E.wheelDeltaX,E.wheelDeltaY);var M=G.y!==0?Math.abs(G.y/k):0;if(ea&&M!==0){var Z=o(ea.x-ia.offsetLeft,ea.y-ia.offsetTop);F("wheelZoom",Z,Math.pow(2,G.y>0?M:-M))}g(E)}}s=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,
pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},s);var ga=false,ma=0,ja=T5.getConfig(),U=e(),V=e(),$=e(),ya=e(),fa=null,aa=o(),la=o(),ca=null,oa=false,ra=0,O=[],ea=o(),sa=false,qa,ha,va=0,xa=0,ia=s.element,ta=s.observable,na=typeof FlashCanvas!=="undefined",pa={supportsTouch:N,addListeners:function(E){O.push(E)},decoupleListeners:function(E){for(var G=0;E&&G<O.length;G++)if(O[G].listenerId===E){O.splice(G,1);break}},release:function(){ja.unbindEvent(N?"touchstart":
"mousedown",H,false);ja.unbindEvent(N?"touchmove":"mousemove",Y,false);ja.unbindEvent(N?"touchend":"mouseup",T,false);if(!N){window.removeEventListener("mousewheel",da,false);window.removeEventListener("DOMMouseScroll",da,false)}},inertiaEnable:function(E,G){sa=true;qa=E;ha=G?Math.min(G.width,G.height):500},inertiaDisable:function(){sa=false}};if(typeof N==="undefined")N=T5.getConfig().supportsTouch;ja.bindEvent(N?"touchstart":"mousedown",H,false);ja.bindEvent(N?"touchmove":"mousemove",Y,false);ja.bindEvent(N?
"touchend":"mouseup",T,false);if(!N){ja.bindEvent("mousewheel",da,window);ja.bindEvent("DOMMouseScroll",da,window)}return pa},S=[];return{capture:function(s,p){if(!s)throw Error("Unable to capture touch of null element");if(!s.id)s.id="touchable_"+D++;var r=S[s.id];if(!r){r=new L(COG.extend({element:s},p));S[s.id]=r}if(p){p.listenerId&&r.decoupleListeners(p.listenerId);p.listenerId=++K;r.addListeners(p)}return r},release:function(s){if(s&&s.id&&S[s.id]){S[s.id].release();delete S[s.id]}}}}();
T5=function(){var l=function(){function a(b,o){return g(b.x-o.x,b.y-o.y)}function e(b,o){if(!o)o=b.length;if(o<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var f={edges:Array(o-1),accrued:Array(o-1),total:0},k=0;k<o-1;k++){var h=a(b[k],b[k+1]);f.edges[k]=Math.sqrt(h.x*h.x+h.y*h.y);f.accrued[k]=f.total+f.edges[k];f.total+=f.edges[k]}return f}function g(b,o){return{x:b?b:0,y:o?o:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,o=0,f=arguments.length;f--;){b+=arguments[f].x;o+=arguments[f].y}return g(b,o)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?g(b.x,b.y):null},diff:a,distance:function(b,o){return e(b,o).total},edges:e,equals:function(b,o){return b.x===o.x&&b.y===o.y},extendBy:function(b,o,f){return g(b.x-Math.cos(o)*f,b.y-Math.sin(o)*f)},floor:function(b){for(var o=Array(b.length),f=b.length;f--;)o[f]=g(~~b[f].x,~~b[f].y);return o},getRect:function(b){for(var o,f,k,
h,q=b.length;q--;){var t=b[q];o=typeof o==="undefined"||t.x<o?t.x:o;f=typeof f==="undefined"||t.y<f?t.y:f;k=typeof k==="undefined"||t.x>k?t.x:k;h=typeof h==="undefined"||t.y>h?t.y:h}return m.init(o,f,h,h)},init:g,invert:function(b){return g(-b.x,-b.y)},min:function(b,o){return g(b.x<o.x?b.x:o.x,b.y<o.y?b.y:o.y)},max:function(b,o){return g(b.x>o.x?b.x:o.x,b.y>o.y?b.y:o.y)},offset:function(b,o,f){return g(b.x+o,b.y+(f?f:o))},simplify:function(b,o){if(!b)return null;o=o?o:l.VECTOR_SIMPLIFICATION;for(var f=
[],k=null,h=b.length;h--;){var q=b[h];if(include=!k||h===0||Math.abs(q.x-k.x)+Math.abs(q.y-k.y)>o){f.unshift(q);k=q}}return f},theta:function(b,o,f){f=Math.asin((b.y-o.y)/f);return b.x>o.x?f:Math.PI-f}}}(),n=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),m=function(){function a(g){return e(g.x1,g.y1,g.x2,g.y2)}function e(g,b,o,f){g=g?g:0;b=b?b:0;o=typeof o!=="undefined"?o:g;f=typeof f!=="undefined "?f:f;return{x1:g,y1:b,x2:o,y2:f,width:o-g,height:f-b}}return{center:function(g){return l.init(g.x1+
g.width/2,g.y1+g.height/2)},copy:a,diagonalSize:function(g){return Math.sqrt(g.width*g.width+g.height*g.height)},fromCenter:function(g,b,o,f){o=~~(o/2);f=~~(f/2);return e(g-o,b-f,g+o,b+f)},init:e,intersect:function(g,b){var o=e(Math.max(g.x1,b.x1),Math.max(g.y1,b.y1),Math.min(g.x2,b.x2),Math.min(g.y2,b.y2));return o.width>0&&o.height>0?o:null},union:function(g,b){if(g.width===0||g.height===0)return a(b);else if(b.width===0||b.height===0)return a(g);else{var o=e(Math.min(g.x1,b.x1),Math.min(g.y1,b.y1),
Math.max(g.x2,b.x2),Math.max(g.y2,b.y2));return o.width>0&&o.height>0?o:null}}}}(),d=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return l.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,height:e?e:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:l,XYRect:m,Vector:function(a,e){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return l.init(a,e)},V:COG.extend(l,n),D:d}}();
(function(){function l(){for(;y.length>0;){var u=y.shift();document.location=u}t=0}function n(u){for(var v=true,B=x.length;B--;)v=v&&u!=x[B];return v}function m(u,v){var B=[];for(var D in v)D&&B.push(D+"="+escape(v[D]));return"tile5://"+u+"/"+(B.length>0?"?"+B.join("&"):"")}function d(u,v){n(u)&&COG.Log.info("would push url: "+m(u,v))}function a(u,v){if(n(u)){y.push(m(u,v));t||(t=setTimeout(l,100))}}function e(u){return function(v,B,D){(D?D:u?document.body:document).addEventListener(v,B,false)}}function g(u){return function(v,
B,D){(D?D:u?document.body:document).removeEventListener(v,B,false)}}function b(u,v,B){(B?B:document).attachEvent("on"+u,v)}function o(u,v,B){(B?B:document).detachEvent("on"+u,v)}function f(){k={base:{name:"Unknown",bindEvent:e(),unbindEvent:g(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:d,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:o,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:e(true),unbindEvent:g(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};h=[k.froyo,k.android,k.ipod,k.iphone,k.ipad,k.ie]}var k=null,h=[],q=null,t=0,y=[],x=["view.wake","tile.loaded"];T5.getConfig=function(){k||f();if(!q){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var u=0;u<h.length;u++){var v=h[u];if(v.regex&&v.regex.test(navigator.userAgent)){q=T5.ex({},k.base,v);COG.Log.info("PLATFORM DETECTED AS: "+q.name);break}}if(!q){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
q=k.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return q}})();
T5.Dispatcher=function(){var l=[],n={execute:function(m){var d=n.findAction(m);d&&d.execute.apply(d,Array.prototype.slice.call(arguments,1))},findAction:function(m){for(var d=l.length;d--;)if(l[d].id==m)return l[d];return null},getRegisteredActions:function(){return[].concat(l)},getRegisteredActionIds:function(){for(var m=[],d=l.length;d--;)l[d].id&&m.push(l[d].id);return m},registerAction:function(m){m&&m.id&&l.push(m)},Action:function(m){m=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},m);var d={id:m.id,execute:function(){m.execute&&m.execute.apply(this,arguments)},getParam:function(a){return m[a]?m[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",d.id,m.title,m.icon)}};m.autoRegister&&n.registerAction(d);return d},Agent:function(m){m=COG.extend({name:"Untitled",translator:null,execute:null},m);var d={getName:function(){return m.name},getParam:function(a){return m[a]},getId:function(){return COG.toID(d.getName())},run:function(a,e){if(m.execute){var g=
m.translator?m.translator(a):a;m.execute.call(d,g,function(b,o){e&&e(b,o,g)})}}};return d},runAgents:function(m,d,a){for(var e=0;e<m.length;e++)m[e].run(d,a)}};return n}();
T5.Resources=function(){var l="",n={},m={getPath:function(d){return/^(file|https?|\/)/.test(d)?d:l+d},setBasePath:function(d){l=d},loadResource:function(d){d=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},d);var a=function(e){d.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){d.callback(e)})};d.cacheable&&n[d.filename]?a(n[d.filename]):COG.xhr({url:m.getPath(d.filename),dataType:d.dataType,success:function(e){if(d.cacheable)n[d.filename]=e;a(e)},error:function(e,g,b){COG.Log.error("error loading resource ["+
d.filename+"], error = "+b)}})},loadSnippet:function(d,a){/\.\w+$/.test(d)||(d+=".html");m.loadResource({filename:"snippets/"+d,callback:a,dataType:"html"})}};return m}();
T5.Images=function(){function l(){if(!t){var u=T5.getConfig().maxImageLoads;t=COG.Loopage.join({execute:function(v,B){if(!u||k.length<u){var D=f.shift();if(D){k[k.length]=D;D.image.onload=m;D.image.src=T5.Resources.getPath(D.url);D.requested=T5.ticks()}else B.trigger("complete")}},frequency:10});t.bind("complete",function(){t=null})}}function n(){y=true;try{var u=h.length/2>>0;if(u>0){h.sort(function(B,D){return B.created-D.created});for(var v=u;v--;)delete e[h[v].url];h.splice(0,u)}}finally{y=false}COG.say("imagecache.cleared")}
function m(){var u=b[this.id],v;if(u&&u.image.complete&&u.image.width>0){u.loaded=true;u.hitCount=1;for(v=k.length;v--;)if(k[v].image.src==this.src){k.splice(v,1);break}if(u.background||u.postProcess||u.drawBackground||u.customDraw)if(u.image){globalImageData=u;v=a(u.realSize?u.realSize.width:u.image.width,u.realSize?u.realSize.height:u.image.height);var B=v.getContext("2d"),D=u.offset?u.offset:T5.XY.init();u.background&&B.drawImage(u.background,0,0);u.drawBackground&&u.drawBackground(B);u.customDraw?
u.customDraw(B,u):B.drawImage(u.image,D.x,D.y);u.postProcess&&u.postProcess(B,u);u.image=v}for(v=u.callbacks.length;v--;)u.callbacks[v]&&u.callbacks[v](this,false);u.callbacks=[];h[h.length]={url:this.src,created:u.requested};delete b[this.id];l()}}function d(u,v,B){var D=e[u];if(D){D.hitCount++;D.image.complete&&D.image.width>0&&v?v(D.image,true):D.callbacks.push(v)}else{D=T5.ex({url:u,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[v]},B);D.image.id="resourceLoaderImage"+
o++;e[u]=D;b[D.image.id]=D;f[f.length]=D;l()}return D}function a(u,v){var B=document.createElement("canvas");B.width=u?u:0;B.height=v?v:0;if(typeof FlashCanvas!=="undefined"){B.id="tmpCanvas"+g++;B.style.cssText="position: absolute; top: -"+(v-1)+"px; left: -"+(u-1)+"px;";document.body.appendChild(B);FlashCanvas.initElement(B)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(B);return B}var e={},g=0,b={},o=0,f=[],k=[],h=[],q=0,t=null,y=false,x={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){k=[]},get:function(u,v,B){var D=null,K=null;y||(D=e[u]);if((K=D?D.image:null)&&(K.getContext||K.complete&&K.width>0))return K;else v&&d(u,v,B);return null},load:d,newCanvas:a,reset:function(){e={}},stats:function(){return{imageLoadingCount:k.length,queuedImageCount:f.length,imageCacheFullness:q}}};COG.Loopage.join({execute:function(u){for(var v=false,B=0,D=T5.getConfig();B<k.length;)if(u-k[B].requested>x.loadTimeout*1E3){k.splice(B,1);v=true}else B++;v&&l();if(D&&D.imageCacheMaxSize){q=
h.length*x.avgImageSize/D.imageCacheMaxSize;q>=1&&n()}},frequency:2E4});return x}();T5.Generator=function(){var l={};return{init:function(n,m){var d=l[n];if(!d)throw Error("Unable to locate requested generator: "+n);return new d(m)},register:function(n,m){l[n]=m},Template:function(){}}}();
T5.TimeLord=function(){var l=/^P(\d+Y)?(\d+M)?(\d+D)?$/,n=/^(\d+H)?(\d+M)?(\d+S)?$/,m=function(a,e){return{days:a?a:0,seconds:e?e:0}},d={8601:function(a){a=a.split("T");var e=null;e=null;var g=0,b=0;l.lastIndex=-1;e=l.exec(a[0]);g+=e[3]?parseInt(e[3].slice(0,-1),10):0;n.lastIndex=-1;e=n.exec(a[1]);b+=e[1]?parseInt(e[1].slice(0,-1),10)*3600:0;b+=e[2]?parseInt(e[2].slice(0,-1),10)*60:0;b+=e[3]?parseInt(e[3].slice(0,-1),10):0;return new m(g,b)}};return{Duration:m,addDuration:function(){for(var a=new m,
e=arguments.length;e--;){a.days+=arguments[e].days;a.seconds+=arguments[e].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,e){var g=e?d[e]:null;if(g)return g(a);COG.Log.warn("Could not find duration parser for specified format: "+e);return new m},formatDuration:function(a){var e,g,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){e=~~(a/3600);a-=e*3600}if(a>=60){g=Math.round(a/60);a-=g*60}if(e)b=b+e+(e>1?" hrs ":" hr ")+
(g?(g>10?g:"0"+g)+" min ":"");else if(g)b=b+g+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
T5.zoomable=function(l,n){function m(a,e){if(a&&d!==a){d=a;l.triggerAll("zoomLevelChange",d,e)}}n=T5.ex({initial:0,min:0,max:null,zoomAnimation:T5.easing("quad.out")},n);var d=n.initial;T5.ex(l,{getZoomLevel:function(){return d},setZoomLevel:m,zoomIn:function(){l.scale(2,T5.easing("sine.out"))||l.setZoomLevel(d+1)},zoomOut:function(){l.scale(0.5,T5.easing("sine.out"))||l.setZoomLevel(d-1)}});l.bind("scale",function(a,e,g){a=0;e=Math.sqrt(e);if(e<1)a=-(0.5/e);else if(e>1)a=e;m(d+a>>0,g)});l.bind("doubleTap",
function(a,e,g){l.scalable()&&l.animate(2,T5.D.getCenter(l.getDimensions()),T5.XY.init(g.x,g.y),n.zoomAnimation)})};
(function(){var l=Math.PI*2,n=Math.PI/2,m=Math.abs,d=Math.pow,a=Math.sin,e=Math.asin,g=Math.cos,b=1.70158,o={linear:function(f,k,h,q){return h*f/q+k},backin:function(f,k,h,q){return h*(f/=q)*f*((b+1)*f-b)+k},backout:function(f,k,h,q){return h*((f=f/q-1)*f*((b+1)*f+b)+1)+k},backinout:function(f,k,h,q){return(f/=q/2)<1?h/2*f*f*(((b*=1.525)+1)*f-b)+k:h/2*((f-=2)*f*(((b*=1.525)+1)*f+b)+2)+k},bouncein:function(f,k,h,q){return h-o.bounceout(q-f,0,h,q)+k},bounceout:function(f,k,h,q){return(f/=q)<1/2.75?
h*7.5625*f*f+k:f<2/2.75?h*(7.5625*(f-=1.5/2.75)*f+0.75)+k:f<2.5/2.75?h*(7.5625*(f-=2.25/2.75)*f+0.9375)+k:h*(7.5625*(f-=2.625/2.75)*f+0.984375)+k},bounceinout:function(f,k,h,q){return f<q/2?o.bouncein(f*2,0,h,q)/2+k:o.bounceout(f*2-q,0,h,q)/2+h/2+k},cubicin:function(f,k,h,q){return h*(f/=q)*f*f+k},cubicout:function(f,k,h,q){return h*((f=f/q-1)*f*f+1)+k},cubicinout:function(f,k,h,q){if((f/=q/2)<1)return h/2*f*f*f+k;return h/2*((f-=2)*f*f+2)+k},elasticin:function(f,k,h,q,t,y){if(f==0)return k;if((f/=
q)==1)return k+h;y||(y=q*0.3);if(!t||t<m(h)){t=h;h=y/4}else h=y/l*e(h/t);return-(t*d(2,10*(f-=1))*a((f*q-h)*l/y))+k},elasticout:function(f,k,h,q,t,y){var x;if(f==0)return k;if((f/=q)==1)return k+h;y||(y=q*0.3);if(!t||t<m(h)){t=h;x=y/4}else x=y/l*e(h/t);return t*d(2,-10*f)*a((f*q-x)*l/y)+h+k},elasticinout:function(f,k,h,q,t,y){var x;if(f==0)return k;if((f/=q/2)==2)return k+h;y||(y=q*0.3*1.5);if(!t||t<m(h)){t=h;x=y/4}else x=y/l*e(h/t);if(f<1)return-0.5*t*d(2,10*(f-=1))*a((f*q-x)*l/y)+k;return t*d(2,
-10*(f-=1))*a((f*q-x)*l/y)*0.5+h+k},quadin:function(f,k,h,q){return h*(f/=q)*f+k},quadout:function(f,k,h,q){return-h*(f/=q)*(f-2)+k},quadinout:function(f,k,h,q){if((f/=q/2)<1)return h/2*f*f+k;return-h/2*(--f*(f-2)-1)+k},sinein:function(f,k,h,q){return-h*g(f/q*n)+h+k},sineout:function(f,k,h,q){return h*a(f/q*n)+k},sineinout:function(f,k,h,q){return-h/2*(g(Math.PI*f/q)-1)+k}};T5.easing=function(f){return o[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(f,k){o[f.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=k}})();
T5.Tween=function(l){l=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},l);var n=T5.ticks(),m=[],d=false,a=0,e=0,g={cancelOnInteract:l.cancelOnInteract,isComplete:function(){return d},triggerComplete:function(b){l.complete&&l.complete(b)},update:function(b){try{var o=l.tweenFn(b-n,a,e,l.duration);if(l.target)l.target[l.property]=o;for(var f=m.length;f--;)m[f](o,void 0);if(d=n+l.duration<=b){if(l.target)l.target[l.property]=
l.tweenFn(l.duration,a,e,l.duration);for(var k=m.length;k--;)m[k](o,true)}}catch(h){COG.Log.exception(h)}},requestUpdates:function(b){m.push(b)}};a=l.target&&l.property&&l.target[l.property]?l.target[l.property]:l.startValue;if(typeof l.endValue!=="undefined")e=l.endValue-a;if(e==0)d=true;T5.wakeTweens();return g};
(function(){function l(a){if(d)return n.length;d=true;try{for(var e=0;e<n.length;)if(n[e].isComplete()){n[e].triggerComplete(false);n.splice(e,1)}else{n[e].update(a);e++}}finally{d=false}n.length===0&&m.trigger("complete");return n.length}var n=[],m=null,d=false;T5.tweenValue=function(a,e,g,b,o){a=new T5.Tween({startValue:a,endValue:e,tweenFn:g,complete:b,duration:o});n.push(a);return a};T5.tween=function(a,e,g,b,o,f){a=new T5.Tween({target:a,property:e,endValue:g,tweenFn:b,duration:f,complete:o});
n.push(a);return a};T5.tweenVector=function(a,e,g,b,o,f){var k=[];if(a){var h=a.x==e,q=a.y==g;h||k.push(T5.tween(a,"x",e,b,function(){(h=true)&&q&&o()},f));q||k.push(T5.tween(a,"y",g,b,function(){q=true;h&&q&&o()},f))}return k};T5.cancelAnimation=function(a){if(!d){d=true;try{for(var e=0;e<n.length;)if(!a||a(n[e])){n[e].triggerComplete(true);n.splice(e,1)}else e++}finally{d=false}}};T5.isTweening=function(){return n.length>0};T5.wakeTweens=function(){if(!m){m=COG.Loopage.join({execute:l,frequency:20});
m.bind("complete",function(){m=null})}}})();(function(){var l={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var n=0,m=arguments.length;m--;){var d=l[arguments[m].toUpperCase()];if(d)n|=d}return n}})();
T5.ViewLayer=function(l){l=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},l);var n=null,m=false,d=false,a=l.supportFastDraw,e=l.id,g=T5.viewState("ACTIVE"),b=l.validStates,o=0,f=0,k=T5.ex({addToView:function(h){h.setLayer(e,k)},shouldDraw:function(h,q,t){h=(h&b)!==0&&(m?a:true);return h=d||t||o!==q.x||f!==q.y},cycle:function(){},draw:function(){},remove:function(){k.trigger("remove",k)},changed:function(){d=
true;k.trigger("changed",k);n&&n.trigger("invalidate")},getId:function(){return e},setId:function(h){e=h},getParent:function(){return n},setParent:function(h){m=(n=h)?n.fastDraw&&displayState!==g:false;k.trigger("parentChange",n)}},l);COG.observable(k);k.bind("drawComplete",function(h,q){d=false;o=q.x;f=q.y});k.bind("resync",function(h,q){if(q.syncXY){if(k.minXY){q.syncXY(k.minXY);COG.Log.info("resyncing min",k.minXY)}if(k.maxXY){q.syncXY(k.maxXY);COG.Log.info("resyncing max",k.maxXY)}}});return k};
T5.View=function(l){function n(z,C,I,P){G=na;B();if(P&&l.inertia){ga=true;f(s+C,p+I,l.panAnimationEasing,l.panAnimationDuration)}else P||f(s+C,p+I)}function m(){G=ta;ga=false;COG.Loopage.join({execute:B,after:50,single:true})}function d(z,C){aa=M(z);la=M(C);var I=Z(aa),P=Z(la);ha=ka(aa);T=ka(la);O=aa&&I!==0?P/I:1}function a(z,C,I){d(C,I);if(fa=O!==1){G=pa;B()}}function e(z,C,I,P){d(C,I);if(l.adjustScaleFactor){O=l.adjustScaleFactor(O);COG.Log.info("scale factor adjusted to: "+O)}if(P<l.pinchZoomAnimateTrigger){q(sa,
O,ha,t(),T5.easing("sine.out"),function(){b();O=1},300);O=sa}else{b();O=1}}function g(z,C,I){Q.zoom(C,Math.min(Math.pow(2,Math.round(Math.log(I))),8),500)}function b(){var z=aa?t():T;O=Math.round(O*10)/10;fa=false;for(var C=K.length;C--;)K[C].trigger("scale",O,z);Q.trigger("scale",O,z);G=ta;B()}function o(){clearTimeout(ra);ra=setTimeout(k,50)}function f(z,C,I,P,R){function W(){ba+=1;if(ba>=2){m(0,0);R&&R()}}var ba=0;if(V){z=z<V.x?V.x:z;C=C<V.y?V.y:C}if($){z=z>$.x?$.x:z;C=C>$.y?$.y:C}if(I){z=T5.tweenValue(s,
z,I,W,P);C=T5.tweenValue(p,C,I,W,P);z.cancelOnInteract=true;z.requestUpdates(function(X){s=X;ga=true;B()});C.cancelOnInteract=true;C.requestUpdates(function(X){p=X;ga=true;B()})}else{s=z;p=C}}function k(){var z;if(L){COG.Touch.release(L);if(l.autoSize&&L.parentNode){z=L.parentNode.getBoundingClientRect();if(z.height!==0&&z.width!==0){L.height=z.height;L.width=z.width}}try{if(!L.id)L.id=l.id+"_canvas";S=L.getContext("2d");S.clearRect(0,0,L.width,L.height)}catch(C){COG.Log.exception(C);throw Error("Could not initialise canvas on specified view element");
}ia=COG.Touch.capture(L,{observable:Q});if(H.height!==L.height||H.width!==L.width){H=T5.D.init(L.width,L.height);Q.trigger("resize",L.width,L.height);for(z=N;z--;)K[z].trigger("resize",L.width,L.height)}l.inertia&&ia.inertiaEnable(l.panAnimationDuration,H);for(z=N;z--;)K[z].trigger("contextChanged",S);v()}}function h(z,C){C.setId(z);C.added=T5.ticks();C.bind("remove",function(){Q.removeLayer(z)});C.trigger("contextChanged",S);C.setParent(Q);K.push(C);K.sort(function(I,P){var R=P.zindex-I.zindex;if(R===
0)R=P.added-I.added;return R});N=K.length;return C}function q(z,C,I,P,R,W,ba){function X(){W&&W();b();O=1;qa=null}fa=true;ha=T5.XY.offset(I,w.x1,w.y1);T=T5.XY.offset(P,w.x1,w.y1);aa=null;COG.Log.info("zoom from: ",ha);COG.Log.info("zoom to:   ",T);if(R)T5.tweenValue(0,C-z,R,X,ba?ba:1E3).requestUpdates(function(ua){qa=ua/(C-z);O=z+ua;G=pa;B();Q.trigger("animate")});else{O=C;X()}}function t(){var z=T5.D.getCenter(H),C=T5.XY.distance([T,z]);z=T5.XY.theta(T,z,C);var I=T5.XY.diff(ha,T);z=T5.XY.extendBy(T,
z,C/O);z.x+=I.x;z.y+=I.y;return z}function y(){D("idle",Q);da=true;ma=0}function x(z,C,I,P,R){var W=(C&pa)!==0,ba=T5.XYRect.copy(I),X,ua=0;z.clearRect(0,0,L.width,L.height);if(A||W)A=false;if(W){T5.D.getCenter(H);var wa=(qa?qa:1)/2,za=T5.XY.diff(ha,T);if(aa){U.x=T.x+za.x;U.y=T.y+za.y}else{U.x=T.x-za.x*wa;U.y=T.y-za.y*wa}}z.save();try{sa=O;if(W){W=1/O;wa=(W-0.5)/0.5;ba=T5.XYRect.fromCenter(T.x-(T.x-s)*wa,T.y-(T.y-p)*wa,~~(ba.width*W),~~(ba.height*W));z.scale(O,O)}z.translate(-ba.x1,-ba.y1);$=V=null;
for(ua=N;ua--;){X=K[ua];if(X.shouldDraw(C,I,P)){var Aa=X.style,Ba=Aa?T5.Style.apply(z,Aa):null;if(X.minXY)V=V?T5.XY.min(V,X.minXY):T5.XY.copy(X.minXY);if(X.maxXY)$=$?T5.XY.max($,X.maxXY):T5.XY.copy(X.maxXY);X.draw(z,ba,C,Q,P,R);Ba&&T5.Style.apply(z,Ba);X.trigger("drawComplete",ba,R)}}}finally{z.restore()}Q.trigger("drawComplete",I,R);COG.Log.trace("draw complete",R)}function u(z,C){var I=false,P=ca?ca:ga?na:G,R=!ga&&(P===pa||P===na),W=oa||P===na||P===pa||T5.isTweening();r=T5.XY.init(s>>0,p>>0);w=
T5.XYRect.fromCenter(r.x,r.y,H.width,H.height);if(R){T5.cancelAnimation(function(ba){return ba.cancelOnInteract});da=false;if(ma!==0){clearTimeout(ma);ma=0}}for(R=N;R--;){if(K[R].animated)G|=E;I=K[R].cycle(z,w,G,W)||I}W=W||(G&E)!==0;if(I=I||W||O!==1&&O!==ea){x(S,P,w,W,z);ea=O;oa=false}if(!I&&Y===0&&!va){if(!da&&ma===0)ma=setTimeout(y,500);C.trigger("complete")}Y=0;COG.Log.trace("Completed draw cycle",z)}function v(){oa=true;B()}function B(){Y+=1;if(!F){F=COG.Loopage.join({execute:u,frequency:xa});
F.bind("complete",function(){F=null})}}function D(){Q.trigger.apply(null,arguments);for(var z=K.length;z--;)K[z].trigger.apply(null,arguments)}l=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},l);var K=[],N=0,L=document.getElementById(l.container),S=null,s=0,p=0,r=null,w=null,A=false,F=null,J=1,H=T5.D.init(),
Y=0,T=null,da=false,ga=false,ma=0,ja=0,U=T5.XY.init(),V=null,$=null,ya=0,fa=false,aa=null,la=null,ca=null,oa=false,ra=0,O=1,ea=0,sa=1,qa=null,ha=null,va=typeof FlashCanvas!=="undefined",xa=~~(1E3/l.fps),ia=null,ta=T5.viewState("ACTIVE"),na=T5.viewState("PAN"),pa=T5.viewState("ZOOM"),E=T5.viewState("ANIMATING"),G=ta,M=T5.XY.getRect,Z=T5.XYRect.diagonalSize,ka=T5.XYRect.center,Q={id:l.id,deviceScaling:J,fastDraw:l.fastDraw||T5.getConfig().requireFastDraw,animate:function(z,C,I,P,R){q(O,z,C,I,P,R)},
centerOn:function(z){s=z.x-L.width/2;p=z.y-L.height/2},getDimensions:function(){return H},getZoomCenter:function(){return U},getLayer:function(z){for(var C=0;C<N;C++)if(K[C].getId()==z)return K[C];return null},setLayer:function(z,C){for(var I=0;I<N;I++)if(K[I].getId()===z){K.splice(I,1);break}C&&h(z,C);v();return C},eachLayer:function(z){for(var C=N;C--;)z(K[C])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");A=true;v()},invalidate:v,resize:function(z,C){if(L){l.autoSize=
false;L.width=z;L.height=C;k();Q.trigger("resize",L.width,L.height)}},scale:function(z,C,I,P,R){P||(P=T5.D.getCenter(H));R||(R=T5.D.getCenter(H));Q.animate(z,P,R,C,I);return Q},triggerAll:D,removeLayer:function(z){a:{for(var C=N;C--;)if(K[C].getId()==z){z=C;break a}z=-1}if(z>=0&&z<N){COG.say("layer.removed",{layer:K[z]});K.splice(z,1);v()}N=K.length},stateOverride:function(z){ca=z},getOffset:function(){return r?r:T5.XY.init(s,p)},getViewRect:function(){return w?w:T5.XYRect.fromCenter(s,p,H.width,
H.height)},updateOffset:f,pan:function(z,C,I,P,R){f(s+z,p+C,I,P,R)},zoom:function(z,C,I){ga=false;O=C;fa=O!==1;ha=T5.D.getCenter(H);T=T5.XY.offset(O>1?T5.XY.copy(z):T5.D.getCenter(H),w.x1,w.y1);aa=null;clearTimeout(ja);if(fa){G=pa;B();if(I)ja=setTimeout(function(){b();O=1},parseInt(I,10))}}};J=T5.getConfig().getScaling();Q.markers=h("markers",new T5.MarkerLayer);COG.observable(Q);Q.bind("wake",B);Q.bind("invalidate",v);if(l.pannable){Q.bind("pan",n);Q.bind("panEnd",m);Q.bind("inertiaCancel",function(){ga=
false;B()})}if(l.scalable){Q.bind("pinchZoom",a);Q.bind("pinchZoomEnd",e);Q.bind("wheelZoom",g)}Q.bind("tap",function(z,C,I){for(var P=T5.XY.offset(I,s,p),R=K.length;R--;)z.cancel=z.cancel||K[R].trigger("tap",C,I,P).cancel});Q.bind("resync",function(){$=V=null});COG.configurable(Q,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(l,null,{container:function(z,C){L=document.getElementById(C);k()},rotation:function(z,C){ya=C}}),true);k();l.autoSize&&window.addEventListener("resize",
o,false);return Q};
T5.PathLayer=function(l){l=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},l);var n=false,m=[],d=null,a=[],e=null,g=0,b=[],o=T5.ex(new T5.ViewLayer(l),{getAnimation:function(f,k,h,q){var t="pathAnimation"+g++;b.push(t);return new T5.AnimatedPathLayer({id:t,path:m,zindex:l.zindex+1,easing:f?f:T5.easing("sine.inout"),duration:k?k:5E3,drawIndicator:h,autoCenter:q?q:false})},cycle:function(f,k,h,q){return q},draw:function(f){var k,h=m.length;f.save();try{T5.Style.apply(f,l.style);if(h>0){f.beginPath();
f.moveTo(m[h-1].x,m[h-1].y);for(k=h;k--;)f.lineTo(m[k].x,m[k].y);f.stroke();if(d){f.fillStyle=l.waypointFillStyle;for(k=d.length;k--;){f.beginPath();f.arc(d[k].x,d[k].y,2,0,Math.PI*2,false);f.stroke();f.fill()}}}}finally{f.restore()}n=false},updateCoordinates:function(f,k){a=f;e=k;var h=o.getParent();if(h&&h.syncXY){h.syncXY(a);e&&h.syncXY(e);o.trigger("tidy")}}});o.bind("tidy",function(){m=T5.XY.simplify(a,l.pixelGeneralization);d=T5.XY.simplify(e,l.pixelGeneralization);n=true;o.changed()});return o};
T5.ShapeLayer=function(l){function n(g){for(var b=d.length;b--;)d[b].resync(g);d.sort(function(o,f){var k=f.xy.y-o.xy.y;if(k===0)k=f.xy.x-o.xy.y;return k});a=true;e.changed()}function m(g,b){b.syncXY&&n(b)}l=T5.ex({zindex:80},l);var d=[],a=false,e=T5.ex(new T5.ViewLayer(l),{add:function(g){d[d.length]=g},each:function(g){for(var b=d.length;b--;)g(d[b])},cycle:function(){return a},draw:function(g,b,o){var f=b.x1,k=b.y1,h=b.width;b=b.height;for(var q=d.length;q--;){var t=d[q].style;t=t?T5.Style.apply(g,
t):null;d[q].draw(g,f,k,h,b,o);t&&T5.Style.apply(g,t)}a=false}});e.bind("parentChange",m);e.bind("resync",m);return e};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(l){l=T5.ex({style:null,properties:{}},l);return T5.ex(l,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(l,n){n=T5.ex({size:4},n);var m=T5.XY.init(),d=T5.ex(n,{draw:function(a){a.beginPath();a.arc(m.x,m.y,d.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([l]);m=T5.XY.floor([l])[0]}});COG.Log.info("created arc = ",l);return d};
T5.Poly=function(l,n){n=T5.ex({fill:false,simplify:false},n);var m=false,d=n.fill,a=n.simplify,e=T5.viewState("ZOOM"),g=[],b=T5.ex(new T5.Shape(n),{draw:function(o,f,k,h,q,t){if(m){f=true;k=(t&e)!==0;o.beginPath();for(t=g.length;t--;){k=g[t].x;h=g[t].y;if(f){o.moveTo(k,h);f=false}else o.lineTo(k,h);k=true}if(k){d&&o.fill();o.stroke()}}},resync:function(o){b.xy=o.syncXY(l);g=T5.XY.floor(a?T5.XY.simplify(l):l)}});m=l&&l.length>=2;return b};
T5.AnimatedPathLayer=function(l){function n(b,o,f){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(f.x,f.y,4,0,Math.PI*2,false);b.stroke();b.fill()}l=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},l);var m=T5.XY.edges(l.path),d,a=null,e=0;T5.tweenValue(0,m.total,l.easing,function(){g.remove()},l.duration).requestUpdates(function(b,o){e=b;o&&g.remove()});var g=
T5.ex(new T5.ViewLayer(l),{cycle:function(){for(var b=0;b<m.accrued.length&&m.accrued[b]<e;)b++;a=null;if(b<l.path.length-1){var o=e-(b>0?m.accrued[b-1]:0),f=l.path[b];d=T5.XY.theta(f,l.path[b+1],m.edges[b]);a=T5.XY.extendBy(f,d,o);if(l.autoCenter)(b=g.getParent())&&b.centerOn(a)}return a},draw:function(b,o){if(a)(l.drawIndicator?l.drawIndicator:n)(b,o,T5.XY.init(a.x,a.y),d)}});return g};
T5.Marker=function(l){function n(o,f,k,h){d=o;a=f;e=k;g=h}l=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},l);var m=false,d=0,a=0,e=0,g=0,b=T5.ex(l,{isNew:true,isAnimating:function(){return m},draw:function(o,f,k,h,q){if(b.isNew&&l.tweenIn){var t=b.xy.y;b.xy.y=f.y1-20;m=true;T5.tween(b.xy,"y",t,l.tweenIn,function(){b.xy.y=t;m=false},l.animationSpeed?l.animationSpeed:250+Math.random()*500)}b.drawMarker(o,f,b.xy.x,b.xy.y,k,h,q);b.isNew=false},drawMarker:function(o,f,k,h){o.beginPath();
o.arc(k,h,4,0,Math.PI*2,false);o.fill();n(k-4,h-4,8,8)},hitTest:function(o,f){return o>=d&&o<=d+e&&f>=a&&f<=a+g},updateBounds:n});COG.observable(b);return b};
T5.ImageMarker=function(l){l=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},l);var n=l.imageAnchor?T5.XY.invert(l.imageAnchor):null,m=T5.ex(new T5.Marker(l),{drawMarker:function(d,a,e,g){if((a=m.isAnimating()&&m.animatingImage?m.animatingImage:m.image)&&a.complete&&a.width>0){n||(n=T5.XY.init(-a.width>>1,-a.height>>1));var b=m.scale,o=e+~~(n.x*b),f=g+~~(n.y*b),k=~~(a.width*b),h=~~(a.height*b);m.updateBounds(o,f,k,k);if(m.rotation||
m.opacity!==1){d.save();try{d.globalAlpha=m.opacity;d.translate(e,g);d.rotate(m.rotation);d.drawImage(a,n.x*b,n.y*b,k,h)}finally{d.restore()}}else d.drawImage(a,o,f,k,h)}}});if(!m.image)m.image=T5.Images.get(l.imageUrl,function(d){COG.Log.info("updating marker image to: "+d.src);m.image=d});if(!m.animatingImage)m.animatingImage=T5.Images.get(l.animatingImageUrl,function(d){m.animatingImage=d});return m};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(l){function n(){e.changed();e.trigger("markerUpdate",d)}function m(){var g=e.getParent();if(g&&g.syncXY)for(var b=d.length;b--;)g.syncXY([d[b].xy])}l=T5.ex({zindex:100,style:"basic"},l);var d=[],a=false,e=T5.ex(new T5.ViewLayer(l),{cycle:function(){return a},draw:function(g,b,o,f){a=false;for(var k=d.length;k--;){d[k].draw(g,b,o,e,f);a=a||d[k].isAnimating()}return a?1:0},add:function(g){if(g&&typeof g.length!=="undefined")for(var b=g.length;b--;){if(g[b])d[d.length]=g[b]}else if(g)d[d.length]=
g;n()},clear:function(g){if(g)for(var b=0;b<d.length;b++)g(d[b])&&d.splice(b,1);else d=[];n()},find:function(g){for(var b=[],o=d.length;o--;)if(!g||g(d[o]))b[b.length]=d[o];return b}});e.bind("tap",function(g,b,o){for(var f=[],k=o.x,h=o.y,q=d.length;q--;)if(d[q].hitTest(k,h))f[f.length]=d[q];if(f.length>0)g.cancel=e.trigger("markerTap",b,o,f).cancel});e.bind("parentChange",m);e.bind("changed",m);return e};
T5.ImageLayer=function(l,n){function m(k){a&&a.run(k,function(h){e=h;(h=f.getParent())&&h.trigger("invalidate")})}function d(){var k=f.getParent();k&&k.trigger("invalidate")}n=T5.ex({imageLoadArgs:{}},n);var a=l?T5.Generator.init(l,n):null,e=null,g=T5.XYRect.init(),b=n.imageLoadArgs,o=T5.viewState("ZOOM"),f=T5.ex(new T5.ViewLayer(n),{changeGenerator:function(k,h){a=T5.Generator.init(k,T5.ex({},n,h));a.bindToView(f.getParent());e=null;m(g)},cycle:function(k,h){m(h)},draw:function(k,h,q){k.save();try{k.strokeStyle=
"#555";k.beginPath();if(e)for(var t=e.length;t--;){var y=e[t].x,x=e[t].y,u=T5.XYRect.init(e[t].x,e[t].y,e[t].x+e[t].width,e[t].y+e[t].height);T5.XYRect.intersect(h,u)&&f.drawImage(k,h,y,x,e[t],q)}k.clip()}finally{k.restore()}g=T5.XYRect.copy(h)},drawImage:function(k,h,q,t,y,x){if(h=T5.Images.get(y.url,(x&o)===0?d:null,b)){k.rect(q,t,y.width,y.height);k.drawImage(h,q,t,h.width,h.height)}}});f.bind("idle",function(){m(g)});f.bind("parentChange",function(k,h){a&&a.bindToView(h)});f.bind("tap",function(k,
h,q,t){k=[];var y=t.x,x=t.y,u,v;if(e)for(var B=e.length;B--;){u=e[B];if(v=y>=u.x&&y<=u.x+u.width&&x>=u.y&&x<=u.y+u.height)k[k.length]=u}k.length>0&&f.trigger("tapImage",k,h,q,t)});return f};
T5.Style=function(){function l(g,b){a[g]=m(b);return g}function n(g){for(var b in g)l(b,g[b])}function m(g){function b(h){var q=g[h];typeof q!=="undefined"&&f.push(function(t){t[h]=q})}function o(){f=[];for(var h in g)b(h)}g=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var f=[],k={applyToContext:function(h){for(var q=f.length;q--;)f[q](h)},update:function(h,
q){g[h]=q;o()}};o();return k}var d={},a={},e={apply:function(g,b){var o=a[b]?a[b]:a.basic,f;if(g&&g.canvas){f=d[g.canvas.id];d[g.canvas.id]=b}o.applyToContext(g);return f},define:l,defineMany:n,get:function(g){return a[g]},init:m,load:function(g){COG.jsonp(g,function(b){T5.resetStyles(b)})}};n({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return e}();
T5.Tiling=function(){return{tileSize:256,init:function(l,n,m,d,a){return T5.ex({x:l,y:n,width:m,height:d},a)}}}();
T5.TileGenerator=function(l){function n(t,y,x,u){function v(){if(q.initTileCreator){g=true;q.initTileCreator(t,y,x,u)}}q.prepTileCreator?q.prepTileCreator(t,y,x,v):v()}function m(t,y){for(var x=~~((t.x1-e.x)/b),u=~~((t.y1-e.y)/o),v=[],B=-k;B<k;B++)for(var D=-h;D<h;D++){var K=f(x+B,u+D);if(K)v[v.length]=K}y&&y(v);a=T5.XYRect.copy(t)}l=T5.ex({tileWidth:256,tileHeight:256},l);var d=null,a=null,e=T5.XY.init(),g=false,b=l.tileWidth,o=l.tileHeight,f=null,k=0,h=0,q={bindToView:function(t){COG.Log.info("initializing generator");
d=t;q.trigger("bindView",t)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){f=null;g=false;a=null},run:function(t,y){if(!a||Math.abs(t.x1-a.x1)>b||Math.abs(t.y1-a.y1)>o){if(!f&&!g||q.requireRefresh()){COG.Log.info("generating tiles, view rect = ",t);e=T5.XY.init(t.x1,t.y1);k=Math.ceil(t.width/b)+1;h=Math.ceil(t.height/o)+1;n(b,o,q.getTileCreatorArgs?q.getTileCreatorArgs(d):{},function(x){f=x;g=false;m(t,y)})}f&&m(t,y)}}};
COG.observable(q);q.bind("update",function(){COG.Log.info("captured generator update");a=null});return q};
T5.Geo=function(){function l(s,p){var r=null;for(var w in L)if(p){if(w==p&&L[w][s]){r=L[w];break}}else if(L[w][s]){r=L[w];break}return r}function n(s,p){var r=h*Math.sin(s);return a-2*Math.atan(p*Math.pow((1-r)/(1+r),h/2))}function m(s,p,r,w){var A=0;s=s.toUpperCase();for(var F in w){var J=p[F];if(J){var H=r[F];J=H?H(s,J):COG.wordExists(s,J)?1:0;A+=J*w[F]}}return A}var d=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],a=Math.PI/2,e=Math.PI*2,g=-a,b=a,o=
-e,f=Math.PI/180,k=180/Math.PI,h=0.08181919084262157,q=null,t={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},y={VECTORIZE_PER_CYCLE:500},x={getEngine:function(s){for(var p=null,r=1;!p&&r<arguments.length;r++)p=l(s,arguments[r]);p=p?p:l(s);if(!p)throw Error("Unable to find GEO engine with "+s+" capability");return p},rankGeocodeResponses:function(s,p,r){var w=[],A=S.AddressCompareFns;if(r&&r.compareFns)A=T5.ex({},A,r.compareFns);for(r=0;r<p.length;r++)w.push(new S.GeoSearchResult({caption:N.toString(p[r]),
data:p[r],pos:p[r].pos,matchWeight:m(s,p[r],A,S.GeocodeFieldWeights)}));w.sort(function(F,J){return J.matchWeight-F.matchWeight});return w},distanceToString:function(s){if(s>1E3)return~~(s/10)/100+" km";return s?s+" m":""},dist2rad:function(s){return s/6371},lat2pix:function(s){s=parseFloat(s)*f;s=Math.sin(s);var p=h*s;return Math.log((1+s)/(1-s)*Math.pow((1-p)/(1+p),h))/2},lon2pix:function(s){return parseFloat(s)*f},pix2lon:function(s){return S.normalizeLon(s)*k},pix2lat:function(s){s=Math.pow(Math.E,
-s);for(var p=a-2*Math.atan(s),r=n(p,s),w=0;w<12&&Math.abs(p-r)>1.0E-7;){p=r;r=n(p,s);w++}return r*k},normalizeLon:function(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s},radsPerPixel:function(s){return 2*Math.PI/(256<<s)}},u=function(s,p){return{lat:parseFloat(s?s:0),lon:parseFloat(p?p:0)}},v=function(s,p){return{min:D.parse(s),max:D.parse(p)}},B=function(s){return s=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},s)},D=function(){var s={calcDistance:function(p,
r){if(s.empty(p)||s.empty(r))return 0;var w=(r.lat-p.lat)*f/2,A=(r.lon-p.lon)*f/2;w=Math.sin(w)*Math.sin(w)+Math.cos(p.lat*f)*Math.cos(r.lat*f)*Math.sin(A)*Math.sin(A);return 6371*2*Math.atan2(Math.sqrt(w),Math.sqrt(1-w))},copy:function(p){return p?new u(p.lat,p.lon):null},empty:function(p){return!p||p.lat===0&&p.lon===0},equal:function(p,r){return p&&r&&p.lat==r.lat&&p.lon==r.lon},inArray:function(p,r){for(var w=D.equal,A=r.length;A--;)if(w(p,r[A]))return true;return false},inBounds:function(p,r){var w=
!(D.empty(p)||D.empty(r));return w=(w=w&&p.lat>=r.min.lat&&p.lat<=r.max.lat)&&p.lon>=r.min.lon&&p.lon<=r.max.lon},offset:function(p,r,w){var A=p.lat*f;r=A+r/6371;for(p=p.lon*f+Math.asin(Math.sin(w/6371)/Math.cos(A));r<g;)r+=Math.PI;for(;r>b;)r-=Math.PI;for(;p>e;)p-=2*Math.PI;return new u(r*k,p*k)},parse:function(p){if(p)if(typeof p.lat!=="undefined")return s.copy(p);else{if(p.split)for(var r=[" ",","],w=0;w<r.length;w++){var A=p.split(r[w]);if(A.length===2)return new u(A[0],A[1])}}else return new u;
return null},parseArray:function(p){var r=p.length,w=Array(r);for(r=r;r--;)w[r]=s.parse(p[r]);return w},fromMercatorPixels:function(p,r){return new u(T5.Geo.pix2lat(r),T5.Geo.normalizeLon(T5.Geo.pix2lon(p)))},toMercatorPixels:function(p){return T5.XY.init(T5.Geo.lon2pix(p.lon),T5.Geo.lat2pix(p.lat))},generalize:function(p,r,w){var A=p.length,F=[],J=null;w||(w=250);w/=1E3;COG.Log.info("generalizing positions, must include "+r.length+" positions");for(var H=A;H--;)if(H===0)F.unshift(p[H]);else{var Y=
!J||D.inArray(p[H],r)?w:D.calcDistance(J,p[H]);if(p[H]&&Y>=w){F.unshift(p[H]);J=p[H]}}COG.Log.info("generalized "+A+" positions into "+F.length+" positions");return F},vectorize:function(p,r){var w=p.length,A=Array(w);r=T5.ex({chunkSize:y.VECTORIZE_PER_CYCLE,async:true},r);if(!r.async){for(var F=w;F--;)A[F]=T5.GeoXY.init(p[F]);return A}return COG.Loopage.join({frequency:10,execute:function(J,H){for(var Y=0,T=r.chunkSize,da=w;da--;){A[da]=T5.GeoXY.init(p[da]);Y+=1;if(Y>T)break}w=da;w<=0&&H.trigger("complete",
A)}})},toString:function(p){return p?p.lat+" "+p.lon:""}};return s}(),K=function(){var s={calcSize:function(p,r,w){var A=T5.XY.init(0,r.lat-p.lat);if(typeof w==="undefined")w=true;A.x=w&&p.lon>r.lon?360-p.lon+r.lon:r.lon-p.lon;return A},createBoundsFromCenter:function(p,r){var w=r/6371,A=p.lat*f,F=p.lon*f,J=A-w,H=A+w;if(J>g&&H<b){A=Math.asin(Math.sin(w)/Math.cos(A));w=F-A;if(w<o)w+=2*Math.PI;F=F+A;if(F>e)F-=2*Math.PI}else{J=Math.max(J,g);H=Math.min(H,b);w=o;F=e}return new v(new u(J*k,w*k),new u(H*
k,F*k))},expand:function(p,r){return new v(new u(p.min.lat-r,p.min.lon-S.normalizeLon(r)),new u(p.max.lat+r,p.max.lon+S.normalizeLon(r)))},forPositions:function(p,r){var w=null,A=T5.ticks();r||(r="auto");for(var F=p.length;F--;)if(w){var J=s.calcSize(w.min,p[F],false),H=s.calcSize(p[F],w.max,false);if(J.x<0)w.min.lon=p[F].lon;if(J.y<0)w.min.lat=p[F].lat;if(H.x<0)w.max.lon=p[F].lon;if(H.y<0)w.max.lat=p[F].lat}else w=new T5.Geo.BoundingBox(p[F],p[F]);if(r){if(r=="auto"){F=s.calcSize(w.min,w.max);r=
Math.max(F.x,F.y)*0.3}w=s.expand(w,r)}COG.Log.trace("calculated bounds for "+p.length+" positions",A);return w},getCenter:function(p){var r=K.calcSize(p.min,p.max);return new T5.Geo.Position(p.min.lat+r.y/2,p.min.lon+r.x/2)},getGeoHash:function(p){var r=T5.Geo.GeoHash.encode(p.min.lat,p.min.lon);p=T5.Geo.GeoHash.encode(p.max.lat,p.max.lon);COG.Log.info("min hash = "+r+", max hash = "+p)},getZoomLevel:function(p,r){var w=s.getCenter(p),A=d[Math.min(Math.round(Math.abs(w.lat)*0.05),d.length)],F=s.calcSize(p.min,
p.max);w=Math.ceil(Math.log(d[3]*r.height/F.y)/Math.log(2));A=Math.ceil(Math.log(A*r.width/F.x)/Math.log(2));return Math.min(isNaN(w)?1E3:w,isNaN(A)?1E3:A)},isEmpty:function(p){return!p||D.empty(p.min)||D.empty(p.max)},toString:function(p){return"min: "+D.toString(p.min)+", max: "+D.toString(p.max)}};return s}(),N=function(){var s=/^(\d+).*$/,p=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(r,w){s.lastIndex=-1;if(s.test(r))for(var A=r.replace(s,"$1"),F=w.split(","),J=0;J<F.length;J++){p.lastIndex=
-1;if(p.test(F[J])){var H=p.exec(F[J]);if(A>=parseInt(H[1],10)&&A<=parseInt(H[2],10))return true}else if(A==F[J])return true}return false},normalize:function(r){if(!r)return"";r=r.toUpperCase();if(!q){var w=[];for(var A in t)w.push(A);q=RegExp("(\\s)("+w.join("|")+")(\\s|$)","i")}q.lastIndex=-1;if(w=q.exec(r))r=r.replace(q,"$1"+t[w[2]]);return r},toString:function(r){return r.streetDetails+" "+r.location}}}(),L={},S={P:D,B:K,A:N,Radius:function(s,p){return{distance:parseInt(s,10),uom:p}},Position:u,
BoundingBox:v,Address:B,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(s){if(!s.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var p=T5.ex({remove:function(){delete L[p.id]}},s);return L[p.id]=p},GeoSearchResult:function(s){s=T5.ex({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},s);return T5.ex(s,{toString:function(){return s.caption+(s.matchWeight?" ("+s.matchWeight+")":"")}})},GeoSearchAgent:function(s){return new T5.Dispatcher.Agent(s)},
GeocodingAgent:function(s){s=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(p,r){try{if(!p.reverse&&!p.freeform)address=new B(p);var w=S.getEngine("geocode");if(w)w.geocode({addresses:[p.freeform?p.freeform:address],complete:function(F,J){if(r){var H=J;if(p.freeform)H=S.rankGeocodeResponses(p.freeform,H,S.getEngine("geocode"));r(H,s)}}})}catch(A){COG.Log.exception(A)}}},s);return new S.GeoSearchAgent(s)}};T5.GeoXY=function(){function s(r,w){if(r.length){for(var A,F,J,H,
Y=r.length;Y--;){s(r[Y],w);A=typeof A==="undefined"||r.x<A?r.x:A;F=typeof F==="undefined"||r.y<F?r.y:F;J=typeof J==="undefined"||r.x>J?r.x:J;H=typeof H==="undefined"||r.y>H?r.y:H}return T5.XYRect.init(A,F,H,H)}else if(r.mercXY){A=r.mercXY;r.x=~~(A.x/w);r.y=~~((Math.PI-A.y)/w);r.radsPerPixel=w}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");return r}function p(r,w,A){r.pos=w;r.mercXY=D.toMercatorPixels(w);(A=typeof A!=="undefined"?A:r.radsPerPixel)&&s(r,A)}return{init:function(r,
w){var A=T5.XY.init();p(A,r,w);return A},sync:s,toPos:function(r,w){w=w?w:self.radsPerPixel;return D.fromMercatorPixels(r.x*w,Math.PI-r.y*w)},updatePos:p}}();S.GeoVector=function(s){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return T5.GeoXY.init(s)};return T5.ex(S,y,x)}();
T5.Geo.GeoHash=function(){function l(n,m,d){if(m&d)n[0]=(n[0]+n[1])/2;else n[1]=(n[0]+n[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(n){var m=1,d=[],a=[];d[0]=-90;d[1]=90;a[0]=-180;a[1]=180;lat_err=90;lon_err=180;for(i=0;i<n.length;i++){c=n[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(m){lon_err/=2;l(a,cd,mask)}else{lat_err/=2;l(d,cd,mask)}m=!m}}d[2]=(d[0]+
d[1])/2;a[2]=(a[0]+a[1])/2;return{latitude:d,longitude:a}},encode:function(n,m,d){var a=1,e=[],g=[],b=0,o=0;d=d?d:12;geohash="";e[0]=-90;e[1]=90;g[0]=-180;for(g[1]=180;geohash.length<d;){if(a){mid=(g[0]+g[1])/2;if(m>mid){o|=BITS[b];g[0]=mid}else g[1]=mid}else{mid=(e[0]+e[1])/2;if(n>mid){o|=BITS[b];e[0]=mid}else e[1]=mid}a=!a;if(b<4)b++;else{geohash+=BASE32[o];o=b=0}}return geohash}}}();
T5.Geo.JSON=function(){function l(k,h,q,t){h=m(h);k.add(t.line(h,q));return h.length}function n(k,h,q,t){h=m(h);k.add(t.poly(h,q));return h.length}function m(k){var h=k?k.length:0,q=Array(h);for(h=h;h--;)q[h]=new T5.Geo.Position(k[h][1],k[h][0]);return T5.Geo.P.vectorize(q,g)}function d(k,h,q){return new f(k,h,q)}var a="featurecollection",e="feature",g={async:false},b={processor:null,group:"shapes",layerClass:T5.ShapeLayer},o={point:T5.ex({},b,{processor:function(k,h,q,t){h=m([h.coordinates],g);if(h.length>
0)if(q=t.marker(h[0],q)){k.add(q);return h.length}},group:"markers",layerClass:T5.MarkerLayer}),linestring:T5.ex({},b,{processor:function(k,h,q,t){h=m(h&&h.coordinates?h.coordinates:[]);return l(k,h,q,t)}}),multilinestring:T5.ex({},b,{processor:function(k,h,q,t){h=h&&h.coordinates?h.coordinates:[];for(var y=0,x=h.length;x--;)y+=l(k,h[x],q,t);return y}}),polygon:T5.ex({},b,{processor:function(k,h,q,t){h=h&&h.coordinates?h.coordinates:[];if(h.length>0)return n(k,h[0],q,t);return 0}}),multipolygon:T5.ex({},
b,{processor:function(k,h,q,t){h=h&&h.coordinates?h.coordinates:[];for(var y=0,x=0;x<h.length;x++)y+=n(k,h[x][0],q,t);return y}})},f=function(k,h,q,t){function y(p,r){var w=p.processor,A=B+p.group,F=T5.ex({},p,q,{properties:r.properties});if(w){var J=S[A];if(!J){J=new p.layerClass({id:A});S[A]=J}globalLayers=S;return w(J,r.data,F,t)}return 0}function x(p,r){var w=p&&p.type?p.type.toLowerCase():null;return w&&w===e?x(p.geometry,p.properties):{type:w,isCollection:w?w===a:false,definition:o[w],data:p,
properties:r?r:p.properties}}q=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},q);t=T5.ex({marker:function(p){return new T5.Marker({xy:p})},line:function(p,r){return new T5.Poly(p,r)},poly:function(p,r){return new T5.Poly(p,T5.ex({fill:true},r))}},t);var u=q.vectorsPerCycle,v=q.rowPreParse,B=q.layerPrefix,D=0,K=0,N=null,L=0,S={},s;if(!k)return null;if(typeof k.length==="undefined")k=[k];K=k.length;s=COG.Loopage.join({frequency:10,execute:function(p,
r){var w=0,A=D;if(!N){for(;A<K;A++){var F=x(v?v(k[A]):k[A]),J=null;if(F.isCollection){L+=1;N=d(F.data.features,function(H){N=null;for(var Y in H)S[Y]=H[Y]},{layerPrefix:B+L+"-"});J+=1}else if(F.definition)J=y(F.definition,F);w+=J?J:1;if(w>=u)break}D=A+1;!N&&D>=K&&r.trigger("complete")}}});s.bind("complete",function(){h&&h(S)});return s};return{parse:d}}();
T5.Geo.LocationSearch=function(l){function n(g,b){navigator.geolocation.clearWatch(d);d=0;if(a){clearTimeout(a);a=0}b&&b([g],l)}function m(g){COG.Log.info("caught location tracking error:",g)}l=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},l);var d=0,a=0,e=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(g,b){if(navigator.geolocation&&!d){d=navigator.geolocation.watchPosition(function(o){var f=new T5.Geo.Position(o.coords.latitude,o.coords.longitude);
o=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:f,accuracy:o.coords.accuracy/1E3,matchWeight:100});if(!e||o.accuracy<e.accuracy)e=o;if(!l.requiredAccuracy||e.accuracy<l.requiredAccuracy)n(e,b)},m,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(l.searchTimeout)a=setTimeout(function(){e&&n(e,b)},l.searchTimeout)}}},l))};
T5.Map=function(l){function n(x){try{var u=new T5.Geo.Position(x.coords.latitude,x.coords.longitude),v=x.coords.accuracy/1E3;y.trigger("locationUpdate",x,v);if(q){if(!k){k=new T5.Geo.UI.LocationOverlay({pos:u,accuracy:v});k.update(y.getTileLayer());y.setLayer("location",k)}var B=T5.Geo.B.createBoundsFromCenter(u,Math.max(v,1));y.gotoBounds(B)}else{k.pos=u;k.accuracy=v;k.update(y.getTileLayer());e(u,null,T5.easing("sine.out"))}q=false}catch(D){COG.Log.exception(D)}}function m(x){COG.Log.info("caught location tracking error:",
x)}function d(){var x=y.getViewRect();if(x){x=T5.XY.init(x.x1+x.width/2,x.y1+x.height/2);return T5.GeoXY.toPos(x,t)}return null}function a(x,u,v){COG.Log.info("position updated to: ",x);y.setZoomLevel(u);T5.Images.cancelLoad();T5.cancelAnimation();e(x,v)}function e(x,u,v,B){x=T5.GeoXY.init(x,T5.Geo.radsPerPixel(y.getZoomLevel()));y.updateOffset(x.x,x.y,v,B,u);y.trigger("wake");y.trigger("boundsChange",y.getBoundingBox());u&&typeof v==="undefined"&&u(y)}l=T5.ex({tapExtent:10,provider:null,crosshair:false,
zoomLevel:0,boundsChangeThreshold:30},l);var g={NONE:0,SINGLE:1,WATCH:2},b=T5.XY.init(),o=g.NONE,f=false,k=null,h=0,q=true,t=0;if(!l.provider)l.provider=new T5.Geo.MapProvider;l.adjustScaleFactor=function(x){return Math.pow(2,(x<1?Math.floor:Math.ceil)(Math.log(x)))};var y=T5.ex(new T5.View(l),{getBoundingBox:function(){var x=y.getViewRect();return new T5.Geo.BoundingBox(T5.GeoXY.toPos(T5.XY.init(x.x1,x.y2),t),T5.GeoXY.toPos(T5.XY.init(x.x2,x.y1),t))},getCenterPosition:d,gotoBounds:function(x,u){var v=
T5.Geo.B.getZoomLevel(x,y.getDimensions());a(T5.Geo.B.getCenter(x),v,u)},gotoPosition:a,panToPosition:e,syncXY:function(x){return T5.GeoXY.sync(x,t)},locate:function(){y.trackStart(g.SINGLE);setTimeout(y.trackCancel,1E4)},trackStart:function(x){if(navigator.geolocation&&!h){o=x?x:g.WATCH;q=true;h=navigator.geolocation.watchPosition(n,m,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){h&&navigator.geolocation&&navigator.geolocation.clearWatch(h);y.removeLayer("location");
k=null;o=g.NONE;h=0},animateRoute:function(x,u,v,B){var D=y.getLayer("route");if(D)(x=D.getAnimation(x,u,v,B))&&x.addToView(y)}});y.bind("pan",function(){o===g.SINGLE&&y.trackCancel()});y.bind("tap",function(){});y.bind("idle",function(){var x=T5.XY.absSize(T5.XY.diff(b,y.getOffset()));COG.Log.info("idle, change delta = "+x);if(x>l.boundsChangeThreshold){b=T5.XY.copy(y.getOffset());y.trigger("boundsChange",y.getBoundingBox())}});T5.zoomable(y,l);y.bind("zoomLevelChange",function(x,u,v){COG.Log.info("zoom level change, new zoom level = "+
u+", zoomXY = ",v);x=v?T5.GeoXY.toPos(v,t):d();t=T5.Geo.radsPerPixel(u);y.triggerAll("resync",y);e(x)});COG.configurable(y,["provider"],COG.paramTweaker(l,null,{provider:function(){y.cleanup();f=false}}),true);return y};
T5.Geo.MapProvider=function(){var l=1,n=20;return{zoomLevel:0,checkZoomLevel:function(m){return Math.min(Math.max(m,l),n)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:l,max:n}},prepTileGridArgs:function(m,d,a,e,g){var b=null;if(g.tileBackgroundColor){b=T5.Images.newCanvas(a,a);var o=b.getContext("2d");o.fillStyle=g.tileBackgroundColor;o.fillRect(0,0,a,a)}return T5.ex({tileSize:a,width:m,height:d,center:e,tileDrawArgs:{background:b}},
g)},setZoomRange:function(m,d){l=m;n=d}}};T5.MapTileGenerator=function(l){function n(e,g){m=g;a.reset()}var m=0,d=null,a=T5.ex(new T5.TileGenerator(l),{getTileCreatorArgs:function(e){d=e.getCenterPosition();return{zoomLevel:m,position:d}},requireRefresh:function(){return!d}});a.bind("bindView",function(e,g){if(g.getZoomLevel){m=g.getZoomLevel();g.bind("zoomLevelChange",n)}});return a};
T5.Geo.Routing=function(){var l={calculate:function(n){n=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},n);var m=T5.Geo.getEngine("route");m&&m.route(n,function(d){if(n.generalize)d.geometry=T5.Geo.P.generalize(d.geometry,d.getInstructionPositions());if(n.map){l.createMapOverlay(n.map,d);n.autoFit&&n.map.gotoBounds(d.boundingBox)}n.success&&n.success(d)})},createMapOverlay:function(n,m){var d=n.getDimensions();d=new T5.Geo.UI.RouteOverlay({data:m,width:d.width,
height:d.height});n.setLayer("route",d)},parseTurnType:function(n){for(var m=l.TurnType.Unknown,d=T5.Geo.Routing.TurnTypeRules,a=0;a<d.length;a++){d[a].regex.lastIndex=-1;var e=d[a].regex.exec(n);if(e){m=d[a].customCheck?d[a].customCheck(n,e):d[a].turnType;break}}return m},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(n){var m=n=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},n),d=n.description;d=d.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");m.description=d;if(!n.turnType)n.turnType=l.parseTurnType(n.description);return n},RouteData:function(n){n=T5.ex({geometry:[],instructions:[],boundingBox:null},
n);if(!n.boundingBox)n.boundingBox=T5.Geo.B.forPositions(n.geometry);return T5.ex({getInstructionPositions:function(){for(var m=[],d=0;d<n.instructions.length;d++)n.instructions[d].position&&m.push(n.instructions[d].position);return m}},n)}};return l}();T5.Geo.Search=function(){return{bestResults:function(l,n){n||(n=20);for(var m=l.length>0?l[0]:null,d=[],a=0;a<l.length;a++)if(m&&l[a]&&m.matchWeight-l[a].matchWeight<=n)d.push(l[a]);else break;return d}}}();
T5.Geo.UI=function(){var l={AnnotationTween:null,RouteOverlay:function(n){n=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},n);var m=[],d=[],a=new T5.PathLayer(n);(function(){if(n.data&&n.data.instructions){for(var e=n.data.instructions,g=Array(e.length),b=e.length;b--;)g[b]=e[b].position;T5.Geo.P.vectorize(g).bind("complete",function(o,f){d=f})}n.data&&n.data.geometry&&T5.Geo.P.vectorize(n.data.geometry).bind("complete",
function(o,f){m=f;a.updateCoordinates(m,d,true)})})();return a},Poly:function(n,m){m=T5.ex({autoParse:true},m);for(var d=Array(n.length),a=m.autoParse,e=T5.Geo.P.parse,g=n.length;g--;)d[g]=T5.GeoXY.init(a?e(n[g]):n[g]);return new T5.Poly(d,m)},Annotation:function(n){n=T5.ex({pos:null},n);n.xy=T5.GeoXY.init(n.pos);return new T5.ImageAnnotation(n)},LocationOverlay:function(n){n=T5.ex({pos:null,accuracy:null,zindex:90},n);var m=new Image,d=T5.XY.init(),a=T5.XY.init(),e=null;m.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
m.onload=function(){d=T5.XY.init(m.width/2,m.height/2)};var g=T5.ex(new T5.ViewLayer(n),{pos:n.pos,accuracy:n.accuracy,drawAccuracyIndicator:false,draw:function(b,o){var f=a.x-o.x,k=a.y-o.y;if(e){b.fillStyle="rgba(30, 30, 30, 0.2)";b.beginPath();b.arc(f,k,e,0,Math.PI*2,false);b.fill()}m.complete&&m.width>0&&b.drawImage(m,f-d.x,k-d.y,m.width,m.height);g.changed()},update:function(b){if(b){e=Math.floor(b.getPixelDistance(g.accuracy)*0.5);a=b.getGridXYForPosition(g.pos);g.changed()}}});g.bind("gridUpdate",
function(b,o){g.update(o)});return g},AnnotationsOverlay:function(n){function m(b,o){var f=b.length,k=g.getParent();if(o=o?o:k?k.getTileLayer():null)for(f=f;f--;)o.syncVectors([b[f].xy]);b.sort(function(h,q){var t=q.xy.y-h.xy.y;if(t===0)t=q.xy.x-h.xy.x;return t})}n=T5.ex({pois:null,map:null,zindex:100},n);var d=[],a=false,e=[],g=T5.ex(new T5.ViewLayer(n),{cycle:function(){return a},draw:function(b,o,f,k,h){a=false;b.fillStyle="rgba(255, 0, 0, 0.75)";b.globalCompositeOperation="source-over";for(f=
d.length;f--;){d[f].draw(b,o,k,g,h);a=a||d[f].isAnimating()}for(f=e.length;f--;){e[f].draw(b,o,k,g,h);a=a||e[f].isAnimating()}return a?1:0},add:function(b){if(b&&b.length)for(var o=b.length;o--;)e[e.length]=b[o];else if(b)e[e.length]=b;m(e);g.changed()},clear:function(b){e=[];m(e);if(b){d=[];m(d)}g.changed()}});COG.listen("geo.pois-updated",function(b){if(n.pois&&n.pois.id==b.srcID){b=b.pois;try{d=[];for(var o=0;o<b.length;o++)if(b[o].pos){var f;var k=b[o];if(k&&k.pos){var h={poi:k,annotation:null};
n.map&&n.map.trigger("getAnnotationForPOI",h);if(!h.annotation)h.annotation=new T5.Annotation({xy:T5.GeoXY.init(k.pos)});if(h.annotation){h.annotation.isNew=k.isNew;k.isNew=false}f=h.annotation}else f=void 0;f&&d.push(f)}m(d)}catch(q){COG.Log.exception(q)}g.changed()}});g.bind("gridUpdate",function(b,o){m(d,o);m(e,o);g.changed()});return g}};l.ImageAnnotation=l.Annotation;return l}();
T5.Geo.Routing.TurnTypeRules=function(){var l=T5.Geo.Routing.TurnType,n=[];n.push({regex:/continue/i,turnType:l.Continue});n.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(m,d){return/bear/i.test(d[1])?l.TurnLeftSlight:l.TurnLeft}});n.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(m,d){return/bear/i.test(d[1])?l.TurnRightSlight:l.TurnRight}});n.push({regex:/enter\s(roundabout|rotaty)/i,turnType:l.EnterRoundabout});n.push({regex:/take.*?ramp/i,turnType:l.Ramp});n.push({regex:/take.*?exit/i,
turnType:l.RampExit});n.push({regex:/make(.*?)u\-turn/i,customCheck:function(m,d){return/right/i.test(d[1])?l.UTurnRight:l.UTurnLeft}});n.push({regex:/proceed/i,turnType:l.Start});n.push({regex:/arrive/i,turnType:l.Arrive});n.push({regex:/fell\sthrough/i,turnType:l.Merge});return n}();
