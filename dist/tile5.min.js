var RTree=function(u){var I=3,y=6;if(!isNaN(u)){I=Math.floor(u/2);y=u}var x={x:0,y:0,w:0,h:0,id:"root",nodes:[]},m=function(){var s={};return function(h){var j=0;if(h in s)j=s[h]++;else s[h]=0;return h+"_"+j}}();RTree.Rectangle.squarified_ratio=function(s,h,j){var n=(s+h)/2;s=s*h;return s*j/(s/(n*n))};var p=function(s,h,j){var n=[],w=[],l=[],o=1;if(!s||!RTree.Rectangle.overlap_rectangle(s,j))return l;s={x:s.x,y:s.y,w:s.w,h:s.h,target:h};w.push(j.nodes.length);n.push(j);do{j=n.pop();h=w.pop()-1;if("target"in
s)for(;h>=0;){var q=j.nodes[h];if(RTree.Rectangle.overlap_rectangle(s,q))if(s.target&&"leaf"in q&&q.leaf===s.target||!s.target&&("leaf"in q||RTree.Rectangle.contains_rectangle(q,s))){if("nodes"in q){l=v(q,true,[],q);j.nodes.splice(h,1)}else l=j.nodes.splice(h,1);RTree.Rectangle.make_MBR(j.nodes,j);delete s.target;if(j.nodes.length<I)s.nodes=v(j,true,[],j);break}else if("nodes"in q){o+=1;w.push(h);n.push(j);j=q;h=q.nodes.length}h-=1}else if("nodes"in s){j.nodes.splice(h+1,1);j.nodes.length>0&&RTree.Rectangle.make_MBR(j.nodes,
j);for(h=0;h<s.nodes.length;h++)C(s.nodes[h],j);s.nodes.length=0;if(n.length==0&&j.nodes.length<=1){s.nodes=v(j,true,s.nodes,j);j.nodes.length=0;n.push(j);w.push(1)}else if(n.length>0&&j.nodes.length<I){s.nodes=v(j,true,s.nodes,j);j.nodes.length=0}else delete s.nodes}else RTree.Rectangle.make_MBR(j.nodes,j);o-=1}while(n.length>0);return l},v=function(s,h,j,n){var w=[];if(!RTree.Rectangle.overlap_rectangle(s,n))return j;w.push(n.nodes);do{n=w.pop();for(var l=n.length-1;l>=0;l--){var o=n[l];if(RTree.Rectangle.overlap_rectangle(s,
o))if("nodes"in o)w.push(o.nodes);else if("leaf"in o)h?j.push(o):j.push(o.leaf)}}while(w.length>0);return j},C=function(s,h){var j;if(h.nodes.length==0){h.x=s.x;h.y=s.y;h.w=s.w;h.h=s.h;h.nodes.push(s)}else{var n=-1,w=[],l;w.push(h);var o=h.nodes;do{if(n!=-1){w.push(o[n]);o=o[n].nodes;n=-1}for(var q=o.length-1;q>=0;q--){var N=o[q];if("leaf"in N){n=-1;break}var H=RTree.Rectangle.squarified_ratio(N.w,N.h,N.nodes.length+1);N=RTree.Rectangle.squarified_ratio(Math.max(N.x+N.w,s.x+s.w)-Math.min(N.x,s.x),
Math.max(N.y+N.h,s.y+s.h)-Math.min(N.y,s.y),N.nodes.length+2);if(n<0||Math.abs(N-H)<l){l=Math.abs(N-H);n=q}}}while(n!=-1);n=s;do{if(j&&"nodes"in j&&j.nodes.length==0){l=j;j=w.pop();for(o=0;o<j.nodes.length;o++)if(j.nodes[o]===l||j.nodes[o].nodes.length==0){j.nodes.splice(o,1);break}}else j=w.pop();if("leaf"in n||"nodes"in n||Object.prototype.toString.call(n)==="[object Array]"){if(Object.prototype.toString.call(n)==="[object Array]"){for(l=0;l<n.length;l++)RTree.Rectangle.expand_rectangle(j,n[l]);
j.nodes=j.nodes.concat(n)}else{RTree.Rectangle.expand_rectangle(j,n);j.nodes.push(n)}if(j.nodes.length<=y)n={x:j.x,y:j.y,w:j.w,h:j.h};else{l=n=j.nodes;o=l.length-1;q=0;H=l.length-1;N=0;var B=void 0,P=void 0;for(B=l.length-2;B>=0;B--){P=l[B];if(P.x>l[q].x)q=B;else if(P.x+P.w<l[o].x+l[o].w)o=B;if(P.y>l[N].y)N=B;else if(P.y+P.h<l[H].y+l[H].h)H=B}if(Math.abs(l[o].x+l[o].w-l[q].x)>Math.abs(l[H].y+l[H].h-l[N].y))if(o>q){B=l.splice(o,1)[0];P=l.splice(q,1)[0]}else{P=l.splice(q,1)[0];B=l.splice(o,1)[0]}else if(H>
N){B=l.splice(H,1)[0];P=l.splice(N,1)[0]}else{P=l.splice(N,1)[0];B=l.splice(H,1)[0]}for(l=[{x:B.x,y:B.y,w:B.w,h:B.h,nodes:[B]},{x:P.x,y:P.y,w:P.w,h:P.h,nodes:[P]}];n.length>0;){o=n;q=l[0];H=l[1];B=RTree.Rectangle.squarified_ratio(q.w,q.h,q.nodes.length+1);P=RTree.Rectangle.squarified_ratio(H.w,H.h,H.nodes.length+1);var V=void 0,ka=void 0;N=void 0;for(var ma=o.length-1;ma>=0;ma--){var Z=o[ma],ia={};ia.x=Math.min(q.x,Z.x);ia.y=Math.min(q.y,Z.y);ia.w=Math.max(q.x+q.w,Z.x+Z.w)-ia.x;ia.h=Math.max(q.y+
q.h,Z.y+Z.h)-ia.y;ia=Math.abs(RTree.Rectangle.squarified_ratio(ia.w,ia.h,q.nodes.length+2)-B);var R={};R.x=Math.min(H.x,Z.x);R.y=Math.min(H.y,Z.y);R.w=Math.max(H.x+H.w,Z.x+Z.w)-R.x;R.h=Math.max(H.y+H.h,Z.y+Z.h)-R.y;Z=Math.abs(RTree.Rectangle.squarified_ratio(R.w,R.h,H.nodes.length+2)-P);if(!ka||!V||Math.abs(Z-ia)<V){ka=ma;V=Math.abs(Z-ia);N=Z<ia?H:q}}B=o.splice(ka,1)[0];if(q.nodes.length+o.length+1<=I){q.nodes.push(B);RTree.Rectangle.expand_rectangle(q,B)}else if(H.nodes.length+o.length+1<=I){H.nodes.push(B);
RTree.Rectangle.expand_rectangle(H,B)}else{N.nodes.push(B);RTree.Rectangle.expand_rectangle(N,B)}}n=l=l;if(w.length<1){j.nodes.push(l[0]);w.push(j);n=l[1]}}}else{RTree.Rectangle.expand_rectangle(j,n);n={x:j.x,y:j.y,w:j.w,h:j.h}}}while(w.length>0)}};this.get_tree=function(){return x};this.set_tree=function(s,h){h||(h=x);var j=h;j.nodes=s.nodes;j.x=s.x;j.y=s.y;j.w=s.w;j.h=s.h;return j};this.search=function(){if(arguments.length<1)throw"Wrong number of arguments. RT.Search requires at least a bounding rectangle.";
switch(arguments.length){case 1:arguments[1]=false;case 2:arguments[2]=[];case 3:arguments[3]=x;default:arguments.length=4}return v.apply(this,arguments)};this.toJSON=function(s,h){var j=[],n=[],w={},l=3,o=1,q="";if(s&&!RTree.Rectangle.overlap_rectangle(s,x))return"";if(h){l+=4;n.push(h.nodes.length);j.push(h.nodes);q+="var main_tree = {x:"+h.x.toFixed()+",y:"+h.y.toFixed()+",w:"+h.w.toFixed()+",h:"+h.h.toFixed()+",nodes:["}else{n.push(x.nodes.length);j.push(x.nodes);q+="var main_tree = {x:"+x.x.toFixed()+
",y:"+x.y.toFixed()+",w:"+x.w.toFixed()+",h:"+x.h.toFixed()+",nodes:["}do{var N=j.pop(),H=n.pop()-1;if(H>=0&&H<N.length-1)q+=",";for(;H>=0;){var B=N[H];if(!s||RTree.Rectangle.overlap_rectangle(s,B))if(B.nodes)if(o>=l){var P=m("saved_subtree");q+="{x:"+B.x.toFixed()+",y:"+B.y.toFixed()+",w:"+B.w.toFixed()+",h:"+B.h.toFixed()+",load:'"+P+".js'}";w[P]=this.toJSON(s,B);if(H>0)q+=","}else{q+="{x:"+B.x.toFixed()+",y:"+B.y.toFixed()+",w:"+B.w.toFixed()+",h:"+B.h.toFixed()+",nodes:[";o+=1;n.push(H);j.push(N);
N=B.nodes;H=B.nodes.length}else if(B.leaf){P=B.leaf.toJSON?B.leaf.toJSON():JSON.stringify(B.leaf);q+="{x:"+B.x.toFixed()+",y:"+B.y.toFixed()+",w:"+B.w.toFixed()+",h:"+B.h.toFixed()+",leaf:"+P+"}";if(H>0)q+=","}else if(B.load){q+="{x:"+B.x.toFixed()+",y:"+B.y.toFixed()+",w:"+B.w.toFixed()+",h:"+B.h.toFixed()+",load:'"+B.load+"'}";if(H>0)q+=","}H-=1}if(H<0){q+="]}";o-=1}}while(j.length>0);q+=";";for(var V in w)q+="\nvar "+V+" = function(){"+w[V]+" return(main_tree);};";return q};this.remove=function(){if(arguments.length<
1)throw"Wrong number of arguments. RT.remove requires at least a bounding rectangle.";switch(arguments.length){case 1:arguments[1]=false;case 2:arguments[2]=x;default:arguments.length=3}if(arguments[1]===false){var s=0,h=[];do{s=h.length;h=h.concat(p.apply(this,arguments))}while(s!=h.length);return h}else return p.apply(this,arguments)};this.insert=function(s,h){if(arguments.length<2)throw"Wrong number of arguments. RT.Insert requires at least a bounding rectangle and an object.";return C({x:s.x,
y:s.y,w:s.w,h:s.h,leaf:h},x)}};
RTree.Rectangle=function(u,I,y,x){var m,p,v,C,s,h;if(u.x){m=u.x;v=u.y;if(u.w!==0&&!u.w&&u.x2){s=u.x2-u.x;h=u.y2-u.y}else{s=u.w;h=u.h}}else{m=u;v=I;s=y;h=x}p=m+s;C=v+h;this.x1=this.x=function(){return m};this.y1=this.y=function(){return v};this.x2=function(){return p};this.y2=function(){return C};this.w=function(){return s};this.h=function(){return h};this.toJSON=function(){return'{"x":'+m.toString()+', "y":'+v.toString()+', "w":'+s.toString()+', "h":'+h.toString()+"}"};this.overlap=function(j){return this.x()<
j.x2()&&this.x2()>j.x()&&this.y()<j.y2()&&this.y2()>j.y()};this.expand=function(j){var n=Math.min(this.x(),j.x()),w=Math.min(this.y(),j.y());s=Math.max(this.x2(),j.x2())-n;h=Math.max(this.y2(),j.y2())-w;m=n;v=w;return this};this.setRect=function(){}};RTree.Rectangle.overlap_rectangle=function(u,I){return u.x<I.x+I.w&&u.x+u.w>I.x&&u.y<I.y+I.h&&u.y+u.h>I.y};RTree.Rectangle.contains_rectangle=function(u,I){return u.x+u.w<=I.x+I.w&&u.x>=I.x&&u.y+u.h<=I.y+I.h&&u.y>=I.y};
RTree.Rectangle.expand_rectangle=function(u,I){var y=Math.min(u.x,I.x),x=Math.min(u.y,I.y);u.w=Math.max(u.x+u.w,I.x+I.w)-y;u.h=Math.max(u.y+u.h,I.y+I.h)-x;u.x=y;u.y=x;return u};RTree.Rectangle.make_MBR=function(u,I){if(u.length<1)return{x:0,y:0,w:0,h:0};if(I)I.x=u[0].x;else I={x:u[0].x,y:u[0].y,w:u[0].w,h:u[0].h};I.y=u[0].y;I.w=u[0].w;I.h=u[0].h;for(var y=u.length-1;y>0;y--)RTree.Rectangle.expand_rectangle(I,u[y]);return I};COG=typeof COG!=="undefined"?COG:{};
COG.extend=function(){for(var u=arguments[0]||{},I,y=1,x=arguments.length;y<x;y++)if((I=arguments[y])!==null)for(var m in I){var p=I[m];if(u!==p)if(p!==undefined)u[m]=p}return u};
(function(){var u=Object.prototype.hasOwnProperty,I=0,y={};y.toID=function(x){return x.replace(/\s/g,"-")};y.objId=function(x){return(x?x:"obj")+I++};y.isFunction=function(x){return toString.call(x)==="[object Function]"};y.isArray=function(x){return toString.call(x)==="[object Array]"};y.isPlainObject=function(x){if(!x||toString.call(x)!=="[object Object]"||x.nodeType||x.setInterval)return false;if(x.constructor&&!u.call(x,"constructor")&&!u.call(x.constructor.prototype,"isPrototypeOf"))return false;
var m;for(m in x);return m===undefined||u.call(x,m)};y.isEmptyObject=function(x){for(var m in x)return false;return true};y.isXmlDocument=function(x){return toString.call(x)==="[object Document]"};y.contains=function(x,m){var p=x,v=arguments,C=1;if(m&&module.isArray(m)){v=m;C=0}for(C=C;C<v;C++)p=p&&typeof foo[v[C]]!=="undefined";return p};y.formatStr=function(x){if(arguments.length<=1)return x;for(var m=arguments.length-2,p=0;p<=m;p++)x=x.replace(RegExp("\\{"+p+"\\}","gi"),arguments[p+1]);return x};
y.wordExists=function(x,m){var p="";if(m.toString)m=m.toString();for(var v=0;v<m.length;v++)p+=!/\w/.test(m[v])?"\\"+m[v]:m[v];return RegExp("(^|\\s|\\,)"+p+"(\\,|\\s|$)","i").test(x)};COG.extend(COG,y)})();
(function(){function u(p){return typeof console!=="undefined"?function(){console[p](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var I=window.console&&window.console.markTimeline,y=u("error"),x=u("info"),m=function(){return I?function(p,v){console.markTimeline(p+(v?": "+((new Date).getTime()-v)+"ms":""))}:function(){}}();COG.extend(COG,{trace:m,debug:u("debug"),info:x,warn:u("warn"),error:y,exception:function(p){if(y)for(var v in p)x("ERROR DETAIL: "+v+
": "+p[v])}})})();
(function(){function u(y,x){var m=y.hasOwnProperty("obsHandlers")?y.obsHandlers:null;m[x]||(m[x]=[]);return m[x]}var I=0;COG.observable=function(y){if(!y)return null;if(!(y.hasOwnProperty("obsHandlers")?y.obsHandlers:null))y.obsHandlers={};if(!y.hasOwnProperty("bind")){y.bind=function(x,m){var p="callback"+I++;u(y,x).unshift({fn:m,id:p});return p};y.triggerCustom=function(x,m){var p=u(y,x),v={cancel:false,name:x,source:this},C;m&&COG.extend(v,m);if(!p)return null;C=Array.prototype.slice.call(arguments,2);
y.eventInterceptor&&y.eventInterceptor(x,v,C);C.unshift(v);for(var s=p.length;s--&&!v.cancel;)p[s].fn.apply(this,C);return v};y.trigger=function(x){var m=Array.prototype.slice.call(arguments,1);m.splice(0,0,x,null);return y.triggerCustom.apply(this,m)};y.unbind=function(x,m){if(typeof x==="undefined")y.obsHandlers={};else for(var p=u(y,x),v=0;p&&v<p.length;v++)if(p[v].id===m){p.splice(v,1);break}return y}}return y}})();
(function(){function u(m,p){m[p]||(m[p]=function(v){return m.configure(p,v)})}function I(m){m.gtConfId="configurable"+x++;m.gtConfig={};m.gtConfigFns=[];return m.gtConfig}var y={},x=0;COG.paramTweaker=function(m,p,v){return function(C,s){if(typeof s!=="undefined"){if(C in m)m[C]=s;v&&C in v&&v[C](C,s)}else return p&&C in p?p[C](C):m[C]}};COG.configurable=function(m,p,v,C){if(m){m.gtConfId||I(m);var s=m.gtConfId,h=m.gtConfig,j=m.gtConfigFns;y[s]=m;j.push(v);for(v=p.length;v--;){h[p[v]]=true;C&&u(m,
p[v])}if(!m.configure)m.configure=function(n,w){if(h[n]){for(var l=j.length;l--;){var o=j[l](n,w);if(typeof o!=="undefined")return o}return y[s]}return null}}}})();
(function(){function u(m){var p=document.createElement("script"),v=false;p.src=m;p.async=true;p.onload=p.onreadystatechange=function(){if(!v&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){v=true;p.onload=p.onreadystatechange=null;p&&p.parentNode&&p.parentNode.removeChild(p)}};y||(y=document.getElementsByTagName("head")[0]);y.appendChild(p)}var I=0,y,x=this;COG.jsonp=function(m,p,v){m+=m.indexOf("?")>=0?"&":"?";var C="json"+ ++I;x[C]=function(s){p(s);x[C]=null;try{delete x[C]}catch(h){}};
u(m+(v?v:"callback")+"="+C);return C}})();
(function(){var u=1.70158,I=Math.PI/2,y=1E3/60|0,x=Math.abs,m=Math.pow,p=Math.sin,v=Math.asin,C=Math.cos,s={linear:function(h,j,n,w){return n*h/w+j},backin:function(h,j,n,w){return n*(h/=w)*h*((u+1)*h-u)+j},backout:function(h,j,n,w){return n*((h=h/w-1)*h*((u+1)*h+u)+1)+j},backinout:function(h,j,n,w){return(h/=w/2)<1?n/2*h*h*(((u*=1.525)+1)*h-u)+j:n/2*((h-=2)*h*(((u*=1.525)+1)*h+u)+2)+j},bouncein:function(h,j,n,w){return n-s.bounceout(w-h,0,n,w)+j},bounceout:function(h,j,n,w){return(h/=w)<1/2.75?n*
7.5625*h*h+j:h<2/2.75?n*(7.5625*(h-=1.5/2.75)*h+0.75)+j:h<2.5/2.75?n*(7.5625*(h-=2.25/2.75)*h+0.9375)+j:n*(7.5625*(h-=2.625/2.75)*h+0.984375)+j},bounceinout:function(h,j,n,w){return h<w/2?s.bouncein(h*2,0,n,w)/2+j:s.bounceout(h*2-w,0,n,w)/2+n/2+j},cubicin:function(h,j,n,w){return n*(h/=w)*h*h+j},cubicout:function(h,j,n,w){return n*((h=h/w-1)*h*h+1)+j},cubicinout:function(h,j,n,w){if((h/=w/2)<1)return n/2*h*h*h+j;return n/2*((h-=2)*h*h+2)+j},elasticin:function(h,j,n,w,l,o){if(h==0)return j;if((h/=
w)==1)return j+n;o||(o=w*0.3);if(!l||l<x(n)){l=n;n=o/4}else n=o/TWO_PI*v(n/l);return-(l*m(2,10*(h-=1))*p((h*w-n)*TWO_PI/o))+j},elasticout:function(h,j,n,w,l,o){var q;if(h==0)return j;if((h/=w)==1)return j+n;o||(o=w*0.3);if(!l||l<x(n)){l=n;q=o/4}else q=o/TWO_PI*v(n/l);return l*m(2,-10*h)*p((h*w-q)*TWO_PI/o)+n+j},elasticinout:function(h,j,n,w,l,o){var q;if(h==0)return j;if((h/=w/2)==2)return j+n;o||(o=w*0.3*1.5);if(!l||l<x(n)){l=n;q=o/4}else q=o/TWO_PI*v(n/l);if(h<1)return-0.5*l*m(2,10*(h-=1))*p((h*
w-q)*TWO_PI/o)+j;return l*m(2,-10*(h-=1))*p((h*w-q)*TWO_PI/o)*0.5+n+j},quadin:function(h,j,n,w){return n*(h/=w)*h+j},quadout:function(h,j,n,w){return-n*(h/=w)*(h-2)+j},quadinout:function(h,j,n,w){if((h/=w/2)<1)return n/2*h*h+j;return-n/2*(--h*(h-2)-1)+j},sinein:function(h,j,n,w){return-n*C(h/w*I)+n+j},sineout:function(h,j,n,w){return n*p(h/w*I)+j},sineinout:function(h,j,n,w){return-n/2*(C(Math.PI*h/w)-1)+j}};COG.tweenValue=function(h,j,n,w,l){function o(B){B=B?B:(new Date).getTime();if(N+y<B){var P=
B-q,V=n(P,h,H,w),ka=q+w<=B;B=!ka;if(l){P=l(V,ka,P);B=typeof P!="undefined"?P&&B:B}B&&animFrame(o)}}var q=(new Date).getTime(),N=0,H=j-h;animFrame(o);return{}};COG.easing=function(h){return s[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(h,j){s[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]=j}})();
(function(){var u=/^P(\d+Y)?(\d+M)?(\d+D)?$/,I=/^(\d+H)?(\d+M)?(\d+S)?$/,y={8601:function(m){m=m.split("T");var p=null;p=null;var v=0,C=0;u.lastIndex=-1;p=u.exec(m[0]);v+=p[3]?parseInt(p[3].slice(0,-1),10):0;I.lastIndex=-1;p=I.exec(m[1]);C+=p[1]?parseInt(p[1].slice(0,-1),10)*3600:0;C+=p[2]?parseInt(p[2].slice(0,-1),10)*60:0;C+=p[3]?parseInt(p[3].slice(0,-1),10):0;return new x(v,C)}},x=COG.Duration=function(m,p){return{days:m?m:0,seconds:p?p:0}};COG.addDuration=function(){for(var m=new x,p=arguments.length;p--;){m.days+=
arguments[p].days;m.seconds+=arguments[p].seconds}if(m.seconds>=86400){m.days+=~~(m.seconds/86400);m.seconds%=86400}return m};COG.formatDuration=function(m){var p,v,C="";if(m.days)C=m.days+" days ";if(m.seconds){m=m.seconds;if(m>=3600){p=~~(m/3600);m-=p*3600}if(m>=60){v=Math.round(m/60);m-=v*60}if(p)C=C+p+(p>1?" hrs ":" hr ")+(v?(v>10?v:"0"+v)+" min ":"");else if(v)C=C+v+" min";else if(m>0)C=C+(m>10?m:"0"+m)+" sec"}return C};COG.parseDuration=function(m,p){var v=p?y[p]:null;if(v)return v(m);COG.Log.warn("Could not find duration parser for specified format: "+
p);return new x}})();COG.ObjectStore=function(){var u={},I={},y="obj_"+(new Date).getTime(),x=0,m=Object.prototype.hasOwnProperty;return{add:function(p,v){var C;v=v?v:"default";if(p&&p.constructor)if(!m.call(p,"id"))p.id=y+ ++x;C=I[v]?I[v]:I[v]=[];u[p.id]=C.length;C[p.length]=p}}};var CANI={};
(function(u){var I=[],y=0,x=false,m=u.register=function(p,v){I.push({section:p,run:v})};u.init=function(p){function v(){if(y<I.length){var s=I[y++];C[s.section]||(C[s.section]={});s.run(C[s.section],v)}else{for(s in C)u[s]=C[s];x=true;p&&p(u)}}var C={};if(x&&p)p(u);else{y=0;v()}};m("canvas",function(p,v){function C(){var n,w=s.getContext("2d");w.save();try{w.translate(50,50);w.beginPath();w.rect(0,0,20,20);n=w.isPointInPath(10,10)}finally{w.restore()}return n}var s=document.createElement("canvas"),
h=typeof FlashCanvas!="undefined",j=typeof G_vmlCanvasManager!="undefnined";s.width=200;s.height=200;p.pipTransformed=h||j?false:C();v()})})(CANI);
INTERACT=function(){function u(l){return function(o,q,N){(N?N:l?document.body:document).addEventListener(o,q,false)}}function I(l){return function(o,q,N){(N?N:l?document.body:document).removeEventListener(o,q,false)}}function y(l,o,q){(q?q:document).attachEvent("on"+l,o)}function x(l,o,q){(q?q:document).detachEvent("on"+l,o)}function m(l,o){return{x:l?l:0,y:o?o:0,count:1}}function p(l,o){n.push(COG.extend({handler:null,checks:{},type:l},o))}function v(l){var o=0,q=0;if(l.offsetParent){do{o+=l.offsetLeft;
q+=l.offsetTop;l=l.offsetParent}while(l)}return{left:o,top:q}}function C(l,o){return{source:l,target:o.target?o.target:o.srcElement}}function s(l,o){for(var q=l.target?l.target:l.srcElement;q&&q!==o&&q.nodeName&&q.nodeName.toUpperCase()!="CANVAS";)q=q.parentNode;return q&&q===o}function h(l,o){return{x:l.x-(o?o.left:0),y:l.y-(o?o.top:0)}}function j(l){if(l.preventDefault){l.preventDefault();l.stopPropagation()}else l.cancelBubble&&l.cancelBubble()}var n=[],w=function(l,o,q){function N(R,ea,ba,X){var T=
0,da=0,E=0;COG.tweenValue(0,R,ba,X,function(S){E=T;T=S});COG.tweenValue(0,ea,ba,X,function(S){H.trigger("pan",T-E,S-da);da=S})}q=COG.extend({binder:null,unbinder:null,observable:null},q);for(var H=q.observable,B=null,P=[],V=[],ka,ma,Z={bind:function(){return H.bind.apply(null,arguments)},pannable:function(R){B=COG.extend({inertia:true},R);return Z},unbind:function(){H.unbind();for(var R=0;R<P.length;R++)P[R].unbind();return Z}},ia=0;ia<o.length;ia++)P.push(o[ia](l,H,q));H.bind("pointerDown",function(){V=
[];ma=ka=0});H.bind("pointerMove",function(R,ea,ba,X){if(B){V[V.length]={ticks:(new Date).getTime(),x:X.x,y:X.y};H.trigger("pan",X.x,X.y)}ka+=X.x?X.x:0;ma+=X.y?X.y:0});H.bind("pointerUp",function(R,ea,ba){if(Math.abs(ka)>20||Math.abs(ma)>20){if(B){ba=V.length;var X,T;ea=0;for(T=V.length;--T>1&&ea<50;)ea+=V[T].ticks-V[T-1].ticks;if(ba-T>1){R=V[ba-1].x-V[T].x;X=V[ba-1].y-V[T].y;T=Math.sqrt(R*R+X*X)|0;if(T>15){R=V[ba-1].x-V[0].x;X=V[ba-1].y-V[0].y;T=Math.sqrt(R*R+X*X)|0;ba=Math.asin(X/T);ea=T*500/ea|
0;ea=ea>300?300:ea;N(Math.cos(R>0?ba:Math.PI-ba)*ea,Math.sin(ba)*ea,COG.easing("sine.out"),500)}}}}else H.trigger("tap",ea,ba)});return Z};p("pointer",{handler:function(l,o,q){function N(E){if(E.pageX&&E.pageY)return m(E.pageX,E.pageY);else{var S=document.documentElement,ca=document.body;return m(E.clientX+(S&&S.scrollLeft||ca&&ca.scrollLeft||0)-(S&&S.clientLeft||ca&&ca.clientLeft||0),E.clientY+(S&&S.scrollTop||ca&&ca.scrollTop||0)-(S&&S.clientTop||ca&&ca.clientTop||0))}}function H(E){if(s(E,l))if(R=
ka(E)){var S=N(E);l.style.cursor="move";j(E);T=S.x;da=S.y;ea=m(T,da);o.triggerCustom("pointerDown",C("mouse",E),ea,h(ea,v(l)))}}function B(E){var S=N(E);ba=S.x;X=S.y;if(s(E,l))ma(E,R?"pointerMove":"pointerHover")}function P(E){if(R&&ka(E)){R=false;if(s(E,l)){l.style.cursor="default";ma(E,"pointerUp")}}}function V(E){if(s(E,l)){var S;E=E||window.event;if(E.detail)S=E.axis===2?-E.detail*Z:0;else{S=E.wheelDeltaY?E.wheelDeltaY:E.wheelDelta;if(window.opera)S=-S}if(S!==0){var ca=m(ba,X);o.triggerCustom("zoom",
C("mouse",E),ca,h(ca,v(l)),S/ia,"wheel");j(E);E.returnValue=false}}}function ka(E){E=E||window.event;return(E.which||E.button)==1}function ma(E,S,ca,ua,sa){ca=typeof ca!="undefined"?ca:ba;ua=typeof ua!="undefined"?ua:X;var Q=ca-T,aa=ua-da,Y=m(ca,ua);o.triggerCustom(S,C("mouse",E),Y,h(Y,v(l)),m(Q,aa));if(typeof sa=="undefined"||sa){T=ca;da=ua}}q=COG.extend({},q);var Z=120,ia=Z*8,R=false,ea,ba,X,T,da;q.binder("mousedown",H,false);q.binder("mousemove",B,false);q.binder("mouseup",P,false);q.binder("dblclick",
function(E){COG.info("captured double click");if(s(E,l)){var S=N(E);o.triggerCustom("doubleTap",C("mouse",E),S,h(S,v(l)))}},false);q.binder("mousewheel",V,document);q.binder("DOMMouseScroll",V,document);return{unbind:function(){q.unbinder("mousedown",H,false);q.unbinder("mousemove",B,false);q.unbinder("mouseup",P,false);q.unbinder("mousewheel",V,document);q.unbinder("DOMMouseScroll",V,document)}}},checks:{touch:false}});p("pointer",{handler:function(l,o,q){function N(Q){if(Q.count<2)return 0;var aa=
Q.x-Q.next.x;Q=Q.y-Q.next.y;return~~Math.sqrt(aa*aa+Q*Q)}function H(Q,aa,Y){aa=aa?aa:0;Y=Y?Y:0;for(var va={x:Q.x-aa,y:Q.y-Y,id:Q.id,count:Q.count},ya=va;Q.next;){Q=Q.next;ya=ya.next={x:Q.x-aa,y:Q.y-Y,id:Q.id}}return va}function B(Q,aa){var Y=Q[aa?aa:"touches"],va,ya;if(Y.length===0)return null;ya=va={x:Y[0].pageX,y:Y[0].pageY,id:Y[0].identifier,count:Y.length};for(var Ca=1,Wa=Y.length;Ca<Wa;Ca++)ya=ya.next={x:Y[Ca].pageX,y:Y[Ca].pageY,id:Y[Ca].identifier};return va}function P(Q){if(s(Q,l)){X=v(l);
var aa=B(Q,"changedTouches"),Y=H(aa,X.left,X.top);if(!da){T=R;o.triggerCustom("pointerDown",C("touch",Q),aa,Y)}ua&&o.triggerCustom("pointerDownMulti",C("touch",Q),aa,Y);da=B(Q);if(da.count>1)S=N(da);sa=1;ca=H(da)}}function V(Q){if(s(Q,l)){Q.preventDefault();E=B(Q);if(T==R)T=Math.abs(da.x-E.x)>Z||Math.abs(da.y-E.y)>Z?ia:R;if(T!=R){T=E.count>1?ba:ea;if(T==ba)if(da.count===1){da=H(E);S=N(da)}else{var aa=N(E);if(Math.abs(S-aa)<ma)T=ea;else{var Y;Y=E.x;var va=E.next.x,ya=E.y,Ca=E.next.y,Wa=ya<Ca?ya:Ca;
Y={x:(Y<va?Y:va)+(Math.abs(Y-va)>>1),y:Wa+(Math.abs(ya-Ca)>>1)};aa=aa/S;va=aa-sa;o.triggerCustom("zoom",C("touch",Q),Y,h(Y,X),va,"pinch");sa=aa}}T==ea&&o.triggerCustom("pointerMove",C("touch",Q),E,H(E,X.left,X.top),m(E.x-ca.x,E.y-ca.y));ua&&o.triggerCustom("pointerMoveMulti",C("touch",Q),E,H(E,X.left,X.top))}ca=H(E)}}function ka(Q){if(s(Q,l)){var aa=B(Q,"changedTouches"),Y=H(aa,X.left,X.top);E=B(Q);if(!E){o.triggerCustom("pointerUp",C("touch",Q),aa,Y);da=null}ua&&o.triggerCustom("pointerUpMulti",
C("touch",Q),aa,Y)}}q=COG.extend({detailed:false,inertia:false},q);var ma=20,Z=7,ia=0,R=1,ea=2,ba=3,X,T,da,E,S,ca,ua=q.detailed,sa=1;q.binder("touchstart",P,false);q.binder("touchmove",V,false);q.binder("touchend",ka,false);COG.info("initialized touch handler");return{unbind:function(){q.unbinder("touchstart",P,false);q.unbinder("touchmove",V,false);q.unbinder("touchend",ka,false)}}},checks:{touch:true}});return{register:p,watch:function(l,o,q){o=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},o);capabilities=COG.extend({touch:"ontouchstart"in window},q);if(!o.observable){COG.info("creating observable");o.observable=COG.observable({});globalOpts=o}o.binder=o.isIE?y:u(o.bindToBody);o.unbinder=o.isIE?x:I(o.bindToBody);q=o.types;for(var N=capabilities,H=[],B=n.length;B--;){var P=n[B],V=!q||q.indexOf(P.type)>=0,ka=true;for(var ma in P.checks){var Z=P.checks[ma];COG.info("checking "+ma+" capability. require: "+Z+", capability = "+N[ma]);ka=ka&&Z===N[ma]}if(V&&ka)H[H.length]=
P.handler}return new w(l,H,o)}}}();var T5={};
(function(u){function I(){return(new Date).getTime()}function y(b,e){e=Wa.call(e);if(e=="finite")return!Ca[ya](+b);return e=="null"&&b===null||e==typeof b||e=="object"&&b===Object(b)||e=="array"&&Array.isArray&&Array.isArray(b)||Rb.call(b).slice(8,-1).toLowerCase()==e}function x(b){b=b||(new Date).getTime();for(var e=0;e<Ta.length;){var f=Ta[e],d=Oa[f],a=Oa[f].image&&(ab||Oa[f].image.complete&&Oa[f].image.width>0),c=b-d.start;c=a||c>=Sb;if(a){a=d.callbacks;ub[f]=d.image;for(var g=0;g<a.length;g++)a[g](d.image,
true)}if(c){Ta.splice(e,1);delete Oa[f]}else e++}Ta.length>0&&animFrame(x)}function m(b,e){var f=b&&e?ub[b]:null;if(f&&f&&(ab||f.complete&&f.width>0))e(f);else{if(f=Oa[b])f.callbacks.push(e);else{f=new Image;f.id="_ldimg"+ ++Tb;Oa[b]={start:(new Date).getTime(),image:f,callbacks:[e]};f.src=b;Ta[Ta.length]=b}animFrame(x)}}function p(b,e,f,d,a,c){this.x=b;this.y=e;this.w=d||256;this.h=d||256;this.x2=this.x+this.w;this.y2=this.y+this.h;this.url=f;this.id=c||b+"_"+e;this.loaded=false;this.image=null}
function v(b){function e(c){var g=b[c];y(g,ta)||d.push(function(k){k[c]=g})}function f(){d=[];for(var c in b)e(c)}b=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},b);var d=[],a={applyToContext:function(c){for(var g=d.length;g--;)d[g](c)},update:function(c,g){b[c]=g;f()}};f();return a}function C(){for(var b=0,e=arguments.length;e--;){var f=Ub[arguments[e].toUpperCase()];
if(f)b|=f}return b}function s(b){b=b?b:(new Date).getTime();if(b-vb>Vb){for(var e=Xa.splice(0),f=e.length;f--;)e[f](b);vb=b}Xa.length&&animFrame(s)}function h(b){var e=Xa.length==0;Xa[Xa.length]=b;e&&animFrame(s)}function j(b,e,f,d,a){a=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},a);var c=(new Date).getTime(),g=b[e],k=e=="translate",i=a.autoInvalidate,r=f.length&&d.length&&f.length==d.length?f.length:0,A=Array(r),L=Array(r),J=COG.easing(a.easing),F=
a.duration,O=a.progress,t=function(G){var M=G-c;G=c+F<=G;for(var U=b.layer?b.layer.view:null,W,ja=r;ja--;){W=J(M,f[ja],A[ja],F);L[ja]=k?W|0:W}g.apply(b,L);i&&U&&U.invalidate();if(O){M=[].concat(G?d:L);M.unshift(G);O.apply(b,M)}if(G){b.animations--;g.apply(b,d);a.complete&&a.complete.apply(b,d)}else h(t)};if(g&&g.apply&&r>0){F=F?F:DEFAULT_DURATION;for(e=r;e--;)A[e]=d[e]-f[e];b.animations++;h(t)}}function n(b){za.call(this,b)}function w(b,e){e=COG.extend({simplify:false,typeName:"Poly"},e);var f=e.simplify;
za.call(this,e);COG.extend(this,{resync:function(d){var a,c,g,k,i,r;d.syncXY(b);r=this.points=la.floor(f?la.simplify(b):b);for(var A=r.length;A--;){d=r[A].x;a=r[A].y;k=y(k,ta)||d<k?d:k;i=y(i,ta)||a<i?a:i;c=y(c,ta)||d>c?d:c;g=y(g,ta)||a>g?a:g}this.updateBounds(Da.init(k,i,c,g),true)}});this.haveData=b&&b.length>=2}function l(b,e){e.fill=false;w.call(this,b,e)}function o(b){function e(){var r,A;if(k&&k.width>0){if(!this.centerOffset)this.centerOffset=la.init(-k.width>>1,-k.height>>1);r=this.xy.x+this.centerOffset.x;
A=this.xy.y+this.centerOffset.y;this.updateBounds(Da.init(r,A,r+k.width,A+k.height),false)}}function f(r){if(this.imageUrl=r){var A=this;m(this.imageUrl,function(L,J){k=L;if(J){var F=i.layer?i.layer.view:null;F&&F.invalidate()}e.apply(A)})}}b=COG.extend({image:null,imageUrl:null,centerOffset:null,typeName:"Image"},b);var d=null,a=za.prototype.resync,c=0,g=0,k=b.image;za.call(this,b);var i=COG.extend(this,{changeImage:f,drag:function(r,A,L,J){d||(d=la.init(r.startX-this.xy.x,r.startY-this.xy.y));this.xy.x=
A-d.x;this.xy.y=L-d.y;if(J){d=null;if(this.layer)if(r=this.layer.view){r.syncXY([this.xy],true);r.invalidate()}this.trigger("dragDrop")}return true},getProps:function(){this.bounds||e(this,k);return{image:k,x:this.xy.x+c,y:this.xy.y+g}},resync:function(r){a.call(this,r);e.call(this)}});k||f.call(this,this.imageUrl);if(this.centerOffset){c=this.centerOffset.x;g=this.centerOffset.y}}function q(b){b=COG.extend({imageAnchor:null},b);if(b.imageAnchor)b.centerOffset=la.invert(b.imageAnchor);o.call(this,
b)}function N(b){b=COG.extend({startAngle:0,endAngle:Math.PI*2,typeName:"Arc"},b);za.call(this,b)}function H(b){b=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,validStates:C("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);this.view=null;COG.observable(COG.extend(this,b))}function B(b){for(var e=null,f=1;!e&&f<arguments.length;f++)e=ka(b,arguments[f]);e=e?e:ka(b);if(!e)throw Error("Unable to find GEO engine with "+b+" capability");return e}function P(b){b=parseFloat(b)*
Ea;b=sa(b);var e=bb*b;return ca((1+b)/(1-b)*E((1-e)/(1+e),bb))/2}function V(b){return R/(256<<b)}function ka(b,e){var f=null;for(var d in Pa)if(e){if(d==e&&Pa[d][b]){f=Pa[d];break}}else if(Pa[d][b]){f=Pa[d];break}return f}function ma(b,e){var f=bb*sa(b);return ea-2*Y(e*E((1-f)/(1+f),bb/2))}function Z(b,e,f,d){e=ia(e);b.add(d(e,f));return e.length}function ia(b){var e=b?b.length:0,f=Array(e);for(e=e;e--;)f[e]=ha.init(b[e][1],b[e][0]);return ha.vectorize(f,wb)}window.animFrame=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var R=Math.PI*2,ea=Math.PI/2,ba=Math.abs,X=Math.ceil,T=Math.min,da=Math.max,E=Math.pow,S=Math.sqrt,ca=Math.log,ua=Math.round,sa=Math.sin,Q=Math.asin,aa=Math.cos,Y=Math.atan,va=Math.atan2,ya="hasOwnProperty",Ca={NaN:1,Infinity:1,"-Infinity":1},Wa=String.prototype.toLowerCase,Rb=Object.prototype.toString,
ta="undefined",xb="number",Wb=typeof G_vmlCanvasManager!=ta,ab=typeof FlashCanvas!=ta,la=function(){function b(d,a){return f(d.x-a.x,d.y-a.y)}function e(d,a){a=a||d.length;if(a<=1)return null;for(var c=Array(a-1),g=Array(a-1),k=0,i,r=0;r<a-1;r++){i=b(d[r],d[r+1]);c[r]=S(i.x*i.x+i.y*i.y);g[r]=k+=c[r]}return{edges:c,accrued:g,tota:k}}function f(d,a){return{x:d||0,y:a||0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var d=0,a=0,c=arguments.length;c--;){d+=arguments[c].x;
a+=arguments[c].y}return f(d,a)},absSize:function(d){return da(ba(d.x),ba(d.y))},copy:function(d){return d?f(d.x,d.y):null},diff:b,distance:function(d,a){return e(d,a).total},edges:e,equals:function(d,a){return d.x===a.x&&d.y===a.y},extendBy:function(d,a,c){var g=aa(a)*c|0;a=sa(a)*c|0;return f(d.x-g,d.y-a)},floor:function(d){for(var a=Array(d.length),c=d.length;c--;)a[c]=f(~~d[c].x,~~d[c].y);return a},getRect:function(d){for(var a,c,g,k,i=d.length;i--;){var r=d[i];a=y(a,ta)||r.x<a?r.x:a;c=y(c,ta)||
r.y<c?r.y:c;g=y(g,ta)||r.x>g?r.x:g;k=y(k,ta)||r.y>k?r.y:k}return Da.init(a,c,g,k)},init:f,invert:function(d){return f(-d.x,-d.y)},min:function(d,a){return f(d.x<a.x?d.x:a.x,d.y<a.y?d.y:a.y)},max:function(d,a){return f(d.x>a.x?d.x:a.x,d.y>a.y?d.y:a.y)},offset:function(d,a,c){return f(d.x+a,d.y+(c||a))},scale:function(d,a){return f(d.x/a|0,d.y/a|0)},simplify:function(d,a){if(!d)return null;a=a?a:la.VECTOR_SIMPLIFICATION;for(var c=[],g=null,k=d.length;k--;){var i=d[k];if(include=!g||k===0||ba(i.x-g.x)+
ba(i.y-g.y)>a){c.unshift(i);g=i}}return c},theta:function(d,a,c){c=Q((d.y-a.y)/c);return d.x>a.x?c:Math.PI-c},toString:function(d){return d?d.x+", "+d.y:""}}}(),hb=function(){return{dotProduct:function(b,e){return b.x*e.x+b.y*e.y}}}(),Da=function(){function b(f){return e(f.x,f.y,f.x2,f.y2)}function e(f,d,a,c){f=f||0;d=d||0;a=a||f;c=c||d;return{x:f,y:d,x2:a,y2:c,w:a-f,h:c-d}}return{buffer:function(f,d,a){return la.init(f.x-d,f.y-(a||d),f.x+d,f.y+(a||d))},center:function(f){return la.init(f.x+(f.w>>
1),f.y+(f.h>>1))},copy:b,diagonalSize:function(f){return S(f.w*f.w+f.h*f.h)},fromCenter:function(f,d,a,c){a=a>>1;c=c>>1;return e(f-a,d-c,f+a,d+c)},init:e,intersect:function(f,d){var a=da(f.x,d.x),c=da(f.y,d.y),g=T(f.x2,d.x2),k=T(f.y2,d.y2);a=e(a,c,g,k);return a.w>0&&a.h>0?a:null},toString:function(f){return f?"["+f.x+", "+f.y+", "+f.x2+", "+f.y2+"]":""},union:function(f,d){if(f.w===0||f.h===0)return b(d);else if(d.w===0||d.h===0)return b(f);else{var a=T(f.x,d.x),c=T(f.y,d.y),g=da(f.x2,d.x2),k=da(f.y2,
d.y2);a=e(a,c,g,k);return a.w>0&&a.h>0?a:null}}}}(),ib=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return la.init(b.width>>1,b.height>>1)},getSize:function(b){return S(E(b.width,2)+E(b.height,2))},init:function(b,e){b=b?b:0;return{width:b,height:e?e:b}}}}();Hits=function(){return{diffHits:function(b,e){var f=[],d={},a;for(a=e.length;a--;)d[e[a].target.id]=true;for(a=b.length;a--;)d[b[a].target.id]||(f[f.length]=b[a]);return f},init:function(b,
e,f,d){return{type:b,x:d.x|0,y:d.y|0,elements:[],absXY:e,relXY:f}},initHit:function(b,e,f){return{type:b,target:e,drag:f}},triggerEvent:function(b,e,f,d){e.triggerCustom(b.type+(f?f:"Hit"),{hitType:b.type},d?d:b.elements,b.absXY,b.relXY,la.init(b.x,b.y))}}}();var Xb=T5.newCanvas=function(b,e){var f=document.createElement("canvas");f.width=b?b:0;f.height=e?e:0;if(ab){document.body.appendChild(f);FlashCanvas.initElement(f)}Wb&&G_vmlCanvasManager.initElement(f);return f},yb=function(){var b={};return{init:function(e,
f){var d=b[e];if(!d)throw Error("Unable to locate requested generator: "+e);return new d(f)},register:function(e,f){b[e]=f}}}(),Sb=3E4,ub={},Tb=0;(new Date).getTime();var Oa={},Ta=[];p.prototype={constructor:p,load:function(b){var e=this;m(this.url,function(f){e.loaded=true;e.image=f;b&&b()})}};var Yb=function(){return{applyStyle:function(){},applyTransform:function(b,e,f){return{restore:null,x:e,y:f}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getOffset:function(){return la.init(0,
0)},getViewport:function(){},hitTest:function(){return false},prepare:function(){},render:function(){},reset:function(){}}},zb={},Qa=u.registerRenderer=function(b,e){zb[b]=e},Ab=u.attachRenderer=function(b,e,f,d){b=b.split("/");for(var a=new Yb(e,f,d),c=0;c<b.length;c++){var g=zb[b[c]];if(g)a=new g(e,f,d,a)}return a};Qa("canvas",function(b,e,f,d){function a(t,G,M,U){var W=false;if(G)W=i.isPointInPath(J?G.x-r:G.relXY.x,J?G.y-A:G.relXY.y);return{draw:U||O,viewport:t,state:M,hit:W,vpX:r,vpY:A,context:i}}
f=COG.extend({},f);var c,g,k,i,r=0,A=0,L=null,J=CANI.canvas.pipTransformed,F={},O=function(){this.fill&&i.fill();this.stroke&&i.stroke()};(function(){if(e){var t=e.tagName=="CANVAS",G=t?e.parentNode:e;c=b.width=G.offsetWidth;g=b.height=G.offsetHeight;if(t){k=e;k.width=c;k.height=g;ab&&FlashCanvas.initElement(k)}else{k=Xb(c,g);k.style.cssText="position: absolute; z-index: 1;";e.appendChild(k)}i=null}})();return COG.extend(d,{interactTarget:k,applyStyle:function(t){var G=Zb(t),M=G&&i&&i.canvas?F[i.canvas.id]:
null;if(G){F[i.canvas.id]=t;G.applyToContext(i);return M}},applyTransform:function(t){if(t.translateX!==0||t.translateY!==0||t.scaling!==1||t.rotation!==0){i.save();L={undo:function(){i.restore();L=null},x:t.xy.x,y:t.xy.y};i.translate(t.xy.x-r+t.translateX,t.xy.y-A+t.translateY);t.rotation!==0&&i.rotate(t.rotation);t.scaling!==1&&i.scale(t.scaling,t.scaling)}return L},drawTiles:function(t,G){for(var M,U,W=r-256,ja=A-256,Aa=t.x2,qa=t.y2,Fa=G.length;Fa--;){M=G[Fa];if(U=M.x>=W&&M.x<=Aa&&M.y>=ja&&M.y<=
qa)M.loaded?i.drawImage(M.image,M.x-r,M.y-A):M.load(b.invalidate)}},hitTest:function(t,G,M){return i.isPointInPath(G,M)},prepare:function(t,G){var M,U=false;b.getOffset();var W=b.getScaleFactor();if(i)i.restore();else i=k.getContext("2d");for(M=t.length;M--;)U=U||t[M].clip;r=G.x;A=G.y;if(i){U||i.clearRect(0,0,c,g);i.save();i.scale(W,W)}i.globalCompositeOperation="source-over";return i},prepArc:function(t,G,M,U){i.beginPath();i.arc(t.xy.x-(L?L.x:r),t.xy.y-(L?L.y:A),t.size>>1,t.startAngle,t.endAngle,
false);return a(G,M,U)},prepImage:function(t,G,M,U,W){var ja=(W.x||t.xy.x)-(L?L.x:r),Aa=(W.y||t.xy.y)-(L?L.y:A),qa=W.image||t.image;if(qa){i.beginPath();i.rect(ja,Aa,W.width||qa.width,W.height||qa.height);return a(G,M,U,function(){i.drawImage(qa,ja,Aa,W.width||qa.width,W.height||qa.height)})}},prepPoly:function(t,G,M,U,W){var ja=true;t=W.points||t.points;W=L?L.x:r;var Aa=L?L.y:A;i.beginPath();for(var qa=t.length;qa--;){var Fa=t[qa].x-W,cb=t[qa].y-Aa;if(ja){i.moveTo(Fa,cb);ja=false}else i.lineTo(Fa,
cb)}return a(G,M,U)},getContext:function(){return i},getDimensions:function(){return{width:c,height:g}},getOffset:function(){return la.init(r,A)},render:function(t){i.strokeStyle="#F00";i.rect(t.x-r,t.y-A,t.w,t.h);i.stroke()}})});Qa("dom",function(b,e,f,d){var a=typeof e.style["-webkit-transform"]!="undefined",c=null;c=document.createElement("div");c.id=COG.objId("domImages");c.style.cssText=COG.formatStr("position: absolute; overflow: hidden; width: {0}px; height: {1}px;",e.offsetWidth,e.offsetHeight);
e.insertBefore(c,d.interactTarget);return COG.extend(d,{drawTiles:function(g,k){for(var i,r,A,L=g.x,J=g.y,F=L-256,O=J-256,t=L+g.w,G=J+g.h,M,U,W=k.length;W--;){i=k[W];r=i.image;A=i.x>=F&&i.x<=t&&i.y>=O&&i.y<=G;M=i.x-L;U=i.y-J;if(!r){r=i.image=new Image;r.src=i.url;c.appendChild(r);r.style.cssText="-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;"}if(a)r.style["-webkit-transform"]=
"translate3d("+M+"px, "+U+"px, 0px)";else{r.style.left=M+"px";r.style.top=U+"px"}r.style.display=A?"block":"none"}},reset:function(){c.innerHTML=""}})});var Bb={},$b=u.defineStyle=function(b,e){Bb[b]=v(e);return b},Cb=u.defineStyles=function(b){for(var e in b)$b(e,b[e])},Zb=u.getStyle=function(b){return Bb[b]};u.loadStyles=function(b){COG.jsonp(b,function(e){Cb(e)})};Cb({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},
waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});var Ub={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Kb=function(b){function e(z,D,K){Ga||Fa(na-D,oa-K)}function f(z,D,K,$){ja(T(da(pa+E(2,$)-1,0.5),2))}function d(){var z=ca(pa)/Math.LN2|0;if(z!==0){pa=E(2,z);Aa(Ya+z,ac,bc)}redraw=true}function a(z,D){var K=ga.getViewport(),$=1/pa;return la.init(K?K.x+z*$:z,K?K.y+D*$:D)}function c(z,D,K){qa("doubleTap",D,K,a(K.x,K.y));b.scalable&&ja(2,a(K.x,K.y),b.zoomEasing,null,b.zoomDuration)}
function g(z,D,K){Ga=null;G("down",D,K)}function k(z,D,K){G("hover",D,K)}function i(z,D,K){O(D,K,false)}function r(z,D,K){O(D,K,true)}function A(){clearTimeout(Db);Db=setTimeout(function(){renderer.checkSize()},250)}function L(z,D,K){G("tap",D,K);qa("tap",D,K,a(K.x,K.y,true))}function J(z,D){D.id=z;D.added=I();D.view=ga;D.trigger("parentChange",ga,db,cc);ra.push(D);ra.sort(function(K,$){var fa=$.zindex-K.zindex;if(fa===0)fa=$.added-K.added;return fa});Ia=ra.length;return D}function F(){wa&&wa.unbind();
if(renderer){wa=INTERACT.watch(renderer.interactTarget);b.pannable&&wa.pannable().bind("pan",e);if(b.scalable){wa.bind("zoom",f);wa.bind("doubleTap",c)}wa.bind("pointerDown",g);wa.bind("pointerMove",i);wa.bind("pointerUp",r);b.captureHover&&wa.bind("pointerHover",k);wa.bind("tap",L)}}function O(z,D,K){if(Ga){z=a(D.x,D.y);if(Ga.drag.call(Ga.target,Ga,z.x,z.y,K))redraw=true;if(K)Ga=null}}function t(z){var D,K,$=false;z=z||(new Date).getTime();if($=z-Eb>dc){var fa=ba(na-jb),Ba=ba(oa-kb);D=na!==lb||oa!==
mb;K=pa!==Fb;if(D||K)Ra++;if(fa>=Gb||Ba>=Gb)W();ga.trigger("enterFrame",z,ec++);Eb=z}if($&&Ra){Ma=Hb|(pa!==1?Ib:0)|(D?nb:0)|(ob?Jb:0);pb=(D=(Ma&(Ib|nb))!==0)&&(Ma&Jb)===0;D=U();if(renderer.prepare(ra,D,Ma,z,xa)){Ra=0;for(ii=Ia;ii--;){K=ra[ii];if((Ma&K.validStates)!==0){$=K.style?renderer.applyStyle(K.style):null;K.draw(renderer,D,Ma,ga,z,xa);$&&renderer.applyStyle($)}}renderer.render(D);lb=na;mb=oa;Fb=pa}if(xa){z=xa?xa.elements:[];if(Za&&Za.type==="hover"){D=Hits.diffHits(Za.elements,z);D.length>
0&&Hits.triggerEvent(Za,ga,"Out",D)}if(z.length>0){K=xa.x;$=xa.y;for(D=z.length;D--;){fa=z[D];Ba=K;var Ja=$,Ha=fa&&fa.drag&&(!fa.canDrag||fa.canDrag(fa,Ba,Ja));if(Ha){Ga=fa;Ga.startX=Ba;Ga.startY=Ja}if(Ha)break}Hits.triggerEvent(xa,ga)}Za=z.length>0?COG.extend({},xa):null;xa=null}}animFrame(t)}function G(z,D,K){xa=Hits.init(z,D,K,a(K.x,K.y,true));for(z=Ia;z--;)qb=qb||(ra[z].hitGuess?ra[z].hitGuess(xa.x,xa.y,Ma,ga):false);qb&&Ra++}function M(){Ra++}function U(){var z;z=pa!==1?Da.fromCenter(na+(ga.width>>
1),oa+(ga.height>>1),ga.width/pa|0,ga.height/pa|0):Da.init(na,oa,na+ga.width,oa+ga.height);z.scaleFactor=pa;return z}function W(){var z=U();if(z){if(Ua||Va)if(z){var D=eb?na+(z.w>>1):na,K=fb?oa+(z.h>>1):oa,$=z.w,fa=z.h;if(Ua&&Ua>$)if(D+$>Ua)na=eb?na:Ua-$;else if(D<0)na=eb?na:0;if(Va&&Va>fa)if(K+fa>Va)oa=fb?oa:Va-fa;else if(K<0)oa=fb?oa:0}jb=na;kb=oa;qa("refresh",ga,z);Ra++}}function ja(z,D,K,$,fa){if(K)COG.tweenValue(pa,z,K,fa,function(Ba,Ja){pa=Ba;if(Ja){var Ha=ua(ca(pa)/Math.LN2);pa=E(2,Ha);$&&
$()}d()});else{pa=z;d()}return ga}function Aa(z,D,K){z=da(b.minZoom,T(b.maxZoom,z));if(z!==Ya){var $=E(2,z-Ya),fa=ga.width>>1,Ba=ga.height>>1,Ja=fa/$|0,Ha=Ba/$|0;Ya=z;Fa(((D?D:na+fa)-Ja)*$,((K?K:oa+Ba)-Ha)*$);lb=na;mb=oa;kb=jb=0;qa("zoomLevelChange",z);pa=1;renderer.reset();W()}}function qa(){for(var z=ga.trigger.apply(null,arguments).cancel,D=ra.length;D--;)z=ra[D].trigger.apply(null,arguments).cancel||z;return!z}function Fa(z,D,K,$,fa){function Ba(){Ja+=1;if(Ja>=2){ob=false;fa&&fa()}}var Ja=0;if(K){if((Ma&
nb)===0){COG.tweenValue(na,z,K,$,function(Ha,rb){na=Ha|0;(rb?Ba:M)();return!pb});COG.tweenValue(oa,D,K,$,function(Ha,rb){oa=Ha|0;(rb?Ba:M)();return!pb});ob=true}}else{na=z|0;oa=D|0;fa&&fa()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,inertia:true,refreshDistance:256,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,
minZoom:1,maxZoom:1,renderer:"canvas",zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var cb={},ra=[],Ia=0,db=document.getElementById(b.container),Ga=null,ec=0,cc=null,fc=y(window.attachEvent,"function"),qb=false,Gb=b.refreshDistance,na=0,oa=0,jb=0,kb=0,lb=0,mb=0,Ua=null,Va=null,eb=false,fb=false,xa=null,pb=false,Za=null,Db=0,pa=1,Fb=1,Eb=0,wa=null,ob=false,dc=1E3/b.fps|0,Ra=0,ac,bc,Ya=b.zoomLevel,Hb=C("ACTIVE"),nb=C("PAN"),Ib=C("ZOOM"),Jb=C("ANIMATING"),Ma=Hb,ga={id:b.id,detach:function(){wa&&
wa.unbind()},eachLayer:function(z){for(var D=Ia;D--;)z(ra[D])},getLayer:function(z){for(var D=0;D<Ia;D++)if(ra[D].id===z)return ra[D];return null},getZoomLevel:function(){return Ya},setLayer:function(z,D){for(var K=0;K<Ia;K++)if(ra[K].id===z){ra.splice(K,1);break}D&&J(z,D);W();return D},invalidate:M,refresh:W,resetScale:function(){pa=1},scale:ja,setZoomLevel:Aa,syncXY:function(){},triggerAll:qa,removeLayer:function(z){a:{for(var D=Ia;D--;)if(ra[D].id===z){z=D;break a}z=-1}if(z>=0&&z<Ia){ga.trigger("layerRemoved",
ra[z]);ra.splice(z,1);Ra++}Ia=ra.length},getOffset:function(){return la.init(na,oa)},getRenderer:function(){return renderer},getScaleFactor:function(){return pa},setMaxOffset:function(z,D,K,$){Ua=z;Va=D;eb=K;fb=$},getViewport:U,updateOffset:Fa,pan:function(z,D,K,$,fa){Fa(na+z,oa+D,K,$,fa)}};COG.observable(ga);ga.bind("resync",function(){});COG.configurable(ga,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,null,{container:function(z,
D){db=document.getElementById(D);renderer=Ab(b.renderer,ga,db);F()},inertia:F,captureHover:F,scalable:F,pannable:F}),true);CANI.init(function(z){ga.markers=J("markers",new gb({zindex:20}));cb=z;renderer=Ab(b.renderer,ga,db);F();fc?window.attachEvent("onresize",A):window.addEventListener("resize",A,false)});animFrame(t);return ga},za=function(b){b=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},typeName:"Shape"},b);COG.extend(this,b);this.id=
COG.objId(this.typeName);this.view=this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};za.prototype={constructor:za,animate:function(b,e,f,d){j(this,b,e,f,d)},drag:null,draw:null,getProps:null,resync:function(b){if(this.xy){b.syncXY([this.xy]);this.size&&this.updateBounds(Da.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},rotate:function(b){this.rotation=b},scale:function(b){this.scaling=b},translate:function(b,
e){this.translateX=b;this.translateY=e},updateBounds:function(b,e){this.bounds=b;if(e)this.xy=Da.center(this.bounds)}};var Vb=1E3/60|0,Xa=[],vb=0;n.prototype=COG.extend(za.prototype,{constructor:n,prep:function(b){return b.arc(this.xy.x,this.xy.y,this.size>>1,0,Math.PI*2)}});w.prototype=COG.extend({},za.prototype,{constructor:w});l.prototype=COG.extend({},w.prototype);o.prototype=COG.extend({},za.prototype,{constructor:o});q.prototype=COG.extend({},o.prototype,{constructor:q});N.prototype=COG.extend(za.prototype,
{constructor:N});H.prototype={constructor:H,clip:null,cycle:function(){},draw:function(){},hitGuess:null};Qa=function(b,e){function f(A,L){if(a&&i){k=a.search(i);i=null}var J=L&&L.getZoomLevel?L.getZoomLevel():0;c[J]||(c[J]=new RTree);a=c[J]}e=COG.extend({imageLoadArgs:{}},e);var d=b?yb.init(b,e).run:null,a=null,c=[],g=[],k=[],i=null,r=COG.extend(new H(e),{draw:function(A,L){A.drawTiles(L,g)}});r.bind("refresh",function(A,L,J){var F=(new Date).getTime();if(a){k=i?a.search(i):[];d(L,J,a,function(){g=
a.search(J);L.invalidate();COG.info("GEN COMPLETED IN "+((new Date).getTime()-F)+" ms")});i=Da.copy(J)}});r.bind("parentChange",f);r.bind("resync",f);return r};var Lb=function(b){function e(i){clearTimeout(g);g=setTimeout(function(){a.sort(function(r,A){if(A.xy&&r.xy){var L=A.xy.y-r.xy.y;return L!=0?L:A.xy.x-r.xy.x}});i&&i.invalidate()},50)}function f(i,r,A,L){c.remove(L,r);c.insert(A,r)}function d(i,r){c=new RTree;for(var A=a.length;A--;){var L=a[A];L.resync(r);L.bounds&&c.insert(L.bounds,c)}e(r)}
b=COG.extend({zindex:10},b);var a=[],c=null,g=0,k=COG.extend(new H(b),{add:function(i,r){if(i){i.layer=k;if(r)a.unshift(i);else a[a.length]=i;var A=k.view;if(A){i.resync(A);c&&i.bounds&&c.insert(i.bounds,c);e(A)}i.bind("move",f)}},clear:function(){a=[]},draw:function(i,r,A,L,J,F){L={};for(J=(c&&r?c.search(r):[]).length;J--;){var O=a[J],t=O.style||k.style,G,M=i.applyTransform(O),U=O.getProps?O.getProps(i,A):L;if(U=(G=i["prep"+O.typeName])?G.call(i,O,r,F,A,U):null){if(U.hit){F.elements.push(Hits.initHit(O.type,
O,O.draggable?O.drag:null));G=F.type+"Style";t=O[G]||k[G]||t}t=t?i.applyStyle(t):null;(G=O.draw||U.draw)&&G.call(O,U);t&&i.applyStyle(t)}M&&M.undo&&M.undo()}},find:function(){return[].concat(a)},hitGuess:function(i,r){return c&&c.search({x:i-10,y:r-10,w:20,h:20}).length>0}});k.bind("parentChange",d);k.bind("resync",d);return k},gb=function(b){return new Lb(b)};COG.extend(u,{ex:COG.extend,is:y,ticks:I,userMessage:function(b,e,f){u.trigger("userMessage",b,e,f)},XY:la,XYRect:Da,Dimensions:ib,Vector:hb,
Hits:Hits,Generator:yb,tweenValue:COG.tweenValue,easing:COG.easing,Tile:p,TileLayer:Qa,getImage:m,viewState:C,View:Kb,ViewLayer:H,ImageLayer:Qa,Drawable:za,Marker:n,Poly:w,Line:l,Arc:N,ImageDrawable:o,ImageMarker:q,DrawLayer:Lb,ShapeLayer:gb});COG.observable(u);var sb=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],Ea=Math.PI/180,Na=180/Math.PI,tb=ea,Mb=-tb,Nb=R,gc=-Nb,bb=0.08181919084262157,$a=null,Ob={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",
CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ha=function(){function b(a){return a?f(a.lat,a.lon):null}function e(a){return!a||a.lat===0&&a.lon===0}function f(a,c){return{lat:parseFloat(a?a:0),lon:parseFloat(c?c:0)}}function d(a){if(a)if(y(a.lat,xb))return b(a);else{if(a.split)for(var c=[" ",","],g=0;g<c.length;g++){var k=a.split(c[g]);if(k.length===2)return f(k[0],k[1])}}else return f();return null}return{calcDistance:function(a,c){if(e(a)||e(c))return 0;var g=(c.lat-a.lat)*Ea>>1,k=(c.lon-a.lon)*
Ea>>1;g=sa(g)*sa(g)+aa(a.lat*Ea)*aa(c.lat*Ea)*sa(k)*sa(k);return 6371*2*va(S(g),S(1-g))},copy:b,empty:e,equal:function(a,c){return a&&c&&a.lat==c.lat&&a.lon==c.lon},fromMercatorPixels:function(a,c){for(var g=E(Math.E,-c),k=ea-2*Y(g),i=ma(k,g),r=0;r<12&&ba(k-i)>1.0E-7;){k=i;i=ma(k,g);r++}return f(i*Na,a%360*Na)},generalize:function(a,c,g){var k=a.length,i=[],r=null;g||(g=250);g/=1E3;COG.info("generalizing positions, must include "+c.length+" positions");for(var A=k;A--;)if(A===0)i.unshift(a[A]);else{var L=
!r||ha.inArray(a[A],c)?g:ha.calcDistance(r,a[A]);if(a[A]&&L>=g){i.unshift(a[A]);r=a[A]}}COG.info("generalized "+k+" positions into "+i.length+" positions");return i},inArray:function(a,c){for(var g=ha.equal,k=c.length;k--;)if(g(a,c[k]))return true;return false},inBounds:function(a,c){var g=!(ha.empty(a)||ha.empty(c));return g=(g=g&&a.lat>=c.min.lat&&a.lat<=c.max.lat)&&a.lon>=c.min.lon&&a.lon<=c.max.lon},init:f,offset:function(a,c,g){var k=a.lat*Ea;a=a.lon*Ea;c=k+c/6371;g=Q(sa(g/6371)/aa(k));g=a+g;
c=(c+ea)%Math.PI-ea;g%=R;return f(c*Na,g*Na)},parse:d,parseArray:function(a){var c=a.length,g=Array(c);for(c=c;c--;)g[c]=d(a[c]);return g},toMercatorPixels:function(a){return T5.XY.init(parseFloat(a.lon)*Ea,P(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,c){function g(){for(var A=0,L=c.chunkSize,J=k;J--;){i[J]=T5.GeoXY.init(a[J]);A+=1;if(A>L)break}k=J;if(k<=0)c.callback&&c.callback(i);else animFrame(g)}var k=a.length,i=Array(k);c=COG.extend({chunkSize:500,async:true,
callback:null},c);if(!c.async){for(var r=k;r--;)i[r]=T5.GeoXY.init(a[r]);return i}animFrame(g);return null}}}(),Ka=function(){function b(a,c,g){var k=T5.XY.init(0,c.lat-a.lat);k.x=(g||y(g,ta))&&a.lon>c.lon?360-a.lon+c.lon:c.lon-a.lon;return k}function e(a,c){return Ka.init(ha.init(a.min.lat-c,a.min.lon-c%360),ha.init(a.max.lat+c,a.max.lon+c%360))}function f(a){var c=b(a.min,a.max);return ha.init(a.min.lat+(c.y>>1),a.min.lon+(c.x>>1))}function d(a,c){return{min:ha.parse(a),max:ha.parse(c)}}return{calcSize:b,
createBoundsFromCenter:function(a,c){var g=c/6371,k=a.lat*Ea,i=a.lon*Ea,r=k-g,A=k+g;if(r>Mb&&A<tb){k=Q(sa(g)/aa(k));g=(i-k)%R;i=(i+k)%R}else{r=da(r,Mb);A=T(A,tb);g=gc;i=Nb}return Ka.init(ha.init(r*Na,g*Na),ha.init(A*Na,i*Na))},expand:e,forPositions:function(a,c){var g=null,k=T5.ticks();c||(c="auto");for(var i=a.length;i--;)if(g){var r=b(g.min,a[i],false),A=b(a[i],g.max,false);if(r.x<0)g.min.lon=a[i].lon;if(r.y<0)g.min.lat=a[i].lat;if(A.x<0)g.max.lon=a[i].lon;if(A.y<0)g.max.lat=a[i].lat}else g=d(a[i],
a[i]);if(c){if(c=="auto"){i=b(g.min,g.max);c=da(i.x,i.y)*0.3}g=e(g,c)}COG.trace("calculated bounds for "+a.length+" positions",k);return g},getCenter:f,getGeoHash:function(a){var c=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+c+", max hash = "+a)},getZoomLevel:function(a,c){var g=f(a);g=T(ua(ba(g.lat)*0.05),sb.length);var k=sb[g],i=b(a.min,a.max);g=X(ca(sb[3]*c.h/i.y)/ca(2));k=X(ca(k*c.w/i.x)/ca(2));return T(isNaN(g)?1E3:g,isNaN(k)?
1E3:k)},init:d,isEmpty:function(a){return!a||ha.empty(a.min)||ha.empty(a.max)},toString:function(a){return"min: "+ha.toString(a.min)+", max: "+ha.toString(a.max)}}}();hb=function(){var b=/^(\d+).*$/,e=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(f,d){b.lastIndex=-1;if(b.test(f))for(var a=f.replace(b,"$1"),c=d.split(","),g=0;g<c.length;g++){e.lastIndex=-1;if(e.test(c[g])){var k=e.exec(c[g]);if(a>=parseInt(k[1],10)&&a<=parseInt(k[2],10))return true}else if(a==c[g])return true}return false},normalize:function(f){if(!f)return"";
f=f.toUpperCase();if(!$a){var d=[];for(var a in Ob)d.push(a);$a=RegExp("(\\s)("+d.join("|")+")(\\s|$)","i")}$a.lastIndex=-1;if(d=$a.exec(f))f=f.replace($a,"$1"+Ob[d[2]]);return f},toString:function(f){return f.streetDetails+" "+f.location}}}();var La=u.GeoXY=function(){function b(d,a){if(d.length){for(var c,g,k,i,r=d.length;r--;){b(d[r],a);c=y(c,ta)||d.x<c?d.x:c;g=y(g,ta)||d.y<g?d.y:g;k=y(k,ta)||d.x>k?d.x:k;i=y(i,ta)||d.y>i?d.y:i}return Da.init(c,g,i,i)}else if(d.mercXY){c=d.mercXY;d.x=(c.x+Math.PI)/
a|0;d.y=(Math.PI-c.y)/a|0;d.rpp=a}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return d}function e(d,a){if(d.length)for(var c=d.length;c--;)e(d[c],a);else{d.mercXY=la.init(d.x*a-Math.PI,Math.PI-d.y*a);d.pos=ha.fromMercatorPixels(d.mercXY.x,d.mercXY.y)}return d}function f(d,a,c){d.pos=a;d.mercXY=ha.toMercatorPixels(a);(c=y(c,xb)?c:d.rpp)&&b(d,c)}return{init:function(d,a){var c=la.init();f(c,d,a);return c},sync:b,syncPos:e,toPos:function(d,a){a=a||d.rpp;return ha.fromMercatorPixels(d.x*
a-Math.PI,Math.PI-d.y*a)},updatePos:f}}(),Pa={};ib=function(){return{bestResults:function(b,e){e||(e=20);for(var f=b.length>0?b[0]:null,d=[],a=0;a<b.length;a++)if(f&&b[a]&&f.matchWeight-b[a].matchWeight<=e)d.push(b[a]);else break;return d}}}();var Pb=function(b){b=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},b);return COG.extend(b,{toString:function(){return b.caption+(b.matchWeight?" ("+b.matchWeight+")":"")}})};Qa=function(){function b(a,c){var g=new T5.ShapeLayer;
c.geometry&&ha.vectorize(c.geometry,{callback:function(k){g.add(new T5.Line(k,{style:"waypoints",simplify:true}));a.setLayer("route",g)}})}function e(a){for(var c=f.Unknown,g=d,k=0;k<g.length;k++){g[k].regex.lastIndex=-1;var i=g[k].regex.exec(a);if(i){c=g[k].customCheck?g[k].customCheck(a,i):g[k].turnType;break}}return c}var f={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",
TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},d=function(){var a=[];a.push({regex:/continue/i,turnType:f.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(c,g){return/bear/i.test(g[1])?f.TurnLeftSlight:f.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(c,g){return/bear/i.test(g[1])?
f.TurnRightSlight:f.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:f.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:f.Ramp});a.push({regex:/take.*?exit/i,turnType:f.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(c,g){return/right/i.test(g[1])?f.UTurnRight:f.UTurnLeft}});a.push({regex:/proceed/i,turnType:f.Start});a.push({regex:/arrive/i,turnType:f.Arrive});a.push({regex:/fell\sthrough/i,turnType:f.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",
waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var c=B("route");c&&c.route(a,function(g){if(a.generalize)g.geometry=ha.generalize(g.geometry,g.getInstructionPositions());if(a.map){b(a.map,g);a.autoFit&&a.map.gotoBounds(g.boundingBox)}a.success&&a.success(g)})},createMapOverlay:b,parseTurnType:e,TurnType:f,Instruction:function(a){var c=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),g=a.description;g=g.replace(/(\w)(\/)(\w)/g,
"$1 $2 $3");c.description=g;if(!a.turnType)a.turnType=e(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Ka.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var c=[],g=0;g<a.instructions.length;g++)a.instructions[g].position&&c.push(a.instructions[g].position);return c}},a)}}}();var hc="featurecollection",ic="feature",wb={async:false},Sa={processor:null,group:"shapes",layerClass:gb},
jc={point:COG.extend({},Sa,{processor:function(b,e,f,d){e=ia([e.coordinates],wb);if(e.length>0)if(f=d.marker(e[0],f)){b.add(f);return e.length}},group:"markers",layerClass:gb}),linestring:COG.extend({},Sa,{processor:function(b,e,f,d){e=ia(e&&e.coordinates?e.coordinates:[]);return Z(b,e,f,d.line)}}),multilinestring:COG.extend({},Sa,{processor:function(b,e,f,d){e=e&&e.coordinates?e.coordinates:[];for(var a=0,c=e.length;c--;)a+=Z(b,e[c],f,d.line);return a}}),polygon:COG.extend({},Sa,{processor:function(b,
e,f,d){e=e&&e.coordinates?e.coordinates:[];if(e.length>0)return Z(b,e[0],f,d.poly);return 0}}),multipolygon:COG.extend({},Sa,{processor:function(b,e,f,d){e=e&&e.coordinates?e.coordinates:[];for(var a=0,c=0;c<e.length;c++)a+=Z(b,e[c][0],f,d.poly);return a}})},Qb=function(b,e,f,d){function a(t,G){var M=t.processor,U=r+t.group,W=COG.extend({},t,f,{properties:G.properties});if(M){var ja=O[U];if(!ja){ja=new t.layerClass({id:U});O[U]=ja}return M(ja,G.data,W,d)}return 0}function c(t,G){var M=t&&t.type?t.type.toLowerCase():
null;return M&&M===ic?c(t.geometry,t.properties):{type:M,isCollection:M?M===hc:false,definition:jc[M],data:t,properties:G?G:t.properties}}function g(t){var G=0,M=COG.extend({},f),U=A;t=t?t:(new Date).getTime();if(!J){for(;U<L;U++){t=c(i?i(b[U]):b[U]);var W=null;if(t.isCollection){M.layerPrefix=r+F++ +"-";J=new Qb(t.data.features,function(ja){J=null;for(var Aa in ja)O[Aa]=ja[Aa];A>=L&&e&&e(O)},M);W+=1}else if(t.definition)W=a(t.definition,t);G+=W?W:1;if(G>=k)break}A=U+1;if(J||A<L)animFrame(g);else e&&
e(O)}}f=COG.extend({rowPreParse:null,simplify:false,layerPrefix:"geojson-"},f);d=COG.extend({marker:function(t){return new n({xy:t})},line:function(t,G){return new w(t,COG.extend({},f,G))},poly:function(t,G){return new w(t,COG.extend({fill:true},f,G))}},d);var k=500,i=f.rowPreParse,r=f.layerPrefix,A=0,L=0,J=null,F=0,O={};if(b){y(b,"array")||(b=[b]);L=b.length;animFrame(g)}};Sa=u.GeoJSON={parse:function(b,e,f){return new Qb(b,e,f)}};u.Map=function(b){function e(F){try{var O=ha.init(F.coords.latitude,
F.coords.longitude),t=F.coords.accuracy/1E3;J.trigger("locationUpdate",F,t);if(r){if(!k){k=new UI.LocationOverlay({pos:O,accuracy:t});k.update(J.getTileLayer());J.setLayer("location",k)}var G=Ka.createBoundsFromCenter(O,Math.max(t,1));J.gotoBounds(G)}else{k.pos=O;k.accuracy=t;k.update(J.getTileLayer());a(O,null,COG.easing("sine.out"))}r=false}catch(M){COG.exception(M)}}function f(F){COG.info("caught location tracking error:",F)}function d(F,O,t){J.setZoomLevel(O);a(F,t)}function a(F,O,t,G){F=La.init(F,
V(J.getZoomLevel()));J.updateOffset(F.x-(J.width>>1),F.y-(J.height>>1),t,G,function(){O&&O(J)})}b=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,minZoom:1,maxZoom:18,pannable:true,scalable:true},b);var c={NONE:0,SINGLE:1,WATCH:2};la.init();var g=c.NONE,k=null,i=0,r=true,A=0,L=b.tapExtent;b.adjustScaleFactor=function(F){return Math.pow(2,(F<1?Math.floor:Math.ceil)(Math.log(F)))};var J=COG.extend(new Kb(b),{getBoundingBox:function(){var F=J.getViewport();return F?Ka.init(La.toPos(la.init(F.x,
F.y2),A),La.toPos(la.init(F.x2,F.y),A)):null},getCenterPosition:function(){var F=J.getViewport();if(F){F=la.init(F.x+(F.w>>1),F.y+(F.h>>1));return La.toPos(F,A)}return null},gotoBounds:function(F,O){var t=Ka.getZoomLevel(F,J.getViewport());d(Ka.getCenter(F),t,O)},gotoPosition:d,panToPosition:a,syncXY:function(F,O){return(O?La.syncPos:La.sync)(F,A)},locate:function(){J.trackStart(c.SINGLE);setTimeout(J.trackCancel,1E4)},trackStart:function(F){if(navigator.geolocation&&!i){g=F?F:c.WATCH;r=true;i=navigator.geolocation.watchPosition(e,
f,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){i&&navigator.geolocation&&navigator.geolocation.clearWatch(i);J.removeLayer("location");k=null;g=c.NONE;i=0},animateRoute:function(F,O,t,G){var M=J.getLayer("route");if(M)(F=M.getAnimation(F,O,t,G))&&F.addToView(J)}});J.bind("pan",function(){g===c.SINGLE&&J.trackCancel()});J.bind("tap",function(F,O,t,G){F=La.toPos(G,A);var M=La.toPos(la.offset(G,-L,L),A);G=La.toPos(la.offset(G,L,-L),A);J.trigger("geotap",O,t,F,Ka.init(M,
G))});J.bind("refresh",function(){J.trigger("boundsChange",J.getBoundingBox())});J.bind("zoomLevelChange",function(F,O){var t;A=V(O);t=R/A|0;J.setMaxOffset(t,t,true,false);J.resetScale();J.triggerAll("resync",J)});return J};u.GeoShape=function(b,e){e=COG.extend({autoParse:true},e);for(var f=Array(b.length),d=e.autoParse,a=T5.Geo.Position.parse,c=b.length;c--;)f[c]=T5.GeoXY.init(d?a(b[c]):b[c]);return new T5.Poly(f,e)};u.LocationOverlay=function(b){b=COG.extend({pos:null,accuracy:null,zindex:90},b);
var e=new Image,f=T5.XY.init(),d=T5.XY.init(),a=null;e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
e.onload=function(){f=T5.XY.init(e.width>>1,e.height>>1)};var c=COG.extend(new T5.ViewLayer(b),{pos:b.pos,accuracy:b.accuracy,drawAccuracyIndicator:false,draw:function(g,k){var i=d.x-k.x,r=d.y-k.y;if(a){g.fillStyle="rgba(30, 30, 30, 0.2)";g.beginPath();g.arc(i,r,a,0,Math.PI*2,false);g.fill()}e.complete&&e.width>0&&g.drawImage(e,i-f.x,r-f.y,e.width,e.height)},update:function(g){if(g){a=g.getPixelDistance(c.accuracy)>>1;d=g.getGridXYForPosition(c.pos)}}});c.bind("gridUpdate",function(g,k){c.update(k)});
return c};u.Geo={distanceToString:function(b){if(b>1E3)return~~(b/10)/100+" km";return b?b+" m":""},dist2rad:function(b){return b/6371},getEngine:B,radsPerPixel:V,Position:ha,BoundingBox:Ka,Radius:function(b,e){return{distance:parseInt(b,10),uom:e}},Address:function(b){return b=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},b)},A:hb,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(b){if(!b.id)throw Error("A GEO.Engine cannot be registered without providing an id.");
var e=COG.extend({remove:function(){delete Pa[e.id]}},b);return Pa[e.id]=e},Search:ib,GeoSearchResult:Pb,LocationSearch:function(b){function e(g,k){navigator.geolocation.clearWatch(d);d=0;if(a){clearTimeout(a);a=0}k&&k([g],b)}function f(g){COG.info("caught location tracking error:",g)}b=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},b);var d=0,a=0,c=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(g,k){if(navigator.geolocation&&!d){d=navigator.geolocation.watchPosition(function(i){var r=
ha.init(i.coords.latitude,i.coords.longitude);i=new Pb({id:1,caption:"Current Location",pos:r,accuracy:i.coords.accuracy/1E3,matchWeight:100});if(!c||i.accuracy<c.accuracy)c=i;if(!b.requiredAccuracy||c.accuracy<b.requiredAccuracy)e(c,k)},f,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(b.searchTimeout)a=setTimeout(function(){c&&e(c,k)},b.searchTimeout)}}},b))},Routing:Qa,GeoJSON:Sa}})(T5);
