COG=function(){var m=/\$\{(.*?)\}/ig,n=Object.prototype.hasOwnProperty,k=0,e={id:"grunt.core",extend:function(){var a=arguments[0]||{},d=1,h=arguments.length,b=false,o,f,l,g;if(typeof a==="boolean"){b=a;a=arguments[1]||{};d=2}if(typeof a!=="object"&&!e.isFunction(a))a={};if(h===d){a=this;--d}for(;d<h;d++)if((o=arguments[d])!=null)for(f in o){l=a[f];g=o[f];if(a!==g)if(b&&g&&(e.isPlainObject(g)||e.isArray(g))){l=l&&(e.isPlainObject(l)||e.isArray(l))?l:e.isArray(g)?[]:{};a[f]=e.extend(b,l,g)}else if(g!==
undefined)a[f]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return false;var d;for(d in a);return d===undefined||n.call(a,d)},isEmptyObject:function(a){for(var d in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,d){var h=a,b=arguments,o=1;if(d&&e.isArray(d)){b=d;o=0}for(o=o;o<b;o++)h=h&&typeof foo[b[o]]!=="undefined";return h},newModule:function(a){a=e.extend({id:null,requires:[],parent:null},a);if(a.parent)a=e.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+k++},formatStr:function(a){if(arguments.length<=1)return a;for(var d=arguments.length-2,h=0;h<=d;h++)a=a.replace(RegExp("\\{"+h+"\\}","gi"),arguments[h+
1]);return a},wordExists:function(a,d){var h="";if(d.toString)d=d.toString();for(var b=0;b<d.length;b++)h+=!/\w/.test(d[b])?"\\"+d[b]:d[b];return RegExp("(^|\\s|\\,)"+h+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,d){for(var h=m.exec(a);h;){a=a.replace(h[0],COG.XPath.first(h[1],d));m.lastIndex=0;h=m.exec(a)}return a}};return e}();
COG.Log=function(){function m(d,h){var b,o=h&&h.length>0?h[0]:"";for(b=1;h&&b<h.length;b++)o+=" "+(k&&COG.isPlainObject(h[b])?JSON.stringify(h[b]):h[b]);typeof console!=="undefined"&&console[d](o);for(b=0;b<n.length;b++)n[b].call(a,o,d)}var n=[],k=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(d,h){if(e)console.markTimeline(d+(h?": "+(a.getTraceTicks()-h)+"ms":""))},debug:function(){m("debug",
arguments)},info:function(){m("info",arguments)},warn:function(){m("warn",arguments)},error:function(){m("error",arguments)},exception:function(d){a.error(arguments);for(var h in d)a.info("ERROR DETAIL: "+h+": "+d[h])},watch:function(d,h){try{h()}catch(b){a.exception(b,d)}},throwError:function(d){a.error(d);throw Error(d);},requestUpdates:function(d){n.push(d)}};return a}();
(function(){function m(e,a){e[a]||(e[a]=function(d){return e.configure(a,d)})}function n(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var k={};COG.paramTweaker=function(e,a,d){return function(h,b){if(typeof b!=="undefined"){if(h in e)e[h]=b;d&&h in d&&d[h](h,b)}else return a&&h in a?a[h](h):e[h]}};COG.configurable=function(e,a,d,h){if(e){e.gtConfId||n(e);var b=e.gtConfId,o=e.gtConfig,f=e.gtConfigFns;k[b]=e;f.push(d);for(d=a.length;d--;){o[a[d]]=true;h&&
m(e,a[d])}if(!e.configure)e.configure=function(l,g){if(o[l]){for(var q=f.length;q--;){var v=f[q](l,g);if(typeof v!=="undefined")return v}return k[b]}return null}}}})();
(function(){function m(n,k){var e=n.gtObsHandlers;e[k]||(e[k]=[]);return e[k]}COG.observable=function(n){if(n){if(!n.gtObsHandlers)n.gtObsHandlers={};if(!(n.bind||n.trigger||n.unbind)){n.bind=function(k,e){var a=COG.objId("callback");m(n,k).unshift({fn:e,id:a});return a};n.trigger=function(k){var e=m(n,k),a={cancel:false,tickCount:(new Date).getTime()},d;if(!e)return null;d=Array.prototype.slice.call(arguments,1);d.unshift(a);for(var h=e.length;h--&&!a.cancel;)e[h].fn.apply(self,d);return a};n.unbind=
function(k,e){for(var a=m(n,k),d=0;a&&d<a.length;d++)if(a[d].id===e){a.splice(d,1);break}return n}}}}})();(function(){var m={},n=[];COG.addPipe=function(k){k("pipe.test",{});n.push(k)};COG.listen=function(k,e){m[k]||(m[k]=[]);e&&m[k].push(e)};COG.say=function(k,e){var a;for(a=n.length;a--;)n[a](k,e);if(m[k])for(a=m[k].length;a--;)m[k][a](e)}})();
COG.Loopage=function(){function m(g){return COG.extend({id:d++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function n(g){b.push(g);k()}function k(){o&&clearTimeout(o);o=setTimeout(e,0);l=true}function e(){for(var g,q=(new Date).getTime(),v=h.length;b.length>0;){var C=b.shift();for(g=v;g--;)if(h[g].id===C){h.splice(g,1);break}l=true;v=h.length}if(l){f=a;for(g=v;g--;)f=h[g].frequency<f?h[g].frequency:f}for(g=v;g--;){C=q-h[g].lastTick;if(h[g].lastTick===0||C>=h[g].frequency){h[g].execute(q,
h[g]);h[g].lastTick=q;h[g].single&&h[g].trigger("complete")}}o=v?setTimeout(e,f):0}var a=6E4,d=0,h=[],b=[],o=0,f=a,l=true;return{join:function(g){var q=new m(g);if(q.after>0)q.lastTick=(new Date).getTime()+q.after;COG.observable(q);q.bind("complete",function(){n(q.id)});h.unshift(q);k();return q},leave:n}}();if(!this.JSON)this.JSON={};
(function(){function m(f){return f<10?"0"+f:f}function n(f){a.lastIndex=0;return a.test(f)?'"'+f.replace(a,function(l){var g=b[l];return typeof g==="string"?g:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function k(f,l){var g,q,v,C,B=d,s,u=l[f];if(u&&typeof u==="object"&&typeof u.toJSON==="function")u=u.toJSON(f);if(typeof o==="function")u=o.call(l,f,u);switch(typeof u){case "string":return n(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";d+=h;s=[];if(Object.prototype.toString.apply(u)==="[object Array]"){C=u.length;for(g=0;g<C;g+=1)s[g]=k(g,u)||"null";v=s.length===0?"[]":d?"[\n"+d+s.join(",\n"+d)+"\n"+B+"]":"["+s.join(",")+"]";d=B;return v}if(o&&typeof o==="object"){C=o.length;for(g=0;g<C;g+=1){q=o[g];if(typeof q==="string")if(v=k(q,u))s.push(n(q)+(d?": ":":")+v)}}else for(q in u)if(Object.hasOwnProperty.call(u,q))if(v=k(q,u))s.push(n(q)+(d?": ":":")+v);v=s.length===0?"{}":d?"{\n"+d+s.join(",\n"+d)+
"\n"+B+"}":"{"+s.join(",")+"}";d=B;return v}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+m(this.getUTCMonth()+1)+"-"+m(this.getUTCDate())+"T"+m(this.getUTCHours())+":"+m(this.getUTCMinutes())+":"+m(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,h,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;if(typeof JSON.stringify!=="function")JSON.stringify=function(f,l,g){var q;h=d="";if(typeof g==="number")for(q=0;q<g;q+=1)h+=" ";else if(typeof g==="string")h=g;if((o=l)&&typeof l!=="function"&&(typeof l!=="object"||typeof l.length!=="number"))throw Error("JSON.stringify");return k("",
{"":f})};if(typeof JSON.parse!=="function")JSON.parse=function(f,l){function g(v,C){var B,s,u=v[C];if(u&&typeof u==="object")for(B in u)if(Object.hasOwnProperty.call(u,B)){s=g(u,B);if(s!==undefined)u[B]=s;else delete u[B]}return l.call(v,C,u)}var q;f=String(f);e.lastIndex=0;if(e.test(f))f=f.replace(e,function(v){return"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){q=eval("("+f+")");return typeof l==="function"?g({"":q},""):q}throw new SyntaxError("JSON.parse");}})();
(function(){function m(k,e){var a=k.split("|"),d={};for(var h in e){var b=e[h];d[h]=a.length>b?a[b]:null}return d}var n={JSON:{parse:function(k){return JSON.parse(k)}},PDON:{parse:function(k){var e=null,a=[];k=k.split("\n");for(var d=0;d<k.length;d++){var h=k[d];if(e)a.push(m(h,e));else if(h){e=h.split("|");h={};for(var b=0;b<e.length;b++)h[e[b]]=b;e=h}else e=null}return a}}};COG.parseData=function(k,e){e=e?e.toUpperCase():"JSON";if(!n[e])throw Error("Unsupported data format: "+e);try{return n[e].parse(k)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function m(a){for(var d=null,h=0;h<n.length;h++)if(d=n[h](a))break;return d}var n=[],k=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(a){return{toString:function(){var d=
null;if(a){var h=null;if(a.resultType>=0&&a.resultType<k.length)h=k[a.resultType];if(h)d=h(a)}return d?d:""}}},first:function(a,d){var h=e.SearchResult,b;var o=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!o)o=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(d))b=d.evaluate(a,d,m,o,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(f){COG.Log.warn("invalid xpath expression: "+a+" on node: "+d);b=null}return new h(b)},registerResolver:function(a){n.push(a)}};return e}();
COG.Storage=function(){function m(n){if(n&&n=="session")return sessionStorage;return localStorage}return{get:function(n,k){var e=m(k).getItem(n);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(n,k,e){k=jQuery.isArray(k)||jQuery.isPlainObject(k)?JSON.stringify(k):k;m(e).setItem(n,k)},remove:function(n,k){m(k).removeItem(n)}}}();
COG.ParseRules=function(){var m=[];return{add:function(n,k){m.push({regex:n,handler:k})},each:function(n,k,e){function a(){d++;e&&d>=m.length&&e(k)}for(var d=0,h=0;h<m.length;h++){var b=m[h].regex,o=m[h].handler,f=false;if(b){b.lastIndex=-1;if((b=b.exec(n))&&o){f=true;o(b,k,a)&&a()}}f||a()}}}};
(function(){function m(b){var o=[],f=function(g,q){q=COG.isFunction(q)?q():q;o[o.length]=encodeURIComponent(g)+"="+encodeURIComponent(q)};if(COG.isArray(b))for(var l=0;l<b.length;l++)f(b[l].name,b[l].value);else for(l in b)f(l,b[l]);return o.join("&").replace(/%20/g,"+")}var n={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},k={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,d={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},h={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function o(){if(this.readyState===4){var q=null,v=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(v)if(b.handleResponse)b.handleResponse(this);else{var C=b,B=this.getResponseHeader(h.CONTENT_TYPE),s,u=false;for(s in n)if(B&&B.indexOf(n[s])>=0){u=true;
break}B=!u;for(u=0;u<e.length;u++)B=B||e[u]==s;if(B)b:{B=s;for(var x in k)for(u=0;u<k[x].length;u++)if(RegExp(k[x][u]+"$","i").test(C.url)){s=x;break b}s=B?B:"DEFAULT"}try{q=d[s](this,C)}catch(z){q=d.DEFAULT(this,C)}}else b.error&&b.error(this)}catch(J){COG.Log.exception(J,"PROCESSING AJAX RESPONSE")}v&&q&&b.success&&b.success.call(this,q)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var f=
a.exec(b.url),l=f&&(f[1]&&f[1]!==location.protocol||f[2]!==location.host);if(b.data)b.method="POST";if(b.url){f=null;if(b.xhr)f=b.xhr(b);f||(f=new XMLHttpRequest);f.open(b.method,b.url,b.async);b.data&&f.setRequestHeader("Content-Type",b.contentType);l||f.setRequestHeader("X-Requested-With","XMLHttpRequest");f.onreadystatechange=o;f.send(b.method=="POST"?m(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function m(a){var d=document.createElement("script"),h=false;d.src=a;d.async=true;d.onload=d.onreadystatechange=function(){if(!h&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){h=true;d.onload=d.onreadystatechange=null;d&&d.parentNode&&d.parentNode.removeChild(d)}};k||(k=document.getElementsByTagName("head")[0]);k.appendChild(d)}var n=0,k,e=this;COG.jsonp=function(a,d,h){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++n;e[b]=function(o){d(o);e[b]=null;try{delete e[b]}catch(f){}};
m(a+(h?h:"callback")+"="+b);return b}})();
COG.Touch=function(){function m(t,p){return{x:t.x-p.x,y:t.y-p.y}}function n(t,p){var r=m(t,p);return Math.sqrt(r.x*r.x+r.y*r.y)}function k(t){if(t.count>1)return n(t.touches[0],t.touches[1]);return 0}function e(t,p){var r=t&&t.count>0?t.touches[0]:null;if(r&&p&&p.count>0)return m(r,p.touches[0]);return null}function a(t,p){t.count=p.count;for(var r=f;r--;){t.touches[r].x=p.touches[r].x;t.touches[r].y=p.touches[r].y}}function d(){for(var t={count:0,touches:Array(f)},p=f;p--;)t.touches[p]=o();return t}
function h(t){if(t.preventDefault){t.preventDefault();t.stopPropagation()}else t.cancelBubble&&t.cancelBubble()}function b(t,p,r){if(N){p=p[r?r:"touches"];r=p.length;for(r=t.count=r;r--;){t.touches[r].x=p[r].pageX;t.touches[r].y=p[r].pageY}}else if(p.button===0){t.count=1;t.touches[0].x=p.pageX?p.pageX:p.screenX;t.touches[0].y=p.pageY?p.pageY:p.screenY}else t.count=0}function o(t,p){return{x:t?t:0,y:p?p:0}}var f=10,l=120,g=100,q=250,v=300,C=5,B=0,s=1,u=2,x=7,z=0,J=0,N=undefined,L=function(t){function p(E,
H,O,M){var y=Math.asin((E.y-H.y)/O);O=O*(va/M)>>0;O=O>ua?ua:O;y=H.x>E.x?y:Math.PI-y;F("pan",Math.cos(y)*-O,Math.sin(y)*O,true)}function r(E,H){var O,M;if(N){O=H-qa;if(O<q){M=n(U.touches[0],E);M>t.inertiaTrigger&&p(U.touches[0],E,M,O)}}else{Y.x=E.x;Y.y=E.y;COG.Loopage.join({execute:function(y,D){O=y-H;M=n(E,Y);if(O<g&&M>t.inertiaTrigger){D.trigger("complete");p(E,Y,M,O)}else O>g&&D.trigger("complete")},frequency:10})}}function w(E){var H=0,O=0;if(E.offsetParent){do{H+=E.offsetLeft;O+=E.offsetTop;E=
E.offsetParent}while(E)}return o(H,O)}function A(E){var H=E.count,O=Array(H),M=w($);for(H=H;H--;)O[H]=o(E.touches[H].x-M.x,E.touches[H].y-M.y);return O}function F(){na&&na.trigger.apply(null,arguments)}function K(E,H){var O=w($);O=o(H.x-O.x,H.y-O.y);F(E,H,O)}function G(E){var H=E.target?E.target:E.srcElement;if(ra||H&&H===$){b(U,E);if(U.count!==0){ja=null;ka.x=0;ka.y=0;P=true;ca=false;qa=(new Date).getTime();h(E);H.style.cursor="move";F("inertiaCancel");sa=qa;if(E=U.count>0?U.touches[0]:null){F("touchStart",
E.x,E.y);if(sa-ta<v)if((E=m(U.touches[0],fa.touches[0]))&&Math.abs(E.x)<t.maxDistDoubleTap&&Math.abs(E.y)<t.maxDistDoubleTap)ca=true;da=B;a(fa,U)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function W(E){var H=E.target?E.target:E.srcElement,O=0;if(ra||H&&H===$){b(aa,E);if(aa.count>0){Y.x=aa.touches[0].x;Y.y=aa.touches[0].y}if(P){N&&h(E);if(aa.count>1){U.count===1&&a(U,aa);O=k(U)-k(aa)}if(da===B)if((E=e(aa,U))&&(Math.abs(E.x)>=x||Math.abs(E.y)>=x))da=s;if(da!==B)if(!O||Math.abs(O)<
C){if(ja=e(aa,fa)){ka.x-=ja.x;ka.y-=ja.y;la.x-=ja.x;la.y-=ja.y}F("pan",la.x,la.y);la.x=0;la.y=0;da=s}else{F("pinchZoom",A(U),A(aa));da=u}a(fa,aa)}}}function T(E){var H=E.target?E.target:E.srcElement;if(P&&(ra||H&&H===$)){b(ga,E,"changedTouches");var O=ga.touches[0];N&&h(E);E=(new Date).getTime();ta=sa;if(da===B){K("tap",U.touches[0]);ma||(ma=setTimeout(function(){ma=0;ca&&K("doubleTap",U.touches[0])},v+50))}else if(da==s){F("panEnd",ka.x,ka.y);ha&&r(O,E)}else da==u&&F("pinchZoomEnd",A(U),A(fa),E-
qa);H.style.cursor="default";P=false}}function Z(E){var H=E.target?E.target:E.srcElement;if(ra||H&&H===$){if(E.detail){H=-E.detail*l;H=o(E.axis===1?H:0,E.axis===2?H:0)}else H=o(E.wheelDeltaX,E.wheelDeltaY);var O=H.y!==0?Math.abs(H.y/l):0;if(Y&&O!==0){var M=o(Y.x-$.offsetLeft,Y.y-$.offsetTop);F("wheelZoom",M,Math.pow(2,H.y>0?O:-O))}h(E)}}t=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,
pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},t);var ca=false,ma=0,ia=T5.getConfig(),U=d(),aa=d(),fa=d(),ga=d(),ja=null,ka=o(),la=o(),da=null,P=false,qa=0,oa=[],Y=o(),ha=false,va,ua,sa=0,ta=0,$=t.element,na=t.observable,ra=typeof FlashCanvas!=="undefined",ea={supportsTouch:N,addListeners:function(E){oa.push(E)},decoupleListeners:function(E){for(var H=0;E&&H<oa.length;H++)if(oa[H].listenerId===E){oa.splice(H,1);break}},release:function(){ia.unbindEvent(N?"touchstart":
"mousedown",G,false);ia.unbindEvent(N?"touchmove":"mousemove",W,false);ia.unbindEvent(N?"touchend":"mouseup",T,false);if(!N){window.removeEventListener("mousewheel",Z,false);window.removeEventListener("DOMMouseScroll",Z,false)}},inertiaEnable:function(E,H){ha=true;va=E;ua=H?Math.min(H.width,H.height):500},inertiaDisable:function(){ha=false}};if(typeof N==="undefined")N=T5.getConfig().supportsTouch;ia.bindEvent(N?"touchstart":"mousedown",G,false);ia.bindEvent(N?"touchmove":"mousemove",W,false);ia.bindEvent(N?
"touchend":"mouseup",T,false);if(!N){ia.bindEvent("mousewheel",Z,window);ia.bindEvent("DOMMouseScroll",Z,window)}return ea},S=[];return{capture:function(t,p){if(!t)throw Error("Unable to capture touch of null element");if(!t.id)t.id="touchable_"+z++;var r=S[t.id];if(!r){r=new L(COG.extend({element:t},p));S[t.id]=r}if(p){p.listenerId&&r.decoupleListeners(p.listenerId);p.listenerId=++J;r.addListeners(p)}return r},release:function(t){if(t&&t.id&&S[t.id]){S[t.id].release();delete S[t.id]}}}}();
T5=function(){var m=function(){function a(b,o){return h(b.x-o.x,b.y-o.y)}function d(b,o){if(!o)o=b.length;if(o<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var f={edges:Array(o-1),accrued:Array(o-1),total:0},l=0;l<o-1;l++){var g=a(b[l],b[l+1]);f.edges[l]=Math.sqrt(g.x*g.x+g.y*g.y);f.accrued[l]=f.total+f.edges[l];f.total+=f.edges[l]}return f}function h(b,o){return{x:b?b:0,y:o?o:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,o=0,f=arguments.length;f--;){b+=arguments[f].x;o+=arguments[f].y}return h(b,o)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?h(b.x,b.y):null},diff:a,distance:function(b,o){return d(b,o).total},edges:d,equals:function(b,o){return b.x===o.x&&b.y===o.y},extendBy:function(b,o,f){return h(b.x-Math.cos(o)*f,b.y-Math.sin(o)*f)},floor:function(b){for(var o=Array(b.length),f=b.length;f--;)o[f]=h(~~b[f].x,~~b[f].y);return o},getRect:function(b){for(var o,f,l,
g,q=b.length;q--;){var v=b[q];o=typeof o==="undefined"||v.x<o?v.x:o;f=typeof f==="undefined"||v.y<f?v.y:f;l=typeof l==="undefined"||v.x>l?v.x:l;g=typeof g==="undefined"||v.y>g?v.y:g}return k.init(o,f,g,g)},init:h,invert:function(b){return h(-b.x,-b.y)},offset:function(b,o,f){return h(b.x+o,b.y+(f?f:o))},simplify:function(b,o){if(!b)return null;o=o?o:m.VECTOR_SIMPLIFICATION;for(var f=[],l=null,g=b.length;g--;){var q=b[g];if(include=!l||g===0||Math.abs(q.x-l.x)+Math.abs(q.y-l.y)>o){f.unshift(q);l=q}}return f},
theta:function(b,o,f){f=Math.asin((b.y-o.y)/f);return b.x>o.x?f:Math.PI-f}}}(),n=function(){return{dotProduct:function(a,d){return a.x*d.x+a.y*d.y}}}(),k=function(){function a(d,h,b,o){d=d?d:0;h=h?h:0;b=typeof b!=="undefined"?b:d;o=typeof o!=="undefined "?o:o;return{x1:d,y1:h,x2:b,y2:o,width:b-d,height:o-h}}return{center:function(d){return m.init(d.x1+d.width/2,d.y1+d.height/2)},copy:function(d){return a(d.x1,d.y1,d.x2,d.y2)},diagonalSize:function(d){return Math.sqrt(d.width*d.width+d.height*d.height)},
fromCenter:function(d,h,b,o){b=~~(b/2);o=~~(o/2);return a(d-b,h-o,d+b,h+o)},init:a,intersect:function(d,h){var b=a(Math.max(d.x1,h.x1),Math.max(d.y1,h.y1),Math.min(d.x2,h.x2),Math.min(d.y2,h.y2));return b.width>0&&b.height>0?b:null}}}(),e=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return m.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,d){a=a?a:0;return{width:a,
height:d?d:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:m,XYRect:k,Vector:function(a,d){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return m.init(a,d)},V:COG.extend(m,n),D:e}}();
(function(){function m(){for(;C.length>0;){var s=C.shift();document.location=s}v=0}function n(s){for(var u=true,x=B.length;x--;)u=u&&s!=B[x];return u}function k(s,u){var x=[];for(var z in u)z&&x.push(z+"="+escape(u[z]));return"tile5://"+s+"/"+(x.length>0?"?"+x.join("&"):"")}function e(s,u){n(s)&&COG.Log.info("would push url: "+k(s,u))}function a(s,u){if(n(s)){C.push(k(s,u));v||(v=setTimeout(m,100))}}function d(s){return function(u,x,z){(z?z:s?document.body:document).addEventListener(u,x,false)}}function h(s){return function(u,
x,z){(z?z:s?document.body:document).removeEventListener(u,x,false)}}function b(s,u,x){(x?x:document).attachEvent("on"+s,u)}function o(s,u,x){(x?x:document).detachEvent("on"+s,u)}function f(){l={base:{name:"Unknown",bindEvent:d(),unbindEvent:h(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:o,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:d(true),unbindEvent:h(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[l.froyo,l.android,l.ipod,l.iphone,l.ipad,l.ie]}var l=null,g=[],q=null,v=0,C=[],B=["view.wake","tile.loaded"];T5.getConfig=function(){l||f();if(!q){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var s=0;s<g.length;s++){var u=g[s];if(u.regex&&u.regex.test(navigator.userAgent)){q=T5.ex({},l.base,u);COG.Log.info("PLATFORM DETECTED AS: "+q.name);break}}if(!q){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
q=l.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return q}})();
T5.Dispatcher=function(){var m=[],n={execute:function(k){var e=n.findAction(k);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(k){for(var e=m.length;e--;)if(m[e].id==k)return m[e];return null},getRegisteredActions:function(){return[].concat(m)},getRegisteredActionIds:function(){for(var k=[],e=m.length;e--;)m[e].id&&k.push(m[e].id);return k},registerAction:function(k){k&&k.id&&m.push(k)},Action:function(k){k=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},k);var e={id:k.id,execute:function(){k.execute&&k.execute.apply(this,arguments)},getParam:function(a){return k[a]?k[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,k.title,k.icon)}};k.autoRegister&&n.registerAction(e);return e},Agent:function(k){k=COG.extend({name:"Untitled",translator:null,execute:null},k);var e={getName:function(){return k.name},getParam:function(a){return k[a]},getId:function(){return COG.toID(e.getName())},run:function(a,d){if(k.execute){var h=
k.translator?k.translator(a):a;k.execute.call(e,h,function(b,o){d&&d(b,o,h)})}}};return e},runAgents:function(k,e,a){for(var d=0;d<k.length;d++)k[d].run(e,a)}};return n}();
T5.Resources=function(){var m="",n={},k={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:m+e},setBasePath:function(e){m=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var a=function(d){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(d)})};e.cacheable&&n[e.filename]?a(n[e.filename]):COG.xhr({url:k.getPath(e.filename),dataType:e.dataType,success:function(d){if(e.cacheable)n[e.filename]=d;a(d)},error:function(d,h,b){COG.Log.error("error loading resource ["+
e.filename+"], error = "+b)}})},loadSnippet:function(e,a){/\.\w+$/.test(e)||(e+=".html");k.loadResource({filename:"snippets/"+e,callback:a,dataType:"html"})}};return k}();
T5.Images=function(){function m(){if(!v){var s=T5.getConfig().maxImageLoads;v=COG.Loopage.join({execute:function(u,x){if(!s||l.length<s){var z=f.shift();if(z){l[l.length]=z;z.image.onload=k;z.image.src=T5.Resources.getPath(z.url);z.requested=T5.ticks()}else x.trigger("complete")}},frequency:10});v.bind("complete",function(){v=null})}}function n(){C=true;try{var s=g.length/2>>0;if(s>0){g.sort(function(x,z){return x.created-z.created});for(var u=s;u--;)delete d[g[u].url];g.splice(0,s)}}finally{C=false}COG.say("imagecache.cleared")}
function k(){var s=b[this.id],u;if(s&&s.image.complete&&s.image.width>0){s.loaded=true;s.hitCount=1;for(u=l.length;u--;)if(l[u].image.src==this.src){l.splice(u,1);break}if(s.background||s.postProcess||s.drawBackground||s.customDraw)if(s.image){globalImageData=s;u=a(s.realSize?s.realSize.width:s.image.width,s.realSize?s.realSize.height:s.image.height);var x=u.getContext("2d"),z=s.offset?s.offset:T5.XY.init();s.background&&x.drawImage(s.background,0,0);s.drawBackground&&s.drawBackground(x);s.customDraw?
s.customDraw(x,s):x.drawImage(s.image,z.x,z.y);s.postProcess&&s.postProcess(x,s);s.image=u}for(u=s.callbacks.length;u--;)s.callbacks[u]&&s.callbacks[u](this,false);s.callbacks=[];g[g.length]={url:this.src,created:s.requested};delete b[this.id];m()}}function e(s,u,x){var z=d[s];if(z){z.hitCount++;z.image.complete&&z.image.width>0&&u?u(z.image,true):z.callbacks.push(u)}else{z=T5.ex({url:s,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[u]},x);z.image.id="resourceLoaderImage"+
o++;d[s]=z;b[z.image.id]=z;f[f.length]=z;m()}return z}function a(s,u){var x=document.createElement("canvas");x.width=s?s:0;x.height=u?u:0;if(typeof FlashCanvas!=="undefined"){x.id="tmpCanvas"+h++;x.style.cssText="position: absolute; top: -"+(u-1)+"px; left: -"+(s-1)+"px;";document.body.appendChild(x);FlashCanvas.initElement(x)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(x);return x}var d={},h=0,b={},o=0,f=[],l=[],g=[],q=0,v=null,C=false,B={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){l=[]},get:function(s,u,x){var z=null,J=null;C||(z=d[s]);if((J=z?z.image:null)&&(J.getContext||J.complete&&J.width>0))return J;else u&&e(s,u,x);return null},load:e,newCanvas:a,reset:function(){d={}},stats:function(){return{imageLoadingCount:l.length,queuedImageCount:f.length,imageCacheFullness:q}}};COG.Loopage.join({execute:function(s){for(var u=false,x=0,z=T5.getConfig();x<l.length;)if(s-l[x].requested>B.loadTimeout*1E3){l.splice(x,1);u=true}else x++;u&&m();if(z&&z.imageCacheMaxSize){q=
g.length*B.avgImageSize/z.imageCacheMaxSize;q>=1&&n()}},frequency:2E4});return B}();T5.Generator=function(){var m={};return{init:function(n,k){var e=m[n];if(!e)throw Error("Unable to locate requested generator: "+n);return new e(k)},register:function(n,k){m[n]=k},Template:function(){}}}();
T5.TimeLord=function(){var m=/^P(\d+Y)?(\d+M)?(\d+D)?$/,n=/^(\d+H)?(\d+M)?(\d+S)?$/,k=function(a,d){return{days:a?a:0,seconds:d?d:0}},e={8601:function(a){a=a.split("T");var d=null;d=null;var h=0,b=0;m.lastIndex=-1;d=m.exec(a[0]);h+=d[3]?parseInt(d[3].slice(0,-1),10):0;n.lastIndex=-1;d=n.exec(a[1]);b+=d[1]?parseInt(d[1].slice(0,-1),10)*3600:0;b+=d[2]?parseInt(d[2].slice(0,-1),10)*60:0;b+=d[3]?parseInt(d[3].slice(0,-1),10):0;return new k(h,b)}};return{Duration:k,addDuration:function(){for(var a=new k,
d=arguments.length;d--;){a.days+=arguments[d].days;a.seconds+=arguments[d].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,d){var h=d?e[d]:null;if(h)return h(a);COG.Log.warn("Could not find duration parser for specified format: "+d);return new k},formatDuration:function(a){var d,h,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){d=~~(a/3600);a-=d*3600}if(a>=60){h=Math.round(a/60);a-=h*60}if(d)b=b+d+(d>1?" hrs ":" hr ")+
(h?(h>10?h:"0"+h)+" min ":"");else if(h)b=b+h+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
(function(){var m=Math.PI*2,n=Math.PI/2,k=Math.abs,e=Math.pow,a=Math.sin,d=Math.asin,h=Math.cos,b=1.70158,o={linear:function(f,l,g,q){return g*f/q+l},backin:function(f,l,g,q){return g*(f/=q)*f*((b+1)*f-b)+l},backout:function(f,l,g,q){return g*((f=f/q-1)*f*((b+1)*f+b)+1)+l},backinout:function(f,l,g,q){return(f/=q/2)<1?g/2*f*f*(((b*=1.525)+1)*f-b)+l:g/2*((f-=2)*f*(((b*=1.525)+1)*f+b)+2)+l},bouncein:function(f,l,g,q){return g-o.bounceout(q-f,0,g,q)+l},bounceout:function(f,l,g,q){return(f/=q)<1/2.75?
g*7.5625*f*f+l:f<2/2.75?g*(7.5625*(f-=1.5/2.75)*f+0.75)+l:f<2.5/2.75?g*(7.5625*(f-=2.25/2.75)*f+0.9375)+l:g*(7.5625*(f-=2.625/2.75)*f+0.984375)+l},bounceinout:function(f,l,g,q){return f<q/2?o.bouncein(f*2,0,g,q)/2+l:o.bounceout(f*2-q,0,g,q)/2+g/2+l},cubicin:function(f,l,g,q){return g*(f/=q)*f*f+l},cubicout:function(f,l,g,q){return g*((f=f/q-1)*f*f+1)+l},cubicinout:function(f,l,g,q){if((f/=q/2)<1)return g/2*f*f*f+l;return g/2*((f-=2)*f*f+2)+l},elasticin:function(f,l,g,q,v,C){if(f==0)return l;if((f/=
q)==1)return l+g;C||(C=q*0.3);if(!v||v<k(g)){v=g;g=C/4}else g=C/m*d(g/v);return-(v*e(2,10*(f-=1))*a((f*q-g)*m/C))+l},elasticout:function(f,l,g,q,v,C){var B;if(f==0)return l;if((f/=q)==1)return l+g;C||(C=q*0.3);if(!v||v<k(g)){v=g;B=C/4}else B=C/m*d(g/v);return v*e(2,-10*f)*a((f*q-B)*m/C)+g+l},elasticinout:function(f,l,g,q,v,C){var B;if(f==0)return l;if((f/=q/2)==2)return l+g;C||(C=q*0.3*1.5);if(!v||v<k(g)){v=g;B=C/4}else B=C/m*d(g/v);if(f<1)return-0.5*v*e(2,10*(f-=1))*a((f*q-B)*m/C)+l;return v*e(2,
-10*(f-=1))*a((f*q-B)*m/C)*0.5+g+l},quadin:function(f,l,g,q){return g*(f/=q)*f+l},quadout:function(f,l,g,q){return-g*(f/=q)*(f-2)+l},quadinout:function(f,l,g,q){if((f/=q/2)<1)return g/2*f*f+l;return-g/2*(--f*(f-2)-1)+l},sinein:function(f,l,g,q){return-g*h(f/q*n)+g+l},sineout:function(f,l,g,q){return g*a(f/q*n)+l},sineinout:function(f,l,g,q){return-g/2*(h(Math.PI*f/q)-1)+l}};T5.easing=function(f){return o[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(f,l){o[f.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=l}})();
T5.Tween=function(m){m=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},m);var n=T5.ticks(),k=[],e=false,a=0,d=0,h={cancelOnInteract:m.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(b){m.complete&&m.complete(b)},update:function(b){try{var o=m.tweenFn(b-n,a,d,m.duration);if(m.target)m.target[m.property]=o;for(var f=k.length;f--;)k[f](o,void 0);if(e=n+m.duration<=b){if(m.target)m.target[m.property]=
m.tweenFn(m.duration,a,d,m.duration);for(var l=k.length;l--;)k[l](o,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(b){k.push(b)}};a=m.target&&m.property&&m.target[m.property]?m.target[m.property]:m.startValue;if(typeof m.endValue!=="undefined")d=m.endValue-a;if(d==0)e=true;T5.wakeTweens();return h};
(function(){function m(a){if(e)return n.length;e=true;try{for(var d=0;d<n.length;)if(n[d].isComplete()){n[d].triggerComplete(false);n.splice(d,1)}else{n[d].update(a);d++}}finally{e=false}n.length===0&&k.trigger("complete");return n.length}var n=[],k=null,e=false;T5.tweenValue=function(a,d,h,b,o){a=new T5.Tween({startValue:a,endValue:d,tweenFn:h,complete:b,duration:o});n.push(a);return a};T5.tween=function(a,d,h,b,o,f){a=new T5.Tween({target:a,property:d,endValue:h,tweenFn:b,duration:f,complete:o});
n.push(a);return a};T5.tweenVector=function(a,d,h,b,o,f){var l=[];if(a){var g=a.x==d,q=a.y==h;g||l.push(T5.tween(a,"x",d,b,function(){(g=true)&&q&&o()},f));q||l.push(T5.tween(a,"y",h,b,function(){q=true;g&&q&&o()},f))}return l};T5.cancelAnimation=function(a){if(!e){e=true;try{for(var d=0;d<n.length;)if(!a||a(n[d])){n[d].triggerComplete(true);n.splice(d,1)}else d++}finally{e=false}}};T5.isTweening=function(){return n.length>0};T5.wakeTweens=function(){if(!k){k=COG.Loopage.join({execute:m,frequency:20});
k.bind("complete",function(){k=null})}}})();(function(){var m={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var n=0,k=arguments.length;k--;){var e=m[arguments[k].toUpperCase()];if(e)n|=e}return n}})();
T5.ViewLayer=function(m){m=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null},m);var n=null,k=false,e=false,a=m.supportFastDraw,d=m.id,h=T5.viewState("ACTIVE"),b=m.validStates,o=0,f=0,l=T5.ex({addToView:function(g){g.setLayer(d,l)},shouldDraw:function(g,q,v){g=(g&b)!==0&&(k?a:true);return g=e||v||o!==q.x||f!==q.y},cycle:function(){},draw:function(){},remove:function(){l.trigger("remove",l)},changed:function(){e=true;l.trigger("changed",
l);n&&n.trigger("invalidate")},getId:function(){return d},setId:function(g){d=g},getParent:function(){return n},setParent:function(g){k=(n=g)?n.fastDraw&&displayState!==h:false;l.trigger("parentChange",n)}},m);COG.observable(l);l.bind("drawComplete",function(g,q){e=false;o=q.x;f=q.y});return l};
T5.View=function(m){function n(y,D,I,Q){ea=$;x();if(Q&&m.inertia){ca=true;f(t+D,p+I,m.panAnimationEasing,m.panAnimationDuration)}else Q||f(t+D,p+I)}function k(){ea=ta;ca=false;COG.Loopage.join({execute:x,after:50,single:true})}function e(y,D){ga=E(y);ja=E(D);var I=H(ga),Q=H(ja);ha=O(ga);T=O(ja);P=ga&&I!==0?Q/I:1}function a(y,D,I){e(D,I);if(fa=P!==1){ea=na;x()}}function d(y,D,I,Q){e(D,I);if(m.adjustScaleFactor){P=m.adjustScaleFactor(P);COG.Log.info("scale factor adjusted to: "+P)}if(Q<m.pinchZoomAnimateTrigger){q(oa,
P,ha,v(),T5.easing("sine.out"),function(){b();P=1},300);P=oa}else{b();P=1}}function h(y,D,I){M.zoom(D,Math.min(Math.pow(2,Math.round(Math.log(I))),8),500)}function b(){var y=ga?v():T;P=Math.round(P*10)/10;fa=false;for(var D=J.length;D--;)J[D].trigger("scale",P,y);M.trigger("scale",P,y);ea=ta;x()}function o(){clearTimeout(da);da=setTimeout(l,50)}function f(y,D,I,Q,R){function V(){X+=1;if(X>=2){k(0,0);R&&R()}}var X=0;if(I){y=T5.tweenValue(t,y,I,V,Q);D=T5.tweenValue(p,D,I,V,Q);y.cancelOnInteract=true;
y.requestUpdates(function(ba){t=ba;ca=true;x()});D.cancelOnInteract=true;D.requestUpdates(function(ba){p=ba;ca=true;x()})}else{t=y;p=D}}function l(){var y;if(L){COG.Touch.release(L);if(m.autoSize&&L.parentNode){y=L.parentNode.getBoundingClientRect();if(y.height!==0&&y.width!==0){L.height=y.height;L.width=y.width}}try{if(!L.id)L.id=m.id+"_canvas";S=L.getContext("2d");S.clearRect(0,0,L.width,L.height)}catch(D){COG.Log.exception(D);throw Error("Could not initialise canvas on specified view element");
}sa=COG.Touch.capture(L,{observable:M});if(G.height!==L.height||G.width!==L.width){G=T5.D.init(L.width,L.height);M.trigger("resize",L.width,L.height);for(y=N;y--;)J[y].trigger("resize",L.width,L.height)}m.inertia&&sa.inertiaEnable(m.panAnimationDuration,G);for(y=N;y--;)J[y].trigger("contextChanged",S);u()}}function g(y,D){D.setId(y);D.added=T5.ticks();D.bind("remove",function(){M.removeLayer(y)});D.trigger("contextChanged",S);D.setParent(M);J.push(D);J.sort(function(I,Q){var R=Q.zindex-I.zindex;if(R===
0)R=Q.added-I.added;return R});N=J.length;return D}function q(y,D,I,Q,R,V,X){function ba(){V&&V();b();P=1;Y=null}fa=true;ha=T5.XY.offset(I,w.x1,w.y1);T=T5.XY.offset(Q,w.x1,w.y1);ga=null;COG.Log.info("zoom from: ",ha);COG.Log.info("zoom to:   ",T);if(R)T5.tweenValue(0,D-y,R,ba,X?X:1E3).requestUpdates(function(pa){Y=pa/(D-y);P=y+pa;ea=na;x();M.trigger("animate")});else{P=D;ba()}}function v(){var y=T5.D.getCenter(G),D=T5.XY.distance([T,y]);y=T5.XY.theta(T,y,D);var I=T5.XY.diff(ha,T);y=T5.XY.extendBy(T,
y,D/P);y.x+=I.x;y.y+=I.y;return y}function C(){z(Z,M);Z=true;ma=0}function B(y,D,I,Q,R){var V=(D&na)!==0,X=T5.XYRect.copy(I),ba=0;y.clearRect(0,0,L.width,L.height);if(A||V)A=false;if(V){T5.D.getCenter(G);var pa=(Y?Y:1)/2,wa=T5.XY.diff(ha,T);if(ga){U.x=T.x+wa.x;U.y=T.y+wa.y}else{U.x=T.x-wa.x*pa;U.y=T.y-wa.y*pa}}y.save();try{oa=P;if(V){V=1/P;pa=(V-0.5)/0.5;X=T5.XYRect.fromCenter(T.x-(T.x-t)*pa,T.y-(T.y-p)*pa,~~(X.width*V),~~(X.height*V));y.scale(P,P)}y.translate(-X.x1,-X.y1);for(ba=N;ba--;)if(J[ba].shouldDraw(D,
I,Q)){var xa=J[ba].style,ya=xa?T5.Style.apply(y,xa):null;J[ba].draw(y,X,D,M,Q,R);ya&&T5.Style.apply(y,ya);J[ba].trigger("drawComplete",X,R)}}finally{y.restore()}M.trigger("drawComplete",I,R);COG.Log.trace("draw complete",R)}function s(y,D){var I=false,Q=ka?ka:ca?$:ea,R=!ca&&(Q===na||Q===$),V=la||Q===$||Q===na||T5.isTweening();r=T5.XY.init(t>>0,p>>0);w=T5.XYRect.fromCenter(r.x,r.y,G.width,G.height);if(R){T5.cancelAnimation(function(X){return X.cancelOnInteract});Z=false;if(ma!==0){clearTimeout(ma);
ma=0}}for(R=N;R--;){if(J[R].animated)ea|=ra;I=J[R].cycle(y,w,ea,V)||I}V=V||(ea&ra)!==0;if(I=I||V||P!==1&&P!==qa){B(S,Q,w,V,y);qa=P;la=false}if(!I&&W===0&&!va){if(!Z&&ma===0)ma=setTimeout(C,500);D.trigger("complete")}W=0;COG.Log.trace("Completed draw cycle",y)}function u(){la=true;x()}function x(){W+=1;if(!F){F=COG.Loopage.join({execute:s,frequency:ua});F.bind("complete",function(){F=null})}}function z(){M.trigger.apply(null,arguments);for(var y=J.length;y--;)J[y].trigger.apply(null,arguments)}m=T5.ex({id:COG.objId("view"),
container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},m);var J=[],N=0,L=document.getElementById(m.container),S=null,t=0,p=0,r=null,w=null,A=false,F=null,K=1,G=T5.D.init(),W=0,T=null,Z=false,ca=false,ma=0,ia=0,U=T5.XY.init(),aa=0,fa=false,ga=null,ja=null,ka=null,la=false,da=0,P=1,qa=0,oa=1,Y=null,ha=null,va=typeof FlashCanvas!=="undefined",
ua=~~(1E3/m.fps),sa=null,ta=T5.viewState("ACTIVE"),$=T5.viewState("PAN"),na=T5.viewState("ZOOM"),ra=T5.viewState("ANIMATING"),ea=ta,E=T5.XY.getRect,H=T5.XYRect.diagonalSize,O=T5.XYRect.center,M={id:m.id,deviceScaling:K,fastDraw:m.fastDraw||T5.getConfig().requireFastDraw,animate:function(y,D,I,Q,R){q(P,y,D,I,Q,R)},centerOn:function(y){t=y.x-L.width/2;p=y.y-L.height/2},getDimensions:function(){return G},getZoomCenter:function(){return U},getLayer:function(y){for(var D=0;D<N;D++)if(J[D].getId()==y)return J[D];
return null},setLayer:function(y,D){for(var I=0;I<N;I++)if(J[I].getId()===y){J.splice(I,1);break}D&&g(y,D);u();return D},eachLayer:function(y){for(var D=N;D--;)y(J[D])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");A=true;u()},invalidate:u,resize:function(y,D){if(L){m.autoSize=false;L.width=y;L.height=D;l();M.trigger("resize",L.width,L.height)}},scale:function(y,D,I,Q,R){Q||(Q=T5.D.getCenter(G));R||(R=T5.D.getCenter(G));M.animate(y,Q,R,D,I);return M},triggerAll:z,
removeLayer:function(y){a:{for(var D=N;D--;)if(J[D].getId()==y){y=D;break a}y=-1}if(y>=0&&y<N){COG.say("layer.removed",{layer:J[y]});J.splice(y,1);u()}N=J.length},stateOverride:function(y){ka=y},getOffset:function(){return r?r:T5.XY.init(t,p)},getViewRect:function(){return w?w:T5.XYRect.fromCenter(t,p,G.width,G.height)},updateOffset:f,pan:function(y,D,I,Q,R){f(t+y,p+D,I,Q,R)},zoom:function(y,D,I){ca=false;P=D;fa=P!==1;ha=T5.D.getCenter(G);T=T5.XY.offset(P>1?T5.XY.copy(y):T5.D.getCenter(G),w.x1,w.y1);
ga=null;clearTimeout(ia);if(fa){ea=na;x();if(I)ia=setTimeout(function(){b();P=1},parseInt(I,10))}}};K=T5.getConfig().getScaling();M.markers=g("markers",new T5.MarkerLayer);COG.observable(M);M.bind("wake",x);M.bind("invalidate",u);if(m.pannable){M.bind("pan",n);M.bind("panEnd",k);M.bind("inertiaCancel",function(){ca=false;x()})}if(m.scalable){M.bind("pinchZoom",a);M.bind("pinchZoomEnd",d);M.bind("wheelZoom",h)}M.bind("tap",function(y,D,I){for(var Q=T5.XY.offset(I,t,p),R=J.length;R--;)y.cancel=y.cancel||
J[R].trigger("tap",D,I,Q).cancel});COG.configurable(M,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(m,null,{container:function(y,D){L=document.getElementById(D);l()},rotation:function(y,D){aa=D}}),true);l();m.autoSize&&window.addEventListener("resize",o,false);return M};
T5.PathLayer=function(m){m=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},m);var n=false,k=[],e=null,a=[],d=null,h=0,b=[],o=T5.ex(new T5.ViewLayer(m),{getAnimation:function(f,l,g,q){var v="pathAnimation"+h++;b.push(v);return new T5.AnimatedPathLayer({id:v,path:k,zindex:m.zindex+1,easing:f?f:T5.easing("sine.inout"),duration:l?l:5E3,drawIndicator:g,autoCenter:q?q:false})},cycle:function(f,l,g,q){return q},draw:function(f){var l,g=k.length;f.save();try{T5.Style.apply(f,m.style);if(g>0){f.beginPath();
f.moveTo(k[g-1].x,k[g-1].y);for(l=g;l--;)f.lineTo(k[l].x,k[l].y);f.stroke();if(e){f.fillStyle=m.waypointFillStyle;for(l=e.length;l--;){f.beginPath();f.arc(e[l].x,e[l].y,2,0,Math.PI*2,false);f.stroke();f.fill()}}}}finally{f.restore()}n=false},updateCoordinates:function(f,l){a=f;d=l;var g=o.getParent();if(g&&g.syncXY){g.syncXY(a);d&&g.syncXY(d);o.trigger("tidy")}}});o.bind("tidy",function(){k=T5.XY.simplify(a,m.pixelGeneralization);e=T5.XY.simplify(d,m.pixelGeneralization);n=true;o.changed()});return o};
T5.ShapeLayer=function(m){function n(h){for(var b=e.length;b--;)e[b].resync(h);e.sort(function(o,f){var l=f.xy.y-o.xy.y;if(l===0)l=f.xy.x-o.xy.y;return l});a=true;d.changed()}function k(h,b){b.syncXY&&n(b)}m=T5.ex({zindex:80},m);var e=[],a=false,d=T5.ex(new T5.ViewLayer(m),{add:function(h){e[e.length]=h},each:function(h){for(var b=e.length;b--;)h(e[b])},cycle:function(){return a},draw:function(h,b,o){var f=b.x1,l=b.y1,g=b.width;b=b.height;for(var q=e.length;q--;){var v=e[q].style;v=v?T5.Style.apply(h,
v):null;e[q].draw(h,f,l,g,b,o);v&&T5.Style.apply(h,v)}a=false}});d.bind("parentChange",k);d.bind("resync",k);return d};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(m){m=T5.ex({style:null,properties:{}},m);return T5.ex(m,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(m,n){n=T5.ex({size:4},n);var k=T5.XY.init(),e=T5.ex(n,{draw:function(a){a.beginPath();a.arc(k.x,k.y,e.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([m]);k=T5.XY.floor([m])[0]}});COG.Log.info("created arc = ",m);return e};
T5.Poly=function(m,n){n=T5.ex({fill:false,simplify:false},n);var k=false,e=n.fill,a=n.simplify,d=T5.viewState("ZOOM"),h=[],b=T5.ex(new T5.Shape(n),{draw:function(o,f,l,g,q,v){if(k){f=true;l=(v&d)!==0;o.beginPath();for(v=h.length;v--;){l=h[v].x;g=h[v].y;if(f){o.moveTo(l,g);f=false}else o.lineTo(l,g);l=true}if(l){e&&o.fill();o.stroke()}}},resync:function(o){b.xy=o.syncXY(m);h=T5.XY.floor(a?T5.XY.simplify(m):m)}});k=m&&m.length>=2;return b};
T5.AnimatedPathLayer=function(m){function n(b,o,f){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(f.x,f.y,4,0,Math.PI*2,false);b.stroke();b.fill()}m=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},m);var k=T5.XY.edges(m.path),e,a=null,d=0;T5.tweenValue(0,k.total,m.easing,function(){h.remove()},m.duration).requestUpdates(function(b,o){d=b;o&&h.remove()});var h=
T5.ex(new T5.ViewLayer(m),{cycle:function(){for(var b=0;b<k.accrued.length&&k.accrued[b]<d;)b++;a=null;if(b<m.path.length-1){var o=d-(b>0?k.accrued[b-1]:0),f=m.path[b];e=T5.XY.theta(f,m.path[b+1],k.edges[b]);a=T5.XY.extendBy(f,e,o);if(m.autoCenter)(b=h.getParent())&&b.centerOn(a)}return a},draw:function(b,o){if(a)(m.drawIndicator?m.drawIndicator:n)(b,o,T5.XY.init(a.x,a.y),e)}});return h};
T5.Marker=function(m){function n(o,f,l,g){e=o;a=f;d=l;h=g}m=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},m);var k=false,e=0,a=0,d=0,h=0,b=T5.ex(m,{isNew:true,isAnimating:function(){return k},draw:function(o,f,l,g,q){if(b.isNew&&m.tweenIn){var v=b.xy.y;b.xy.y=f.y1-20;k=true;T5.tween(b.xy,"y",v,m.tweenIn,function(){b.xy.y=v;k=false},m.animationSpeed?m.animationSpeed:250+Math.random()*500)}b.drawMarker(o,f,b.xy.x,b.xy.y,l,g,q);b.isNew=false},drawMarker:function(o,f,l,g){o.beginPath();
o.arc(l,g,4,0,Math.PI*2,false);o.fill();n(l-4,g-4,8,8)},hitTest:function(o,f){return o>=e&&o<=e+d&&f>=a&&f<=a+h},updateBounds:n});COG.observable(b);return b};
T5.ImageMarker=function(m){m=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},m);var n=m.imageAnchor?T5.XY.invert(m.imageAnchor):null,k=T5.ex(new T5.Marker(m),{drawMarker:function(e,a,d,h){if((a=k.isAnimating()&&k.animatingImage?k.animatingImage:k.image)&&a.complete&&a.width>0){n||(n=T5.XY.init(-a.width>>1,-a.height>>1));var b=k.scale,o=d+~~(n.x*b),f=h+~~(n.y*b),l=~~(a.width*b),g=~~(a.height*b);k.updateBounds(o,f,l,l);if(k.rotation||
k.opacity!==1){e.save();try{e.globalAlpha=k.opacity;e.translate(d,h);e.rotate(k.rotation);e.drawImage(a,n.x*b,n.y*b,l,g)}finally{e.restore()}}else e.drawImage(a,o,f,l,g)}}});if(!k.image)k.image=T5.Images.get(m.imageUrl,function(e){COG.Log.info("updating marker image to: "+e.src);k.image=e});if(!k.animatingImage)k.animatingImage=T5.Images.get(m.animatingImageUrl,function(e){k.animatingImage=e});return k};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(m){function n(){d.changed();d.trigger("markerUpdate",e)}function k(){var h=d.getParent();if(h&&h.syncXY)for(var b=e.length;b--;)h.syncXY([e[b].xy])}m=T5.ex({zindex:100,style:"basic"},m);var e=[],a=false,d=T5.ex(new T5.ViewLayer(m),{cycle:function(){return a},draw:function(h,b,o,f){a=false;for(var l=e.length;l--;){e[l].draw(h,b,o,d,f);a=a||e[l].isAnimating()}return a?1:0},add:function(h){if(h&&typeof h.length!=="undefined")for(var b=h.length;b--;){if(h[b])e[e.length]=h[b]}else if(h)e[e.length]=
h;n()},clear:function(h){if(h)for(var b=0;b<e.length;b++)h(e[b])&&e.splice(b,1);else e=[];n()},find:function(h){for(var b=[],o=e.length;o--;)if(!h||h(e[o]))b[b.length]=e[o];return b}});d.bind("tap",function(h,b,o){for(var f=[],l=o.x,g=o.y,q=e.length;q--;)if(e[q].hitTest(l,g))f[f.length]=e[q];if(f.length>0)h.cancel=d.trigger("markerTap",b,o,f).cancel});d.bind("parentChange",k);d.bind("changed",k);return d};
T5.ImageLayer=function(m,n){function k(l){var g=[];a.run(l,function(q){d=q;for(q=d.length;q--;)d[q]||(g[g.length]=q);for(q=0;q<g.length;q++)d.splice(g[q],1);(q=f.getParent())&&q.trigger("invalidate")})}function e(){var l=f.getParent();l&&l.trigger("invalidate")}n=T5.ex({imageLoadArgs:{}},n);var a=T5.Generator.init(m,n),d=null,h=T5.XYRect.init(),b=n.imageLoadArgs,o=T5.viewState("ZOOM"),f=T5.ex(new T5.ViewLayer(n),{cycle:function(l,g){k(g)},draw:function(l,g,q){l.save();try{l.strokeStyle="#555";l.beginPath();
if(d)for(var v=d.length;v--;){var C=d[v].x,B=d[v].y,s=T5.XYRect.init(d[v].x,d[v].y,d[v].x+d[v].width,d[v].y+d[v].height);T5.XYRect.intersect(g,s)&&f.drawImage(l,g,C,B,d[v],q)}l.clip()}finally{l.restore()}h=T5.XYRect.copy(g)},drawImage:function(l,g,q,v,C,B){if(g=T5.Images.get(C.url,(B&o)===0?e:null,b)){l.rect(q,v,C.width,C.height);l.drawImage(g,q,v,g.width,g.height)}}});f.bind("idle",function(){k(h)});f.bind("parentChange",function(l,g){a.bindToView(g)});f.bind("tap",function(l,g,q,v){l=[];var C=v.x,
B=v.y,s,u;if(d)for(var x=d.length;x--;){s=d[x];if(u=C>=s.x&&C<=s.x+s.width&&B>=s.y&&B<=s.y+s.height)l[l.length]=s}l.length>0&&f.trigger("tapImage",l,g,q,v)});return f};
T5.Style=function(){function m(h,b){a[h]=k(b);return h}function n(h){for(var b in h)m(b,h[b])}function k(h){function b(g){var q=h[g];typeof q!=="undefined"&&o.push(function(v){v[g]=q})}h=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},h);var o=[],f={applyToContext:function(g){for(var q=o.length;q--;)o[q](g)}};for(var l in h)b(l);return f}var e={},a={},d={apply:function(h,
b){var o=a[b]?a[b]:a.basic,f;if(h&&h.canvas){f=e[h.canvas.id];e[h.canvas.id]=b}o.applyToContext(h);return f},define:m,defineMany:n,init:k,load:function(h){COG.jsonp(h,function(b){T5.resetStyles(b)})}};n({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return d}();T5.Tiling=function(){return{tileSize:256,init:function(m,n,k,e,a){return T5.ex({x:m,y:n,width:k,height:e},a)}}}();
T5.TileGenerator=function(m){function n(q,v){for(var C=~~((q.x1-a.x)/h),B=~~((q.y1-a.y)/b),s=[],u=-f;u<f;u++)for(var x=-l;x<l;x++)s[s.length]=o(C+u,B+x);v&&v(s);e=T5.XYRect.copy(q)}m=T5.ex({tileWidth:256,tileHeight:256},m);var k=null,e=null,a=T5.XY.init(),d=false,h=m.tileWidth,b=m.tileHeight,o=null,f=0,l=0,g={bindToView:function(q){COG.Log.info("initializing generator");k=q;g.trigger("bindView",q)},getTileCreatorArgs:null,initTileCreator:null,requireRefresh:function(){return false},reset:function(){o=
null;d=false},run:function(q,v){if(!e||Math.abs(q.x1-e.x1)>h||Math.abs(q.y1-e.y1)>b){if(!o&&!d||g.requireRefresh()){COG.Log.info("generating tiles, view rect = ",q);a=T5.XY.init(q.x1,q.y1);f=Math.ceil(q.width/h)+1;l=Math.ceil(q.height/b)+1;if(g.initTileCreator){d=true;g.initTileCreator(b,h,g.getTileCreatorArgs?g.getTileCreatorArgs(k):{},function(C){o=C;d=false;n(q,v)})}}o&&n(q,v)}}};COG.observable(g);g.bind("update",function(){COG.Log.info("captured generator update");e=null});return g};
T5.Geo=function(){function m(t,p){var r=null;for(var w in L)if(p){if(w==p&&L[w][t]){r=L[w];break}}else if(L[w][t]){r=L[w];break}return r}function n(t,p){var r=g*Math.sin(t);return a-2*Math.atan(p*Math.pow((1-r)/(1+r),g/2))}function k(t,p,r,w){var A=0;t=t.toUpperCase();for(var F in w){var K=p[F];if(K){var G=r[F];K=G?G(t,K):COG.wordExists(t,K)?1:0;A+=K*w[F]}}return A}var e=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],a=Math.PI/2,d=Math.PI*2,h=-a,b=a,o=
-d,f=Math.PI/180,l=180/Math.PI,g=0.08181919084262157,q=null,v={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},C={VECTORIZE_PER_CYCLE:500},B={getEngine:function(t){for(var p=null,r=1;!p&&r<arguments.length;r++)p=m(t,arguments[r]);p=p?p:m(t);if(!p)throw Error("Unable to find GEO engine with "+t+" capability");return p},rankGeocodeResponses:function(t,p,r){var w=[],A=S.AddressCompareFns;if(r&&r.compareFns)A=T5.ex({},A,r.compareFns);for(r=0;r<p.length;r++)w.push(new S.GeoSearchResult({caption:N.toString(p[r]),
data:p[r],pos:p[r].pos,matchWeight:k(t,p[r],A,S.GeocodeFieldWeights)}));w.sort(function(F,K){return K.matchWeight-F.matchWeight});return w},distanceToString:function(t){if(t>1E3)return~~(t/10)/100+" km";return t?t+" m":""},dist2rad:function(t){return t/6371},lat2pix:function(t){t=parseFloat(t)*f;t=Math.sin(t);var p=g*t;return Math.log((1+t)/(1-t)*Math.pow((1-p)/(1+p),g))/2},lon2pix:function(t){return parseFloat(t)*f},pix2lon:function(t){return S.normalizeLon(t)*l},pix2lat:function(t){t=Math.pow(Math.E,
-t);for(var p=a-2*Math.atan(t),r=n(p,t),w=0;w<12&&Math.abs(p-r)>1.0E-7;){p=r;r=n(p,t);w++}return r*l},normalizeLon:function(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t},radsPerPixel:function(t){return 2*Math.PI/(256<<t)}},s=function(t,p){return{lat:parseFloat(t?t:0),lon:parseFloat(p?p:0)}},u=function(t,p){return{min:z.parse(t),max:z.parse(p)}},x=function(t){return t=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},t)},z=function(){var t={calcDistance:function(p,
r){if(t.empty(p)||t.empty(r))return 0;var w=(r.lat-p.lat)*f/2,A=(r.lon-p.lon)*f/2;w=Math.sin(w)*Math.sin(w)+Math.cos(p.lat*f)*Math.cos(r.lat*f)*Math.sin(A)*Math.sin(A);return 6371*2*Math.atan2(Math.sqrt(w),Math.sqrt(1-w))},copy:function(p){return p?new s(p.lat,p.lon):null},empty:function(p){return!p||p.lat===0&&p.lon===0},equal:function(p,r){return p&&r&&p.lat==r.lat&&p.lon==r.lon},inArray:function(p,r){for(var w=z.equal,A=r.length;A--;)if(w(p,r[A]))return true;return false},inBounds:function(p,r){var w=
!(z.empty(p)||z.empty(r));return w=(w=w&&p.lat>=r.min.lat&&p.lat<=r.max.lat)&&p.lon>=r.min.lon&&p.lon<=r.max.lon},offset:function(p,r,w){var A=p.lat*f;r=A+r/6371;for(p=p.lon*f+Math.asin(Math.sin(w/6371)/Math.cos(A));r<h;)r+=Math.PI;for(;r>b;)r-=Math.PI;for(;p>d;)p-=2*Math.PI;return new s(r*l,p*l)},parse:function(p){if(p)if(typeof p.lat!=="undefined")return t.copy(p);else{if(p.split)for(var r=[" ",","],w=0;w<r.length;w++){var A=p.split(r[w]);if(A.length===2)return new s(A[0],A[1])}}else return new s;
return null},parseArray:function(p){var r=p.length,w=Array(r);for(r=r;r--;)w[r]=t.parse(p[r]);return w},fromMercatorPixels:function(p,r){return new s(T5.Geo.pix2lat(r),T5.Geo.normalizeLon(T5.Geo.pix2lon(p)))},toMercatorPixels:function(p){return T5.XY.init(T5.Geo.lon2pix(p.lon),T5.Geo.lat2pix(p.lat))},generalize:function(p,r,w){var A=p.length,F=[],K=null;w||(w=250);w/=1E3;COG.Log.info("generalizing positions, must include "+r.length+" positions");for(var G=A;G--;)if(G===0)F.unshift(p[G]);else{var W=
!K||z.inArray(p[G],r)?w:z.calcDistance(K,p[G]);if(p[G]&&W>=w){F.unshift(p[G]);K=p[G]}}COG.Log.info("generalized "+A+" positions into "+F.length+" positions");return F},vectorize:function(p,r){var w=p.length,A=Array(w);r=T5.ex({chunkSize:C.VECTORIZE_PER_CYCLE,async:true},r);if(!r.async){for(var F=w;F--;)A[F]=T5.GeoXY.init(p[F]);return A}return COG.Loopage.join({frequency:10,execute:function(K,G){for(var W=0,T=r.chunkSize,Z=w;Z--;){A[Z]=T5.GeoXY.init(p[Z]);W+=1;if(W>T)break}w=Z;w<=0&&G.trigger("complete",
A)}})},toString:function(p){return p?p.lat+" "+p.lon:""}};return t}(),J=function(){var t={calcSize:function(p,r,w){var A=T5.XY.init(0,r.lat-p.lat);if(typeof w==="undefined")w=true;A.x=w&&p.lon>r.lon?360-p.lon+r.lon:r.lon-p.lon;return A},createBoundsFromCenter:function(p,r){var w=r/6371,A=p.lat*f,F=p.lon*f,K=A-w,G=A+w;if(K>h&&G<b){A=Math.asin(Math.sin(w)/Math.cos(A));w=F-A;if(w<o)w+=2*Math.PI;F=F+A;if(F>d)F-=2*Math.PI}else{K=Math.max(K,h);G=Math.min(G,b);w=o;F=d}return new u(new s(K*l,w*l),new s(G*
l,F*l))},expand:function(p,r){return new u(new s(p.min.lat-r,p.min.lon-S.normalizeLon(r)),new s(p.max.lat+r,p.max.lon+S.normalizeLon(r)))},forPositions:function(p,r){var w=null,A=T5.ticks();r||(r="auto");for(var F=p.length;F--;)if(w){var K=t.calcSize(w.min,p[F],false),G=t.calcSize(p[F],w.max,false);if(K.x<0)w.min.lon=p[F].lon;if(K.y<0)w.min.lat=p[F].lat;if(G.x<0)w.max.lon=p[F].lon;if(G.y<0)w.max.lat=p[F].lat}else w=new T5.Geo.BoundingBox(p[F],p[F]);if(r){if(r=="auto"){F=t.calcSize(w.min,w.max);r=
Math.max(F.x,F.y)*0.3}w=t.expand(w,r)}COG.Log.trace("calculated bounds for "+p.length+" positions",A);return w},getCenter:function(p){var r=J.calcSize(p.min,p.max);return new T5.Geo.Position(p.min.lat+r.y/2,p.min.lon+r.x/2)},getGeoHash:function(p){var r=T5.Geo.GeoHash.encode(p.min.lat,p.min.lon);p=T5.Geo.GeoHash.encode(p.max.lat,p.max.lon);COG.Log.info("min hash = "+r+", max hash = "+p)},getZoomLevel:function(p,r){var w=t.getCenter(p),A=e[Math.min(Math.round(Math.abs(w.lat)*0.05),e.length)],F=t.calcSize(p.min,
p.max);w=Math.ceil(Math.log(e[3]*r.height/F.y)/Math.log(2));A=Math.ceil(Math.log(A*r.width/F.x)/Math.log(2));return Math.min(isNaN(w)?1E3:w,isNaN(A)?1E3:A)},isEmpty:function(p){return!p||z.empty(p.min)||z.empty(p.max)},toString:function(p){return"min: "+z.toString(p.min)+", max: "+z.toString(p.max)}};return t}(),N=function(){var t=/^(\d+).*$/,p=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(r,w){t.lastIndex=-1;if(t.test(r))for(var A=r.replace(t,"$1"),F=w.split(","),K=0;K<F.length;K++){p.lastIndex=
-1;if(p.test(F[K])){var G=p.exec(F[K]);if(A>=parseInt(G[1],10)&&A<=parseInt(G[2],10))return true}else if(A==F[K])return true}return false},normalize:function(r){if(!r)return"";r=r.toUpperCase();if(!q){var w=[];for(var A in v)w.push(A);q=RegExp("(\\s)("+w.join("|")+")(\\s|$)","i")}q.lastIndex=-1;if(w=q.exec(r))r=r.replace(q,"$1"+v[w[2]]);return r},toString:function(r){return r.streetDetails+" "+r.location}}}(),L={},S={P:z,B:J,A:N,Radius:function(t,p){return{distance:parseInt(t,10),uom:p}},Position:s,
BoundingBox:u,Address:x,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(t){if(!t.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var p=T5.ex({remove:function(){delete L[p.id]}},t);return L[p.id]=p},GeoSearchResult:function(t){t=T5.ex({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},t);return T5.ex(t,{toString:function(){return t.caption+(t.matchWeight?" ("+t.matchWeight+")":"")}})},GeoSearchAgent:function(t){return new T5.Dispatcher.Agent(t)},
GeocodingAgent:function(t){t=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(p,r){try{if(!p.reverse&&!p.freeform)address=new x(p);var w=S.getEngine("geocode");if(w)w.geocode({addresses:[p.freeform?p.freeform:address],complete:function(F,K){if(r){var G=K;if(p.freeform)G=S.rankGeocodeResponses(p.freeform,G,S.getEngine("geocode"));r(G,t)}}})}catch(A){COG.Log.exception(A)}}},t);return new S.GeoSearchAgent(t)}};T5.GeoXY=function(){function t(r,w){if(r.length){for(var A,F,K,G,
W=r.length;W--;){t(r[W],w);A=typeof A==="undefined"||r.x<A?r.x:A;F=typeof F==="undefined"||r.y<F?r.y:F;K=typeof K==="undefined"||r.x>K?r.x:K;G=typeof G==="undefined"||r.y>G?r.y:G}return T5.XYRect.init(A,F,G,G)}else if(r.mercXY){A=r.mercXY;r.x=~~(A.x/w);r.y=~~((Math.PI-A.y)/w);r.radsPerPixel=w}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");return r}function p(r,w,A){r.pos=w;r.mercXY=z.toMercatorPixels(w);(A=typeof A!=="undefined"?A:r.radsPerPixel)&&t(r,A)}return{init:function(r,
w){var A=T5.XY.init();p(A,r,w);return A},sync:t,toPos:function(r,w){w=w?w:self.radsPerPixel;return z.fromMercatorPixels(r.x*w,Math.PI-r.y*w)},updatePos:p}}();S.GeoVector=function(t){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return T5.GeoXY.init(t)};return T5.ex(S,C,B)}();
T5.Geo.GeoHash=function(){function m(n,k,e){if(k&e)n[0]=(n[0]+n[1])/2;else n[1]=(n[0]+n[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(n){var k=1,e=[],a=[];e[0]=-90;e[1]=90;a[0]=-180;a[1]=180;lat_err=90;lon_err=180;for(i=0;i<n.length;i++){c=n[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(k){lon_err/=2;m(a,cd,mask)}else{lat_err/=2;m(e,cd,mask)}k=!k}}e[2]=(e[0]+
e[1])/2;a[2]=(a[0]+a[1])/2;return{latitude:e,longitude:a}},encode:function(n,k,e){var a=1,d=[],h=[],b=0,o=0;e=e?e:12;geohash="";d[0]=-90;d[1]=90;h[0]=-180;for(h[1]=180;geohash.length<e;){if(a){mid=(h[0]+h[1])/2;if(k>mid){o|=BITS[b];h[0]=mid}else h[1]=mid}else{mid=(d[0]+d[1])/2;if(n>mid){o|=BITS[b];d[0]=mid}else d[1]=mid}a=!a;if(b<4)b++;else{geohash+=BASE32[o];o=b=0}}return geohash}}}();
T5.Geo.JSON=function(){function m(l,g,q,v){g=k(g);l.add(v.line(g,q));return g.length}function n(l,g,q,v){g=k(g);l.add(v.poly(g,q));return g.length}function k(l){var g=l?l.length:0,q=Array(g);for(g=g;g--;)q[g]=new T5.Geo.Position(l[g][1],l[g][0]);return T5.Geo.P.vectorize(q,h)}function e(l,g,q){return new f(l,g,q)}var a="featurecollection",d="feature",h={async:false},b={processor:null,group:"shapes",layerClass:T5.ShapeLayer},o={point:T5.ex({},b,{processor:function(l,g,q,v){g=k([g.coordinates],h);if(g.length>
0)if(q=v.marker(g[0],q)){l.add(q);return g.length}},group:"markers",layerClass:T5.MarkerLayer}),linestring:T5.ex({},b,{processor:function(l,g,q,v){g=k(g&&g.coordinates?g.coordinates:[]);return m(l,g,q,v)}}),multilinestring:T5.ex({},b,{processor:function(l,g,q,v){g=g&&g.coordinates?g.coordinates:[];for(var C=0,B=g.length;B--;)C+=m(l,g[B],q,v);return C}}),polygon:T5.ex({},b,{processor:function(l,g,q,v){g=g&&g.coordinates?g.coordinates:[];if(g.length>0)return n(l,g[0],q,v);return 0}}),multipolygon:T5.ex({},
b,{processor:function(l,g,q,v){g=g&&g.coordinates?g.coordinates:[];for(var C=0,B=0;B<g.length;B++)C+=n(l,g[B][0],q,v);return C}})},f=function(l,g,q,v){function C(p,r){var w=p.processor,A=x+p.group,F=T5.ex({},p,q,{properties:r.properties});if(w){var K=S[A];if(!K){K=new p.layerClass({id:A});S[A]=K}globalLayers=S;return w(K,r.data,F,v)}return 0}function B(p,r){var w=p&&p.type?p.type.toLowerCase():null;return w&&w===d?B(p.geometry,p.properties):{type:w,isCollection:w?w===a:false,definition:o[w],data:p,
properties:r?r:p.properties}}q=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},q);v=T5.ex({marker:function(p){return new T5.Marker({xy:p})},line:function(p,r){return new T5.Poly(p,r)},poly:function(p,r){return new T5.Poly(p,T5.ex({fill:true},r))}},v);var s=q.vectorsPerCycle,u=q.rowPreParse,x=q.layerPrefix,z=0,J=0,N=null,L=0,S={},t;if(!l)return null;if(typeof l.length==="undefined")l=[l];J=l.length;t=COG.Loopage.join({frequency:10,execute:function(p,
r){var w=0,A=z;if(!N){for(;A<J;A++){var F=B(u?u(l[A]):l[A]),K=null;if(F.isCollection){L+=1;N=e(F.data.features,function(G){N=null;for(var W in G)S[W]=G[W]},{layerPrefix:x+L+"-"});K+=1}else if(F.definition)K=C(F.definition,F);w+=K?K:1;if(w>=s)break}z=A+1;!N&&z>=J&&r.trigger("complete")}}});t.bind("complete",function(){g&&g(S)});return t};return{parse:e}}();
T5.Geo.LocationSearch=function(m){function n(h,b){navigator.geolocation.clearWatch(e);e=0;if(a){clearTimeout(a);a=0}b&&b([h],m)}function k(h){COG.Log.info("caught location tracking error:",h)}m=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},m);var e=0,a=0,d=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(h,b){if(navigator.geolocation&&!e){e=navigator.geolocation.watchPosition(function(o){var f=new T5.Geo.Position(o.coords.latitude,o.coords.longitude);
o=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:f,accuracy:o.coords.accuracy/1E3,matchWeight:100});if(!d||o.accuracy<d.accuracy)d=o;if(!m.requiredAccuracy||d.accuracy<m.requiredAccuracy)n(d,b)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(m.searchTimeout)a=setTimeout(function(){d&&n(d,b)},m.searchTimeout)}}},m))};
T5.Map=function(m){function n(u){try{var x=new T5.Geo.Position(u.coords.latitude,u.coords.longitude),z=u.coords.accuracy/1E3;s.trigger("locationUpdate",u,z);if(v){if(!g){g=new T5.Geo.UI.LocationOverlay({pos:x,accuracy:z});g.update(s.getTileLayer());s.setLayer("location",g)}var J=T5.Geo.B.createBoundsFromCenter(x,Math.max(z,1));s.gotoBounds(J)}else{g.pos=x;g.accuracy=z;g.update(s.getTileLayer());h(x,null,T5.easing("sine.out"))}v=false}catch(N){COG.Log.exception(N)}}function k(u){COG.Log.info("caught location tracking error:",
u)}function e(){var u=s.getViewRect();if(u){u=T5.XY.init(u.x1+u.width/2,u.y1+u.height/2);return T5.GeoXY.toPos(u,C)}return null}function a(u){if(u&&B!==u){var x=e();B=u;C=T5.Geo.radsPerPixel(B);h(x);s.trigger("zoomLevelChange",B);s.triggerAll("resync",s)}}function d(u,x,z){COG.Log.info("position updated to: ",u);a(x);T5.Images.cancelLoad();T5.cancelAnimation();h(u,z)}function h(u,x,z,J){u=T5.GeoXY.init(u,T5.Geo.radsPerPixel(B));s.updateOffset(u.x,u.y,z,J,x);s.trigger("wake");s.trigger("boundsChange",
s.getBoundingBox());x&&typeof z==="undefined"&&x(s)}m=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,zoomAnimation:T5.easing("quad.out")},m);var b={NONE:0,SINGLE:1,WATCH:2},o=T5.XY.init(),f=b.NONE,l=false,g=null,q=0,v=true,C=0,B=m.zoomLevel;if(!m.provider)m.provider=new T5.Geo.MapProvider;m.adjustScaleFactor=function(u){return Math.pow(2,(u<1?Math.floor:Math.ceil)(Math.log(u)))};var s=T5.ex(new T5.View(m),{getBoundingBox:function(){var u=s.getViewRect();return new T5.Geo.BoundingBox(T5.GeoXY.toPos(T5.XY.init(u.x1,
u.y2),C),T5.GeoXY.toPos(T5.XY.init(u.x2,u.y1),C))},getCenterPosition:e,getZoomLevel:function(){return B},setZoomLevel:a,gotoBounds:function(u,x){var z=T5.Geo.B.getZoomLevel(u,s.getDimensions());d(T5.Geo.B.getCenter(u),z,x)},gotoPosition:d,panToPosition:h,syncXY:function(u){return T5.GeoXY.sync(u,C)},locate:function(){s.trackStart(b.SINGLE);setTimeout(s.trackCancel,1E4)},trackStart:function(u){if(navigator.geolocation&&!q){f=u?u:b.WATCH;v=true;q=navigator.geolocation.watchPosition(n,k,{enableHighAccuracy:true,
timeout:1E4,maximumAge:5E3})}},trackCancel:function(){q&&navigator.geolocation&&navigator.geolocation.clearWatch(q);s.removeLayer("location");g=null;f=b.NONE;q=0},zoomIn:function(){T5.Geo.radsPerPixel(B);T5.Geo.radsPerPixel(B+1);s.scale(2,T5.easing("sine.out"))||s.setZoomLevel(B+1)},zoomOut:function(){T5.Geo.radsPerPixel(B);T5.Geo.radsPerPixel(B-1);s.scale(0.5,T5.easing("sine.out"))||s.setZoomLevel(B-1)},animateRoute:function(u,x,z,J){var N=s.getLayer("route");if(N)(u=N.getAnimation(u,x,z,J))&&u.addToView(s)}});
s.bind("pan",function(){f===b.SINGLE&&s.trackCancel()});s.bind("tap",function(){});s.bind("doubleTap",function(u,x,z){s.scalable()&&s.animate(2,T5.D.getCenter(s.getDimensions()),T5.XY.init(z.x,z.y),m.zoomAnimation)});s.bind("scale",function(u,x,z){u=0;x=Math.sqrt(x);if(x<1)u=-(0.5/x);else if(x>1)u=x;COG.Log.info("zoom xy = ",z);d(T5.GeoXY.toPos(z,C),B+u>>0)});s.bind("idle",function(){if(T5.XY.absSize(T5.XY.diff(o,s.getOffset()))>m.boundsChangeThreshold){o=T5.XY.copy(s.getOffset());s.trigger("boundsChange",
s.getBoundingBox())}});COG.configurable(s,["provider"],COG.paramTweaker(m,null,{provider:function(){s.cleanup();l=false}}),true);return s};
T5.Geo.MapProvider=function(){var m=1,n=20;return{zoomLevel:0,checkZoomLevel:function(k){return Math.min(Math.max(k,m),n)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:m,max:n}},prepTileGridArgs:function(k,e,a,d,h){var b=null;if(h.tileBackgroundColor){b=T5.Images.newCanvas(a,a);var o=b.getContext("2d");o.fillStyle=h.tileBackgroundColor;o.fillRect(0,0,a,a)}return T5.ex({tileSize:a,width:k,height:e,center:d,tileDrawArgs:{background:b}},
h)},setZoomRange:function(k,e){m=k;n=e}}};T5.MapTileGenerator=function(m){function n(d,h){COG.Log.info("ZOOM LEVEL CHANGED");k=h;a.reset()}var k=0,e=null,a=T5.ex(new T5.TileGenerator(m),{getTileCreatorArgs:function(d){e=d.getCenterPosition();return{zoomLevel:k,position:e}},requireRefresh:function(){return!e}});a.bind("bindView",function(d,h){if(h.getZoomLevel){k=h.getZoomLevel();h.bind("zoomLevelChange",n)}});return a};
T5.Geo.Routing=function(){var m={calculate:function(n){n=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},n);var k=T5.Geo.getEngine("route");k&&k.route(n,function(e){if(n.generalize)e.geometry=T5.Geo.P.generalize(e.geometry,e.getInstructionPositions());if(n.map){m.createMapOverlay(n.map,e);n.autoFit&&n.map.gotoBounds(e.boundingBox)}n.success&&n.success(e)})},createMapOverlay:function(n,k){var e=n.getDimensions();e=new T5.Geo.UI.RouteOverlay({data:k,width:e.width,
height:e.height});n.setLayer("route",e)},parseTurnType:function(n){for(var k=m.TurnType.Unknown,e=T5.Geo.Routing.TurnTypeRules,a=0;a<e.length;a++){e[a].regex.lastIndex=-1;var d=e[a].regex.exec(n);if(d){k=e[a].customCheck?e[a].customCheck(n,d):e[a].turnType;break}}return k},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(n){var k=n=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},n),e=n.description;e=e.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");k.description=e;if(!n.turnType)n.turnType=m.parseTurnType(n.description);return n},RouteData:function(n){n=T5.ex({geometry:[],instructions:[],boundingBox:null},
n);if(!n.boundingBox)n.boundingBox=T5.Geo.B.forPositions(n.geometry);return T5.ex({getInstructionPositions:function(){for(var k=[],e=0;e<n.instructions.length;e++)n.instructions[e].position&&k.push(n.instructions[e].position);return k}},n)}};return m}();T5.Geo.Search=function(){return{bestResults:function(m,n){n||(n=20);for(var k=m.length>0?m[0]:null,e=[],a=0;a<m.length;a++)if(k&&m[a]&&k.matchWeight-m[a].matchWeight<=n)e.push(m[a]);else break;return e}}}();
T5.Geo.UI=function(){var m={AnnotationTween:null,RouteOverlay:function(n){n=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},n);var k=[],e=[],a=new T5.PathLayer(n);(function(){if(n.data&&n.data.instructions){for(var d=n.data.instructions,h=Array(d.length),b=d.length;b--;)h[b]=d[b].position;T5.Geo.P.vectorize(h).bind("complete",function(o,f){e=f})}n.data&&n.data.geometry&&T5.Geo.P.vectorize(n.data.geometry).bind("complete",
function(o,f){k=f;a.updateCoordinates(k,e,true)})})();return a},Poly:function(n,k){k=T5.ex({autoParse:true},k);for(var e=Array(n.length),a=k.autoParse,d=T5.Geo.P.parse,h=n.length;h--;)e[h]=T5.GeoXY.init(a?d(n[h]):n[h]);return new T5.Poly(e,k)},Annotation:function(n){n=T5.ex({pos:null},n);n.xy=T5.GeoXY.init(n.pos);return new T5.ImageAnnotation(n)},LocationOverlay:function(n){n=T5.ex({pos:null,accuracy:null,zindex:90},n);var k=new Image,e=T5.XY.init(),a=T5.XY.init(),d=null;k.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
k.onload=function(){e=T5.XY.init(k.width/2,k.height/2)};var h=T5.ex(new T5.ViewLayer(n),{pos:n.pos,accuracy:n.accuracy,drawAccuracyIndicator:false,draw:function(b,o){var f=a.x-o.x,l=a.y-o.y;if(d){b.fillStyle="rgba(30, 30, 30, 0.2)";b.beginPath();b.arc(f,l,d,0,Math.PI*2,false);b.fill()}k.complete&&k.width>0&&b.drawImage(k,f-e.x,l-e.y,k.width,k.height);h.changed()},update:function(b){if(b){d=Math.floor(b.getPixelDistance(h.accuracy)*0.5);a=b.getGridXYForPosition(h.pos);h.changed()}}});h.bind("gridUpdate",
function(b,o){h.update(o)});return h},AnnotationsOverlay:function(n){function k(b,o){var f=b.length,l=h.getParent();if(o=o?o:l?l.getTileLayer():null)for(f=f;f--;)o.syncVectors([b[f].xy]);b.sort(function(g,q){var v=q.xy.y-g.xy.y;if(v===0)v=q.xy.x-g.xy.x;return v})}n=T5.ex({pois:null,map:null,zindex:100},n);var e=[],a=false,d=[],h=T5.ex(new T5.ViewLayer(n),{cycle:function(){return a},draw:function(b,o,f,l,g){a=false;b.fillStyle="rgba(255, 0, 0, 0.75)";b.globalCompositeOperation="source-over";for(f=
e.length;f--;){e[f].draw(b,o,l,h,g);a=a||e[f].isAnimating()}for(f=d.length;f--;){d[f].draw(b,o,l,h,g);a=a||d[f].isAnimating()}return a?1:0},add:function(b){if(b&&b.length)for(var o=b.length;o--;)d[d.length]=b[o];else if(b)d[d.length]=b;k(d);h.changed()},clear:function(b){d=[];k(d);if(b){e=[];k(e)}h.changed()}});COG.listen("geo.pois-updated",function(b){if(n.pois&&n.pois.id==b.srcID){b=b.pois;try{e=[];for(var o=0;o<b.length;o++)if(b[o].pos){var f;var l=b[o];if(l&&l.pos){var g={poi:l,annotation:null};
n.map&&n.map.trigger("getAnnotationForPOI",g);if(!g.annotation)g.annotation=new T5.Annotation({xy:T5.GeoXY.init(l.pos)});if(g.annotation){g.annotation.isNew=l.isNew;l.isNew=false}f=g.annotation}else f=void 0;f&&e.push(f)}k(e)}catch(q){COG.Log.exception(q)}h.changed()}});h.bind("gridUpdate",function(b,o){k(e,o);k(d,o);h.changed()});return h}};m.ImageAnnotation=m.Annotation;return m}();
T5.Geo.Routing.TurnTypeRules=function(){var m=T5.Geo.Routing.TurnType,n=[];n.push({regex:/continue/i,turnType:m.Continue});n.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(k,e){return/bear/i.test(e[1])?m.TurnLeftSlight:m.TurnLeft}});n.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(k,e){return/bear/i.test(e[1])?m.TurnRightSlight:m.TurnRight}});n.push({regex:/enter\s(roundabout|rotaty)/i,turnType:m.EnterRoundabout});n.push({regex:/take.*?ramp/i,turnType:m.Ramp});n.push({regex:/take.*?exit/i,
turnType:m.RampExit});n.push({regex:/make(.*?)u\-turn/i,customCheck:function(k,e){return/right/i.test(e[1])?m.UTurnRight:m.UTurnLeft}});n.push({regex:/proceed/i,turnType:m.Start});n.push({regex:/arrive/i,turnType:m.Arrive});n.push({regex:/fell\sthrough/i,turnType:m.Merge});return n}();
