COG=function(){var l=/\$\{(.*?)\}/ig,o=Object.prototype.hasOwnProperty,m=0,f={id:"grunt.core",extend:function(){var a=arguments[0]||{},d=1,g=arguments.length,e=false,n,b,h,k;if(typeof a==="boolean"){e=a;a=arguments[1]||{};d=2}if(typeof a!=="object"&&!f.isFunction(a))a={};if(g===d){a=this;--d}for(;d<g;d++)if((n=arguments[d])!=null)for(b in n){h=a[b];k=n[b];if(a!==k)if(e&&k&&(f.isPlainObject(k)||f.isArray(k))){h=h&&(f.isPlainObject(h)||f.isArray(h))?h:f.isArray(k)?[]:{};a[b]=f.extend(e,h,k)}else if(k!==
undefined)a[b]=k}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!o.call(a,"constructor")&&!o.call(a.constructor.prototype,"isPrototypeOf"))return false;var d;for(d in a);return d===undefined||o.call(a,d)},isEmptyObject:function(a){for(var d in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,d){var g=a,e=arguments,n=1;if(d&&f.isArray(d)){e=d;n=0}for(n=n;n<e;n++)g=g&&typeof foo[e[n]]!=="undefined";return g},newModule:function(a){a=f.extend({id:null,requires:[],parent:null},a);if(a.parent)a=f.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+m++},formatStr:function(a){if(arguments.length<=1)return a;for(var d=arguments.length-2,g=0;g<=d;g++)a=a.replace(RegExp("\\{"+g+"\\}","gi"),arguments[g+
1]);return a},wordExists:function(a,d){var g="";if(d.toString)d=d.toString();for(var e=0;e<d.length;e++)g+=!/\w/.test(d[e])?"\\"+d[e]:d[e];return RegExp("(^|\\s|\\,)"+g+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,d){for(var g=l.exec(a);g;){a=a.replace(g[0],COG.XPath.first(g[1],d));l.lastIndex=0;g=l.exec(a)}return a}};return f}();
COG.Log=function(){function l(d,g){var e,n=g&&g.length>0?g[0]:"";for(e=1;g&&e<g.length;e++)n+=" "+(m&&COG.isPlainObject(g[e])?JSON.stringify(g[e]):g[e]);typeof console!=="undefined"&&console[d](n);for(e=0;e<o.length;e++)o[e].call(a,n,d)}var o=[],m=typeof JSON!=="undefined",f=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return f?(new Date).getTime():null},trace:function(d,g){if(f)console.markTimeline(d+(g?": "+(a.getTraceTicks()-g)+"ms":""))},debug:function(){l("debug",
arguments)},info:function(){l("info",arguments)},warn:function(){l("warn",arguments)},error:function(){l("error",arguments)},exception:function(d){a.error(arguments);for(var g in d)a.info("ERROR DETAIL: "+g+": "+d[g])},watch:function(d,g){try{g()}catch(e){a.exception(e,d)}},throwError:function(d){a.error(d);throw Error(d);},requestUpdates:function(d){o.push(d)}};return a}();
(function(){function l(f,a){f[a]||(f[a]=function(d){return f.configure(a,d)})}function o(f){f.gtConfId=COG.objId("configurable");f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var m={};COG.paramTweaker=function(f,a,d){return function(g,e){if(typeof e!=="undefined"){if(g in f)f[g]=e;d&&g in d&&d[g](g,e)}else return a&&g in a?a[g](g):f[g]}};COG.configurable=function(f,a,d,g){if(f){f.gtConfId||o(f);var e=f.gtConfId,n=f.gtConfig,b=f.gtConfigFns;m[e]=f;b.push(d);for(d=a.length;d--;){n[a[d]]=true;g&&
l(f,a[d])}if(!f.configure)f.configure=function(h,k){if(n[h]){for(var p=b.length;p--;){var r=b[p](h,k);if(typeof r!=="undefined")return r}return m[e]}return null}}}})();
(function(){function l(o,m){var f=o.gtObsHandlers;f[m]||(f[m]=[]);return f[m]}COG.observable=function(o){if(o){if(!o.gtObsHandlers)o.gtObsHandlers={};if(!(o.bind||o.trigger||o.unbind)){o.bind=function(m,f){var a=COG.objId("callback");l(o,m).unshift({fn:f,id:a});return a};o.trigger=function(m){var f=l(o,m),a={cancel:false,tickCount:(new Date).getTime()},d;if(!f)return null;d=Array.prototype.slice.call(arguments,1);d.unshift(a);for(var g=f.length;g--&&!a.cancel;)f[g].fn.apply(self,d);return a};o.unbind=
function(m,f){for(var a=l(o,m),d=0;a&&d<a.length;d++)if(a[d].id===f){a.splice(d,1);break}return o}}}}})();(function(){var l={},o=[];COG.addPipe=function(m){m("pipe.test",{});o.push(m)};COG.listen=function(m,f){l[m]||(l[m]=[]);f&&l[m].push(f)};COG.say=function(m,f){var a;for(a=o.length;a--;)o[a](m,f);if(l[m])for(a=l[m].length;a--;)l[m][a](f)}})();
COG.Loopage=function(){function l(k){return COG.extend({id:d++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},k)}function o(k){e.push(k);m()}function m(){n&&clearTimeout(n);n=setTimeout(f,0);h=true}function f(){for(var k,p=(new Date).getTime(),r=g.length;e.length>0;){var s=e.shift();for(k=r;k--;)if(g[k].id===s){g.splice(k,1);break}h=true;r=g.length}if(h){b=a;for(k=r;k--;)b=g[k].frequency<b?g[k].frequency:b}for(k=r;k--;){s=p-g[k].lastTick;if(g[k].lastTick===0||s>=g[k].frequency){g[k].execute(p,
g[k]);g[k].lastTick=p;g[k].single&&g[k].trigger("complete")}}n=r?setTimeout(f,b):0}var a=6E4,d=0,g=[],e=[],n=0,b=a,h=true;return{join:function(k){var p=new l(k);if(p.after>0)p.lastTick=(new Date).getTime()+p.after;COG.observable(p);p.bind("complete",function(){o(p.id)});g.unshift(p);m();return p},leave:o}}();if(!this.JSON)this.JSON={};
(function(){function l(b){return b<10?"0"+b:b}function o(b){a.lastIndex=0;return a.test(b)?'"'+b.replace(a,function(h){var k=e[h];return typeof k==="string"?k:"\\u"+("0000"+h.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function m(b,h){var k,p,r,s,A=d,v,w=h[b];if(w&&typeof w==="object"&&typeof w.toJSON==="function")w=w.toJSON(b);if(typeof n==="function")w=n.call(h,b,w);switch(typeof w){case "string":return o(w);case "number":return isFinite(w)?String(w):"null";case "boolean":case "null":return String(w);
case "object":if(!w)return"null";d+=g;v=[];if(Object.prototype.toString.apply(w)==="[object Array]"){s=w.length;for(k=0;k<s;k+=1)v[k]=m(k,w)||"null";r=v.length===0?"[]":d?"[\n"+d+v.join(",\n"+d)+"\n"+A+"]":"["+v.join(",")+"]";d=A;return r}if(n&&typeof n==="object"){s=n.length;for(k=0;k<s;k+=1){p=n[k];if(typeof p==="string")if(r=m(p,w))v.push(o(p)+(d?": ":":")+r)}}else for(p in w)if(Object.hasOwnProperty.call(w,p))if(r=m(p,w))v.push(o(p)+(d?": ":":")+r);r=v.length===0?"{}":d?"{\n"+d+v.join(",\n"+d)+
"\n"+A+"}":"{"+v.join(",")+"}";d=A;return r}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,g,e={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},n;if(typeof JSON.stringify!=="function")JSON.stringify=function(b,h,k){var p;g=d="";if(typeof k==="number")for(p=0;p<k;p+=1)g+=" ";else if(typeof k==="string")g=k;if((n=h)&&typeof h!=="function"&&(typeof h!=="object"||typeof h.length!=="number"))throw Error("JSON.stringify");return m("",
{"":b})};if(typeof JSON.parse!=="function")JSON.parse=function(b,h){function k(r,s){var A,v,w=r[s];if(w&&typeof w==="object")for(A in w)if(Object.hasOwnProperty.call(w,A)){v=k(w,A);if(v!==undefined)w[A]=v;else delete w[A]}return h.call(r,s,w)}var p;b=String(b);f.lastIndex=0;if(f.test(b))b=b.replace(f,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){p=eval("("+b+")");return typeof h==="function"?k({"":p},""):p}throw new SyntaxError("JSON.parse");}})();
(function(){function l(m,f){var a=m.split("|"),d={};for(var g in f){var e=f[g];d[g]=a.length>e?a[e]:null}return d}var o={JSON:{parse:function(m){return JSON.parse(m)}},PDON:{parse:function(m){var f=null,a=[];m=m.split("\n");for(var d=0;d<m.length;d++){var g=m[d];if(f)a.push(l(g,f));else if(g){f=g.split("|");g={};for(var e=0;e<f.length;e++)g[f[e]]=e;f=g}else f=null}return a}}};COG.parseData=function(m,f){f=f?f.toUpperCase():"JSON";if(!o[f])throw Error("Unsupported data format: "+f);try{return o[f].parse(m)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function l(a){for(var d=null,g=0;g<o.length;g++)if(d=o[g](a))break;return d}var o=[],m=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var f={SearchResult:function(a){return{toString:function(){var d=
null;if(a){var g=null;if(a.resultType>=0&&a.resultType<m.length)g=m[a.resultType];if(g)d=g(a)}return d?d:""}}},first:function(a,d){var g=f.SearchResult,e;var n=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!n)n=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(d))e=d.evaluate(a,d,l,n,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");e=null}}catch(b){COG.Log.warn("invalid xpath expression: "+a+" on node: "+d);e=null}return new g(e)},registerResolver:function(a){o.push(a)}};return f}();
COG.Storage=function(){function l(o){if(o&&o=="session")return sessionStorage;return localStorage}return{get:function(o,m){var f=l(m).getItem(o);return/^(\{|\[).*(\}|\])$/.test(f)?JSON.parse(f):f},set:function(o,m,f){m=jQuery.isArray(m)||jQuery.isPlainObject(m)?JSON.stringify(m):m;l(f).setItem(o,m)},remove:function(o,m){l(m).removeItem(o)}}}();
COG.ParseRules=function(){var l=[];return{add:function(o,m){l.push({regex:o,handler:m})},each:function(o,m,f){function a(){d++;f&&d>=l.length&&f(m)}for(var d=0,g=0;g<l.length;g++){var e=l[g].regex,n=l[g].handler,b=false;if(e){e.lastIndex=-1;if((e=e.exec(o))&&n){b=true;n(e,m,a)&&a()}}b||a()}}}};
(function(){function l(e){var n=[],b=function(k,p){p=COG.isFunction(p)?p():p;n[n.length]=encodeURIComponent(k)+"="+encodeURIComponent(p)};if(COG.isArray(e))for(var h=0;h<e.length;h++)b(e[h].name,e[h].value);else for(h in e)b(h,e[h]);return n.join("&").replace(/%20/g,"+")}var o={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},m={JSON:["json"],PDON:["pdon.txt"]},f=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,d={XML:function(e){return e.responseXML},JSON:function(e){return COG.parseData(e.responseText)},
PDON:function(e){return COG.parseData(e.responseText,"PDON")},DEFAULT:function(e){return e.responseText}},g={CONTENT_TYPE:"Content-Type"};COG.xhr=function(e){function n(){if(this.readyState===4){var p=null,r=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(r)if(e.handleResponse)e.handleResponse(this);else{var s=e,A=this.getResponseHeader(g.CONTENT_TYPE),v,w=false;for(v in o)if(A&&A.indexOf(o[v])>=0){w=true;
break}A=!w;for(w=0;w<f.length;w++)A=A||f[w]==v;if(A)b:{A=v;for(var B in m)for(w=0;w<m[B].length;w++)if(RegExp(m[B][w]+"$","i").test(s.url)){v=B;break b}v=A?A:"DEFAULT"}try{p=d[v](this,s)}catch(E){p=d.DEFAULT(this,s)}}else e.error&&e.error(this)}catch(J){COG.Log.exception(J,"PROCESSING AJAX RESPONSE")}r&&p&&e.success&&e.success.call(this,p)}}try{e=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},e);var b=
a.exec(e.url),h=b&&(b[1]&&b[1]!==location.protocol||b[2]!==location.host);if(e.data)e.method="POST";if(e.url){b=null;if(e.xhr)b=e.xhr(e);b||(b=new XMLHttpRequest);b.open(e.method,e.url,e.async);e.data&&b.setRequestHeader("Content-Type",e.contentType);h||b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.onreadystatechange=n;b.send(e.method=="POST"?l(e.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(k){COG.Log.exception(k)}}})();
(function(){function l(a){var d=document.createElement("script"),g=false;d.src=a;d.async=true;d.onload=d.onreadystatechange=function(){if(!g&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){g=true;d.onload=d.onreadystatechange=null;d&&d.parentNode&&d.parentNode.removeChild(d)}};m||(m=document.getElementsByTagName("head")[0]);m.appendChild(d)}var o=0,m,f=this;COG.jsonp=function(a,d,g){a+=a.indexOf("?")>=0?"&":"?";var e="json"+ ++o;f[e]=function(n){d(n);f[e]=null;try{delete f[e]}catch(b){}};
l(a+(g?g:"callback")+"="+e);return e}})();
COG.Touch=function(){function l(D,G){return{x:D.x-G.x,y:D.y-G.y}}function o(D,G){var H=l(D,G);return Math.sqrt(H.x*H.x+H.y*H.y)}function m(D){if(D.count>1)return o(D.touches[0],D.touches[1]);return 0}function f(D,G){var H=D&&D.count>0?D.touches[0]:null;if(H&&G&&G.count>0)return l(H,G.touches[0]);return null}function a(D,G){D.count=G.count;for(var H=b;H--;){D.touches[H].x=G.touches[H].x;D.touches[H].y=G.touches[H].y}}function d(){for(var D={count:0,touches:Array(b)},G=b;G--;)D.touches[G]=n();return D}
function g(D){if(D.preventDefault){D.preventDefault();D.stopPropagation()}else D.cancelBubble&&D.cancelBubble()}function e(D,G,H){if(O){G=G[H?H:"touches"];H=G.length;for(H=D.count=H;H--;){D.touches[H].x=G[H].pageX;D.touches[H].y=G[H].pageY}}else if(G.button===0){D.count=1;D.touches[0].x=G.pageX?G.pageX:G.screenX;D.touches[0].y=G.pageY?G.pageY:G.screenY}else D.count=0}function n(D,G){return{x:D?D:0,y:G?G:0}}var b=10,h=120,k=h*8,p=100,r=250,s=300,A=5,v=0,w=1,B=2,E=7,J=0,L=0,O=undefined,U=function(D){function G(C,
t,x,I){var N=Math.asin((C.y-t.y)/x);x=x*(na/I)>>0;x=x>ga?ga:x;N=t.x>C.x?N:Math.PI-N;q("pan",Math.cos(N)*-x,Math.sin(N)*x,true)}function H(C,t){var x,I;if(O){x=t-oa;if(x<r){I=o(S.touches[0],C);I>D.inertiaTrigger&&G(S.touches[0],C,I,x)}}else{aa.x=C.x;aa.y=C.y;COG.Loopage.join({execute:function(N,Q){x=N-t;I=o(C,aa);if(x<p&&I>D.inertiaTrigger){Q.trigger("complete");G(C,aa,I,x)}else x>p&&Q.trigger("complete")},frequency:10})}}function W(C){var t=0,x=0;if(C.offsetParent){do{t+=C.offsetLeft;x+=C.offsetTop;
C=C.offsetParent}while(C)}return n(t,x)}function y(C){var t=C.count,x=Array(t),I=W(X);for(t=t;t--;)x[t]=n(C.touches[t].x-I.x,C.touches[t].y-I.y);return x}function q(){ra&&ra.trigger.apply(null,arguments)}function u(C,t){var x=W(X);x=n(t.x-x.x,t.y-x.y);q(C,t,x)}function z(C){var t=C.target?C.target:C.srcElement;if(ja||t&&t===X){e(S,C);if(S.count!==0){ea=null;da.x=0;da.y=0;pa=true;M=false;oa=(new Date).getTime();g(C);t.style.cursor="move";q("inertiaCancel");ka=oa;if(C=S.count>0?S.touches[0]:null){q("touchStart",
C.x,C.y);if(ka-sa<s)if((C=l(S.touches[0],fa.touches[0]))&&Math.abs(C.x)<D.maxDistDoubleTap&&Math.abs(C.y)<D.maxDistDoubleTap)M=true;ca=v;a(fa,S)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function F(C){var t=C.target?C.target:C.srcElement,x=0;if(ja||t&&t===X){e(ba,C);if(ba.count>0){aa.x=ba.touches[0].x;aa.y=ba.touches[0].y}if(pa){O&&g(C);if(ba.count>1){S.count===1&&a(S,ba);x=m(S)-m(ba)}if(ca===v)if((C=f(ba,S))&&(Math.abs(C.x)>=E||Math.abs(C.y)>=E))ca=w;if(ca!==v)if(!x||Math.abs(x)<
A){if(ea=f(ba,fa)){da.x-=ea.x;da.y-=ea.y;R.x-=ea.x;R.y-=ea.y}q("pan",R.x,R.y);R.x=0;R.y=0;ca=w}else{q("pinchZoom",y(S),y(ba));ca=B}a(fa,ba)}}}function K(C){var t=C.target?C.target:C.srcElement;if(pa&&(ja||t&&t===X)){e(qa,C,"changedTouches");var x=qa.touches[0];O&&g(C);C=(new Date).getTime();sa=ka;if(ca===v){u("tap",S.touches[0]);Y||(Y=setTimeout(function(){Y=0;M&&u("doubleTap",S.touches[0])},s+50))}else if(ca==w){q("panEnd",da.x,da.y);la&&H(x,C)}else ca==B&&q("pinchZoomEnd",y(S),y(fa),C-oa);t.style.cursor=
"default";pa=false}}function P(C){var t=C.target?C.target:C.srcElement;if(ja||t&&t===X){if(C.detail){t=-C.detail*h;t=n(C.axis===1?t:0,C.axis===2?t:0)}else t=n(C.wheelDeltaX,C.wheelDeltaY);t=t.y/k;if(aa&&t!==0){var x=n(aa.x-X.offsetLeft,aa.y-X.offsetTop);q("wheelZoom",x,t)}g(C)}}D=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,
wheelZoomHandler:null},D);var M=false,Y=0,Z=T5.getConfig(),S=d(),ba=d(),fa=d(),qa=d(),ea=null,da=n(),R=n(),ca=null,pa=false,oa=0,ma=[],aa=n(),la=false,na,ga,ka=0,sa=0,X=D.element,ra=D.observable,ja=typeof FlashCanvas!=="undefined",ta={supportsTouch:O,addListeners:function(C){ma.push(C)},decoupleListeners:function(C){for(var t=0;C&&t<ma.length;t++)if(ma[t].listenerId===C){ma.splice(t,1);break}},release:function(){Z.unbindEvent(O?"touchstart":"mousedown",z,false);Z.unbindEvent(O?"touchmove":"mousemove",
F,false);Z.unbindEvent(O?"touchend":"mouseup",K,false);if(!O){window.removeEventListener("mousewheel",P,false);window.removeEventListener("DOMMouseScroll",P,false)}},inertiaEnable:function(C,t){la=true;na=C;ga=t?Math.min(t.width,t.height):500},inertiaDisable:function(){la=false}};if(typeof O==="undefined")O=T5.getConfig().supportsTouch;Z.bindEvent(O?"touchstart":"mousedown",z,false);Z.bindEvent(O?"touchmove":"mousemove",F,false);Z.bindEvent(O?"touchend":"mouseup",K,false);if(!O){Z.bindEvent("mousewheel",
P,window);Z.bindEvent("DOMMouseScroll",P,window)}return ta},T=[];return{capture:function(D,G){if(!D)throw Error("Unable to capture touch of null element");if(!D.id)D.id="touchable_"+J++;var H=T[D.id];if(!H){H=new U(COG.extend({element:D},G));T[D.id]=H}if(G){G.listenerId&&H.decoupleListeners(G.listenerId);G.listenerId=++L;H.addListeners(G)}return H},release:function(D){if(D&&D.id&&T[D.id]){T[D.id].release();delete T[D.id]}}}}();
T5=function(){var l=function(){function d(n,b){return e(n.x-b.x,n.y-b.y)}function g(n,b){if(!b)b=n.length;if(b<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var h={edges:Array(b-1),accrued:Array(b-1),total:0},k=0;k<b-1;k++){var p=d(n[k],n[k+1]);h.edges[k]=Math.sqrt(p.x*p.x+p.y*p.y);h.accrued[k]=h.total+h.edges[k];h.total+=h.edges[k]}return h}function e(n,b){return{x:n?n:0,y:b?b:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var n=
0,b=0,h=arguments.length;h--;){n+=arguments[h].x;b+=arguments[h].y}return e(n,b)},absSize:function(n){return Math.max(Math.abs(n.x),Math.abs(n.y))},copy:function(n){return n?e(n.x,n.y):null},diff:d,distance:function(n,b){return g(n,b).total},edges:g,equals:function(n,b){return n.x===b.x&&n.y===b.y},extendBy:function(n,b,h){return e(n.x-Math.cos(b)*h,n.y-Math.sin(b)*h)},floor:function(n){for(var b=Array(n.length),h=n.length;h--;)b[h]=e(~~n[h].x,~~n[h].y);return b},getRect:function(n){for(var b,h,k,
p,r=n.length;r--;){var s=n[r];b=typeof b==="undefined"||s.x<b?s.x:b;h=typeof h==="undefined"||s.y<h?s.y:h;k=typeof k==="undefined"||s.x>k?s.x:k;p=typeof p==="undefined"||s.y>p?s.y:p}return m.init(b,h,k,p)},init:e,invert:function(n){return e(-n.x,-n.y)},min:function(n,b){return e(n.x<b.x?n.x:b.x,n.y<b.y?n.y:b.y)},max:function(n,b){return e(n.x>b.x?n.x:b.x,n.y>b.y?n.y:b.y)},offset:function(n,b,h){return e(n.x+b,n.y+(h?h:b))},simplify:function(n,b){if(!n)return null;b=b?b:l.VECTOR_SIMPLIFICATION;for(var h=
[],k=null,p=n.length;p--;){var r=n[p];if(include=!k||p===0||Math.abs(r.x-k.x)+Math.abs(r.y-k.y)>b){h.unshift(r);k=r}}return h},theta:function(n,b,h){h=Math.asin((n.y-b.y)/h);return n.x>b.x?h:Math.PI-h}}}(),o=function(){return{dotProduct:function(d,g){return d.x*g.x+d.y*g.y}}}(),m=function(){function d(e){return g(e.x1,e.y1,e.x2,e.y2)}function g(e,n,b,h){e=e?e:0;n=n?n:0;b=typeof b!=="undefined"?b:e;h=typeof h!=="undefined "?h:h;return{x1:e,y1:n,x2:b,y2:h,width:b-e,height:h-n}}return{center:function(e){return l.init(e.x1+
e.width/2,e.y1+e.height/2)},copy:d,diagonalSize:function(e){return Math.sqrt(e.width*e.width+e.height*e.height)},fromCenter:function(e,n,b,h){b=~~(b/2);h=~~(h/2);return g(e-b,n-h,e+b,n+h)},init:g,intersect:function(e,n){var b=g(Math.max(e.x1,n.x1),Math.max(e.y1,n.y1),Math.min(e.x2,n.x2),Math.min(e.y2,n.y2));return b.width>0&&b.height>0?b:null},union:function(e,n){if(e.width===0||e.height===0)return d(n);else if(n.width===0||n.height===0)return d(e);else{var b=g(Math.min(e.x1,n.x1),Math.min(e.y1,n.y1),
Math.max(e.x2,n.x2),Math.max(e.y2,n.y2));return b.width>0&&b.height>0?b:null}}}}(),f=function(){return{getAspectRatio:function(d){return d.height!==0?d.width/d.height:1},getCenter:function(d){return l.init(d.width/2,d.height/2)},getSize:function(d){return Math.sqrt(Math.pow(d.width,2)+Math.pow(d.height,2))},init:function(d,g){d=d?d:0;return{width:d,height:g?g:d}}}}(),a={ex:COG.extend,ticks:function(){return(new Date).getTime()},userMessage:function(d,g,e){a.trigger("userMessage",d,g,e)},XY:l,XYRect:m,
Vector:function(d,g){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return l.init(d,g)},V:COG.extend(l,o),D:f};COG.observable(a);return a}();
(function(){function l(){for(;s.length>0;){var v=s.shift();document.location=v}r=0}function o(v){for(var w=true,B=A.length;B--;)w=w&&v!=A[B];return w}function m(v,w){var B=[];for(var E in w)E&&B.push(E+"="+escape(w[E]));return"tile5://"+v+"/"+(B.length>0?"?"+B.join("&"):"")}function f(v,w){o(v)&&COG.Log.info("would push url: "+m(v,w))}function a(v,w){if(o(v)){s.push(m(v,w));r||(r=setTimeout(l,100))}}function d(v){return function(w,B,E){(E?E:v?document.body:document).addEventListener(w,B,false)}}function g(v){return function(w,
B,E){(E?E:v?document.body:document).removeEventListener(w,B,false)}}function e(v,w,B){(B?B:document).attachEvent("on"+v,w)}function n(v,w,B){(B?B:document).detachEvent("on"+v,w)}function b(){h={base:{name:"Unknown",bindEvent:d(),unbindEvent:g(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:f,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:e,unbindEvent:n,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:d(true),unbindEvent:g(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};k=[h.froyo,h.android,h.ipod,h.iphone,h.ipad,h.ie]}var h=null,k=[],p=null,r=0,s=[],A=["view.wake","tile.loaded"];T5.getConfig=function(){h||b();if(!p){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var v=0;v<k.length;v++){var w=k[v];if(w.regex&&w.regex.test(navigator.userAgent)){p=T5.ex({},h.base,w);COG.Log.info("PLATFORM DETECTED AS: "+p.name);break}}if(!p){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
p=h.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return p}})();
T5.Dispatcher=function(){var l=[],o={execute:function(m){var f=o.findAction(m);f&&f.execute.apply(f,Array.prototype.slice.call(arguments,1))},findAction:function(m){for(var f=l.length;f--;)if(l[f].id==m)return l[f];return null},getRegisteredActions:function(){return[].concat(l)},getRegisteredActionIds:function(){for(var m=[],f=l.length;f--;)l[f].id&&m.push(l[f].id);return m},registerAction:function(m){m&&m.id&&l.push(m)},Action:function(m){m=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},m);var f={id:m.id,execute:function(){m.execute&&m.execute.apply(this,arguments)},getParam:function(a){return m[a]?m[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",f.id,m.title,m.icon)}};m.autoRegister&&o.registerAction(f);return f},Agent:function(m){m=COG.extend({name:"Untitled",translator:null,execute:null},m);var f={getName:function(){return m.name},getParam:function(a){return m[a]},getId:function(){return COG.toID(f.getName())},run:function(a,d){if(m.execute){var g=
m.translator?m.translator(a):a;m.execute.call(f,g,function(e,n){d&&d(e,n,g)})}}};return f},runAgents:function(m,f,a){for(var d=0;d<m.length;d++)m[d].run(f,a)}};return o}();
T5.Resources=function(){var l="",o={},m={getPath:function(f){return/^(file|https?|\/)/.test(f)?f:l+f},setBasePath:function(f){l=f},loadResource:function(f){f=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},f);var a=function(d){f.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){f.callback(d)})};f.cacheable&&o[f.filename]?a(o[f.filename]):COG.xhr({url:m.getPath(f.filename),dataType:f.dataType,success:function(d){if(f.cacheable)o[f.filename]=d;a(d)},error:function(d,g,e){COG.Log.error("error loading resource ["+
f.filename+"], error = "+e)}})},loadSnippet:function(f,a){/\.\w+$/.test(f)||(f+=".html");m.loadResource({filename:"snippets/"+f,callback:a,dataType:"html"})}};return m}();
T5.Images=function(){function l(){if(!r){var v=T5.getConfig().maxImageLoads;r=COG.Loopage.join({execute:function(w,B){if(!v||h.length<v){var E=b.shift();if(E){h[h.length]=E;E.image.onload=m;E.image.src=T5.Resources.getPath(E.url);E.requested=T5.ticks()}else B.trigger("complete")}},frequency:10});r.bind("complete",function(){r=null})}}function o(){s=true;try{var v=k.length/2>>0;if(v>0){k.sort(function(B,E){return B.created-E.created});for(var w=v;w--;)delete d[k[w].url];k.splice(0,v)}}finally{s=false}COG.say("imagecache.cleared")}
function m(){var v=e[this.id],w;if(v&&v.image.complete&&v.image.width>0){v.loaded=true;v.hitCount=1;for(w=h.length;w--;)if(h[w].image.src==this.src){h.splice(w,1);break}if(v.background||v.postProcess||v.drawBackground||v.customDraw)if(v.image){globalImageData=v;w=a(v.realSize?v.realSize.width:v.image.width,v.realSize?v.realSize.height:v.image.height);var B=w.getContext("2d"),E=v.offset?v.offset:T5.XY.init();v.background&&B.drawImage(v.background,0,0);v.drawBackground&&v.drawBackground(B);v.customDraw?
v.customDraw(B,v):B.drawImage(v.image,E.x,E.y);v.postProcess&&v.postProcess(B,v);v.image=w}for(w=v.callbacks.length;w--;)v.callbacks[w]&&v.callbacks[w](this,false);v.callbacks=[];k[k.length]={url:this.src,created:v.requested};delete e[this.id];l()}}function f(v,w,B){var E=d[v];if(E){E.hitCount++;E.image.complete&&E.image.width>0&&w?w(E.image,true):E.callbacks.push(w)}else{E=T5.ex({url:v,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[w]},B);E.image.id="resourceLoaderImage"+
n++;d[v]=E;e[E.image.id]=E;b[b.length]=E;l()}return E}function a(v,w){var B=document.createElement("canvas");B.width=v?v:0;B.height=w?w:0;if(typeof FlashCanvas!=="undefined"){B.id="tmpCanvas"+g++;B.style.cssText="position: absolute; top: -"+(w-1)+"px; left: -"+(v-1)+"px;";document.body.appendChild(B);FlashCanvas.initElement(B)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(B);return B}var d={},g=0,e={},n=0,b=[],h=[],k=[],p=0,r=null,s=false,A={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){h=[]},get:function(v,w,B){var E=null,J=null;s||(E=d[v]);if((J=E?E.image:null)&&(J.getContext||J.complete&&J.width>0))return J;else w&&f(v,w,B);return null},load:f,newCanvas:a,reset:function(){d={}},stats:function(){return{imageLoadingCount:h.length,queuedImageCount:b.length,imageCacheFullness:p}}};COG.Loopage.join({execute:function(v){for(var w=false,B=0,E=T5.getConfig();B<h.length;)if(v-h[B].requested>A.loadTimeout*1E3){h.splice(B,1);w=true}else B++;w&&l();if(E&&E.imageCacheMaxSize){p=
k.length*A.avgImageSize/E.imageCacheMaxSize;p>=1&&o()}},frequency:2E4});return A}();T5.Generator=function(){var l={};return{init:function(o,m){var f=l[o];if(!f)throw Error("Unable to locate requested generator: "+o);return new f(m)},register:function(o,m){l[o]=m},Template:function(){}}}();
T5.TimeLord=function(){var l=/^P(\d+Y)?(\d+M)?(\d+D)?$/,o=/^(\d+H)?(\d+M)?(\d+S)?$/,m=function(a,d){return{days:a?a:0,seconds:d?d:0}},f={8601:function(a){a=a.split("T");var d=null;d=null;var g=0,e=0;l.lastIndex=-1;d=l.exec(a[0]);g+=d[3]?parseInt(d[3].slice(0,-1),10):0;o.lastIndex=-1;d=o.exec(a[1]);e+=d[1]?parseInt(d[1].slice(0,-1),10)*3600:0;e+=d[2]?parseInt(d[2].slice(0,-1),10)*60:0;e+=d[3]?parseInt(d[3].slice(0,-1),10):0;return new m(g,e)}};return{Duration:m,addDuration:function(){for(var a=new m,
d=arguments.length;d--;){a.days+=arguments[d].days;a.seconds+=arguments[d].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,d){var g=d?f[d]:null;if(g)return g(a);COG.Log.warn("Could not find duration parser for specified format: "+d);return new m},formatDuration:function(a){var d,g,e="";if(a.days)e=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){d=~~(a/3600);a-=d*3600}if(a>=60){g=Math.round(a/60);a-=g*60}if(d)e=e+d+(d>1?" hrs ":" hr ")+
(g?(g>10?g:"0"+g)+" min ":"");else if(g)e=e+g+" min";else if(a>0)e=e+(a>10?a:"0"+a)+" sec"}return e}}}();
T5.zoomable=function(l,o){function m(a,d){if(a&&f!==a){var g=l.triggerAll("zoomLevelChange",a,d);if(g)f=a;return g}}o=T5.ex({initial:1,min:0,max:null,zoomAnimation:T5.easing("quad.out")},o);var f=o.initial;T5.ex(l,{getZoomLevel:function(){return f},setZoomLevel:m,zoomIn:function(){l.scale(2,T5.easing("sine.out"))||l.setZoomLevel(f+1)},zoomOut:function(){l.scale(0.5,T5.easing("sine.out"))||l.setZoomLevel(f-1)}});l.bind("scale",function(a,d,g){var e=Math.log(d)/Math.LN2;T5.cancelAnimation(function(n){return n.cancelOnInteract});
a.cancel=!m(f+e,g);a.cancel||l.updateOffset(g.x*d,g.y*d)});l.bind("doubleTap",function(a,d,g){if(l.scalable()){T5.cancelAnimation(function(e){return e.cancelOnInteract});l.scale(2,T5.XY.init(g.x,g.y))}})};
(function(){var l=Math.PI*2,o=Math.PI/2,m=Math.abs,f=Math.pow,a=Math.sin,d=Math.asin,g=Math.cos,e=1.70158,n={linear:function(b,h,k,p){return k*b/p+h},backin:function(b,h,k,p){return k*(b/=p)*b*((e+1)*b-e)+h},backout:function(b,h,k,p){return k*((b=b/p-1)*b*((e+1)*b+e)+1)+h},backinout:function(b,h,k,p){return(b/=p/2)<1?k/2*b*b*(((e*=1.525)+1)*b-e)+h:k/2*((b-=2)*b*(((e*=1.525)+1)*b+e)+2)+h},bouncein:function(b,h,k,p){return k-n.bounceout(p-b,0,k,p)+h},bounceout:function(b,h,k,p){return(b/=p)<1/2.75?
k*7.5625*b*b+h:b<2/2.75?k*(7.5625*(b-=1.5/2.75)*b+0.75)+h:b<2.5/2.75?k*(7.5625*(b-=2.25/2.75)*b+0.9375)+h:k*(7.5625*(b-=2.625/2.75)*b+0.984375)+h},bounceinout:function(b,h,k,p){return b<p/2?n.bouncein(b*2,0,k,p)/2+h:n.bounceout(b*2-p,0,k,p)/2+k/2+h},cubicin:function(b,h,k,p){return k*(b/=p)*b*b+h},cubicout:function(b,h,k,p){return k*((b=b/p-1)*b*b+1)+h},cubicinout:function(b,h,k,p){if((b/=p/2)<1)return k/2*b*b*b+h;return k/2*((b-=2)*b*b+2)+h},elasticin:function(b,h,k,p,r,s){if(b==0)return h;if((b/=
p)==1)return h+k;s||(s=p*0.3);if(!r||r<m(k)){r=k;k=s/4}else k=s/l*d(k/r);return-(r*f(2,10*(b-=1))*a((b*p-k)*l/s))+h},elasticout:function(b,h,k,p,r,s){var A;if(b==0)return h;if((b/=p)==1)return h+k;s||(s=p*0.3);if(!r||r<m(k)){r=k;A=s/4}else A=s/l*d(k/r);return r*f(2,-10*b)*a((b*p-A)*l/s)+k+h},elasticinout:function(b,h,k,p,r,s){var A;if(b==0)return h;if((b/=p/2)==2)return h+k;s||(s=p*0.3*1.5);if(!r||r<m(k)){r=k;A=s/4}else A=s/l*d(k/r);if(b<1)return-0.5*r*f(2,10*(b-=1))*a((b*p-A)*l/s)+h;return r*f(2,
-10*(b-=1))*a((b*p-A)*l/s)*0.5+k+h},quadin:function(b,h,k,p){return k*(b/=p)*b+h},quadout:function(b,h,k,p){return-k*(b/=p)*(b-2)+h},quadinout:function(b,h,k,p){if((b/=p/2)<1)return k/2*b*b+h;return-k/2*(--b*(b-2)-1)+h},sinein:function(b,h,k,p){return-k*g(b/p*o)+k+h},sineout:function(b,h,k,p){return k*a(b/p*o)+h},sineinout:function(b,h,k,p){return-k/2*(g(Math.PI*b/p)-1)+h}};T5.easing=function(b){return n[b.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(b,h){n[b.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=h}})();
T5.Tween=function(l){l=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},l);var o=T5.ticks(),m=[],f=false,a=0,d=0,g={cancelOnInteract:l.cancelOnInteract,isComplete:function(){return f},triggerComplete:function(e){l.complete&&l.complete(e)},update:function(e){try{var n=l.tweenFn(e-o,a,d,l.duration);if(l.target)l.target[l.property]=n;for(var b=m.length;b--;)m[b](n,void 0);if(f=o+l.duration<=e){if(l.target)l.target[l.property]=
l.tweenFn(l.duration,a,d,l.duration);for(var h=m.length;h--;)m[h](n,true)}}catch(k){COG.Log.exception(k)}},requestUpdates:function(e){m.push(e)}};a=l.target&&l.property&&l.target[l.property]?l.target[l.property]:l.startValue;if(typeof l.endValue!=="undefined")d=l.endValue-a;if(d==0)f=true;T5.wakeTweens();return g};
(function(){function l(a){if(f)return o.length;f=true;try{for(var d=0;d<o.length;)if(o[d].isComplete()){o[d].triggerComplete(false);o.splice(d,1)}else{o[d].update(a);d++}}finally{f=false}o.length===0&&m.trigger("complete");return o.length}var o=[],m=null,f=false;T5.tweenValue=function(a,d,g,e,n){a=new T5.Tween({startValue:a,endValue:d,tweenFn:g,complete:e,duration:n});o.push(a);return a};T5.tween=function(a,d,g,e,n,b){a=new T5.Tween({target:a,property:d,endValue:g,tweenFn:e,duration:b,complete:n});
o.push(a);return a};T5.tweenVector=function(a,d,g,e,n,b){var h=[];if(a){var k=a.x==d,p=a.y==g;k||h.push(T5.tween(a,"x",d,e,function(){(k=true)&&p&&n()},b));p||h.push(T5.tween(a,"y",g,e,function(){p=true;k&&p&&n()},b))}return h};T5.cancelAnimation=function(a){if(!f){f=true;try{for(var d=0;d<o.length;)if(!a||a(o[d])){o[d].triggerComplete(true);o.splice(d,1)}else d++}finally{f=false}}};T5.isTweening=function(){return o.length>0};T5.wakeTweens=function(){if(!m){m=COG.Loopage.join({execute:l,frequency:20});
m.bind("complete",function(){m=null})}}})();(function(){var l={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var o=0,m=arguments.length;m--;){var f=l[arguments[m].toUpperCase()];if(f)o|=f}return o}})();
T5.ViewLayer=function(l){l=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},l);var o=null,m=false,f=false,a=l.supportFastDraw,d=l.id,g=T5.viewState("ACTIVE"),e=l.validStates,n=0,b=0,h=T5.ex({addToView:function(k){k.setLayer(d,h)},shouldDraw:function(k,p,r){return(f||r||n!==p.x1||b!==p.y1)&&(k&e)!==0&&(m?a:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){h.trigger("remove",
h)},changed:function(k){f=true;h.trigger("changed",h);o&&o.trigger("invalidate",k)},getId:function(){return d},setId:function(k){d=k},getParent:function(){return o},setParent:function(k){m=(o=k)?o.fastDraw&&displayState!==g:false;h.trigger("parentChange",o)}},l);COG.observable(h);h.bind("drawComplete",function(k,p){f=false;n=p.x1;b=p.y1});h.bind("resync",function(k,p){if(p.syncXY){h.minXY&&p.syncXY(h.minXY);h.maxXY&&p.syncXY(h.maxXY)}});return h};
T5.View=function(l){function o(t,x,I,N){X=ga;A();if(N&&l.inertia)n(O+x,U+I,l.panAnimationEasing,l.panAnimationDuration);else N||n(O+x,U+I)}function m(){X=na;M=false;COG.Loopage.join({execute:A,after:50,single:true})}function f(t,x,I){da||(da=[].concat(I));t=ra(da);ta(t);x=ja(t);var N=ra(I);I=ta(N);N=ja(N);g(I);R=t&&x!==0?N/x:1;d()}function a(t,x,I){C.zoom(T5.D.getCenter(y),I)}function d(t){p();var x=T5.XY.init(aa-(D.width/(R*2)>>0),la-(D.height/(R*2)>>0)),I=Math.log(R)/Math.LN2>>0;if(R!==1)X=ka;COG.Log.info("scale factor = "+
R+", exp = "+I);if(I!==0){R=Math.pow(2,I);if(!C.trigger("scale",R,x).cancel){COG.Log.info("ok to scale");for(t=B.length;t--;)B[t].trigger("scale",R,x);R=1;da=null;X=na;t=true}}A(t)}function g(t){F=T5.XY.init(O,U);K=T5.XY.offset(t,O,U)}function e(){clearTimeout(ea);ea=setTimeout(b,50)}function n(t,x,I,N,Q){function V(){$+=1;if($>=2){m(0,0);Q&&Q()}}var $=0,ha=Z?T5.XY.offset(Z,-u,-z):null,ia=S?T5.XY.offset(S,-u,-z):null;if(ha){t=t<ha.x?ha.x:t;x=x<ha.y?ha.y:x}if(ia){t=t>ia.x?ia.x:t;x=x>ia.y?ia.y:x}if(I){if(!M){t=
T5.tweenValue(O,t,I,V,N);x=T5.tweenValue(U,x,I,V,N);t.cancelOnInteract=true;t.requestUpdates(function(ua){O=ua>>0;M=true;A()});x.cancelOnInteract=true;x.requestUpdates(function(ua){U=ua>>0;M=true;A()})}}else{O=t>>0;U=x>>0}}function b(){var t;if(J){COG.Touch.release(J);if(l.autoSize&&J.parentNode){t=J.parentNode.getBoundingClientRect();if(t.height!==0&&t.width!==0){J.height=t.height;J.width=t.width}}try{if(!J.id)J.id=l.id+"_canvas";L=J.getContext("2d")}catch(x){COG.Log.exception(x);throw Error("Could not initialise canvas on specified view element");
}ma=COG.Touch.capture(J,{observable:C});if(y.height!==J.height||y.width!==J.width){y=T5.D.init(J.width,J.height);u=y.width/2>>0;z=y.height/2>>0;C.trigger("resize",J.width,J.height);for(t=E;t--;)B[t].trigger("resize",J.width,J.height)}l.inertia&&ma.inertiaEnable(l.panAnimationDuration,y);for(t=E;t--;)B[t].trigger("contextChanged",L);A()}}function h(t,x){x.setId(t);x.added=T5.ticks();x.bind("remove",function(){C.removeLayer(t)});x.trigger("contextChanged",L);x.setParent(C);B.push(x);B.sort(function(I,
N){var Q=N.zindex-I.zindex;if(Q===0)Q=N.added-I.added;return Q});E=B.length;return x}function k(){w("idle",C);P=true;Y=0}function p(t){var x=1/R;aa=K.x+(O-F.x);la=K.y+(U-F.y);if(t)return T5.XYRect.fromCenter(aa>>0,la>>0,t.width*x>>0,t.height*x>>0)}function r(t,x,I,N){var Q=T5.XYRect.copy(x),V,$=0;I&&L.clearRect(0,0,J.width,J.height);L.save();try{L.globalCompositeOperation="source-over";if(R!==1){Q=p(Q);L.scale(R,R)}L.translate(-Q.x1,-Q.y1);S=Z=null;L.beginPath();T=false;for($=E;$--;)if(B[$].clip){B[$].clip(L,
Q,t,C,I,N);T=true}L.closePath();T&&L.clip();for($=E;$--;){V=B[$];var ha=V.style,ia=ha?T5.Style.apply(L,ha):null;if(V.minXY)Z=Z?T5.XY.min(Z,V.minXY):T5.XY.copy(V.minXY);if(V.maxXY)S=S?T5.XY.max(S,V.maxXY):T5.XY.copy(V.maxXY);V.draw(L,Q,t,C,I,N);ia&&T5.Style.apply(L,ia)}}finally{L.restore()}if(H){L.globalCompositeOperation="source-over";L.strokeStyle="#f00";L.beginPath();L.moveTo(J.width/2,0);L.lineTo(J.width/2,J.height);L.moveTo(0,J.height/2);L.lineTo(J.width,J.height/2);L.stroke()}w("drawComplete",
x,N);COG.Log.trace("draw complete",N)}function s(t,x){var I=false,N=fa?fa:M?ga:X,Q=!M&&(N===ka||N===ga),V=qa||N===ga||N===ka||T5.isTweening();D=v();if(Q){T5.cancelAnimation(function($){return $.cancelOnInteract});P=false;if(Y!==0){clearTimeout(Y);Y=0}}for(Q=E;Q--;){if(B[Q].animated)X|=sa;B[Q].cycle(t,D,X,V);I=B[Q].shouldDraw(X,D,V)||I}V=V||(X&sa)!==0;if(I=I||V||R!==1&&R!==ca){r(N,D,V,t);ca=R;qa=false}if(!I&&q===0&&!pa){if(!P&&Y===0)Y=setTimeout(k,500);x.trigger("complete")}q=0;COG.Log.trace("Completed draw cycle",
t)}function A(t){qa=t?true:false;q+=1;if(!G){G=COG.Loopage.join({execute:s,frequency:oa});G.bind("complete",function(){G=null})}}function v(){return T5.XYRect.init(O,U,O+y.width,U+y.height)}function w(){for(var t=C.trigger.apply(null,arguments).cancel,x=B.length;x--;)t=B[x].trigger.apply(null,arguments).cancel||t;return!t}l=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,
adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},l);var B=[],E=0,J=document.getElementById(l.container),L=null,O=0,U=0,T=false,D=null,G=null,H=l.guides,W=1,y=T5.D.init(),q=0,u=0,z=0,F=null,K=null,P=false,M=false,Y=0,Z=null,S=null,ba=0,fa=null,qa=false,ea=0,da=null,R=1,ca=0,pa=typeof FlashCanvas!=="undefined",oa=~~(1E3/l.fps),ma=null,aa,la,na=T5.viewState("ACTIVE"),ga=T5.viewState("PAN"),ka=T5.viewState("ZOOM"),sa=T5.viewState("ANIMATING"),X=na,ra=T5.XY.getRect,ja=T5.XYRect.diagonalSize,
ta=T5.XYRect.center,C={id:l.id,deviceScaling:W,fastDraw:l.fastDraw||T5.getConfig().requireFastDraw,getDimensions:function(){return y},getLayer:function(t){for(var x=0;x<E;x++)if(B[x].getId()==t)return B[x];return null},setLayer:function(t,x){for(var I=0;I<E;I++)if(B[I].getId()===t){B.splice(I,1);break}x&&h(t,x);A();return x},eachLayer:function(t){for(var x=E;x--;)t(B[x])},invalidate:A,resize:function(t,x){if(J){l.autoSize=false;J.width=t;J.height=x;b();C.trigger("resize",J.width,J.height)}},scale:function(t,
x,I,N){function Q(){R=Math.pow(2,Math.round(Math.log(R)/Math.LN2));N&&N();d(true)}var V=R;x||(x=T5.D.getCenter(y));g(x);if(I)T5.tweenValue(0,t-V,I,Q,1E3).requestUpdates(function($){R=V+$;d()});else{R=t;Q()}return C},triggerAll:w,removeLayer:function(t){a:{for(var x=E;x--;)if(B[x].getId()==t){t=x;break a}t=-1}if(t>=0&&t<E){COG.say("layer.removed",{layer:B[t]});B.splice(t,1);A()}E=B.length},stateOverride:function(t){fa=t},getOffset:function(){return T5.XY.init(O,U)},getViewRect:v,updateOffset:n,pan:function(t,
x,I,N,Q){n(O+t,U+x,I,N,Q)},zoom:function(t,x){g(t);M=false;R=Math.max(R+Math.pow(2,x)-1,0.25);COG.Log.info("zooming, scale change = "+x+", targetXY = ",t);d()}};W=T5.getConfig().getScaling();C.markers=h("markers",new T5.MarkerLayer);COG.observable(C);C.bind("invalidate",function(t,x){A(x)});if(l.pannable){C.bind("pan",o);C.bind("panEnd",m);C.bind("inertiaCancel",function(){M=false;A()})}if(l.scalable){C.bind("pinchZoom",f);C.bind("wheelZoom",a)}C.bind("tap",function(t,x,I){for(var N=T5.XY.offset(I,
O,U),Q=B.length;Q--;)t.cancel=t.cancel||B[Q].trigger("tap",x,I,N).cancel});C.bind("resync",function(){S=Z=null});COG.configurable(C,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(l,null,{container:function(t,x){J=document.getElementById(x);b()},rotation:function(t,x){ba=x}}),true);b();l.autoSize&&window.addEventListener("resize",e,false);return C};
T5.PathLayer=function(l){l=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},l);var o=false,m=[],f=null,a=[],d=null,g=0,e=[],n=T5.ex(new T5.ViewLayer(l),{getAnimation:function(b,h,k,p){var r="pathAnimation"+g++;e.push(r);return new T5.AnimatedPathLayer({id:r,path:m,zindex:l.zindex+1,easing:b?b:T5.easing("sine.inout"),duration:h?h:5E3,drawIndicator:k,autoCenter:p?p:false})},cycle:function(b,h,k,p){return p},draw:function(b){var h,k=m.length;b.save();try{T5.Style.apply(b,l.style);if(k>0){b.beginPath();
b.moveTo(m[k-1].x,m[k-1].y);for(h=k;h--;)b.lineTo(m[h].x,m[h].y);b.stroke();if(f){b.fillStyle=l.waypointFillStyle;for(h=f.length;h--;){b.beginPath();b.arc(f[h].x,f[h].y,2,0,Math.PI*2,false);b.stroke();b.fill()}}}}finally{b.restore()}o=false},updateCoordinates:function(b,h){a=b;d=h;var k=n.getParent();if(k&&k.syncXY){k.syncXY(a);d&&k.syncXY(d);n.trigger("tidy")}}});n.bind("tidy",function(){m=T5.XY.simplify(a,l.pixelGeneralization);f=T5.XY.simplify(d,l.pixelGeneralization);o=true;n.changed()});return n};
T5.ShapeLayer=function(l){function o(d){for(var g=f.length;g--;)f[g].resync(d);f.sort(function(e,n){var b=n.xy.y-e.xy.y;if(b===0)b=n.xy.x-e.xy.y;return b});a.changed()}function m(d,g){g.syncXY&&o(g)}l=T5.ex({zindex:80},l);var f=[],a=T5.ex(new T5.ViewLayer(l),{add:function(d){f[f.length]=d},each:function(d){for(var g=f.length;g--;)d(f[g])},draw:function(d,g,e){var n=g.x1,b=g.y1,h=g.width;g=g.height;for(var k=f.length;k--;){var p=f[k].style;p=p?T5.Style.apply(d,p):null;f[k].draw(d,n,b,h,g,e);p&&T5.Style.apply(d,
p)}}});a.bind("parentChange",m);a.bind("resync",m);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(l){l=T5.ex({style:null,properties:{}},l);return T5.ex(l,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(l,o){o=T5.ex({size:4},o);var m=T5.XY.init(),f=T5.ex(o,{draw:function(a){a.beginPath();a.arc(m.x,m.y,f.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([l]);m=T5.XY.floor([l])[0]}});COG.Log.info("created arc = ",l);return f};
T5.Poly=function(l,o){o=T5.ex({fill:false,simplify:false},o);var m=false,f=o.fill,a=o.simplify,d=T5.viewState("ZOOM"),g=[],e=T5.ex(new T5.Shape(o),{draw:function(n,b,h,k,p,r){if(m){b=true;h=(r&d)!==0;n.beginPath();for(r=g.length;r--;){h=g[r].x;k=g[r].y;if(b){n.moveTo(h,k);b=false}else n.lineTo(h,k);h=true}if(h){f&&n.fill();n.stroke()}}},resync:function(n){e.xy=n.syncXY(l);g=T5.XY.floor(a?T5.XY.simplify(l):l)}});m=l&&l.length>=2;return e};
T5.AnimatedPathLayer=function(l){function o(e,n,b){e.fillStyle="#FFFFFF";e.strokeStyle="#222222";e.beginPath();e.arc(b.x,b.y,4,0,Math.PI*2,false);e.stroke();e.fill()}l=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},l);var m=T5.XY.edges(l.path),f,a=null,d=0;T5.tweenValue(0,m.total,l.easing,function(){g.remove()},l.duration).requestUpdates(function(e,n){d=e;n&&g.remove()});var g=T5.ex(new T5.ViewLayer(l),
{cycle:function(){for(var e=0;e<m.accrued.length&&m.accrued[e]<d;)e++;a=null;if(e<l.path.length-1){var n=d-(e>0?m.accrued[e-1]:0),b=l.path[e];f=T5.XY.theta(b,l.path[e+1],m.edges[e]);a=T5.XY.extendBy(b,f,n)}return a},draw:function(e,n){if(a)(l.drawIndicator?l.drawIndicator:o)(e,n,T5.XY.init(a.x,a.y),f)}});return g};
T5.Marker=function(l){function o(n,b,h,k){f=n;a=b;d=h;g=k}l=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},l);var m=false,f=0,a=0,d=0,g=0,e=T5.ex(l,{isAnimating:function(){return m},draw:function(n,b,h,k,p){if(e.isNew&&l.tweenIn){var r=e.xy.y;e.xy.y=b.y1-20;m=true;T5.tween(e.xy,"y",r,l.tweenIn,function(){e.xy.y=r>>0;m=false},l.animationSpeed?l.animationSpeed:250+Math.random()*500)}e.drawMarker(n,b,e.xy.x,e.xy.y,h,k,p);e.isNew=false},drawMarker:function(n,b,h,k){n.beginPath();
n.arc(h,k,4,0,Math.PI*2,false);n.fill();o(h-4,k-4,8,8)},hitTest:function(n,b){return n>=f&&n<=f+d&&b>=a&&b<=a+g},updateBounds:o});COG.observable(e);return e};
T5.ImageMarker=function(l){l=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},l);var o=l.imageAnchor?T5.XY.invert(l.imageAnchor):null,m=T5.ex(new T5.Marker(l),{drawMarker:function(f,a,d,g){if((a=m.isAnimating()&&m.animatingImage?m.animatingImage:m.image)&&a.width>0){o||(o=T5.XY.init(-a.width>>1,-a.height>>1));var e=m.scale,n=d+~~(o.x*e),b=g+~~(o.y*e),h=~~(a.width*e),k=~~(a.height*e);m.updateBounds(n,b,h,h);if(m.rotation||m.opacity!==
1){f.save();try{f.globalAlpha=m.opacity;f.translate(d,g);f.rotate(m.rotation);f.drawImage(a,o.x*e,o.y*e,h,k)}finally{f.restore()}}else f.drawImage(a,n,b,h,k)}}});if(!m.image)m.image=T5.Images.get(l.imageUrl,function(f){m.image=f});if(!m.animatingImage)m.animatingImage=T5.Images.get(l.animatingImageUrl,function(f){m.animatingImage=f});return m};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(l){function o(){a.changed();a.trigger("markerUpdate",f)}function m(){var d=a.getParent();if(d&&d.syncXY)for(var g=f.length;g--;)d.syncXY([f[g].xy])}l=T5.ex({zindex:100,style:"basic"},l);var f=[],a=T5.ex(new T5.ViewLayer(l),{draw:function(d,g,e,n){for(var b=f.length;b--;)f[b].draw(d,g,e,a,n)},add:function(d){if(d&&typeof d.length!=="undefined")for(var g=d.length;g--;){if(d[g])f[f.length]=d[g]}else if(d)f[f.length]=d;o()},clear:function(d){if(d)for(var g=0;g<f.length;g++)d(f[g])&&
f.splice(g,1);else f=[];o()},each:function(d){if(d)for(var g=f.length;g--;)d(f[g])},find:function(d){for(var g=[],e=f.length;e--;)if(!d||d(f[e]))g[g.length]=f[e];return g}});a.bind("tap",function(d,g,e){for(var n=[],b=e.x,h=e.y,k=f.length;k--;)if(f[k].hitTest(b,h))n[n.length]=f[k];if(n.length>0)d.cancel=a.trigger("markerTap",g,e,n).cancel});a.bind("parentChange",m);a.bind("resync",m);a.bind("changed",m);return a};
T5.ImageLayer=function(l,o){function m(b,h,k){for(h=d.length;h--;){var p=d[h],r=p.x,s=p.y,A=T5.XYRect.init(p.x,p.y,p.x+p.width,p.y+p.height);if(k&&T5.XYRect.intersect(b,A)){A=T5.Images.get(p.url,function(){n.changed()},e);k(A,r,s,p.width,p.height)}}}function f(b){a&&a.run(b,function(h){d=[].concat(h);n.changed()})}o=T5.ex({imageLoadArgs:{}},o);var a=l?T5.Generator.init(l,o):null,d=[],g=T5.XYRect.init(),e=o.imageLoadArgs,n=T5.ex(new T5.ViewLayer(o),{changeGenerator:function(b,h){a=T5.Generator.init(b,
T5.ex({},o,h));a.bindToView(n.getParent());d=null;f(g)},clip:function(b,h,k){m(h,k,function(p,r,s,A,v){p&&b.rect(r,s,A,v)})},cycle:function(b,h){f(h)},draw:function(b,h,k){m(h,k,function(p,r,s,A,v){n.drawImage(b,p,r,s,A,v,h,k)});g=T5.XYRect.copy(h)},drawImage:function(b,h,k,p){h&&b.drawImage(h,k,p,h.width,h.height)}});n.bind("idle",function(){f(g)});n.bind("parentChange",function(b,h){a&&a.bindToView(h)});n.bind("tap",function(b,h,k,p){b=[];var r=p.x,s=p.y,A,v;if(d)for(var w=d.length;w--;){A=d[w];
if(v=r>=A.x&&r<=A.x+A.width&&s>=A.y&&s<=A.y+A.height)b[b.length]=A}b.length>0&&n.trigger("tapImage",b,h,k,p)});return n};
T5.Style=function(){function l(g,e){a[g]=m(e);return g}function o(g){for(var e in g)l(e,g[e])}function m(g){function e(k){var p=g[k];typeof p!=="undefined"&&b.push(function(r){r[k]=p})}function n(){b=[];for(var k in g)e(k)}g=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var b=[],h={applyToContext:function(k){for(var p=b.length;p--;)b[p](k)},update:function(k,
p){g[k]=p;n()}};n();return h}var f={},a={},d={apply:function(g,e){var n=a[e]?a[e]:a.basic,b;if(g&&g.canvas){b=f[g.canvas.id];f[g.canvas.id]=e}n.applyToContext(g);return b},define:l,defineMany:o,get:function(g){return a[g]},init:m,load:function(g){COG.jsonp(g,function(e){T5.resetStyles(e)})}};o({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return d}();
T5.Tiling=function(){return{tileSize:256,init:function(l,o,m,f,a){return T5.ex({x:l,y:o,width:m,height:f},a)}}}();
T5.TileGenerator=function(l){function o(s,A,v,w){function B(){if(r.initTileCreator){e=true;r.initTileCreator(s,A,v,w)}}r.prepTileCreator?r.prepTileCreator(s,A,v,B):B()}function m(s,A){for(var v=~~((s.x1-d.x)/n),w=~~((s.y1-d.y)/b),B=[],E=-g;E<k;E++)for(var J=-g;J<p;J++){var L=h(v+E,w+J);if(L)B[B.length]=L}A&&A(B);a=T5.XYRect.copy(s)}l=T5.ex({tileWidth:256,tileHeight:256,relative:false,padding:2},l);var f=null,a=null,d=T5.XY.init(),g=l.padding,e=false,n=l.tileWidth,b=l.tileHeight,h=null,k=0,p=0,r={bindToView:function(s){COG.Log.info("initializing generator");
f=s;r.trigger("bindView",s)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){h=null;e=false;a=null},run:function(s,A){if(!a||Math.abs(s.x1-a.x1)>n||Math.abs(s.y1-a.y1)>b){if(!h&&!e||r.requireRefresh()){d=l.relative?T5.XY.init(s.x1,s.y1):T5.XY.init();k=Math.ceil(s.width/n)+g;p=Math.ceil(s.height/b)+g;o(n,b,r.getTileCreatorArgs?r.getTileCreatorArgs(f):{},function(v){h=v;e=false;m(s,A)})}h&&m(s,A)}}};COG.observable(r);r.bind("update",
function(){COG.Log.info("captured generator update");a=null});return r};
T5.Geo=function(){function l(y){for(var q=null,u=1;!q&&u<arguments.length;u++)q=d(y,arguments[u]);q=q?q:d(y);if(!q)throw Error("Unable to find GEO engine with "+y+" capability");return q}function o(y){y=parseFloat(y)*r;y=Math.sin(y);var q=A*y;return Math.log((1+y)/(1-y)*Math.pow((1-q)/(1+q),A))/2}function m(y){return parseFloat(y)*r}function f(y){y=Math.pow(Math.E,-y);for(var q=n-2*Math.atan(y),u=g(q,y),z=0;z<w&&Math.abs(q-u)>v;){q=u;u=g(q,y);z++}return u*s}function a(y){return y%360*s}function d(y,
q){var u=null;for(var z in H)if(q){if(z==q&&H[z][y]){u=H[z];break}}else if(H[z][y]){u=H[z];break}return u}function g(y,q){var u=A*Math.sin(y);return n-2*Math.atan(q*Math.pow((1-u)/(1+u),A/2))}var e=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],n=Math.PI/2,b=Math.PI*2,h=-n,k=n,p=-b,r=Math.PI/180,s=180/Math.PI,A=0.08181919084262157,v=1.0E-7,w=12,B=null,E={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},
J={VECTORIZE_PER_CYCLE:500},L=function(y,q){return{lat:parseFloat(y?y:0),lon:parseFloat(q?q:0)}},O=function(y,q){return{min:T.parse(y),max:T.parse(q)}},U=function(y){return y=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},y)},T=function(){var y={calcDistance:function(q,u){if(y.empty(q)||y.empty(u))return 0;var z=(u.lat-q.lat)*r/2,F=(u.lon-q.lon)*r/2;z=Math.sin(z)*Math.sin(z)+Math.cos(q.lat*r)*Math.cos(u.lat*r)*Math.sin(F)*Math.sin(F);return 6371*2*Math.atan2(Math.sqrt(z),
Math.sqrt(1-z))},copy:function(q){return q?new L(q.lat,q.lon):null},empty:function(q){return!q||q.lat===0&&q.lon===0},equal:function(q,u){return q&&u&&q.lat==u.lat&&q.lon==u.lon},inArray:function(q,u){for(var z=T.equal,F=u.length;F--;)if(z(q,u[F]))return true;return false},inBounds:function(q,u){var z=!(T.empty(q)||T.empty(u));return z=(z=z&&q.lat>=u.min.lat&&q.lat<=u.max.lat)&&q.lon>=u.min.lon&&q.lon<=u.max.lon},offset:function(q,u,z){var F=q.lat*r;u=F+u/6371;for(q=q.lon*r+Math.asin(Math.sin(z/6371)/
Math.cos(F));u<h;)u+=Math.PI;for(;u>k;)u-=Math.PI;for(;q>b;)q-=2*Math.PI;return new L(u*s,q*s)},parse:function(q){if(q)if(typeof q.lat!=="undefined")return y.copy(q);else{if(q.split)for(var u=[" ",","],z=0;z<u.length;z++){var F=q.split(u[z]);if(F.length===2)return new L(F[0],F[1])}}else return new L;return null},parseArray:function(q){var u=q.length,z=Array(u);for(u=u;u--;)z[u]=y.parse(q[u]);return z},fromMercatorPixels:function(q,u){return new L(f(u),a(q))},toMercatorPixels:function(q){return T5.XY.init(m(q.lon),
o(q.lat))},generalize:function(q,u,z){var F=q.length,K=[],P=null;z||(z=250);z/=1E3;COG.Log.info("generalizing positions, must include "+u.length+" positions");for(var M=F;M--;)if(M===0)K.unshift(q[M]);else{var Y=!P||T.inArray(q[M],u)?z:T.calcDistance(P,q[M]);if(q[M]&&Y>=z){K.unshift(q[M]);P=q[M]}}COG.Log.info("generalized "+F+" positions into "+K.length+" positions");return K},vectorize:function(q,u){var z=q.length,F=Array(z);u=T5.ex({chunkSize:J.VECTORIZE_PER_CYCLE,async:true},u);if(!u.async){for(var K=
z;K--;)F[K]=T5.GeoXY.init(q[K]);return F}return COG.Loopage.join({frequency:10,execute:function(P,M){for(var Y=0,Z=u.chunkSize,S=z;S--;){F[S]=T5.GeoXY.init(q[S]);Y+=1;if(Y>Z)break}z=S;z<=0&&M.trigger("complete",F)}})},toString:function(q){return q?q.lat+" "+q.lon:""}};return y}(),D=function(){var y={calcSize:function(q,u,z){var F=T5.XY.init(0,u.lat-q.lat);if(typeof z==="undefined")z=true;F.x=z&&q.lon>u.lon?360-q.lon+u.lon:u.lon-q.lon;return F},createBoundsFromCenter:function(q,u){var z=u/6371,F=q.lat*
r,K=q.lon*r,P=F-z,M=F+z;if(P>h&&M<k){F=Math.asin(Math.sin(z)/Math.cos(F));z=K-F;if(z<p)z+=2*Math.PI;K=K+F;if(K>b)K-=2*Math.PI}else{P=Math.max(P,h);M=Math.min(M,k);z=p;K=b}return new O(new L(P*s,z*s),new L(M*s,K*s))},expand:function(q,u){return new O(new L(q.min.lat-u,q.min.lon-u%360),new L(q.max.lat+u,q.max.lon+u%360))},forPositions:function(q,u){var z=null,F=T5.ticks();u||(u="auto");for(var K=q.length;K--;)if(z){var P=y.calcSize(z.min,q[K],false),M=y.calcSize(q[K],z.max,false);if(P.x<0)z.min.lon=
q[K].lon;if(P.y<0)z.min.lat=q[K].lat;if(M.x<0)z.max.lon=q[K].lon;if(M.y<0)z.max.lat=q[K].lat}else z=new T5.Geo.BoundingBox(q[K],q[K]);if(u){if(u=="auto"){K=y.calcSize(z.min,z.max);u=Math.max(K.x,K.y)*0.3}z=y.expand(z,u)}COG.Log.trace("calculated bounds for "+q.length+" positions",F);return z},getCenter:function(q){var u=D.calcSize(q.min,q.max);return new T5.Geo.Position(q.min.lat+u.y/2,q.min.lon+u.x/2)},getGeoHash:function(q){var u=T5.Geo.GeoHash.encode(q.min.lat,q.min.lon);q=T5.Geo.GeoHash.encode(q.max.lat,
q.max.lon);COG.Log.info("min hash = "+u+", max hash = "+q)},getZoomLevel:function(q,u){var z=y.getCenter(q),F=e[Math.min(Math.round(Math.abs(z.lat)*0.05),e.length)],K=y.calcSize(q.min,q.max);z=Math.ceil(Math.log(e[3]*u.height/K.y)/Math.log(2));F=Math.ceil(Math.log(F*u.width/K.x)/Math.log(2));return Math.min(isNaN(z)?1E3:z,isNaN(F)?1E3:F)},isEmpty:function(q){return!q||T.empty(q.min)||T.empty(q.max)},toString:function(q){return"min: "+T.toString(q.min)+", max: "+T.toString(q.max)}};return y}(),G=function(){var y=
/^(\d+).*$/,q=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(u,z){y.lastIndex=-1;if(y.test(u))for(var F=u.replace(y,"$1"),K=z.split(","),P=0;P<K.length;P++){q.lastIndex=-1;if(q.test(K[P])){var M=q.exec(K[P]);if(F>=parseInt(M[1],10)&&F<=parseInt(M[2],10))return true}else if(F==K[P])return true}return false},normalize:function(u){if(!u)return"";u=u.toUpperCase();if(!B){var z=[];for(var F in E)z.push(F);B=RegExp("(\\s)("+z.join("|")+")(\\s|$)","i")}B.lastIndex=-1;if(z=B.exec(u))u=u.replace(B,"$1"+
E[z[2]]);return u},toString:function(u){return u.streetDetails+" "+u.location}}}(),H={},W={P:T,B:D,A:G,Radius:function(y,q){return{distance:parseInt(y,10),uom:q}},Position:L,BoundingBox:O,Address:U,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(y){if(!y.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var q=T5.ex({remove:function(){delete H[q.id]}},y);return H[q.id]=q},GeoSearchResult:function(y){y=T5.ex({id:null,caption:"",resultType:"",
data:null,pos:null,matchWeight:0},y);return T5.ex(y,{toString:function(){return y.caption+(y.matchWeight?" ("+y.matchWeight+")":"")}})},GeoSearchAgent:function(y){return new T5.Dispatcher.Agent(y)},GeocodingAgent:function(y){y=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(q,u){try{if(!q.reverse&&!q.freeform)address=new U(q);var z=l("geocode");if(z)z.geocode({addresses:[q.freeform?q.freeform:address],complete:function(K,P){if(u){var M=P;if(q.freeform)M=W.rankGeocodeResponses(q.freeform,
M,l("geocode"));u(M,y)}}})}catch(F){COG.Log.exception(F)}}},y);return new W.GeoSearchAgent(y)}};T5.GeoXY=function(){function y(u,z){if(u.length){for(var F,K,P,M,Y=u.length;Y--;){y(u[Y],z);F=typeof F==="undefined"||u.x<F?u.x:F;K=typeof K==="undefined"||u.y<K?u.y:K;P=typeof P==="undefined"||u.x>P?u.x:P;M=typeof M==="undefined"||u.y>M?u.y:M}return T5.XYRect.init(F,K,M,M)}else if(u.mercXY){F=u.mercXY;u.x=~~(F.x/z);u.y=~~((Math.PI-F.y)/z);u.rpp=z}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");
return u}function q(u,z,F){u.pos=z;u.mercXY=T.toMercatorPixels(z);(F=typeof F!=="undefined"?F:u.rpp)&&y(u,F)}return{init:function(u,z){var F=T5.XY.init();q(F,u,z);return F},sync:y,toPos:function(u,z){z=z?z:self.rpp;return T.fromMercatorPixels(u.x*z,Math.PI-u.y*z)},updatePos:q}}();W.GeoVector=function(y){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return T5.GeoXY.init(y)};return T5.ex(W,J,{distanceToString:function(y){if(y>1E3)return~~(y/10)/100+
" km";return y?y+" m":""},dist2rad:function(y){return y/6371},getEngine:l,lat2pix:o,lon2pix:m,pix2lat:f,pix2lon:a,radsPerPixel:function(y){return 2*Math.PI/(256<<y)}})}();
T5.Geo.GeoHash=function(){function l(o,m,f){if(m&f)o[0]=(o[0]+o[1])/2;else o[1]=(o[0]+o[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(o){var m=1,f=[],a=[];f[0]=-90;f[1]=90;a[0]=-180;a[1]=180;lat_err=90;lon_err=180;for(i=0;i<o.length;i++){c=o[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(m){lon_err/=2;l(a,cd,mask)}else{lat_err/=2;l(f,cd,mask)}m=!m}}f[2]=(f[0]+
f[1])/2;a[2]=(a[0]+a[1])/2;return{latitude:f,longitude:a}},encode:function(o,m,f){var a=1,d=[],g=[],e=0,n=0;f=f?f:12;geohash="";d[0]=-90;d[1]=90;g[0]=-180;for(g[1]=180;geohash.length<f;){if(a){mid=(g[0]+g[1])/2;if(m>mid){n|=BITS[e];g[0]=mid}else g[1]=mid}else{mid=(d[0]+d[1])/2;if(o>mid){n|=BITS[e];d[0]=mid}else d[1]=mid}a=!a;if(e<4)e++;else{geohash+=BASE32[n];n=e=0}}return geohash}}}();
T5.GeoJSON=function(){function l(h,k,p,r){k=m(k);h.add(r.line(k,p));return k.length}function o(h,k,p,r){k=m(k);h.add(r.poly(k,p));return k.length}function m(h){var k=h?h.length:0,p=Array(k);for(k=k;k--;)p[k]=new T5.Geo.Position(h[k][1],h[k][0]);return T5.Geo.P.vectorize(p,g)}function f(h,k,p){return new b(h,k,p)}var a="featurecollection",d="feature",g={async:false},e={processor:null,group:"shapes",layerClass:T5.ShapeLayer},n={point:T5.ex({},e,{processor:function(h,k,p,r){k=m([k.coordinates],g);if(k.length>
0)if(p=r.marker(k[0],p)){h.add(p);return k.length}},group:"markers",layerClass:T5.MarkerLayer}),linestring:T5.ex({},e,{processor:function(h,k,p,r){k=m(k&&k.coordinates?k.coordinates:[]);return l(h,k,p,r)}}),multilinestring:T5.ex({},e,{processor:function(h,k,p,r){k=k&&k.coordinates?k.coordinates:[];for(var s=0,A=k.length;A--;)s+=l(h,k[A],p,r);return s}}),polygon:T5.ex({},e,{processor:function(h,k,p,r){k=k&&k.coordinates?k.coordinates:[];if(k.length>0)return o(h,k[0],p,r);return 0}}),multipolygon:T5.ex({},
e,{processor:function(h,k,p,r){k=k&&k.coordinates?k.coordinates:[];for(var s=0,A=0;A<k.length;A++)s+=o(h,k[A][0],p,r);return s}})},b=function(h,k,p,r){function s(D,G){var H=D.processor,W=B+D.group,y=T5.ex({},D,p,{properties:G.properties});if(H){var q=U[W];if(!q){q=new D.layerClass({id:W});U[W]=q}globalLayers=U;return H(q,G.data,y,r)}return 0}function A(D,G){var H=D&&D.type?D.type.toLowerCase():null;return H&&H===d?A(D.geometry,D.properties):{type:H,isCollection:H?H===a:false,definition:n[H],data:D,
properties:G?G:D.properties}}p=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},p);r=T5.ex({marker:function(D){return new T5.Marker({xy:D})},line:function(D,G){return new T5.Poly(D,G)},poly:function(D,G){return new T5.Poly(D,T5.ex({fill:true},G))}},r);var v=p.vectorsPerCycle,w=p.rowPreParse,B=p.layerPrefix,E=0,J=0,L=null,O=0,U={},T;if(!h)return null;if(typeof h.length==="undefined")h=[h];J=h.length;T=COG.Loopage.join({frequency:10,execute:function(D,
G){var H=0,W=E;if(!L){for(;W<J;W++){var y=A(w?w(h[W]):h[W]),q=null;if(y.isCollection){O+=1;L=f(y.data.features,function(u){L=null;for(var z in u)U[z]=u[z]},{layerPrefix:B+O+"-"});q+=1}else if(y.definition)q=s(y.definition,y);H+=q?q:1;if(H>=v)break}E=W+1;!L&&E>=J&&G.trigger("complete")}}});T.bind("complete",function(){k&&k(U)});return T};return{parse:f}}();T5.Geo.JSON=T5.GeoJSON;
T5.Geo.LocationSearch=function(l){function o(g,e){navigator.geolocation.clearWatch(f);f=0;if(a){clearTimeout(a);a=0}e&&e([g],l)}function m(g){COG.Log.info("caught location tracking error:",g)}l=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},l);var f=0,a=0,d=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(g,e){if(navigator.geolocation&&!f){f=navigator.geolocation.watchPosition(function(n){var b=new T5.Geo.Position(n.coords.latitude,n.coords.longitude);
n=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:b,accuracy:n.coords.accuracy/1E3,matchWeight:100});if(!d||n.accuracy<d.accuracy)d=n;if(!l.requiredAccuracy||d.accuracy<l.requiredAccuracy)o(d,e)},m,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(l.searchTimeout)a=setTimeout(function(){d&&o(d,e)},l.searchTimeout)}}},l))};
T5.Map=function(l){function o(s){try{var A=new T5.Geo.Position(s.coords.latitude,s.coords.longitude),v=s.coords.accuracy/1E3;r.trigger("locationUpdate",s,v);if(k){if(!b){b=new T5.Geo.UI.LocationOverlay({pos:A,accuracy:v});b.update(r.getTileLayer());r.setLayer("location",b)}var w=T5.Geo.B.createBoundsFromCenter(A,Math.max(v,1));r.gotoBounds(w)}else{b.pos=A;b.accuracy=v;b.update(r.getTileLayer());a(A,null,T5.easing("sine.out"))}k=false}catch(B){COG.Log.exception(B)}}function m(s){COG.Log.info("caught location tracking error:",
s)}function f(s,A,v){r.setZoomLevel(A);T5.Images.cancelLoad();T5.cancelAnimation();a(s,v)}function a(s,A,v,w){s=T5.GeoXY.init(s,T5.Geo.radsPerPixel(r.getZoomLevel()));var B=r.getDimensions();r.updateOffset(s.x-B.width/2,s.y-B.height/2,v,w,A);r.trigger("wake");r.trigger("boundsChange",r.getBoundingBox());A&&typeof v==="undefined"&&A(r)}l=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},l);var d={NONE:0,SINGLE:1,WATCH:2},g=T5.XY.init(),e=d.NONE,n=false,b=null,
h=0,k=true,p=0;if(!l.provider)l.provider=new T5.Geo.MapProvider;l.adjustScaleFactor=function(s){return Math.pow(2,(s<1?Math.floor:Math.ceil)(Math.log(s)))};var r=T5.ex(new T5.View(l),{getBoundingBox:function(){var s=r.getViewRect();return new T5.Geo.BoundingBox(T5.GeoXY.toPos(T5.XY.init(s.x1,s.y2),p),T5.GeoXY.toPos(T5.XY.init(s.x2,s.y1),p))},getCenterPosition:function(){var s=r.getViewRect();if(s){s=T5.XY.init(s.x1+s.width/2,s.y1+s.height/2);return T5.GeoXY.toPos(s,p)}return null},gotoBounds:function(s,
A){var v=T5.Geo.B.getZoomLevel(s,r.getDimensions());f(T5.Geo.B.getCenter(s),v,A)},gotoPosition:f,panToPosition:a,syncXY:function(s){return T5.GeoXY.sync(s,p)},locate:function(){r.trackStart(d.SINGLE);setTimeout(r.trackCancel,1E4)},trackStart:function(s){if(navigator.geolocation&&!h){e=s?s:d.WATCH;k=true;h=navigator.geolocation.watchPosition(o,m,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){h&&navigator.geolocation&&navigator.geolocation.clearWatch(h);r.removeLayer("location");
b=null;e=d.NONE;h=0},animateRoute:function(s,A,v,w){var B=r.getLayer("route");if(B)(s=B.getAnimation(s,A,v,w))&&s.addToView(r)}});r.bind("pan",function(){e===d.SINGLE&&r.trackCancel()});r.bind("tap",function(){});r.bind("idle",function(){if(T5.XY.absSize(T5.XY.diff(g,r.getOffset()))>l.boundsChangeThreshold){g=T5.XY.copy(r.getOffset());r.trigger("boundsChange",r.getBoundingBox())}});T5.zoomable(r,l);r.bind("zoomLevelChange",function(s,A){p=T5.Geo.radsPerPixel(A);r.triggerAll("resync",r)});COG.configurable(r,
["provider"],COG.paramTweaker(l,null,{provider:function(){r.cleanup();n=false}}),true);return r};
T5.Geo.MapProvider=function(){var l=1,o=20;return{zoomLevel:0,checkZoomLevel:function(m){return Math.min(Math.max(m,l),o)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:l,max:o}},prepTileGridArgs:function(m,f,a,d,g){var e=null;if(g.tileBackgroundColor){e=T5.Images.newCanvas(a,a);var n=e.getContext("2d");n.fillStyle=g.tileBackgroundColor;n.fillRect(0,0,a,a)}return T5.ex({tileSize:a,width:m,height:f,center:d,tileDrawArgs:{background:e}},
g)},setZoomRange:function(m,f){l=m;o=f}}};
T5.MapTileGenerator=function(l){function o(d,g){var e=g>=a.minLevel&&(!a.maxLevel||g<=a.maxLevel);COG.Log.info("new zoom level = "+g+", zoom ok = "+e);d.cancel=!e;if(e){m=g;a.reset()}}l=T5.ex({relative:true},l);var m=0,f=null,a=T5.ex(new T5.TileGenerator(l),{minLevel:3,maxLevel:20,getTileCreatorArgs:function(d){f=d.getCenterPosition();return{zoomLevel:m,position:f}},requireRefresh:function(){return!f}});a.bind("bindView",function(d,g){if(g.getZoomLevel){m=g.getZoomLevel();g.bind("zoomLevelChange",
o)}});return a};
T5.Geo.Routing=function(){var l={calculate:function(o){o=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},o);var m=T5.Geo.getEngine("route");m&&m.route(o,function(f){if(o.generalize)f.geometry=T5.Geo.P.generalize(f.geometry,f.getInstructionPositions());if(o.map){l.createMapOverlay(o.map,f);o.autoFit&&o.map.gotoBounds(f.boundingBox)}o.success&&o.success(f)})},createMapOverlay:function(o,m){var f=o.getDimensions();f=new T5.Geo.UI.RouteOverlay({data:m,width:f.width,
height:f.height});o.setLayer("route",f)},parseTurnType:function(o){for(var m=l.TurnType.Unknown,f=T5.Geo.Routing.TurnTypeRules,a=0;a<f.length;a++){f[a].regex.lastIndex=-1;var d=f[a].regex.exec(o);if(d){m=f[a].customCheck?f[a].customCheck(o,d):f[a].turnType;break}}return m},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(o){var m=o=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},o),f=o.description;f=f.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");m.description=f;if(!o.turnType)o.turnType=l.parseTurnType(o.description);return o},RouteData:function(o){o=T5.ex({geometry:[],instructions:[],boundingBox:null},
o);if(!o.boundingBox)o.boundingBox=T5.Geo.B.forPositions(o.geometry);return T5.ex({getInstructionPositions:function(){for(var m=[],f=0;f<o.instructions.length;f++)o.instructions[f].position&&m.push(o.instructions[f].position);return m}},o)}};return l}();T5.Geo.Search=function(){return{bestResults:function(l,o){o||(o=20);for(var m=l.length>0?l[0]:null,f=[],a=0;a<l.length;a++)if(m&&l[a]&&m.matchWeight-l[a].matchWeight<=o)f.push(l[a]);else break;return f}}}();
T5.Geo.UI=function(){var l={AnnotationTween:null,RouteOverlay:function(o){o=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},o);var m=[],f=[],a=new T5.PathLayer(o);(function(){if(o.data&&o.data.instructions){for(var d=o.data.instructions,g=Array(d.length),e=d.length;e--;)g[e]=d[e].position;T5.Geo.P.vectorize(g).bind("complete",function(n,b){f=b})}o.data&&o.data.geometry&&T5.Geo.P.vectorize(o.data.geometry).bind("complete",
function(n,b){m=b;a.updateCoordinates(m,f,true)})})();return a},Poly:function(o,m){m=T5.ex({autoParse:true},m);for(var f=Array(o.length),a=m.autoParse,d=T5.Geo.P.parse,g=o.length;g--;)f[g]=T5.GeoXY.init(a?d(o[g]):o[g]);return new T5.Poly(f,m)},Annotation:function(o){o=T5.ex({pos:null},o);o.xy=T5.GeoXY.init(o.pos);return new T5.ImageAnnotation(o)},LocationOverlay:function(o){o=T5.ex({pos:null,accuracy:null,zindex:90},o);var m=new Image,f=T5.XY.init(),a=T5.XY.init(),d=null;m.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
m.onload=function(){f=T5.XY.init(m.width/2,m.height/2)};var g=T5.ex(new T5.ViewLayer(o),{pos:o.pos,accuracy:o.accuracy,drawAccuracyIndicator:false,draw:function(e,n){var b=a.x-n.x,h=a.y-n.y;if(d){e.fillStyle="rgba(30, 30, 30, 0.2)";e.beginPath();e.arc(b,h,d,0,Math.PI*2,false);e.fill()}m.complete&&m.width>0&&e.drawImage(m,b-f.x,h-f.y,m.width,m.height);g.changed()},update:function(e){if(e){d=Math.floor(e.getPixelDistance(g.accuracy)*0.5);a=e.getGridXYForPosition(g.pos);g.changed()}}});g.bind("gridUpdate",
function(e,n){g.update(n)});return g},AnnotationsOverlay:function(o){function m(e,n){var b=e.length,h=g.getParent();if(n=n?n:h?h.getTileLayer():null)for(b=b;b--;)n.syncVectors([e[b].xy]);e.sort(function(k,p){var r=p.xy.y-k.xy.y;if(r===0)r=p.xy.x-k.xy.x;return r})}o=T5.ex({pois:null,map:null,zindex:100},o);var f=[],a=false,d=[],g=T5.ex(new T5.ViewLayer(o),{cycle:function(){return a},draw:function(e,n,b,h,k){a=false;e.fillStyle="rgba(255, 0, 0, 0.75)";e.globalCompositeOperation="source-over";for(b=
f.length;b--;){f[b].draw(e,n,h,g,k);a=a||f[b].isAnimating()}for(b=d.length;b--;){d[b].draw(e,n,h,g,k);a=a||d[b].isAnimating()}return a?1:0},add:function(e){if(e&&e.length)for(var n=e.length;n--;)d[d.length]=e[n];else if(e)d[d.length]=e;m(d);g.changed()},clear:function(e){d=[];m(d);if(e){f=[];m(f)}g.changed()}});COG.listen("geo.pois-updated",function(e){if(o.pois&&o.pois.id==e.srcID){e=e.pois;try{f=[];for(var n=0;n<e.length;n++)if(e[n].pos){var b;var h=e[n];if(h&&h.pos){var k={poi:h,annotation:null};
o.map&&o.map.trigger("getAnnotationForPOI",k);if(!k.annotation)k.annotation=new T5.Annotation({xy:T5.GeoXY.init(h.pos)});if(k.annotation){k.annotation.isNew=h.isNew;h.isNew=false}b=k.annotation}else b=void 0;b&&f.push(b)}m(f)}catch(p){COG.Log.exception(p)}g.changed()}});g.bind("gridUpdate",function(e,n){m(f,n);m(d,n);g.changed()});return g}};l.ImageAnnotation=l.Annotation;return l}();
T5.Geo.Routing.TurnTypeRules=function(){var l=T5.Geo.Routing.TurnType,o=[];o.push({regex:/continue/i,turnType:l.Continue});o.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(m,f){return/bear/i.test(f[1])?l.TurnLeftSlight:l.TurnLeft}});o.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(m,f){return/bear/i.test(f[1])?l.TurnRightSlight:l.TurnRight}});o.push({regex:/enter\s(roundabout|rotaty)/i,turnType:l.EnterRoundabout});o.push({regex:/take.*?ramp/i,turnType:l.Ramp});o.push({regex:/take.*?exit/i,
turnType:l.RampExit});o.push({regex:/make(.*?)u\-turn/i,customCheck:function(m,f){return/right/i.test(f[1])?l.UTurnRight:l.UTurnLeft}});o.push({regex:/proceed/i,turnType:l.Start});o.push({regex:/arrive/i,turnType:l.Arrive});o.push({regex:/fell\sthrough/i,turnType:l.Merge});return o}();
