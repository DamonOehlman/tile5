COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var X=arguments[0]||{},oa,K=1,G=arguments.length;K<G;K++)if((oa=arguments[K])!==null)for(var q in oa){var p=oa[q];if(X!==p)if(p!==undefined)X[q]=p}return X};
(function(){var X=Object.prototype.hasOwnProperty,oa=0,K={};K.toID=function(G){return G.replace(/\s/g,"-")};K.objId=function(G){return(G?G:"obj")+oa++};K.isFunction=function(G){return toString.call(G)==="[object Function]"};K.isArray=function(G){return toString.call(G)==="[object Array]"};K.isPlainObject=function(G){if(!G||toString.call(G)!=="[object Object]"||G.nodeType||G.setInterval)return false;if(G.constructor&&!X.call(G,"constructor")&&!X.call(G.constructor.prototype,"isPrototypeOf"))return false;
var q;for(q in G);return q===undefined||X.call(G,q)};K.isEmptyObject=function(G){for(var q in G)return false;return true};K.isXmlDocument=function(G){return toString.call(G)==="[object Document]"};K.contains=function(G,q){var p=G,F=arguments,y=1;if(q&&module.isArray(q)){F=q;y=0}for(y=y;y<F;y++)p=p&&typeof foo[F[y]]!=="undefined";return p};K.formatStr=function(G){if(arguments.length<=1)return G;for(var q=arguments.length-2,p=0;p<=q;p++)G=G.replace(RegExp("\\{"+p+"\\}","gi"),arguments[p+1]);return G};
K.wordExists=function(G,q){var p="";if(q.toString)q=q.toString();for(var F=0;F<q.length;F++)p+=!/\w/.test(q[F])?"\\"+q[F]:q[F];return RegExp("(^|\\s|\\,)"+p+"(\\,|\\s|$)","i").test(G)};COG.extend(COG,K)})();
(function(){function X(p){return typeof console!=="undefined"?function(){console[p](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var oa=window.console&&window.console.markTimeline,K=X("error"),G=X("info"),q=function(){return oa?function(p,F){console.markTimeline(p+(F?": "+((new Date).getTime()-F)+"ms":""))}:function(){}}();COG.extend(COG,{trace:q,debug:X("debug"),info:G,warn:X("warn"),error:K,exception:function(p){if(K)for(var F in p)G("ERROR DETAIL: "+
F+": "+p[F])}})})();var FNS_TIME=["webkitAnimationTime","mozAnimationTime","animationTime","webkitAnimationStartTime","mozAnimationStartTime","animationStartTime"],FNS_FRAME=["webkitRequestAnimationFrame","mozRequestAnimationFrame","requestAnimationFrame"],animTime=function(){return(new Date).getTime()},animFrame=function(X){setTimeout(function(){X(animTime())},1E3/60)};FNS_TIME.forEach(function(X){if(X in window)animTime=function(){return window[X]}});
FNS_FRAME.forEach(function(X){if(X in window)animFrame=function(oa){window[X](oa)}});COG.animTime=animTime;COG.animFrame=animFrame;
COG.Loopage=function(){function X(y){return COG.extend({id:q++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},y)}function oa(y){F.push(y);G||(G=animFrame(K));recalcSleepFrequency=true}function K(){for(var y,Z=animTime(),ia=p.length;F.length>0;){var Ca=F.shift();for(y=ia;y--;)if(p[y].id===Ca){p.splice(y,1);break}ia=p.length}for(y=ia;y--;){Ca=Z-p[y].lastTick;if(p[y].lastTick===0||Ca>=p[y].frequency){p[y].execute(Z,p[y]);p[y].lastTick=Z;p[y].single&&p[y].trigger("complete")}}G=ia?
animFrame(K):0}var G=0,q=0,p=[],F=[];return{join:function(y){var Z=new X(y);if(Z.after>0)Z.lastTick=(new Date).getTime()+Z.after;COG.observable(Z);Z.bind("complete",function(){oa(Z.id)});p.unshift(Z);G||(G=animFrame(K));recalcSleepFrequency=true;return Z},leave:oa}}();
(function(){function X(K,G){var q=K.obsHandlers;q[G]||(q[G]=[]);return q[G]}var oa=0;COG.observable=function(K){if(!K)return null;if(!K.obsHandlers)K.obsHandlers={};if(!(K.bind||K.trigger||K.unbind)){K.bind=function(G,q){var p="callback"+oa++;X(K,G).unshift({fn:q,id:p});return p};K.triggerCustom=function(G,q){var p=X(K,G),F={cancel:false,name:G},y;q&&COG.extend(F,q);if(!p)return null;y=Array.prototype.slice.call(arguments,2);K.eventInterceptor&&K.eventInterceptor(G,F,y);y.unshift(F);for(var Z=p.length;Z--&&
!F.cancel;)p[Z].fn.apply(this,y);return F};K.trigger=function(G){var q=Array.prototype.slice.call(arguments,1);q.splice(0,0,G,null);return K.triggerCustom.apply(this,q)};K.unbind=function(G,q){if(typeof G==="undefined")K.obsHandlers={};else for(var p=X(K,G),F=0;p&&F<p.length;F++)if(p[F].id===q){p.splice(F,1);break}return K}}return K}})();
(function(){function X(q,p){q[p]||(q[p]=function(F){return q.configure(p,F)})}function oa(q){q.gtConfId="configurable"+G++;q.gtConfig={};q.gtConfigFns=[];return q.gtConfig}var K={},G=0;COG.paramTweaker=function(q,p,F){return function(y,Z){if(typeof Z!=="undefined"){if(y in q)q[y]=Z;F&&y in F&&F[y](y,Z)}else return p&&y in p?p[y](y):q[y]}};COG.configurable=function(q,p,F,y){if(q){q.gtConfId||oa(q);var Z=q.gtConfId,ia=q.gtConfig,Ca=q.gtConfigFns;K[Z]=q;Ca.push(F);for(F=p.length;F--;){ia[p[F]]=true;
y&&X(q,p[F])}if(!q.configure)q.configure=function(Da,Qa){if(ia[Da]){for(var I=Ca.length;I--;){var H=Ca[I](Da,Qa);if(typeof H!=="undefined")return H}return K[Z]}return null}}}})();
(function(){function X(q){var p=document.createElement("script"),F=false;p.src=q;p.async=true;p.onload=p.onreadystatechange=function(){if(!F&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){F=true;p.onload=p.onreadystatechange=null;p&&p.parentNode&&p.parentNode.removeChild(p)}};K||(K=document.getElementsByTagName("head")[0]);K.appendChild(p)}var oa=0,K,G=this;COG.jsonp=function(q,p,F){q+=q.indexOf("?")>=0?"&":"?";var y="json"+ ++oa;G[y]=function(Z){p(Z);G[y]=null;try{delete G[y]}catch(ia){}};
X(q+(F?F:"callback")+"="+y);return y}})();
(function(){function X(b){if(Da)return ia.length;Da=true;try{for(var u=0;u<ia.length;)if(ia[u].isComplete()){ia[u].triggerComplete(false);ia.splice(u,1)}else{ia[u].update(b);u++}}finally{Da=false}ia.length===0&&Ca.trigger("complete");return ia.length}function oa(){if(!Ca){Ca=COG.Loopage.join({execute:X,frequency:20});Ca.bind("complete",function(){Ca=null})}}var K=1.70158,G=Math.PI/2,q=Math.abs,p=Math.pow,F=Math.sin,y=Math.asin,Z=Math.cos,ia=[],Ca=null,Da=false,Qa={linear:function(b,u,t,B){return t*
b/B+u},backin:function(b,u,t,B){return t*(b/=B)*b*((K+1)*b-K)+u},backout:function(b,u,t,B){return t*((b=b/B-1)*b*((K+1)*b+K)+1)+u},backinout:function(b,u,t,B){return(b/=B/2)<1?t/2*b*b*(((K*=1.525)+1)*b-K)+u:t/2*((b-=2)*b*(((K*=1.525)+1)*b+K)+2)+u},bouncein:function(b,u,t,B){return t-Qa.bounceout(B-b,0,t,B)+u},bounceout:function(b,u,t,B){return(b/=B)<1/2.75?t*7.5625*b*b+u:b<2/2.75?t*(7.5625*(b-=1.5/2.75)*b+0.75)+u:b<2.5/2.75?t*(7.5625*(b-=2.25/2.75)*b+0.9375)+u:t*(7.5625*(b-=2.625/2.75)*b+0.984375)+
u},bounceinout:function(b,u,t,B){return b<B/2?Qa.bouncein(b*2,0,t,B)/2+u:Qa.bounceout(b*2-B,0,t,B)/2+t/2+u},cubicin:function(b,u,t,B){return t*(b/=B)*b*b+u},cubicout:function(b,u,t,B){return t*((b=b/B-1)*b*b+1)+u},cubicinout:function(b,u,t,B){if((b/=B/2)<1)return t/2*b*b*b+u;return t/2*((b-=2)*b*b+2)+u},elasticin:function(b,u,t,B,N,P){if(b==0)return u;if((b/=B)==1)return u+t;P||(P=B*0.3);if(!N||N<q(t)){N=t;t=P/4}else t=P/TWO_PI*y(t/N);return-(N*p(2,10*(b-=1))*F((b*B-t)*TWO_PI/P))+u},elasticout:function(b,
u,t,B,N,P){var da;if(b==0)return u;if((b/=B)==1)return u+t;P||(P=B*0.3);if(!N||N<q(t)){N=t;da=P/4}else da=P/TWO_PI*y(t/N);return N*p(2,-10*b)*F((b*B-da)*TWO_PI/P)+t+u},elasticinout:function(b,u,t,B,N,P){var da;if(b==0)return u;if((b/=B/2)==2)return u+t;P||(P=B*0.3*1.5);if(!N||N<q(t)){N=t;da=P/4}else da=P/TWO_PI*y(t/N);if(b<1)return-0.5*N*p(2,10*(b-=1))*F((b*B-da)*TWO_PI/P)+u;return N*p(2,-10*(b-=1))*F((b*B-da)*TWO_PI/P)*0.5+t+u},quadin:function(b,u,t,B){return t*(b/=B)*b+u},quadout:function(b,u,t,
B){return-t*(b/=B)*(b-2)+u},quadinout:function(b,u,t,B){if((b/=B/2)<1)return t/2*b*b+u;return-t/2*(--b*(b-2)-1)+u},sinein:function(b,u,t,B){return-t*Z(b/B*G)+t+u},sineout:function(b,u,t,B){return t*F(b/B*G)+u},sineinout:function(b,u,t,B){return-t/2*(Z(Math.PI*b/B)-1)+u}},I=COG.Tween=function(b){b=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:H("sine.out"),complete:null},b);var u=(new Date).getTime(),t=[],B=false,N=0,P=0,da={isComplete:function(){return B},triggerComplete:function(ea){b.complete&&
b.complete(ea)},update:function(ea){var ra=b.tweenFn(ea-u,N,P,b.duration);if(b.target)b.target[b.property]=ra;for(var la=t.length;la--;)t[la](ra,void 0);if(B=u+b.duration<=ea){if(b.target)b.target[b.property]=b.tweenFn(b.duration,N,P,b.duration);for(ea=t.length;ea--;)t[ea](ra,true)}},requestUpdates:function(ea){t.push(ea)}};N=b.target&&b.property&&b.target[b.property]?b.target[b.property]:b.startValue;if(typeof b.endValue!=="undefined")P=b.endValue-N;if(P==0)B=true;oa();return da};COG.tweenValue=
function(b,u,t,B,N){function P(ra){var la=ra-da,$=t(la,b,ea,B),sa=da+B<=ra;ra=!sa;if(N){la=N($,sa,la);ra=typeof la!="undefined"?la&&ra:ra}ra&&animFrame(P)}var da=animTime(),ea=u-b;animFrame(P);return{}};COG.tween=function(b,u,t,B,N,P){b=new I({target:b,property:u,endValue:t,tweenFn:B,duration:P,complete:N});ia.push(b);return b};COG.endTweens=function(b){if(!Da){Da=true;try{for(var u=0;u<ia.length;)if(!b||b(ia[u])){ia[u].triggerComplete(true);ia.splice(u,1)}else u++}finally{Da=false}}};COG.getTweens=
function(){return[].concat(ia)};var H=COG.easing=function(b){return Qa[b.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(b,u){Qa[b.replace(/[\-\_\s\.]/g,"").toLowerCase()]=u}})();
(function(){var X=/^P(\d+Y)?(\d+M)?(\d+D)?$/,oa=/^(\d+H)?(\d+M)?(\d+S)?$/,K={8601:function(q){q=q.split("T");var p=null;p=null;var F=0,y=0;X.lastIndex=-1;p=X.exec(q[0]);F+=p[3]?parseInt(p[3].slice(0,-1),10):0;oa.lastIndex=-1;p=oa.exec(q[1]);y+=p[1]?parseInt(p[1].slice(0,-1),10)*3600:0;y+=p[2]?parseInt(p[2].slice(0,-1),10)*60:0;y+=p[3]?parseInt(p[3].slice(0,-1),10):0;return new G(F,y)}},G=COG.Duration=function(q,p){return{days:q?q:0,seconds:p?p:0}};COG.addDuration=function(){for(var q=new G,p=arguments.length;p--;){q.days+=
arguments[p].days;q.seconds+=arguments[p].seconds}if(q.seconds>=86400){q.days+=~~(q.seconds/86400);q.seconds%=86400}return q};COG.formatDuration=function(q){var p,F,y="";if(q.days)y=q.days+" days ";if(q.seconds){q=q.seconds;if(q>=3600){p=~~(q/3600);q-=p*3600}if(q>=60){F=Math.round(q/60);q-=F*60}if(p)y=y+p+(p>1?" hrs ":" hr ")+(F?(F>10?F:"0"+F)+" min ":"");else if(F)y=y+F+" min";else if(q>0)y=y+(q>10?q:"0"+q)+" sec"}return y};COG.parseDuration=function(q,p){var F=p?K[p]:null;if(F)return F(q);COG.Log.warn("Could not find duration parser for specified format: "+
p);return new G}})();
INTERACT=function(){function X(I){return function(H,b,u){(u?u:I?document.body:document).addEventListener(H,b,false)}}function oa(I){return function(H,b,u){(u?u:I?document.body:document).removeEventListener(H,b,false)}}function K(I,H,b){(b?b:document).attachEvent("on"+I,H)}function G(I,H,b){(b?b:document).detachEvent("on"+I,H)}function q(I,H){return{x:I?I:0,y:H?H:0,count:1}}function p(I,H){Da.push(COG.extend({handler:null,checks:{},type:I},H))}function F(I){var H=0,b=0;if(I.offsetParent){do{H+=I.offsetLeft;
b+=I.offsetTop;I=I.offsetParent}while(I)}return{x:H,y:b}}function y(I,H){return{source:I,target:H.target?H.target:H.srcElement}}function Z(I,H){for(var b=I.target?I.target:I.srcElement;b&&b!==H&&b.nodeName&&b.nodeName.toUpperCase()!="CANVAS";)b=b.parentNode;return b&&b===H}function ia(I,H){return{x:I.x-(H?H.x:0),y:I.y-(H?H.y:0)}}function Ca(I){if(I.preventDefault){I.preventDefault();I.stopPropagation()}else I.cancelBubble&&I.cancelBubble()}var Da=[],Qa=function(I,H,b){function u($,sa,za,aa){var L=
0,ua=0,w=0;COG.tweenValue(0,$,za,aa,function(ma){w=L;L=ma});COG.tweenValue(0,sa,za,aa,function(ma){t.trigger("pan",L-w,ma-ua);ua=ma})}b=COG.extend({binder:null,unbinder:null,observable:null},b);for(var t=b.observable,B=null,N=[],P=[],da,ea,ra={bind:function(){return t.bind.apply(null,arguments)},pannable:function($){B=COG.extend({inertia:true},$);return ra},unbind:function(){t.unbind();for(var $=0;$<N.length;$++)N[$].unbind();return ra}},la=0;la<H.length;la++)N.push(H[la](I,t,b));t.bind("pointerDown",
function(){P=[];ea=da=0});t.bind("pointerMove",function($,sa,za,aa){if(B){P[P.length]={ticks:(new Date).getTime(),x:aa.x,y:aa.y};t.trigger("pan",aa.x,aa.y)}da+=aa.x?aa.x:0;ea+=aa.y?aa.y:0});t.bind("pointerUp",function($,sa,za){if(Math.abs(da)>20||Math.abs(ea)>20){if(B){$=P;sa=$.length;var aa;var L=za=0,ua,w,ma;aa=sa>0?(new Date).getTime()-$[sa-1].ticks:0;var Y;for(Y=$.length;--Y>1&&aa<50;)aa+=$[Y].ticks-$[Y-1].ticks;aa=sa-Y;if(aa>1){for(;Y<sa;Y++){ua=$[Y].x-$[Y-1].x;w=$[Y].y-$[Y-1].y;ma=$[Y].ticks-
$[Y-1].ticks;za+=ua/ma;L+=w/ma}za=Math.min(za/aa*500|0,300);L=Math.min(L/aa*500|0,300);u(za,L,COG.easing("quad.out"),500)}}}else t.trigger("tap",sa,za)});return ra};p("pointer",{handler:function(I,H,b){function u(w){if(Z(w,I))if(la=P(w)){I.style.cursor="move";Ca(w);L=w.pageX?w.pageX:w.screenX;ua=w.pageY?w.pageY:w.screenY;$=q(L,ua);sa=F(I);H.triggerCustom("pointerDown",y("mouse",w),$,ia($,sa))}}function t(w){za=w.pageX?w.pageX:w.screenX;aa=w.pageY?w.pageY:w.screenY;if(Z(w,I))da(w,la?"pointerMove":
"pointerHover")}function B(w){if(la&&P(w)){la=false;if(Z(w,I)){I.style.cursor="default";da(w,"pointerUp")}}}function N(w){if(Z(w,I)){var ma;w=w||window.event;if(w.detail)ma=w.axis===2?-w.detail*ea:0;else{ma=w.wheelDeltaY?w.wheelDeltaY:w.wheelDelta;if(window.opera)ma=-ma}if(ma!==0){var Y=q(za,aa);H.triggerCustom("zoom",y("mouse",w),Y,ia(Y,F(I)),ma/ra,"wheel");Ca(w);w.returnValue=false}}}function P(w){w=w||window.event;return(w.which||w.button)==1}function da(w,ma,Y,Ma,Oa){Y=typeof Y!="undefined"?Y:
za;Ma=typeof Ma!="undefined"?Ma:aa;var R=Y-L,ha=Ma-ua,ba=q(Y,Ma);H.triggerCustom(ma,y("mouse",w),ba,ia(ba,sa),q(R,ha));if(typeof Oa=="undefined"||Oa){L=Y;ua=Ma}}b=COG.extend({},b);var ea=120,ra=ea*8,la=false,$,sa,za,aa,L,ua;b.binder("mousedown",u,false);b.binder("mousemove",t,false);b.binder("mouseup",B,false);b.binder("dblclick",function(w){COG.info("captured double click");if(Z(w,I)){var ma=q(w.pageX?w.pageX:w.screenX,w.pageY?w.pageY:w.screenY);COG.info("captured double click + target matched");
H.triggerCustom("doubleTap",y("mouse",w),ma,ia(ma,F(I)))}},false);b.binder("mousewheel",N,document);b.binder("DOMMouseScroll",N,document);return{unbind:function(){b.unbinder("mousedown",u,false);b.unbinder("mousemove",t,false);b.unbinder("mouseup",B,false);b.unbinder("mousewheel",N,document);b.unbinder("DOMMouseScroll",N,document)}}},checks:{touch:false}});p("pointer",{handler:function(I,H,b){function u(R){if(R.count<2)return 0;var ha=R.x-R.next.x;R=R.y-R.next.y;return~~Math.sqrt(ha*ha+R*R)}function t(R,
ha,ba){ha=ha?ha:0;ba=ba?ba:0;for(var Ga={x:R.x-ha,y:R.y-ba,id:R.id,count:R.count},Na=Ga;R.next;){R=R.next;Na=Na.next={x:R.x-ha,y:R.y-ba,id:R.id}}return Ga}function B(R,ha){var ba=R[ha?ha:"touches"],Ga,Na;if(ba.length===0)return null;Na=Ga={x:ba[0].pageX,y:ba[0].pageY,id:ba[0].identifier,count:ba.length};for(var Ha=1,hb=ba.length;Ha<hb;Ha++)Na=Na.next={x:ba[Ha].pageX,y:ba[Ha].pageY,id:ba[Ha].identifier};return Ga}function N(R){if(Z(R,I)){aa=F(I);var ha=B(R,"changedTouches"),ba=t(ha,aa.x,aa.y);if(!ua){L=
$;H.triggerCustom("pointerDown",y("touch",R),ha,ba)}Ma&&H.triggerCustom("pointerDownMulti",y("touch",R),ha,ba);ua=B(R);if(ua.count>1)ma=u(ua);Oa=1;Y=t(ua)}}function P(R){if(Z(R,I)){R.preventDefault();w=B(R);if(L==$)L=Math.abs(ua.x-w.x)>ra||Math.abs(ua.y-w.y)>ra?la:$;if(L!=$){L=w.count>1?za:sa;if(L==za)if(ua.count===1){ua=t(w);ma=u(ua)}else{var ha=u(w);if(Math.abs(ma-ha)<ea)L=sa;else{var ba;ba=w.x;var Ga=w.next.x,Na=w.y,Ha=w.next.y,hb=Na<Ha?Na:Ha;ba={x:(ba<Ga?ba:Ga)+(Math.abs(ba-Ga)>>1),y:hb+(Math.abs(Na-
Ha)>>1)};ha=ha/ma;Ga=ha-Oa;H.triggerCustom("zoom",y("touch",R),ba,ia(ba,aa),Ga,"pinch");Oa=ha}}L==sa&&H.triggerCustom("pointerMove",y("touch",R),w,t(w,aa.x,aa.y),q(w.x-Y.x,w.y-Y.y));Ma&&H.triggerCustom("pointerMoveMulti",y("touch",R),w,t(w,aa.x,aa.y))}Y=t(w)}}function da(R){if(Z(R,I)){var ha=B(R,"changedTouches"),ba=t(ha,aa.x,aa.y);w=B(R);if(!w){L===$&&H.triggerCustom("tap",y("touch",R),ha,ba);H.triggerCustom("pointerUp",y("touch",R),ha,ba);ua=null}Ma&&H.triggerCustom("pointerUpMulti",y("touch",R),
ha,ba)}}b=COG.extend({detailed:false,inertia:false},b);var ea=20,ra=7,la=0,$=1,sa=2,za=3,aa,L,ua,w,ma,Y,Ma=b.detailed,Oa=1;b.binder("touchstart",N,false);b.binder("touchmove",P,false);b.binder("touchend",da,false);COG.info("initialized touch handler");return{unbind:function(){b.unbinder("touchstart",N,false);b.unbinder("touchmove",P,false);b.unbinder("touchend",da,false)}}},checks:{touch:true}});return{register:p,watch:function(I,H,b){H=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!=
"undefined",types:null},H);capabilities=COG.extend({touch:"ontouchstart"in window},b);if(!H.observable){COG.info("creating observable");H.observable=COG.observable({});globalOpts=H}H.binder=H.isIE?K:X(H.bindToBody);H.unbinder=H.isIE?G:oa(H.bindToBody);b=H.types;for(var u=capabilities,t=[],B=Da.length;B--;){var N=Da[B],P=!b||b.indexOf(N.type)>=0,da=true;for(var ea in N.checks){var ra=N.checks[ea];COG.info("checking "+ea+" capability. require: "+ra+", capability = "+u[ea]);da=da&&ra===u[ea]}if(P&&da)t[t.length]=
N.handler}return new Qa(I,t,H)}}}();
T5=function(){function X(){return(new Date).getTime()}function oa(){for(;ha.length>0;){var d=ha.shift();document.location=d}R=0}function K(d){for(var r=true,f=ba.length;f--;)r=r&&d!=ba[f];return r}function G(d,r){var f=[];for(var c in r)c&&f.push(c+"="+escape(r[c]));return"tile5://"+d+"/"+(f.length>0?"?"+f.join("&"):"")}function q(d,r){K(d)&&COG.info("would push url: "+G(d,r))}function p(d,r){if(K(d)){ha.push(G(d,r));R||(R=setTimeout(oa,100))}}function F(d){return function(r,f,c){(c?c:d?document.body:
document).addEventListener(r,f,false)}}function y(d){return function(r,f,c){(c?c:d?document.body:document).removeEventListener(r,f,false)}}function Z(d,r,f){(f?f:document).attachEvent("on"+d,r)}function ia(d,r,f){(f?f:document).detachEvent("on"+d,r)}function Ca(){Y={base:{name:"Unknown",bindEvent:F(),unbindEvent:y(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:q,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:Z,unbindEvent:ia,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:p,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:p},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:p},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:F(true),unbindEvent:y(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:p},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:p}};Ma=[Y.froyo,Y.android,Y.ipod,Y.iphone,Y.ipad,Y.ie]}function Da(){Y||Ca();if(!Oa){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var d=0;d<Ma.length;d++){var r=Ma[d];if(r.regex&&r.regex.test(navigator.userAgent)){Oa=COG.extend({},Y.base,r);COG.info("PLATFORM DETECTED AS: "+Oa.name);break}}if(!Oa){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Oa=Y.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Oa}function Qa(d,r){function f(j,v){j=j?N(B(j,n),e):e;if(j!=c){c=j;d.triggerAll("zoomLevelChange",j,v)}}r=COG.extend({initial:1,minZoom:1,maxZoom:16},r);var c=null,e=r.minZoom,n=r.maxZoom;COG.extend(d,{getZoomLevel:function(){return c},setZoomLevel:f});d.bind("scale",function(j,v,s){j=Math.log(v)/Math.LN2;COG.endTweens(function(o){return o.cancelOnInteract});f(c+j,s);d.updateOffset(s.x*v,s.y*v)})}function I(){for(var d=
0,r=arguments.length;r--;){var f=hb[arguments[r].toUpperCase()];if(f)d|=f}return d}var H=Math.PI*2,b=Math.PI/2,u=Math.abs,t=Math.ceil,B=Math.min,N=Math.max,P=Math.pow,da=Math.sqrt,ea=Math.log,ra=Math.round,la=Math.sin,$=Math.asin,sa=Math.cos,za=Math.atan,aa=Math.atan2,L=function(){function d(c,e){return f(c.x-e.x,c.y-e.y)}function r(c,e){if(!e)e=c.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var n={edges:Array(e-1),accrued:Array(e-1),total:0},
j=0;j<e-1;j++){var v=d(c[j],c[j+1]);n.edges[j]=da(v.x*v.x+v.y*v.y);n.accrued[j]=n.total+n.edges[j];n.total+=n.edges[j]}return n}function f(c,e){return{x:c?c:0,y:e?e:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var c=0,e=0,n=arguments.length;n--;){c+=arguments[n].x;e+=arguments[n].y}return f(c,e)},absSize:function(c){return N(u(c.x),u(c.y))},copy:function(c){return c?f(c.x,c.y):null},diff:d,distance:function(c,e){return r(c,e).total},edges:r,equals:function(c,
e){return c.x===e.x&&c.y===e.y},extendBy:function(c,e,n){var j=sa(e)*n;e=la(e)*n;return f(c.x-j,c.y-e)},floor:function(c){for(var e=Array(c.length),n=c.length;n--;)e[n]=f(~~c[n].x,~~c[n].y);return e},getRect:function(c){for(var e,n,j,v,s=c.length;s--;){var o=c[s];e=typeof e==="undefined"||o.x<e?o.x:e;n=typeof n==="undefined"||o.y<n?o.y:n;j=typeof j==="undefined"||o.x>j?o.x:j;v=typeof v==="undefined"||o.y>v?o.y:v}return w.init(e,n,j,v)},init:f,invert:function(c){return f(-c.x,-c.y)},min:function(c,
e){return f(c.x<e.x?c.x:e.x,c.y<e.y?c.y:e.y)},max:function(c,e){return f(c.x>e.x?c.x:e.x,c.y>e.y?c.y:e.y)},offset:function(c,e,n){return f(c.x+e,c.y+(n?n:e))},simplify:function(c,e){if(!c)return null;e=e?e:L.VECTOR_SIMPLIFICATION;for(var n=[],j=null,v=c.length;v--;){var s=c[v];if(include=!j||v===0||u(s.x-j.x)+u(s.y-j.y)>e){n.unshift(s);j=s}}return n},theta:function(c,e,n){n=$((c.y-e.y)/n);return c.x>e.x?n:Math.PI-n},toString:function(c){return c.x+", "+c.y}}}(),ua=function(){return{dotProduct:function(d,
r){return d.x*r.x+d.y*r.y}}}(),w=function(){function d(f){return r(f.x1,f.y1,f.x2,f.y2)}function r(f,c,e,n){f=f?f:0;c=c?c:0;e=typeof e!=="undefined"?e:f;n=typeof n!=="undefined "?n:n;return{x1:f,y1:c,x2:e,y2:n,width:e-f,height:n-c}}return{center:function(f){return L.init(f.x1+f.width/2,f.y1+f.height/2)},copy:d,diagonalSize:function(f){return da(f.width*f.width+f.height*f.height)},fromCenter:function(f,c,e,n){e=e>>1;n=n>>1;return r(f-e,c-n,f+e,c+n)},init:r,intersect:function(f,c){var e=N(f.x1,c.x1),
n=N(f.y1,c.y1),j=B(f.x2,c.x2),v=B(f.y2,c.y2);e=r(e,n,j,v);return e.width>0&&e.height>0?e:null},toString:function(f){return"["+f.x1+", "+f.y1+", "+f.x2+", "+f.y2+"]"},union:function(f,c){if(f.width===0||f.height===0)return d(c);else if(c.width===0||c.height===0)return d(f);else{var e=B(f.x1,c.x1),n=B(f.y1,c.y1),j=N(f.x2,c.x2),v=N(f.y2,c.y2);e=r(e,n,j,v);return e.width>0&&e.height>0?e:null}}}}(),ma=function(){return{getAspectRatio:function(d){return d.height!==0?d.width/d.height:1},getCenter:function(d){return L.init(d.width>>
1,d.height>>1)},getSize:function(d){return da(P(d.width,2)+P(d.height,2))},init:function(d,r){d=d?d:0;return{width:d,height:r?r:d}}}}(),Y=null,Ma=[],Oa=null,R=0,ha=[],ba=["view.wake","tile.loaded"],Ga=function(){function d(){var l=Da().maxImageLoads;if(!l||s.length<l)if(l=v.shift()){s[s.length]=l;l.image.onload=r;l.image.src=l.url;l.requested=T5.ticks()}}function r(){var l=n[this.id],D;if(l&&l.image.complete&&l.image.width>0){l.loaded=true;l.hitCount=1;for(D=s.length;D--;)if(s[D].image.src==this.src){s.splice(D,
1);break}if(l.background||l.postProcess||l.drawBackground||l.customDraw)if(l.image){globalImageData=l;D=c(l.realSize?l.realSize.width:l.image.width,l.realSize?l.realSize.height:l.image.height);var Q=D.getContext("2d"),U=l.offset?l.offset:T5.XY.init();l.background&&Q.drawImage(l.background,0,0);l.drawBackground&&l.drawBackground(Q);l.customDraw?l.customDraw(Q,l):Q.drawImage(l.image,U.x,U.y);l.postProcess&&l.postProcess(Q,l);l.image=D}for(D=l.callbacks.length;D--;)l.callbacks[D]&&l.callbacks[D](this,
false);l.callbacks=[];o[o.length]={url:this.src,created:l.requested};delete n[this.id];d()}}function f(l,D,Q){var U=e[l];if(U){U.hitCount++;U.image.complete&&U.image.width>0&&D?D(U.image,true):U.callbacks.push(D)}else{U=COG.extend({url:l,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[D]},Q);U.image.id="resourceLoaderImage"+j++;e[l]=U;n[U.image.id]=U;v[v.length]=U;d()}return U}function c(l,D){var Q=document.createElement("canvas");COG.info("creating new canvas");
Q.width=l?l:0;Q.height=D?D:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(Q);FlashCanvas.initElement(Q)}return Q}var e={},n={},j=0,v=[],s=[],o=[],z={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var l;for(l=s.length;l--;)delete e[s[l].url];s=[];for(l=v.length;l--;)delete e[v[l].url];v=[]},get:function(l,D,Q){var U=null;U=null;if((U=(U=e[l])?U.image:null)&&(U.getContext||U.complete&&U.width>0))return U;else D&&f(l,D,Q);return null},load:f,newCanvas:c,reset:function(){e={}},
stats:function(){return{imageLoadingCount:s.length,queuedImageCount:v.length,imageCacheFullness:0}}};COG.observable(z);return z}(),Na=function(){var d={};return{init:function(r,f){var c=d[r];if(!c)throw Error("Unable to locate requested generator: "+r);return new c(f)},register:function(r,f){d[r]=f},Template:function(){}}}(),Ha=function(){function d(j,v){e[j]=f(v);return j}function r(j){for(var v in j)d(v,j[v])}function f(j){function v(l){var D=j[l];typeof D!=="undefined"&&o.push(function(Q){Q[l]=
D})}function s(){o=[];for(var l in j)v(l)}j=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},j);var o=[],z={applyToContext:function(l){for(var D=o.length;D--;)o[D](l)},update:function(l,D){j[l]=D;s()}};s();return z}var c={},e={},n={apply:function(j,v){var s=e[v]?e[v]:e.basic,o;if(j&&j.canvas){o=c[j.canvas.id];c[j.canvas.id]=v}s.applyToContext(j);return o},define:d,
defineMany:r,get:function(j){return e[j]},init:f,load:function(j){COG.jsonp(j,function(v){r(v)})}};r({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return n}(),hb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Ab=function(d){function r(E,A,M,W){Pa=jb;Q(va-A,ta-M,W?d.panAnimationEasing:null,W?d.panAnimationDuration:null);clearTimeout(O);O=setTimeout(f,100)}function f(){Pa=nb;Ea()}function c(E,A,M,W){Xa(B(N(ja+
P(2,W)-1,0.5),2))}function e(){var E=ea(ja)/Math.LN2>>0;if(E!==0){ja=P(2,E);E=L.init(kb-(x/ja>>0),lb-(J/ja>>0));if(!Aa.trigger("scale",ja,E).cancel){for(var A=ca.length;A--;)ca[A].trigger("scale",ja,E);ja=1;Pa=nb}pa()}Ea()}function n(E){E||(E=L.init(x,J));fa=L.init(va,ta);ga=L.offset(E,va,ta);kb=ga.x;lb=ga.y}function j(E,A){var M,W;W=1/ja;if(ja!==1&&a){M=a.x1+E*W;W=a.y1+A*W}else{M=E+va;W=A+ta}return L.init(M,W)}function v(E,A,M){cb("doubleTap",A,M,j(M.x,M.y));if(d.scalable){COG.endTweens(function(W){return W.cancelOnInteract});
Xa(2,M,d.zoomAnimation,null,d.zoomDuration)}}function s(){ib=null}function o(E,A,M){ib=j(M.x,M.y);D(A,M,ib,"hover")}function z(){clearTimeout(Ya);Ya=setTimeout(U,250)}function l(E,A,M){D(A,M,j(M.x,M.y),"tap");cb("tap",A,M,j(M.x,M.y))}function D(E,A,M,W){for(var na=[],Ia=ya;Ia--;)if(ca[Ia].hitTest)na=na.concat(ca[Ia].hitTest(M.x,M.y,Pa,Aa));na.length>0&&Aa.trigger(W+"Hit",na,E,A,M)}function Q(E,A,M,W,na){function Ia(){ab+=1;if(ab>=2){f();na&&na()}}var ab=0,Va=S?L.offset(S,-x,-J):null,bb=V?L.offset(V,
-x,-J):null;if(Va){E=E<Va.x?Va.x:E;A=A<Va.y?Va.y:A}if(bb){E=E>bb.x?bb.x:E;A=A>bb.y?bb.y:A}if(M){if((Pa&jb)===0){COG.tweenValue(va,E,M,W,function(eb,ob){va=eb|0;(ob?Ia:Ea)();return!Ba});COG.tweenValue(ta,A,M,W,function(eb,ob){ta=eb|0;(ob?Ia:Ea)();return!Ba});Pa=jb|pb}}else{va=E|0;ta=A|0;Ea();na&&na()}}function U(E,A){var M;if(Fa){Sa&&Sa.unbind();if(d.autoSize&&Fa.parentNode){E=Fa.parentNode.offsetWidth;A=Fa.parentNode.offsetHeight}try{if(!Fa.id)Fa.id=d.id+"_canvas";qa=Fa.getContext("2d")}catch(W){COG.exception(W);
throw Error("Could not initialise canvas on specified view element");}if(E&&A&&(Ka!==A||La!==E)){qb=true;La=E;Ka=A;x=La>>1;J=Ka>>1;Aa.trigger("resize",La,Ka);for(M=ya;M--;)ca[M].trigger("resize",La,Ka)}if(d.interactive){Sa=INTERACT.watch(Fa).pannable();Za()}for(M=ya;M--;)ca[M].trigger("contextChanged",qa);Ea()}}function wa(E,A){A.setId(E);A.added=X();A.bind("remove",function(){Aa.removeLayer(E)});A.trigger("contextChanged",qa);A.setParent(Aa);ca.push(A);ca.sort(function(M,W){var na=W.zindex-M.zindex;
if(na===0)na=W.added-M.added;return na});ya=ca.length;return A}function Za(){if(Sa){if(d.pannable){Sa.bind("pan",r);Sa.bind("inertiaCancel",function(){Ea()})}if(d.scalable){Sa.bind("zoom",c);Sa.bind("doubleTap",v)}if(d.captureHover){Sa.bind("pointerDown",s);Sa.bind("pointerHover",o)}Sa.bind("tap",l)}}function $a(){var E=fb?va+x:va,A=g?ta+J:ta;if(Ta&&Ta>La)if(E+La>Ta)va=fb?E-Ta>0?va-Ta:va:Ta-La;else if(E<0)va=fb?va+Ta:0;if(Ua&&Ua>Ka)if(A+Ka>Ua)ta=g?A-Ua>0?ta-Ua:ta:Ua-Ka;else if(A<0)ta=g?ta+Ua:0}function rb(E,
A,M,W){var na;w.center(A);var Ia=0;a=w.copy(A);a.scaleFactor=ja;M||qa.clearRect(0,0,La,Ka);qa.save();try{qa.globalCompositeOperation="source-over";if(ja!==1){var ab=a,Va=1/ja;kb=ga.x+(va-fa.x);lb=ga.y+(ta-fa.y);a=ab?w.fromCenter(kb>>0,lb>>0,ab.width*Va>>0,ab.height*Va>>0):void 0;qa.scale(ja,ja)}qa.translate(-a.x1,-a.y1);V=S=null;if(M){qa.beginPath();for(Ia=ya;Ia--;)ca[Ia].clip&&ca[Ia].clip(qa,a,E,Aa,W);qa.closePath();qa.clip()}for(Ia=ya;Ia--;){na=ca[Ia];var bb=na.style,eb=bb?Ha.apply(qa,bb):null;
if(na.minXY)S=S?L.min(S,na.minXY):L.copy(na.minXY);if(na.maxXY)V=V?L.max(V,na.maxXY):L.copy(na.maxXY);na.draw(qa,a,E,Aa,W);eb&&Ha.apply(qa,eb)}}finally{qa.restore()}if(h){qa.globalCompositeOperation="source-over";qa.strokeStyle="#f00";qa.beginPath();qa.moveTo(x,0);qa.lineTo(x,Ka);qa.moveTo(0,J);qa.lineTo(La,J);qa.stroke()}sb=0;cb("drawComplete",A,W)}function mb(E){var A,M=false;if(sb){if(E-yb>Eb){if(ja!==1)Pa|=zb;Ba=(A=(Pa&(zb|jb))!==0)&&(Pa&pb)===0;if(qb&&Fa){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(Fa);
Fa.width=La;Fa.height=Ka;Fa.style.width=La+"px";Fa.style.height=Ka+"px";qb=false}if(Ta||Ua)$a();k=db();if(Ba){COG.endTweens(function(na){return na.cancelOnInteract});Ja=false;if(T!==0){clearTimeout(T);T=0}}for(var W=ya;W--;){if(ca[W].animated)Pa|=pb;ca[W].cycle(E,k,Pa);ca[W].shouldDraw(Pa,k);M=ca[W].clip||M}rb(Pa,k,m&&M&&!A,E);E-ka>tb&&pa();yb=E}COG.animFrame(mb)}else C=false}function Ea(){sb+=1;if(!C){C=true;COG.animFrame(mb)}}function db(){return w.init(va,ta,va+La,ta+Ka)}function pa(){ka=(new Date).getTime();
cb("refresh",Aa,db());Ea()}function Xa(E,A,M,W,na){if(M)COG.tweenValue(ja,E,M,na,function(Ia,ab){ja=Ia;if(ab){var Va=ra(ea(ja)/Math.LN2);ja=P(2,Va);W&&W()}n(A);e()});else{ja=E;n(A);e()}return Aa}function cb(){for(var E=Aa.trigger.apply(null,arguments).cancel,A=ca.length;A--;)E=ca[A].trigger.apply(null,arguments).cancel||E;return!E}d=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastDraw:false,inertia:true,idleDelay:100,minRefresh:1E3,pannable:true,clipping:true,scalable:true,interactive:true,
panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25,zoomAnimation:COG.easing("quad.out"),zoomDuration:300},d);var ca=[],ya=0,Fa=document.getElementById(d.container),qa=null,ub=typeof window.attachEvent!="undefined",tb=d.minRefresh,ib=null,va=0,ta=0,Ta=null,Ua=null,fb=false,g=false,m=d.clipping,k=null,C=false,a,h=d.guides,i=1,x=0,J=0,fa=null,ga=null,Ba=false,Ja=false,T=0,O=0,S=
null,V=null,ka=0,xa=0,Ya=0,ja=1,yb=0,qb=false,Sa=null,Ka,La,Eb=1E3/d.fps|0,sb=0,kb,lb,nb=I("ACTIVE"),jb=I("PAN"),zb=I("ZOOM"),pb=I("ANIMATING"),Pa=nb,Aa={id:d.id,deviceScaling:i,fastDraw:d.fastDraw||Da().requireFastDraw,getDimensions:function(){return ma.init(La,Ka)},getLayer:function(E){for(var A=0;A<ya;A++)if(ca[A].getId()==E)return ca[A];return null},setLayer:function(E,A){for(var M=0;M<ya;M++)if(ca[M].getId()===E){ca.splice(M,1);break}if(A){wa(E,A);A.trigger("refresh",Aa,db())}Ea();return A},
eachLayer:function(E){for(var A=ya;A--;)E(ca[A])},invalidate:Ea,refresh:pa,resetScale:function(){ja=1},resize:function(E,A){if(Fa){d.autoSize=false;if(La!==E||Ka!==A)U(E,A)}},scale:Xa,triggerAll:cb,removeLayer:function(E){a:{for(var A=ya;A--;)if(ca[A].getId()==E){E=A;break a}E=-1}if(E>=0&&E<ya){Aa.trigger("layerRemoved",ca[E]);ca.splice(E,1);Ea()}ya=ca.length},getOffset:function(){return L.init(va,ta)},setMaxOffset:function(E,A,M,W){Ta=E;Ua=A;fb=typeof M!="undefined"?M:false;g=typeof W!="undefined"?
W:false},getViewRect:db,updateOffset:Q,pan:function(E,A,M,W,na){Q(va+E,ta+A,M,W,na)}};i=Da().getScaling();Aa.markers=wa("markers",new vb);COG.observable(Aa);Aa.bind("invalidate",function(){Ea()});Aa.bind("resync",function(){V=S=null});COG.configurable(Aa,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(d,null,{container:function(E,A){Fa=document.getElementById(A);U()},rotation:function(E,A){xa=A}}),true);U();if(d.autoSize)ub?window.attachEvent("onresize",z):window.addEventListener("resize",
z,false);return Aa},gb=function(d){d=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:I("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},d);var r=null,f=false,c=false,e=d.id,n=I("ACTIVE"),j=d.validStates,v=0,s=0,o=COG.extend({addToView:function(z){z.setLayer(e,o)},shouldDraw:function(z){return(z&j)!==0},clip:null,cycle:function(){},draw:function(){},remove:function(){o.trigger("remove",o)},changed:function(){c=true;r&&r.invalidate()},hitTest:null,getId:function(){return e},
setId:function(z){e=z},getParent:function(){return r},setParent:function(z){f=(r=z)?r.fastDraw&&displayState!==n:false;o.trigger("parentChange",r)}},d);COG.observable(o);o.bind("drawComplete",function(z,l){c=false;v=l.x1;s=l.y1});o.bind("resync",function(z,l){if(l.syncXY){o.minXY&&l.syncXY(o.minXY);o.maxXY&&l.syncXY(o.maxXY)}});return o},wb=function(d){function r(s,o,z,l){c=s;e=o;n=z;j=l}d=COG.extend({xy:L.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},d);var f=false,c=0,e=0,n=0,
j=0,v=COG.extend(d,{isAnimating:function(){return f},draw:function(s,o,z,l,D){if(v.isNew&&d.tweenIn)COG.tweenValue(o.y1-20,v.xy.y,d.tweenIn,d.animationSpeed?d.animationSpeed:250+Math.random()*500,function(Q,U){v.xy.y=Q|0;f=!U;D.invalidate()});v.drawMarker(s,o,v.xy.x,v.xy.y,z,l,D);v.isNew=false},drawMarker:function(s,o,z,l){s.beginPath();s.arc(z,l,4,0,Math.PI*2,false);s.fill();r(z-4,l-4,8,8)},hitTest:function(s,o){return s>=c&&s<=c+n&&o>=e&&o<=e+j},updateBounds:r});COG.observable(v);return v},vb=function(d){function r(){f();
e.changed();e.trigger("markerUpdate",c)}function f(){var n=e.getParent();if(n&&n.syncXY)for(var j=c.length;j--;)n.syncXY([c[j].xy])}d=COG.extend({zindex:100,style:"basic"},d);var c=[],e=COG.extend(new gb(d),{draw:function(n,j,v,s){for(var o=c.length;o--;)c[o].draw(n,j,v,e,s)},add:function(n){if(n&&typeof n.length!=="undefined")for(var j=n.length;j--;){if(n[j])c[c.length]=n[j]}else if(n)c[c.length]=n;r()},clear:function(n){if(n)for(var j=0;j<c.length;)if(n(c[j]))c.splice(j,1);else j+=1;else c=[];r()},
each:function(n){if(n)for(var j=c.length;j--;)n(c[j])},find:function(n){for(var j=[],v=c.length;v--;)if(!n||n(c[v]))j[j.length]=c[v];return j},hitTest:function(n,j){for(var v=[],s=c.length;s--;)if(c[s].hitTest(n,j))v[v.length]={type:"marker",data:c[s]};return v}});e.bind("tap",function(n,j,v,s){var o=[],z=s.x;s=s.y;for(var l=c.length;l--;)if(c[l].hitTest(z,s))o[o.length]=c[l];if(o.length>0)n.cancel=e.trigger("markerTap",j,v,o).cancel});e.bind("parentChange",f);e.bind("resync",f);return e},Bb=function(d){function r(s,
o,z){s.fillStyle="#FFFFFF";s.strokeStyle="#222222";s.beginPath();s.arc(z.x,z.y,4,0,Math.PI*2,false);s.stroke();s.fill()}d=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:I("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},d);var f=L.edges(d.path),c,e=null,n=d.drawIndicator?d.drawIndicator:r,j=0,v=COG.extend(new gb(d),{cycle:function(){for(var s=0;s<f.accrued.length&&f.accrued[s]<j;)s++;e=null;if(s<d.path.length-1){var o=j-(s>0?f.accrued[s-1]:0),z=d.path[s];
c=L.theta(z,d.path[s+1],f.edges[s]);e=L.extendBy(z,c,o)}return e},draw:function(s,o){e&&n&&n(s,o,L.init(e.x,e.y),c)}});COG.tweenValue(0,f.total,d.easing,d.duration,function(s,o){j=s;o&&v.remove();v.changed()});return v},Cb=function(d){d=COG.extend({style:null,properties:{}},d);return COG.extend(d,{rect:null,draw:function(){},resync:function(){}})},xb=function(d,r){r=COG.extend({fill:false,simplify:false},r);var f=false,c=r.fill,e=r.simplify,n=I("ZOOM"),j=[],v=COG.extend(new Cb(r),{draw:function(s,
o,z,l,D,Q){if(f){o=true;z=(Q&n)!==0;s.beginPath();for(Q=j.length;Q--;){z=j[Q].x;l=j[Q].y;if(o){s.moveTo(z,l);o=false}else s.lineTo(z,l);z=true}if(z){c&&s.fill();s.stroke()}}},resync:function(s){v.xy=s.syncXY(d);j=L.floor(e?L.simplify(d):d)}});f=d&&d.length>=2;return v},Db=function(d){function r(n){for(var j=c.length;j--;)c[j].resync(n);c.sort(function(v,s){var o=s.xy.y-v.xy.y;if(o===0)o=s.xy.x-v.xy.y;return o});e.changed()}function f(n,j){j.syncXY&&r(j)}d=COG.extend({zindex:80},d);var c=[],e=COG.extend(new gb(d),
{add:function(n){c[c.length]=n},each:function(n){for(var j=c.length;j--;)n(c[j])},draw:function(n,j,v){var s=j.x1,o=j.y1,z=j.width;j=j.height;for(var l=c.length;l--;){var D=c[l].style;D=D?Ha.apply(n,D):null;c[l].draw(n,s,o,z,j,v);D&&Ha.apply(n,D)}}});e.bind("parentChange",f);e.bind("resync",f);return e},Fb=function(){return{tileSize:256,init:function(d,r,f,c,e){return COG.extend({x:d,y:r,width:f,height:c},e)}}}(),Wa={ex:COG.extend,ticks:X,getConfig:Da,userMessage:function(d,r,f){Wa.trigger("userMessage",
d,r,f)},zoomable:Qa,XY:L,XYRect:w,Dimensions:ma,Vector:ua,D:ma,Images:Ga,Generator:Na,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ha,viewState:I,View:Ab,ViewLayer:gb,ImageLayer:function(d,r){function f(o,z,l){for(z=j.length;z--;){var D=j[z],Q=D.x,U=D.y,wa=w.init(D.x,D.y,D.x+D.width,D.y+D.height);if(l&&w.intersect(o,wa))(wa=Ga.get(D.url,function(){s.changed()},v))&&l(wa,Q,U,D.width,D.height)}}function c(o){var z=++n,l=s.getParent();e&&e.run(l,o,function(D){if(z==
n){j=[].concat(D);l.invalidate()}})}r=COG.extend({imageLoadArgs:{}},r);var e=d?Na.init(d,r):null,n=0,j=[],v=r.imageLoadArgs,s=COG.extend(new gb(r),{changeGenerator:function(o,z){e=Na.init(o,COG.extend({},r,z));j=null;c(s.getParent().getViewRect())},clip:function(o,z,l){f(z,l,function(D,Q,U,wa,Za){o.rect(Q,U,wa,Za)})},draw:function(o,z,l){f(z,l,function(D,Q,U,wa,Za){s.drawImage(o,D,Q,U,wa,Za,z,l)})},drawImage:function(o,z,l,D){z&&o.drawImage(z,l,D,z.width,z.height)}});s.bind("refresh",function(o,z,
l){c(l)});s.bind("tap",function(o,z,l,D){o=[];var Q=D.x,U=D.y,wa,Za;if(j)for(var $a=j.length;$a--;){wa=j[$a];if(Za=Q>=wa.x&&Q<=wa.x+wa.width&&U>=wa.y&&U<=wa.y+wa.height)o[o.length]=wa}o.length>0&&s.trigger("tapImage",o,z,l,D)});return s},ImageGenerator:function(d){d=COG.extend({relative:false,padding:2},d);d={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(d);return d},Marker:wb,ImageMarker:function(d){d=COG.extend({image:null,imageUrl:null,animatingImage:null,
animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},d);var r=d.imageAnchor?T5.XY.invert(d.imageAnchor):null,f=COG.extend(new wb(d),{drawMarker:function(c,e,n,j){if((e=f.isAnimating()&&f.animatingImage?f.animatingImage:f.image)&&e.width>0){r||(r=L.init(-e.width>>1,-e.height>>1));var v=f.scale,s=n+~~(r.x*v),o=j+~~(r.y*v),z=~~(e.width*v),l=~~(e.height*v);f.updateBounds(s,o,z,z);if(f.rotation||f.opacity!==1){c.save();try{c.globalAlpha=f.opacity;c.translate(n,j);c.rotate(f.rotation);
c.drawImage(e,r.x*v,r.y*v,z,l)}finally{c.restore()}}else c.drawImage(e,s,o,z,l)}}});if(!f.image)f.image=Ga.get(d.imageUrl,function(c){f.image=c});if(!f.animatingImage)f.animatingImage=Ga.get(d.animatingImageUrl,function(c){f.animatingImage=c});return f},MarkerLayer:vb,PathLayer:function(d){function r(){var o=s.getParent();if(o&&o.syncXY){o.syncXY(e);n&&o.syncXY(n);s.trigger("tidy")}}d=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},d);var f=[],c=null,e=[],n=null,j=0,v=[],s=COG.extend(new gb(d),
{getAnimation:function(o,z,l,D){var Q="pathAnimation"+j++;v.push(Q);return new Bb({id:Q,path:f,zindex:d.zindex+1,easing:o?o:COG.easing("sine.inout"),duration:z?z:5E3,drawIndicator:l,autoCenter:D?D:false})},draw:function(o){var z,l=f.length;o.save();try{Ha.apply(o,d.style);if(l>0){o.beginPath();o.moveTo(f[l-1].x,f[l-1].y);for(z=l;z--;)o.lineTo(f[z].x,f[z].y);o.stroke();if(c){o.fillStyle=d.waypointFillStyle;for(z=c.length;z--;){o.beginPath();o.arc(c[z].x,c[z].y,2,0,Math.PI*2,false);o.stroke();o.fill()}}}}finally{o.restore()}},
updateCoordinates:function(o,z){e=o;n=z;r()}});s.bind("tidy",function(){f=L.simplify(e,d.pixelGeneralization);c=L.simplify(n,d.pixelGeneralization);s.changed(true)});s.bind("resync",r);return s},AnimatedPathLayer:Bb,Shape:Cb,Arc:function(d,r){r=COG.extend({size:4},r);var f=L.init(),c=COG.extend(r,{draw:function(e){e.beginPath();e.arc(f.x,f.y,c.size,0,Math.PI*2,false);e.fill();e.stroke()},resync:function(e){e.syncXY([d]);f=L.floor([d])[0]}});COG.info("created arc = ",d);return c},Poly:xb,ShapeLayer:Db,
Tiling:Fb};COG.observable(Wa);var Ra=Wa.Geo=function(){function d(g){for(var m=null,k=1;!m&&k<arguments.length;k++)m=n(g,arguments[k]);m=m?m:n(g);if(!m)throw Error("Unable to find GEO engine with "+g+" capability");return m}function r(g){g=parseFloat(g)*D;g=la(g);var m=$a*g;return ea((1+g)/(1-g)*P((1-m)/(1+m),$a))/2}function f(g){return parseFloat(g)*D}function c(g){g=P(Math.E,-g);for(var m=b-2*za(g),k=j(m,g),C=0;C<mb&&u(m-k)>rb;){m=k;k=j(m,g);C++}return k*Q}function e(g){return g%360*Q}function n(g,
m){var k=null;for(var C in ya)if(m){if(C==m&&ya[C][g]){k=ya[C];break}}else if(ya[C][g]){k=ya[C];break}return k}function j(g,m){var k=$a*la(g);return b-2*za(m*P((1-k)/(1+k),$a/2))}function v(g,m,k,C){m=o(m);g.add(C.line(m,k));return m.length}function s(g,m,k,C){m=o(m);g.add(C.poly(m,k));return m.length}function o(g){var m=g?g.length:0,k=Array(m);for(m=m;m--;)k[m]=Ra.Position.init(g[m][1],g[m][0]);return Ra.Position.vectorize(k,va)}function z(g,m,k){return new Ua(g,m,k)}var l=[1.406245461070741,1.321415085624082,
1.077179995861952,0.703119412486786,0.488332580888611],D=Math.PI/180,Q=180/Math.PI,U=b,wa=-U,Za=-H,$a=0.08181919084262157,rb=1.0E-7,mb=12,Ea=null,db={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},pa=function(){function g(a){return a?k(a.lat,a.lon):null}function m(a){return!a||a.lat===0&&a.lon===0}function k(a,h){return{lat:parseFloat(a?a:0),lon:parseFloat(h?h:0)}}function C(a){if(a)if(typeof a.lat!=="undefined")return g(a);else{if(a.split)for(var h=
[" ",","],i=0;i<h.length;i++){var x=a.split(h[i]);if(x.length===2)return k(x[0],x[1])}}else return k();return null}return{calcDistance:function(a,h){if(m(a)||m(h))return 0;var i=(h.lat-a.lat)*D>>1,x=(h.lon-a.lon)*D>>1;i=la(i)*la(i)+sa(a.lat*D)*sa(h.lat*D)*la(x)*la(x);return 6371*2*aa(da(i),da(1-i))},copy:g,empty:m,equal:function(a,h){return a&&h&&a.lat==h.lat&&a.lon==h.lon},fromMercatorPixels:function(a,h){return k(c(h),e(a))},generalize:function(a,h,i){var x=a.length,J=[],fa=null;i||(i=250);i/=1E3;
COG.info("generalizing positions, must include "+h.length+" positions");for(var ga=x;ga--;)if(ga===0)J.unshift(a[ga]);else{var Ba=!fa||pa.inArray(a[ga],h)?i:pa.calcDistance(fa,a[ga]);if(a[ga]&&Ba>=i){J.unshift(a[ga]);fa=a[ga]}}COG.info("generalized "+x+" positions into "+J.length+" positions");return J},inArray:function(a,h){for(var i=pa.equal,x=h.length;x--;)if(i(a,h[x]))return true;return false},inBounds:function(a,h){var i=!(pa.empty(a)||pa.empty(h));return i=(i=i&&a.lat>=h.min.lat&&a.lat<=h.max.lat)&&
a.lon>=h.min.lon&&a.lon<=h.max.lon},init:k,offset:function(a,h,i){var x=a.lat*D;a=a.lon*D;h=x+h/6371;i=$(la(i/6371)/sa(x));i=a+i;h=(h+b)%Math.PI-b;i%=H;return k(h*Q,i*Q)},parse:C,parseArray:function(a){var h=a.length,i=Array(h);for(h=h;h--;)i[h]=C(a[h]);return i},toMercatorPixels:function(a){return T5.XY.init(f(a.lon),r(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,h){function i(){for(var ga=0,Ba=h.chunkSize,Ja=x;Ja--;){J[Ja]=T5.GeoXY.init(a[Ja]);ga+=1;if(ga>Ba)break}x=
Ja;if(x<=0)h.callback&&h.callback(J);else COG.animFrame(i)}var x=a.length,J=Array(x);h=COG.extend({chunkSize:500,async:true,callback:null},h);if(!h.async){for(var fa=x;fa--;)J[fa]=T5.GeoXY.init(a[fa]);return J}COG.animFrame(i);return null}}}(),Xa=function(){function g(a,h,i){var x=T5.XY.init(0,h.lat-a.lat);if(typeof i==="undefined")i=true;x.x=i&&a.lon>h.lon?360-a.lon+h.lon:h.lon-a.lon;return x}function m(a,h){return Xa.init(pa.init(a.min.lat-h,a.min.lon-h%360),pa.init(a.max.lat+h,a.max.lon+h%360))}
function k(a){var h=g(a.min,a.max);return pa.init(a.min.lat+(h.y>>1),a.min.lon+(h.x>>1))}function C(a,h){return{min:pa.parse(a),max:pa.parse(h)}}return{calcSize:g,createBoundsFromCenter:function(a,h){var i=h/6371,x=a.lat*D,J=a.lon*D,fa=x-i,ga=x+i;if(fa>wa&&ga<U){x=$(la(i)/sa(x));i=(J-x)%H;J=(J+x)%H}else{fa=N(fa,wa);ga=B(ga,U);i=Za;J=H}return Xa.init(pa.init(fa*Q,i*Q),pa.init(ga*Q,J*Q))},expand:m,forPositions:function(a,h){var i=null,x=T5.ticks();h||(h="auto");for(var J=a.length;J--;)if(i){var fa=
g(i.min,a[J],false),ga=g(a[J],i.max,false);if(fa.x<0)i.min.lon=a[J].lon;if(fa.y<0)i.min.lat=a[J].lat;if(ga.x<0)i.max.lon=a[J].lon;if(ga.y<0)i.max.lat=a[J].lat}else i=C(a[J],a[J]);if(h){if(h=="auto"){J=g(i.min,i.max);h=N(J.x,J.y)*0.3}i=m(i,h)}COG.trace("calculated bounds for "+a.length+" positions",x);return i},getCenter:k,getGeoHash:function(a){var h=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+h+", max hash = "+a)},getZoomLevel:function(a,
h){var i=k(a);i=B(ra(u(i.lat)*0.05),l.length);var x=l[i],J=g(a.min,a.max);i=t(ea(l[3]*h.height/J.y)/ea(2));x=t(ea(x*h.width/J.x)/ea(2));return B(isNaN(i)?1E3:i,isNaN(x)?1E3:x)},init:C,isEmpty:function(a){return!a||pa.empty(a.min)||pa.empty(a.max)},toString:function(a){return"min: "+pa.toString(a.min)+", max: "+pa.toString(a.max)}}}(),cb=function(){var g=/^(\d+).*$/,m=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(k,C){g.lastIndex=-1;if(g.test(k))for(var a=k.replace(g,"$1"),h=C.split(","),i=0;i<
h.length;i++){m.lastIndex=-1;if(m.test(h[i])){var x=m.exec(h[i]);if(a>=parseInt(x[1],10)&&a<=parseInt(x[2],10))return true}else if(a==h[i])return true}return false},normalize:function(k){if(!k)return"";k=k.toUpperCase();if(!Ea){var C=[];for(var a in db)C.push(a);Ea=RegExp("(\\s)("+C.join("|")+")(\\s|$)","i")}Ea.lastIndex=-1;if(C=Ea.exec(k))k=k.replace(Ea,"$1"+db[C[2]]);return k},toString:function(k){return k.streetDetails+" "+k.location}}}(),ca=Wa.GeoXY=function(){function g(k,C){if(k.length){for(var a,
h,i,x,J=k.length;J--;){g(k[J],C);a=typeof a==="undefined"||k.x<a?k.x:a;h=typeof h==="undefined"||k.y<h?k.y:h;i=typeof i==="undefined"||k.x>i?k.x:i;x=typeof x==="undefined"||k.y>x?k.y:x}return w.init(a,h,x,x)}else if(k.mercXY){a=k.mercXY;k.x=(a.x+Math.PI)/C|0;k.y=(Math.PI-a.y)/C|0;k.rpp=C}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return k}function m(k,C,a){k.pos=C;k.mercXY=pa.toMercatorPixels(C);(a=typeof a!=="undefined"?a:k.rpp)&&g(k,a)}return{init:function(k,C){var a=L.init();
m(a,k,C);return a},sync:g,toPos:function(k,C){C=C?C:self.rpp;return pa.fromMercatorPixels(k.x*C-Math.PI,Math.PI-k.y*C)},updatePos:m}}(),ya={},Fa=function(){return{bestResults:function(g,m){m||(m=20);for(var k=g.length>0?g[0]:null,C=[],a=0;a<g.length;a++)if(k&&g[a]&&k.matchWeight-g[a].matchWeight<=m)C.push(g[a]);else break;return C}}}(),qa=function(g){g=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},g);return COG.extend(g,{toString:function(){return g.caption+(g.matchWeight?
" ("+g.matchWeight+")":"")}})},ub=function(){function g(a,h){var i=a.getDimensions();i=new fb({data:h,width:i.width,height:i.height});a.setLayer("route",i)}function m(a){for(var h=k.Unknown,i=C,x=0;x<i.length;x++){i[x].regex.lastIndex=-1;var J=i[x].regex.exec(a);if(J){h=i[x].customCheck?i[x].customCheck(a,J):i[x].turnType;break}}return h}var k={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",
TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},C=function(){var a=[];a.push({regex:/continue/i,turnType:k.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(h,i){return/bear/i.test(i[1])?k.TurnLeftSlight:k.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(h,i){return/bear/i.test(i[1])?
k.TurnRightSlight:k.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:k.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:k.Ramp});a.push({regex:/take.*?exit/i,turnType:k.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(h,i){return/right/i.test(i[1])?k.UTurnRight:k.UTurnLeft}});a.push({regex:/proceed/i,turnType:k.Start});a.push({regex:/arrive/i,turnType:k.Arrive});a.push({regex:/fell\sthrough/i,turnType:k.Merge});return a}();return{calculate:function(a){a=COG.extend({engineId:"",
waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var h=d("route");h&&h.route(a,function(i){if(a.generalize)i.geometry=pa.generalize(i.geometry,i.getInstructionPositions());if(a.map){g(a.map,i);a.autoFit&&a.map.gotoBounds(i.boundingBox)}a.success&&a.success(i)})},createMapOverlay:g,parseTurnType:m,TurnType:k,Instruction:function(a){var h=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),i=a.description;i=i.replace(/(\w)(\/)(\w)/g,
"$1 $2 $3");h.description=i;if(!a.turnType)a.turnType=m(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=Xa.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var h=[],i=0;i<a.instructions.length;i++)a.instructions[i].position&&h.push(a.instructions[i].position);return h}},a)}}}(),tb="featurecollection",ib="feature",va={async:false},ta={processor:null,group:"shapes",layerClass:Db},
Ta={point:COG.extend({},ta,{processor:function(g,m,k,C){m=o([m.coordinates],va);if(m.length>0)if(k=C.marker(m[0],k)){g.add(k);return m.length}},group:"markers",layerClass:vb}),linestring:COG.extend({},ta,{processor:function(g,m,k,C){m=o(m&&m.coordinates?m.coordinates:[]);return v(g,m,k,C)}}),multilinestring:COG.extend({},ta,{processor:function(g,m,k,C){m=m&&m.coordinates?m.coordinates:[];for(var a=0,h=m.length;h--;)a+=v(g,m[h],k,C);return a}}),polygon:COG.extend({},ta,{processor:function(g,m,k,C){m=
m&&m.coordinates?m.coordinates:[];if(m.length>0)return s(g,m[0],k,C);return 0}}),multipolygon:COG.extend({},ta,{processor:function(g,m,k,C){m=m&&m.coordinates?m.coordinates:[];for(var a=0,h=0;h<m.length;h++)a+=s(g,m[h][0],k,C);return a}})},Ua=function(g,m,k,C){function a(S,V){var ka=S.processor,xa=fa+S.group,Ya=COG.extend({},S,k,{properties:V.properties});if(ka){var ja=O[xa];if(!ja){ja=new S.layerClass({id:xa});O[xa]=ja}globalLayers=O;return ka(ja,V.data,Ya,C)}return 0}function h(S,V){var ka=S&&S.type?
S.type.toLowerCase():null;return ka&&ka===ib?h(S.geometry,S.properties):{type:ka,isCollection:ka?ka===tb:false,definition:Ta[ka],data:S,properties:V?V:S.properties}}function i(){var S=0,V=ga;if(!Ja){for(;V<Ba;V++){var ka=h(J?J(g[V]):g[V]),xa=null;if(ka.isCollection){T+=1;Ja=z(ka.data.features,function(Ya){Ja=null;for(var ja in Ya)O[ja]=Ya[ja]},{layerPrefix:fa+T+"-"});xa+=1}else if(ka.definition)xa=a(ka.definition,ka);S+=xa?xa:1;if(S>=x)break}ga=V+1;if(Ja||ga<Ba)COG.animFrame(i);else m&&m(O)}}k=COG.extend({vectorsPerCycle:Ra.VECTORIZE_PER_CYCLE,
rowPreParse:null,simplify:false,layerPrefix:"geojson-"},k);C=COG.extend({marker:function(S){return new wb({xy:S})},line:function(S,V){return new xb(S,V)},poly:function(S,V){return new xb(S,COG.extend({fill:true},V))}},C);var x=k.vectorsPerCycle,J=k.rowPreParse,fa=k.layerPrefix,ga=0,Ba=0,Ja=null,T=0,O={};if(g){if(typeof g.length==="undefined")g=[g];Ba=g.length;COG.animFrame(i)}};Wa.GeoJSON={parse:z};Wa.Map=function(g){function m(O){try{var S=Ra.Position.init(O.coords.latitude,O.coords.longitude),V=
O.coords.accuracy/1E3;T.trigger("locationUpdate",O,V);if(ga){if(!J){J=new Ra.UI.LocationOverlay({pos:S,accuracy:V});J.update(T.getTileLayer());T.setLayer("location",J)}var ka=Ra.BoundingBox.createBoundsFromCenter(S,Math.max(V,1));T.gotoBounds(ka)}else{J.pos=S;J.accuracy=V;J.update(T.getTileLayer());a(S,null,COG.easing("sine.out"))}ga=false}catch(xa){COG.exception(xa)}}function k(O){COG.info("caught location tracking error:",O)}function C(O,S,V){COG.endTweens();T.setZoomLevel(S);a(O,V)}function a(O,
S,V,ka){O=ca.init(O,Ra.radsPerPixel(T.getZoomLevel()));var xa=T.getDimensions();T.updateOffset(O.x-(xa.width>>1),O.y-(xa.height>>1),V,ka,function(){T.refresh();T.trigger("boundsChange",T.getBoundingBox());S&&S(T)})}g=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},g);var h={NONE:0,SINGLE:1,WATCH:2},i=L.init(),x=h.NONE,J=null,fa=0,ga=true,Ba=0,Ja=g.tapExtent;g.adjustScaleFactor=function(O){return Math.pow(2,(O<1?Math.floor:Math.ceil)(Math.log(O)))};var T=COG.extend(new Ab(g),
{getBoundingBox:function(){var O=T.getViewRect();return Ra.BoundingBox.init(ca.toPos(L.init(O.x1,O.y2),Ba),ca.toPos(L.init(O.x2,O.y1),Ba))},getCenterPosition:function(){var O=T.getViewRect();if(O){O=L.init(O.x1+(O.width>>1),O.y1+(O.height>>1));return ca.toPos(O,Ba)}return null},gotoBounds:function(O,S){var V=Ra.BoundingBox.getZoomLevel(O,T.getDimensions());C(Ra.BoundingBox.getCenter(O),V,S)},gotoPosition:C,panToPosition:a,syncXY:function(O){return ca.sync(O,Ba)},locate:function(){T.trackStart(h.SINGLE);
setTimeout(T.trackCancel,1E4)},trackStart:function(O){if(navigator.geolocation&&!fa){x=O?O:h.WATCH;ga=true;fa=navigator.geolocation.watchPosition(m,k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){fa&&navigator.geolocation&&navigator.geolocation.clearWatch(fa);T.removeLayer("location");J=null;x=h.NONE;fa=0},animateRoute:function(O,S,V,ka){var xa=T.getLayer("route");if(xa)(O=xa.getAnimation(O,S,V,ka))&&O.addToView(T)}});T.bind("pan",function(){x===h.SINGLE&&T.trackCancel()});
T.bind("tap",function(O,S,V,ka){var xa=Ra.radsPerPixel(T.getZoomLevel());O=ca.toPos(ka,xa);var Ya=ca.toPos(L.offset(ka,-Ja,Ja),xa);ka=ca.toPos(L.offset(ka,Ja,-Ja),xa);T.trigger("geotap",S,V,O,Xa.init(Ya,ka))});T.bind("refresh",function(){if(L.absSize(L.diff(i,T.getOffset()))>g.boundsChangeThreshold){i=L.copy(T.getOffset());T.trigger("boundsChange",T.getBoundingBox())}});Qa(T,g);T.bind("zoomLevelChange",function(O,S){var V;Ba=Ra.radsPerPixel(S);V=H/Ba|0;T.setMaxOffset(V,V,true,false);Ga.cancelLoad();
T.resetScale();T.triggerAll("resync",T);T.refresh()});return T};Wa.GeoShape=function(g,m){m=COG.extend({autoParse:true},m);for(var k=Array(g.length),C=m.autoParse,a=T5.Geo.Position.parse,h=g.length;h--;)k[h]=T5.GeoXY.init(C?a(g[h]):g[h]);return new T5.Poly(k,m)};var fb=Wa.RouteOverlay=function(g){g=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},g);var m=[],k=[],C=new T5.PathLayer(g);(function(){if(g.data&&
g.data.instructions){for(var a=g.data.instructions,h=Array(a.length),i=a.length;i--;)h[i]=a[i].position;pa.vectorize(h,{callback:function(x){k=x}})}g.data&&g.data.geometry&&pa.vectorize(g.data.geometry,{callback:function(x){m=x;C.updateCoordinates(m,k,true)}})})();return C};Wa.LocationOverlay=function(g){g=COG.extend({pos:null,accuracy:null,zindex:90},g);var m=new Image,k=T5.XY.init(),C=T5.XY.init(),a=null;m.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
m.onload=function(){k=T5.XY.init(m.width>>1,m.height>>1)};var h=COG.extend(new T5.ViewLayer(g),{pos:g.pos,accuracy:g.accuracy,drawAccuracyIndicator:false,draw:function(i,x){var J=C.x-x.x,fa=C.y-x.y;if(a){i.fillStyle="rgba(30, 30, 30, 0.2)";i.beginPath();i.arc(J,fa,a,0,Math.PI*2,false);i.fill()}m.complete&&m.width>0&&i.drawImage(m,J-k.x,fa-k.y,m.width,m.height);h.changed()},update:function(i){if(i){a=i.getPixelDistance(h.accuracy)>>1;C=i.getGridXYForPosition(h.pos);h.changed()}}});h.bind("gridUpdate",
function(i,x){h.update(x)});return h};return{distanceToString:function(g){if(g>1E3)return~~(g/10)/100+" km";return g?g+" m":""},dist2rad:function(g){return g/6371},getEngine:d,lat2pix:r,lon2pix:f,pix2lat:c,pix2lon:e,radsPerPixel:function(g){return H/(256<<g)},Position:pa,BoundingBox:Xa,Radius:function(g,m){return{distance:parseInt(g,10),uom:m}},Address:function(g){return g=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},g)},A:cb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(g){if(!g.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var m=COG.extend({remove:function(){delete ya[m.id]}},g);return ya[m.id]=m},Search:Fa,GeoSearchResult:qa,LocationSearch:function(g){function m(i,x){navigator.geolocation.clearWatch(C);C=0;if(a){clearTimeout(a);a=0}x&&x([i],g)}function k(i){COG.info("caught location tracking error:",i)}g=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},g);var C=0,a=0,h=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(i,x){if(navigator.geolocation&&!C){C=navigator.geolocation.watchPosition(function(J){var fa=pa.init(J.coords.latitude,J.coords.longitude);J=new qa({id:1,caption:"Current Location",pos:fa,accuracy:J.coords.accuracy/1E3,matchWeight:100});if(!h||J.accuracy<h.accuracy)h=J;if(!g.requiredAccuracy||h.accuracy<g.requiredAccuracy)m(h,x)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)a=
setTimeout(function(){h&&m(h,x)},g.searchTimeout)}}},g))},Routing:ub}}();return Wa}();
