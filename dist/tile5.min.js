COG=function(){var l=/\$\{(.*?)\}/ig,n=Object.prototype.hasOwnProperty,m=0,f={id:"grunt.core",extend:function(){var a=arguments[0]||{},b=1,h=arguments.length,d=false,o,e,k,g;if(typeof a==="boolean"){d=a;a=arguments[1]||{};b=2}if(typeof a!=="object"&&!f.isFunction(a))a={};if(h===b){a=this;--b}for(;b<h;b++)if((o=arguments[b])!=null)for(e in o){k=a[e];g=o[e];if(a!==g)if(d&&g&&(f.isPlainObject(g)||f.isArray(g))){k=k&&(f.isPlainObject(k)||f.isArray(k))?k:f.isArray(g)?[]:{};a[e]=f.extend(d,k,g)}else if(g!==
undefined)a[e]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return false;var b;for(b in a);return b===undefined||n.call(a,b)},isEmptyObject:function(a){for(var b in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,b){var h=a,d=arguments,o=1;if(b&&f.isArray(b)){d=b;o=0}for(o=o;o<d;o++)h=h&&typeof foo[d[o]]!=="undefined";return h},newModule:function(a){a=f.extend({id:null,requires:[],parent:null},a);if(a.parent)a=f.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+m++},formatStr:function(a){if(arguments.length<=1)return a;for(var b=arguments.length-2,h=0;h<=b;h++)a=a.replace(RegExp("\\{"+h+"\\}","gi"),arguments[h+
1]);return a},wordExists:function(a,b){var h="";if(b.toString)b=b.toString();for(var d=0;d<b.length;d++)h+=!/\w/.test(b[d])?"\\"+b[d]:b[d];return RegExp("(^|\\s|\\,)"+h+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,b){for(var h=l.exec(a);h;){a=a.replace(h[0],COG.XPath.first(h[1],b));l.lastIndex=0;h=l.exec(a)}return a}};return f}();
COG.Log=function(){function l(b,h){var d,o=h&&h.length>0?h[0]:"";for(d=1;h&&d<h.length;d++)o+=" "+(m&&COG.isPlainObject(h[d])?JSON.stringify(h[d]):h[d]);typeof console!=="undefined"&&console[b](o);for(d=0;d<n.length;d++)n[d].call(a,o,b)}var n=[],m=typeof JSON!=="undefined",f=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return f?(new Date).getTime():null},trace:function(b,h){if(f)console.markTimeline(b+(h?": "+(a.getTraceTicks()-h)+"ms":""))},debug:function(){l("debug",
arguments)},info:function(){l("info",arguments)},warn:function(){l("warn",arguments)},error:function(){l("error",arguments)},exception:function(b){a.error(arguments);for(var h in b)a.info("ERROR DETAIL: "+h+": "+b[h])},watch:function(b,h){try{h()}catch(d){a.exception(d,b)}},throwError:function(b){a.error(b);throw Error(b);},requestUpdates:function(b){n.push(b)}};return a}();
(function(){function l(f,a){f[a]||(f[a]=function(b){return f.configure(a,b)})}function n(f){f.gtConfId=COG.objId("configurable");f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var m={};COG.paramTweaker=function(f,a,b){return function(h,d){if(typeof d!=="undefined"){if(h in f)f[h]=d;b&&h in b&&b[h](h,d)}else return a&&h in a?a[h](h):f[h]}};COG.configurable=function(f,a,b,h){if(f){f.gtConfId||n(f);var d=f.gtConfId,o=f.gtConfig,e=f.gtConfigFns;m[d]=f;e.push(b);for(b=a.length;b--;){o[a[b]]=true;h&&
l(f,a[b])}if(!f.configure)f.configure=function(k,g){if(o[k]){for(var q=e.length;q--;){var v=e[q](k,g);if(typeof v!=="undefined")return v}return m[d]}return null}}}})();
(function(){function l(n,m){var f=n.gtObsHandlers;f[m]||(f[m]=[]);return f[m]}COG.observable=function(n){if(n){if(!n.gtObsHandlers)n.gtObsHandlers={};if(!(n.bind||n.trigger||n.unbind)){n.bind=function(m,f){var a=COG.objId("callback");l(n,m).unshift({fn:f,id:a});return a};n.trigger=function(m){var f=l(n,m),a={cancel:false,tickCount:(new Date).getTime()},b;if(!f)return null;b=Array.prototype.slice.call(arguments,1);b.unshift(a);for(var h=f.length;h--&&!a.cancel;)f[h].fn.apply(self,b);return a};n.unbind=
function(m,f){for(var a=l(n,m),b=0;a&&b<a.length;b++)if(a[b].id===f){a.splice(b,1);break}return n}}}}})();(function(){var l={},n=[];COG.addPipe=function(m){m("pipe.test",{});n.push(m)};COG.listen=function(m,f){l[m]||(l[m]=[]);f&&l[m].push(f)};COG.say=function(m,f){var a;for(a=n.length;a--;)n[a](m,f);if(l[m])for(a=l[m].length;a--;)l[m][a](f)}})();
COG.Loopage=function(){function l(g){return COG.extend({id:b++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function n(g){d.push(g);m()}function m(){o&&clearTimeout(o);o=setTimeout(f,0);k=true}function f(){for(var g,q=(new Date).getTime(),v=h.length;d.length>0;){var y=d.shift();for(g=v;g--;)if(h[g].id===y){h.splice(g,1);break}k=true;v=h.length}if(k){e=a;for(g=v;g--;)e=h[g].frequency<e?h[g].frequency:e}for(g=v;g--;){y=q-h[g].lastTick;if(h[g].lastTick===0||y>=h[g].frequency){h[g].execute(q,
h[g]);h[g].lastTick=q;h[g].single&&h[g].trigger("complete")}}o=v?setTimeout(f,e):0}var a=6E4,b=0,h=[],d=[],o=0,e=a,k=true;return{join:function(g){var q=new l(g);if(q.after>0)q.lastTick=(new Date).getTime()+q.after;COG.observable(q);q.bind("complete",function(){n(q.id)});h.unshift(q);m();return q},leave:n}}();if(!this.JSON)this.JSON={};
(function(){function l(e){return e<10?"0"+e:e}function n(e){a.lastIndex=0;return a.test(e)?'"'+e.replace(a,function(k){var g=d[k];return typeof g==="string"?g:"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function m(e,k){var g,q,v,y,w=b,t,u=k[e];if(u&&typeof u==="object"&&typeof u.toJSON==="function")u=u.toJSON(e);if(typeof o==="function")u=o.call(k,e,u);switch(typeof u){case "string":return n(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";b+=h;t=[];if(Object.prototype.toString.apply(u)==="[object Array]"){y=u.length;for(g=0;g<y;g+=1)t[g]=m(g,u)||"null";v=t.length===0?"[]":b?"[\n"+b+t.join(",\n"+b)+"\n"+w+"]":"["+t.join(",")+"]";b=w;return v}if(o&&typeof o==="object"){y=o.length;for(g=0;g<y;g+=1){q=o[g];if(typeof q==="string")if(v=m(q,u))t.push(n(q)+(b?": ":":")+v)}}else for(q in u)if(Object.hasOwnProperty.call(u,q))if(v=m(q,u))t.push(n(q)+(b?": ":":")+v);v=t.length===0?"{}":b?"{\n"+b+t.join(",\n"+b)+
"\n"+w+"}":"{"+t.join(",")+"}";b=w;return v}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,h,d={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;if(typeof JSON.stringify!=="function")JSON.stringify=function(e,k,g){var q;h=b="";if(typeof g==="number")for(q=0;q<g;q+=1)h+=" ";else if(typeof g==="string")h=g;if((o=k)&&typeof k!=="function"&&(typeof k!=="object"||typeof k.length!=="number"))throw Error("JSON.stringify");return m("",
{"":e})};if(typeof JSON.parse!=="function")JSON.parse=function(e,k){function g(v,y){var w,t,u=v[y];if(u&&typeof u==="object")for(w in u)if(Object.hasOwnProperty.call(u,w)){t=g(u,w);if(t!==undefined)u[w]=t;else delete u[w]}return k.call(v,y,u)}var q;e=String(e);f.lastIndex=0;if(f.test(e))e=e.replace(f,function(v){return"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){q=eval("("+e+")");return typeof k==="function"?g({"":q},""):q}throw new SyntaxError("JSON.parse");}})();
(function(){function l(m,f){var a=m.split("|"),b={};for(var h in f){var d=f[h];b[h]=a.length>d?a[d]:null}return b}var n={JSON:{parse:function(m){return JSON.parse(m)}},PDON:{parse:function(m){var f=null,a=[];m=m.split("\n");for(var b=0;b<m.length;b++){var h=m[b];if(f)a.push(l(h,f));else if(h){f=h.split("|");h={};for(var d=0;d<f.length;d++)h[f[d]]=d;f=h}else f=null}return a}}};COG.parseData=function(m,f){f=f?f.toUpperCase():"JSON";if(!n[f])throw Error("Unsupported data format: "+f);try{return n[f].parse(m)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function l(a){for(var b=null,h=0;h<n.length;h++)if(b=n[h](a))break;return b}var n=[],m=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var f={SearchResult:function(a){return{toString:function(){var b=
null;if(a){var h=null;if(a.resultType>=0&&a.resultType<m.length)h=m[a.resultType];if(h)b=h(a)}return b?b:""}}},first:function(a,b){var h=f.SearchResult,d;var o=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!o)o=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(b))d=b.evaluate(a,b,l,o,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");d=null}}catch(e){COG.Log.warn("invalid xpath expression: "+a+" on node: "+b);d=null}return new h(d)},registerResolver:function(a){n.push(a)}};return f}();
COG.Storage=function(){function l(n){if(n&&n=="session")return sessionStorage;return localStorage}return{get:function(n,m){var f=l(m).getItem(n);return/^(\{|\[).*(\}|\])$/.test(f)?JSON.parse(f):f},set:function(n,m,f){m=jQuery.isArray(m)||jQuery.isPlainObject(m)?JSON.stringify(m):m;l(f).setItem(n,m)},remove:function(n,m){l(m).removeItem(n)}}}();
COG.ParseRules=function(){var l=[];return{add:function(n,m){l.push({regex:n,handler:m})},each:function(n,m,f){function a(){b++;f&&b>=l.length&&f(m)}for(var b=0,h=0;h<l.length;h++){var d=l[h].regex,o=l[h].handler,e=false;if(d){d.lastIndex=-1;if((d=d.exec(n))&&o){e=true;o(d,m,a)&&a()}}e||a()}}}};
(function(){function l(d){var o=[],e=function(g,q){q=COG.isFunction(q)?q():q;o[o.length]=encodeURIComponent(g)+"="+encodeURIComponent(q)};if(COG.isArray(d))for(var k=0;k<d.length;k++)e(d[k].name,d[k].value);else for(k in d)e(k,d[k]);return o.join("&").replace(/%20/g,"+")}var n={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},m={JSON:["json"],PDON:["pdon.txt"]},f=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,b={XML:function(d){return d.responseXML},JSON:function(d){return COG.parseData(d.responseText)},
PDON:function(d){return COG.parseData(d.responseText,"PDON")},DEFAULT:function(d){return d.responseText}},h={CONTENT_TYPE:"Content-Type"};COG.xhr=function(d){function o(){if(this.readyState===4){var q=null,v=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(v)if(d.handleResponse)d.handleResponse(this);else{var y=d,w=this.getResponseHeader(h.CONTENT_TYPE),t,u=false;for(t in n)if(w&&w.indexOf(n[t])>=0){u=true;
break}w=!u;for(u=0;u<f.length;u++)w=w||f[u]==t;if(w)b:{w=t;for(var A in m)for(u=0;u<m[A].length;u++)if(RegExp(m[A][u]+"$","i").test(y.url)){t=A;break b}t=w?w:"DEFAULT"}try{q=b[t](this,y)}catch(C){q=b.DEFAULT(this,y)}}else d.error&&d.error(this)}catch(I){COG.Log.exception(I,"PROCESSING AJAX RESPONSE")}v&&q&&d.success&&d.success.call(this,q)}}try{d=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},d);var e=
a.exec(d.url),k=e&&(e[1]&&e[1]!==location.protocol||e[2]!==location.host);if(d.data)d.method="POST";if(d.url){e=null;if(d.xhr)e=d.xhr(d);e||(e=new XMLHttpRequest);e.open(d.method,d.url,d.async);d.data&&e.setRequestHeader("Content-Type",d.contentType);k||e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.onreadystatechange=o;e.send(d.method=="POST"?l(d.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function l(a){var b=document.createElement("script"),h=false;b.src=a;b.async=true;b.onload=b.onreadystatechange=function(){if(!h&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){h=true;b.onload=b.onreadystatechange=null;b&&b.parentNode&&b.parentNode.removeChild(b)}};m||(m=document.getElementsByTagName("head")[0]);m.appendChild(b)}var n=0,m,f=this;COG.jsonp=function(a,b,h){a+=a.indexOf("?")>=0?"&":"?";var d="json"+ ++n;f[d]=function(o){b(o);f[d]=null;try{delete f[d]}catch(e){}};
l(a+(h?h:"callback")+"="+d);return d}})();
COG.Touch=function(){function l(s,p){return{x:s.x-p.x,y:s.y-p.y}}function n(s,p){var r=l(s,p);return Math.sqrt(r.x*r.x+r.y*r.y)}function m(s){if(s.count>1)return n(s.touches[0],s.touches[1]);return 0}function f(s,p){var r=s&&s.count>0?s.touches[0]:null;if(r&&p&&p.count>0)return l(r,p.touches[0]);return null}function a(s,p){s.count=p.count;for(var r=e;r--;){s.touches[r].x=p.touches[r].x;s.touches[r].y=p.touches[r].y}}function b(){for(var s={count:0,touches:Array(e)},p=e;p--;)s.touches[p]=o();return s}
function h(s){if(s.preventDefault){s.preventDefault();s.stopPropagation()}else s.cancelBubble&&s.cancelBubble()}function d(s,p,r){if(L){p=p[r?r:"touches"];r=p.length;for(r=s.count=r;r--;){s.touches[r].x=p[r].pageX;s.touches[r].y=p[r].pageY}}else if(p.button===0){s.count=1;s.touches[0].x=p.pageX?p.pageX:p.screenX;s.touches[0].y=p.pageY?p.pageY:p.screenY}else s.count=0}function o(s,p){return{x:s?s:0,y:p?p:0}}var e=10,k=120,g=100,q=250,v=300,y=5,w=0,t=1,u=2,A=7,C=0,I=0,L=undefined,Q=function(s){function p(G,
F,x,B){var H=Math.asin((G.y-F.y)/x);x=x*(oa/B)>>0;x=x>ka?ka:x;H=F.x>G.x?H:Math.PI-H;E("pan",Math.cos(H)*-x,Math.sin(H)*x,true)}function r(G,F){var x,B;if(L){x=F-pa;if(x<q){B=n(T.touches[0],G);B>s.inertiaTrigger&&p(T.touches[0],G,B,x)}}else{ba.x=G.x;ba.y=G.y;COG.Loopage.join({execute:function(H,M){x=H-F;B=n(G,ba);if(x<g&&B>s.inertiaTrigger){M.trigger("complete");p(G,ba,B,x)}else x>g&&M.trigger("complete")},frequency:10})}}function z(G){var F=0,x=0;if(G.offsetParent){do{F+=G.offsetLeft;x+=G.offsetTop;
G=G.offsetParent}while(G)}return o(F,x)}function D(G){var F=G.count,x=Array(F),B=z(ca);for(F=F;F--;)x[F]=o(G.touches[F].x-B.x,G.touches[F].y-B.y);return x}function E(){Z&&Z.trigger.apply(null,arguments)}function J(G,F){var x=z(ca);x=o(F.x-x.x,F.y-x.y);E(G,F,x)}function K(G){var F=G.target?G.target:G.srcElement;if(la||F&&F===ca){d(T,G);if(T.count!==0){fa=null;P.x=0;P.y=0;ma=true;qa=false;pa=(new Date).getTime();h(G);F.style.cursor="move";E("inertiaCancel");ja=pa;if(G=T.count>0?T.touches[0]:null){E("touchStart",
G.x,G.y);if(ja-ga<v)if((G=l(T.touches[0],ha.touches[0]))&&Math.abs(G.x)<s.maxDistDoubleTap&&Math.abs(G.y)<s.maxDistDoubleTap)qa=true;da=w;a(ha,T)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function U(G){var F=G.target?G.target:G.srcElement,x=0;if(la||F&&F===ca){d(V,G);if(V.count>0){ba.x=V.touches[0].x;ba.y=V.touches[0].y}if(ma){L&&h(G);if(V.count>1){T.count===1&&a(T,V);x=m(T)-m(V)}if(da===w)if((G=f(V,T))&&(Math.abs(G.x)>=A||Math.abs(G.y)>=A))da=t;if(da!==w)if(!x||Math.abs(x)<
y){if(fa=f(V,ha)){P.x-=fa.x;P.y-=fa.y;ia.x-=fa.x;ia.y-=fa.y}E("pan",ia.x,ia.y);ia.x=0;ia.y=0;da=t}else{E("pinchZoom",D(T),D(V));da=u}a(ha,V)}}}function aa(G){var F=G.target?G.target:G.srcElement;if(ma&&(la||F&&F===ca)){d(ra,G,"changedTouches");var x=ra.touches[0];L&&h(G);G=(new Date).getTime();ga=ja;if(da===w){J("tap",T.touches[0]);$||($=setTimeout(function(){$=0;qa&&J("doubleTap",T.touches[0])},v+50))}else if(da==t){E("panEnd",P.x,P.y);na&&r(x,G)}else da==u&&E("pinchZoomEnd",D(T),D(ha),G-pa);F.style.cursor=
"default";ma=false}}function X(G){var F=G.target?G.target:G.srcElement;if(la||F&&F===ca){if(G.detail){F=-G.detail*k;F=o(G.axis===1?F:0,G.axis===2?F:0)}else F=o(G.wheelDeltaX,G.wheelDeltaY);var x=F.y!==0?Math.abs(F.y/k):0;if(ba&&x!==0){var B=o(ba.x-ca.offsetLeft,ba.y-ca.offsetTop);E("wheelZoom",B,Math.pow(2,F.y>0?x:-x))}h(G)}}s=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,
tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},s);var qa=false,$=0,S=T5.getConfig(),T=b(),V=b(),ha=b(),ra=b(),fa=null,P=o(),ia=o(),da=null,ma=false,pa=0,sa=[],ba=o(),na=false,oa,ka,ja=0,ga=0,ca=s.element,Z=s.observable,la=typeof FlashCanvas!=="undefined",ta={supportsTouch:L,addListeners:function(G){sa.push(G)},decoupleListeners:function(G){for(var F=0;G&&F<sa.length;F++)if(sa[F].listenerId===G){sa.splice(F,1);break}},release:function(){S.unbindEvent(L?"touchstart":"mousedown",K,false);
S.unbindEvent(L?"touchmove":"mousemove",U,false);S.unbindEvent(L?"touchend":"mouseup",aa,false);if(!L){window.removeEventListener("mousewheel",X,false);window.removeEventListener("DOMMouseScroll",X,false)}},inertiaEnable:function(G,F){na=true;oa=G;ka=F?Math.min(F.width,F.height):500},inertiaDisable:function(){na=false}};if(typeof L==="undefined")L=T5.getConfig().supportsTouch;S.bindEvent(L?"touchstart":"mousedown",K,false);S.bindEvent(L?"touchmove":"mousemove",U,false);S.bindEvent(L?"touchend":"mouseup",
aa,false);if(!L){S.bindEvent("mousewheel",X,window);S.bindEvent("DOMMouseScroll",X,window)}return ta},N=[];return{capture:function(s,p){if(!s)throw Error("Unable to capture touch of null element");if(!s.id)s.id="touchable_"+C++;var r=N[s.id];if(!r){r=new Q(COG.extend({element:s},p));N[s.id]=r}if(p){p.listenerId&&r.decoupleListeners(p.listenerId);p.listenerId=++I;r.addListeners(p)}return r},release:function(s){if(s&&s.id&&N[s.id]){N[s.id].release();delete N[s.id]}}}}();
T5=function(){var l=function(){function b(o,e){return d(o.x-e.x,o.y-e.y)}function h(o,e){if(!e)e=o.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var k={edges:Array(e-1),accrued:Array(e-1),total:0},g=0;g<e-1;g++){var q=b(o[g],o[g+1]);k.edges[g]=Math.sqrt(q.x*q.x+q.y*q.y);k.accrued[g]=k.total+k.edges[g];k.total+=k.edges[g]}return k}function d(o,e){return{x:o?o:0,y:e?e:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var o=
0,e=0,k=arguments.length;k--;){o+=arguments[k].x;e+=arguments[k].y}return d(o,e)},absSize:function(o){return Math.max(Math.abs(o.x),Math.abs(o.y))},copy:function(o){return o?d(o.x,o.y):null},diff:b,distance:function(o,e){return h(o,e).total},edges:h,equals:function(o,e){return o.x===e.x&&o.y===e.y},extendBy:function(o,e,k){return d(o.x-Math.cos(e)*k,o.y-Math.sin(e)*k)},floor:function(o){for(var e=Array(o.length),k=o.length;k--;)e[k]=d(~~o[k].x,~~o[k].y);return e},getRect:function(o){for(var e,k,g,
q,v=o.length;v--;){var y=o[v];e=typeof e==="undefined"||y.x<e?y.x:e;k=typeof k==="undefined"||y.y<k?y.y:k;g=typeof g==="undefined"||y.x>g?y.x:g;q=typeof q==="undefined"||y.y>q?y.y:q}return m.init(e,k,g,q)},init:d,invert:function(o){return d(-o.x,-o.y)},min:function(o,e){return d(o.x<e.x?o.x:e.x,o.y<e.y?o.y:e.y)},max:function(o,e){return d(o.x>e.x?o.x:e.x,o.y>e.y?o.y:e.y)},offset:function(o,e,k){return d(o.x+e,o.y+(k?k:e))},simplify:function(o,e){if(!o)return null;e=e?e:l.VECTOR_SIMPLIFICATION;for(var k=
[],g=null,q=o.length;q--;){var v=o[q];if(include=!g||q===0||Math.abs(v.x-g.x)+Math.abs(v.y-g.y)>e){k.unshift(v);g=v}}return k},theta:function(o,e,k){k=Math.asin((o.y-e.y)/k);return o.x>e.x?k:Math.PI-k}}}(),n=function(){return{dotProduct:function(b,h){return b.x*h.x+b.y*h.y}}}(),m=function(){function b(d){return h(d.x1,d.y1,d.x2,d.y2)}function h(d,o,e,k){d=d?d:0;o=o?o:0;e=typeof e!=="undefined"?e:d;k=typeof k!=="undefined "?k:k;return{x1:d,y1:o,x2:e,y2:k,width:e-d,height:k-o}}return{center:function(d){return l.init(d.x1+
d.width/2,d.y1+d.height/2)},copy:b,diagonalSize:function(d){return Math.sqrt(d.width*d.width+d.height*d.height)},fromCenter:function(d,o,e,k){e=~~(e/2);k=~~(k/2);return h(d-e,o-k,d+e,o+k)},init:h,intersect:function(d,o){var e=h(Math.max(d.x1,o.x1),Math.max(d.y1,o.y1),Math.min(d.x2,o.x2),Math.min(d.y2,o.y2));return e.width>0&&e.height>0?e:null},union:function(d,o){if(d.width===0||d.height===0)return b(o);else if(o.width===0||o.height===0)return b(d);else{var e=h(Math.min(d.x1,o.x1),Math.min(d.y1,o.y1),
Math.max(d.x2,o.x2),Math.max(d.y2,o.y2));return e.width>0&&e.height>0?e:null}}}}(),f=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return l.init(b.width/2,b.height/2)},getSize:function(b){return Math.sqrt(Math.pow(b.width,2)+Math.pow(b.height,2))},init:function(b,h){b=b?b:0;return{width:b,height:h?h:b}}}}(),a={ex:COG.extend,ticks:function(){return(new Date).getTime()},userMessage:function(b,h,d){a.trigger("userMessage",b,h,d)},XY:l,XYRect:m,
Vector:function(b,h){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return l.init(b,h)},V:COG.extend(l,n),D:f};COG.observable(a);return a}();
(function(){function l(){for(;y.length>0;){var t=y.shift();document.location=t}v=0}function n(t){for(var u=true,A=w.length;A--;)u=u&&t!=w[A];return u}function m(t,u){var A=[];for(var C in u)C&&A.push(C+"="+escape(u[C]));return"tile5://"+t+"/"+(A.length>0?"?"+A.join("&"):"")}function f(t,u){n(t)&&COG.Log.info("would push url: "+m(t,u))}function a(t,u){if(n(t)){y.push(m(t,u));v||(v=setTimeout(l,100))}}function b(t){return function(u,A,C){(C?C:t?document.body:document).addEventListener(u,A,false)}}function h(t){return function(u,
A,C){(C?C:t?document.body:document).removeEventListener(u,A,false)}}function d(t,u,A){(A?A:document).attachEvent("on"+t,u)}function o(t,u,A){(A?A:document).detachEvent("on"+t,u)}function e(){k={base:{name:"Unknown",bindEvent:b(),unbindEvent:h(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:f,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:d,unbindEvent:o,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:b(true),unbindEvent:h(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[k.froyo,k.android,k.ipod,k.iphone,k.ipad,k.ie]}var k=null,g=[],q=null,v=0,y=[],w=["view.wake","tile.loaded"];T5.getConfig=function(){k||e();if(!q){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var t=0;t<g.length;t++){var u=g[t];if(u.regex&&u.regex.test(navigator.userAgent)){q=T5.ex({},k.base,u);COG.Log.info("PLATFORM DETECTED AS: "+q.name);break}}if(!q){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
q=k.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return q}})();
T5.Dispatcher=function(){var l=[],n={execute:function(m){var f=n.findAction(m);f&&f.execute.apply(f,Array.prototype.slice.call(arguments,1))},findAction:function(m){for(var f=l.length;f--;)if(l[f].id==m)return l[f];return null},getRegisteredActions:function(){return[].concat(l)},getRegisteredActionIds:function(){for(var m=[],f=l.length;f--;)l[f].id&&m.push(l[f].id);return m},registerAction:function(m){m&&m.id&&l.push(m)},Action:function(m){m=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},m);var f={id:m.id,execute:function(){m.execute&&m.execute.apply(this,arguments)},getParam:function(a){return m[a]?m[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",f.id,m.title,m.icon)}};m.autoRegister&&n.registerAction(f);return f},Agent:function(m){m=COG.extend({name:"Untitled",translator:null,execute:null},m);var f={getName:function(){return m.name},getParam:function(a){return m[a]},getId:function(){return COG.toID(f.getName())},run:function(a,b){if(m.execute){var h=
m.translator?m.translator(a):a;m.execute.call(f,h,function(d,o){b&&b(d,o,h)})}}};return f},runAgents:function(m,f,a){for(var b=0;b<m.length;b++)m[b].run(f,a)}};return n}();
T5.Resources=function(){var l="",n={},m={getPath:function(f){return/^(file|https?|\/)/.test(f)?f:l+f},setBasePath:function(f){l=f},loadResource:function(f){f=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},f);var a=function(b){f.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){f.callback(b)})};f.cacheable&&n[f.filename]?a(n[f.filename]):COG.xhr({url:m.getPath(f.filename),dataType:f.dataType,success:function(b){if(f.cacheable)n[f.filename]=b;a(b)},error:function(b,h,d){COG.Log.error("error loading resource ["+
f.filename+"], error = "+d)}})},loadSnippet:function(f,a){/\.\w+$/.test(f)||(f+=".html");m.loadResource({filename:"snippets/"+f,callback:a,dataType:"html"})}};return m}();
T5.Images=function(){function l(){if(!v){var t=T5.getConfig().maxImageLoads;v=COG.Loopage.join({execute:function(u,A){if(!t||k.length<t){var C=e.shift();if(C){k[k.length]=C;C.image.onload=m;C.image.src=T5.Resources.getPath(C.url);C.requested=T5.ticks()}else A.trigger("complete")}},frequency:10});v.bind("complete",function(){v=null})}}function n(){y=true;try{var t=g.length/2>>0;if(t>0){g.sort(function(A,C){return A.created-C.created});for(var u=t;u--;)delete b[g[u].url];g.splice(0,t)}}finally{y=false}COG.say("imagecache.cleared")}
function m(){var t=d[this.id],u;if(t&&t.image.complete&&t.image.width>0){t.loaded=true;t.hitCount=1;for(u=k.length;u--;)if(k[u].image.src==this.src){k.splice(u,1);break}if(t.background||t.postProcess||t.drawBackground||t.customDraw)if(t.image){globalImageData=t;u=a(t.realSize?t.realSize.width:t.image.width,t.realSize?t.realSize.height:t.image.height);var A=u.getContext("2d"),C=t.offset?t.offset:T5.XY.init();t.background&&A.drawImage(t.background,0,0);t.drawBackground&&t.drawBackground(A);t.customDraw?
t.customDraw(A,t):A.drawImage(t.image,C.x,C.y);t.postProcess&&t.postProcess(A,t);t.image=u}for(u=t.callbacks.length;u--;)t.callbacks[u]&&t.callbacks[u](this,false);t.callbacks=[];g[g.length]={url:this.src,created:t.requested};delete d[this.id];l()}}function f(t,u,A){var C=b[t];if(C){C.hitCount++;C.image.complete&&C.image.width>0&&u?u(C.image,true):C.callbacks.push(u)}else{C=T5.ex({url:t,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[u]},A);C.image.id="resourceLoaderImage"+
o++;b[t]=C;d[C.image.id]=C;e[e.length]=C;l()}return C}function a(t,u){var A=document.createElement("canvas");A.width=t?t:0;A.height=u?u:0;if(typeof FlashCanvas!=="undefined"){A.id="tmpCanvas"+h++;A.style.cssText="position: absolute; top: -"+(u-1)+"px; left: -"+(t-1)+"px;";document.body.appendChild(A);FlashCanvas.initElement(A)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(A);return A}var b={},h=0,d={},o=0,e=[],k=[],g=[],q=0,v=null,y=false,w={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){k=[]},get:function(t,u,A){var C=null,I=null;y||(C=b[t]);if((I=C?C.image:null)&&(I.getContext||I.complete&&I.width>0))return I;else u&&f(t,u,A);return null},load:f,newCanvas:a,reset:function(){b={}},stats:function(){return{imageLoadingCount:k.length,queuedImageCount:e.length,imageCacheFullness:q}}};COG.Loopage.join({execute:function(t){for(var u=false,A=0,C=T5.getConfig();A<k.length;)if(t-k[A].requested>w.loadTimeout*1E3){k.splice(A,1);u=true}else A++;u&&l();if(C&&C.imageCacheMaxSize){q=
g.length*w.avgImageSize/C.imageCacheMaxSize;q>=1&&n()}},frequency:2E4});return w}();T5.Generator=function(){var l={};return{init:function(n,m){var f=l[n];if(!f)throw Error("Unable to locate requested generator: "+n);return new f(m)},register:function(n,m){l[n]=m},Template:function(){}}}();
T5.TimeLord=function(){var l=/^P(\d+Y)?(\d+M)?(\d+D)?$/,n=/^(\d+H)?(\d+M)?(\d+S)?$/,m=function(a,b){return{days:a?a:0,seconds:b?b:0}},f={8601:function(a){a=a.split("T");var b=null;b=null;var h=0,d=0;l.lastIndex=-1;b=l.exec(a[0]);h+=b[3]?parseInt(b[3].slice(0,-1),10):0;n.lastIndex=-1;b=n.exec(a[1]);d+=b[1]?parseInt(b[1].slice(0,-1),10)*3600:0;d+=b[2]?parseInt(b[2].slice(0,-1),10)*60:0;d+=b[3]?parseInt(b[3].slice(0,-1),10):0;return new m(h,d)}};return{Duration:m,addDuration:function(){for(var a=new m,
b=arguments.length;b--;){a.days+=arguments[b].days;a.seconds+=arguments[b].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,b){var h=b?f[b]:null;if(h)return h(a);COG.Log.warn("Could not find duration parser for specified format: "+b);return new m},formatDuration:function(a){var b,h,d="";if(a.days)d=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){b=~~(a/3600);a-=b*3600}if(a>=60){h=Math.round(a/60);a-=h*60}if(b)d=d+b+(b>1?" hrs ":" hr ")+
(h?(h>10?h:"0"+h)+" min ":"");else if(h)d=d+h+" min";else if(a>0)d=d+(a>10?a:"0"+a)+" sec"}return d}}}();
T5.zoomable=function(l,n){function m(a,b){if(a&&f!==a){f=a;l.triggerAll("zoomLevelChange",f,b)}}n=T5.ex({initial:0,min:0,max:null,zoomAnimation:T5.easing("quad.out")},n);var f=n.initial;T5.ex(l,{getZoomLevel:function(){return f},setZoomLevel:m,zoomIn:function(){l.scale(2,T5.easing("sine.out"))||l.setZoomLevel(f+1)},zoomOut:function(){l.scale(0.5,T5.easing("sine.out"))||l.setZoomLevel(f-1)}});l.bind("scale",function(a,b,h){a=0;b=Math.sqrt(b);if(b<1)a=-(0.5/b);else if(b>1)a=b;T5.cancelAnimation(function(d){return d.cancelOnInteract});
m(f+a>>0,h)});l.bind("doubleTap",function(a,b,h){if(l.scalable()){T5.cancelAnimation(function(d){return d.cancelOnInteract});l.animate(2,T5.D.getCenter(l.getDimensions()),T5.XY.init(h.x,h.y),n.zoomAnimation)}})};
(function(){var l=Math.PI*2,n=Math.PI/2,m=Math.abs,f=Math.pow,a=Math.sin,b=Math.asin,h=Math.cos,d=1.70158,o={linear:function(e,k,g,q){return g*e/q+k},backin:function(e,k,g,q){return g*(e/=q)*e*((d+1)*e-d)+k},backout:function(e,k,g,q){return g*((e=e/q-1)*e*((d+1)*e+d)+1)+k},backinout:function(e,k,g,q){return(e/=q/2)<1?g/2*e*e*(((d*=1.525)+1)*e-d)+k:g/2*((e-=2)*e*(((d*=1.525)+1)*e+d)+2)+k},bouncein:function(e,k,g,q){return g-o.bounceout(q-e,0,g,q)+k},bounceout:function(e,k,g,q){return(e/=q)<1/2.75?
g*7.5625*e*e+k:e<2/2.75?g*(7.5625*(e-=1.5/2.75)*e+0.75)+k:e<2.5/2.75?g*(7.5625*(e-=2.25/2.75)*e+0.9375)+k:g*(7.5625*(e-=2.625/2.75)*e+0.984375)+k},bounceinout:function(e,k,g,q){return e<q/2?o.bouncein(e*2,0,g,q)/2+k:o.bounceout(e*2-q,0,g,q)/2+g/2+k},cubicin:function(e,k,g,q){return g*(e/=q)*e*e+k},cubicout:function(e,k,g,q){return g*((e=e/q-1)*e*e+1)+k},cubicinout:function(e,k,g,q){if((e/=q/2)<1)return g/2*e*e*e+k;return g/2*((e-=2)*e*e+2)+k},elasticin:function(e,k,g,q,v,y){if(e==0)return k;if((e/=
q)==1)return k+g;y||(y=q*0.3);if(!v||v<m(g)){v=g;g=y/4}else g=y/l*b(g/v);return-(v*f(2,10*(e-=1))*a((e*q-g)*l/y))+k},elasticout:function(e,k,g,q,v,y){var w;if(e==0)return k;if((e/=q)==1)return k+g;y||(y=q*0.3);if(!v||v<m(g)){v=g;w=y/4}else w=y/l*b(g/v);return v*f(2,-10*e)*a((e*q-w)*l/y)+g+k},elasticinout:function(e,k,g,q,v,y){var w;if(e==0)return k;if((e/=q/2)==2)return k+g;y||(y=q*0.3*1.5);if(!v||v<m(g)){v=g;w=y/4}else w=y/l*b(g/v);if(e<1)return-0.5*v*f(2,10*(e-=1))*a((e*q-w)*l/y)+k;return v*f(2,
-10*(e-=1))*a((e*q-w)*l/y)*0.5+g+k},quadin:function(e,k,g,q){return g*(e/=q)*e+k},quadout:function(e,k,g,q){return-g*(e/=q)*(e-2)+k},quadinout:function(e,k,g,q){if((e/=q/2)<1)return g/2*e*e+k;return-g/2*(--e*(e-2)-1)+k},sinein:function(e,k,g,q){return-g*h(e/q*n)+g+k},sineout:function(e,k,g,q){return g*a(e/q*n)+k},sineinout:function(e,k,g,q){return-g/2*(h(Math.PI*e/q)-1)+k}};T5.easing=function(e){return o[e.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(e,k){o[e.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=k}})();
T5.Tween=function(l){l=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},l);var n=T5.ticks(),m=[],f=false,a=0,b=0,h={cancelOnInteract:l.cancelOnInteract,isComplete:function(){return f},triggerComplete:function(d){l.complete&&l.complete(d)},update:function(d){try{var o=l.tweenFn(d-n,a,b,l.duration);if(l.target)l.target[l.property]=o;for(var e=m.length;e--;)m[e](o,void 0);if(f=n+l.duration<=d){if(l.target)l.target[l.property]=
l.tweenFn(l.duration,a,b,l.duration);for(var k=m.length;k--;)m[k](o,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(d){m.push(d)}};a=l.target&&l.property&&l.target[l.property]?l.target[l.property]:l.startValue;if(typeof l.endValue!=="undefined")b=l.endValue-a;if(b==0)f=true;T5.wakeTweens();return h};
(function(){function l(a){if(f)return n.length;f=true;try{for(var b=0;b<n.length;)if(n[b].isComplete()){n[b].triggerComplete(false);n.splice(b,1)}else{n[b].update(a);b++}}finally{f=false}n.length===0&&m.trigger("complete");return n.length}var n=[],m=null,f=false;T5.tweenValue=function(a,b,h,d,o){a=new T5.Tween({startValue:a,endValue:b,tweenFn:h,complete:d,duration:o});n.push(a);return a};T5.tween=function(a,b,h,d,o,e){a=new T5.Tween({target:a,property:b,endValue:h,tweenFn:d,duration:e,complete:o});
n.push(a);return a};T5.tweenVector=function(a,b,h,d,o,e){var k=[];if(a){var g=a.x==b,q=a.y==h;g||k.push(T5.tween(a,"x",b,d,function(){(g=true)&&q&&o()},e));q||k.push(T5.tween(a,"y",h,d,function(){q=true;g&&q&&o()},e))}return k};T5.cancelAnimation=function(a){if(!f){f=true;try{for(var b=0;b<n.length;)if(!a||a(n[b])){n[b].triggerComplete(true);n.splice(b,1)}else b++}finally{f=false}}};T5.isTweening=function(){return n.length>0};T5.wakeTweens=function(){if(!m){m=COG.Loopage.join({execute:l,frequency:20});
m.bind("complete",function(){m=null})}}})();(function(){var l={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var n=0,m=arguments.length;m--;){var f=l[arguments[m].toUpperCase()];if(f)n|=f}return n}})();
T5.ViewLayer=function(l){l=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},l);var n=null,m=false,f=false,a=l.supportFastDraw,b=l.id,h=T5.viewState("ACTIVE"),d=l.validStates,o=0,e=0,k=T5.ex({addToView:function(g){g.setLayer(b,k)},shouldDraw:function(g,q,v){return(f||v||o!==q.x1||e!==q.y1)&&(g&d)!==0&&(m?a:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){k.trigger("remove",
k)},changed:function(g){f=true;k.trigger("changed",k);n&&n.trigger("invalidate",g)},getId:function(){return b},setId:function(g){b=g},getParent:function(){return n},setParent:function(g){m=(n=g)?n.fastDraw&&displayState!==h:false;k.trigger("parentChange",n)}},l);COG.observable(k);k.bind("drawComplete",function(g,q){f=false;o=q.x1;e=q.y1});k.bind("resync",function(g,q){if(q.syncXY){k.minXY&&q.syncXY(k.minXY);k.maxXY&&q.syncXY(k.maxXY)}});return k};
T5.View=function(l){function n(x,B,H,M){Z=ja;t();if(M&&l.inertia){aa=true;e(Q+B,N+H,l.panAnimationEasing,l.panAnimationDuration)}else M||e(Q+B,N+H)}function m(){Z=ka;aa=false;COG.Loopage.join({execute:t,after:50,single:true})}function f(x,B){var H=la(x);G(H);var M=ta(H),O=la(B),R=G(O);O=ta(O);K=T5.XY.offset(R,p.x1,p.y1);P=H&&M!==0?O/M:1}function a(x,B,H){f(B,H);if(V=P!==1){Z=ga;t()}}function b(x,B,H){f(B,H);if(l.adjustScaleFactor){P=l.adjustScaleFactor(P);COG.Log.info("scale factor adjusted to: "+
P)}d();P=1}function h(x,B,H){F.zoom(B,Math.min(Math.pow(2,Math.round(Math.log(H))),8),500)}function d(){var x=T5.XY.init(na,oa);P=Math.round(P*10)/10;V=false;for(var B=A.length;B--;)A[B].trigger("scale",P,x);F.trigger("scale",P,x);Z=ka;t()}function o(){clearTimeout(fa);fa=setTimeout(k,50)}function e(x,B,H,M,O){function R(){Y+=1;if(Y>=2){m(0,0);O&&O()}}var Y=0;if($){x=x<$.x?$.x:x;B=B<$.y?$.y:B}if(S){x=x>S.x?S.x:x;B=B>S.y?S.y:B}if(H){x=T5.tweenValue(Q,x,H,R,M);B=T5.tweenValue(N,B,H,R,M);x.cancelOnInteract=
true;x.requestUpdates(function(W){Q=W;aa=true;t()});B.cancelOnInteract=true;B.requestUpdates(function(W){N=W;aa=true;t()})}else{Q=x;N=B}}function k(){var x;if(I){COG.Touch.release(I);if(l.autoSize&&I.parentNode){x=I.parentNode.getBoundingClientRect();if(x.height!==0&&x.width!==0){I.height=x.height;I.width=x.width}}try{if(!I.id)I.id=l.id+"_canvas";L=I.getContext("2d")}catch(B){COG.Log.exception(B);throw Error("Could not initialise canvas on specified view element");}ba=COG.Touch.capture(I,{observable:F});
if(E.height!==I.height||E.width!==I.width){E=T5.D.init(I.width,I.height);F.trigger("resize",I.width,I.height);for(x=C;x--;)A[x].trigger("resize",I.width,I.height)}l.inertia&&ba.inertiaEnable(l.panAnimationDuration,E);for(x=C;x--;)A[x].trigger("contextChanged",L);t()}}function g(x,B){B.setId(x);B.added=T5.ticks();B.bind("remove",function(){F.removeLayer(x)});B.trigger("contextChanged",L);B.setParent(F);A.push(B);A.sort(function(H,M){var O=M.zindex-H.zindex;if(O===0)O=M.added-H.added;return O});C=A.length;
return B}function q(x,B,H,M,O,R,Y){function W(){R&&R();d();P=1;ma=null}V=true;K=T5.XY.offset(M,p.x1,p.y1);if(O)T5.tweenValue(0,B-x,O,W,Y?Y:1E3).requestUpdates(function(ea){ma=ea/(B-x);P=x+ea;Z=ga;t();F.trigger("animate")});else{P=B;W()}}function v(){u("idle",F);U=true;X=0}function y(x,B,H,M){var O=false,R=(x&ga)!==0,Y=T5.XYRect.copy(B),W,ea=0;H&&L.clearRect(0,0,I.width,I.height);L.save();try{da=P;L.globalCompositeOperation="source-over";if(R){R=1/P;var ua=(R-0.5)*2,xa=Y.width*R>>0,ya=Y.height*R>>
0,za=K.y-N;na=K.x-(K.x-Q)*ua>>0;oa=K.y-za*ua>>0;Y=T5.XYRect.fromCenter(na,oa,xa,ya);L.scale(P,P)}L.translate(-Y.x1,-Y.y1);S=$=null;L.beginPath();for(ea=C;ea--;)if(A[ea].clip){A[ea].clip(L,Y,x,F,H,M);O=true}L.closePath();O&&L.clip();for(ea=C;ea--;){W=A[ea];var va=W.style,wa=va?T5.Style.apply(L,va):null;if(W.minXY)$=$?T5.XY.min($,W.minXY):T5.XY.copy(W.minXY);if(W.maxXY)S=S?T5.XY.max(S,W.maxXY):T5.XY.copy(W.maxXY);W.draw(L,Y,x,F,H,M);wa&&T5.Style.apply(L,wa);W.trigger("drawComplete",Y,M)}}finally{L.restore()}if(z){L.globalCompositeOperation=
"source-over";L.strokeStyle="#f00";L.beginPath();L.moveTo(I.width/2,0);L.lineTo(I.width/2,I.height);L.moveTo(0,I.height/2);L.lineTo(I.width,I.height/2);L.stroke()}F.trigger("drawComplete",B,M);COG.Log.trace("draw complete",M)}function w(x,B){var H=false,M=ha?ha:aa?ja:Z,O=!aa&&(M===ga||M===ja),R=ra||M===ja||M===ga||T5.isTweening();s=T5.XY.init(Q>>0,N>>0);p=T5.XYRect.fromCenter(s.x,s.y,E.width,E.height);if(O){T5.cancelAnimation(function(Y){return Y.cancelOnInteract});U=false;if(X!==0){clearTimeout(X);
X=0}}for(O=C;O--;){if(A[O].animated)Z|=ca;A[O].cycle(x,p,Z,R);H=A[O].shouldDraw(Z,p,R)||H}R=R||(Z&ca)!==0;if(H=H||R||P!==1&&P!==ia){y(M,p,R,x);ia=P;ra=false}if(!H&&J===0&&!pa){if(!U&&X===0)X=setTimeout(v,500);B.trigger("complete")}J=0;COG.Log.trace("Completed draw cycle",x)}function t(x){ra=x?true:false;J+=1;if(!r){r=COG.Loopage.join({execute:w,frequency:sa});r.bind("complete",function(){r=null})}}function u(){F.trigger.apply(null,arguments);for(var x=A.length;x--;)A[x].trigger.apply(null,arguments)}
l=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},l);var A=[],C=0,I=document.getElementById(l.container),L=null,Q=0,N=0,s=null,p=null,r=null,z=l.guides,D=1,E=T5.D.init(),J=0,K=null,U=false,aa=false,X=0,qa=0,$=null,S=null,T=0,V=false,ha=null,ra=false,fa=0,P=1,ia=0,da=1,ma=null,
pa=typeof FlashCanvas!=="undefined",sa=~~(1E3/l.fps),ba=null,na,oa,ka=T5.viewState("ACTIVE"),ja=T5.viewState("PAN"),ga=T5.viewState("ZOOM"),ca=T5.viewState("ANIMATING"),Z=ka,la=T5.XY.getRect,ta=T5.XYRect.diagonalSize,G=T5.XYRect.center,F={id:l.id,deviceScaling:D,fastDraw:l.fastDraw||T5.getConfig().requireFastDraw,animate:function(x,B,H,M,O){q(P,x,B,H,M,O)},centerOn:function(x){Q=x.x-I.width/2;N=x.y-I.height/2},getDimensions:function(){return E},getLayer:function(x){for(var B=0;B<C;B++)if(A[B].getId()==
x)return A[B];return null},setLayer:function(x,B){for(var H=0;H<C;H++)if(A[H].getId()===x){A.splice(H,1);break}B&&g(x,B);t();return B},eachLayer:function(x){for(var B=C;B--;)x(A[B])},invalidate:t,resize:function(x,B){if(I){l.autoSize=false;I.width=x;I.height=B;k();F.trigger("resize",I.width,I.height)}},scale:function(x,B,H,M,O){M||(M=T5.D.getCenter(E));O||(O=T5.D.getCenter(E));F.animate(x,M,O,B,H);return F},triggerAll:u,removeLayer:function(x){a:{for(var B=C;B--;)if(A[B].getId()==x){x=B;break a}x=
-1}if(x>=0&&x<C){COG.say("layer.removed",{layer:A[x]});A.splice(x,1);t()}C=A.length},stateOverride:function(x){ha=x},getOffset:function(){return s?s:T5.XY.init(Q,N)},getViewRect:function(){return p?p:T5.XYRect.fromCenter(Q,N,E.width,E.height)},updateOffset:e,pan:function(x,B,H,M,O){e(Q+x,N+B,H,M,O)},zoom:function(x,B,H){aa=false;P=B;V=P!==1;K=T5.XY.offset(P>1?T5.XY.copy(x):T5.D.getCenter(E),p.x1,p.y1);clearTimeout(qa);if(V){Z=ga;t();if(H)qa=setTimeout(function(){d();P=1},parseInt(H,10))}}};D=T5.getConfig().getScaling();
F.markers=g("markers",new T5.MarkerLayer);COG.observable(F);F.bind("invalidate",function(x,B){t(B)});if(l.pannable){F.bind("pan",n);F.bind("panEnd",m);F.bind("inertiaCancel",function(){aa=false;t()})}if(l.scalable){F.bind("pinchZoom",a);F.bind("pinchZoomEnd",b);F.bind("wheelZoom",h)}F.bind("tap",function(x,B,H){for(var M=T5.XY.offset(H,Q,N),O=A.length;O--;)x.cancel=x.cancel||A[O].trigger("tap",B,H,M).cancel});F.bind("resync",function(){S=$=null});COG.configurable(F,["inertia","container","rotation",
"tapExtent","scalable","pannable"],COG.paramTweaker(l,null,{container:function(x,B){I=document.getElementById(B);k()},rotation:function(x,B){T=B}}),true);k();l.autoSize&&window.addEventListener("resize",o,false);return F};
T5.PathLayer=function(l){l=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},l);var n=false,m=[],f=null,a=[],b=null,h=0,d=[],o=T5.ex(new T5.ViewLayer(l),{getAnimation:function(e,k,g,q){var v="pathAnimation"+h++;d.push(v);return new T5.AnimatedPathLayer({id:v,path:m,zindex:l.zindex+1,easing:e?e:T5.easing("sine.inout"),duration:k?k:5E3,drawIndicator:g,autoCenter:q?q:false})},cycle:function(e,k,g,q){return q},draw:function(e){var k,g=m.length;e.save();try{T5.Style.apply(e,l.style);if(g>0){e.beginPath();
e.moveTo(m[g-1].x,m[g-1].y);for(k=g;k--;)e.lineTo(m[k].x,m[k].y);e.stroke();if(f){e.fillStyle=l.waypointFillStyle;for(k=f.length;k--;){e.beginPath();e.arc(f[k].x,f[k].y,2,0,Math.PI*2,false);e.stroke();e.fill()}}}}finally{e.restore()}n=false},updateCoordinates:function(e,k){a=e;b=k;var g=o.getParent();if(g&&g.syncXY){g.syncXY(a);b&&g.syncXY(b);o.trigger("tidy")}}});o.bind("tidy",function(){m=T5.XY.simplify(a,l.pixelGeneralization);f=T5.XY.simplify(b,l.pixelGeneralization);n=true;o.changed()});return o};
T5.ShapeLayer=function(l){function n(b){for(var h=f.length;h--;)f[h].resync(b);f.sort(function(d,o){var e=o.xy.y-d.xy.y;if(e===0)e=o.xy.x-d.xy.y;return e});a.changed()}function m(b,h){h.syncXY&&n(h)}l=T5.ex({zindex:80},l);var f=[],a=T5.ex(new T5.ViewLayer(l),{add:function(b){f[f.length]=b},each:function(b){for(var h=f.length;h--;)b(f[h])},draw:function(b,h,d){var o=h.x1,e=h.y1,k=h.width;h=h.height;for(var g=f.length;g--;){var q=f[g].style;q=q?T5.Style.apply(b,q):null;f[g].draw(b,o,e,k,h,d);q&&T5.Style.apply(b,
q)}}});a.bind("parentChange",m);a.bind("resync",m);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(l){l=T5.ex({style:null,properties:{}},l);return T5.ex(l,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(l,n){n=T5.ex({size:4},n);var m=T5.XY.init(),f=T5.ex(n,{draw:function(a){a.beginPath();a.arc(m.x,m.y,f.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([l]);m=T5.XY.floor([l])[0]}});COG.Log.info("created arc = ",l);return f};
T5.Poly=function(l,n){n=T5.ex({fill:false,simplify:false},n);var m=false,f=n.fill,a=n.simplify,b=T5.viewState("ZOOM"),h=[],d=T5.ex(new T5.Shape(n),{draw:function(o,e,k,g,q,v){if(m){e=true;k=(v&b)!==0;o.beginPath();for(v=h.length;v--;){k=h[v].x;g=h[v].y;if(e){o.moveTo(k,g);e=false}else o.lineTo(k,g);k=true}if(k){f&&o.fill();o.stroke()}}},resync:function(o){d.xy=o.syncXY(l);h=T5.XY.floor(a?T5.XY.simplify(l):l)}});m=l&&l.length>=2;return d};
T5.AnimatedPathLayer=function(l){function n(d,o,e){d.fillStyle="#FFFFFF";d.strokeStyle="#222222";d.beginPath();d.arc(e.x,e.y,4,0,Math.PI*2,false);d.stroke();d.fill()}l=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},l);var m=T5.XY.edges(l.path),f,a=null,b=0;T5.tweenValue(0,m.total,l.easing,function(){h.remove()},l.duration).requestUpdates(function(d,o){b=d;o&&h.remove()});var h=
T5.ex(new T5.ViewLayer(l),{cycle:function(){for(var d=0;d<m.accrued.length&&m.accrued[d]<b;)d++;a=null;if(d<l.path.length-1){var o=b-(d>0?m.accrued[d-1]:0),e=l.path[d];f=T5.XY.theta(e,l.path[d+1],m.edges[d]);a=T5.XY.extendBy(e,f,o);if(l.autoCenter)(d=h.getParent())&&d.centerOn(a)}return a},draw:function(d,o){if(a)(l.drawIndicator?l.drawIndicator:n)(d,o,T5.XY.init(a.x,a.y),f)}});return h};
T5.Marker=function(l){function n(o,e,k,g){f=o;a=e;b=k;h=g}l=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},l);var m=false,f=0,a=0,b=0,h=0,d=T5.ex(l,{isNew:true,isAnimating:function(){return m},draw:function(o,e,k,g,q){if(d.isNew&&l.tweenIn){var v=d.xy.y;d.xy.y=e.y1-20;m=true;T5.tween(d.xy,"y",v,l.tweenIn,function(){d.xy.y=v;m=false},l.animationSpeed?l.animationSpeed:250+Math.random()*500)}d.drawMarker(o,e,d.xy.x,d.xy.y,k,g,q);d.isNew=false},drawMarker:function(o,e,k,g){o.beginPath();
o.arc(k,g,4,0,Math.PI*2,false);o.fill();n(k-4,g-4,8,8)},hitTest:function(o,e){return o>=f&&o<=f+b&&e>=a&&e<=a+h},updateBounds:n});COG.observable(d);return d};
T5.ImageMarker=function(l){l=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},l);var n=l.imageAnchor?T5.XY.invert(l.imageAnchor):null,m=T5.ex(new T5.Marker(l),{drawMarker:function(f,a,b,h){if((a=m.isAnimating()&&m.animatingImage?m.animatingImage:m.image)&&a.complete&&a.width>0){n||(n=T5.XY.init(-a.width>>1,-a.height>>1));var d=m.scale,o=b+~~(n.x*d),e=h+~~(n.y*d),k=~~(a.width*d),g=~~(a.height*d);m.updateBounds(o,e,k,k);if(m.rotation||
m.opacity!==1){f.save();try{f.globalAlpha=m.opacity;f.translate(b,h);f.rotate(m.rotation);f.drawImage(a,n.x*d,n.y*d,k,g)}finally{f.restore()}}else f.drawImage(a,o,e,k,g)}}});if(!m.image)m.image=T5.Images.get(l.imageUrl,function(f){COG.Log.info("updating marker image to: "+f.src);m.image=f});if(!m.animatingImage)m.animatingImage=T5.Images.get(l.animatingImageUrl,function(f){m.animatingImage=f});return m};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(l){function n(){a.changed();a.trigger("markerUpdate",f)}function m(){var b=a.getParent();if(b&&b.syncXY)for(var h=f.length;h--;)b.syncXY([f[h].xy])}l=T5.ex({zindex:100,style:"basic"},l);var f=[],a=T5.ex(new T5.ViewLayer(l),{draw:function(b,h,d,o){for(var e=f.length;e--;)f[e].draw(b,h,d,a,o)},add:function(b){if(b&&typeof b.length!=="undefined")for(var h=b.length;h--;){if(b[h])f[f.length]=b[h]}else if(b)f[f.length]=b;n()},clear:function(b){if(b)for(var h=0;h<f.length;h++)b(f[h])&&
f.splice(h,1);else f=[];n()},find:function(b){for(var h=[],d=f.length;d--;)if(!b||b(f[d]))h[h.length]=f[d];return h}});a.bind("tap",function(b,h,d){for(var o=[],e=d.x,k=d.y,g=f.length;g--;)if(f[g].hitTest(e,k))o[o.length]=f[g];if(o.length>0)b.cancel=a.trigger("markerTap",h,d,o).cancel});a.bind("parentChange",m);a.bind("resync",m);a.bind("changed",m);return a};
T5.ImageLayer=function(l,n){function m(g,q,v){if(h)for(var y=h.length;y--;){var w=h[y],t=w.x,u=w.y,A=T5.XYRect.init(w.x,w.y,w.x+w.width,w.y+w.height);if(v&&T5.XYRect.intersect(g,A)){A=T5.Images.get(w.url,(q&e)===0?a:null,o);v(A,t,u,w.width,w.height)}}}function f(g){b&&b.run(g,function(q){h=q;k.changed()})}function a(){k.changed()}n=T5.ex({imageLoadArgs:{}},n);var b=l?T5.Generator.init(l,n):null,h=null,d=T5.XYRect.init(),o=n.imageLoadArgs,e=T5.viewState("ZOOM"),k=T5.ex(new T5.ViewLayer(n),{changeGenerator:function(g,
q){b=T5.Generator.init(g,T5.ex({},n,q));b.bindToView(k.getParent());h=null;f(d)},clip:function(g,q,v){m(q,v,function(y,w,t,u,A){y&&g.rect(w,t,u,A)})},cycle:function(g,q){f(q)},draw:function(g,q,v){m(q,v,function(y,w,t,u,A){k.drawImage(g,y,w,t,u,A,q,v)});d=T5.XYRect.copy(q)},drawImage:function(g,q,v,y){q&&g.drawImage(q,v,y,q.width,q.height)}});k.bind("idle",function(){f(d)});k.bind("parentChange",function(g,q){b&&b.bindToView(q)});k.bind("tap",function(g,q,v,y){g=[];var w=y.x,t=y.y,u,A;if(h)for(var C=
h.length;C--;){u=h[C];if(A=w>=u.x&&w<=u.x+u.width&&t>=u.y&&t<=u.y+u.height)g[g.length]=u}g.length>0&&k.trigger("tapImage",g,q,v,y)});return k};
T5.Style=function(){function l(h,d){a[h]=m(d);return h}function n(h){for(var d in h)l(d,h[d])}function m(h){function d(g){var q=h[g];typeof q!=="undefined"&&e.push(function(v){v[g]=q})}function o(){e=[];for(var g in h)d(g)}h=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},h);var e=[],k={applyToContext:function(g){for(var q=e.length;q--;)e[q](g)},update:function(g,
q){h[g]=q;o()}};o();return k}var f={},a={},b={apply:function(h,d){var o=a[d]?a[d]:a.basic,e;if(h&&h.canvas){e=f[h.canvas.id];f[h.canvas.id]=d}o.applyToContext(h);return e},define:l,defineMany:n,get:function(h){return a[h]},init:m,load:function(h){COG.jsonp(h,function(d){T5.resetStyles(d)})}};n({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return b}();
T5.Tiling=function(){return{tileSize:256,init:function(l,n,m,f,a){return T5.ex({x:l,y:n,width:m,height:f},a)}}}();
T5.TileGenerator=function(l){function n(v,y,w,t){function u(){if(q.initTileCreator){h=true;q.initTileCreator(v,y,w,t)}}q.prepTileCreator?q.prepTileCreator(v,y,w,u):u()}function m(v,y){for(var w=~~((v.x1-b.x)/d),t=~~((v.y1-b.y)/o),u=[],A=-k;A<k;A++)for(var C=-g;C<g;C++){var I=e(w+A,t+C);if(I)u[u.length]=I}y&&y(u);a=T5.XYRect.copy(v)}l=T5.ex({tileWidth:256,tileHeight:256},l);var f=null,a=null,b=T5.XY.init(),h=false,d=l.tileWidth,o=l.tileHeight,e=null,k=0,g=0,q={bindToView:function(v){COG.Log.info("initializing generator");
f=v;q.trigger("bindView",v)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){e=null;h=false;a=null},run:function(v,y){if(!a||Math.abs(v.x1-a.x1)>d||Math.abs(v.y1-a.y1)>o){if(!e&&!h||q.requireRefresh()){b=T5.XY.init(v.x1,v.y1);k=Math.ceil(v.width/d)+1;g=Math.ceil(v.height/o)+1;n(d,o,q.getTileCreatorArgs?q.getTileCreatorArgs(f):{},function(w){e=w;h=false;m(v,y)})}e&&m(v,y)}}};COG.observable(q);q.bind("update",function(){COG.Log.info("captured generator update");
a=null});return q};
T5.Geo=function(){function l(s,p){var r=null;for(var z in Q)if(p){if(z==p&&Q[z][s]){r=Q[z];break}}else if(Q[z][s]){r=Q[z];break}return r}function n(s,p){var r=g*Math.sin(s);return a-2*Math.atan(p*Math.pow((1-r)/(1+r),g/2))}function m(s,p,r,z){var D=0;s=s.toUpperCase();for(var E in z){var J=p[E];if(J){var K=r[E];J=K?K(s,J):COG.wordExists(s,J)?1:0;D+=J*z[E]}}return D}var f=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],a=Math.PI/2,b=Math.PI*2,h=-a,d=a,o=
-b,e=Math.PI/180,k=180/Math.PI,g=0.08181919084262157,q=null,v={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},y={VECTORIZE_PER_CYCLE:500},w={getEngine:function(s){for(var p=null,r=1;!p&&r<arguments.length;r++)p=l(s,arguments[r]);p=p?p:l(s);if(!p)throw Error("Unable to find GEO engine with "+s+" capability");return p},rankGeocodeResponses:function(s,p,r){var z=[],D=N.AddressCompareFns;if(r&&r.compareFns)D=T5.ex({},D,r.compareFns);for(r=0;r<p.length;r++)z.push(new N.GeoSearchResult({caption:L.toString(p[r]),
data:p[r],pos:p[r].pos,matchWeight:m(s,p[r],D,N.GeocodeFieldWeights)}));z.sort(function(E,J){return J.matchWeight-E.matchWeight});return z},distanceToString:function(s){if(s>1E3)return~~(s/10)/100+" km";return s?s+" m":""},dist2rad:function(s){return s/6371},lat2pix:function(s){s=parseFloat(s)*e;s=Math.sin(s);var p=g*s;return Math.log((1+s)/(1-s)*Math.pow((1-p)/(1+p),g))/2},lon2pix:function(s){return parseFloat(s)*e},pix2lon:function(s){return N.normalizeLon(s)*k},pix2lat:function(s){s=Math.pow(Math.E,
-s);for(var p=a-2*Math.atan(s),r=n(p,s),z=0;z<12&&Math.abs(p-r)>1.0E-7;){p=r;r=n(p,s);z++}return r*k},normalizeLon:function(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s},radsPerPixel:function(s){return 2*Math.PI/(256<<s)}},t=function(s,p){return{lat:parseFloat(s?s:0),lon:parseFloat(p?p:0)}},u=function(s,p){return{min:C.parse(s),max:C.parse(p)}},A=function(s){return s=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},s)},C=function(){var s={calcDistance:function(p,
r){if(s.empty(p)||s.empty(r))return 0;var z=(r.lat-p.lat)*e/2,D=(r.lon-p.lon)*e/2;z=Math.sin(z)*Math.sin(z)+Math.cos(p.lat*e)*Math.cos(r.lat*e)*Math.sin(D)*Math.sin(D);return 6371*2*Math.atan2(Math.sqrt(z),Math.sqrt(1-z))},copy:function(p){return p?new t(p.lat,p.lon):null},empty:function(p){return!p||p.lat===0&&p.lon===0},equal:function(p,r){return p&&r&&p.lat==r.lat&&p.lon==r.lon},inArray:function(p,r){for(var z=C.equal,D=r.length;D--;)if(z(p,r[D]))return true;return false},inBounds:function(p,r){var z=
!(C.empty(p)||C.empty(r));return z=(z=z&&p.lat>=r.min.lat&&p.lat<=r.max.lat)&&p.lon>=r.min.lon&&p.lon<=r.max.lon},offset:function(p,r,z){var D=p.lat*e;r=D+r/6371;for(p=p.lon*e+Math.asin(Math.sin(z/6371)/Math.cos(D));r<h;)r+=Math.PI;for(;r>d;)r-=Math.PI;for(;p>b;)p-=2*Math.PI;return new t(r*k,p*k)},parse:function(p){if(p)if(typeof p.lat!=="undefined")return s.copy(p);else{if(p.split)for(var r=[" ",","],z=0;z<r.length;z++){var D=p.split(r[z]);if(D.length===2)return new t(D[0],D[1])}}else return new t;
return null},parseArray:function(p){var r=p.length,z=Array(r);for(r=r;r--;)z[r]=s.parse(p[r]);return z},fromMercatorPixels:function(p,r){return new t(T5.Geo.pix2lat(r),T5.Geo.normalizeLon(T5.Geo.pix2lon(p)))},toMercatorPixels:function(p){return T5.XY.init(T5.Geo.lon2pix(p.lon),T5.Geo.lat2pix(p.lat))},generalize:function(p,r,z){var D=p.length,E=[],J=null;z||(z=250);z/=1E3;COG.Log.info("generalizing positions, must include "+r.length+" positions");for(var K=D;K--;)if(K===0)E.unshift(p[K]);else{var U=
!J||C.inArray(p[K],r)?z:C.calcDistance(J,p[K]);if(p[K]&&U>=z){E.unshift(p[K]);J=p[K]}}COG.Log.info("generalized "+D+" positions into "+E.length+" positions");return E},vectorize:function(p,r){var z=p.length,D=Array(z);r=T5.ex({chunkSize:y.VECTORIZE_PER_CYCLE,async:true},r);if(!r.async){for(var E=z;E--;)D[E]=T5.GeoXY.init(p[E]);return D}return COG.Loopage.join({frequency:10,execute:function(J,K){for(var U=0,aa=r.chunkSize,X=z;X--;){D[X]=T5.GeoXY.init(p[X]);U+=1;if(U>aa)break}z=X;z<=0&&K.trigger("complete",
D)}})},toString:function(p){return p?p.lat+" "+p.lon:""}};return s}(),I=function(){var s={calcSize:function(p,r,z){var D=T5.XY.init(0,r.lat-p.lat);if(typeof z==="undefined")z=true;D.x=z&&p.lon>r.lon?360-p.lon+r.lon:r.lon-p.lon;return D},createBoundsFromCenter:function(p,r){var z=r/6371,D=p.lat*e,E=p.lon*e,J=D-z,K=D+z;if(J>h&&K<d){D=Math.asin(Math.sin(z)/Math.cos(D));z=E-D;if(z<o)z+=2*Math.PI;E=E+D;if(E>b)E-=2*Math.PI}else{J=Math.max(J,h);K=Math.min(K,d);z=o;E=b}return new u(new t(J*k,z*k),new t(K*
k,E*k))},expand:function(p,r){return new u(new t(p.min.lat-r,p.min.lon-N.normalizeLon(r)),new t(p.max.lat+r,p.max.lon+N.normalizeLon(r)))},forPositions:function(p,r){var z=null,D=T5.ticks();r||(r="auto");for(var E=p.length;E--;)if(z){var J=s.calcSize(z.min,p[E],false),K=s.calcSize(p[E],z.max,false);if(J.x<0)z.min.lon=p[E].lon;if(J.y<0)z.min.lat=p[E].lat;if(K.x<0)z.max.lon=p[E].lon;if(K.y<0)z.max.lat=p[E].lat}else z=new T5.Geo.BoundingBox(p[E],p[E]);if(r){if(r=="auto"){E=s.calcSize(z.min,z.max);r=
Math.max(E.x,E.y)*0.3}z=s.expand(z,r)}COG.Log.trace("calculated bounds for "+p.length+" positions",D);return z},getCenter:function(p){var r=I.calcSize(p.min,p.max);return new T5.Geo.Position(p.min.lat+r.y/2,p.min.lon+r.x/2)},getGeoHash:function(p){var r=T5.Geo.GeoHash.encode(p.min.lat,p.min.lon);p=T5.Geo.GeoHash.encode(p.max.lat,p.max.lon);COG.Log.info("min hash = "+r+", max hash = "+p)},getZoomLevel:function(p,r){var z=s.getCenter(p),D=f[Math.min(Math.round(Math.abs(z.lat)*0.05),f.length)],E=s.calcSize(p.min,
p.max);z=Math.ceil(Math.log(f[3]*r.height/E.y)/Math.log(2));D=Math.ceil(Math.log(D*r.width/E.x)/Math.log(2));return Math.min(isNaN(z)?1E3:z,isNaN(D)?1E3:D)},isEmpty:function(p){return!p||C.empty(p.min)||C.empty(p.max)},toString:function(p){return"min: "+C.toString(p.min)+", max: "+C.toString(p.max)}};return s}(),L=function(){var s=/^(\d+).*$/,p=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(r,z){s.lastIndex=-1;if(s.test(r))for(var D=r.replace(s,"$1"),E=z.split(","),J=0;J<E.length;J++){p.lastIndex=
-1;if(p.test(E[J])){var K=p.exec(E[J]);if(D>=parseInt(K[1],10)&&D<=parseInt(K[2],10))return true}else if(D==E[J])return true}return false},normalize:function(r){if(!r)return"";r=r.toUpperCase();if(!q){var z=[];for(var D in v)z.push(D);q=RegExp("(\\s)("+z.join("|")+")(\\s|$)","i")}q.lastIndex=-1;if(z=q.exec(r))r=r.replace(q,"$1"+v[z[2]]);return r},toString:function(r){return r.streetDetails+" "+r.location}}}(),Q={},N={P:C,B:I,A:L,Radius:function(s,p){return{distance:parseInt(s,10),uom:p}},Position:t,
BoundingBox:u,Address:A,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(s){if(!s.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var p=T5.ex({remove:function(){delete Q[p.id]}},s);return Q[p.id]=p},GeoSearchResult:function(s){s=T5.ex({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},s);return T5.ex(s,{toString:function(){return s.caption+(s.matchWeight?" ("+s.matchWeight+")":"")}})},GeoSearchAgent:function(s){return new T5.Dispatcher.Agent(s)},
GeocodingAgent:function(s){s=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(p,r){try{if(!p.reverse&&!p.freeform)address=new A(p);var z=N.getEngine("geocode");if(z)z.geocode({addresses:[p.freeform?p.freeform:address],complete:function(E,J){if(r){var K=J;if(p.freeform)K=N.rankGeocodeResponses(p.freeform,K,N.getEngine("geocode"));r(K,s)}}})}catch(D){COG.Log.exception(D)}}},s);return new N.GeoSearchAgent(s)}};T5.GeoXY=function(){function s(r,z){if(r.length){for(var D,E,J,K,
U=r.length;U--;){s(r[U],z);D=typeof D==="undefined"||r.x<D?r.x:D;E=typeof E==="undefined"||r.y<E?r.y:E;J=typeof J==="undefined"||r.x>J?r.x:J;K=typeof K==="undefined"||r.y>K?r.y:K}return T5.XYRect.init(D,E,K,K)}else if(r.mercXY){D=r.mercXY;r.x=~~(D.x/z);r.y=~~((Math.PI-D.y)/z);r.radsPerPixel=z}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");return r}function p(r,z,D){r.pos=z;r.mercXY=C.toMercatorPixels(z);(D=typeof D!=="undefined"?D:r.radsPerPixel)&&s(r,D)}return{init:function(r,
z){var D=T5.XY.init();p(D,r,z);return D},sync:s,toPos:function(r,z){z=z?z:self.radsPerPixel;return C.fromMercatorPixels(r.x*z,Math.PI-r.y*z)},updatePos:p}}();N.GeoVector=function(s){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return T5.GeoXY.init(s)};return T5.ex(N,y,w)}();
T5.Geo.GeoHash=function(){function l(n,m,f){if(m&f)n[0]=(n[0]+n[1])/2;else n[1]=(n[0]+n[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(n){var m=1,f=[],a=[];f[0]=-90;f[1]=90;a[0]=-180;a[1]=180;lat_err=90;lon_err=180;for(i=0;i<n.length;i++){c=n[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(m){lon_err/=2;l(a,cd,mask)}else{lat_err/=2;l(f,cd,mask)}m=!m}}f[2]=(f[0]+
f[1])/2;a[2]=(a[0]+a[1])/2;return{latitude:f,longitude:a}},encode:function(n,m,f){var a=1,b=[],h=[],d=0,o=0;f=f?f:12;geohash="";b[0]=-90;b[1]=90;h[0]=-180;for(h[1]=180;geohash.length<f;){if(a){mid=(h[0]+h[1])/2;if(m>mid){o|=BITS[d];h[0]=mid}else h[1]=mid}else{mid=(b[0]+b[1])/2;if(n>mid){o|=BITS[d];b[0]=mid}else b[1]=mid}a=!a;if(d<4)d++;else{geohash+=BASE32[o];o=d=0}}return geohash}}}();
T5.Geo.JSON=function(){function l(k,g,q,v){g=m(g);k.add(v.line(g,q));return g.length}function n(k,g,q,v){g=m(g);k.add(v.poly(g,q));return g.length}function m(k){var g=k?k.length:0,q=Array(g);for(g=g;g--;)q[g]=new T5.Geo.Position(k[g][1],k[g][0]);return T5.Geo.P.vectorize(q,h)}function f(k,g,q){return new e(k,g,q)}var a="featurecollection",b="feature",h={async:false},d={processor:null,group:"shapes",layerClass:T5.ShapeLayer},o={point:T5.ex({},d,{processor:function(k,g,q,v){g=m([g.coordinates],h);if(g.length>
0)if(q=v.marker(g[0],q)){k.add(q);return g.length}},group:"markers",layerClass:T5.MarkerLayer}),linestring:T5.ex({},d,{processor:function(k,g,q,v){g=m(g&&g.coordinates?g.coordinates:[]);return l(k,g,q,v)}}),multilinestring:T5.ex({},d,{processor:function(k,g,q,v){g=g&&g.coordinates?g.coordinates:[];for(var y=0,w=g.length;w--;)y+=l(k,g[w],q,v);return y}}),polygon:T5.ex({},d,{processor:function(k,g,q,v){g=g&&g.coordinates?g.coordinates:[];if(g.length>0)return n(k,g[0],q,v);return 0}}),multipolygon:T5.ex({},
d,{processor:function(k,g,q,v){g=g&&g.coordinates?g.coordinates:[];for(var y=0,w=0;w<g.length;w++)y+=n(k,g[w][0],q,v);return y}})},e=function(k,g,q,v){function y(p,r){var z=p.processor,D=A+p.group,E=T5.ex({},p,q,{properties:r.properties});if(z){var J=N[D];if(!J){J=new p.layerClass({id:D});N[D]=J}globalLayers=N;return z(J,r.data,E,v)}return 0}function w(p,r){var z=p&&p.type?p.type.toLowerCase():null;return z&&z===b?w(p.geometry,p.properties):{type:z,isCollection:z?z===a:false,definition:o[z],data:p,
properties:r?r:p.properties}}q=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},q);v=T5.ex({marker:function(p){return new T5.Marker({xy:p})},line:function(p,r){return new T5.Poly(p,r)},poly:function(p,r){return new T5.Poly(p,T5.ex({fill:true},r))}},v);var t=q.vectorsPerCycle,u=q.rowPreParse,A=q.layerPrefix,C=0,I=0,L=null,Q=0,N={},s;if(!k)return null;if(typeof k.length==="undefined")k=[k];I=k.length;s=COG.Loopage.join({frequency:10,execute:function(p,
r){var z=0,D=C;if(!L){for(;D<I;D++){var E=w(u?u(k[D]):k[D]),J=null;if(E.isCollection){Q+=1;L=f(E.data.features,function(K){L=null;for(var U in K)N[U]=K[U]},{layerPrefix:A+Q+"-"});J+=1}else if(E.definition)J=y(E.definition,E);z+=J?J:1;if(z>=t)break}C=D+1;!L&&C>=I&&r.trigger("complete")}}});s.bind("complete",function(){g&&g(N)});return s};return{parse:f}}();
T5.Geo.LocationSearch=function(l){function n(h,d){navigator.geolocation.clearWatch(f);f=0;if(a){clearTimeout(a);a=0}d&&d([h],l)}function m(h){COG.Log.info("caught location tracking error:",h)}l=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},l);var f=0,a=0,b=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(h,d){if(navigator.geolocation&&!f){f=navigator.geolocation.watchPosition(function(o){var e=new T5.Geo.Position(o.coords.latitude,o.coords.longitude);
o=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:e,accuracy:o.coords.accuracy/1E3,matchWeight:100});if(!b||o.accuracy<b.accuracy)b=o;if(!l.requiredAccuracy||b.accuracy<l.requiredAccuracy)n(b,d)},m,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(l.searchTimeout)a=setTimeout(function(){b&&n(b,d)},l.searchTimeout)}}},l))};
T5.Map=function(l){function n(w){try{var t=new T5.Geo.Position(w.coords.latitude,w.coords.longitude),u=w.coords.accuracy/1E3;y.trigger("locationUpdate",w,u);if(q){if(!k){k=new T5.Geo.UI.LocationOverlay({pos:t,accuracy:u});k.update(y.getTileLayer());y.setLayer("location",k)}var A=T5.Geo.B.createBoundsFromCenter(t,Math.max(u,1));y.gotoBounds(A)}else{k.pos=t;k.accuracy=u;k.update(y.getTileLayer());b(t,null,T5.easing("sine.out"))}q=false}catch(C){COG.Log.exception(C)}}function m(w){COG.Log.info("caught location tracking error:",
w)}function f(){var w=y.getViewRect();if(w){w=T5.XY.init(w.x1+w.width/2,w.y1+w.height/2);return T5.GeoXY.toPos(w,v)}return null}function a(w,t,u){y.setZoomLevel(t);T5.Images.cancelLoad();T5.cancelAnimation();b(w,u)}function b(w,t,u,A){w=T5.GeoXY.init(w,T5.Geo.radsPerPixel(y.getZoomLevel()));y.updateOffset(w.x,w.y,u,A,t);y.trigger("wake");y.trigger("boundsChange",y.getBoundingBox());t&&typeof u==="undefined"&&t(y)}l=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},
l);var h={NONE:0,SINGLE:1,WATCH:2},d=T5.XY.init(),o=h.NONE,e=false,k=null,g=0,q=true,v=0;if(!l.provider)l.provider=new T5.Geo.MapProvider;l.adjustScaleFactor=function(w){return Math.pow(2,(w<1?Math.floor:Math.ceil)(Math.log(w)))};var y=T5.ex(new T5.View(l),{getBoundingBox:function(){var w=y.getViewRect();return new T5.Geo.BoundingBox(T5.GeoXY.toPos(T5.XY.init(w.x1,w.y2),v),T5.GeoXY.toPos(T5.XY.init(w.x2,w.y1),v))},getCenterPosition:f,gotoBounds:function(w,t){var u=T5.Geo.B.getZoomLevel(w,y.getDimensions());
a(T5.Geo.B.getCenter(w),u,t)},gotoPosition:a,panToPosition:b,syncXY:function(w){return T5.GeoXY.sync(w,v)},locate:function(){y.trackStart(h.SINGLE);setTimeout(y.trackCancel,1E4)},trackStart:function(w){if(navigator.geolocation&&!g){o=w?w:h.WATCH;q=true;g=navigator.geolocation.watchPosition(n,m,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){g&&navigator.geolocation&&navigator.geolocation.clearWatch(g);y.removeLayer("location");k=null;o=h.NONE;g=0},animateRoute:function(w,
t,u,A){var C=y.getLayer("route");if(C)(w=C.getAnimation(w,t,u,A))&&w.addToView(y)}});y.bind("pan",function(){o===h.SINGLE&&y.trackCancel()});y.bind("tap",function(){});y.bind("idle",function(){if(T5.XY.absSize(T5.XY.diff(d,y.getOffset()))>l.boundsChangeThreshold){d=T5.XY.copy(y.getOffset());y.trigger("boundsChange",y.getBoundingBox())}});T5.zoomable(y,l);y.bind("zoomLevelChange",function(w,t,u){w=u?T5.GeoXY.toPos(u,v):f();v=T5.Geo.radsPerPixel(t);y.triggerAll("resync",y);b(w)});COG.configurable(y,
["provider"],COG.paramTweaker(l,null,{provider:function(){y.cleanup();e=false}}),true);return y};
T5.Geo.MapProvider=function(){var l=1,n=20;return{zoomLevel:0,checkZoomLevel:function(m){return Math.min(Math.max(m,l),n)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:l,max:n}},prepTileGridArgs:function(m,f,a,b,h){var d=null;if(h.tileBackgroundColor){d=T5.Images.newCanvas(a,a);var o=d.getContext("2d");o.fillStyle=h.tileBackgroundColor;o.fillRect(0,0,a,a)}return T5.ex({tileSize:a,width:m,height:f,center:b,tileDrawArgs:{background:d}},
h)},setZoomRange:function(m,f){l=m;n=f}}};T5.MapTileGenerator=function(l){function n(b,h){m=h;a.reset()}var m=0,f=null,a=T5.ex(new T5.TileGenerator(l),{getTileCreatorArgs:function(b){f=b.getCenterPosition();return{zoomLevel:m,position:f}},requireRefresh:function(){return!f}});a.bind("bindView",function(b,h){if(h.getZoomLevel){m=h.getZoomLevel();h.bind("zoomLevelChange",n)}});return a};
T5.Geo.Routing=function(){var l={calculate:function(n){n=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},n);var m=T5.Geo.getEngine("route");m&&m.route(n,function(f){if(n.generalize)f.geometry=T5.Geo.P.generalize(f.geometry,f.getInstructionPositions());if(n.map){l.createMapOverlay(n.map,f);n.autoFit&&n.map.gotoBounds(f.boundingBox)}n.success&&n.success(f)})},createMapOverlay:function(n,m){var f=n.getDimensions();f=new T5.Geo.UI.RouteOverlay({data:m,width:f.width,
height:f.height});n.setLayer("route",f)},parseTurnType:function(n){for(var m=l.TurnType.Unknown,f=T5.Geo.Routing.TurnTypeRules,a=0;a<f.length;a++){f[a].regex.lastIndex=-1;var b=f[a].regex.exec(n);if(b){m=f[a].customCheck?f[a].customCheck(n,b):f[a].turnType;break}}return m},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(n){var m=n=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},n),f=n.description;f=f.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");m.description=f;if(!n.turnType)n.turnType=l.parseTurnType(n.description);return n},RouteData:function(n){n=T5.ex({geometry:[],instructions:[],boundingBox:null},
n);if(!n.boundingBox)n.boundingBox=T5.Geo.B.forPositions(n.geometry);return T5.ex({getInstructionPositions:function(){for(var m=[],f=0;f<n.instructions.length;f++)n.instructions[f].position&&m.push(n.instructions[f].position);return m}},n)}};return l}();T5.Geo.Search=function(){return{bestResults:function(l,n){n||(n=20);for(var m=l.length>0?l[0]:null,f=[],a=0;a<l.length;a++)if(m&&l[a]&&m.matchWeight-l[a].matchWeight<=n)f.push(l[a]);else break;return f}}}();
T5.Geo.UI=function(){var l={AnnotationTween:null,RouteOverlay:function(n){n=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},n);var m=[],f=[],a=new T5.PathLayer(n);(function(){if(n.data&&n.data.instructions){for(var b=n.data.instructions,h=Array(b.length),d=b.length;d--;)h[d]=b[d].position;T5.Geo.P.vectorize(h).bind("complete",function(o,e){f=e})}n.data&&n.data.geometry&&T5.Geo.P.vectorize(n.data.geometry).bind("complete",
function(o,e){m=e;a.updateCoordinates(m,f,true)})})();return a},Poly:function(n,m){m=T5.ex({autoParse:true},m);for(var f=Array(n.length),a=m.autoParse,b=T5.Geo.P.parse,h=n.length;h--;)f[h]=T5.GeoXY.init(a?b(n[h]):n[h]);return new T5.Poly(f,m)},Annotation:function(n){n=T5.ex({pos:null},n);n.xy=T5.GeoXY.init(n.pos);return new T5.ImageAnnotation(n)},LocationOverlay:function(n){n=T5.ex({pos:null,accuracy:null,zindex:90},n);var m=new Image,f=T5.XY.init(),a=T5.XY.init(),b=null;m.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
m.onload=function(){f=T5.XY.init(m.width/2,m.height/2)};var h=T5.ex(new T5.ViewLayer(n),{pos:n.pos,accuracy:n.accuracy,drawAccuracyIndicator:false,draw:function(d,o){var e=a.x-o.x,k=a.y-o.y;if(b){d.fillStyle="rgba(30, 30, 30, 0.2)";d.beginPath();d.arc(e,k,b,0,Math.PI*2,false);d.fill()}m.complete&&m.width>0&&d.drawImage(m,e-f.x,k-f.y,m.width,m.height);h.changed()},update:function(d){if(d){b=Math.floor(d.getPixelDistance(h.accuracy)*0.5);a=d.getGridXYForPosition(h.pos);h.changed()}}});h.bind("gridUpdate",
function(d,o){h.update(o)});return h},AnnotationsOverlay:function(n){function m(d,o){var e=d.length,k=h.getParent();if(o=o?o:k?k.getTileLayer():null)for(e=e;e--;)o.syncVectors([d[e].xy]);d.sort(function(g,q){var v=q.xy.y-g.xy.y;if(v===0)v=q.xy.x-g.xy.x;return v})}n=T5.ex({pois:null,map:null,zindex:100},n);var f=[],a=false,b=[],h=T5.ex(new T5.ViewLayer(n),{cycle:function(){return a},draw:function(d,o,e,k,g){a=false;d.fillStyle="rgba(255, 0, 0, 0.75)";d.globalCompositeOperation="source-over";for(e=
f.length;e--;){f[e].draw(d,o,k,h,g);a=a||f[e].isAnimating()}for(e=b.length;e--;){b[e].draw(d,o,k,h,g);a=a||b[e].isAnimating()}return a?1:0},add:function(d){if(d&&d.length)for(var o=d.length;o--;)b[b.length]=d[o];else if(d)b[b.length]=d;m(b);h.changed()},clear:function(d){b=[];m(b);if(d){f=[];m(f)}h.changed()}});COG.listen("geo.pois-updated",function(d){if(n.pois&&n.pois.id==d.srcID){d=d.pois;try{f=[];for(var o=0;o<d.length;o++)if(d[o].pos){var e;var k=d[o];if(k&&k.pos){var g={poi:k,annotation:null};
n.map&&n.map.trigger("getAnnotationForPOI",g);if(!g.annotation)g.annotation=new T5.Annotation({xy:T5.GeoXY.init(k.pos)});if(g.annotation){g.annotation.isNew=k.isNew;k.isNew=false}e=g.annotation}else e=void 0;e&&f.push(e)}m(f)}catch(q){COG.Log.exception(q)}h.changed()}});h.bind("gridUpdate",function(d,o){m(f,o);m(b,o);h.changed()});return h}};l.ImageAnnotation=l.Annotation;return l}();
T5.Geo.Routing.TurnTypeRules=function(){var l=T5.Geo.Routing.TurnType,n=[];n.push({regex:/continue/i,turnType:l.Continue});n.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(m,f){return/bear/i.test(f[1])?l.TurnLeftSlight:l.TurnLeft}});n.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(m,f){return/bear/i.test(f[1])?l.TurnRightSlight:l.TurnRight}});n.push({regex:/enter\s(roundabout|rotaty)/i,turnType:l.EnterRoundabout});n.push({regex:/take.*?ramp/i,turnType:l.Ramp});n.push({regex:/take.*?exit/i,
turnType:l.RampExit});n.push({regex:/make(.*?)u\-turn/i,customCheck:function(m,f){return/right/i.test(f[1])?l.UTurnRight:l.UTurnLeft}});n.push({regex:/proceed/i,turnType:l.Start});n.push({regex:/arrive/i,turnType:l.Arrive});n.push({regex:/fell\sthrough/i,turnType:l.Merge});return n}();
