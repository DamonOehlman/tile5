(function(bb){function H(){var a=arguments[0]||{},b=Array.prototype.slice.call(arguments,1),c,i;for(i=b.length;i--;)if((c=b[i])!==null)for(var k in c){var h=c[k];if(a!==h)if(h!==undefined)a[k]=h}return a}function ga(a,b){if(typeof console!=="undefined")console[b||"debug"](a)}function cb(a){var b=a.match(Ab),c=[],i=0,k;for(k=b?b.length:0;k--;){var h=b[k].slice(1);c[h]||(c[h]=RegExp("\\{"+h+"\\}","g"))}i=c.length;return function(){var f=a;for(k=0;k<i;k++)f=f.replace(c[k],arguments[k]||"");return f}}
function Oa(a){a=a.replace(/[\-\_\s\.]/g,"").toLowerCase();return xa[a]||xa.linear}function db(a,b,c,i,k){function h(g){g=g?g:(new Date).getTime();if(d+eb<g){var e=g-f,q=c(e,a,j,i),l=f+i<=g;g=!l;if(k){e=k(q,l,e);g=typeof e!="undefined"?e&&g:g}g&&animFrame(h)}}var f=(new Date).getTime(),d=0,j=b-a;animFrame(h);return{}}function fb(a){a=parseFloat(a)*ha;a=oa(a);var b=Ea*a;return ja((1+a)/(1-a)*ka((1-b)/(1+b),Ea))/2}function gb(a){return da/(256<<a)}function hb(a,b){var c=Ea*oa(a);return ya-2*ib(b*ka((1-
c)/(1+c),Ea/2))}function S(a,b){this.mercY=this.mercX=null;if(W(a,Fa))jb.parseXY(a,this);else if(a&&a.toPixels){var c=a.toPixels();this.mercX=c.x;this.mercY=c.y}else{this.x=a||0;this.y=b||0}}function la(a,b,c,i){this.x=a||0;this.y=b||0;this.w=c||0;this.h=i||0;this.x2=this.x+this.w;this.y2=this.y+this.h}function kb(a,b){var c=new lb(Math.sqrt(256<<a)|0);b&&b.zoomLevel===a&&b.copyInto(c);c.zoomLevel=a;return c}function mb(a){a=a||(new Date).getTime();for(var b=0;b<ua.length;){var c=ua[b],i=pa[c],k=
pa[c].image&&pa[c].image.complete&&pa[c].image.width>0,h=a-i.start;h=k||h>=Bb;if(k){k=i.callbacks;nb[c]=i.image;for(var f=0;f<k.length;f++)k[f](i.image,true)}if(h){ua.splice(b,1);delete pa[c]}else b++}ua.length>0&&animFrame(mb)}function Ga(a,b){var c=a&&b?nb[a]:null;if(c&&c&&c.complete&&c.width>0)b(c);else{if(c=pa[a])c.callbacks.push(b);else{c=new Image;c.id="_ldimg"+ ++Cb;pa[a]={start:(new Date).getTime(),image:c,callbacks:[b]};c.src=a;ua[ua.length]=a}animFrame(mb)}}function Pa(a,b,c,i,k,h){this.x=
a;this.y=b;this.w=i||256;this.h=i||256;this.x2=this.x+this.w;this.y2=this.y+this.h;this.url=c;this.id=h||a+"_"+b;this.loaded=false;this.image=null}function ob(a){a=a?a:(new Date).getTime();if(a-pb>eb){for(var b=za.splice(0),c=b.length;c--;)b[c](a);pb=a}za.length&&animFrame(ob)}function qb(a){var b=za.length==0;za[za.length]=a;b&&animFrame(ob)}function Db(a,b,c,i,k){k=H({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},k);var h=(new Date).getTime(),f=a[b],d=b=="translate",
j=k.autoInvalidate,g=c.length&&i.length&&c.length==i.length?c.length:0,e=Array(g),q=Array(g),l=Oa(k.easing),n=k.duration,p=k.progress,v=function(x){var E=x-h;x=h+n<=x;for(var K=a.layer?a.layer.view:null,J,z=g;z--;){J=l(E,c[z],e[z],n);q[z]=d?J|0:J}f.apply(a,q);j&&K&&K.invalidate();if(p){E=[].concat(x?i:q);E.unshift(x);p.apply(a,E)}if(x){a.animations--;f.apply(a,i);k.complete&&k.complete.apply(a,i)}else qb(v)};if(f&&f.apply&&g>0){n=n?n:DEFAULT_DURATION;for(b=g;b--;)e[b]=i[b]-c[b];a.animations++;qb(v)}}
function Ha(a,b){b=H({id:"layer_"+Eb++,zindex:0,animated:false,style:null,minXY:null,maxXY:null},b);this.visible=true;qa(H(this,b))}function ia(a,b){if(a&&a.split){var c=a.split(rb);if(c.length>1){a=c[0];b=c[1]}}else if(a&&a.lat){b=a.lon;a=a.lat}this.lat=parseFloat(a||0);this.lon=parseFloat(b||0)}function Aa(a,b){if(W(a,Fb)){for(var c=b,i=this.min=new ia(sb,tb),k=this.max=new ia(Gb,Hb),h=a.length;h--;){var f=a[h];if(f.lat<i.lat)i.lat=f.lat;if(f.lat>k.lat)k.lat=f.lat;if(f.lon<i.lon)i.lon=f.lon;if(f.lon>
k.lon)k.lon=f.lon}if(W(c,ma)){c=calcSize(bounds.min,bounds.max);c=Qa(c.x,c.y)*0.3}this.expand(c)}else{this.min=a;this.max=b}}var Ra={};(function(a){var b=[],c=0,i=false,k=a.register=function(h,f){b.push({section:h,run:f})};a.init=function(h){function f(){if(c<b.length){var j=b[c++];d[j.section]||(d[j.section]={});j.run(d[j.section],f)}else{for(j in d)a[j]=d[j];i=true;h&&h(a)}}var d={};if(i&&h)h(a);else{c=0;f()}};k("canvas",function(h,f){function d(){var q,l=j.getContext("2d");l.save();try{l.translate(50,
50);l.beginPath();l.rect(0,0,20,20);q=l.isPointInPath(10,10)}finally{l.restore()}return q}var j=document.createElement("canvas"),g=typeof FlashCanvas!="undefined",e=typeof G_vmlCanvasManager!="undefnined";j.width=200;j.height=200;h.pipTransformed=g||e?false:d();f()})})(Ra);window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},
1E3/60)}}();var Ab=/\{(\d+)(?=\})/g,xa=function(){var a=1.70158,b=Math.PI/2,c=Math.abs,i=Math.pow,k=Math.sin,h=Math.asin,f=Math.cos;return{linear:function(d,j,g,e){return g*d/e+j},backin:function(d,j,g,e){return g*(d/=e)*d*((a+1)*d-a)+j},backout:function(d,j,g,e){return g*((d=d/e-1)*d*((a+1)*d+a)+1)+j},backinout:function(d,j,g,e){return(d/=e/2)<1?g/2*d*d*(((a*=1.525)+1)*d-a)+j:g/2*((d-=2)*d*(((a*=1.525)+1)*d+a)+2)+j},bouncein:function(d,j,g,e){return g-xa.bounceout(e-d,0,g,e)+j},bounceout:function(d,
j,g,e){return(d/=e)<1/2.75?g*7.5625*d*d+j:d<2/2.75?g*(7.5625*(d-=1.5/2.75)*d+0.75)+j:d<2.5/2.75?g*(7.5625*(d-=2.25/2.75)*d+0.9375)+j:g*(7.5625*(d-=2.625/2.75)*d+0.984375)+j},bounceinout:function(d,j,g,e){return d<e/2?xa.bouncein(d*2,0,g,e)/2+j:xa.bounceout(d*2-e,0,g,e)/2+g/2+j},cubicin:function(d,j,g,e){return g*(d/=e)*d*d+j},cubicout:function(d,j,g,e){return g*((d=d/e-1)*d*d+1)+j},cubicinout:function(d,j,g,e){if((d/=e/2)<1)return g/2*d*d*d+j;return g/2*((d-=2)*d*d+2)+j},elasticin:function(d,j,g,
e,q,l){if(d==0)return j;if((d/=e)==1)return j+g;l||(l=e*0.3);if(!q||q<c(g)){q=g;g=l/4}else g=l/da*h(g/q);return-(q*i(2,10*(d-=1))*k((d*e-g)*da/l))+j},elasticout:function(d,j,g,e,q,l){var n;if(d==0)return j;if((d/=e)==1)return j+g;l||(l=e*0.3);if(!q||q<c(g)){q=g;n=l/4}else n=l/da*h(g/q);return q*i(2,-10*d)*k((d*e-n)*da/l)+g+j},elasticinout:function(d,j,g,e,q,l){var n;if(d==0)return j;if((d/=e/2)==2)return j+g;l||(l=e*0.3*1.5);if(!q||q<c(g)){q=g;n=l/4}else n=l/da*h(g/q);if(d<1)return-0.5*q*i(2,10*(d-=
1))*k((d*e-n)*da/l)+j;return q*i(2,-10*(d-=1))*k((d*e-n)*da/l)*0.5+g+j},quadin:function(d,j,g,e){return g*(d/=e)*d+j},quadout:function(d,j,g,e){return-g*(d/=e)*(d-2)+j},quadinout:function(d,j,g,e){if((d/=e/2)<1)return g/2*d*d+j;return-g/2*(--d*(d-2)-1)+j},sinein:function(d,j,g,e){return-g*f(d/e*b)+g+j},sineout:function(d,j,g,e){return g*k(d/e*b)+j},sineinout:function(d,j,g,e){return-g/2*(f(Math.PI*d/e)-1)+j}}}();if(typeof animFrame==="undefined")throw Error("animFrame COG required for tweening support");
var qa=function(){function a(c,i){var k=c.hasOwnProperty("obsHandlers")?c.obsHandlers:null;k[i]||(k[i]=[]);return k[i]}var b=0;return function(c){if(!c)return null;if(!(c.hasOwnProperty("obsHandlers")?c.obsHandlers:null))c.obsHandlers={};if(!c.hasOwnProperty("bind")){c.bind=function(i,k){var h="callback"+b++;a(c,i).unshift({fn:k,id:h});return h};c.triggerCustom=function(i,k){var h=a(c,i),f={cancel:false,name:i,source:this},d;for(d in k)f[d]=k[d];if(!h)return null;d=Array.prototype.slice.call(arguments,
2);c.eventInterceptor&&c.eventInterceptor(i,f,d);d.unshift(f);for(var j=h.length;j--&&!f.cancel;)h[j].fn.apply(this,d);return f};c.trigger=function(i){var k=Array.prototype.slice.call(arguments,1);k.splice(0,0,i,null);return c.triggerCustom.apply(this,k)};c.unbind=function(i,k){if(typeof i==="undefined")c.obsHandlers={};else for(var h=a(c,i),f=0;h&&f<h.length;f++)if(h[f].id===k){h.splice(f,1);break}return c}}return c}}(),ub=Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===
a)return b;return-1},W=function(){return function(a,b){b=Ib.call(b);if(b=="finite")return!Jb[Kb](+a);return b=="null"&&a===null||b==typeof a||b=="object"&&a===Object(a)||b=="array"&&Array.isArray&&Array.isArray(a)||Lb.call(a).slice(8,-1).toLowerCase()==b}}(),Mb=function(){function a(k){var h=document.createElement("script"),f=false;h.src=k;h.async=true;h.onload=h.onreadystatechange=function(){if(!f&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f=true;h.onload=h.onreadystatechange=
null;h&&h.parentNode&&h.parentNode.removeChild(h)}};c||(c=document.getElementsByTagName("head")[0]);c.appendChild(h)}var b=0,c,i=this;return function(k,h,f){k+=k.indexOf("?")>=0?"&":"?";var d="json"+ ++b;i[d]=function(j){h(j);i[d]=null;try{delete i[d]}catch(g){}};a(k+(f?f:"callback")+"="+d);return d}}();INTERACT=function(){function a(l){return function(n,p){l.addEventListener(n,p,false)}}function b(l){return function(n,p){l.removeEventListener(n,p,false)}}function c(l){return function(n,p){l.attachEvent("on"+
n,p)}}function i(l,n){return{x:l?l:0,y:n?n:0,count:1}}function k(l,n){e.push(H({handler:null,checks:{},type:l},n))}function h(l){var n=0,p=0;if(l.offsetParent){do{n+=l.offsetLeft;p+=l.offsetTop;l=l.offsetParent}while(l)}return{left:n,top:p}}function f(l,n){return{source:l,target:n.target?n.target:n.srcElement}}function d(l,n){for(var p=l.target?l.target:l.srcElement;p&&p!==n;)p=p.parentNode;return p&&p===n}function j(l,n){return{x:l.x-(n?n.left:0),y:l.y-(n?n.top:0)}}function g(l,n){if(l.preventDefault){l.preventDefault();
l.stopPropagation()}else if(typeof l.cancelBubble!="undefined")l.cancelBubble=true;n&&l.stopImmediatePropagation&&l.stopImmediatePropagation()}var e=[],q=function(l,n,p){p=H({binder:null,unbinder:null,observable:null},p);for(var v=p.observable,x=[],E,K,J={bind:function(){return v.bind.apply(null,arguments)},unbind:function(){v.unbind();for(z=0;z<x.length;z++)x[z].unbind();return J}},z=0;z<n.length;z++)x.push(n[z](l,v,p));v.bind("pointerDown",function(){K=E=0});v.bind("pointerMove",function(o,y,C,
u){E+=u.x||0;K+=u.y||0});v.bind("pointerUp",function(o,y,C){Math.abs(E)>20||Math.abs(K)>20||v.triggerCustom("tap",o,y,C)});return J};k("pointer",{handler:function(l,n,p){function v(s){if(s.pageX&&s.pageY)return i(s.pageX,s.pageY);else{var A=document.documentElement,M=document.body;return i(s.clientX+(A&&A.scrollLeft||M&&M.scrollLeft||0)-(A&&A.clientLeft||M&&M.clientLeft||0),s.clientY+(A&&A.scrollTop||M&&M.scrollTop||0)-(A&&A.clientTop||M&&M.clientTop||0))}}function x(s){if(d(s,l))if(u=z(s)){var A=
v(s);l.style.cursor="move";g(s,true);R=A.x;N=A.y;B=i(R,N);n.triggerCustom("pointerDown",f("mouse",s),B,j(B,h(l)))}}function E(s){var A=v(s);F=A.x;G=A.y;if(d(s,l))o(s,u?"pointerMove":"pointerHover")}function K(s){if(u&&z(s)){u=false;if(d(s,l)){l.style.cursor="default";o(s,"pointerUp")}}}function J(s){if(d(s,l)){var A;s=s||window.event;if(s.detail)A=s.axis===2?-s.detail*y:0;else{A=s.wheelDeltaY?s.wheelDeltaY:s.wheelDelta;if(window.opera)A=-A}if(A!==0){var M=i(F,G);n.triggerCustom("zoom",f("mouse",s),
M,j(M,h(l)),A/C,"wheel");g(s);s.returnValue=false}}}function z(s){s=s||window.event;return(s.which||s.button)==1}function o(s,A,M,O,T){M=typeof M!="undefined"?M:F;O=typeof O!="undefined"?O:G;var w=M-R,I=O-N,D=i(M,O);n.triggerCustom(A,f("mouse",s),D,j(D,h(l)),i(w,I));if(typeof T=="undefined"||T){R=M;N=O}}p=H({},p);var y=120,C=y*8,u=false,B,F,G,R,N;p.binder("mousedown",x);p.binder("mousemove",E);p.binder("mouseup",K);p.binder("dblclick",function(s){ga("captured double click");if(d(s,l)){var A=v(s);
n.triggerCustom("doubleTap",f("mouse",s),A,j(A,h(l)))}});p.binder("mousewheel",J);p.binder("DOMMouseScroll",J);return{unbind:function(){p.unbinder("mousedown",x);p.unbinder("mousemove",E);p.unbinder("mouseup",K);p.unbinder("mousewheel",J);p.unbinder("DOMMouseScroll",J)}}},checks:{touch:false}});k("pointer",{handler:function(l,n,p){function v(w){if(w.count<2)return 0;var I=w.x-w.next.x;w=w.y-w.next.y;return~~Math.sqrt(I*I+w*w)}function x(w,I,D){I=I?I:0;D=D?D:0;for(var Z={x:w.x-I,y:w.y-D,id:w.id,count:w.count},
V=Z;w.next;){w=w.next;V=V.next={x:w.x-I,y:w.y-D,id:w.id}}return Z}function E(w,I){var D=w[I?I:"touches"],Z,V;if(D.length===0)return null;V=Z={x:D[0].pageX,y:D[0].pageY,id:D[0].identifier,count:D.length};for(var X=1,va=D.length;X<va;X++)V=V.next={x:D[X].pageX,y:D[X].pageY,id:D[X].identifier};return Z}function K(w){if(d(w,l)){G=h(l);var I=E(w,"changedTouches"),D=x(I,G.left,G.top);if(!N){R=u;n.triggerCustom("pointerDown",f("touch",w),I,D)}O&&n.triggerCustom("pointerDownMulti",f("touch",w),I,D);N=E(w);
if(N.count>1)A=v(N);T=1;M=x(N)}}function J(w){if(d(w,l)){g(w);s=E(w);if(R==u)R=Math.abs(N.x-s.x)>y||Math.abs(N.y-s.y)>y?C:u;if(R!=u){R=s.count>1?F:B;if(R==F)if(N.count===1){N=x(s);A=v(N)}else{var I=v(s);if(Math.abs(A-I)<o)R=B;else{var D;D=s.x;var Z=s.next.x,V=s.y,X=s.next.y;D={x:(D<Z?D:Z)+(Math.abs(D-Z)>>1),y:(V<X?V:X)+(Math.abs(V-X)>>1)};I=I/A;Z=I-T;n.triggerCustom("zoom",f("touch",w),D,j(D,G),Z,"pinch");T=I}}R==B&&n.triggerCustom("pointerMove",f("touch",w),s,x(s,G.left,G.top),i(s.x-M.x,s.y-M.y));
O&&n.triggerCustom("pointerMoveMulti",f("touch",w),s,x(s,G.left,G.top))}M=x(s)}}function z(w){if(d(w,l)){var I=E(w,"changedTouches"),D=x(I,G.left,G.top);s=E(w);if(!s){n.triggerCustom("pointerUp",f("touch",w),I,D);N=null}O&&n.triggerCustom("pointerUpMulti",f("touch",w),I,D)}}p=H({detailed:false,inertia:false},p);var o=20,y=7,C=0,u=1,B=2,F=3,G,R,N,s,A,M,O=p.detailed,T=1;p.binder("touchstart",K);p.binder("touchmove",J);p.binder("touchend",z);ga("initialized touch handler");return{unbind:function(){p.unbinder("touchstart",
K);p.unbinder("touchmove",J);p.unbinder("touchend",z)}}},checks:{touch:true}});return{register:k,watch:function(l,n,p){n=H({bindTarget:null,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},n);capabilities=H({touch:"ontouchstart"in window},p);if(!n.observable){ga("creating observable");n.observable=qa({});globalOpts=n}n.binder=(n.isIE?c:a)(n.bindTarget||document);n.unbinder=(n.isIE?c:b)(n.bindTarget||document);p=n.types;for(var v=capabilities,x=[],E=e.length;E--;){var K=e[E],
J=!p||p.indexOf(K.type)>=0,z=true,o;for(o in K.checks){var y=K.checks[o];ga("checking "+o+" capability. require: "+y+", capability = "+v[o]);z=z&&y===v[o]}if(J&&z)x[x.length]=K.handler}return new q(l,x,n)}}}();var Y={ex:H,log:ga,observable:qa,formatter:cb,wordExists:function(a,b){for(var c=a.split(/\s|\,/).length;c--;)if(a.toLowerCase()==b.toLowerCase())return true;return false},is:W,indexOf:ub};qa(Y);var Sa=function(){var a={};return{create:function(b,c){if(a[b][c])return a[b][c].apply(null,Array.prototype.slice.call(arguments,
2))},register:function(b,c,i){a[b]||(a[b]={});a[b][c]&&ga(Nb(b,c),"warn");a[b][c]=i}}}(),Nb=cb("Registration of {0}: {1} will override existing definition"),Ta=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],da=Math.PI*2,ya=Math.PI/2,ha=Math.PI/180,Ia=180/Math.PI,sb=ya,Gb=-sb,tb=da,Hb=-tb,Ea=0.08181919084262157,na=Math.abs,vb=Math.ceil,wa=Math.round,Ja=Math.min,Qa=Math.max,ka=Math.pow,wb=Math.sqrt,ja=Math.log,oa=Math.sin,Ob=Math.asin,Ua=Math.cos,ib=Math.atan,
Pb=Math.atan2,Kb="hasOwnProperty",Jb={NaN:1,Infinity:1,"-Infinity":1},Ib=String.prototype.toLowerCase,Lb=Object.prototype.toString,ma="undefined",Fa="string",Va="number",Fb="array",aa=Sa.register,ra=Sa.create,Qb=0,Eb=0,rb=/[\,\s]+/,Rb=Y.newCanvas=function(a,b){var c=document.createElement("canvas");c.width=a?a:0;c.height=b?b:0;Y.trigger("createCanvas",c);return c},Sb=function(){function a(k){i++;k=k||(new Date).getTime();for(var h=c.length;h--;){var f=c[h];i%f.every===0&&f.cb(k)}animFrame(a)}var b=
1E3/60,c=[],i=0;animFrame(a);return{attach:function(k,h){c[c.length]={cb:k,every:h?wa(h/b):1}},detact:function(){}}}(),jb=function(){var a=/^xy\((.*)\).*$/i;return{parseXY:function(b,c){c=c||new S;if(!a.test(b)){var i=b.split(rb);c.mercX=parseFloat(i[1])*ha;c.mercY=fb(i[0])}return c}}}(),ea=function(){var a={"-webkit-user-select":"none",position:"absolute"},b;b=function(c){for(var i=0;i<c.length;i++){var k=c[i];if(typeof document.body.style[k]!="undefined")return k}}(["-webkit-transform","MozTransform"]);
return{supportTransforms:b,create:function(c,i,k){c=document.createElement(c);var h=[];k=k||{};c.className=i||"";for(var f in k)h[h.length]=f+": "+k[f];c.style.cssText=h.join(";");return c},move:function(c,i,k,h){if(b)c.style[b]="translate("+i+"px, "+k+"px) translateZ(0) "+(h||[]).join(" ");else{c.style.left=i+"px";c.style.top=k+"px"}},styles:function(c){return H({},a,c)}}}();S.prototype={constructor:S,add:function(){for(var a=this.x,b=this.y,c=arguments.length;c--;){a+=arguments[c].x;b+=arguments[c].y}return new S(a,
b)},equals:function(a){return this.x===a.x&&this.y===a.y},offset:function(a,b){return new S(this.x+a,this.y+b)},sync:function(a,b){if(b){this.mercX=this.x*a-Math.PI;this.mercY=Math.PI-this.y*a}else if(this.mercX||this.mercY){this.x=wa((this.mercX+Math.PI)/a);this.y=wa((Math.PI-this.mercY)/a)}return this},pos:function(){for(var a=ka(Math.E,-this.mercY),b=ya-2*ib(a),c=hb(b,a),i=0;i<12&&na(b-c)>1.0E-7;){b=c;c=hb(b,a);i++}return new ia(c*Ia,this.mercX%360*Ia)},toString:function(){return this.x+", "+this.y}};
la.prototype={constructor:la,buffer:function(a,b){return new la(this.x-a,this.y-(b||a),this.w+a*2,this.h+(b||a)*2)},center:function(){return new S(this.x+(this.w>>1),this.y+(this.h>>1))}};Hits=function(){return{diffHits:function(a,b){var c=[],i={},k;for(k=b.length;k--;)i[b[k].target.id]=true;for(k=a.length;k--;)i[a[k].target.id]||(c[c.length]=a[k]);return c},init:function(a,b,c,i){return{type:a,x:i.x|0,y:i.y|0,elements:[],absXY:b,relXY:c}},initHit:function(a,b,c){return{type:a,target:b,drag:c}},triggerEvent:function(a,
b,c,i){b.triggerCustom(a.type+(c?c:"Hit"),{hitType:a.type},i?i:a.elements,a.absXY,a.relXY,new S(a.x,a.y))}}}();var lb=function(a){function b(h,f){var d=c[h],j;d||(d=c[h]=[]);(j=d[f])||(j=d[f]=[]);return j}a=a||128;var c=[],i={},k=0;return{copyInto:function(h){for(var f in i){var d=i[f];h.insert(d.bounds||d,d,f)}},insert:function(h,f,d){var j=h.x/a|0,g=h.y/a|0,e=(h.x+h.w)/a|0;h=(h.y+h.h)/a|0;d=d||f.id||"obj_"+k++;i[d]=f;for(f=j;f<=e;f++)for(j=g;j<=h;j++)b(f,j).push(d)},remove:function(h,f,d){d=d||
f.id;if(i[d]){var j=h.x/a|0;f=h.y/a|0;var g=(h.x+h.w)/a|0;h=(h.y+h.h)/a|0;delete i[d];for(j=j;j<=g;j++)for(var e=f;e<=h;e++){var q=b(j,e),l=ub.call(q,d);l>=0&&q.splice(l,1)}}},search:function(h){var f=h.y/a|0,d=(h.x+h.w)/a|0,j=(h.y+h.h)/a|0,g=[],e=[];for(h=h.x/a|0;h<=d;h++)for(var q=f;q<=j;q++)g=g.concat(b(h,q));g.sort();for(f=g.length;f--;){d=g[f];if(j=i[d])e[e.length]=j;for(;f>0&&g[f-1]==d;)f--}return e}}},Bb=3E4,nb={},Cb=0;(new Date).getTime();var pa={},ua=[];Pa.prototype={constructor:Pa,load:function(a){var b=
this;Ga(this.url,function(c){b.loaded=true;b.image=c;a&&a()})}};var Tb=function(){return qa({fastpan:true,applyStyle:function(){},applyTransform:function(a,b,c){return{restore:null,x:b,y:c}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getViewport:function(){},hitTest:function(){return false},prepare:function(){},projectXY:null,reset:function(){}})},Ub=Y.attachRenderer=function(a,b,c,i,k){a=a.split("/");for(var h=new Tb(b,c,i,k),f=0;f<a.length;f++)h=ra("renderer",a[f],
b,c,i,k,h);return h};aa("renderer","canvas",function(a,b,c,i,k){function h(o,y,C){var u,B;n[y]=function(F){for(u=J.length;u--;)if(B=C[J[u]])F[z[u]]=B}}function f(o,y,C){var u=false;if(y)u=e.isPointInPath(v?y.x-q:y.relXY.x,v?y.y-l:y.relXY.y);return{draw:C||K,viewport:o,hit:u,vpX:q,vpY:l,context:e}}i=H({},i);var d,j,g,e,q=0,l=0,n={},p=null,v=Ra.canvas.pipTransformed,x={},E=function(){},K=function(){this.fill&&e.fill();this.stroke&&e.stroke()},J=["fill","stroke","lineWidth","opacity"],z=["fillStyle",
"strokeStyle","lineWidth","globalAlpha"];if(b){d=b.offsetWidth;j=b.offsetHeight;g=Rb(d,j);g.style.cssText="position: absolute; z-index: 1;";a.attachFrame(g,true);e=null}c=H(k,{applyStyle:function(o){var y=n[o],C=e&&e.canvas?e.canvas.id:"default",u;x[C]||(x[C]=[]);u=x[C].pop()||"basic";if(y){x[C].push(o);y(e);return u}},applyTransform:function(o){if(o.translateX!==0||o.translateY!==0||o.scaling!==1||o.rotation!==0){e.save();p={undo:function(){e.restore();p=null},x:o.xy.x,y:o.xy.y};e.translate(o.xy.x-
q+o.translateX,o.xy.y-l+o.translateY);o.rotation!==0&&e.rotate(o.rotation);o.scaling!==1&&e.scale(o.scaling,o.scaling)}return p},drawTiles:function(o,y,C){for(var u,B=q-256,F=l-256,G=o.x2,R=o.y2,N=y.length;N--;){o=y[N];if(u=o.x>=B&&o.x<=G&&o.y>=F&&o.y<=R)if(!o.loaded&&C)o.load(a.invalidate);else o.image&&e.drawImage(o.image,o.x-q,o.y-l)}},prepare:function(o,y){var C,u=false,B=y.scaled||y;if(e)e.restore();else e=g.getContext("2d");for(C=o.length;C--;)u=u||o[C].clip;q=B.x;l=B.y;if(e){u||e.clearRect(0,
0,d,j);e.save()}e.globalCompositeOperation="source-over";return e},prepArc:function(o,y,C){e.beginPath();e.arc(o.xy.x-(p?p.x:q),o.xy.y-(p?p.y:l),o.size>>1,o.startAngle,o.endAngle,false);return f(y,C)},prepImage:function(o,y,C,u){var B=(u.x||o.xy.x)-(p?p.x:q),F=(u.y||o.xy.y)-(p?p.y:l),G=u.image||o.image;if(G){e.beginPath();e.rect(B,F,u.width||G.width,u.height||G.height);return f(y,C,function(){e.drawImage(G,B,F,u.width||G.width,u.height||G.height)})}},prepMarker:function(o,y,C){var u=o.xy.x-(p?p.x:
q),B=o.xy.y-(p?p.y:l),F=o.size,G=undefined;e.beginPath();switch(o.markerStyle.toLowerCase()){case "image":G=E;e.rect(u-(F>>1),B-(F>>1),F,F);if(o.reset&&o.image){o.image=null;o.reset=false}o.image?e.drawImage(o.image,u-(F>>1),B-(F>>1),F,F):Ga(o.imageUrl,function(R){o.image=R;e.drawImage(o.image,u-(F>>1),B-(F>>1),F,F)});break;default:e.moveTo(u,B);e.lineTo(u-(F>>1),B-F);e.lineTo(u+(F>>1),B-F);e.lineTo(u,B)}return f(y,C,G)},prepPoly:function(o,y,C,u){var B=true;o=u.points||o.points;u=p?p.x:q;var F=p?
p.y:l;e.beginPath();for(var G=o.length;G--;){var R=o[G].x-u,N=o[G].y-F;if(B){e.moveTo(R,N);B=false}else e.lineTo(R,N)}return f(y,C)},getContext:function(){return e}});(function(){for(var o in Y.styles)h(null,o,Y.styles[o]);Y.bind("styleDefined",h)})();c.bind("detach",function(){b.removeChild(g)});return c});aa("renderer","dom",function(a,b,c,i,k){function h(e){var q=e.image=new Image;j[e.id]=e;q.src=e.url;q.onload=function(){if(g[e.id])d.appendChild(this);else e.image=null};q.style.cssText="-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;";
return q}function f(e,q,l){var n=[],p;for(p in e){var v=e[p];if(l?v[l]:!q[p]){if(v.image&&v.image.parentNode){d.removeChild(v.image);v.image=null}n[n.length]=p}}for(q=n.length;q--;)delete e[n[q]]}var d=null,j={},g={};d=ea.create("div","",ea.styles({width:b.offsetWidth+"px",height:b.offsetHeight+"px"}));b.childNodes.length>0?b.insertBefore(d,b.childNodes[0]):b.appendChild(d);a.attachFrame(d);a=H(k,{drawTiles:function(e,q,l){for(var n,p=e.x,v=e.y,x=q.length;x--;){e=q[x];if(e.url){(n=e.image||(l?h(e):
null))&&ea.move(n,e.x-p,e.y-v);g[e.id]=e}}}});a.bind("predraw",function(){f(j,g);g={}});a.bind("detach",function(){b.removeChild(d)});a.bind("reset",function(){for(f(j,g={});d.childNodes.length>0;)d.removeChild(d.childNodes[0])});return a});var Wa=Y.styles={},Vb=Y.defineStyle=function(a,b){Wa[a]=b;Y.trigger("styleDefined",a,Wa[a]);return a},xb=Y.defineStyles=function(a){for(var b in a)Vb(b,a[b])};Y.getStyle=function(a){return Wa[a]};Y.loadStyles=function(a){Mb(a,function(b){xb(b)})};xb({basic:{fill:"#ffffff"},
highlight:{fill:"#ff0000"},waypoints:{lineWidth:4,stroke:"#003377",fill:"#ffffff"},waypointsHover:{lineWidth:4,stroke:"#ff0000",fill:"#ffffff"}});aa("view","simple",function(a){function b(m,r,t,L){E(Ja(Qa(U+ka(2,L)-1,0.5),2))}function c(m){var r=m|0;m=r+Math.round((m-r)*50)/50;if(m!==U){U=m;m=ja(U)/Math.LN2|0;if(m!==0){U=ka(2,m);n(Ba+m,Wb,Xb)}fa++}}function i(m,r){var t=renderer&&renderer.projectXY?renderer.projectXY(m,r):null;if(!t){t=P.getViewport();var L=1/U;t=new S(t?t.x+m*L:m,t?t.y+r*L:r)}return t}
function k(m,r,t){K("doubleTap",r,t,i(t.x,t.y));a.scalable&&E(2,i(t.x,t.y),Yb,null,Zb)}function h(m,r,t){B=null;N=true;l("down",r,t)}function f(m,r,t){l("hover",r,t)}function d(m,r,t,L){q(r,t,false);if(!B){s=L.x;A=L.y}}function j(m,r,t){q(r,t,true);N=false}function g(){clearTimeout(yb);yb=setTimeout(function(){renderer.checkSize()},250)}function e(m,r,t){l("tap",r,t);K("tap",r,t,i(t.x,t.y,true))}function q(m,r,t){if(B){m=i(r.x,r.y);B.drag.call(B.target,B,m.x,m.y,t)&&fa++;if(t)B=null}}function l(m,
r,t){ba=Hits.init(m,r,t,i(t.x,t.y,true));for(m=o;m--;)G=G||(z[m].hitGuess?z[m].hitGuess(ba.x,ba.y,P):false);G&&fa++}function n(m,r,t){if(W(m,Va)){m=Qa(a.minZoom,Ja(a.maxZoom,m|0));if(m!==Ba){var L=ka(2,m-Ba),Q=Xa/L|0,$=Ya/L|0;Ba=m;J(((r||O+Xa)-Q)*L,((t||T+Ya)-$)*L);Z=D=0;K("zoom",m);U=1;renderer.trigger("reset");x()}return P}else return Ba}function p(){var m=new la(O,T,Ka,La);m.scaleFactor=U;return m}function v(m,r,t){if(W(r,ma))for(r=0;r<o;r++){if(z[r].id===m)return z[r]}else if(W(m,Fa)){r=ra("layer",
r,P,t);r.added=(new Date).getTime();r.id=m;z[z.length]=r;z.sort(function(L,Q){return Q.zindex-L.zindex||Q.added-L.added});o=z.length;r.trigger("resync");r.trigger("refresh",P,p());P.trigger("layerChange",P,r);fa++;return r}else return[].concat(z)}function x(){var m=p();if(m){if(V||X)if(m){var r=va?O+(m.w>>1):O,t=Ma?T+(m.h>>1):T,L=m.w,Q=m.h;if(V&&V>L)if(r+L>V)O=va?O:V-L;else if(r<0)O=va?O:0;if(X&&X>Q)if(t+Q>X)T=Ma?T:X-Q;else if(t<0)T=Ma?T:0}D=O;Z=T;K("refresh",P,m);fa++}}function E(m,r,t,L,Q){var $;
if(!$b){t=false;$=wa(ja(m)/Math.LN2);m=ka(2,$)}t?db(U,m,t,Q,function(sa,Na){m=sa;if(Na){$=wa(ja(m)/Math.LN2);m=ka(2,$);L&&L()}c(m)}):c(m);return P}function K(){for(var m=P.trigger.apply(null,arguments).cancel,r=z.length;r--;)m=z[r].trigger.apply(null,arguments).cancel||m;return!m}function J(m,r,t){if(W(m,Va)){if(!(t&&panSpeed===0)){O=m|0;T=r|0}}else return new S(O,T)}a=H({container:"",captureHover:true,drawOnScale:true,padding:0,inertia:true,refreshDistance:256,pannable:false,scalable:false,minZoom:1,
maxZoom:1,renderer:"canvas/dom",zoom:1},a);var z=[],o=0,y=null,C=null,u,B=null,F=!W(window.attachEvent,ma),G=false,R=true,N=false,s=0,A=0,M=a.refreshDistance,O=0,T=0,w=0,I=0,D=0,Z=0,V=null,X=null,va=false,Ma=false,Ca=a.padding,ba=null,Da=null,yb=0,U=1,zb=1,ca=null,Za={index:0,draw:false},$b=true,fa=0,Ka,La,Xa,Ya,$a,ab,Wb,Xb,Ba=a.zoom||a.zoomLevel,Yb=Oa("quad.out"),Zb=300,P={id:a.id,padding:Ca,panSpeed:0,attachFrame:function(m,r){r&&y.appendChild(m)},center:function(m,r,t){if(W(m,Fa)){r=jb.parseXY(m).sync(P.rpp);
m=r.x;r=r.y}if(W(m,Va)){J(m-$a,r-ab,t);return P}else{r=J().offset($a,ab);P.rpp&&r.sync(P.rpp,true);return r}},detach:function(){renderer&&renderer.trigger("detach");ca&&ca.unbind();if(C){u.removeChild(C);y=C=null}},layer:v,invalidate:function(){fa++},refresh:x,resetScale:function(){U=1},scale:E,triggerAll:K,removeLayer:function(m){a:{for(var r=o;r--;)if(z[r].id===m){m=r;break a}m=-1}if(m>=0&&m<o){P.trigger("layerRemove",P,z[m]);z.splice(m,1);fa++}o=z.length},getRenderer:function(){return renderer},
getScaleFactor:function(){return U},setMaxOffset:function(m,r,t,L){V=m;X=r;va=t;Ma=L},getViewport:p,offset:J,pan:function(m,r){s=m;A=r;fa++},zoom:n};qa(P);P.bind("resize",function(){renderer.checkSize()});Ra.init(function(){v("markers","draw",{zindex:20});u=document.getElementById(a.container);u.appendChild(C=ea.create("div","",ea.styles({overflow:"hidden",width:u.offsetWidth+"px",height:u.offsetHeight+"px"})));Ka=C.offsetWidth+Ca*2;La=C.offsetHeight+Ca*2;Xa=Ka/2;Ya=La/2;$a=u.offsetWidth/2;ab=u.offsetHeight/
2;C.appendChild(y=ea.create("div","",ea.styles({width:Ka+"px",height:La+"px","z-index":2,margin:-Ca+"px 0 0 "+-Ca+"px"})));renderer=Ub(a.renderer,P,y,u,a);R=renderer.fastpan;ca&&ca.unbind();if(renderer){ca=INTERACT.watch(renderer.interactTarget||u);if(a.scalable){ca.bind("zoom",b);ca.bind("doubleTap",k)}ca.bind("pointerDown",h);ca.bind("pointerMove",d);ca.bind("pointerUp",j);a.captureHover&&ca.bind("pointerHover",f);ca.bind("tap",e)}F?window.attachEvent("onresize",g):window.addEventListener("resize",
g,false)});Sb.attach(function(m){var r=[],t,L,Q;self.panSpeed=panSpeed=na(s)+na(A);t=U!==zb;if(panSpeed>0||t)fa++;if(panSpeed<2&&(na(O-D)>=M||na(T-Z)>=M))x();Za.index++;Za.draw=fa||panSpeed||0;if(renderer&&Za.draw){w+=s;I+=A;if(s||A)P.trigger("pan");if(U!==1&&ea.supportTransforms)r[r.length]="scale("+U+")";if(t=!R||(a.drawOnScale||U===1)&&panSpeed<5){O=O-w/U|0;T=T-I/U|0;Q=p();renderer.trigger("predraw",Q);if(renderer.prepare(z,Q,m,ba)){L=I=t=w=fa=0;for(ii=o;ii--;){var $=z[ii];if($.visible){var sa=
$.style?renderer.applyStyle($.style,true):null;$.draw(renderer,Q,P,m,ba);sa&&renderer.applyStyle(sa)}}renderer.trigger("render",Q);P.trigger("drawComplete",Q,m);zb=U;ea.move(y,t,L,r)}}else ea.move(y,w,I,r);if(N||!a.inertia)A=s=0;else if(s!=0||A!=0){s*=0.8;A*=0.8;if(na(s)<0.5)s=0;if(na(A)<0.5)A=0}if(ba){m=ba?ba.elements:[];if(Da&&Da.type==="hover"){r=Hits.diffHits(Da.elements,m);r.length>0&&Hits.triggerEvent(Da,P,"Out",r)}if(m.length>0){t=ba.x;L=ba.y;for(r=m.length;r--;){Q=m[r];$=t;sa=L;var Na=Q&&
Q.drag&&(!Q.canDrag||Q.canDrag(Q,$,sa));if(Na){B=Q;B.startX=$;B.startY=sa}if(Na)break}Hits.triggerEvent(ba,P)}Da=m.length>0?H({},ba):null;ba=null}}});return P});aa("view","map",function(a){function b(d,j,g){f.zoom(j);c(d,g)}function c(d,j,g,e){d=new S(d);d.sync(gb(f.zoom()));f.center(d.x,d.y,g,e,function(){j&&j(f)})}a=H({zoomLevel:1,minZoom:1,maxZoom:18,pannable:true,scalable:true},a);var i=new S,k=0,h=a.tapExtent;a.adjustScaleFactor=function(d){return Math.pow(2,(d<1?Math.floor:Math.ceil)(Math.log(d)))};
var f=H(ra("view","simple",a),{getBoundingBox:function(){var d=f.getViewport();return d?new Aa((new S(d.x,d.y2)).sync(k,true).pos(),(new S(d.x2,d.y)).sync(k,true).pos()):null},getCenterPosition:function(){var d=f.getViewport();if(d)return(new S(d.x+(d.w>>1),d.y+(d.h>>1))).sync(k,true).pos();return null},gotoBounds:function(d,j){b(d.center(),d.bestZoomLevel(f.getViewport()),j)},gotoPosition:b,panToPosition:c});f.bind("tap",function(d,j,g,e){d=e.sync(k,true).pos();var q=e.offset(-h,h).sync(k,true).pos();
e=e.offset(h,-h).sync(k,true).pos();f.trigger("geotap",j,g,d,new Aa(q,e))});f.bind("refresh",function(d,j,g){if(i.x!=g.x||i.y!=g.y){f.trigger("boundsChange",f.getBoundingBox());i.x=g.x;i.y=g.y}});f.bind("zoom",function(d,j){var g;k=f.rpp=gb(j);g=da/k|0;f.setMaxOffset(g,g,true,false);f.resetScale();f.triggerAll("resync")});return f});var ta=function(a,b,c){c=H({style:null,xy:null,size:20,fill:false,stroke:true,draggable:false,observable:true,properties:{},typeName:"Shape"},c);H(this,c);if(W(this.xy,
Fa))this.xy=new S(this.xy);this.id="drawable_"+Qb++;this.bounds=null;this.view=a;this.layer=b;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&qa(this)};ta.prototype={constructor:ta,animate:function(a,b,c,i){Db(this,a,b,c,i)},drag:null,draw:null,getProps:null,resync:function(){if(this.xy){this.xy.sync(this.view.rpp);if(this.size){var a=this.size>>1;this.updateBounds(new la(this.xy.x-a,this.xy.y-a,this.size,this.size))}}},rotate:function(a){this.rotation=
a},scale:function(a){this.scaling=a},translate:function(a,b){this.translateX=a;this.translateY=b},updateBounds:function(a,b){a&&(!this.bounds||a.x!=this.bounds.x||a.y!=this.bounds.y)&&this.trigger("move",this,a,this.bounds);this.bounds=a;if(b)this.xy=this.bounds.center()}};var eb=1E3/60|0,za=[],pb=0;aa("drawable","marker",function(a,b,c){c=H({fill:true,stroke:false,markerStyle:"simple",hoverStyle:"highlight",typeName:"Marker"},c);return new ta(a,b,c)});aa("drawable","poly",function(a,b,c){c=H({simplify:false,
fill:true,points:[],typeName:"Poly"},c);var i=c.points,k=c.simplify;ta.call(this,c);H(this,{getPoints:function(){return[].concat(i)},resync:function(){var h,f,d,j,g,e,q,l;for(h=i.length;h--;)i[h].sync(a.rpp);l=this.points=k?k(i):i;for(h=l.length;h--;){f=l[h].x;d=l[h].y;e=W(e,ma)||f<e?f:e;q=W(q,ma)||d<q?d:q;j=W(j,ma)||f>j?f:j;g=W(g,ma)||d>g?d:g}this.updateBounds(new la(e,q,j-e,g-q),true)}});this.haveData=i&&i.length>=2});aa("drawable","line",function(a,b,c){c.fill=false;return ra("drawable","poly",
a,b,c)});aa("drawable","image",function(a,b,c){function i(){if(j&&j.width>0){if(!this.centerOffset)this.centerOffset=new S(-j.width>>1,-j.height>>1);this.updateBounds(new la(this.xy.x+this.centerOffset.x,this.xy.y+this.centerOffset.y,j.width,j.height),false)}}function k(e){if(this.imageUrl=e){var q=this;Ga(this.imageUrl,function(l,n){j=l;if(n){var p=g.layer?g.layer.view:null;p&&p.invalidate()}i.apply(q)})}}c=H({image:null,imageUrl:null,centerOffset:null,typeName:"Image"},c);var h=ta.prototype.resync,
f=0,d=0,j=c.image,g=H(new ta(a,b,c),{changeImage:k,getProps:function(){this.bounds||i(this,j);return{image:j,x:this.xy.x+f,y:this.xy.y+d}},resync:function(e){h.call(this,e);i.call(this)}});j||k.call(this,this.imageUrl);if(this.centerOffset){f=this.centerOffset.x;d=this.centerOffset.y}});aa("drawable","arc",function(a,b,c){c=H({startAngle:0,endAngle:Math.PI*2,typeName:"Arc"},c);return new ta(a,b,c)});Ha.prototype={constructor:Ha,clip:null,cycle:function(){},draw:function(){},hitGuess:null};aa("layer",
"tile",function(a,b){b=H({generator:"osm",imageLoadArgs:{}},b);var c=ra("generator",b.generator,b).run,i=null,k=[],h=H(new Ha(a,b),{draw:function(f,d,j){f.drawTiles&&f.drawTiles(d,i.search(d.buffer(128)),j.panSpeed<2)}});h.bind("refresh",function(f,d,j){var g=(new Date).getTime();i&&c(d,j,i,function(){d.invalidate();ga("GEN COMPLETED IN "+((new Date).getTime()-g)+" ms")})});h.bind("resync",function(){var f=a&&a.zoom?a.zoom():0;k[f]||(k[f]=kb(f));i=k[f]});return h});aa("layer","draw",function(a,b){function c(g,
e,q,l){var n=this.dragOffset;if(!n)n=this.dragOffset=new S(g.startX-this.xy.x,g.startY-this.xy.y);this.xy.x=e-n.x;this.xy.y=q-n.y;if(l){delete this.dragOffset;a.invalidate();this.trigger("dragDrop")}return true}function i(g){clearTimeout(d);d=setTimeout(function(){h.sort(function(e,q){if(q.xy&&e.xy){var l=q.xy.y-e.xy.y;return l!=0?l:q.xy.x-e.xy.x}});g&&g.invalidate()},50)}function k(g,e,q,l){l&&f.remove(l,e);f.insert(q,e)}b=H({zindex:10},b);var h=[],f,d=0,j=H(new Ha(a,b),{itemCount:0,clear:function(){f=
new lb;h=[];j.itemCount=0},create:function(g,e,q){g=ra("drawable",g,a,j,e);if(q)h.unshift(g);else h[h.length]=g;g.resync();f&&g.bounds&&f.insert(g.bounds,g);i(a);g.bind("move",k);j.itemCount=h.length;return g},draw:function(g,e,q,l,n){q={};l=f&&e?f.search(e):[];for(var p=l.length;p--;){var v=l[p],x=v.style||j.style,E,K=g.applyTransform(v),J=v.getProps?v.getProps(g):q;if(J=(E=g["prep"+v.typeName])?E.call(g,v,e,n,J):null){if(n&&J.hit){n.elements.push(Hits.initHit(v.type,v,v.draggable?c:null));E=n.type+
"Style";x=v[E]||j[E]||x}x=x?g.applyStyle(x,true):null;(E=v.draw||J.draw)&&E.call(v,J);x&&g.applyStyle(x)}K&&K.undo&&K.undo()}},find:function(){return[].concat(h)},hitGuess:function(g,e){return f&&f.search({x:g-10,y:e-10,w:20,h:20}).length>0}});j.bind("resync",function(){f=kb(a.zoom(),f);for(var g=h.length;g--;)h[g].resync()});return j});ia.prototype={constructor:ia,distanceTo:function(){if(!targetPos||this.empty()||targetPos.empty())return 0;var a=(targetPos.lat-this.lat)*ha>>1,b=(targetPos.lon-this.lon)*
ha>>1;a=oa(a)*oa(a)+Ua(this.lat*ha)*Ua(targetPos.lat*ha)*oa(b)*oa(b);return 6371*2*Pb(wb(a),wb(1-a))},equalTo:function(a){return pos&&this.lat===a.lat&&this.lon===a.lon},empty:function(){return this.lat===0&&this.lon===0},inArray:function(a){for(var b=a.length;b--;)if(this.equal(a[b]))return true;return false},offset:function(a,b){var c=this.lat*ha,i=this.lon*ha,k=c+a/6371;c=Ob(oa(b/6371)/Ua(c));i=i+c;k=(k+ya)%Math.PI-ya;i%=da;return new ia(k*Ia,i*Ia)},toPixels:function(){return new S(parseFloat(this.lon)*
ha,fb(this.lat))},toString:function(a){return this.lat+(a||" ")+this.lon}};aa=function(){return{generalize:function(a,b,c){var i=a.length,k=[],h=null;c||(c=250);c/=1E3;ga("generalizing positions, must include "+b.length+" positions");for(var f=i;f--;)if(f===0)k.unshift(a[f]);else{var d=!h||a[f].inArray(b)?c:h.distanceTo(a[f]);if(a[f]&&d>=c){k.unshift(a[f]);h=a[f]}}ga("generalized "+i+" positions into "+k.length+" positions");return k},parseArray:function(a){var b=a.length,c=Array(b);for(b=b;b--;)c[b]=
new ia(a[b]);return c},vectorize:function(a,b){function c(){for(var f=0,d=b.chunkSize,j=i;j--;){k[j]=new S(a[j]);f+=1;if(f>d)break}i=j;if(i<=0)b.callback&&b.callback(k);else animFrame(c)}var i=a.length,k=Array(i);b=H({chunkSize:500,async:true,callback:null},b);if(!b.async){for(var h=i;h--;)k[h]=new S(a[h]);return k}animFrame(c);return null}}}();Aa.prototype={constructor:Aa,bestZoomLevel:function(a){var b=this.center();b=Ja(wa(na(b.lat)*0.05),Ta.length);var c=Ta[b],i=this.size();b=vb(ja(Ta[3]*a.h/
i.y)/ja(2));a=vb(ja(c*a.w/i.x)/ja(2));return Ja(isNaN(b)?1E3:b,isNaN(a)?1E3:a)},center:function(){var a=this.size();return new ia(this.min.lat+(a.y>>1),this.min.lon+(a.x>>1))},expand:function(a){this.min.lat-=a;this.max.lat+=a;this.min.lon-=a%360;this.max.lon+=a%360},size:function(a){var b=new S(0,this.max.lat-this.min.lat);b.x=(a||isType(a,ma))&&this.min.lon>this.max.lon?360-this.min.lon+this.max.lon:this.max.lon-this.min.lon;return b},toString:function(){return"min: "+this.min+", max: "+this.max}};
H(Y,{userMessage:function(a,b,c){Y.trigger("userMessage",a,b,c)},Registry:Sa,DOM:ea,Rect:la,XY:S,Hits:Hits,tweenValue:db,easing:Oa,Tile:Pa,getImage:Ga,Pos:ia,PosFns:aa,BBox:Aa});bb.T5=Y;bb.Tile5=function(a,b){b=H({container:a,type:"map",renderer:"canvas",starpos:null,zoom:1,fastpan:false,drawOnScale:true,zoombar:{}},b);return ra("view",b.type,b)}})(window);
