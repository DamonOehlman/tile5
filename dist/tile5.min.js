COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var P=arguments[0]||{},fa,K=1,y=arguments.length;K<y;K++)if((fa=arguments[K])!==null)for(var k in fa){var l=fa[k];if(P!==l)if(l!==undefined)P[k]=l}return P};
(function(){var P=Object.prototype.hasOwnProperty,fa=0,K={};K.toID=function(y){return y.replace(/\s/g,"-")};K.objId=function(y){return(y?y:"obj")+fa++};K.isFunction=function(y){return toString.call(y)==="[object Function]"};K.isArray=function(y){return toString.call(y)==="[object Array]"};K.isPlainObject=function(y){if(!y||toString.call(y)!=="[object Object]"||y.nodeType||y.setInterval)return false;if(y.constructor&&!P.call(y,"constructor")&&!P.call(y.constructor.prototype,"isPrototypeOf"))return false;
var k;for(k in y);return k===undefined||P.call(y,k)};K.isEmptyObject=function(y){for(var k in y)return false;return true};K.isXmlDocument=function(y){return toString.call(y)==="[object Document]"};K.contains=function(y,k){var l=y,u=arguments,A=1;if(k&&module.isArray(k)){u=k;A=0}for(A=A;A<u;A++)l=l&&typeof foo[u[A]]!=="undefined";return l};K.formatStr=function(y){if(arguments.length<=1)return y;for(var k=arguments.length-2,l=0;l<=k;l++)y=y.replace(RegExp("\\{"+l+"\\}","gi"),arguments[l+1]);return y};
K.wordExists=function(y,k){var l="";if(k.toString)k=k.toString();for(var u=0;u<k.length;u++)l+=!/\w/.test(k[u])?"\\"+k[u]:k[u];return RegExp("(^|\\s|\\,)"+l+"(\\,|\\s|$)","i").test(y)};COG.extend(COG,K)})();
(function(){function P(l){return typeof console!=="undefined"?function(){console[l](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var fa=window.console&&window.console.markTimeline,K=P("error"),y=P("info"),k=function(){return fa?function(l,u){console.markTimeline(l+(u?": "+((new Date).getTime()-u)+"ms":""))}:function(){}}();COG.extend(COG,{trace:k,debug:P("debug"),info:y,warn:P("warn"),error:K,exception:function(l){if(K)for(var u in l)y("ERROR DETAIL: "+
u+": "+l[u])}})})();
(function(){function P(K,y){var k=K.hasOwnProperty("obsHandlers")?K.obsHandlers:null;k[y]||(k[y]=[]);return k[y]}var fa=0;COG.observable=function(K){if(!K)return null;if(!(K.hasOwnProperty("obsHandlers")?K.obsHandlers:null))K.obsHandlers={};if(!K.hasOwnProperty("bind")){K.bind=function(y,k){var l="callback"+fa++;P(K,y).unshift({fn:k,id:l});return l};K.triggerCustom=function(y,k){var l=P(K,y),u={cancel:false,name:y,source:this},A;k&&COG.extend(u,k);if(!l)return null;A=Array.prototype.slice.call(arguments,2);
K.eventInterceptor&&K.eventInterceptor(y,u,A);A.unshift(u);for(var X=l.length;X--&&!u.cancel;)l[X].fn.apply(this,A);return u};K.trigger=function(y){var k=Array.prototype.slice.call(arguments,1);k.splice(0,0,y,null);return K.triggerCustom.apply(this,k)};K.unbind=function(y,k){if(typeof y==="undefined")K.obsHandlers={};else for(var l=P(K,y),u=0;l&&u<l.length;u++)if(l[u].id===k){l.splice(u,1);break}return K}}return K}})();
(function(){function P(k,l){k[l]||(k[l]=function(u){return k.configure(l,u)})}function fa(k){k.gtConfId="configurable"+y++;k.gtConfig={};k.gtConfigFns=[];return k.gtConfig}var K={},y=0;COG.paramTweaker=function(k,l,u){return function(A,X){if(typeof X!=="undefined"){if(A in k)k[A]=X;u&&A in u&&u[A](A,X)}else return l&&A in l?l[A](A):k[A]}};COG.configurable=function(k,l,u,A){if(k){k.gtConfId||fa(k);var X=k.gtConfId,n=k.gtConfig,H=k.gtConfigFns;K[X]=k;H.push(u);for(u=l.length;u--;){n[l[u]]=true;A&&P(k,
l[u])}if(!k.configure)k.configure=function(z,I){if(n[z]){for(var v=H.length;v--;){var t=H[v](z,I);if(typeof t!=="undefined")return t}return K[X]}return null}}}})();
(function(){function P(k){var l=document.createElement("script"),u=false;l.src=k;l.async=true;l.onload=l.onreadystatechange=function(){if(!u&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){u=true;l.onload=l.onreadystatechange=null;l&&l.parentNode&&l.parentNode.removeChild(l)}};K||(K=document.getElementsByTagName("head")[0]);K.appendChild(l)}var fa=0,K,y=this;COG.jsonp=function(k,l,u){k+=k.indexOf("?")>=0?"&":"?";var A="json"+ ++fa;y[A]=function(X){l(X);y[A]=null;try{delete y[A]}catch(n){}};
P(k+(u?u:"callback")+"="+A);return A}})();
(function(){var P=1.70158,fa=Math.PI/2,K=1E3/60|0,y=Math.abs,k=Math.pow,l=Math.sin,u=Math.asin,A=Math.cos,X={linear:function(n,H,z,I){return z*n/I+H},backin:function(n,H,z,I){return z*(n/=I)*n*((P+1)*n-P)+H},backout:function(n,H,z,I){return z*((n=n/I-1)*n*((P+1)*n+P)+1)+H},backinout:function(n,H,z,I){return(n/=I/2)<1?z/2*n*n*(((P*=1.525)+1)*n-P)+H:z/2*((n-=2)*n*(((P*=1.525)+1)*n+P)+2)+H},bouncein:function(n,H,z,I){return z-X.bounceout(I-n,0,z,I)+H},bounceout:function(n,H,z,I){return(n/=I)<1/2.75?
z*7.5625*n*n+H:n<2/2.75?z*(7.5625*(n-=1.5/2.75)*n+0.75)+H:n<2.5/2.75?z*(7.5625*(n-=2.25/2.75)*n+0.9375)+H:z*(7.5625*(n-=2.625/2.75)*n+0.984375)+H},bounceinout:function(n,H,z,I){return n<I/2?X.bouncein(n*2,0,z,I)/2+H:X.bounceout(n*2-I,0,z,I)/2+z/2+H},cubicin:function(n,H,z,I){return z*(n/=I)*n*n+H},cubicout:function(n,H,z,I){return z*((n=n/I-1)*n*n+1)+H},cubicinout:function(n,H,z,I){if((n/=I/2)<1)return z/2*n*n*n+H;return z/2*((n-=2)*n*n+2)+H},elasticin:function(n,H,z,I,v,t){if(n==0)return H;if((n/=
I)==1)return H+z;t||(t=I*0.3);if(!v||v<y(z)){v=z;z=t/4}else z=t/TWO_PI*u(z/v);return-(v*k(2,10*(n-=1))*l((n*I-z)*TWO_PI/t))+H},elasticout:function(n,H,z,I,v,t){var G;if(n==0)return H;if((n/=I)==1)return H+z;t||(t=I*0.3);if(!v||v<y(z)){v=z;G=t/4}else G=t/TWO_PI*u(z/v);return v*k(2,-10*n)*l((n*I-G)*TWO_PI/t)+z+H},elasticinout:function(n,H,z,I,v,t){var G;if(n==0)return H;if((n/=I/2)==2)return H+z;t||(t=I*0.3*1.5);if(!v||v<y(z)){v=z;G=t/4}else G=t/TWO_PI*u(z/v);if(n<1)return-0.5*v*k(2,10*(n-=1))*l((n*
I-G)*TWO_PI/t)+H;return v*k(2,-10*(n-=1))*l((n*I-G)*TWO_PI/t)*0.5+z+H},quadin:function(n,H,z,I){return z*(n/=I)*n+H},quadout:function(n,H,z,I){return-z*(n/=I)*(n-2)+H},quadinout:function(n,H,z,I){if((n/=I/2)<1)return z/2*n*n+H;return-z/2*(--n*(n-2)-1)+H},sinein:function(n,H,z,I){return-z*A(n/I*fa)+z+H},sineout:function(n,H,z,I){return z*l(n/I*fa)+H},sineinout:function(n,H,z,I){return-z/2*(A(Math.PI*n/I)-1)+H}};COG.tweenValue=function(n,H,z,I,v){function t(ja){ja=ja?ja:(new Date).getTime();if(xa+K<
ja){var va=ja-G,aa=z(va,n,ma,I),Ba=G+I<=ja;ja=!Ba;if(v){va=v(aa,Ba,va);ja=typeof va!="undefined"?va&&ja:ja}ja&&animFrame(t)}}var G=(new Date).getTime(),xa=0,ma=H-n;animFrame(t);return{}};COG.easing=function(n){return X[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(n,H){X[n.replace(/[\-\_\s\.]/g,"").toLowerCase()]=H}})();
(function(){var P=/^P(\d+Y)?(\d+M)?(\d+D)?$/,fa=/^(\d+H)?(\d+M)?(\d+S)?$/,K={8601:function(k){k=k.split("T");var l=null;l=null;var u=0,A=0;P.lastIndex=-1;l=P.exec(k[0]);u+=l[3]?parseInt(l[3].slice(0,-1),10):0;fa.lastIndex=-1;l=fa.exec(k[1]);A+=l[1]?parseInt(l[1].slice(0,-1),10)*3600:0;A+=l[2]?parseInt(l[2].slice(0,-1),10)*60:0;A+=l[3]?parseInt(l[3].slice(0,-1),10):0;return new y(u,A)}},y=COG.Duration=function(k,l){return{days:k?k:0,seconds:l?l:0}};COG.addDuration=function(){for(var k=new y,l=arguments.length;l--;){k.days+=
arguments[l].days;k.seconds+=arguments[l].seconds}if(k.seconds>=86400){k.days+=~~(k.seconds/86400);k.seconds%=86400}return k};COG.formatDuration=function(k){var l,u,A="";if(k.days)A=k.days+" days ";if(k.seconds){k=k.seconds;if(k>=3600){l=~~(k/3600);k-=l*3600}if(k>=60){u=Math.round(k/60);k-=u*60}if(l)A=A+l+(l>1?" hrs ":" hr ")+(u?(u>10?u:"0"+u)+" min ":"");else if(u)A=A+u+" min";else if(k>0)A=A+(k>10?k:"0"+k)+" sec"}return A};COG.parseDuration=function(k,l){var u=l?K[l]:null;if(u)return u(k);COG.Log.warn("Could not find duration parser for specified format: "+
l);return new y}})();COG.ObjectStore=function(){var P={},fa={},K="obj_"+(new Date).getTime(),y=0,k=Object.prototype.hasOwnProperty;return{add:function(l,u){var A;u=u?u:"default";if(l&&l.constructor)if(!k.call(l,"id"))l.id=K+ ++y;A=fa[u]?fa[u]:fa[u]=[];P[l.id]=A.length;A[l.length]=l}}};var CANI={};
(function(P){var fa=[],K=0,y=false,k=P.register=function(l,u){fa.push({section:l,run:u})};P.init=function(l){function u(){if(K<fa.length){var X=fa[K++];A[X.section]||(A[X.section]={});X.run(A[X.section],u)}else{for(X in A)P[X]=A[X];y=true;l&&l(P)}}var A={};if(y&&l)l(P);else{K=0;u()}};k("canvas",function(l,u){function A(){var z,I=X.getContext("2d");I.save();try{I.translate(50,50);I.beginPath();I.rect(0,0,20,20);z=I.isPointInPath(10,10)}finally{I.restore()}return z}var X=document.createElement("canvas"),
n=typeof FlashCanvas!="undefined",H=typeof G_vmlCanvasManager!="undefnined";X.width=200;X.height=200;l.pipTransformed=n||H?false:A();u()})})(CANI);
INTERACT=function(){function P(v){return function(t,G,xa){(xa?xa:v?document.body:document).addEventListener(t,G,false)}}function fa(v){return function(t,G,xa){(xa?xa:v?document.body:document).removeEventListener(t,G,false)}}function K(v,t,G){(G?G:document).attachEvent("on"+v,t)}function y(v,t,G){(G?G:document).detachEvent("on"+v,t)}function k(v,t){return{x:v?v:0,y:t?t:0,count:1}}function l(v,t){z.push(COG.extend({handler:null,checks:{},type:v},t))}function u(v){var t=0,G=0;if(v.offsetParent){do{t+=
v.offsetLeft;G+=v.offsetTop;v=v.offsetParent}while(v)}return{left:t,top:G}}function A(v,t){return{source:v,target:t.target?t.target:t.srcElement}}function X(v,t){for(var G=v.target?v.target:v.srcElement;G&&G!==t&&G.nodeName&&G.nodeName.toUpperCase()!="CANVAS";)G=G.parentNode;return G&&G===t}function n(v,t){return{x:v.x-(t?t.left:0),y:v.y-(t?t.top:0)}}function H(v){if(v.preventDefault){v.preventDefault();v.stopPropagation()}else v.cancelBubble&&v.cancelBubble()}var z=[],I=function(v,t,G){function xa(ga,
na,wa,T){var Y=0,oa=0,B=0;COG.tweenValue(0,ga,wa,T,function(U){B=Y;Y=U});COG.tweenValue(0,na,wa,T,function(U){ma.trigger("pan",Y-B,U-oa);oa=U})}G=COG.extend({binder:null,unbinder:null,observable:null},G);for(var ma=G.observable,ja=null,va=[],aa=[],Ba,Ca,Ka={bind:function(){return ma.bind.apply(null,arguments)},pannable:function(ga){ja=COG.extend({inertia:true},ga);return Ka},unbind:function(){ma.unbind();for(var ga=0;ga<va.length;ga++)va[ga].unbind();return Ka}},Na=0;Na<t.length;Na++)va.push(t[Na](v,
ma,G));ma.bind("pointerDown",function(){aa=[];Ca=Ba=0});ma.bind("pointerMove",function(ga,na,wa,T){if(ja){aa[aa.length]={ticks:(new Date).getTime(),x:T.x,y:T.y};ma.trigger("pan",T.x,T.y)}Ba+=T.x?T.x:0;Ca+=T.y?T.y:0});ma.bind("pointerUp",function(ga,na,wa){if(Math.abs(Ba)>20||Math.abs(Ca)>20){if(ja){wa=aa.length;var T,Y;na=0;for(Y=aa.length;--Y>1&&na<50;)na+=aa[Y].ticks-aa[Y-1].ticks;if(wa-Y>1){ga=aa[wa-1].x-aa[Y].x;T=aa[wa-1].y-aa[Y].y;Y=Math.sqrt(ga*ga+T*T)|0;if(Y>15){ga=aa[wa-1].x-aa[0].x;T=aa[wa-
1].y-aa[0].y;Y=Math.sqrt(ga*ga+T*T)|0;wa=Math.asin(T/Y);na=Y*500/na|0;na=na>300?300:na;xa(Math.cos(ga>0?wa:Math.PI-wa)*na,Math.sin(wa)*na,COG.easing("sine.out"),500)}}}}else ma.trigger("tap",na,wa)});return Ka};l("pointer",{handler:function(v,t,G){function xa(B){if(B.pageX&&B.pageY)return k(B.pageX,B.pageY);else{var U=document.documentElement,sa=document.body;return k(B.clientX+(U&&U.scrollLeft||sa&&sa.scrollLeft||0)-(U&&U.clientLeft||sa&&sa.clientLeft||0),B.clientY+(U&&U.scrollTop||sa&&sa.scrollTop||
0)-(U&&U.clientTop||sa&&sa.clientTop||0))}}function ma(B){if(X(B,v))if(ga=Ba(B)){var U=xa(B);v.style.cursor="move";H(B);Y=U.x;oa=U.y;na=k(Y,oa);t.triggerCustom("pointerDown",A("mouse",B),na,n(na,u(v)))}}function ja(B){var U=xa(B);wa=U.x;T=U.y;if(X(B,v))Ca(B,ga?"pointerMove":"pointerHover")}function va(B){if(ga&&Ba(B)){ga=false;if(X(B,v)){v.style.cursor="default";Ca(B,"pointerUp")}}}function aa(B){if(X(B,v)){var U;B=B||window.event;if(B.detail)U=B.axis===2?-B.detail*Ka:0;else{U=B.wheelDeltaY?B.wheelDeltaY:
B.wheelDelta;if(window.opera)U=-U}if(U!==0){var sa=k(wa,T);t.triggerCustom("zoom",A("mouse",B),sa,n(sa,u(v)),U/Na,"wheel");H(B);B.returnValue=false}}}function Ba(B){B=B||window.event;return(B.which||B.button)==1}function Ca(B,U,sa,Aa,$a){sa=typeof sa!="undefined"?sa:wa;Aa=typeof Aa!="undefined"?Aa:T;var Q=sa-Y,ka=Aa-oa,da=k(sa,Aa);t.triggerCustom(U,A("mouse",B),da,n(da,u(v)),k(Q,ka));if(typeof $a=="undefined"||$a){Y=sa;oa=Aa}}G=COG.extend({},G);var Ka=120,Na=Ka*8,ga=false,na,wa,T,Y,oa;G.binder("mousedown",
ma,false);G.binder("mousemove",ja,false);G.binder("mouseup",va,false);G.binder("dblclick",function(B){COG.info("captured double click");if(X(B,v)){var U=xa(B);t.triggerCustom("doubleTap",A("mouse",B),U,n(U,u(v)))}},false);G.binder("mousewheel",aa,document);G.binder("DOMMouseScroll",aa,document);return{unbind:function(){G.unbinder("mousedown",ma,false);G.unbinder("mousemove",ja,false);G.unbinder("mouseup",va,false);G.unbinder("mousewheel",aa,document);G.unbinder("DOMMouseScroll",aa,document)}}},checks:{touch:false}});
l("pointer",{handler:function(v,t,G){function xa(Q){if(Q.count<2)return 0;var ka=Q.x-Q.next.x;Q=Q.y-Q.next.y;return~~Math.sqrt(ka*ka+Q*Q)}function ma(Q,ka,da){ka=ka?ka:0;da=da?da:0;for(var Z={x:Q.x-ka,y:Q.y-da,id:Q.id,count:Q.count},Ua=Z;Q.next;){Q=Q.next;Ua=Ua.next={x:Q.x-ka,y:Q.y-da,id:Q.id}}return Z}function ja(Q,ka){var da=Q[ka?ka:"touches"],Z,Ua;if(da.length===0)return null;Ua=Z={x:da[0].pageX,y:da[0].pageY,id:da[0].identifier,count:da.length};for(var qa=1,ib=da.length;qa<ib;qa++)Ua=Ua.next=
{x:da[qa].pageX,y:da[qa].pageY,id:da[qa].identifier};return Z}function va(Q){if(X(Q,v)){T=u(v);var ka=ja(Q,"changedTouches"),da=ma(ka,T.left,T.top);if(!oa){Y=ga;t.triggerCustom("pointerDown",A("touch",Q),ka,da)}Aa&&t.triggerCustom("pointerDownMulti",A("touch",Q),ka,da);oa=ja(Q);if(oa.count>1)U=xa(oa);$a=1;sa=ma(oa)}}function aa(Q){if(X(Q,v)){Q.preventDefault();B=ja(Q);if(Y==ga)Y=Math.abs(oa.x-B.x)>Ka||Math.abs(oa.y-B.y)>Ka?Na:ga;if(Y!=ga){Y=B.count>1?wa:na;if(Y==wa)if(oa.count===1){oa=ma(B);U=xa(oa)}else{var ka=
xa(B);if(Math.abs(U-ka)<Ca)Y=na;else{var da;da=B.x;var Z=B.next.x,Ua=B.y,qa=B.next.y,ib=Ua<qa?Ua:qa;da={x:(da<Z?da:Z)+(Math.abs(da-Z)>>1),y:ib+(Math.abs(Ua-qa)>>1)};ka=ka/U;Z=ka-$a;t.triggerCustom("zoom",A("touch",Q),da,n(da,T),Z,"pinch");$a=ka}}Y==na&&t.triggerCustom("pointerMove",A("touch",Q),B,ma(B,T.left,T.top),k(B.x-sa.x,B.y-sa.y));Aa&&t.triggerCustom("pointerMoveMulti",A("touch",Q),B,ma(B,T.left,T.top))}sa=ma(B)}}function Ba(Q){if(X(Q,v)){var ka=ja(Q,"changedTouches"),da=ma(ka,T.left,T.top);
B=ja(Q);if(!B){t.triggerCustom("pointerUp",A("touch",Q),ka,da);oa=null}Aa&&t.triggerCustom("pointerUpMulti",A("touch",Q),ka,da)}}G=COG.extend({detailed:false,inertia:false},G);var Ca=20,Ka=7,Na=0,ga=1,na=2,wa=3,T,Y,oa,B,U,sa,Aa=G.detailed,$a=1;G.binder("touchstart",va,false);G.binder("touchmove",aa,false);G.binder("touchend",Ba,false);COG.info("initialized touch handler");return{unbind:function(){G.unbinder("touchstart",va,false);G.unbinder("touchmove",aa,false);G.unbinder("touchend",Ba,false)}}},
checks:{touch:true}});return{register:l,watch:function(v,t,G){t=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},t);capabilities=COG.extend({touch:"ontouchstart"in window},G);if(!t.observable){COG.info("creating observable");t.observable=COG.observable({});globalOpts=t}t.binder=t.isIE?K:P(t.bindToBody);t.unbinder=t.isIE?y:fa(t.bindToBody);G=t.types;for(var xa=capabilities,ma=[],ja=z.length;ja--;){var va=z[ja],aa=!G||G.indexOf(va.type)>=0,Ba=true;
for(var Ca in va.checks){var Ka=va.checks[Ca];COG.info("checking "+Ca+" capability. require: "+Ka+", capability = "+xa[Ca]);Ba=Ba&&Ka===xa[Ca]}if(aa&&Ba)ma[ma.length]=va.handler}return new I(v,ma,t)}}}();var T5={};
(function(P){function fa(){return(new Date).getTime()}function K(){for(;xb.length>0;){var b=xb.shift();document.location=b}yb=0}function y(b){for(var h=true,c=Kb.length;c--;)h=h&&b!=Kb[c];return h}function k(b,h){var c=[];for(var e in h)e&&c.push(e+"="+escape(h[e]));return"tile5://"+b+"/"+(c.length>0?"?"+c.join("&"):"")}function l(b,h){y(b)&&COG.info("would push url: "+k(b,h))}function u(b,h){if(y(b)){xb.push(k(b,h));yb||(yb=setTimeout(K,100))}}function A(b){return function(h,c,e){(e?e:b?document.body:
document).addEventListener(h,c,false)}}function X(b){return function(h,c,e){(e?e:b?document.body:document).removeEventListener(h,c,false)}}function n(b,h,c){(c?c:document).attachEvent("on"+b,h)}function H(b,h,c){(c?c:document).detachEvent("on"+b,h)}function z(){ab={base:{name:"Unknown",bindEvent:A(),unbindEvent:X(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:l,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:n,unbindEvent:H,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:u,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:u},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:u},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:A(true),unbindEvent:X(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:u},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:u}};zb=[ab.froyo,ab.android,ab.ipod,ab.iphone,ab.ipad,ab.ie]}function I(){ab||z();if(!jb){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<zb.length;b++){var h=zb[b];if(h.regex&&h.regex.test(navigator.userAgent)){jb=COG.extend({},ab.base,h);COG.info("PLATFORM DETECTED AS: "+jb.name);break}}if(!jb){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
jb=ab.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return jb}function v(){var b=(new Date).getTime(),h=0;clearTimeout(lb);for(lb=0;h<kb.length;){var c=kb[h],e=gb[c],f=gb[c].image&&(Lb||gb[c].image.complete&&gb[c].image.width>0),m=b-e.start;m=f||m>=Vb;if(f){f=e.image;e=e.callbacks;Mb[c]=f;for(var o=0;o<e.length;o++)e[o](f,true)}if(m){kb.splice(h,1);delete gb[c]}else h++}if(kb.length>0)lb=setTimeout(v,Nb)}function t(){for(var b=0,h=arguments.length;h--;){var c=Wb[arguments[h].toUpperCase()];
if(c)b|=c}return b}function G(b,h,c,e,f){f=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},f);var m=(new Date).getTime(),o=b[h],w=f.autoInvalidate,E=c.length&&e.length&&c.length==e.length?c.length:0,F=Array(E),R=Array(E),D=COG.easing(f.easing),O=f.duration,ea=f.progress,N=function(V){var W=V-m;V=m+O<=V;for(var ba=E;ba--;)R[ba]=D(W,c[ba],F[ba],O);o.apply(b,R);w&&b.invalidate.call(b);if(ea){W=[].concat(V?e:R);W.unshift(V);ea.apply(b,W)}if(V){o.apply(b,e);
f.complete&&f.complete.apply(b,e)}else ma(N)};if(o&&o.apply&&E>0){O=O?O:DEFAULT_DURATION;for(h=E;h--;)F[h]=e[h]-c[h];ma(N)}}function xa(b,h){var c,e;if(h&&h.width>0){if(!b.imageOffset)b.imageOffset=Z.init(-h.width>>1,-h.height>>1);if(!b.bounds){c=b.xy.x+b.imageOffset.x;e=b.xy.y+b.imageOffset.y;b.bounds=qa.init(c,e,c+h.width,e+h.height)}}}function ma(b){var h=mb.length==0;mb[mb.length]=b;h&&animFrame(ja)}function ja(b){b=b?b:(new Date).getTime();if(b-Ob>Xb){for(var h=mb.splice(0),c=h.length;c--;)h[c](b);
Ob=b}mb.length&&animFrame(ja)}function va(b){bb.call(this,b)}function aa(b,h){h=COG.extend({simplify:false},h);var c=false,e=h.simplify;t("ZOOM");var f=[];h.type=h.fill?"polygon":"line";bb.call(this,h);COG.extend(this,{animatePath:function(){},prepPath:function(m,o,w){if(c){var E=true;m.beginPath();for(var F=f.length;F--;){var R=f[F].x-o,D=f[F].y-w;if(E){m.moveTo(R,D);E=false}else m.lineTo(R,D)}}return c},resync:function(m){var o,w,E,F,R;m.syncXY(b);f=Z.floor(e?Z.simplify(b):b);for(var D=f.length;D--;){m=
f[D].x;o=f[D].y;F=typeof F=="undefined"||m<F?m:F;R=typeof R=="undefined"||o<R?o:R;w=typeof w=="undefined"||m>w?m:w;E=typeof E=="undefined"||o>E?o:E}this.updateBounds(qa.init(F,R,w,E),true)}});c=b&&b.length>=2}function Ba(b,h){h.fill=false;aa.call(this,b,h)}function Ca(b){function h(E){(this.imageUrl=E)&&Ab(this.imageUrl,function(F,R){o=F;if(R){var D=w.layer?w.layer.getParent():null;D&&D.invalidate()}})}b=COG.extend({image:null,imageUrl:null,imageOffset:null},b);var c=null,e=bb.prototype.updateBounds,
f,m,o=b.image;bb.call(this,b);var w=COG.extend(this,{changeImage:h,drag:function(E,F,R,D){c||(c=Z.init(E.startX-this.xy.x,E.startY-this.xy.y));this.xy.x=F-c.x;this.xy.y=R-c.y;if(D){c=null;if(this.layer)(E=this.layer.getParent())&&E.syncXY([this.xy],true);this.trigger("dragDrop")}return true},draw:function(E){E.drawImage(o,f,m)},prepPath:function(E,F,R){var D=o&&o.width>0;if(D){xa(this,o);f=this.xy.x+this.imageOffset.x-F;m=this.xy.y+this.imageOffset.y-R;E.beginPath();E.rect(f,m,o.width,o.height)}return D},
updateBounds:function(E,F){e.call(this,E,F);xa(this,o)}});o||h(this.imageUrl)}function Ka(b){b=COG.extend({imageAnchor:null},b);if(b.imageAnchor)b.imageOffset=Z.invert(b.imageAnchor);Ca.call(this,b)}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var Na=Math.PI*2,ga=Math.PI/2,na=Math.abs,
wa=Math.ceil,T=Math.min,Y=Math.max,oa=Math.pow,B=Math.sqrt,U=Math.log,sa=Math.round,Aa=Math.sin,$a=Math.asin,Q=Math.cos,ka=Math.atan,da=Math.atan2,Z=function(){function b(e,f){return c(e.x-f.x,e.y-f.y)}function h(e,f){if(!f)f=e.length;if(f<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var m={edges:Array(f-1),accrued:Array(f-1),total:0},o=0;o<f-1;o++){var w=b(e[o],e[o+1]);m.edges[o]=B(w.x*w.x+w.y*w.y);m.accrued[o]=m.total+m.edges[o];m.total+=m.edges[o]}return m}
function c(e,f){return{x:e?e:0,y:f?f:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var e=0,f=0,m=arguments.length;m--;){e+=arguments[m].x;f+=arguments[m].y}return c(e,f)},absSize:function(e){return Y(na(e.x),na(e.y))},copy:function(e){return e?c(e.x,e.y):null},diff:b,distance:function(e,f){return h(e,f).total},edges:h,equals:function(e,f){return e.x===f.x&&e.y===f.y},extendBy:function(e,f,m){var o=Q(f)*m|0;f=Aa(f)*m|0;return c(e.x-o,e.y-f)},floor:function(e){for(var f=
Array(e.length),m=e.length;m--;)f[m]=c(~~e[m].x,~~e[m].y);return f},getRect:function(e){for(var f,m,o,w,E=e.length;E--;){var F=e[E];f=typeof f==="undefined"||F.x<f?F.x:f;m=typeof m==="undefined"||F.y<m?F.y:m;o=typeof o==="undefined"||F.x>o?F.x:o;w=typeof w==="undefined"||F.y>w?F.y:w}return qa.init(f,m,o,w)},init:c,invert:function(e){return c(-e.x,-e.y)},min:function(e,f){return c(e.x<f.x?e.x:f.x,e.y<f.y?e.y:f.y)},max:function(e,f){return c(e.x>f.x?e.x:f.x,e.y>f.y?e.y:f.y)},offset:function(e,f,m){return c(e.x+
f,e.y+(m?m:f))},scale:function(e,f){return c(e.x/f|0,e.y/f|0)},simplify:function(e,f){if(!e)return null;f=f?f:Z.VECTOR_SIMPLIFICATION;for(var m=[],o=null,w=e.length;w--;){var E=e[w];if(include=!o||w===0||na(E.x-o.x)+na(E.y-o.y)>f){m.unshift(E);o=E}}return m},theta:function(e,f,m){m=$a((e.y-f.y)/m);return e.x>f.x?m:Math.PI-m},toString:function(e){return e?e.x+", "+e.y:""}}}(),Ua=function(){return{dotProduct:function(b,h){return b.x*h.x+b.y*h.y}}}(),qa=function(){function b(c){return h(c.x1,c.y1,c.x2,
c.y2)}function h(c,e,f,m){c=c?c:0;e=e?e:0;f=typeof f!=="undefined"?f:c;m=typeof m!=="undefined "?m:m;return{x1:c,y1:e,x2:f,y2:m,width:f-c,height:m-e}}return{center:function(c){return Z.init(c.x1+(c.width>>1),c.y1+(c.height>>1))},copy:b,diagonalSize:function(c){return B(c.width*c.width+c.height*c.height)},fromCenter:function(c,e,f,m){f=f>>1;m=m>>1;return h(c-f,e-m,c+f,e+m)},init:h,intersect:function(c,e){var f=Y(c.x1,e.x1),m=Y(c.y1,e.y1),o=T(c.x2,e.x2),w=T(c.y2,e.y2);f=h(f,m,o,w);return f.width>0&&
f.height>0?f:null},toString:function(c){return c?"["+c.x1+", "+c.y1+", "+c.x2+", "+c.y2+"]":""},union:function(c,e){if(c.width===0||c.height===0)return b(e);else if(e.width===0||e.height===0)return b(c);else{var f=T(c.x1,e.x1),m=T(c.y1,e.y1),o=Y(c.x2,e.x2),w=Y(c.y2,e.y2);f=h(f,m,o,w);return f.width>0&&f.height>0?f:null}}}}(),ib=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return Z.init(b.width>>1,b.height>>1)},getSize:function(b){return B(oa(b.width,
2)+oa(b.height,2))},init:function(b,h){b=b?b:0;return{width:b,height:h?h:b}}}}();Hits=function(){return{diffHits:function(b,h){var c=[],e={},f;for(f=h.length;f--;)e[h[f].target.id]=true;for(f=b.length;f--;)e[b[f].target.id]||(c[c.length]=b[f]);return c},init:function(b,h,c,e){return{type:b,x:e.x|0,y:e.y|0,elements:[],absXY:h,relXY:c}},initHit:function(b,h,c){return{type:b,target:h,drag:c}},triggerEvent:function(b,h,c,e){h.triggerCustom(b.type+(c?c:"Hit"),{hitType:b.type},e?e:b.elements,b.absXY,b.relXY,
Z.init(b.x,b.y))}}}();var ab=null,zb=[],jb=null,yb=0,xb=[],Kb=["view.wake","tile.loaded"],Nb=100,Vb=3E4,Mb={},Yb=0;(new Date).getTime();var gb={},kb=[],Lb=typeof FlashCanvas!="undefined",lb=0,Ab=T5.getImage=function(b,h){var c=b&&h?Mb[b]:null;if(c&&c&&(Lb||c.complete&&c.width>0))h(c);else{if(c=gb[b])c.callbacks.push(h);else{c=new Image;c.id="_ldimg"+ ++Yb;gb[b]={start:(new Date).getTime(),image:c,callbacks:[h]};c.src=b;kb[kb.length]=b}lb||(lb=setTimeout(v,Nb))}};T5.newCanvas=function(b,h){var c=document.createElement("canvas");
c.width=b?b:0;c.height=h?h:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(c);FlashCanvas.initElement(c)}typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(c);return c};var Bb=function(){var b={};return{init:function(h,c){var e=b[h];if(!e)throw Error("Unable to locate requested generator: "+h);return new e(c)},register:function(h,c){b[h]=c},Template:function(){}}}(),nb=function(){function b(o,w){f[o]=c(w);return o}function h(o){for(var w in o)b(w,o[w])}function c(o){function w(D){var O=
o[D];typeof O!=="undefined"&&F.push(function(ea){ea[D]=O})}function E(){F=[];for(var D in o)w(D)}o=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},o);var F=[],R={applyToContext:function(D){for(var O=F.length;O--;)F[O](D)},update:function(D,O){o[D]=O;E()}};E();return R}var e={},f={},m={apply:function(o,w){var E=f[w]?f[w]:f.basic,F;if(o&&o.canvas){F=e[o.canvas.id];
e[o.canvas.id]=w}E.applyToContext(o);return F},define:b,defineMany:h,get:function(o){return f[o]},init:c,load:function(o){COG.jsonp(o,function(w){h(w)})}};h({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});return m}(),Wb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},Tb=function(b){function h(r,s,C){Va||Wa(g-s,i-C)}function c(r,s,C,ha){db(T(Y(Fa+
oa(2,ha)-1,0.5),2))}function e(){var r=U(Fa)/Math.LN2|0;if(r!==0){Fa=oa(2,r);sb(ob+r,tb,ub)}ya()}function f(r){r||(r=Z.init(S,M));ca=Z.init(g,i);la=Z.offset(r,g,i);tb=la.x;ub=la.y}function m(r,s){var C=1/Fa;return Z.init(ta?ta.x1+r*C:r,ta?ta.y1+s*C:s)}function o(r,s,C){La("doubleTap",s,C,m(C.x,C.y));b.scalable&&db(2,C,b.zoomEasing,null,b.zoomDuration)}function w(r,s,C){Va=null;Ga("down",s,C)}function E(r,s,C){Ga("hover",s,C)}function F(r,s,C){W(s,C,false)}function R(r,s,C){W(s,C,true)}function D(){clearTimeout(Pb);
Pb=setTimeout(ea,250)}function O(r,s,C){Ga("tap",s,C);La("tap",s,C,m(C.x,C.y,true))}function ea(r,s){var C;cb=typeof FlashCanvas!=="undefined";COG.info("is flash = "+cb);if(Da){if(b.autoSize&&Da.parentNode){r=Da.parentNode.offsetWidth;s=Da.parentNode.offsetHeight}try{if(!Da.id)Da.id=b.id+"_canvas";Ha=Da.getContext("2d")}catch(ha){COG.exception(ha);throw Error("Could not initialise canvas on specified view element");}if(r&&s&&(Oa!==s||Pa!==r)){Cb=true;Pa=r;Oa=s;S=Pa>>1;M=Oa>>1;Ea.trigger("resize",
Pa,Oa);for(C=Ma;C--;)ua[C].trigger("resize",Pa,Oa)}for(C=Ma;C--;)ua[C].trigger("contextChanged",Ha);ya();V()}}function N(r,s){s.setId(r);s.added=fa();s.bind("remove",function(){Ea.removeLayer(r)});s.trigger("contextChanged",Ha);s.setParent(Ea);ua.push(s);ua.sort(function(C,ha){var pa=ha.zindex-C.zindex;if(pa===0)pa=ha.added-C.added;return pa});Ma=ua.length;return s}function V(){Ta&&Ta.unbind();Ta=INTERACT.watch(Da);b.pannable&&Ta.pannable().bind("pan",h);if(b.scalable){Ta.bind("zoom",c);Ta.bind("doubleTap",
o)}Ta.bind("pointerDown",w);Ta.bind("pointerMove",F);Ta.bind("pointerUp",R);b.captureHover&&Ta.bind("pointerHover",E);Ta.bind("tap",O)}function W(r,s,C){if(Va){r=m(s.x,s.y);Va.drag.call(Va.target,Va,r.x,r.y,C)&&ya();if(C)Va=null}}function ba(r){var s,C,ha=false;if(Db|cb){r=r?r:(new Date).getTime();if(r-Qb>Zb){C=g!==p||i!==q;eb=Rb|(Fa!==1?Sb:0)|(C?Eb:0)|(Fb?Gb:0);za=(s=(eb&(Sb|Eb))!==0)&&(eb&Gb)===0;if(Cb&&Da){Da.width=Pa;Da.height=Oa;Da.style.width=Pa+"px";Da.style.height=Oa+"px";cb&&FlashCanvas.initElement(Da);
typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(Da);Cb=false}$=hb();for(C=Ma;C--;){eb|=ua[C].animated?Gb:0;ua[C].cycle(r,$,eb);ha=ua[C].clip||ha}C=eb;var pa=$;ha=J&&ha&&!s;s=r;var Ia;qa.center(pa);var Qa=0,Ra;if(Fa!==1){Ra=1/Fa;tb=la.x+(g-ca.x);ub=la.y+(i-ca.y);Ra=pa?qa.fromCenter(tb>>0,ub>>0,pa.width*Ra>>0,pa.height*Ra>>0):void 0}else Ra=qa.copy(pa);ta=Ra;ha||Ha.clearRect(0,0,Pa,Oa);ta.scaleFactor=Fa;Ha.save();try{Fa!==1&&Ha.scale(Fa,Fa);Xa=Ya=null;if(ha){Ha.beginPath();for(Qa=
Ma;Qa--;)ua[Qa].clip&&ua[Qa].clip(Ha,ta,C,Ea,s);Ha.closePath();Ha.clip()}Ha.globalCompositeOperation="source-over";for(Qa=Ma;Qa--;){Ia=ua[Qa];if(Ia.shouldDraw(eb,$)){var Sa=Ia.style,fb=Sa?nb.apply(Ha,Sa):null;Ia.draw(Ha,ta,C,Ea,s,L);fb&&nb.apply(Ha,fb)}}}finally{Ha.restore()}Db=0;La("drawComplete",pa,s);if(L){Ia=L?L.elements:[];if(pb&&pb.type==="hover"){Sa=Hits.diffHits(pb.elements,Ia);Sa.length>0&&Hits.triggerEvent(pb,Ea,"Out",Sa)}if(Ia.length>0){fb=L.x;C=L.y;for(Sa=Ia.length;Sa--;){pa=Ia[Sa];ha=
fb;s=C;if(Qa=pa&&pa.drag&&(!pa.canDrag||pa.canDrag(pa,ha,s))){Va=pa;Va.startX=ha;Va.startY=s}if(Qa)break}Hits.triggerEvent(L,Ea)}pb=Ia.length>0?COG.extend({},L):null;L=null}r-qb>Hb&&ra();Qb=r;p=g;q=i}animFrame(ba)}else ia=false}function Ga(r,s,C){L=Hits.init(r,s,C,m(C.x,C.y,true));for(r=Ma;r--;)rb=rb||(ua[r].hitGuess?ua[r].hitGuess(L.x,L.y,eb,Ea):false);rb&&ya()}function ya(){Db+=1;if(!ia){ia=true;animFrame(ba)}}function hb(){return qa.init(g,i,g+Pa,i+Oa)}function ra(){if(a||d){var r=j?g+S:g,s=x?
i+M:i;if(a&&a>Pa)if(r+Pa>a)g=j?r-a>0?g-a:g:a-Pa;else if(r<0)g=j?g+a:0;if(d&&d>Oa)if(s+Oa>d)i=x?s-d>0?i-d:i:d-Oa;else if(s<0)i=x?i+d:0}qb=(new Date).getTime();La("refresh",Ea,hb());ya()}function db(r,s,C,ha,pa){if(C)COG.tweenValue(Fa,r,C,pa,function(Ia,Qa){Fa=Ia;if(Qa){var Ra=sa(U(Fa)/Math.LN2);Fa=oa(2,Ra);ha&&ha()}f(s);e()});else{Fa=r;f(s);e()}return Ea}function sb(r,s,C){r=Y(b.minZoom,T(b.maxZoom,r));if(r!==ob){var ha=oa(2,r-ob),pa=S/ha|0,Ia=M/ha|0;ob=r;Wa(((s?s:g+S)-pa)*ha,((C?C:i+M)-Ia)*ha);p=
g;q=i;La("zoomLevelChange",r);Fa=1;ra()}}function La(){for(var r=Ea.trigger.apply(null,arguments).cancel,s=ua.length;s--;)r=ua[s].trigger.apply(null,arguments).cancel||r;return!r}function Wa(r,s,C,ha,pa){function Ia(){Qa+=1;if(Qa>=2){Fb=false;pa&&pa()}}var Qa=0,Ra=Ya?Z.offset(Ya,-S,-M):null,Sa=Xa?Z.offset(Xa,-S,-M):null;if(Ra){r=r<Ra.x?Ra.x:r;s=s<Ra.y?Ra.y:s}if(Sa){r=r>Sa.x?Sa.x:r;s=s>Sa.y?Sa.y:s}if(C){if((eb&Eb)===0){COG.tweenValue(g,r,C,ha,function(fb,Ib){g=fb|0;(Ib?Ia:ya)();return!za});COG.tweenValue(i,
s,C,ha,function(fb,Ib){i=fb|0;(Ib?Ia:ya)();return!za});Fb=true}}else{g=r|0;i=s|0;ya();pa&&pa()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},
b);var ua=[],Ma=0,Da=document.getElementById(b.container),Va=null,Ha=null,vb=typeof window.attachEvent!="undefined",cb,rb=false,Hb=b.minRefresh,g=0,i=0,p=0,q=0,a=null,d=null,j=false,x=false,J=b.clipping,$=null,ia=false,ta,Ja=1,S=0,M=0,L=null,ca=null,la=null,za=false,Ya=null,Xa=null,qb=0,pb=null,Pb=0,Fa=1,Qb=0,Cb=false,Ta=null,Fb=false,Oa,Pa,Zb=1E3/b.fps|0,Db=0,tb,ub,ob=b.zoomLevel,Rb=t("ACTIVE"),Eb=t("PAN"),Sb=t("ZOOM"),Gb=t("ANIMATING"),eb=Rb,Ea={id:b.id,deviceScaling:Ja,fastDraw:b.fastDraw||I().requireFastDraw,
detach:function(){Ta&&Ta.unbind()},eachLayer:function(r){for(var s=Ma;s--;)r(ua[s])},getDimensions:function(){return ib.init(Pa,Oa)},getLayer:function(r){for(var s=0;s<Ma;s++)if(ua[s].getId()==r)return ua[s];return null},getZoomLevel:function(){return ob},setLayer:function(r,s){for(var C=0;C<Ma;C++)if(ua[C].getId()===r){ua.splice(C,1);break}if(s){N(r,s);s.trigger("refresh",Ea,hb())}ya();return s},invalidate:ya,refresh:ra,resetScale:function(){Fa=1},resize:function(r,s){if(Da){b.autoSize=false;if(Pa!==
r||Oa!==s)ea(r,s)}},scale:db,setZoomLevel:sb,syncXY:function(){},triggerAll:La,removeLayer:function(r){a:{for(var s=Ma;s--;)if(ua[s].getId()==r){r=s;break a}r=-1}if(r>=0&&r<Ma){Ea.trigger("layerRemoved",ua[r]);ua.splice(r,1);ya()}Ma=ua.length},getOffset:function(){return Z.init(g,i)},setMaxOffset:function(r,s,C,ha){a=r;d=s;j=typeof C!="undefined"?C:false;x=typeof ha!="undefined"?ha:false},getViewRect:hb,updateOffset:Wa,pan:function(r,s,C,ha,pa){Wa(g+r,i+s,C,ha,pa)}};Ja=I().getScaling();COG.observable(Ea);
Ea.bind("invalidate",function(){ya()});Ea.bind("resync",function(){Xa=Ya=null});COG.configurable(Ea,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,null,{container:function(r,s){Da=document.getElementById(s);ea()},inertia:V,captureHover:V,scalable:V,pannable:V}),true);CANI.init(function(r){Ea.markers=N("markers",new wb({zindex:20}));canvasCaps=r.canvas;ea();if(b.autoSize)vb?window.attachEvent("onresize",D):window.addEventListener("resize",
D,false)});return Ea},Jb=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:t("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var h=null,c=false,e=false,f=b.id,m=t("ACTIVE"),o=b.validStates,w=0,E=0,F=COG.extend({addToView:function(R){R.setLayer(f,F)},shouldDraw:function(R){return(R&o)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){F.trigger("remove",F)},changed:function(){e=true;h&&h.invalidate()},
hitTest:null,getId:function(){return f},setId:function(R){f=R},getParent:function(){return h},setParent:function(R){c=(h=R)?h.fastDraw&&displayState!==m:false;F.trigger("parentChange",h)}},b);COG.observable(F);F.bind("drawComplete",function(R,D){e=false;w=D.x1;E=D.y1});F.bind("resync",function(R,D){F.minXY&&D.syncXY(F.minXY);F.maxXY&&D.syncXY(F.maxXY)});return F},bb=function(b){b=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape"},
b);COG.extend(this,b);this.id=COG.objId(this.type);this.view=this.bounds=null;this.rotation=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};bb.prototype={constructor:bb,animate:function(b,h,c,e){G(this,b,h,c,e)},drag:null,draw:function(b){this.fill&&b.fill();this.stroke&&b.stroke()},invalidate:function(){var b=this.layer?this.layer.getParent():null;b&&b.invalidate()},prepPath:function(){},resync:function(b){if(this.xy){b.syncXY([this.xy]);this.size&&this.updateBounds(qa.fromCenter(this.xy.x,
this.xy.y,this.size,this.size))}},rotate:function(b){this.rotation=b},scale:function(b){this.scaling=b},translate:function(b,h){this.translateX=b;this.translateY=h},updateBounds:function(b,h){this.bounds=b;if(h)this.xy=qa.center(this.bounds)}};var Xb=1E3/60|0,mb=[],Ob=0;va.prototype=COG.extend(bb.prototype,{constructor:va,prepPath:function(b,h,c){b.beginPath();b.arc(this.xy.x-h,this.xy.y-c,this.size>>1,0,Math.PI*2,false);return true}});aa.prototype=COG.extend({},bb.prototype,{constructor:aa});Ba.prototype=
COG.extend({},aa.prototype);Ca.prototype=COG.extend({},bb.prototype,{constructor:Ca});Ka.prototype=COG.extend({},Ca.prototype,{constructor:Ka});var Ub=function(b){b=COG.extend({zindex:10},b);var h=[],c=CANI.canvas.pipTransformed,e=COG.extend(new Jb(b),{draw:function(f,m,o,w,E,F){w=m.x1;E=m.y1;var R=F?c?F.x-w:F.relXY.x:0,D=F?c?F.y-E:F.relXY.y:0,O=m.width;m=m.height;for(var ea=h.length;ea--;){var N=h[ea],V=N.xy.x,W=N.xy.y,ba=N.style||e.style,Ga=N.scaling!==1||N.rotatation||N.translateX||N.translateY;
if(Ga){f.save();f.translate(V-w+N.translateX,W-E+N.translateY);N.rotation!==0&&f.rotate(N.rotation);N.scaling!==1&&f.scale(N.scaling,N.scaling);if(c){R-=V;D-=W}}if(N.prepPath(f,Ga?V:w,Ga?W:E,O,m,o)){if(F&&f.isPointInPath(R,D)){F.elements.push(Hits.initHit(N.type,N,N.draggable?N.drag:null));V=F.type+"Style";ba=N[V]||e[V]||ba}ba=ba?nb.apply(f,ba):null;N.draw(f,w,E,O,m,o);ba&&nb.apply(f,ba)}Ga&&f.restore()}},getDrawables:function(){return[]},hitGuess:function(f,m){for(var o=false,w=h.length;!o&&w--;){var E=
h[w];if(!(o=o))o=(E=E.bounds)&&f>=E.x1&&f<=E.x2&&m>=E.y1&&m<=E.y2;o=o}return o}});e.bind("refresh",function(f,m,o){h=e.getDrawables(m,o)});return e},wb=function(b){function h(m){for(var o=e.length;o--;)e[o].resync(m);e.sort(function(w,E){var F=E.xy.y-w.xy.y;return F!=0?F:E.xy.x-w.xy.y});f.changed()}function c(m,o){h(o)}b=COG.extend({zindex:10},b);var e=[],f=COG.extend(new Ub(b),{add:function(m,o){if(m){m.layer=f;var w=f.getParent();if(w){m.resync(f.getParent());w.invalidate()}if(o)e.unshift(m);else e[e.length]=
m}},clear:function(){e=[]},find:function(){return[].concat(e)},getDrawables:function(){return e}});f.bind("parentChange",c);f.bind("resync",c);return f},$b=function(){return{tileSize:256,init:function(b,h,c,e,f){return COG.extend({x:b,y:h,width:c,height:e},f)}}}();COG.extend(P,{ex:COG.extend,ticks:fa,getConfig:I,userMessage:function(b,h,c){P.trigger("userMessage",b,h,c)},XY:Z,XYRect:qa,Dimensions:ib,Vector:Ua,Hits:Hits,Generator:Bb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,
Style:nb,viewState:t,View:Tb,ViewLayer:Jb,ImageLayer:function(b,h){function c(D,O,ea,N){O.image?D.drawImage(O.image,ea,N):Ab(O.url,function(V){O.image=V;R.changed()})}function e(D,O,ea){for(O=w.length;O--;){var N=w[O],V=N.x,W=N.y,ba=qa.init(N.x,N.y,N.x+N.width,N.y+N.height);ea&&qa.intersect(D,ba)&&Ab(N.url,function(Ga,ya){ea(Ga,V,W,N.width,N.height);ya&&R.changed()},F)}}function f(D){var O=E?Math.abs(E.x1-D.x1)+Math.abs(E.y1-D.y1):0;if(m&&(!E||O>256)){var ea=++o;O=R.getParent();m.run(O,D,function(N){E=
qa.copy(D);if(ea==o)for(var V=N.length;V--;){var W=N[V];w[w.length]={image:null,sequence:ea,url:W.url,rect:qa.init(W.x,W.y,W.x+W.width,W.y+W.height)}}})}}h=COG.extend({imageLoadArgs:{}},h);var m=b?Bb.init(b,h):null,o=0,w=[],E=null,F=h.imageLoadArgs,R=COG.extend(new Jb(h),{changeGenerator:function(D,O){m=Bb.init(D,COG.extend({},h,O));f(R.getParent().getViewRect())},clip:function(D,O){for(var ea=O.x1,N=O.y1,V=w.length;V--;){var W=w[V].rect;qa.intersect(O,W)&&D.rect(W.x1-ea,W.y1-N,W.width,W.height)}},
draw:function(D,O){for(var ea=O.x1,N=O.y1,V=0;V<w.length;){var W=w[V],ba=W.rect;qa.intersect(O,ba)&&c(D,W,ba.x1-ea,ba.y1-N);if(W.sequence!==o)w.splice(V,1);else V++}},mask:function(D,O,ea){e(O,ea,function(N,V,W,ba,Ga){COG.info("clearing rect @ x = "+V+", y = "+W+", width = "+ba+", height = "+Ga);D.clearRect(V,W,ba,Ga)})}});R.bind("refresh",function(D,O,ea){f(ea)});R.bind("tap",function(D,O,ea,N){D=[];var V=N.x,W=N.y,ba,Ga;if(w)for(var ya=w.length;ya--;){ba=w[ya];if(Ga=V>=ba.x&&V<=ba.x+ba.width&&W>=
ba.y&&W<=ba.y+ba.height)D[D.length]=ba}D.length>0&&R.trigger("tapImage",D,O,ea,N)});return R},ImageGenerator:function(b){b=COG.extend({relative:false,padding:2},b);b={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(b);return b},Drawable:bb,Marker:va,Poly:aa,Line:Ba,ImageDrawable:Ca,ImageMarker:Ka,DrawLayer:Ub,ShapeLayer:wb,Tiling:$b});COG.observable(P);var Za=P.Geo=function(){function b(g){for(var i=null,p=1;!i&&p<arguments.length;p++)i=m(g,arguments[p]);
i=i?i:m(g);if(!i)throw Error("Unable to find GEO engine with "+g+" capability");return i}function h(g){g=parseFloat(g)*D;g=Aa(g);var i=W*g;return U((1+g)/(1-g)*oa((1-i)/(1+i),W))/2}function c(g){return parseFloat(g)*D}function e(g){g=oa(Math.E,-g);for(var i=ga-2*ka(g),p=o(i,g),q=0;q<Ga&&na(i-p)>ba;){i=p;p=o(i,g);q++}return p*O}function f(g){return g%360*O}function m(g,i){var p=null;for(var q in Wa)if(i){if(q==i&&Wa[q][g]){p=Wa[q];break}}else if(Wa[q][g]){p=Wa[q];break}return p}function o(g,i){var p=
W*Aa(g);return ga-2*ka(i*oa((1-p)/(1+p),W/2))}function w(g,i,p,q){i=E(i);g.add(q(i,p));return i.length}function E(g){var i=g?g.length:0,p=Array(i);for(i=i;i--;)p[i]=Za.Position.init(g[i][1],g[i][0]);return Za.Position.vectorize(p,vb)}function F(g,i,p){return new Hb(g,i,p)}var R=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],D=Math.PI/180,O=180/Math.PI,ea=ga,N=-ea,V=-Na,W=0.08181919084262157,ba=1.0E-7,Ga=12,ya=null,hb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",
CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},ra=function(){function g(a){return a?p(a.lat,a.lon):null}function i(a){return!a||a.lat===0&&a.lon===0}function p(a,d){return{lat:parseFloat(a?a:0),lon:parseFloat(d?d:0)}}function q(a){if(a)if(typeof a.lat!=="undefined")return g(a);else{if(a.split)for(var d=[" ",","],j=0;j<d.length;j++){var x=a.split(d[j]);if(x.length===2)return p(x[0],x[1])}}else return p();return null}return{calcDistance:function(a,d){if(i(a)||i(d))return 0;var j=
(d.lat-a.lat)*D>>1,x=(d.lon-a.lon)*D>>1;j=Aa(j)*Aa(j)+Q(a.lat*D)*Q(d.lat*D)*Aa(x)*Aa(x);return 6371*2*da(B(j),B(1-j))},copy:g,empty:i,equal:function(a,d){return a&&d&&a.lat==d.lat&&a.lon==d.lon},fromMercatorPixels:function(a,d){return p(e(d),f(a))},generalize:function(a,d,j){var x=a.length,J=[],$=null;j||(j=250);j/=1E3;COG.info("generalizing positions, must include "+d.length+" positions");for(var ia=x;ia--;)if(ia===0)J.unshift(a[ia]);else{var ta=!$||ra.inArray(a[ia],d)?j:ra.calcDistance($,a[ia]);
if(a[ia]&&ta>=j){J.unshift(a[ia]);$=a[ia]}}COG.info("generalized "+x+" positions into "+J.length+" positions");return J},inArray:function(a,d){for(var j=ra.equal,x=d.length;x--;)if(j(a,d[x]))return true;return false},inBounds:function(a,d){var j=!(ra.empty(a)||ra.empty(d));return j=(j=j&&a.lat>=d.min.lat&&a.lat<=d.max.lat)&&a.lon>=d.min.lon&&a.lon<=d.max.lon},init:p,offset:function(a,d,j){var x=a.lat*D;a=a.lon*D;d=x+d/6371;j=$a(Aa(j/6371)/Q(x));j=a+j;d=(d+ga)%Math.PI-ga;j%=Na;return p(d*O,j*O)},parse:q,
parseArray:function(a){var d=a.length,j=Array(d);for(d=d;d--;)j[d]=q(a[d]);return j},toMercatorPixels:function(a){return T5.XY.init(c(a.lon),h(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,d){function j(){for(var ia=0,ta=d.chunkSize,Ja=x;Ja--;){J[Ja]=T5.GeoXY.init(a[Ja]);ia+=1;if(ia>ta)break}x=Ja;if(x<=0)d.callback&&d.callback(J);else animFrame(j)}var x=a.length,J=Array(x);d=COG.extend({chunkSize:500,async:true,callback:null},d);if(!d.async){for(var $=x;$--;)J[$]=
T5.GeoXY.init(a[$]);return J}animFrame(j);return null}}}(),db=function(){function g(a,d,j){var x=T5.XY.init(0,d.lat-a.lat);if(typeof j==="undefined")j=true;x.x=j&&a.lon>d.lon?360-a.lon+d.lon:d.lon-a.lon;return x}function i(a,d){return db.init(ra.init(a.min.lat-d,a.min.lon-d%360),ra.init(a.max.lat+d,a.max.lon+d%360))}function p(a){var d=g(a.min,a.max);return ra.init(a.min.lat+(d.y>>1),a.min.lon+(d.x>>1))}function q(a,d){return{min:ra.parse(a),max:ra.parse(d)}}return{calcSize:g,createBoundsFromCenter:function(a,
d){var j=d/6371,x=a.lat*D,J=a.lon*D,$=x-j,ia=x+j;if($>N&&ia<ea){x=$a(Aa(j)/Q(x));j=(J-x)%Na;J=(J+x)%Na}else{$=Y($,N);ia=T(ia,ea);j=V;J=Na}return db.init(ra.init($*O,j*O),ra.init(ia*O,J*O))},expand:i,forPositions:function(a,d){var j=null,x=T5.ticks();d||(d="auto");for(var J=a.length;J--;)if(j){var $=g(j.min,a[J],false),ia=g(a[J],j.max,false);if($.x<0)j.min.lon=a[J].lon;if($.y<0)j.min.lat=a[J].lat;if(ia.x<0)j.max.lon=a[J].lon;if(ia.y<0)j.max.lat=a[J].lat}else j=q(a[J],a[J]);if(d){if(d=="auto"){J=g(j.min,
j.max);d=Y(J.x,J.y)*0.3}j=i(j,d)}COG.trace("calculated bounds for "+a.length+" positions",x);return j},getCenter:p,getGeoHash:function(a){var d=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+d+", max hash = "+a)},getZoomLevel:function(a,d){var j=p(a);j=T(sa(na(j.lat)*0.05),R.length);var x=R[j],J=g(a.min,a.max);j=wa(U(R[3]*d.height/J.y)/U(2));x=wa(U(x*d.width/J.x)/U(2));return T(isNaN(j)?1E3:j,isNaN(x)?1E3:x)},init:q,isEmpty:function(a){return!a||
ra.empty(a.min)||ra.empty(a.max)},toString:function(a){return"min: "+ra.toString(a.min)+", max: "+ra.toString(a.max)}}}(),sb=function(){var g=/^(\d+).*$/,i=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(p,q){g.lastIndex=-1;if(g.test(p))for(var a=p.replace(g,"$1"),d=q.split(","),j=0;j<d.length;j++){i.lastIndex=-1;if(i.test(d[j])){var x=i.exec(d[j]);if(a>=parseInt(x[1],10)&&a<=parseInt(x[2],10))return true}else if(a==d[j])return true}return false},normalize:function(p){if(!p)return"";p=p.toUpperCase();
if(!ya){var q=[];for(var a in hb)q.push(a);ya=RegExp("(\\s)("+q.join("|")+")(\\s|$)","i")}ya.lastIndex=-1;if(q=ya.exec(p))p=p.replace(ya,"$1"+hb[q[2]]);return p},toString:function(p){return p.streetDetails+" "+p.location}}}(),La=P.GeoXY=function(){function g(q,a){if(q.length){for(var d,j,x,J,$=q.length;$--;){g(q[$],a);d=typeof d==="undefined"||q.x<d?q.x:d;j=typeof j==="undefined"||q.y<j?q.y:j;x=typeof x==="undefined"||q.x>x?q.x:x;J=typeof J==="undefined"||q.y>J?q.y:J}return qa.init(d,j,J,J)}else if(q.mercXY){d=
q.mercXY;q.x=(d.x+Math.PI)/a|0;q.y=(Math.PI-d.y)/a|0;q.rpp=a}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return q}function i(q,a){if(q.length)for(var d=q.length;d--;)i(q[d],a);else{q.mercXY=Z.init(q.x*a-Math.PI,Math.PI-q.y*a);q.pos=ra.fromMercatorPixels(q.mercXY.x,q.mercXY.y)}return q}function p(q,a,d){q.pos=a;q.mercXY=ra.toMercatorPixels(a);(d=typeof d!=="undefined"?d:q.rpp)&&g(q,d)}return{init:function(q,a){var d=Z.init();p(d,q,a);return d},sync:g,syncPos:i,toPos:function(q,
a){a=a?a:_self.rpp;return ra.fromMercatorPixels(q.x*a-Math.PI,Math.PI-q.y*a)},updatePos:p}}(),Wa={},ua=function(){return{bestResults:function(g,i){i||(i=20);for(var p=g.length>0?g[0]:null,q=[],a=0;a<g.length;a++)if(p&&g[a]&&p.matchWeight-g[a].matchWeight<=i)q.push(g[a]);else break;return q}}}(),Ma=function(g){g=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},g);return COG.extend(g,{toString:function(){return g.caption+(g.matchWeight?" ("+g.matchWeight+")":"")}})},Da=
function(){function g(a,d){var j=new T5.ShapeLayer;d.geometry&&ra.vectorize(d.geometry,{callback:function(x){j.add(new T5.Line(x,{style:"waypoints",simplify:true}));a.setLayer("route",j)}})}function i(a){for(var d=p.Unknown,j=q,x=0;x<j.length;x++){j[x].regex.lastIndex=-1;var J=j[x].regex.exec(a);if(J){d=j[x].customCheck?j[x].customCheck(a,J):j[x].turnType;break}}return d}var p={Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",
TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},q=function(){var a=[];a.push({regex:/continue/i,turnType:p.Continue});a.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(d,j){return/bear/i.test(j[1])?p.TurnLeftSlight:p.TurnLeft}});a.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(d,
j){return/bear/i.test(j[1])?p.TurnRightSlight:p.TurnRight}});a.push({regex:/enter\s(roundabout|rotaty)/i,turnType:p.EnterRoundabout});a.push({regex:/take.*?ramp/i,turnType:p.Ramp});a.push({regex:/take.*?exit/i,turnType:p.RampExit});a.push({regex:/make(.*?)u\-turn/i,customCheck:function(d,j){return/right/i.test(j[1])?p.UTurnRight:p.UTurnLeft}});a.push({regex:/proceed/i,turnType:p.Start});a.push({regex:/arrive/i,turnType:p.Arrive});a.push({regex:/fell\sthrough/i,turnType:p.Merge});return a}();return{calculate:function(a){a=
COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},a);var d=b("route");d&&d.route(a,function(j){if(a.generalize)j.geometry=ra.generalize(j.geometry,j.getInstructionPositions());if(a.map){g(a.map,j);a.autoFit&&a.map.gotoBounds(j.boundingBox)}a.success&&a.success(j)})},createMapOverlay:g,parseTurnType:i,TurnType:p,Instruction:function(a){var d=a=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},a),
j=a.description;j=j.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");d.description=j;if(!a.turnType)a.turnType=i(a.description);return a},RouteData:function(a){a=COG.extend({geometry:[],instructions:[],boundingBox:null},a);if(!a.boundingBox)a.boundingBox=db.forPositions(a.geometry);return COG.extend({getInstructionPositions:function(){for(var d=[],j=0;j<a.instructions.length;j++)a.instructions[j].position&&d.push(a.instructions[j].position);return d}},a)}}}(),Va="featurecollection",Ha="feature",vb={async:false},
cb={processor:null,group:"shapes",layerClass:wb},rb={point:COG.extend({},cb,{processor:function(g,i,p,q){i=E([i.coordinates],vb);if(i.length>0)if(p=q.marker(i[0],p)){g.add(p);return i.length}},group:"markers",layerClass:wb}),linestring:COG.extend({},cb,{processor:function(g,i,p,q){i=E(i&&i.coordinates?i.coordinates:[]);return w(g,i,p,q.line)}}),multilinestring:COG.extend({},cb,{processor:function(g,i,p,q){i=i&&i.coordinates?i.coordinates:[];for(var a=0,d=i.length;d--;)a+=w(g,i[d],p,q.line);return a}}),
polygon:COG.extend({},cb,{processor:function(g,i,p,q){i=i&&i.coordinates?i.coordinates:[];if(i.length>0)return w(g,i[0],p,q.poly);return 0}}),multipolygon:COG.extend({},cb,{processor:function(g,i,p,q){i=i&&i.coordinates?i.coordinates:[];for(var a=0,d=0;d<i.length;d++)a+=w(g,i[d][0],p,q.poly);return a}})},Hb=function(g,i,p,q){function a(L,ca){var la=L.processor,za=$+L.group,Ya=COG.extend({},L,p,{properties:ca.properties});if(la){var Xa=M[za];if(!Xa){Xa=new L.layerClass({id:za});M[za]=Xa}globalLayers=
M;return la(Xa,ca.data,Ya,q)}return 0}function d(L,ca){var la=L&&L.type?L.type.toLowerCase():null;return la&&la===Ha?d(L.geometry,L.properties):{type:la,isCollection:la?la===Va:false,definition:rb[la],data:L,properties:ca?ca:L.properties}}function j(L){var ca=0,la=COG.extend({},p),za=ia;L=L?L:(new Date).getTime();if(!Ja){for(;za<ta;za++){L=d(J?J(g[za]):g[za]);var Ya=null;if(L.isCollection){la.layerPrefix=$+S++ +"-";Ja=F(L.data.features,function(Xa){Ja=null;for(var qb in Xa)M[qb]=Xa[qb]},la);Ya+=1}else if(L.definition)Ya=
a(L.definition,L);ca+=Ya?Ya:1;if(ca>=x)break}ia=za+1;if(Ja||ia<ta)animFrame(j);else i&&i(M)}}p=COG.extend({vectorsPerCycle:Za.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},p);q=COG.extend({marker:function(L){return new va({xy:L})},line:function(L,ca){return new aa(L,COG.extend({},p,ca))},poly:function(L,ca){return new aa(L,COG.extend({fill:true},p,ca))}},q);var x=p.vectorsPerCycle,J=p.rowPreParse,$=p.layerPrefix,ia=0,ta=0,Ja=null,S=0,M={};if(g){if(typeof g.length==="undefined")g=
[g];ta=g.length;animFrame(j)}};P.GeoJSON={parse:F};P.Map=function(g){function i(M){try{var L=Za.Position.init(M.coords.latitude,M.coords.longitude),ca=M.coords.accuracy/1E3;S.trigger("locationUpdate",M,ca);if(ia){if(!J){J=new Za.UI.LocationOverlay({pos:L,accuracy:ca});J.update(S.getTileLayer());S.setLayer("location",J)}var la=Za.BoundingBox.createBoundsFromCenter(L,Math.max(ca,1));S.gotoBounds(la)}else{J.pos=L;J.accuracy=ca;J.update(S.getTileLayer());a(L,null,COG.easing("sine.out"))}ia=false}catch(za){COG.exception(za)}}
function p(M){COG.info("caught location tracking error:",M)}function q(M,L,ca){S.setZoomLevel(L);a(M,ca)}function a(M,L,ca,la){M=La.init(M,Za.radsPerPixel(S.getZoomLevel()));var za=S.getDimensions();S.updateOffset(M.x-(za.width>>1),M.y-(za.height>>1),ca,la,function(){S.refresh();S.trigger("boundsChange",S.getBoundingBox());L&&L(S)})}g=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,minZoom:1,maxZoom:18,pannable:true,scalable:true},g);var d={NONE:0,SINGLE:1,WATCH:2},j=
Z.init(),x=d.NONE,J=null,$=0,ia=true,ta=0,Ja=g.tapExtent;g.adjustScaleFactor=function(M){return Math.pow(2,(M<1?Math.floor:Math.ceil)(Math.log(M)))};var S=COG.extend(new Tb(g),{getBoundingBox:function(){var M=S.getViewRect();return Za.BoundingBox.init(La.toPos(Z.init(M.x1,M.y2),ta),La.toPos(Z.init(M.x2,M.y1),ta))},getCenterPosition:function(){var M=S.getViewRect();if(M){M=Z.init(M.x1+(M.width>>1),M.y1+(M.height>>1));return La.toPos(M,ta)}return null},gotoBounds:function(M,L){var ca=Za.BoundingBox.getZoomLevel(M,
S.getDimensions());q(Za.BoundingBox.getCenter(M),ca,L)},gotoPosition:q,panToPosition:a,syncXY:function(M,L){return(L?La.syncPos:La.sync)(M,ta)},locate:function(){S.trackStart(d.SINGLE);setTimeout(S.trackCancel,1E4)},trackStart:function(M){if(navigator.geolocation&&!$){x=M?M:d.WATCH;ia=true;$=navigator.geolocation.watchPosition(i,p,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){$&&navigator.geolocation&&navigator.geolocation.clearWatch($);S.removeLayer("location");J=
null;x=d.NONE;$=0},animateRoute:function(M,L,ca,la){var za=S.getLayer("route");if(za)(M=za.getAnimation(M,L,ca,la))&&M.addToView(S)}});S.bind("pan",function(){x===d.SINGLE&&S.trackCancel()});S.bind("tap",function(M,L,ca,la){M=La.toPos(la,ta);var za=La.toPos(Z.offset(la,-Ja,Ja),ta);la=La.toPos(Z.offset(la,Ja,-Ja),ta);S.trigger("geotap",L,ca,M,db.init(za,la))});S.bind("refresh",function(){if(Z.absSize(Z.diff(j,S.getOffset()))>g.boundsChangeThreshold){j=Z.copy(S.getOffset());S.trigger("boundsChange",
S.getBoundingBox())}});S.bind("zoomLevelChange",function(M,L){var ca;ta=Za.radsPerPixel(L);ca=Na/ta|0;S.setMaxOffset(ca,ca,true,false);S.resetScale();S.triggerAll("resync",S);S.refresh()});return S};P.GeoShape=function(g,i){i=COG.extend({autoParse:true},i);for(var p=Array(g.length),q=i.autoParse,a=T5.Geo.Position.parse,d=g.length;d--;)p[d]=T5.GeoXY.init(q?a(g[d]):g[d]);return new T5.Poly(p,i)};P.LocationOverlay=function(g){g=COG.extend({pos:null,accuracy:null,zindex:90},g);var i=new Image,p=T5.XY.init(),
q=T5.XY.init(),a=null;i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
i.onload=function(){p=T5.XY.init(i.width>>1,i.height>>1)};var d=COG.extend(new T5.ViewLayer(g),{pos:g.pos,accuracy:g.accuracy,drawAccuracyIndicator:false,draw:function(j,x){var J=q.x-x.x,$=q.y-x.y;if(a){j.fillStyle="rgba(30, 30, 30, 0.2)";j.beginPath();j.arc(J,$,a,0,Math.PI*2,false);j.fill()}i.complete&&i.width>0&&j.drawImage(i,J-p.x,$-p.y,i.width,i.height);d.changed()},update:function(j){if(j){a=j.getPixelDistance(d.accuracy)>>1;q=j.getGridXYForPosition(d.pos);d.changed()}}});d.bind("gridUpdate",
function(j,x){d.update(x)});return d};return{distanceToString:function(g){if(g>1E3)return~~(g/10)/100+" km";return g?g+" m":""},dist2rad:function(g){return g/6371},getEngine:b,lat2pix:h,lon2pix:c,pix2lat:e,pix2lon:f,radsPerPixel:function(g){return Na/(256<<g)},Position:ra,BoundingBox:db,Radius:function(g,i){return{distance:parseInt(g,10),uom:i}},Address:function(g){return g=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},g)},A:sb,GeocodeFieldWeights:{streetDetails:50,
location:50},AddressCompareFns:{},Engine:function(g){if(!g.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var i=COG.extend({remove:function(){delete Wa[i.id]}},g);return Wa[i.id]=i},Search:ua,GeoSearchResult:Ma,LocationSearch:function(g){function i(j,x){navigator.geolocation.clearWatch(q);q=0;if(a){clearTimeout(a);a=0}x&&x([j],g)}function p(j){COG.info("caught location tracking error:",j)}g=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,
watch:false},g);var q=0,a=0,d=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(j,x){if(navigator.geolocation&&!q){q=navigator.geolocation.watchPosition(function(J){var $=ra.init(J.coords.latitude,J.coords.longitude);J=new Ma({id:1,caption:"Current Location",pos:$,accuracy:J.coords.accuracy/1E3,matchWeight:100});if(!d||J.accuracy<d.accuracy)d=J;if(!g.requiredAccuracy||d.accuracy<g.requiredAccuracy)i(d,x)},p,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)a=
setTimeout(function(){d&&i(d,x)},g.searchTimeout)}}},g))},Routing:Da}}()})(T5);
