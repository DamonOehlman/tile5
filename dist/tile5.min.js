COG=function(){var h=/\$\{(.*?)\}/ig,n=Object.prototype.hasOwnProperty,k=0,d={id:"grunt.core",extend:function(){var a=arguments[0]||{},e=1,m=arguments.length,b=false,o,f,l,g;if(typeof a==="boolean"){b=a;a=arguments[1]||{};e=2}if(typeof a!=="object"&&!d.isFunction(a))a={};if(m===e){a=this;--e}for(;e<m;e++)if((o=arguments[e])!=null)for(f in o){l=a[f];g=o[f];if(a!==g)if(b&&g&&(d.isPlainObject(g)||d.isArray(g))){l=l&&(d.isPlainObject(l)||d.isArray(l))?l:d.isArray(g)?[]:{};a[f]=d.extend(b,l,g)}else if(g!==
undefined)a[f]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return false;var e;for(e in a);return e===undefined||n.call(a,e)},isEmptyObject:function(a){for(var e in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,e){var m=a,b=arguments,o=1;if(e&&d.isArray(e)){b=e;o=0}for(o=o;o<b;o++)m=m&&typeof foo[b[o]]!=="undefined";return m},newModule:function(a){a=d.extend({id:null,requires:[],parent:null},a);if(a.parent)a=d.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+k++},formatStr:function(a){if(arguments.length<=1)return a;for(var e=arguments.length-2,m=0;m<=e;m++)a=a.replace(RegExp("\\{"+m+"\\}","gi"),arguments[m+
1]);return a},wordExists:function(a,e){var m="";if(e.toString)e=e.toString();for(var b=0;b<e.length;b++)m+=!/\w/.test(e[b])?"\\"+e[b]:e[b];return RegExp("(^|\\s|\\,)"+m+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,e){for(var m=h.exec(a);m;){a=a.replace(m[0],COG.XPath.first(m[1],e));h.lastIndex=0;m=h.exec(a)}return a}};return d}();
COG.Log=function(){function h(e,m){var b,o=m&&m.length>0?m[0]:"";for(b=1;m&&b<m.length;b++)o+=" "+(k&&COG.isPlainObject(m[b])?JSON.stringify(m[b]):m[b]);typeof console!=="undefined"&&console[e](o);for(b=0;b<n.length;b++)n[b].call(a,o,e)}var n=[],k=typeof JSON!=="undefined",d=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return d?(new Date).getTime():null},trace:function(e,m){if(d)console.markTimeline(e+(m?": "+(a.getTraceTicks()-m)+"ms":""))},debug:function(){h("debug",
arguments)},info:function(){h("info",arguments)},warn:function(){h("warn",arguments)},error:function(){h("error",arguments)},exception:function(e){a.error(arguments);for(var m in e)a.info("ERROR DETAIL: "+m+": "+e[m])},watch:function(e,m){try{m()}catch(b){a.exception(b,e)}},throwError:function(e){a.error(e);throw Error(e);},requestUpdates:function(e){n.push(e)}};return a}();
(function(){function h(d,a){d[a]||(d[a]=function(e){return d.configure(a,e)})}function n(d){d.gtConfId=COG.objId("configurable");d.gtConfig={};d.gtConfigFns=[];return d.gtConfig}var k={};COG.paramTweaker=function(d,a,e){return function(m,b){if(typeof b!=="undefined"){if(m in d)d[m]=b;e&&m in e&&e[m](m,b)}else return a&&m in a?a[m](m):d[m]}};COG.configurable=function(d,a,e,m){if(d){d.gtConfId||n(d);var b=d.gtConfId,o=d.gtConfig,f=d.gtConfigFns;k[b]=d;f.push(e);for(e=a.length;e--;){o[a[e]]=true;m&&
h(d,a[e])}if(!d.configure)d.configure=function(l,g){if(o[l]){for(var q=f.length;q--;){var v=f[q](l,g);if(typeof v!=="undefined")return v}return k[b]}return null}}}})();
(function(){function h(n,k){var d=n.gtObsHandlers;d[k]||(d[k]=[]);return d[k]}COG.observable=function(n){if(n){if(!n.gtObsHandlers)n.gtObsHandlers={};if(!(n.bind||n.trigger||n.unbind)){n.bind=function(k,d){var a=COG.objId("callback");h(n,k).unshift({fn:d,id:a});return a};n.trigger=function(k){var d=h(n,k),a={cancel:false,tickCount:(new Date).getTime()},e;if(!d)return null;e=Array.prototype.slice.call(arguments,1);e.unshift(a);for(var m=d.length;m--&&!a.cancel;)d[m].fn.apply(self,e);return a};n.unbind=
function(k,d){for(var a=h(n,k),e=0;a&&e<a.length;e++)if(a[e].id===d){a.splice(e,1);break}return n}}}}})();(function(){var h={},n=[];COG.addPipe=function(k){k("pipe.test",{});n.push(k)};COG.listen=function(k,d){h[k]||(h[k]=[]);d&&h[k].push(d)};COG.say=function(k,d){var a;for(a=n.length;a--;)n[a](k,d);if(h[k])for(a=h[k].length;a--;)h[k][a](d)}})();
COG.Loopage=function(){function h(g){return COG.extend({id:e++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function n(g){b.push(g);k()}function k(){o&&clearTimeout(o);o=setTimeout(d,0);l=true}function d(){for(var g,q=(new Date).getTime(),v=m.length;b.length>0;){var u=b.shift();for(g=v;g--;)if(m[g].id===u){m.splice(g,1);break}l=true;v=m.length}if(l){f=a;for(g=v;g--;)f=m[g].frequency<f?m[g].frequency:f}for(g=v;g--;){u=q-m[g].lastTick;if(m[g].lastTick===0||u>=m[g].frequency){m[g].execute(q,
m[g]);m[g].lastTick=q;m[g].single&&m[g].trigger("complete")}}o=v?setTimeout(d,f):0}var a=6E4,e=0,m=[],b=[],o=0,f=a,l=true;return{join:function(g){var q=new h(g);if(q.after>0)q.lastTick=(new Date).getTime()+q.after;COG.observable(q);q.bind("complete",function(){n(q.id)});m.unshift(q);k();return q},leave:n}}();if(!this.JSON)this.JSON={};
(function(){function h(f){return f<10?"0"+f:f}function n(f){a.lastIndex=0;return a.test(f)?'"'+f.replace(a,function(l){var g=b[l];return typeof g==="string"?g:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function k(f,l){var g,q,v,u,y=e,t,w=l[f];if(w&&typeof w==="object"&&typeof w.toJSON==="function")w=w.toJSON(f);if(typeof o==="function")w=o.call(l,f,w);switch(typeof w){case "string":return n(w);case "number":return isFinite(w)?String(w):"null";case "boolean":case "null":return String(w);
case "object":if(!w)return"null";e+=m;t=[];if(Object.prototype.toString.apply(w)==="[object Array]"){u=w.length;for(g=0;g<u;g+=1)t[g]=k(g,w)||"null";v=t.length===0?"[]":e?"[\n"+e+t.join(",\n"+e)+"\n"+y+"]":"["+t.join(",")+"]";e=y;return v}if(o&&typeof o==="object"){u=o.length;for(g=0;g<u;g+=1){q=o[g];if(typeof q==="string")if(v=k(q,w))t.push(n(q)+(e?": ":":")+v)}}else for(q in w)if(Object.hasOwnProperty.call(w,q))if(v=k(q,w))t.push(n(q)+(e?": ":":")+v);v=t.length===0?"{}":e?"{\n"+e+t.join(",\n"+e)+
"\n"+y+"}":"{"+t.join(",")+"}";e=y;return v}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,m,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;if(typeof JSON.stringify!=="function")JSON.stringify=function(f,l,g){var q;m=e="";if(typeof g==="number")for(q=0;q<g;q+=1)m+=" ";else if(typeof g==="string")m=g;if((o=l)&&typeof l!=="function"&&(typeof l!=="object"||typeof l.length!=="number"))throw Error("JSON.stringify");return k("",
{"":f})};if(typeof JSON.parse!=="function")JSON.parse=function(f,l){function g(v,u){var y,t,w=v[u];if(w&&typeof w==="object")for(y in w)if(Object.hasOwnProperty.call(w,y)){t=g(w,y);if(t!==undefined)w[y]=t;else delete w[y]}return l.call(v,u,w)}var q;f=String(f);d.lastIndex=0;if(d.test(f))f=f.replace(d,function(v){return"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){q=eval("("+f+")");return typeof l==="function"?g({"":q},""):q}throw new SyntaxError("JSON.parse");}})();
(function(){function h(k,d){var a=k.split("|"),e={};for(var m in d){var b=d[m];e[m]=a.length>b?a[b]:null}return e}var n={JSON:{parse:function(k){return JSON.parse(k)}},PDON:{parse:function(k){var d=null,a=[];k=k.split("\n");for(var e=0;e<k.length;e++){var m=k[e];if(d)a.push(h(m,d));else if(m){d=m.split("|");m={};for(var b=0;b<d.length;b++)m[d[b]]=b;d=m}else d=null}return a}}};COG.parseData=function(k,d){d=d?d.toUpperCase():"JSON";if(!n[d])throw Error("Unsupported data format: "+d);try{return n[d].parse(k)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function h(a){for(var e=null,m=0;m<n.length;m++)if(e=n[m](a))break;return e}var n=[],k=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var d={SearchResult:function(a){return{toString:function(){var e=
null;if(a){var m=null;if(a.resultType>=0&&a.resultType<k.length)m=k[a.resultType];if(m)e=m(a)}return e?e:""}}},first:function(a,e){var m=d.SearchResult,b;var o=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!o)o=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(e))b=e.evaluate(a,e,h,o,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(f){COG.Log.warn("invalid xpath expression: "+a+" on node: "+e);b=null}return new m(b)},registerResolver:function(a){n.push(a)}};return d}();
COG.Storage=function(){function h(n){if(n&&n=="session")return sessionStorage;return localStorage}return{get:function(n,k){var d=h(k).getItem(n);return/^(\{|\[).*(\}|\])$/.test(d)?JSON.parse(d):d},set:function(n,k,d){k=jQuery.isArray(k)||jQuery.isPlainObject(k)?JSON.stringify(k):k;h(d).setItem(n,k)},remove:function(n,k){h(k).removeItem(n)}}}();
COG.ParseRules=function(){var h=[];return{add:function(n,k){h.push({regex:n,handler:k})},each:function(n,k,d){function a(){e++;d&&e>=h.length&&d(k)}for(var e=0,m=0;m<h.length;m++){var b=h[m].regex,o=h[m].handler,f=false;if(b){b.lastIndex=-1;if((b=b.exec(n))&&o){f=true;o(b,k,a)&&a()}}f||a()}}}};
(function(){function h(b){var o=[],f=function(g,q){q=COG.isFunction(q)?q():q;o[o.length]=encodeURIComponent(g)+"="+encodeURIComponent(q)};if(COG.isArray(b))for(var l=0;l<b.length;l++)f(b[l].name,b[l].value);else for(l in b)f(l,b[l]);return o.join("&").replace(/%20/g,"+")}var n={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},k={JSON:["json"],PDON:["pdon.txt"]},d=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,e={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},m={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function o(){if(this.readyState===4){var q=null,v=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(v)if(b.handleResponse)b.handleResponse(this);else{var u=b,y=this.getResponseHeader(m.CONTENT_TYPE),t,w=false;for(t in n)if(y&&y.indexOf(n[t])>=0){w=true;
break}y=!w;for(w=0;w<d.length;w++)y=y||d[w]==t;if(y)b:{y=t;for(var B in k)for(w=0;w<k[B].length;w++)if(RegExp(k[B][w]+"$","i").test(u.url)){t=B;break b}t=y?y:"DEFAULT"}try{q=e[t](this,u)}catch(z){q=e.DEFAULT(this,u)}}else b.error&&b.error(this)}catch(N){COG.Log.exception(N,"PROCESSING AJAX RESPONSE")}v&&q&&b.success&&b.success.call(this,q)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var f=
a.exec(b.url),l=f&&(f[1]&&f[1]!==location.protocol||f[2]!==location.host);if(b.data)b.method="POST";if(b.url){f=null;if(b.xhr)f=b.xhr(b);f||(f=new XMLHttpRequest);f.open(b.method,b.url,b.async);b.data&&f.setRequestHeader("Content-Type",b.contentType);l||f.setRequestHeader("X-Requested-With","XMLHttpRequest");f.onreadystatechange=o;f.send(b.method=="POST"?h(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function h(a){var e=document.createElement("script"),m=false;e.src=a;e.async=true;e.onload=e.onreadystatechange=function(){if(!m&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){m=true;e.onload=e.onreadystatechange=null;e&&e.parentNode&&e.parentNode.removeChild(e)}};k||(k=document.getElementsByTagName("head")[0]);k.appendChild(e)}var n=0,k,d=this;COG.jsonp=function(a,e,m){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++n;d[b]=function(o){e(o);d[b]=null;try{delete d[b]}catch(f){}};
h(a+(m?m:"callback")+"="+b);return b}})();
COG.Touch=function(){function h(s,p){return{x:s.x-p.x,y:s.y-p.y}}function n(s,p){var r=h(s,p);return Math.sqrt(r.x*r.x+r.y*r.y)}function k(s){if(s.count>1)return n(s.touches[0],s.touches[1]);return 0}function d(s,p){var r=s&&s.count>0?s.touches[0]:null;if(r&&p&&p.count>0)return h(r,p.touches[0]);return null}function a(s,p){s.count=p.count;for(var r=f;r--;){s.touches[r].x=p.touches[r].x;s.touches[r].y=p.touches[r].y}}function e(){for(var s={count:0,touches:Array(f)},p=f;p--;)s.touches[p]=o();return s}
function m(s){if(s.preventDefault){s.preventDefault();s.stopPropagation()}else s.cancelBubble&&s.cancelBubble()}function b(s,p,r){if(G){p=p[r?r:"touches"];r=p.length;for(r=s.count=r;r--;){s.touches[r].x=p[r].pageX;s.touches[r].y=p[r].pageY}}else if(p.button===0){s.count=1;s.touches[0].x=p.pageX?p.pageX:p.screenX;s.touches[0].y=p.pageY?p.pageY:p.screenY}else s.count=0}function o(s,p){return{x:s?s:0,y:p?p:0}}var f=10,l=120,g=100,q=250,v=300,u=5,y=0,t=1,w=2,B=7,z=0,N=0,G=undefined,U=function(s){function p(D,
H,M,L){var A=Math.asin((D.y-H.y)/M);M=M*(va/L)>>0;M=M>ua?ua:M;A=H.x>D.x?A:Math.PI-A;F("pan",Math.cos(A)*-M,Math.sin(A)*M,true)}function r(D,H){var M,L;if(G){M=H-pa;if(M<q){L=n(S.touches[0],D);L>s.inertiaTrigger&&p(S.touches[0],D,L,M)}}else{W.x=D.x;W.y=D.y;COG.Loopage.join({execute:function(A,C){M=A-H;L=n(D,W);if(M<g&&L>s.inertiaTrigger){C.trigger("complete");p(D,W,L,M)}else M>g&&C.trigger("complete")},frequency:10})}}function x(D){var H=0,M=0;if(D.offsetParent){do{H+=D.offsetLeft;M+=D.offsetTop;D=
D.offsetParent}while(D)}return o(H,M)}function E(D){var H=D.count,M=Array(H),L=x(Y);for(H=H;H--;)M[H]=o(D.touches[H].x-L.x,D.touches[H].y-L.y);return M}function F(){ma&&ma.trigger.apply(null,arguments)}function K(D,H){var M=x(Y);M=o(H.x-M.x,H.y-M.y);F(D,H,M)}function J(D){var H=D.target?D.target:D.srcElement;if(qa||H&&H===Y){b(S,D);if(S.count!==0){ha=null;ia.x=0;ia.y=0;P=true;ba=false;pa=(new Date).getTime();m(D);H.style.cursor="move";F("inertiaCancel");sa=pa;if(D=S.count>0?S.touches[0]:null){F("touchStart",
D.x,D.y);if(sa-ta<v)if((D=h(S.touches[0],ea.touches[0]))&&Math.abs(D.x)<s.maxDistDoubleTap&&Math.abs(D.y)<s.maxDistDoubleTap)ba=true;ca=y;a(ea,S)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function X(D){var H=D.target?D.target:D.srcElement,M=0;if(qa||H&&H===Y){b(Z,D);if(Z.count>0){W.x=Z.touches[0].x;W.y=Z.touches[0].y}if(P){G&&m(D);if(Z.count>1){S.count===1&&a(S,Z);M=k(S)-k(Z)}if(ca===y)if((D=d(Z,S))&&(Math.abs(D.x)>=B||Math.abs(D.y)>=B))ca=t;if(ca!==y)if(!M||Math.abs(M)<
u){if(ha=d(Z,ea)){ia.x-=ha.x;ia.y-=ha.y;ja.x-=ha.x;ja.y-=ha.y}F("pan",ja.x,ja.y);ja.x=0;ja.y=0;ca=t}else{F("pinchZoom",E(S),E(Z));ca=w}a(ea,Z)}}}function T(D){var H=D.target?D.target:D.srcElement;if(P&&(qa||H&&H===Y)){b(fa,D,"changedTouches");var M=fa.touches[0];G&&m(D);D=(new Date).getTime();ta=sa;if(ca===y){K("tap",S.touches[0]);ka||(ka=setTimeout(function(){ka=0;ba&&K("doubleTap",S.touches[0])},v+50))}else if(ca==t){F("panEnd",ia.x,ia.y);la&&r(M,D)}else ca==w&&F("pinchZoomEnd",E(S),E(ea),D-pa);
H.style.cursor="default";P=false}}function $(D){var H=D.target?D.target:D.srcElement;if(qa||H&&H===Y){if(D.detail){H=-D.detail*l;H=o(D.axis===1?H:0,D.axis===2?H:0)}else H=o(D.wheelDeltaX,D.wheelDeltaY);var M=H.y!==0?Math.abs(H.y/l):0;if(W&&M!==0){var L=o(W.x-Y.offsetLeft,W.y-Y.offsetTop);F("wheelZoom",L,Math.pow(2,H.y>0?M:-M))}m(D)}}s=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,
tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},s);var ba=false,ka=0,ga=T5.getConfig(),S=e(),Z=e(),ea=e(),fa=e(),ha=null,ia=o(),ja=o(),ca=null,P=false,pa=0,oa=[],W=o(),la=false,va,ua,sa=0,ta=0,Y=s.element,ma=s.observable,qa=typeof FlashCanvas!=="undefined",da={supportsTouch:G,addListeners:function(D){oa.push(D)},decoupleListeners:function(D){for(var H=0;D&&H<oa.length;H++)if(oa[H].listenerId===D){oa.splice(H,1);break}},release:function(){ga.unbindEvent(G?"touchstart":"mousedown",J,false);
ga.unbindEvent(G?"touchmove":"mousemove",X,false);ga.unbindEvent(G?"touchend":"mouseup",T,false);if(!G){window.removeEventListener("mousewheel",$,false);window.removeEventListener("DOMMouseScroll",$,false)}},inertiaEnable:function(D,H){la=true;va=D;ua=H?Math.min(H.width,H.height):500},inertiaDisable:function(){la=false}};if(typeof G==="undefined")G=T5.getConfig().supportsTouch;ga.bindEvent(G?"touchstart":"mousedown",J,false);ga.bindEvent(G?"touchmove":"mousemove",X,false);ga.bindEvent(G?"touchend":
"mouseup",T,false);if(!G){ga.bindEvent("mousewheel",$,window);ga.bindEvent("DOMMouseScroll",$,window)}return da},O=[];return{capture:function(s,p){if(!s)throw Error("Unable to capture touch of null element");if(!s.id)s.id="touchable_"+z++;var r=O[s.id];if(!r){r=new U(COG.extend({element:s},p));O[s.id]=r}if(p){p.listenerId&&r.decoupleListeners(p.listenerId);p.listenerId=++N;r.addListeners(p)}return r},release:function(s){if(s&&s.id&&O[s.id]){O[s.id].release();delete O[s.id]}}}}();
T5=function(){var h=function(){function a(b,o){return m(b.x-o.x,b.y-o.y)}function e(b,o){if(!o)o=b.length;if(o<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var f={edges:Array(o-1),accrued:Array(o-1),total:0},l=0;l<o-1;l++){var g=a(b[l],b[l+1]);f.edges[l]=Math.sqrt(g.x*g.x+g.y*g.y);f.accrued[l]=f.total+f.edges[l];f.total+=f.edges[l]}return f}function m(b,o){return{x:b?b:0,y:o?o:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,o=0,f=arguments.length;f--;){b+=arguments[f].x;o+=arguments[f].y}return m(b,o)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?m(b.x,b.y):null},diff:a,distance:function(b,o){return e(b,o).total},edges:e,equals:function(b,o){return b.x===o.x&&b.y===o.y},extendBy:function(b,o,f){return m(b.x-Math.cos(o)*f,b.y-Math.sin(o)*f)},floor:function(b){for(var o=Array(b.length),f=b.length;f--;)o[f]=m(~~b[f].x,~~b[f].y);return o},getRect:function(b){for(var o,f,l,
g,q=b.length;q--;){var v=b[q];o=typeof o==="undefined"||v.x<o?v.x:o;f=typeof f==="undefined"||v.y<f?v.y:f;l=typeof l==="undefined"||v.x>l?v.x:l;g=typeof g==="undefined"||v.y>g?v.y:g}return k.init(o,f,g,g)},init:m,invert:function(b){return m(-b.x,-b.y)},offset:function(b,o,f){return m(b.x+o,b.y+(f?f:o))},simplify:function(b,o){if(!b)return null;o=o?o:h.VECTOR_SIMPLIFICATION;for(var f=[],l=null,g=b.length;g--;){var q=b[g];if(include=!l||g===0||Math.abs(q.x-l.x)+Math.abs(q.y-l.y)>o){f.unshift(q);l=q}}return f},
theta:function(b,o,f){f=Math.asin((b.y-o.y)/f);return b.x>o.x?f:Math.PI-f}}}(),n=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),k=function(){function a(e,m,b,o){e=e?e:0;m=m?m:0;b=b?b:e;o=o?o:o;return{x1:e,y1:m,x2:b,y2:o,width:b-e,height:o-m}}return{center:function(e){return h.init(e.x1+e.width/2,e.y1+e.height/2)},copy:function(e){return a(e.x1,e.y1,e.x2,e.y2)},diagonalSize:function(e){return Math.sqrt(e.width*e.width+e.height*e.height)},fromCenter:function(e,m,b,o){b=~~(b/
2);o=~~(o/2);return a(e-b,m-o,e+b,m+o)},init:a}}(),d=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return h.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,height:e?e:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:h,XYRect:k,Vector:function(a,e){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return h.init(a,e)},V:COG.extend(h,n),D:d}}();
(function(){function h(){for(;u.length>0;){var t=u.shift();document.location=t}v=0}function n(t){for(var w=true,B=y.length;B--;)w=w&&t!=y[B];return w}function k(t,w){var B=[];for(var z in w)z&&B.push(z+"="+escape(w[z]));return"tile5://"+t+"/"+(B.length>0?"?"+B.join("&"):"")}function d(t,w){n(t)&&COG.Log.info("would push url: "+k(t,w))}function a(t,w){if(n(t)){u.push(k(t,w));v||(v=setTimeout(h,100))}}function e(t){return function(w,B,z){(z?z:t?document.body:document).addEventListener(w,B,false)}}function m(t){return function(w,
B,z){(z?z:t?document.body:document).removeEventListener(w,B,false)}}function b(t,w,B){(B?B:document).attachEvent("on"+t,w)}function o(t,w,B){(B?B:document).detachEvent("on"+t,w)}function f(){l={base:{name:"Unknown",bindEvent:e(),unbindEvent:m(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:d,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:o,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:e(true),unbindEvent:m(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[l.froyo,l.android,l.ipod,l.iphone,l.ipad,l.ie]}var l=null,g=[],q=null,v=0,u=[],y=["view.wake","tile.loaded"];T5.getConfig=function(){l||f();if(!q){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var t=0;t<g.length;t++){var w=g[t];if(w.regex&&w.regex.test(navigator.userAgent)){q=T5.ex({},l.base,w);COG.Log.info("PLATFORM DETECTED AS: "+q.name);break}}if(!q){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
q=l.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return q}})();
T5.Dispatcher=function(){var h=[],n={execute:function(k){var d=n.findAction(k);d&&d.execute.apply(d,Array.prototype.slice.call(arguments,1))},findAction:function(k){for(var d=h.length;d--;)if(h[d].id==k)return h[d];return null},getRegisteredActions:function(){return[].concat(h)},getRegisteredActionIds:function(){for(var k=[],d=h.length;d--;)h[d].id&&k.push(h[d].id);return k},registerAction:function(k){k&&k.id&&h.push(k)},Action:function(k){k=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},k);var d={id:k.id,execute:function(){k.execute&&k.execute.apply(this,arguments)},getParam:function(a){return k[a]?k[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",d.id,k.title,k.icon)}};k.autoRegister&&n.registerAction(d);return d},Agent:function(k){k=COG.extend({name:"Untitled",translator:null,execute:null},k);var d={getName:function(){return k.name},getParam:function(a){return k[a]},getId:function(){return COG.toID(d.getName())},run:function(a,e){if(k.execute){var m=
k.translator?k.translator(a):a;k.execute.call(d,m,function(b,o){e&&e(b,o,m)})}}};return d},runAgents:function(k,d,a){for(var e=0;e<k.length;e++)k[e].run(d,a)}};return n}();
T5.Resources=function(){var h="",n={},k={getPath:function(d){return/^(file|https?|\/)/.test(d)?d:h+d},setBasePath:function(d){h=d},loadResource:function(d){d=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},d);var a=function(e){d.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){d.callback(e)})};d.cacheable&&n[d.filename]?a(n[d.filename]):COG.xhr({url:k.getPath(d.filename),dataType:d.dataType,success:function(e){if(d.cacheable)n[d.filename]=e;a(e)},error:function(e,m,b){COG.Log.error("error loading resource ["+
d.filename+"], error = "+b)}})},loadSnippet:function(d,a){/\.\w+$/.test(d)||(d+=".html");k.loadResource({filename:"snippets/"+d,callback:a,dataType:"html"})}};return k}();
T5.Images=function(){function h(){if(!v){var t=T5.getConfig().maxImageLoads;v=COG.Loopage.join({execute:function(w,B){if(!t||l.length<t){var z=f.shift();if(z){l[l.length]=z;z.image.onload=k;z.image.src=T5.Resources.getPath(z.url);z.requested=T5.ticks()}else B.trigger("complete")}},frequency:10});v.bind("complete",function(){v=null})}}function n(){u=true;try{var t=g.length/2>>0;if(t>0){g.sort(function(B,z){return B.created-z.created});for(var w=t;w--;)delete e[g[w].url];g.splice(0,t)}}finally{u=false}COG.say("imagecache.cleared")}
function k(){var t=b[this.id],w;if(t&&t.image.complete&&t.image.width>0){t.loaded=true;t.hitCount=1;for(w=l.length;w--;)if(l[w].image.src==this.src){l.splice(w,1);break}if(t.background||t.postProcess||t.drawBackground||t.customDraw)if(t.image){w=a(t.realSize?t.realSize.width:image.width,t.realSize?t.realSize.height:image.height);var B=w.getContext("2d"),z=t.offset?t.offset:T5.XY.init();t.background&&B.drawImage(t.background,0,0);t.drawBackground&&t.drawBackground(B);t.customDraw?t.customDraw(B,t):
B.drawImage(t.image,z.x,z.y);t.postProcess&&t.postProcess(B,t);t.image=w}for(w=t.callbacks.length;w--;)t.callbacks[w]&&t.callbacks[w](this,false);t.callbacks=[];g[g.length]={url:this.src,created:t.requested};delete b[this.id];h()}}function d(t,w,B){var z=e[t];if(z){z.hitCount++;z.image.complete&&z.image.width>0&&w?w(z.image,true):z.callbacks.push(w)}else{z=T5.ex({url:t,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[w]},B);z.image.id="resourceLoaderImage"+o++;
e[t]=z;b[z.image.id]=z;f[f.length]=z;h()}return z}function a(t,w){var B=document.createElement("canvas");B.width=t?t:0;B.height=w?w:0;if(typeof FlashCanvas!=="undefined"){B.id="tmpCanvas"+m++;B.style.cssText="position: absolute; top: -"+(w-1)+"px; left: -"+(t-1)+"px;";document.body.appendChild(B);FlashCanvas.initElement(B)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(B);return B}var e={},m=0,b={},o=0,f=[],l=[],g=[],q=0,v=null,u=false,y={avgImageSize:25,loadTimeout:10,cancelLoad:function(){l=
[]},get:function(t,w,B){var z=null,N=null;u||(z=e[t]);if((N=z?z.image:null)&&(N.getContext||N.complete&&N.width>0))return N;else w&&d(t,w,B);return null},load:d,newCanvas:a,reset:function(){e={}},stats:function(){return{imageLoadingCount:l.length,queuedImageCount:f.length,imageCacheFullness:q}}};COG.Loopage.join({execute:function(t){for(var w=false,B=0,z=T5.getConfig();B<l.length;)if(t-l[B].requested>y.loadTimeout*1E3){l.splice(B,1);w=true}else B++;w&&h();if(z&&z.imageCacheMaxSize){q=g.length*y.avgImageSize/
z.imageCacheMaxSize;q>=1&&n()}},frequency:2E4});return y}();T5.Generator=function(){var h={};return{init:function(n,k){var d=h[n];if(!d)throw Error("Unable to locate requested generator: "+n);return new d(k)},register:function(n,k){h[n]=k},Template:function(){}}}();
T5.TimeLord=function(){var h=/^P(\d+Y)?(\d+M)?(\d+D)?$/,n=/^(\d+H)?(\d+M)?(\d+S)?$/,k=function(a,e){return{days:a?a:0,seconds:e?e:0}},d={8601:function(a){a=a.split("T");var e=null;e=null;var m=0,b=0;h.lastIndex=-1;e=h.exec(a[0]);m+=e[3]?parseInt(e[3].slice(0,-1),10):0;n.lastIndex=-1;e=n.exec(a[1]);b+=e[1]?parseInt(e[1].slice(0,-1),10)*3600:0;b+=e[2]?parseInt(e[2].slice(0,-1),10)*60:0;b+=e[3]?parseInt(e[3].slice(0,-1),10):0;return new k(m,b)}};return{Duration:k,addDuration:function(){for(var a=new k,
e=arguments.length;e--;){a.days+=arguments[e].days;a.seconds+=arguments[e].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,e){var m=e?d[e]:null;if(m)return m(a);COG.Log.warn("Could not find duration parser for specified format: "+e);return new k},formatDuration:function(a){var e,m,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){e=~~(a/3600);a-=e*3600}if(a>=60){m=Math.round(a/60);a-=m*60}if(e)b=b+e+(e>1?" hrs ":" hr ")+
(m?(m>10?m:"0"+m)+" min ":"");else if(m)b=b+m+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
(function(){var h=Math.PI*2,n=Math.PI/2,k=Math.abs,d=Math.pow,a=Math.sin,e=Math.asin,m=Math.cos,b=1.70158,o={linear:function(f,l,g,q){return g*f/q+l},backin:function(f,l,g,q){return g*(f/=q)*f*((b+1)*f-b)+l},backout:function(f,l,g,q){return g*((f=f/q-1)*f*((b+1)*f+b)+1)+l},backinout:function(f,l,g,q){return(f/=q/2)<1?g/2*f*f*(((b*=1.525)+1)*f-b)+l:g/2*((f-=2)*f*(((b*=1.525)+1)*f+b)+2)+l},bouncein:function(f,l,g,q){return g-o.bounceout(q-f,0,g,q)+l},bounceout:function(f,l,g,q){return(f/=q)<1/2.75?
g*7.5625*f*f+l:f<2/2.75?g*(7.5625*(f-=1.5/2.75)*f+0.75)+l:f<2.5/2.75?g*(7.5625*(f-=2.25/2.75)*f+0.9375)+l:g*(7.5625*(f-=2.625/2.75)*f+0.984375)+l},bounceinout:function(f,l,g,q){return f<q/2?o.bouncein(f*2,0,g,q)/2+l:o.bounceout(f*2-q,0,g,q)/2+g/2+l},cubicin:function(f,l,g,q){return g*(f/=q)*f*f+l},cubicout:function(f,l,g,q){return g*((f=f/q-1)*f*f+1)+l},cubicinout:function(f,l,g,q){if((f/=q/2)<1)return g/2*f*f*f+l;return g/2*((f-=2)*f*f+2)+l},elasticin:function(f,l,g,q,v,u){if(f==0)return l;if((f/=
q)==1)return l+g;u||(u=q*0.3);if(!v||v<k(g)){v=g;g=u/4}else g=u/h*e(g/v);return-(v*d(2,10*(f-=1))*a((f*q-g)*h/u))+l},elasticout:function(f,l,g,q,v,u){var y;if(f==0)return l;if((f/=q)==1)return l+g;u||(u=q*0.3);if(!v||v<k(g)){v=g;y=u/4}else y=u/h*e(g/v);return v*d(2,-10*f)*a((f*q-y)*h/u)+g+l},elasticinout:function(f,l,g,q,v,u){var y;if(f==0)return l;if((f/=q/2)==2)return l+g;u||(u=q*0.3*1.5);if(!v||v<k(g)){v=g;y=u/4}else y=u/h*e(g/v);if(f<1)return-0.5*v*d(2,10*(f-=1))*a((f*q-y)*h/u)+l;return v*d(2,
-10*(f-=1))*a((f*q-y)*h/u)*0.5+g+l},quadin:function(f,l,g,q){return g*(f/=q)*f+l},quadout:function(f,l,g,q){return-g*(f/=q)*(f-2)+l},quadinout:function(f,l,g,q){if((f/=q/2)<1)return g/2*f*f+l;return-g/2*(--f*(f-2)-1)+l},sinein:function(f,l,g,q){return-g*m(f/q*n)+g+l},sineout:function(f,l,g,q){return g*a(f/q*n)+l},sineinout:function(f,l,g,q){return-g/2*(m(Math.PI*f/q)-1)+l}};T5.easing=function(f){return o[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(f,l){o[f.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=l}})();
T5.Tween=function(h){h=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},h);var n=T5.ticks(),k=[],d=false,a=0,e=0,m={cancelOnInteract:h.cancelOnInteract,isComplete:function(){return d},triggerComplete:function(b){h.complete&&h.complete(b)},update:function(b){try{var o=h.tweenFn(b-n,a,e,h.duration);if(h.target)h.target[h.property]=o;for(var f=k.length;f--;)k[f](o,void 0);if(d=n+h.duration<=b){if(h.target)h.target[h.property]=
h.tweenFn(h.duration,a,e,h.duration);for(var l=k.length;l--;)k[l](o,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(b){k.push(b)}};a=h.target&&h.property&&h.target[h.property]?h.target[h.property]:h.startValue;if(typeof h.endValue!=="undefined")e=h.endValue-a;if(e==0)d=true;T5.wakeTweens();return m};
(function(){function h(a){if(d)return n.length;d=true;try{for(var e=0;e<n.length;)if(n[e].isComplete()){n[e].triggerComplete(false);n.splice(e,1)}else{n[e].update(a);e++}}finally{d=false}n.length===0&&k.trigger("complete");return n.length}var n=[],k=null,d=false;T5.tweenValue=function(a,e,m,b,o){a=new T5.Tween({startValue:a,endValue:e,tweenFn:m,complete:b,duration:o});n.push(a);return a};T5.tween=function(a,e,m,b,o,f){a=new T5.Tween({target:a,property:e,endValue:m,tweenFn:b,duration:f,complete:o});
n.push(a);return a};T5.tweenVector=function(a,e,m,b,o,f){var l=[];if(a){var g=a.x==e,q=a.y==m;g||l.push(T5.tween(a,"x",e,b,function(){(g=true)&&q&&o()},f));q||l.push(T5.tween(a,"y",m,b,function(){q=true;g&&q&&o()},f))}return l};T5.cancelAnimation=function(a){if(!d){d=true;try{for(var e=0;e<n.length;)if(!a||a(n[e])){n[e].triggerComplete(true);n.splice(e,1)}else e++}finally{d=false}}};T5.isTweening=function(){return n.length>0};T5.wakeTweens=function(){if(!k){k=COG.Loopage.join({execute:h,frequency:20});
k.bind("complete",function(){k=null})}}})();(function(){var h={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,PINCH:16,FREEZE:128};T5.viewState=function(){for(var n=0,k=arguments.length;k--;){var d=h[arguments[k].toUpperCase()];if(d)n|=d}return n}})();
T5.ViewLayer=function(h){h=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","PINCH")},h);var n=null,k=false,d=false,a=h.supportFastDraw,e=h.id,m=T5.viewState("ACTIVE"),b=h.validStates,o=0,f=0,l=T5.ex({addToView:function(g){g.setLayer(e,l)},shouldDraw:function(g,q,v){g=(g&b)!==0&&(k?a:true);return g=d||v||o!==q.x||f!==q.y},cycle:function(){},draw:function(){},remove:function(){l.trigger("remove",l)},changed:function(){d=true;l.trigger("changed",
l);n&&n.trigger("invalidate")},getId:function(){return e},setId:function(g){e=g},getParent:function(){return n},setParent:function(g){k=(n=g)?n.fastDraw&&displayState!==m:false;l.trigger("parentChange",n)}},h);COG.observable(l);l.bind("drawComplete",function(g,q){d=false;o=q.x;f=q.y});return l};
T5.View=function(h){function n(A,C,I,Q){da=Y;B();if(Q&&h.inertia){ba=true;f(O+C,s+I,h.panAnimationEasing,h.panAnimationDuration)}else Q||f(O+C,s+I)}function k(){da=ta;ba=false;COG.Loopage.join({execute:B,after:50,single:true})}function d(A,C){fa=D(A);ha=D(C);var I=H(fa),Q=H(ha);la=M(fa);T=M(ha);P=fa&&I!==0?Q/I:1}function a(A,C,I){d(C,I);if(ea=P!==1){da=ma;B()}}function e(A,C,I,Q){d(C,I);if(h.adjustScaleFactor){P=h.adjustScaleFactor(P);COG.Log.info("scale factor adjusted to: "+P)}if(Q<h.pinchZoomAnimateTrigger){q(oa,
P,la,v(),T5.easing("sine.out"),function(){b();P=1},300);P=oa}else{b();P=1}}function m(A,C,I){L.zoom(C,Math.min(Math.pow(2,Math.round(Math.log(I))),8),500)}function b(){var A=fa?v():T;P=Math.round(P*10)/10;ea=false;for(var C=z.length;C--;)z[C].trigger("scale",P,A);L.trigger("scale",P,A);da=ta;B()}function o(){clearTimeout(ca);ca=setTimeout(l,50)}function f(A,C,I,Q,R){function V(){aa+=1;if(aa>=2){k(0,0);R&&R()}}var aa=0;if(I){A=T5.tweenValue(O,A,I,V,Q);C=T5.tweenValue(s,C,I,V,Q);A.cancelOnInteract=
true;A.requestUpdates(function(na){O=na;ba=true;B()});C.cancelOnInteract=true;C.requestUpdates(function(na){s=na;ba=true;B()})}else{O=A;s=C}}function l(){var A;if(G){COG.Touch.release(G);if(h.autoSize&&G.parentNode){A=G.parentNode.getBoundingClientRect();if(A.height!==0&&A.width!==0){G.height=A.height;G.width=A.width}}try{if(!G.id)G.id=h.id+"_canvas";U=G.getContext("2d");U.clearRect(0,0,G.width,G.height)}catch(C){COG.Log.exception(C);throw Error("Could not initialise canvas on specified view element");
}sa=COG.Touch.capture(G,{observable:L});if(J.height!==G.height||J.width!==G.width){J=T5.D.init(G.width,G.height);L.trigger("resize",G.width,G.height);for(A=N;A--;)z[A].trigger("resize",G.width,G.height)}h.inertia&&sa.inertiaEnable(h.panAnimationDuration,J);for(A=N;A--;)z[A].trigger("contextChanged",U);w()}}function g(A,C){C.setId(A);C.added=T5.ticks();C.bind("remove",function(){L.removeLayer(A)});C.trigger("contextChanged",U);C.setParent(L);z.push(C);z.sort(function(I,Q){var R=Q.zindex-I.zindex;if(R===
0)R=Q.added-I.added;return R});N=z.length;return C}function q(A,C,I,Q,R,V,aa){function na(){V&&V();b();P=1;W=null}ea=true;la=T5.XY.copy(I);T=T5.XY.copy(Q);fa=null;if(R)T5.tweenValue(0,C-A,R,na,aa?aa:1E3).requestUpdates(function(ra){W=ra/(C-A);P=A+ra;da=ma;B();L.trigger("animate")});else{P=targetScaleFactor;na()}}function v(){var A=T5.D.getCenter(J),C=T5.XY.distance([T,A]);A=T5.XY.theta(T,A,C);var I=T5.XY.diff(la,T);A=T5.XY.extendBy(T,A,C/P);A.x+=I.x;A.y+=I.y;return A}function u(){L.trigger("idle",
L);$=true;ka=0}function y(A,C,I,Q,R){if(F)C=T5.viewState("FROZEN");var V=(C&ma)!==0,aa=0;if(x||V){A.clearRect(0,0,G.width,G.height);x=false}if(V){T5.D.getCenter(J);var na=(W?W:1)/2,ra=T5.XY.diff(la,T);if(fa){S.x=T.x+ra.x;S.y=T.y+ra.y}else{S.x=T.x-ra.x*na;S.y=T.y-ra.y*na}}A.save();try{oa=P;A.translate(-I.x1,-I.y1);if(K!==1)A.scale(K,K);else if(V){A.translate(T.x,T.y);A.scale(P,P)}for(aa=N;aa--;)if(z[aa].shouldDraw(C,I,Q)){z[aa].draw(A,I,C,L,Q,R);z[aa].trigger("drawComplete",I,R)}}finally{A.restore()}L.trigger("drawComplete",
I,R);COG.Log.trace("draw complete",R)}function t(A,C){var I=false,Q=ia?ia:ba?Y:da,R=!ba&&(Q===ma||Q===Y),V=ja||Q===Y||Q===ma||T5.isTweening();p=T5.XY.init(O>>0,s>>0);r=T5.XYRect.fromCenter(p.x,p.y,J.width,J.height);if(R){T5.cancelAnimation(function(aa){return aa.cancelOnInteract});$=false;if(ka!==0){clearTimeout(ka);ka=0}}for(R=N;R--;){if(z[R].animated)da|=qa;I=z[R].cycle(A,r,da,V)||I}V=V||(da&qa)!==0;if(I=I||V||P!==1&&P!==pa){y(U,Q,r,V,A);pa=P;ja=false}if(!I&&X===0&&!va){if(!$&&ka===0)ka=setTimeout(u,
500);C.trigger("complete")}X=0;COG.Log.trace("Completed draw cycle",A)}function w(){ja=true;B()}function B(){X+=1;if(!(F||E)){E=COG.Loopage.join({execute:t,frequency:ua});E.bind("complete",function(){E=null})}}h=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},h);var z=[],N=0,G=document.getElementById(h.container),
U=null,O=0,s=0,p=null,r=null,x=false,E=null,F=false,K=1,J=T5.D.init(),X=0,T=null,$=false,ba=false,ka=0,ga=0,S=T5.XY.init(),Z=0,ea=false,fa=null,ha=null,ia=null,ja=false,ca=0,P=1,pa=0,oa=1,W=null,la=null,va=typeof FlashCanvas!=="undefined",ua=~~(1E3/h.fps),sa=null,ta=T5.viewState("ACTIVE"),Y=T5.viewState("PAN"),ma=T5.viewState("PINCH"),qa=T5.viewState("ANIMATING"),da=ta,D=T5.XY.getRect,H=T5.XYRect.diagonalSize,M=T5.XYRect.center,L={id:h.id,deviceScaling:K,fastDraw:h.fastDraw||T5.getConfig().requireFastDraw,
animate:function(A,C,I,Q,R){q(P,A,C,I,Q,R)},centerOn:function(A){O=A.x-G.width/2;s=A.y-G.height/2},getDimensions:function(){return J},getZoomCenter:function(){return S},getLayer:function(A){for(var C=0;C<N;C++)if(z[C].getId()==A)return z[C];return null},setLayer:function(A,C){for(var I=0;I<N;I++)if(z[I].getId()===A){z.splice(I,1);break}C&&g(A,C);w()},eachLayer:function(A){for(var C=N;C--;)A(z[C])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");x=true;w()},invalidate:w,
freeze:function(){F=true},unfreeze:function(){F=false;B()},resize:function(A,C){if(G){h.autoSize=false;G.width=A;G.height=C;l();L.trigger("resize",G.width,G.height)}},scale:function(A,C,I,Q,R){Q||(Q=T5.D.getCenter(J));R||(R=T5.D.getCenter(J));L.animate(A,Q,R,C,I);return L},removeLayer:function(A){a:{for(var C=N;C--;)if(z[C].getId()==A){A=C;break a}A=-1}if(A>=0&&A<N){COG.say("layer.removed",{layer:z[A]});z.splice(A,1);w()}N=z.length},stateOverride:function(A){ia=A},getOffset:function(){return p?p:
T5.XY.init(O,s)},getOffsetRect:function(){return r?r:T5.XYRect.fromCenter(O,s,J.width,J.height)},updateOffset:f,zoom:function(A,C,I){ba=false;P=C;ea=P!==1;la=T5.D.getCenter(J);T=P>1?T5.XY.copy(A):T5.D.getCenter(J);fa=null;clearTimeout(ga);if(ea){da=ma;B();if(I)ga=setTimeout(function(){b();P=1},parseInt(I,10))}}};K=T5.getConfig().getScaling();L.markers=g("markers",new T5.MarkerLayer);COG.observable(L);L.bind("wake",B);L.bind("invalidate",w);if(h.pannable){L.bind("pan",n);L.bind("panEnd",k);L.bind("inertiaCancel",
function(){ba=false;B()})}if(h.scalable){L.bind("pinchZoom",a);L.bind("pinchZoomEnd",e);L.bind("wheelZoom",m)}L.bind("tap",function(A,C,I){for(var Q=T5.XY.offset(I,O,s),R=z.length;R--;)A.cancel=A.cancel||z[R].trigger("tap",C,I,Q).cancel});COG.configurable(L,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(h,null,{container:function(A,C){G=document.getElementById(C);l()},rotation:function(A,C){Z=C}}),true);l();h.autoSize&&window.addEventListener("resize",o,false);
return L};
T5.PathLayer=function(h){function n(l){l.syncVectors(e);m&&l.syncVectors(m);f.trigger("tidy")}h=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},h);var k=false,d=[],a=null,e=[],m=null,b=0,o=[],f=T5.ex(new T5.ViewLayer(h),{getAnimation:function(l,g,q,v){var u="pathAnimation"+b++;o.push(u);return new T5.AnimatedPathLayer({id:u,path:d,zindex:h.zindex+1,easing:l?l:T5.easing("sine.inout"),duration:g?g:5E3,drawIndicator:q,autoCenter:v?v:false})},cycle:function(l,g,q,v){return v},draw:function(l,g){var q,
v=d.length;l.save();try{T5.applyStyle(l,h.style);if(v>0){l.beginPath();l.moveTo(d[v-1].x-g.x,d[v-1].y-g.y);for(q=v;q--;)l.lineTo(d[q].x-g.x,d[q].y-g.y);l.stroke();if(a){l.fillStyle=h.waypointFillStyle;for(q=a.length;q--;){l.beginPath();l.arc(a[q].x-g.x,a[q].y-g.y,2,0,Math.PI*2,false);l.stroke();l.fill()}}}}finally{l.restore()}k=false},updateCoordinates:function(l,g){var q=f.getParent();q=q?q.getTileLayer():null;e=l;m=g;COG.Log.info("updating coordinates, grid = "+q);q&&n(q)}});f.bind("gridUpdate",
function(l,g){n(g);for(var q=o.length;q--;)COG.say("layer.remove",{id:o[q]});o=[]});f.bind("tidy",function(){d=T5.XY.simplify(e,h.pixelGeneralization);a=T5.XY.simplify(m,h.pixelGeneralization);k=true;f.changed()});return f};
T5.ShapeLayer=function(h){function n(e){for(var m=k.length;m--;)k[m].resync(e);k.sort(function(b,o){var f=o.xy.y-b.xy.y;if(f===0)f=o.xy.x-b.xy.y;return f});d=true;a.changed()}h=T5.ex({zindex:80,style:null},h);var k=[],d=false,a=T5.ex(new T5.ViewLayer(h),{add:function(e){k[k.length]=e},each:function(e){for(var m=k.length;m--;)e(k[m])},cycle:function(){return d},draw:function(e,m,b){var o=m.x1,f=m.y1,l=m.width;m=m.height;e.save();try{T5.applyStyle(e,h.style);for(var g=k.length;g--;){var q=k[g].style,
v=q?T5.applyStyle(e,q):null;k[g].draw(e,o,f,l,m,b);v&&T5.applyStyle(e,v)}}finally{e.restore()}d=false}});a.bind("parentChange",function(e,m){m.syncVectors&&n(m)});COG.configurable(a,["style"],COG.paramTweaker(h,null,null),true);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(h){h=T5.ex({style:null,properties:{}},h);return T5.ex(h,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(h,n){n=T5.ex({size:4},n);var k=T5.XY.init(),d=T5.ex(n,{draw:function(a){a.beginPath();a.arc(k.x,k.y,d.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncVectors([h]);k=T5.XY.floor([h])[0]}});COG.Log.info("created arc = ",h);return d};
T5.Poly=function(h,n){n=T5.ex({fill:false,simplify:false},n);var k=false,d=n.fill,a=n.simplify,e=T5.viewState("PINCH"),m=[],b=T5.ex(new T5.Shape(n),{draw:function(o,f,l,g,q,v){if(k){f=true;l=(v&e)!==0;o.beginPath();for(v=m.length;v--;){l=m[v].x;g=m[v].y;if(f){o.moveTo(l,g);f=false}else o.lineTo(l,g);l=true}if(l){d&&o.fill();o.stroke()}}},resync:function(o){b.xy=o.syncVectors(h);m=T5.XY.floor(a?T5.XY.simplify(h):h)}});k=h&&h.length>=2;return b};
T5.AnimatedPathLayer=function(h){function n(b,o,f){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(f.x,f.y,4,0,Math.PI*2,false);b.stroke();b.fill()}h=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","PINCH"),drawIndicator:null,duration:2E3,autoCenter:false},h);var k=T5.XY.edges(h.path),d,a=null,e=0;T5.tweenValue(0,k.total,h.easing,function(){m.remove()},h.duration).requestUpdates(function(b,o){e=b;o&&m.remove()});var m=
T5.ex(new T5.ViewLayer(h),{cycle:function(){for(var b=0;b<k.accrued.length&&k.accrued[b]<e;)b++;a=null;if(b<h.path.length-1){var o=e-(b>0?k.accrued[b-1]:0),f=h.path[b];d=T5.XY.theta(f,h.path[b+1],k.edges[b]);a=T5.XY.extendBy(f,d,o);if(h.autoCenter)(b=m.getParent())&&b.centerOn(a)}return a},draw:function(b,o){if(a)(h.drawIndicator?h.drawIndicator:n)(b,o,T5.XY.init(a.x-o.x,a.y-o.y),d)}});return m};
T5.Marker=function(h){function n(o,f,l,g){d=o;a=f;e=l;m=g}h=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},h);var k=false,d=0,a=0,e=0,m=0,b=T5.ex(h,{isNew:true,isAnimating:function(){return k},draw:function(o,f,l,g,q){if(b.isNew&&h.tweenIn){var v=b.xy.y;b.xy.y=f.y-20;k=true;T5.tween(b.xy,"y",v,h.tweenIn,function(){b.xy.y=v;k=false},h.animationSpeed?h.animationSpeed:250+Math.random()*500)}b.drawMarker(o,f,b.xy.x,b.xy.y,l,g,q);b.isNew=false},drawMarker:function(o,f,l,g){o.beginPath();
o.arc(l,g,4,0,Math.PI*2,false);o.fill();n(l-4,g-4,8,8)},hitTest:function(o,f){return o>=d&&o<=d+e&&f>=a&&f<=a+m},updateBounds:n});COG.observable(b);return b};
T5.ImageMarker=function(h){h=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},h);var n=h.imageAnchor?T5.XY.invert(h.imageAnchor):null,k=T5.ex(new T5.Marker(h),{drawMarker:function(d,a,e,m){if((a=k.isAnimating()&&k.animatingImage?k.animatingImage:k.image)&&a.complete&&a.width>0){n||(n=T5.XY.init(-a.width>>1,-a.height>>1));var b=k.scale,o=e+~~(n.x*b),f=m+~~(n.y*b),l=~~(a.width*b),g=~~(a.height*b);k.updateBounds(o,f,l,l);if(k.rotation||
k.opacity!==1){d.save();try{d.globalAlpha=k.opacity;d.translate(e,m);d.rotate(k.rotation);d.drawImage(a,n.x*b,n.y*b,l,g)}finally{d.restore()}}else d.drawImage(a,o,f,l,g)}}});if(!k.image)k.image=T5.Images.get(h.imageUrl,function(d){COG.Log.info("updating marker image to: "+d.src);k.image=d});if(!k.animatingImage)k.animatingImage=T5.Images.get(h.animatingImageUrl,function(d){k.animatingImage=d});return k};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(h){function n(){e.changed();e.trigger("markerUpdate",d)}function k(){var m=e.getParent();if(m&&m.syncVectors)for(var b=d.length;b--;)m.syncVectors([d[b].xy])}h=T5.ex({zindex:100},h);var d=[],a=false,e=T5.ex(new T5.ViewLayer(h),{cycle:function(){return a},draw:function(m,b,o,f){a=false;for(var l=d.length;l--;){d[l].draw(m,b,o,e,f);a=a||d[l].isAnimating()}return a?1:0},add:function(m){if(m&&typeof m.length!=="undefined")for(var b=m.length;b--;){if(m[b])d[d.length]=m[b]}else if(m)d[d.length]=
m;n()},clear:function(m){if(m)for(var b=0;b<d.length;b++)m(d[b])&&d.splice(b,1);else d=[];n()},find:function(m){for(var b=[],o=d.length;o--;)if(!m||m(d[o]))b[b.length]=d[o];return b}});e.bind("tap",function(m,b,o){for(var f=[],l=o.x,g=o.y,q=d.length;q--;)if(d[q].hitTest(l,g))f[f.length]=d[q];if(f.length>0)m.cancel=e.trigger("markerTap",b,o,f).cancel});e.bind("gridUpdate",function(m,b){for(var o=d.length;o--;)b.syncVectors([d[o].xy])});e.bind("parentChange",k);e.bind("changed",k);return e};
T5.ImageLayer=function(h,n){function k(l){e.run(l,function(g){m=g;(g=f.getParent())&&g.trigger("invalidate")});o=T5.XYRect.copy(l)}function d(){var l=f.getParent();l&&l.trigger("invalidate")}function a(){k(b)}n=T5.ex({},n);var e=T5.Generator.init(h,n),m=null,b=T5.XYRect.init(),o=T5.XYRect.init(),f=T5.ex(new T5.ViewLayer(n),{cycle:function(l,g){(Math.abs(g.x1-o.x1)>g.width||Math.abs(g.y1-o.y1)>g.height)&&k(g)},draw:function(l,g){l.save();try{l.strokeStyle="#555";if(m)for(var q=m.length;q--;){var v=
l,u=m[q],y=T5.Images.get(u.url,d);if(y)v.drawImage(y,u.x,u.y,y.width,y.height);else{v.fillStyle="#777";v.fillRect(u.x,u.y,u.width,u.height)}}}finally{l.restore()}l.strokeStyle="#f00";l.beginPath();l.moveTo(g.x1+g.width/2,g.y1);l.lineTo(g.x1+g.width/2,g.y2);l.moveTo(g.x1,g.y1+g.height/2);l.lineTo(g.x2,g.y1+g.height/2);l.stroke();b=T5.XYRect.copy(g)}});f.bind("parentChange",function(l,g){e.bindToView(g);g.bind("idle",a)});return f};
T5.Style=function(h){function n(e){var m=h[e];typeof m!=="undefined"&&k.push(function(b){b[e]=m})}h=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},h);var k=[],d={applyToContext:function(e){for(var m=k.length;m--;)k[m](e)}};for(var a in h)n(a);return d};
(function(){var h={},n={basic:new T5.Style({lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),waypoints:new T5.Style({lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"})};T5.applyStyle=function(k,d){var a=T5.styles[d]?T5.styles[d]:T5.styles.basic,e;if(k&&k.canvas){e=h[k.canvas.id];h[k.canvas.id]=d}a.applyToContext(k);return e};T5.loadStyles=function(k){COG.jsonp(k,function(d){T5.resetStyles(d)})};T5.resetStyles=function(k){var d={};for(var a in k)d[a]=new T5.Style(k[a]);T5.styles=T5.ex({},
n,d)};T5.styles=n})();(function(){T5.tileSize=256;T5.Tile=function(h){return h=T5.ex({x:0,y:0,gridX:0,gridY:0,dirty:true},h)};T5.EmptyTile=function(h){h=new T5.Tile(h);h.empty=true;return h};T5.ImageTile=function(h){h=T5.ex({url:"",sessionParamRegex:null,loading:false,loaded:false},h);return new T5.Tile(h)}})();T5.TileGenerator=function(){};
T5.Geo=function(){function h(s,p){var r=null;for(var x in U)if(p){if(x==p&&U[x][s]){r=U[x];break}}else if(U[x][s]){r=U[x];break}return r}function n(s,p){var r=g*Math.sin(s);return a-2*Math.atan(p*Math.pow((1-r)/(1+r),g/2))}function k(s,p,r,x){var E=0;s=s.toUpperCase();for(var F in x){var K=p[F];if(K){var J=r[F];K=J?J(s,K):COG.wordExists(s,K)?1:0;E+=K*x[F]}}return E}var d=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],a=Math.PI/2,e=Math.PI*2,m=-a,b=a,o=
-e,f=Math.PI/180,l=180/Math.PI,g=0.08181919084262157,q=null,v={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},u={VECTORIZE_PER_CYCLE:500},y={getEngine:function(s){for(var p=null,r=1;!p&&r<arguments.length;r++)p=h(s,arguments[r]);p=p?p:h(s);if(!p)throw Error("Unable to find GEO engine with "+s+" capability");return p},rankGeocodeResponses:function(s,p,r){var x=[],E=O.AddressCompareFns;if(r&&r.compareFns)E=T5.ex({},E,r.compareFns);for(r=0;r<p.length;r++)x.push(new O.GeoSearchResult({caption:G.toString(p[r]),
data:p[r],pos:p[r].pos,matchWeight:k(s,p[r],E,O.GeocodeFieldWeights)}));x.sort(function(F,K){return K.matchWeight-F.matchWeight});return x},distanceToString:function(s){if(s>1E3)return~~(s/10)/100+" km";return s?s+" m":""},dist2rad:function(s){return s/6371},lat2pix:function(s){s=parseFloat(s)*f;s=Math.sin(s);var p=g*s;return Math.log((1+s)/(1-s)*Math.pow((1-p)/(1+p),g))/2},lon2pix:function(s){return parseFloat(s)*f},pix2lon:function(s){return O.normalizeLon(s)*l},pix2lat:function(s){s=Math.pow(Math.E,
-s);for(var p=a-2*Math.atan(s),r=n(p,s),x=0;x<12&&Math.abs(p-r)>1.0E-7;){p=r;r=n(p,s);x++}return r*l},normalizeLon:function(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s},radsPerPixel:function(s){return 2*Math.PI/(256<<s)}},t=function(s,p){return{lat:parseFloat(s?s:0),lon:parseFloat(p?p:0)}},w=function(s,p){return{min:z.parse(s),max:z.parse(p)}},B=function(s){return s=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},s)},z=function(){var s={calcDistance:function(p,
r){if(s.empty(p)||s.empty(r))return 0;var x=(r.lat-p.lat)*f/2,E=(r.lon-p.lon)*f/2;x=Math.sin(x)*Math.sin(x)+Math.cos(p.lat*f)*Math.cos(r.lat*f)*Math.sin(E)*Math.sin(E);return 6371*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x))},copy:function(p){return p?new t(p.lat,p.lon):null},empty:function(p){return!p||p.lat===0&&p.lon===0},equal:function(p,r){return p&&r&&p.lat==r.lat&&p.lon==r.lon},inArray:function(p,r){for(var x=z.equal,E=r.length;E--;)if(x(p,r[E]))return true;return false},inBounds:function(p,r){var x=
!(z.empty(p)||z.empty(r));return x=(x=x&&p.lat>=r.min.lat&&p.lat<=r.max.lat)&&p.lon>=r.min.lon&&p.lon<=r.max.lon},offset:function(p,r,x){var E=p.lat*f;r=E+r/6371;for(p=p.lon*f+Math.asin(Math.sin(x/6371)/Math.cos(E));r<m;)r+=Math.PI;for(;r>b;)r-=Math.PI;for(;p>e;)p-=2*Math.PI;return new t(r*l,p*l)},parse:function(p){if(p)if(typeof p.lat!=="undefined")return s.copy(p);else{if(p.split)for(var r=[" ",","],x=0;x<r.length;x++){var E=p.split(r[x]);if(E.length===2)return new t(E[0],E[1])}}else return new t;
return null},parseArray:function(p){var r=p.length,x=Array(r);for(r=r;r--;)x[r]=s.parse(p[r]);return x},fromMercatorPixels:function(p,r){return new t(T5.Geo.pix2lat(r),T5.Geo.normalizeLon(T5.Geo.pix2lon(p)))},toMercatorPixels:function(p){return T5.XY.init(T5.Geo.lon2pix(p.lon),T5.Geo.lat2pix(p.lat))},generalize:function(p,r,x){var E=p.length,F=[],K=null;x||(x=250);x/=1E3;COG.Log.info("generalizing positions, must include "+r.length+" positions");for(var J=E;J--;)if(J===0)F.unshift(p[J]);else{var X=
!K||z.inArray(p[J],r)?x:z.calcDistance(K,p[J]);if(p[J]&&X>=x){F.unshift(p[J]);K=p[J]}}COG.Log.info("generalized "+E+" positions into "+F.length+" positions");return F},vectorize:function(p,r){var x=p.length,E=Array(x);r=T5.ex({chunkSize:u.VECTORIZE_PER_CYCLE,async:true},r);if(!r.async){for(var F=x;F--;)E[F]=T5.GeoXY.init(p[F]);return E}return COG.Loopage.join({frequency:10,execute:function(K,J){for(var X=0,T=r.chunkSize,$=x;$--;){E[$]=T5.GeoXY.init(p[$]);X+=1;if(X>T)break}x=$;x<=0&&J.trigger("complete",
E)}})},toString:function(p){return p?p.lat+" "+p.lon:""}};return s}(),N=function(){var s={calcSize:function(p,r,x){var E=T5.XY.init(0,r.lat-p.lat);if(typeof x==="undefined")x=true;E.x=x&&p.lon>r.lon?360-p.lon+r.lon:r.lon-p.lon;return E},createBoundsFromCenter:function(p,r){var x=r/6371,E=p.lat*f,F=p.lon*f,K=E-x,J=E+x;if(K>m&&J<b){E=Math.asin(Math.sin(x)/Math.cos(E));x=F-E;if(x<o)x+=2*Math.PI;F=F+E;if(F>e)F-=2*Math.PI}else{K=Math.max(K,m);J=Math.min(J,b);x=o;F=e}return new w(new t(K*l,x*l),new t(J*
l,F*l))},expand:function(p,r){return new w(new t(p.min.lat-r,p.min.lon-O.normalizeLon(r)),new t(p.max.lat+r,p.max.lon+O.normalizeLon(r)))},forPositions:function(p,r){var x=null,E=T5.ticks();r||(r="auto");for(var F=p.length;F--;)if(x){var K=s.calcSize(x.min,p[F],false),J=s.calcSize(p[F],x.max,false);if(K.x<0)x.min.lon=p[F].lon;if(K.y<0)x.min.lat=p[F].lat;if(J.x<0)x.max.lon=p[F].lon;if(J.y<0)x.max.lat=p[F].lat}else x=new T5.Geo.BoundingBox(p[F],p[F]);if(r){if(r=="auto"){F=s.calcSize(x.min,x.max);r=
Math.max(F.x,F.y)*0.3}x=s.expand(x,r)}COG.Log.trace("calculated bounds for "+p.length+" positions",E);return x},getCenter:function(p){var r=N.calcSize(p.min,p.max);return new T5.Geo.Position(p.min.lat+r.y/2,p.min.lon+r.x/2)},getGeoHash:function(p){var r=T5.Geo.GeoHash.encode(p.min.lat,p.min.lon);p=T5.Geo.GeoHash.encode(p.max.lat,p.max.lon);COG.Log.info("min hash = "+r+", max hash = "+p)},getZoomLevel:function(p,r){var x=s.getCenter(p),E=d[Math.min(Math.round(Math.abs(x.lat)*0.05),d.length)],F=s.calcSize(p.min,
p.max);x=Math.ceil(Math.log(d[3]*r.height/F.y)/Math.log(2));E=Math.ceil(Math.log(E*r.width/F.x)/Math.log(2));return Math.min(isNaN(x)?1E3:x,isNaN(E)?1E3:E)},isEmpty:function(p){return!p||z.empty(p.min)||z.empty(p.max)},toString:function(p){return"min: "+z.toString(p.min)+", max: "+z.toString(p.max)}};return s}(),G=function(){var s=/^(\d+).*$/,p=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(r,x){s.lastIndex=-1;if(s.test(r))for(var E=r.replace(s,"$1"),F=x.split(","),K=0;K<F.length;K++){p.lastIndex=
-1;if(p.test(F[K])){var J=p.exec(F[K]);if(E>=parseInt(J[1],10)&&E<=parseInt(J[2],10))return true}else if(E==F[K])return true}return false},normalize:function(r){if(!r)return"";r=r.toUpperCase();if(!q){var x=[];for(var E in v)x.push(E);q=RegExp("(\\s)("+x.join("|")+")(\\s|$)","i")}q.lastIndex=-1;if(x=q.exec(r))r=r.replace(q,"$1"+v[x[2]]);return r},toString:function(r){return r.streetDetails+" "+r.location}}}(),U={},O={P:z,B:N,A:G,Radius:function(s,p){return{distance:parseInt(s,10),uom:p}},Position:t,
BoundingBox:w,Address:B,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(s){if(!s.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var p=T5.ex({remove:function(){delete U[p.id]}},s);return U[p.id]=p},GeoSearchResult:function(s){s=T5.ex({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},s);return T5.ex(s,{toString:function(){return s.caption+(s.matchWeight?" ("+s.matchWeight+")":"")}})},GeoSearchAgent:function(s){return new T5.Dispatcher.Agent(s)},
GeocodingAgent:function(s){s=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(p,r){try{if(!p.reverse&&!p.freeform)address=new B(p);var x=O.getEngine("geocode");if(x)x.geocode({addresses:[p.freeform?p.freeform:address],complete:function(F,K){if(r){var J=K;if(p.freeform)J=O.rankGeocodeResponses(p.freeform,J,O.getEngine("geocode"));r(J,s)}}})}catch(E){COG.Log.exception(E)}}},s);return new O.GeoSearchAgent(s)}};T5.GeoXY=function(){function s(p,r){if(p.mercXY){var x=p.mercXY;
p.x=x.x/r>>0;p.y=(Math.PI-x.y)/r>>0;p.radsPerPixel=r}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");return p}return{init:function(p,r){var x=T5.XY.init();x.pos=p;x.mercXY=z.toMercatorPixels(p);r&&s(x,r);return x},sync:s,toPos:function(p,r){r=r?r:self.radsPerPixel;return z.fromMercatorPixels(p.x*r,Math.PI-p.y*r)}}}();O.GeoVector=function(s){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return T5.GeoXY.init(s)};return T5.ex(O,u,
y)}();
T5.Geo.GeoHash=function(){function h(n,k,d){if(k&d)n[0]=(n[0]+n[1])/2;else n[1]=(n[0]+n[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=NEIGHBORS.right.even;
NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(n){var k=1,d=[],a=[];d[0]=-90;d[1]=90;a[0]=-180;a[1]=180;lat_err=90;lon_err=180;for(i=0;i<n.length;i++){c=n[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(k){lon_err/=2;h(a,cd,mask)}else{lat_err/=2;h(d,cd,mask)}k=!k}}d[2]=(d[0]+d[1])/2;a[2]=(a[0]+
a[1])/2;return{latitude:d,longitude:a}},encode:function(n,k,d){var a=1,e=[],m=[],b=0,o=0;d=d?d:12;geohash="";e[0]=-90;e[1]=90;m[0]=-180;for(m[1]=180;geohash.length<d;){if(a){mid=(m[0]+m[1])/2;if(k>mid){o|=BITS[b];m[0]=mid}else m[1]=mid}else{mid=(e[0]+e[1])/2;if(n>mid){o|=BITS[b];e[0]=mid}else e[1]=mid}a=!a;if(b<4)b++;else{geohash+=BASE32[o];o=b=0}}return geohash}}}();
T5.Geo.JSON=function(){function h(l,g,q,v){g=k(g);l.add(v.line(g,q));return g.length}function n(l,g,q,v){g=k(g);l.add(v.poly(g,q));return g.length}function k(l){var g=l?l.length:0,q=Array(g);for(g=g;g--;)q[g]=new T5.Geo.Position(l[g][1],l[g][0]);return T5.Geo.P.vectorize(q,m)}function d(l,g,q){return new f(l,g,q)}var a="featurecollection",e="feature",m={async:false},b={processor:null,group:"shapes",layerClass:T5.ShapeLayer},o={point:T5.ex({},b,{processor:function(l,g,q,v){g=k([g.coordinates],m);if(g.length>
0)if(q=v.marker(g[0],q)){l.add(q);return g.length}},group:"markers",layerClass:T5.MarkerLayer}),linestring:T5.ex({},b,{processor:function(l,g,q,v){g=k(g&&g.coordinates?g.coordinates:[]);return h(l,g,q,v)}}),multilinestring:T5.ex({},b,{processor:function(l,g,q,v){g=g&&g.coordinates?g.coordinates:[];for(var u=0,y=g.length;y--;)u+=h(l,g[y],q,v);return u}}),polygon:T5.ex({},b,{processor:function(l,g,q,v){g=g&&g.coordinates?g.coordinates:[];if(g.length>0)return n(l,g[0],q,v);return 0}}),multipolygon:T5.ex({},
b,{processor:function(l,g,q,v){g=g&&g.coordinates?g.coordinates:[];for(var u=0,y=0;y<g.length;y++)u+=n(l,g[y][0],q,v);return u}})},f=function(l,g,q,v){function u(p,r){var x=p.processor,E=B+p.group,F=T5.ex({},p,q,{properties:r.properties});if(x){var K=O[E];if(!K){K=new p.layerClass({id:E});O[E]=K}globalLayers=O;return x(K,r.data,F,v)}return 0}function y(p,r){var x=p&&p.type?p.type.toLowerCase():null;return x&&x===e?y(p.geometry,p.properties):{type:x,isCollection:x?x===a:false,definition:o[x],data:p,
properties:r?r:p.properties}}q=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},q);v=T5.ex({marker:function(p){return new T5.Marker({xy:p})},line:function(p,r){return new T5.Poly(p,r)},poly:function(p,r){return new T5.Poly(p,T5.ex({fill:true},r))}},v);var t=q.vectorsPerCycle,w=q.rowPreParse,B=q.layerPrefix,z=0,N=0,G=null,U=0,O={},s;if(!l)return null;if(typeof l.length==="undefined")l=[l];N=l.length;s=COG.Loopage.join({frequency:10,execute:function(p,
r){var x=0,E=z;if(!G){for(;E<N;E++){var F=y(w?w(l[E]):l[E]),K=null;if(F.isCollection){U+=1;G=d(F.data.features,function(J){G=null;for(var X in J)O[X]=J[X]},{layerPrefix:B+U+"-"});K+=1}else if(F.definition)K=u(F.definition,F);x+=K?K:1;if(x>=t)break}z=E+1;!G&&z>=N&&r.trigger("complete")}}});s.bind("complete",function(){g&&g(O)});return s};return{parse:d}}();
T5.Geo.LocationSearch=function(h){function n(m,b){navigator.geolocation.clearWatch(d);d=0;if(a){clearTimeout(a);a=0}b&&b([m],h)}function k(m){COG.Log.info("caught location tracking error:",m)}h=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},h);var d=0,a=0,e=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(m,b){if(navigator.geolocation&&!d){d=navigator.geolocation.watchPosition(function(o){var f=new T5.Geo.Position(o.coords.latitude,o.coords.longitude);
o=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:f,accuracy:o.coords.accuracy/1E3,matchWeight:100});if(!e||o.accuracy<e.accuracy)e=o;if(!h.requiredAccuracy||e.accuracy<h.requiredAccuracy)n(e,b)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(h.searchTimeout)a=setTimeout(function(){e&&n(e,b)},h.searchTimeout)}}},h))};T5.Geo.ImageTileGrid=function(h){T5.ex({},h)};
T5.Map=function(h){function n(y){try{var t=new T5.Geo.Position(y.coords.latitude,y.coords.longitude),w=y.coords.accuracy/1E3;u.trigger("locationUpdate",y,w);if(g){if(!f){f=new T5.Geo.UI.LocationOverlay({pos:t,accuracy:w});f.update(u.getTileLayer());u.setLayer("location",f)}var B=T5.Geo.B.createBoundsFromCenter(t,Math.max(w,1));u.gotoBounds(B)}else{f.pos=t;f.accuracy=w;f.update(u.getTileLayer());a(t,null,T5.easing("sine.out"))}g=false}catch(z){COG.Log.exception(z)}}function k(y){COG.Log.info("caught location tracking error:",
y)}function d(y,t,w){COG.Log.info("position updated to: ",y);v=t;T5.Images.cancelLoad();T5.cancelAnimation();q=T5.Geo.radsPerPixel(v);u.trigger("zoomLevelChange",v);a(y,w)}function a(y,t,w,B){y=T5.GeoXY.init(y,T5.Geo.radsPerPixel(v));u.getDimensions();u.updateOffset(y.x,y.y,w,B,t);u.trigger("wake");u.trigger("boundsChange",u.getBoundingBox());t&&typeof w==="undefined"&&t(u)}h=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,zoomAnimation:T5.easing("quad.out")},
h);var e={NONE:0,SINGLE:1,WATCH:2},m=T5.XY.init(),b=e.NONE,o=false,f=null,l=0,g=true,q=0,v=h.zoomLevel;if(!h.provider)h.provider=new T5.Geo.MapProvider;h.adjustScaleFactor=function(y){return Math.pow(2,(y<1?Math.floor:Math.ceil)(Math.log(y)))};var u=T5.ex(new T5.View(h),{annotations:null,getBoundingBox:function(){var y=u.getOffsetRect();return new T5.Geo.BoundingBox(T5.GeoXY.toPos(T5.XY.init(y.x1,y.y2),q),T5.GeoXY.toPos(T5.XY.init(y.x2,y.y1),q))},getCenterPosition:function(){return T5.GeoXY.toPos(u.getOffset(),
q)},gotoBounds:function(y,t){var w=T5.Geo.B.getZoomLevel(y,u.getDimensions());d(T5.Geo.B.getCenter(y),w,t)},gotoPosition:d,panToPosition:a,locate:function(){u.trackStart(e.SINGLE);setTimeout(u.trackCancel,1E4)},trackStart:function(y){if(navigator.geolocation&&!l){b=y?y:e.WATCH;g=true;l=navigator.geolocation.watchPosition(n,k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){l&&navigator.geolocation&&navigator.geolocation.clearWatch(l);u.removeLayer("location");f=null;
b=e.NONE;l=0},syncVectors:function(y){for(var t,w,B,z,N=y.length;N--;){var G=y[N];if(G&&G.setRadsPerPixel){G.setRadsPerPixel(q);t=typeof t==="undefined"||G.x<t?G.x:t;w=typeof w==="undefined"||G.y<w?G.y:w;B=typeof B==="undefined"||G.x>B?G.x:B;z=typeof z==="undefined"||G.y>z?G.y:z}}return T5.XYRect.init(t,w,z,z)},getZoomLevel:function(){return v},setZoomLevel:function(y){try{d(u.getCenterPosition(),y)}catch(t){COG.Log.exception(t)}},zoomIn:function(){T5.Geo.radsPerPixel(v);T5.Geo.radsPerPixel(v+1);
u.scale(2,T5.easing("sine.out"))||u.setZoomLevel(v+1)},zoomOut:function(){T5.Geo.radsPerPixel(v);T5.Geo.radsPerPixel(v-1);u.scale(0.5,T5.easing("sine.out"))||u.setZoomLevel(v-1)},animateRoute:function(y,t,w,B){var z=u.getLayer("route");if(z)(y=z.getAnimation(y,t,w,B))&&y.addToView(u)}});u.bind("pan",function(){b===e.SINGLE&&u.trackCancel()});u.bind("tap",function(){u.getTileLayer()});u.bind("doubleTap",function(y,t,w){u.scalable()&&u.animate(2,T5.D.getCenter(u.getDimensions()),T5.XY.init(w.x,w.y),
h.zoomAnimation)});u.bind("scale",function(y,t,w){y=0;t=Math.sqrt(t);if(t<1)y=-(0.5/t);else if(t>1)y=t;d(T5.GeoXY.toPos(w,q),v+y>>0)});h.crosshair&&u.setLayer("crosshair",new CrosshairOverlay);u.bind("idle",function(){if(T5.XY.absSize(T5.XY.diff(m,u.getOffset()))>h.boundsChangeThreshold){m=T5.XY.copy(u.getOffset());u.trigger("boundsChange",u.getBoundingBox())}});COG.configurable(u,["provider"],COG.paramTweaker(h,null,{provider:function(){u.cleanup();o=false}}),true);return u};
T5.Geo.MapProvider=function(){var h=1,n=20;return{zoomLevel:0,checkZoomLevel:function(k){return Math.min(Math.max(k,h),n)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:h,max:n}},prepTileGridArgs:function(k,d,a,e,m){var b=null;if(m.tileBackgroundColor){b=T5.Images.newCanvas(a,a);var o=b.getContext("2d");o.fillStyle=m.tileBackgroundColor;o.fillRect(0,0,a,a)}return T5.ex({tileSize:a,width:k,height:d,center:e,tileDrawArgs:{background:b}},
m)},setZoomRange:function(k,d){h=k;n=d}}};
T5.MapTileGenerator=function(h){function n(u,y){for(var t=~~((u.x1-b.x)/f),w=~~((u.y1-b.y)/l),B=[],z=-g;z<g;z++)for(var N=-q;N<q;N++)B[B.length]=tileCreator(t+z,w+N);y&&y(B);m=T5.XYRect.copy(u)}function k(u,y){d=y;a=null}h=T5.ex({tileWidth:256,tileHeight:256},h);var d=0,a=null,e=null,m=null,b=T5.XY.init(),o=false,f=h.tileWidth,l=h.tileHeight,g=0,q=0,v={bindToView:function(u){COG.Log.info("initializing generator");e=u;if(u.getZoomLevel){d=u.getZoomLevel();u.bind("zoomLevelChange",k)}},initTileCreator:null,
run:function(u,y){var t=!m||Math.abs(u.x1-m.x1)>f||Math.abs(u.y1-m.y1)>l;if(!a&&!o){COG.Log.info("generating tiles, view rect = ",u);a=e.getCenterPosition();b=T5.XY.init(u.x1,u.y1);g=Math.ceil(u.width/f)+1;q=Math.ceil(u.height/l)+1;if(v.initTileCreator){o=true;v.initTileCreator(a,d,l,f,function(w){tileCreator=w;o=false;n(u,y)})}COG.Log.info("generator got view center: ",a)}tileCreator&&t&&n(u,y)}};COG.observable(v);return v};
T5.Geo.Routing=function(){var h={calculate:function(n){n=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},n);var k=T5.Geo.getEngine("route");k&&k.route(n,function(d){if(n.generalize)d.geometry=T5.Geo.P.generalize(d.geometry,d.getInstructionPositions());if(n.map){h.createMapOverlay(n.map,d);n.autoFit&&n.map.gotoBounds(d.boundingBox)}n.success&&n.success(d)})},createMapOverlay:function(n,k){var d=n.getDimensions();d=new T5.Geo.UI.RouteOverlay({data:k,width:d.width,
height:d.height});n.setLayer("route",d)},parseTurnType:function(n){for(var k=h.TurnType.Unknown,d=T5.Geo.Routing.TurnTypeRules,a=0;a<d.length;a++){d[a].regex.lastIndex=-1;var e=d[a].regex.exec(n);if(e){k=d[a].customCheck?d[a].customCheck(n,e):d[a].turnType;break}}return k},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(n){var k=n=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},n),d=n.description;d=d.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");k.description=d;if(!n.turnType)n.turnType=h.parseTurnType(n.description);return n},RouteData:function(n){n=T5.ex({geometry:[],instructions:[],boundingBox:null},
n);if(!n.boundingBox)n.boundingBox=T5.Geo.B.forPositions(n.geometry);return T5.ex({getInstructionPositions:function(){for(var k=[],d=0;d<n.instructions.length;d++)n.instructions[d].position&&k.push(n.instructions[d].position);return k}},n)}};return h}();T5.Geo.Search=function(){return{bestResults:function(h,n){n||(n=20);for(var k=h.length>0?h[0]:null,d=[],a=0;a<h.length;a++)if(k&&h[a]&&k.matchWeight-h[a].matchWeight<=n)d.push(h[a]);else break;return d}}}();
T5.Geo.UI=function(){var h={AnnotationTween:null,GeoTileGrid:function(n){n=T5.ex({grid:null,centerPos:new T5.Geo.Position,centerXY:T5.XY.init(),radsPerPixel:0},n);var k=n.radsPerPixel,d=T5.Geo.P.toMercatorPixels(n.centerPos),a=d.x/k-n.centerXY.x>>0,e=d.y/k-n.centerXY.y>>0,m=null,b=T5.ex({},n.grid,{getGridXYForPosition:function(o){o=T5.GeoXY.init(o);b.syncVectors([o]);return o},syncVectors:function(o){for(var f,l,g,q,v=o.length;v--;){var u=o[v];if(u&&u.setRadsPerPixel){u.setRadsPerPixel(k,-a,-m);f=
typeof f==="undefined"||u.x<f?u.x:f;l=typeof l==="undefined"||u.y<l?u.y:l;g=typeof g==="undefined"||u.x>g?u.x:g;q=typeof q==="undefined"||u.y>q?u.y:q}}return T5.XYRect.init(f,l,q,q)},getPixelDistance:function(o){return T5.Geo.dist2rad(o)/k>>0},pixelsToPos:function(o){return T5.Geo.P.fromMercatorPixels((a+o.x)*k,(e+b.gridDimensions.height-o.y)*k)}});m=e+b.gridDimensions.height;return b},RouteOverlay:function(n){n=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",
waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},n);var k=[],d=[],a=new T5.PathLayer(n);(function(){if(n.data&&n.data.instructions){for(var e=n.data.instructions,m=Array(e.length),b=e.length;b--;)m[b]=e[b].position;T5.Geo.P.vectorize(m).bind("complete",function(o,f){d=f})}n.data&&n.data.geometry&&T5.Geo.P.vectorize(n.data.geometry).bind("complete",function(o,f){k=f;a.updateCoordinates(k,d,true)})})();return a},Poly:function(n,k){k=T5.ex({autoParse:true},k);for(var d=Array(n.length),a=k.autoParse,
e=T5.Geo.P.parse,m=n.length;m--;)d[m]=T5.GeoXY.init(a?e(n[m]):n[m]);return new T5.Poly(d,k)},Annotation:function(n){n=T5.ex({pos:null},n);n.xy=T5.GeoXY.init(n.pos);return new T5.ImageAnnotation(n)},LocationOverlay:function(n){n=T5.ex({pos:null,accuracy:null,zindex:90},n);var k=new Image,d=T5.XY.init(),a=T5.XY.init(),e=null;k.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
k.onload=function(){d=T5.XY.init(k.width/2,k.height/2)};var m=T5.ex(new T5.ViewLayer(n),{pos:n.pos,accuracy:n.accuracy,drawAccuracyIndicator:false,draw:function(b,o){var f=a.x-o.x,l=a.y-o.y;if(e){b.fillStyle="rgba(30, 30, 30, 0.2)";b.beginPath();b.arc(f,l,e,0,Math.PI*2,false);b.fill()}k.complete&&k.width>0&&b.drawImage(k,f-d.x,l-d.y,k.width,k.height);m.changed()},update:function(b){if(b){e=Math.floor(b.getPixelDistance(m.accuracy)*0.5);a=b.getGridXYForPosition(m.pos);m.changed()}}});m.bind("gridUpdate",
function(b,o){m.update(o)});return m},AnnotationsOverlay:function(n){function k(b,o){var f=b.length,l=m.getParent();if(o=o?o:l?l.getTileLayer():null)for(f=f;f--;)o.syncVectors([b[f].xy]);b.sort(function(g,q){var v=q.xy.y-g.xy.y;if(v===0)v=q.xy.x-g.xy.x;return v})}n=T5.ex({pois:null,map:null,zindex:100},n);var d=[],a=false,e=[],m=T5.ex(new T5.ViewLayer(n),{cycle:function(){return a},draw:function(b,o,f,l,g){a=false;b.fillStyle="rgba(255, 0, 0, 0.75)";b.globalCompositeOperation="source-over";for(f=
d.length;f--;){d[f].draw(b,o,l,m,g);a=a||d[f].isAnimating()}for(f=e.length;f--;){e[f].draw(b,o,l,m,g);a=a||e[f].isAnimating()}return a?1:0},add:function(b){if(b&&b.length)for(var o=b.length;o--;)e[e.length]=b[o];else if(b)e[e.length]=b;k(e);m.changed()},clear:function(b){e=[];k(e);if(b){d=[];k(d)}m.changed()}});COG.listen("geo.pois-updated",function(b){if(n.pois&&n.pois.id==b.srcID){b=b.pois;try{d=[];for(var o=0;o<b.length;o++)if(b[o].pos){var f;var l=b[o];if(l&&l.pos){var g={poi:l,annotation:null};
n.map&&n.map.trigger("getAnnotationForPOI",g);if(!g.annotation)g.annotation=new T5.Annotation({xy:T5.GeoXY.init(l.pos)});if(g.annotation){g.annotation.isNew=l.isNew;l.isNew=false}f=g.annotation}else f=void 0;f&&d.push(f)}k(d)}catch(q){COG.Log.exception(q)}m.changed()}});m.bind("gridUpdate",function(b,o){k(d,o);k(e,o);m.changed()});return m}};h.ImageAnnotation=h.Annotation;return h}();
T5.Geo.Routing.TurnTypeRules=function(){var h=T5.Geo.Routing.TurnType,n=[];n.push({regex:/continue/i,turnType:h.Continue});n.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(k,d){return/bear/i.test(d[1])?h.TurnLeftSlight:h.TurnLeft}});n.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(k,d){return/bear/i.test(d[1])?h.TurnRightSlight:h.TurnRight}});n.push({regex:/enter\s(roundabout|rotaty)/i,turnType:h.EnterRoundabout});n.push({regex:/take.*?ramp/i,turnType:h.Ramp});n.push({regex:/take.*?exit/i,
turnType:h.RampExit});n.push({regex:/make(.*?)u\-turn/i,customCheck:function(k,d){return/right/i.test(d[1])?h.UTurnRight:h.UTurnLeft}});n.push({regex:/proceed/i,turnType:h.Start});n.push({regex:/arrive/i,turnType:h.Arrive});n.push({regex:/fell\sthrough/i,turnType:h.Merge});return n}();
