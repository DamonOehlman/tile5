COG=function(){var l=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,k=0,d={id:"grunt.core",extend:function(){var a=arguments[0]||{},e=1,g=arguments.length,b=false,o,f,n,h;if(typeof a==="boolean"){b=a;a=arguments[1]||{};e=2}if(typeof a!=="object"&&!d.isFunction(a))a={};if(g===e){a=this;--e}for(;e<g;e++)if((o=arguments[e])!=null)for(f in o){n=a[f];h=o[f];if(a!==h)if(b&&h&&(d.isPlainObject(h)||d.isArray(h))){n=n&&(d.isPlainObject(n)||d.isArray(n))?n:d.isArray(h)?[]:{};a[f]=d.extend(b,n,h)}else if(h!==
undefined)a[f]=h}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var e;for(e in a);return e===undefined||m.call(a,e)},isEmptyObject:function(a){for(var e in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,e){var g=a,b=arguments,o=1;if(e&&d.isArray(e)){b=e;o=0}for(o=o;o<b;o++)g=g&&typeof foo[b[o]]!=="undefined";return g},newModule:function(a){a=d.extend({id:null,requires:[],parent:null},a);if(a.parent)a=d.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+k++},formatStr:function(a){if(arguments.length<=1)return a;for(var e=arguments.length-2,g=0;g<=e;g++)a=a.replace(RegExp("\\{"+g+"\\}","gi"),arguments[g+
1]);return a},wordExists:function(a,e){var g="";if(e.toString)e=e.toString();for(var b=0;b<e.length;b++)g+=!/\w/.test(e[b])?"\\"+e[b]:e[b];return RegExp("(^|\\s|\\,)"+g+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,e){for(var g=l.exec(a);g;){a=a.replace(g[0],COG.XPath.first(g[1],e));l.lastIndex=0;g=l.exec(a)}return a}};return d}();
COG.Log=function(){function l(e,g){var b,o=g&&g.length>0?g[0]:"";for(b=1;g&&b<g.length;b++)o+=" "+(k&&COG.isPlainObject(g[b])?JSON.stringify(g[b]):g[b]);typeof console!=="undefined"&&console[e](o);for(b=0;b<m.length;b++)m[b].call(a,o,e)}var m=[],k=typeof JSON!=="undefined",d=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return d?(new Date).getTime():null},trace:function(e,g){if(d)console.markTimeline(e+(g?": "+(a.getTraceTicks()-g)+"ms":""))},debug:function(){l("debug",
arguments)},info:function(){l("info",arguments)},warn:function(){l("warn",arguments)},error:function(){l("error",arguments)},exception:function(e){a.error(arguments);for(var g in e)a.info("ERROR DETAIL: "+g+": "+e[g])},watch:function(e,g){try{g()}catch(b){a.exception(b,e)}},throwError:function(e){a.error(e);throw Error(e);},requestUpdates:function(e){m.push(e)}};return a}();
(function(){function l(d,a){d[a]||(d[a]=function(e){return d.configure(a,e)})}function m(d){d.gtConfId=COG.objId("configurable");d.gtConfig={};d.gtConfigFns=[];return d.gtConfig}var k={};COG.paramTweaker=function(d,a,e){return function(g,b){if(typeof b!=="undefined"){if(g in d)d[g]=b;e&&g in e&&e[g](g,b)}else return a&&g in a?a[g](g):d[g]}};COG.configurable=function(d,a,e,g){if(d){d.gtConfId||m(d);var b=d.gtConfId,o=d.gtConfig,f=d.gtConfigFns;k[b]=d;f.push(e);for(e=a.length;e--;){o[a[e]]=true;g&&
l(d,a[e])}if(!d.configure)d.configure=function(n,h){if(o[n]){for(var q=f.length;q--;){var v=f[q](n,h);if(typeof v!=="undefined")return v}return k[b]}return null}}}})();
(function(){function l(m,k){var d=m.gtObsHandlers;d[k]||(d[k]=[]);return d[k]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(k,d){var a=COG.objId("callback");l(m,k).unshift({fn:d,id:a});return a};m.trigger=function(k){var d=l(m,k),a={cancel:false,tickCount:(new Date).getTime()},e;if(!d)return null;e=Array.prototype.slice.call(arguments,1);e.unshift(a);for(var g=d.length;g--&&!a.cancel;)d[g].fn.apply(self,e);return a};m.unbind=
function(k,d){for(var a=l(m,k),e=0;a&&e<a.length;e++)if(a[e].id===d){a.splice(e,1);break}return m}}}}})();(function(){var l={},m=[];COG.addPipe=function(k){k("pipe.test",{});m.push(k)};COG.listen=function(k,d){l[k]||(l[k]=[]);d&&l[k].push(d)};COG.say=function(k,d){var a;for(a=m.length;a--;)m[a](k,d);if(l[k])for(a=l[k].length;a--;)l[k][a](d)}})();
COG.Loopage=function(){function l(h){return COG.extend({id:e++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},h)}function m(h){b.push(h);k()}function k(){o&&clearTimeout(o);o=setTimeout(d,0);n=true}function d(){for(var h,q=(new Date).getTime(),v=g.length;b.length>0;){var B=b.shift();for(h=v;h--;)if(g[h].id===B){g.splice(h,1);break}n=true;v=g.length}if(n){f=a;for(h=v;h--;)f=g[h].frequency<f?g[h].frequency:f}for(h=v;h--;){B=q-g[h].lastTick;if(g[h].lastTick===0||B>=g[h].frequency){g[h].execute(q,
g[h]);g[h].lastTick=q;g[h].single&&g[h].trigger("complete")}}o=v?setTimeout(d,f):0}var a=6E4,e=0,g=[],b=[],o=0,f=a,n=true;return{join:function(h){var q=new l(h);if(q.after>0)q.lastTick=(new Date).getTime()+q.after;COG.observable(q);q.bind("complete",function(){m(q.id)});g.unshift(q);k();return q},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function l(f){return f<10?"0"+f:f}function m(f){a.lastIndex=0;return a.test(f)?'"'+f.replace(a,function(n){var h=b[n];return typeof h==="string"?h:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function k(f,n){var h,q,v,B,C=e,t,u=n[f];if(u&&typeof u==="object"&&typeof u.toJSON==="function")u=u.toJSON(f);if(typeof o==="function")u=o.call(n,f,u);switch(typeof u){case "string":return m(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";e+=g;t=[];if(Object.prototype.toString.apply(u)==="[object Array]"){B=u.length;for(h=0;h<B;h+=1)t[h]=k(h,u)||"null";v=t.length===0?"[]":e?"[\n"+e+t.join(",\n"+e)+"\n"+C+"]":"["+t.join(",")+"]";e=C;return v}if(o&&typeof o==="object"){B=o.length;for(h=0;h<B;h+=1){q=o[h];if(typeof q==="string")if(v=k(q,u))t.push(m(q)+(e?": ":":")+v)}}else for(q in u)if(Object.hasOwnProperty.call(u,q))if(v=k(q,u))t.push(m(q)+(e?": ":":")+v);v=t.length===0?"{}":e?"{\n"+e+t.join(",\n"+e)+
"\n"+C+"}":"{"+t.join(",")+"}";e=C;return v}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,g,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;if(typeof JSON.stringify!=="function")JSON.stringify=function(f,n,h){var q;g=e="";if(typeof h==="number")for(q=0;q<h;q+=1)g+=" ";else if(typeof h==="string")g=h;if((o=n)&&typeof n!=="function"&&(typeof n!=="object"||typeof n.length!=="number"))throw Error("JSON.stringify");return k("",
{"":f})};if(typeof JSON.parse!=="function")JSON.parse=function(f,n){function h(v,B){var C,t,u=v[B];if(u&&typeof u==="object")for(C in u)if(Object.hasOwnProperty.call(u,C)){t=h(u,C);if(t!==undefined)u[C]=t;else delete u[C]}return n.call(v,B,u)}var q;f=String(f);d.lastIndex=0;if(d.test(f))f=f.replace(d,function(v){return"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(f.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){q=eval("("+f+")");return typeof n==="function"?h({"":q},""):q}throw new SyntaxError("JSON.parse");}})();
(function(){function l(k,d){var a=k.split("|"),e={};for(var g in d){var b=d[g];e[g]=a.length>b?a[b]:null}return e}var m={JSON:{parse:function(k){return JSON.parse(k)}},PDON:{parse:function(k){var d=null,a=[];k=k.split("\n");for(var e=0;e<k.length;e++){var g=k[e];if(d)a.push(l(g,d));else if(g){d=g.split("|");g={};for(var b=0;b<d.length;b++)g[d[b]]=b;d=g}else d=null}return a}}};COG.parseData=function(k,d){d=d?d.toUpperCase():"JSON";if(!m[d])throw Error("Unsupported data format: "+d);try{return m[d].parse(k)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function l(a){for(var e=null,g=0;g<m.length;g++)if(e=m[g](a))break;return e}var m=[],k=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var d={SearchResult:function(a){return{toString:function(){var e=
null;if(a){var g=null;if(a.resultType>=0&&a.resultType<k.length)g=k[a.resultType];if(g)e=g(a)}return e?e:""}}},first:function(a,e){var g=d.SearchResult,b;var o=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!o)o=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(e))b=e.evaluate(a,e,l,o,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(f){COG.Log.warn("invalid xpath expression: "+a+" on node: "+e);b=null}return new g(b)},registerResolver:function(a){m.push(a)}};return d}();
COG.Storage=function(){function l(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,k){var d=l(k).getItem(m);return/^(\{|\[).*(\}|\])$/.test(d)?JSON.parse(d):d},set:function(m,k,d){k=jQuery.isArray(k)||jQuery.isPlainObject(k)?JSON.stringify(k):k;l(d).setItem(m,k)},remove:function(m,k){l(k).removeItem(m)}}}();
COG.ParseRules=function(){var l=[];return{add:function(m,k){l.push({regex:m,handler:k})},each:function(m,k,d){function a(){e++;d&&e>=l.length&&d(k)}for(var e=0,g=0;g<l.length;g++){var b=l[g].regex,o=l[g].handler,f=false;if(b){b.lastIndex=-1;if((b=b.exec(m))&&o){f=true;o(b,k,a)&&a()}}f||a()}}}};
(function(){function l(b){var o=[],f=function(h,q){q=COG.isFunction(q)?q():q;o[o.length]=encodeURIComponent(h)+"="+encodeURIComponent(q)};if(COG.isArray(b))for(var n=0;n<b.length;n++)f(b[n].name,b[n].value);else for(n in b)f(n,b[n]);return o.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},k={JSON:["json"],PDON:["pdon.txt"]},d=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,e={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},g={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function o(){if(this.readyState===4){var q=null,v=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(v)if(b.handleResponse)b.handleResponse(this);else{var B=b,C=this.getResponseHeader(g.CONTENT_TYPE),t,u=false;for(t in m)if(C&&C.indexOf(m[t])>=0){u=true;
break}C=!u;for(u=0;u<d.length;u++)C=C||d[u]==t;if(C)b:{C=t;for(var z in k)for(u=0;u<k[z].length;u++)if(RegExp(k[z][u]+"$","i").test(B.url)){t=z;break b}t=C?C:"DEFAULT"}try{q=e[t](this,B)}catch(x){q=e.DEFAULT(this,B)}}else b.error&&b.error(this)}catch(O){COG.Log.exception(O,"PROCESSING AJAX RESPONSE")}v&&q&&b.success&&b.success.call(this,q)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var f=
a.exec(b.url),n=f&&(f[1]&&f[1]!==location.protocol||f[2]!==location.host);if(b.data)b.method="POST";if(b.url){f=null;if(b.xhr)f=b.xhr(b);f||(f=new XMLHttpRequest);f.open(b.method,b.url,b.async);b.data&&f.setRequestHeader("Content-Type",b.contentType);n||f.setRequestHeader("X-Requested-With","XMLHttpRequest");f.onreadystatechange=o;f.send(b.method=="POST"?l(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(h){COG.Log.exception(h)}}})();
(function(){function l(a){var e=document.createElement("script"),g=false;e.src=a;e.async=true;e.onload=e.onreadystatechange=function(){if(!g&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){g=true;e.onload=e.onreadystatechange=null;e&&e.parentNode&&e.parentNode.removeChild(e)}};k||(k=document.getElementsByTagName("head")[0]);k.appendChild(e)}var m=0,k,d=this;COG.jsonp=function(a,e,g){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++m;d[b]=function(o){e(o);d[b]=null;try{delete d[b]}catch(f){}};
l(a+(g?g:"callback")+"="+b);return b}})();
COG.Touch=function(){function l(s,p){return{x:s.x-p.x,y:s.y-p.y}}function m(s,p){var r=l(s,p);return Math.sqrt(r.x*r.x+r.y*r.y)}function k(s){if(s.count>1)return m(s.touches[0],s.touches[1]);return 0}function d(s,p){var r=s&&s.count>0?s.touches[0]:null;if(r&&p&&p.count>0)return l(r,p.touches[0]);return null}function a(s,p){s.count=p.count;for(var r=f;r--;){s.touches[r].x=p.touches[r].x;s.touches[r].y=p.touches[r].y}}function e(){for(var s={count:0,touches:Array(f)},p=f;p--;)s.touches[p]=o();return s}
function g(s){if(s.preventDefault){s.preventDefault();s.stopPropagation()}else s.cancelBubble&&s.cancelBubble()}function b(s,p,r){if(I){p=p[r?r:"touches"];r=p.length;for(r=s.count=r;r--;){s.touches[r].x=p[r].pageX;s.touches[r].y=p[r].pageY}}else if(p.button===0){s.count=1;s.touches[0].x=p.pageX?p.pageX:p.screenX;s.touches[0].y=p.pageY?p.pageY:p.screenY}else s.count=0}function o(s,p){return{x:s?s:0,y:p?p:0}}var f=10,n=120,h=100,q=250,v=300,B=5,C=0,t=1,u=2,z=7,x=0,O=0,I=undefined,V=function(s){function p(E,
J,G,y){var D=Math.asin((E.y-J.y)/G);G=G*(ta/y)>>0;G=G>oa?oa:G;D=J.x>E.x?D:Math.PI-D;F("pan",Math.cos(D)*-G,Math.sin(D)*G,true)}function r(E,J){var G,y;if(I){G=J-ia;if(G<q){y=m(T.touches[0],E);y>s.inertiaTrigger&&p(T.touches[0],E,y,G)}}else{W.x=E.x;W.y=E.y;COG.Loopage.join({execute:function(D,K){G=D-J;y=m(E,W);if(G<h&&y>s.inertiaTrigger){K.trigger("complete");p(E,W,y,G)}else G>h&&K.trigger("complete")},frequency:10})}}function w(E){var J=0,G=0;if(E.offsetParent){do{J+=E.offsetLeft;G+=E.offsetTop;E=
E.offsetParent}while(E)}return o(J,G)}function A(E){var J=E.count,G=Array(J),y=w(Y);for(J=J;J--;)G[J]=o(E.touches[J].x-y.x,E.touches[J].y-y.y);return G}function F(){ra&&ra.trigger.apply(null,arguments)}function H(E,J){var G=w(Y);G=o(J.x-G.x,J.y-G.y);F(E,J,G)}function L(E){var J=E.target?E.target:E.srcElement;if(Z||J&&J===Y){b(T,E);if(T.count!==0){da=null;ea.x=0;ea.y=0;la=true;fa=false;ia=(new Date).getTime();g(E);J.style.cursor="move";F("inertiaCancel");ma=ia;if(E=T.count>0?T.touches[0]:null){F("touchStart",
E.x,E.y);if(ma-na<v)if((E=l(T.touches[0],aa.touches[0]))&&Math.abs(E.x)<s.maxDistDoubleTap&&Math.abs(E.y)<s.maxDistDoubleTap)fa=true;M=C;a(aa,T)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function Q(E){var J=E.target?E.target:E.srcElement,G=0;if(Z||J&&J===Y){b(X,E);if(X.count>0){W.x=X.touches[0].x;W.y=X.touches[0].y}if(la){I&&g(E);if(X.count>1){T.count===1&&a(T,X);G=k(T)-k(X)}if(M===C)if((E=d(X,T))&&(Math.abs(E.x)>=z||Math.abs(E.y)>=z))M=t;if(M!==C)if(!G||Math.abs(G)<B){if(da=
d(X,aa)){ea.x-=da.x;ea.y-=da.y;ga.x-=da.x;ga.y-=da.y}F("pan",ga.x,ga.y);ga.x=0;ga.y=0;M=t}else{F("pinchZoom",A(T),A(X));M=u}a(aa,X)}}}function ja(E){var J=E.target?E.target:E.srcElement;if(la&&(Z||J&&J===Y)){b(pa,E,"changedTouches");var G=pa.touches[0];I&&g(E);E=(new Date).getTime();na=ma;if(M===C){H("tap",T.touches[0]);qa||(qa=setTimeout(function(){qa=0;fa&&H("doubleTap",T.touches[0])},v+50))}else if(M==t){F("panEnd",ea.x,ea.y);sa&&r(G,E)}else M==u&&F("pinchZoomEnd",A(T),A(aa),E-ia);J.style.cursor=
"default";la=false}}function U(E){var J=E.target?E.target:E.srcElement;if(Z||J&&J===Y){if(E.detail){J=-E.detail*n;J=o(E.axis===1?J:0,E.axis===2?J:0)}else J=o(E.wheelDeltaX,E.wheelDeltaY);var G=J.y!==0?Math.abs(J.y/n):0;if(W&&G!==0){var y=o(W.x-Y.offsetLeft,W.y-Y.offsetTop);F("wheelZoom",y,Math.pow(2,J.y>0?G:-G))}g(E)}}s=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,
tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},s);var fa=false,qa=0,ba=T5.getConfig(),T=e(),X=e(),aa=e(),pa=e(),da=null,ea=o(),ga=o(),M=null,la=false,ia=0,ha=[],W=o(),sa=false,ta,oa,ma=0,na=0,Y=s.element,ra=s.observable,Z=typeof FlashCanvas!=="undefined",ua={supportsTouch:I,addListeners:function(E){ha.push(E)},decoupleListeners:function(E){for(var J=0;E&&J<ha.length;J++)if(ha[J].listenerId===E){ha.splice(J,1);break}},release:function(){ba.unbindEvent(I?"touchstart":"mousedown",L,false);
ba.unbindEvent(I?"touchmove":"mousemove",Q,false);ba.unbindEvent(I?"touchend":"mouseup",ja,false);if(!I){window.removeEventListener("mousewheel",U,false);window.removeEventListener("DOMMouseScroll",U,false)}},inertiaEnable:function(E,J){sa=true;ta=E;oa=J?Math.min(J.width,J.height):500},inertiaDisable:function(){sa=false}};if(typeof I==="undefined")I=T5.getConfig().supportsTouch;ba.bindEvent(I?"touchstart":"mousedown",L,false);ba.bindEvent(I?"touchmove":"mousemove",Q,false);ba.bindEvent(I?"touchend":
"mouseup",ja,false);if(!I){ba.bindEvent("mousewheel",U,window);ba.bindEvent("DOMMouseScroll",U,window)}return ua},N=[];return{capture:function(s,p){if(!s)throw Error("Unable to capture touch of null element");if(!s.id)s.id="touchable_"+x++;var r=N[s.id];if(!r){r=new V(COG.extend({element:s},p));N[s.id]=r}if(p){p.listenerId&&r.decoupleListeners(p.listenerId);p.listenerId=++O;r.addListeners(p)}return r},release:function(s){if(s&&s.id&&N[s.id]){N[s.id].release();delete N[s.id]}}}}();
T5=function(){var l=function(){function a(b,o){return g(b.x-o.x,b.y-o.y)}function e(b,o){if(!o)o=b.length;if(o<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var f={edges:Array(o-1),accrued:Array(o-1),total:0},n=0;n<o-1;n++){var h=a(b[n],b[n+1]);f.edges[n]=Math.sqrt(h.x*h.x+h.y*h.y);f.accrued[n]=f.total+f.edges[n];f.total+=f.edges[n]}return f}function g(b,o){return{x:b?b:0,y:o?o:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,o=0,f=arguments.length;f--;){b+=arguments[f].x;o+=arguments[f].y}return g(b,o)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?g(b.x,b.y):null},diff:a,distance:function(b,o){return e(b,o).total},edges:e,equals:function(b,o){return b.x===o.x&&b.y===o.y},extendBy:function(b,o,f){return g(b.x-Math.cos(o)*f,b.y-Math.sin(o)*f)},floor:function(b){for(var o=Array(b.length),f=b.length;f--;)o[f]=g(~~b[f].x,~~b[f].y);return o},getRect:function(b){for(var o,f,n,
h,q=b.length;q--;){var v=b[q];o=typeof o==="undefined"||v.x<o?v.x:o;f=typeof f==="undefined"||v.y<f?v.y:f;n=typeof n==="undefined"||v.x>n?v.x:n;h=typeof h==="undefined"||v.y>h?v.y:h}return k.init(o,f,h,h)},init:g,invert:function(b){return g(-b.x,-b.y)},offset:function(b,o,f){return g(b.x+o,b.y+(f?f:o))},simplify:function(b,o){if(!b)return null;o=o?o:l.VECTOR_SIMPLIFICATION;for(var f=[],n=null,h=b.length;h--;){var q=b[h];if(include=!n||h===0||Math.abs(q.x-n.x)+Math.abs(q.y-n.y)>o){f.unshift(q);n=q}}return f},
theta:function(b,o,f){f=Math.asin((b.y-o.y)/f);return b.x>o.x?f:Math.PI-f}}}(),m=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),k=function(){function a(e,g,b,o){e=e?e:0;g=g?g:0;b=typeof b!=="undefined"?b:e;o=typeof o!=="undefined "?o:o;return{x1:e,y1:g,x2:b,y2:o,width:b-e,height:o-g}}return{center:function(e){return l.init(e.x1+e.width/2,e.y1+e.height/2)},copy:function(e){return a(e.x1,e.y1,e.x2,e.y2)},diagonalSize:function(e){return Math.sqrt(e.width*e.width+e.height*e.height)},
fromCenter:function(e,g,b,o){b=~~(b/2);o=~~(o/2);return a(e-b,g-o,e+b,g+o)},init:a,intersect:function(e,g){var b=a(Math.max(e.x1,g.x1),Math.max(e.y1,g.y1),Math.min(e.x2,g.x2),Math.min(e.y2,g.y2));return b.width>0&&b.height>0?b:null}}}(),d=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return l.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,
height:e?e:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:l,XYRect:k,Vector:function(a,e){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return l.init(a,e)},V:COG.extend(l,m),D:d}}();
(function(){function l(){for(;B.length>0;){var t=B.shift();document.location=t}v=0}function m(t){for(var u=true,z=C.length;z--;)u=u&&t!=C[z];return u}function k(t,u){var z=[];for(var x in u)x&&z.push(x+"="+escape(u[x]));return"tile5://"+t+"/"+(z.length>0?"?"+z.join("&"):"")}function d(t,u){m(t)&&COG.Log.info("would push url: "+k(t,u))}function a(t,u){if(m(t)){B.push(k(t,u));v||(v=setTimeout(l,100))}}function e(t){return function(u,z,x){(x?x:t?document.body:document).addEventListener(u,z,false)}}function g(t){return function(u,
z,x){(x?x:t?document.body:document).removeEventListener(u,z,false)}}function b(t,u,z){(z?z:document).attachEvent("on"+t,u)}function o(t,u,z){(z?z:document).detachEvent("on"+t,u)}function f(){n={base:{name:"Unknown",bindEvent:e(),unbindEvent:g(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:d,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:o,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:e(true),unbindEvent:g(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};h=[n.froyo,n.android,n.ipod,n.iphone,n.ipad,n.ie]}var n=null,h=[],q=null,v=0,B=[],C=["view.wake","tile.loaded"];T5.getConfig=function(){n||f();if(!q){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var t=0;t<h.length;t++){var u=h[t];if(u.regex&&u.regex.test(navigator.userAgent)){q=T5.ex({},n.base,u);COG.Log.info("PLATFORM DETECTED AS: "+q.name);break}}if(!q){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
q=n.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return q}})();
T5.Dispatcher=function(){var l=[],m={execute:function(k){var d=m.findAction(k);d&&d.execute.apply(d,Array.prototype.slice.call(arguments,1))},findAction:function(k){for(var d=l.length;d--;)if(l[d].id==k)return l[d];return null},getRegisteredActions:function(){return[].concat(l)},getRegisteredActionIds:function(){for(var k=[],d=l.length;d--;)l[d].id&&k.push(l[d].id);return k},registerAction:function(k){k&&k.id&&l.push(k)},Action:function(k){k=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},k);var d={id:k.id,execute:function(){k.execute&&k.execute.apply(this,arguments)},getParam:function(a){return k[a]?k[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",d.id,k.title,k.icon)}};k.autoRegister&&m.registerAction(d);return d},Agent:function(k){k=COG.extend({name:"Untitled",translator:null,execute:null},k);var d={getName:function(){return k.name},getParam:function(a){return k[a]},getId:function(){return COG.toID(d.getName())},run:function(a,e){if(k.execute){var g=
k.translator?k.translator(a):a;k.execute.call(d,g,function(b,o){e&&e(b,o,g)})}}};return d},runAgents:function(k,d,a){for(var e=0;e<k.length;e++)k[e].run(d,a)}};return m}();
T5.Resources=function(){var l="",m={},k={getPath:function(d){return/^(file|https?|\/)/.test(d)?d:l+d},setBasePath:function(d){l=d},loadResource:function(d){d=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},d);var a=function(e){d.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){d.callback(e)})};d.cacheable&&m[d.filename]?a(m[d.filename]):COG.xhr({url:k.getPath(d.filename),dataType:d.dataType,success:function(e){if(d.cacheable)m[d.filename]=e;a(e)},error:function(e,g,b){COG.Log.error("error loading resource ["+
d.filename+"], error = "+b)}})},loadSnippet:function(d,a){/\.\w+$/.test(d)||(d+=".html");k.loadResource({filename:"snippets/"+d,callback:a,dataType:"html"})}};return k}();
T5.Images=function(){function l(){if(!v){var t=T5.getConfig().maxImageLoads;v=COG.Loopage.join({execute:function(u,z){if(!t||n.length<t){var x=f.shift();if(x){n[n.length]=x;x.image.onload=k;x.image.src=T5.Resources.getPath(x.url);x.requested=T5.ticks()}else z.trigger("complete")}},frequency:10});v.bind("complete",function(){v=null})}}function m(){B=true;try{var t=h.length/2>>0;if(t>0){h.sort(function(z,x){return z.created-x.created});for(var u=t;u--;)delete e[h[u].url];h.splice(0,t)}}finally{B=false}COG.say("imagecache.cleared")}
function k(){var t=b[this.id],u;if(t&&t.image.complete&&t.image.width>0){t.loaded=true;t.hitCount=1;for(u=n.length;u--;)if(n[u].image.src==this.src){n.splice(u,1);break}if(t.background||t.postProcess||t.drawBackground||t.customDraw)if(t.image){globalImageData=t;u=a(t.realSize?t.realSize.width:t.image.width,t.realSize?t.realSize.height:t.image.height);var z=u.getContext("2d"),x=t.offset?t.offset:T5.XY.init();t.background&&z.drawImage(t.background,0,0);t.drawBackground&&t.drawBackground(z);t.customDraw?
t.customDraw(z,t):z.drawImage(t.image,x.x,x.y);t.postProcess&&t.postProcess(z,t);t.image=u}for(u=t.callbacks.length;u--;)t.callbacks[u]&&t.callbacks[u](this,false);t.callbacks=[];h[h.length]={url:this.src,created:t.requested};delete b[this.id];l()}}function d(t,u,z){var x=e[t];if(x){x.hitCount++;x.image.complete&&x.image.width>0&&u?u(x.image,true):x.callbacks.push(u)}else{x=T5.ex({url:t,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[u]},z);x.image.id="resourceLoaderImage"+
o++;e[t]=x;b[x.image.id]=x;f[f.length]=x;l()}return x}function a(t,u){var z=document.createElement("canvas");z.width=t?t:0;z.height=u?u:0;if(typeof FlashCanvas!=="undefined"){z.id="tmpCanvas"+g++;z.style.cssText="position: absolute; top: -"+(u-1)+"px; left: -"+(t-1)+"px;";document.body.appendChild(z);FlashCanvas.initElement(z)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(z);return z}var e={},g=0,b={},o=0,f=[],n=[],h=[],q=0,v=null,B=false,C={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){n=[]},get:function(t,u,z){var x=null,O=null;B||(x=e[t]);if((O=x?x.image:null)&&(O.getContext||O.complete&&O.width>0))return O;else u&&d(t,u,z);return null},load:d,newCanvas:a,reset:function(){e={}},stats:function(){return{imageLoadingCount:n.length,queuedImageCount:f.length,imageCacheFullness:q}}};COG.Loopage.join({execute:function(t){for(var u=false,z=0,x=T5.getConfig();z<n.length;)if(t-n[z].requested>C.loadTimeout*1E3){n.splice(z,1);u=true}else z++;u&&l();if(x&&x.imageCacheMaxSize){q=
h.length*C.avgImageSize/x.imageCacheMaxSize;q>=1&&m()}},frequency:2E4});return C}();T5.Generator=function(){var l={};return{init:function(m,k){var d=l[m];if(!d)throw Error("Unable to locate requested generator: "+m);return new d(k)},register:function(m,k){l[m]=k},Template:function(){}}}();
T5.TimeLord=function(){var l=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,k=function(a,e){return{days:a?a:0,seconds:e?e:0}},d={8601:function(a){a=a.split("T");var e=null;e=null;var g=0,b=0;l.lastIndex=-1;e=l.exec(a[0]);g+=e[3]?parseInt(e[3].slice(0,-1),10):0;m.lastIndex=-1;e=m.exec(a[1]);b+=e[1]?parseInt(e[1].slice(0,-1),10)*3600:0;b+=e[2]?parseInt(e[2].slice(0,-1),10)*60:0;b+=e[3]?parseInt(e[3].slice(0,-1),10):0;return new k(g,b)}};return{Duration:k,addDuration:function(){for(var a=new k,
e=arguments.length;e--;){a.days+=arguments[e].days;a.seconds+=arguments[e].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,e){var g=e?d[e]:null;if(g)return g(a);COG.Log.warn("Could not find duration parser for specified format: "+e);return new k},formatDuration:function(a){var e,g,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){e=~~(a/3600);a-=e*3600}if(a>=60){g=Math.round(a/60);a-=g*60}if(e)b=b+e+(e>1?" hrs ":" hr ")+
(g?(g>10?g:"0"+g)+" min ":"");else if(g)b=b+g+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
(function(){var l=Math.PI*2,m=Math.PI/2,k=Math.abs,d=Math.pow,a=Math.sin,e=Math.asin,g=Math.cos,b=1.70158,o={linear:function(f,n,h,q){return h*f/q+n},backin:function(f,n,h,q){return h*(f/=q)*f*((b+1)*f-b)+n},backout:function(f,n,h,q){return h*((f=f/q-1)*f*((b+1)*f+b)+1)+n},backinout:function(f,n,h,q){return(f/=q/2)<1?h/2*f*f*(((b*=1.525)+1)*f-b)+n:h/2*((f-=2)*f*(((b*=1.525)+1)*f+b)+2)+n},bouncein:function(f,n,h,q){return h-o.bounceout(q-f,0,h,q)+n},bounceout:function(f,n,h,q){return(f/=q)<1/2.75?
h*7.5625*f*f+n:f<2/2.75?h*(7.5625*(f-=1.5/2.75)*f+0.75)+n:f<2.5/2.75?h*(7.5625*(f-=2.25/2.75)*f+0.9375)+n:h*(7.5625*(f-=2.625/2.75)*f+0.984375)+n},bounceinout:function(f,n,h,q){return f<q/2?o.bouncein(f*2,0,h,q)/2+n:o.bounceout(f*2-q,0,h,q)/2+h/2+n},cubicin:function(f,n,h,q){return h*(f/=q)*f*f+n},cubicout:function(f,n,h,q){return h*((f=f/q-1)*f*f+1)+n},cubicinout:function(f,n,h,q){if((f/=q/2)<1)return h/2*f*f*f+n;return h/2*((f-=2)*f*f+2)+n},elasticin:function(f,n,h,q,v,B){if(f==0)return n;if((f/=
q)==1)return n+h;B||(B=q*0.3);if(!v||v<k(h)){v=h;h=B/4}else h=B/l*e(h/v);return-(v*d(2,10*(f-=1))*a((f*q-h)*l/B))+n},elasticout:function(f,n,h,q,v,B){var C;if(f==0)return n;if((f/=q)==1)return n+h;B||(B=q*0.3);if(!v||v<k(h)){v=h;C=B/4}else C=B/l*e(h/v);return v*d(2,-10*f)*a((f*q-C)*l/B)+h+n},elasticinout:function(f,n,h,q,v,B){var C;if(f==0)return n;if((f/=q/2)==2)return n+h;B||(B=q*0.3*1.5);if(!v||v<k(h)){v=h;C=B/4}else C=B/l*e(h/v);if(f<1)return-0.5*v*d(2,10*(f-=1))*a((f*q-C)*l/B)+n;return v*d(2,
-10*(f-=1))*a((f*q-C)*l/B)*0.5+h+n},quadin:function(f,n,h,q){return h*(f/=q)*f+n},quadout:function(f,n,h,q){return-h*(f/=q)*(f-2)+n},quadinout:function(f,n,h,q){if((f/=q/2)<1)return h/2*f*f+n;return-h/2*(--f*(f-2)-1)+n},sinein:function(f,n,h,q){return-h*g(f/q*m)+h+n},sineout:function(f,n,h,q){return h*a(f/q*m)+n},sineinout:function(f,n,h,q){return-h/2*(g(Math.PI*f/q)-1)+n}};T5.easing=function(f){return o[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(f,n){o[f.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=n}})();
T5.Tween=function(l){l=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},l);var m=T5.ticks(),k=[],d=false,a=0,e=0,g={cancelOnInteract:l.cancelOnInteract,isComplete:function(){return d},triggerComplete:function(b){l.complete&&l.complete(b)},update:function(b){try{var o=l.tweenFn(b-m,a,e,l.duration);if(l.target)l.target[l.property]=o;for(var f=k.length;f--;)k[f](o,void 0);if(d=m+l.duration<=b){if(l.target)l.target[l.property]=
l.tweenFn(l.duration,a,e,l.duration);for(var n=k.length;n--;)k[n](o,true)}}catch(h){COG.Log.exception(h)}},requestUpdates:function(b){k.push(b)}};a=l.target&&l.property&&l.target[l.property]?l.target[l.property]:l.startValue;if(typeof l.endValue!=="undefined")e=l.endValue-a;if(e==0)d=true;T5.wakeTweens();return g};
(function(){function l(a){if(d)return m.length;d=true;try{for(var e=0;e<m.length;)if(m[e].isComplete()){m[e].triggerComplete(false);m.splice(e,1)}else{m[e].update(a);e++}}finally{d=false}m.length===0&&k.trigger("complete");return m.length}var m=[],k=null,d=false;T5.tweenValue=function(a,e,g,b,o){a=new T5.Tween({startValue:a,endValue:e,tweenFn:g,complete:b,duration:o});m.push(a);return a};T5.tween=function(a,e,g,b,o,f){a=new T5.Tween({target:a,property:e,endValue:g,tweenFn:b,duration:f,complete:o});
m.push(a);return a};T5.tweenVector=function(a,e,g,b,o,f){var n=[];if(a){var h=a.x==e,q=a.y==g;h||n.push(T5.tween(a,"x",e,b,function(){(h=true)&&q&&o()},f));q||n.push(T5.tween(a,"y",g,b,function(){q=true;h&&q&&o()},f))}return n};T5.cancelAnimation=function(a){if(!d){d=true;try{for(var e=0;e<m.length;)if(!a||a(m[e])){m[e].triggerComplete(true);m.splice(e,1)}else e++}finally{d=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!k){k=COG.Loopage.join({execute:l,frequency:20});
k.bind("complete",function(){k=null})}}})();(function(){var l={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,k=arguments.length;k--;){var d=l[arguments[k].toUpperCase()];if(d)m|=d}return m}})();
T5.ViewLayer=function(l){l=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null},l);var m=null,k=false,d=false,a=l.supportFastDraw,e=l.id,g=T5.viewState("ACTIVE"),b=l.validStates,o=0,f=0,n=T5.ex({addToView:function(h){h.setLayer(e,n)},shouldDraw:function(h,q,v){h=(h&b)!==0&&(k?a:true);return h=d||v||o!==q.x||f!==q.y},cycle:function(){},draw:function(){},remove:function(){n.trigger("remove",n)},changed:function(){d=true;n.trigger("changed",
n);m&&m.trigger("invalidate")},getId:function(){return e},setId:function(h){e=h},getParent:function(){return m},setParent:function(h){k=(m=h)?m.fastDraw&&displayState!==g:false;n.trigger("parentChange",m)}},l);COG.observable(n);n.bind("drawComplete",function(h,q){d=false;o=q.x;f=q.y});return n};
T5.View=function(l){function m(y,D,K,P){Z=na;z();if(P&&l.inertia){U=true;f(N+D,s+K,l.panAnimationEasing,l.panAnimationDuration)}else P||f(N+D,s+K)}function k(){Z=ma;U=false;COG.Loopage.join({execute:z,after:50,single:true})}function d(y,D){aa=ua(y);pa=ua(D);var K=E(aa),P=E(pa);W=J(aa);Q=J(pa);M=aa&&K!==0?P/K:1}function a(y,D,K){d(D,K);if(X=M!==1){Z=Y;z()}}function e(y,D,K,P){d(D,K);if(l.adjustScaleFactor){M=l.adjustScaleFactor(M);COG.Log.info("scale factor adjusted to: "+M)}if(P<l.pinchZoomAnimateTrigger){q(ia,
M,W,v(),T5.easing("sine.out"),function(){b();M=1},300);M=ia}else{b();M=1}}function g(y,D,K){G.zoom(D,Math.min(Math.pow(2,Math.round(Math.log(K))),8),500)}function b(){var y=aa?v():Q;M=Math.round(M*10)/10;X=false;for(var D=x.length;D--;)x[D].trigger("scale",M,y);G.trigger("scale",M,y);Z=ma;z()}function o(){clearTimeout(ga);ga=setTimeout(n,50)}function f(y,D,K,P,R){function S(){$+=1;if($>=2){k(0,0);R&&R()}}var $=0;if(K){y=T5.tweenValue(N,y,K,S,P);D=T5.tweenValue(s,D,K,S,P);y.cancelOnInteract=true;y.requestUpdates(function(ca){N=
ca;U=true;z()});D.cancelOnInteract=true;D.requestUpdates(function(ca){s=ca;U=true;z()})}else{N=y;s=D}}function n(){var y;if(I){COG.Touch.release(I);if(l.autoSize&&I.parentNode){y=I.parentNode.getBoundingClientRect();if(y.height!==0&&y.width!==0){I.height=y.height;I.width=y.width}}try{if(!I.id)I.id=l.id+"_canvas";V=I.getContext("2d");V.clearRect(0,0,I.width,I.height)}catch(D){COG.Log.exception(D);throw Error("Could not initialise canvas on specified view element");}oa=COG.Touch.capture(I,{observable:G});
if(H.height!==I.height||H.width!==I.width){H=T5.D.init(I.width,I.height);G.trigger("resize",I.width,I.height);for(y=O;y--;)x[y].trigger("resize",I.width,I.height)}l.inertia&&oa.inertiaEnable(l.panAnimationDuration,H);for(y=O;y--;)x[y].trigger("contextChanged",V);u()}}function h(y,D){D.setId(y);D.added=T5.ticks();D.bind("remove",function(){G.removeLayer(y)});D.trigger("contextChanged",V);D.setParent(G);x.push(D);x.sort(function(K,P){var R=P.zindex-K.zindex;if(R===0)R=P.added-K.added;return R});O=x.length;
return D}function q(y,D,K,P,R,S,$){function ca(){S&&S();b();M=1;ha=null}X=true;W=T5.XY.offset(K,r.x1,r.y1);Q=T5.XY.offset(P,r.x1,r.y1);aa=null;COG.Log.info("zoom from: ",W);COG.Log.info("zoom to:   ",Q);if(R)T5.tweenValue(0,D-y,R,ca,$?$:1E3).requestUpdates(function(ka){ha=ka/(D-y);M=y+ka;Z=Y;z();G.trigger("animate")});else{M=D;ca()}}function v(){var y=T5.D.getCenter(H),D=T5.XY.distance([Q,y]);y=T5.XY.theta(Q,y,D);var K=T5.XY.diff(W,Q);y=T5.XY.extendBy(Q,y,D/M);y.x+=K.x;y.y+=K.y;return y}function B(){G.trigger("idle",
G);ja=true;fa=0}function C(y,D,K,P,R){var S=(D&Y)!==0,$=T5.XYRect.copy(K),ca=0;y.clearRect(0,0,I.width,I.height);if(w||S)w=false;if(S){T5.D.getCenter(H);var ka=(ha?ha:1)/2,va=T5.XY.diff(W,Q);if(aa){ba.x=Q.x+va.x;ba.y=Q.y+va.y}else{ba.x=Q.x-va.x*ka;ba.y=Q.y-va.y*ka}}y.save();try{ia=M;if(S){S=1/M;ka=(S-0.5)/0.5;$=T5.XYRect.fromCenter(Q.x-(Q.x-N)*ka,Q.y-(Q.y-s)*ka,~~($.width*S),~~($.height*S));y.scale(M,M)}y.translate(-$.x1,-$.y1);for(ca=O;ca--;)if(x[ca].shouldDraw(D,K,P)){var wa=x[ca].style,xa=wa?T5.Style.apply(y,
wa):null;x[ca].draw(y,$,D,G,P,R);xa&&T5.Style.apply(y,xa);x[ca].trigger("drawComplete",$,R)}}finally{y.restore()}G.trigger("drawComplete",K,R);COG.Log.trace("draw complete",R)}function t(y,D){var K=false,P=da?da:U?na:Z,R=!U&&(P===Y||P===na),S=ea||P===na||P===Y||T5.isTweening();p=T5.XY.init(N>>0,s>>0);r=T5.XYRect.fromCenter(p.x,p.y,H.width,H.height);if(R){T5.cancelAnimation(function($){return $.cancelOnInteract});ja=false;if(fa!==0){clearTimeout(fa);fa=0}}for(R=O;R--;){if(x[R].animated)Z|=ra;K=x[R].cycle(y,
r,Z,S)||K}S=S||(Z&ra)!==0;if(K=K||S||M!==1&&M!==la){C(V,P,r,S,y);la=M;ea=false}if(!K&&L===0&&!sa){if(!ja&&fa===0)fa=setTimeout(B,500);D.trigger("complete")}L=0;COG.Log.trace("Completed draw cycle",y)}function u(){ea=true;z()}function z(){L+=1;if(!A){A=COG.Loopage.join({execute:t,frequency:ta});A.bind("complete",function(){A=null})}}l=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,
adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},l);var x=[],O=0,I=document.getElementById(l.container),V=null,N=0,s=0,p=null,r=null,w=false,A=null,F=1,H=T5.D.init(),L=0,Q=null,ja=false,U=false,fa=0,qa=0,ba=T5.XY.init(),T=0,X=false,aa=null,pa=null,da=null,ea=false,ga=0,M=1,la=0,ia=1,ha=null,W=null,sa=typeof FlashCanvas!=="undefined",ta=~~(1E3/l.fps),oa=null,ma=T5.viewState("ACTIVE"),na=T5.viewState("PAN"),Y=T5.viewState("ZOOM"),ra=T5.viewState("ANIMATING"),Z=ma,ua=T5.XY.getRect,E=T5.XYRect.diagonalSize,
J=T5.XYRect.center,G={id:l.id,deviceScaling:F,fastDraw:l.fastDraw||T5.getConfig().requireFastDraw,animate:function(y,D,K,P,R){q(M,y,D,K,P,R)},centerOn:function(y){N=y.x-I.width/2;s=y.y-I.height/2},getDimensions:function(){return H},getZoomCenter:function(){return ba},getLayer:function(y){for(var D=0;D<O;D++)if(x[D].getId()==y)return x[D];return null},setLayer:function(y,D){for(var K=0;K<O;K++)if(x[K].getId()===y){x.splice(K,1);break}D&&h(y,D);u();return D},eachLayer:function(y){for(var D=O;D--;)y(x[D])},
clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");w=true;u()},invalidate:u,resize:function(y,D){if(I){l.autoSize=false;I.width=y;I.height=D;n();G.trigger("resize",I.width,I.height)}},scale:function(y,D,K,P,R){P||(P=T5.D.getCenter(H));R||(R=T5.D.getCenter(H));G.animate(y,P,R,D,K);return G},triggerAll:function(){G.trigger.apply(null,arguments);for(var y=x.length;y--;)x[y].trigger.apply(null,arguments)},removeLayer:function(y){a:{for(var D=O;D--;)if(x[D].getId()==
y){y=D;break a}y=-1}if(y>=0&&y<O){COG.say("layer.removed",{layer:x[y]});x.splice(y,1);u()}O=x.length},stateOverride:function(y){da=y},getOffset:function(){return p?p:T5.XY.init(N,s)},getViewRect:function(){return r?r:T5.XYRect.fromCenter(N,s,H.width,H.height)},updateOffset:f,pan:function(y,D,K,P,R){f(N+y,s+D,K,P,R)},zoom:function(y,D,K){U=false;M=D;X=M!==1;W=T5.D.getCenter(H);Q=T5.XY.offset(M>1?T5.XY.copy(y):T5.D.getCenter(H),r.x1,r.y1);aa=null;clearTimeout(qa);if(X){Z=Y;z();if(K)qa=setTimeout(function(){b();
M=1},parseInt(K,10))}}};F=T5.getConfig().getScaling();G.markers=h("markers",new T5.MarkerLayer);COG.observable(G);G.bind("wake",z);G.bind("invalidate",u);if(l.pannable){G.bind("pan",m);G.bind("panEnd",k);G.bind("inertiaCancel",function(){U=false;z()})}if(l.scalable){G.bind("pinchZoom",a);G.bind("pinchZoomEnd",e);G.bind("wheelZoom",g)}G.bind("tap",function(y,D,K){for(var P=T5.XY.offset(K,N,s),R=x.length;R--;)y.cancel=y.cancel||x[R].trigger("tap",D,K,P).cancel});COG.configurable(G,["inertia","container",
"rotation","tapExtent","scalable","pannable"],COG.paramTweaker(l,null,{container:function(y,D){I=document.getElementById(D);n()},rotation:function(y,D){T=D}}),true);n();l.autoSize&&window.addEventListener("resize",o,false);return G};
T5.PathLayer=function(l){l=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},l);var m=false,k=[],d=null,a=[],e=null,g=0,b=[],o=T5.ex(new T5.ViewLayer(l),{getAnimation:function(f,n,h,q){var v="pathAnimation"+g++;b.push(v);return new T5.AnimatedPathLayer({id:v,path:k,zindex:l.zindex+1,easing:f?f:T5.easing("sine.inout"),duration:n?n:5E3,drawIndicator:h,autoCenter:q?q:false})},cycle:function(f,n,h,q){return q},draw:function(f){var n,h=k.length;f.save();try{T5.Style.apply(f,l.style);if(h>0){f.beginPath();
f.moveTo(k[h-1].x,k[h-1].y);for(n=h;n--;)f.lineTo(k[n].x,k[n].y);f.stroke();if(d){f.fillStyle=l.waypointFillStyle;for(n=d.length;n--;){f.beginPath();f.arc(d[n].x,d[n].y,2,0,Math.PI*2,false);f.stroke();f.fill()}}}}finally{f.restore()}m=false},updateCoordinates:function(f,n){a=f;e=n;var h=o.getParent();if(h&&h.syncXY){h.syncXY(a);e&&h.syncXY(e);o.trigger("tidy")}}});o.bind("tidy",function(){k=T5.XY.simplify(a,l.pixelGeneralization);d=T5.XY.simplify(e,l.pixelGeneralization);m=true;o.changed()});return o};
T5.ShapeLayer=function(l){function m(g){for(var b=d.length;b--;)d[b].resync(g);d.sort(function(o,f){var n=f.xy.y-o.xy.y;if(n===0)n=f.xy.x-o.xy.y;return n});a=true;e.changed()}function k(g,b){b.syncXY&&m(b)}l=T5.ex({zindex:80},l);var d=[],a=false,e=T5.ex(new T5.ViewLayer(l),{add:function(g){d[d.length]=g},each:function(g){for(var b=d.length;b--;)g(d[b])},cycle:function(){return a},draw:function(g,b,o){var f=b.x1,n=b.y1,h=b.width;b=b.height;for(var q=d.length;q--;){var v=d[q].style;v=v?T5.Style.apply(g,
v):null;d[q].draw(g,f,n,h,b,o);v&&T5.Style.apply(g,v)}a=false}});e.bind("parentChange",k);e.bind("resync",k);return e};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(l){l=T5.ex({style:null,properties:{}},l);return T5.ex(l,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(l,m){m=T5.ex({size:4},m);var k=T5.XY.init(),d=T5.ex(m,{draw:function(a){a.beginPath();a.arc(k.x,k.y,d.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([l]);k=T5.XY.floor([l])[0]}});COG.Log.info("created arc = ",l);return d};
T5.Poly=function(l,m){m=T5.ex({fill:false,simplify:false},m);var k=false,d=m.fill,a=m.simplify,e=T5.viewState("ZOOM"),g=[],b=T5.ex(new T5.Shape(m),{draw:function(o,f,n,h,q,v){if(k){f=true;n=(v&e)!==0;o.beginPath();for(v=g.length;v--;){n=g[v].x;h=g[v].y;if(f){o.moveTo(n,h);f=false}else o.lineTo(n,h);n=true}if(n){d&&o.fill();o.stroke()}}},resync:function(o){b.xy=o.syncXY(l);g=T5.XY.floor(a?T5.XY.simplify(l):l)}});k=l&&l.length>=2;return b};
T5.AnimatedPathLayer=function(l){function m(b,o,f){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(f.x,f.y,4,0,Math.PI*2,false);b.stroke();b.fill()}l=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},l);var k=T5.XY.edges(l.path),d,a=null,e=0;T5.tweenValue(0,k.total,l.easing,function(){g.remove()},l.duration).requestUpdates(function(b,o){e=b;o&&g.remove()});var g=
T5.ex(new T5.ViewLayer(l),{cycle:function(){for(var b=0;b<k.accrued.length&&k.accrued[b]<e;)b++;a=null;if(b<l.path.length-1){var o=e-(b>0?k.accrued[b-1]:0),f=l.path[b];d=T5.XY.theta(f,l.path[b+1],k.edges[b]);a=T5.XY.extendBy(f,d,o);if(l.autoCenter)(b=g.getParent())&&b.centerOn(a)}return a},draw:function(b,o){if(a)(l.drawIndicator?l.drawIndicator:m)(b,o,T5.XY.init(a.x,a.y),d)}});return g};
T5.Marker=function(l){function m(o,f,n,h){d=o;a=f;e=n;g=h}l=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},l);var k=false,d=0,a=0,e=0,g=0,b=T5.ex(l,{isNew:true,isAnimating:function(){return k},draw:function(o,f,n,h,q){if(b.isNew&&l.tweenIn){var v=b.xy.y;b.xy.y=f.y1-20;k=true;T5.tween(b.xy,"y",v,l.tweenIn,function(){b.xy.y=v;k=false},l.animationSpeed?l.animationSpeed:250+Math.random()*500)}b.drawMarker(o,f,b.xy.x,b.xy.y,n,h,q);b.isNew=false},drawMarker:function(o,f,n,h){o.beginPath();
o.arc(n,h,4,0,Math.PI*2,false);o.fill();m(n-4,h-4,8,8)},hitTest:function(o,f){return o>=d&&o<=d+e&&f>=a&&f<=a+g},updateBounds:m});COG.observable(b);return b};
T5.ImageMarker=function(l){l=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},l);var m=l.imageAnchor?T5.XY.invert(l.imageAnchor):null,k=T5.ex(new T5.Marker(l),{drawMarker:function(d,a,e,g){if((a=k.isAnimating()&&k.animatingImage?k.animatingImage:k.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var b=k.scale,o=e+~~(m.x*b),f=g+~~(m.y*b),n=~~(a.width*b),h=~~(a.height*b);k.updateBounds(o,f,n,n);if(k.rotation||
k.opacity!==1){d.save();try{d.globalAlpha=k.opacity;d.translate(e,g);d.rotate(k.rotation);d.drawImage(a,m.x*b,m.y*b,n,h)}finally{d.restore()}}else d.drawImage(a,o,f,n,h)}}});if(!k.image)k.image=T5.Images.get(l.imageUrl,function(d){COG.Log.info("updating marker image to: "+d.src);k.image=d});if(!k.animatingImage)k.animatingImage=T5.Images.get(l.animatingImageUrl,function(d){k.animatingImage=d});return k};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(l){function m(){e.changed();e.trigger("markerUpdate",d)}function k(){var g=e.getParent();if(g&&g.syncXY)for(var b=d.length;b--;)g.syncXY([d[b].xy])}l=T5.ex({zindex:100,style:"basic"},l);var d=[],a=false,e=T5.ex(new T5.ViewLayer(l),{cycle:function(){return a},draw:function(g,b,o,f){a=false;for(var n=d.length;n--;){d[n].draw(g,b,o,e,f);a=a||d[n].isAnimating()}return a?1:0},add:function(g){if(g&&typeof g.length!=="undefined")for(var b=g.length;b--;){if(g[b])d[d.length]=g[b]}else if(g)d[d.length]=
g;m()},clear:function(g){if(g)for(var b=0;b<d.length;b++)g(d[b])&&d.splice(b,1);else d=[];m()},find:function(g){for(var b=[],o=d.length;o--;)if(!g||g(d[o]))b[b.length]=d[o];return b}});e.bind("tap",function(g,b,o){for(var f=[],n=o.x,h=o.y,q=d.length;q--;)if(d[q].hitTest(n,h))f[f.length]=d[q];if(f.length>0)g.cancel=e.trigger("markerTap",b,o,f).cancel});e.bind("parentChange",k);e.bind("changed",k);return e};
T5.ImageLayer=function(l,m){function k(q){var v=[];e.run(q,function(B){g=B;for(B=g.length;B--;)g[B]||(v[v.length]=B);for(B=0;B<v.length;B++)g.splice(v[B],1);(B=h.getParent())&&B.trigger("invalidate")});o=T5.XYRect.copy(q)}function d(){var q=h.getParent();q&&q.trigger("invalidate")}function a(){k(b)}m=T5.ex({imageLoadArgs:{}},m);var e=T5.Generator.init(l,m),g=null,b=T5.XYRect.init(),o=T5.XYRect.init(),f=m.imageLoadArgs,n=T5.viewState("ZOOM"),h=T5.ex(new T5.ViewLayer(m),{cycle:function(q,v){(Math.abs(v.x1-
o.x1)>v.width||Math.abs(v.y1-o.y1)>v.height)&&k(v)},draw:function(q,v,B){q.save();try{q.strokeStyle="#555";q.beginPath();if(g)for(var C=g.length;C--;){var t=g[C].x,u=g[C].y,z=T5.XYRect.init(g[C].x,g[C].y,g[C].x+g[C].width,g[C].y+g[C].height);T5.XYRect.intersect(v,z)&&h.drawImage(q,v,t,u,g[C],B)}q.clip()}finally{q.restore()}b=T5.XYRect.copy(v)},drawImage:function(q,v,B,C,t,u){if(v=T5.Images.get(t.url,(u&n)===0?d:null,f)){q.rect(B,C,t.width,t.height);q.drawImage(v,B,C,v.width,v.height)}}});h.bind("parentChange",
function(q,v){e.bindToView(v);v.bind("idle",a)});return h};
T5.Style=function(){function l(g,b){a[g]=k(b);return g}function m(g){for(var b in g)l(b,g[b])}function k(g){function b(h){var q=g[h];typeof q!=="undefined"&&o.push(function(v){v[h]=q})}g=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var o=[],f={applyToContext:function(h){for(var q=o.length;q--;)o[q](h)}};for(var n in g)b(n);return f}var d={},a={},e={apply:function(g,
b){var o=a[b]?a[b]:a.basic,f;if(g&&g.canvas){f=d[g.canvas.id];d[g.canvas.id]=b}o.applyToContext(g);return f},define:l,defineMany:m,init:k,load:function(g){COG.jsonp(g,function(b){T5.resetStyles(b)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return e}();T5.Tiling=function(){return{tileSize:256,init:function(l,m,k,d,a){return T5.ex({x:l,y:m,width:k,height:d},a)}}}();
T5.TileGenerator=function(l){function m(q,v){for(var B=~~((q.x1-a.x)/g),C=~~((q.y1-a.y)/b),t=[],u=-f;u<f;u++)for(var z=-n;z<n;z++)t[t.length]=o(B+u,C+z);v&&v(t);d=T5.XYRect.copy(q)}l=T5.ex({tileWidth:256,tileHeight:256},l);var k=null,d=null,a=T5.XY.init(),e=false,g=l.tileWidth,b=l.tileHeight,o=null,f=0,n=0,h={bindToView:function(q){COG.Log.info("initializing generator");k=q;h.trigger("bindView",q)},getTileCreatorArgs:null,initTileCreator:null,requireRefresh:function(){return false},reset:function(){o=
null;e=false},run:function(q,v){if(!d||Math.abs(q.x1-d.x1)>g||Math.abs(q.y1-d.y1)>b){if(!o&&!e||h.requireRefresh()){COG.Log.info("generating tiles, view rect = ",q);a=T5.XY.init(q.x1,q.y1);f=Math.ceil(q.width/g)+1;n=Math.ceil(q.height/b)+1;if(h.initTileCreator){e=true;h.initTileCreator(b,g,h.getTileCreatorArgs?h.getTileCreatorArgs(k):{},function(B){o=B;e=false;m(q,v)})}}o&&m(q,v)}}};COG.observable(h);return h};
T5.Geo=function(){function l(s,p){var r=null;for(var w in V)if(p){if(w==p&&V[w][s]){r=V[w];break}}else if(V[w][s]){r=V[w];break}return r}function m(s,p){var r=h*Math.sin(s);return a-2*Math.atan(p*Math.pow((1-r)/(1+r),h/2))}function k(s,p,r,w){var A=0;s=s.toUpperCase();for(var F in w){var H=p[F];if(H){var L=r[F];H=L?L(s,H):COG.wordExists(s,H)?1:0;A+=H*w[F]}}return A}var d=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],a=Math.PI/2,e=Math.PI*2,g=-a,b=a,o=
-e,f=Math.PI/180,n=180/Math.PI,h=0.08181919084262157,q=null,v={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},B={VECTORIZE_PER_CYCLE:500},C={getEngine:function(s){for(var p=null,r=1;!p&&r<arguments.length;r++)p=l(s,arguments[r]);p=p?p:l(s);if(!p)throw Error("Unable to find GEO engine with "+s+" capability");return p},rankGeocodeResponses:function(s,p,r){var w=[],A=N.AddressCompareFns;if(r&&r.compareFns)A=T5.ex({},A,r.compareFns);for(r=0;r<p.length;r++)w.push(new N.GeoSearchResult({caption:I.toString(p[r]),
data:p[r],pos:p[r].pos,matchWeight:k(s,p[r],A,N.GeocodeFieldWeights)}));w.sort(function(F,H){return H.matchWeight-F.matchWeight});return w},distanceToString:function(s){if(s>1E3)return~~(s/10)/100+" km";return s?s+" m":""},dist2rad:function(s){return s/6371},lat2pix:function(s){s=parseFloat(s)*f;s=Math.sin(s);var p=h*s;return Math.log((1+s)/(1-s)*Math.pow((1-p)/(1+p),h))/2},lon2pix:function(s){return parseFloat(s)*f},pix2lon:function(s){return N.normalizeLon(s)*n},pix2lat:function(s){s=Math.pow(Math.E,
-s);for(var p=a-2*Math.atan(s),r=m(p,s),w=0;w<12&&Math.abs(p-r)>1.0E-7;){p=r;r=m(p,s);w++}return r*n},normalizeLon:function(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s},radsPerPixel:function(s){return 2*Math.PI/(256<<s)}},t=function(s,p){return{lat:parseFloat(s?s:0),lon:parseFloat(p?p:0)}},u=function(s,p){return{min:x.parse(s),max:x.parse(p)}},z=function(s){return s=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},s)},x=function(){var s={calcDistance:function(p,
r){if(s.empty(p)||s.empty(r))return 0;var w=(r.lat-p.lat)*f/2,A=(r.lon-p.lon)*f/2;w=Math.sin(w)*Math.sin(w)+Math.cos(p.lat*f)*Math.cos(r.lat*f)*Math.sin(A)*Math.sin(A);return 6371*2*Math.atan2(Math.sqrt(w),Math.sqrt(1-w))},copy:function(p){return p?new t(p.lat,p.lon):null},empty:function(p){return!p||p.lat===0&&p.lon===0},equal:function(p,r){return p&&r&&p.lat==r.lat&&p.lon==r.lon},inArray:function(p,r){for(var w=x.equal,A=r.length;A--;)if(w(p,r[A]))return true;return false},inBounds:function(p,r){var w=
!(x.empty(p)||x.empty(r));return w=(w=w&&p.lat>=r.min.lat&&p.lat<=r.max.lat)&&p.lon>=r.min.lon&&p.lon<=r.max.lon},offset:function(p,r,w){var A=p.lat*f;r=A+r/6371;for(p=p.lon*f+Math.asin(Math.sin(w/6371)/Math.cos(A));r<g;)r+=Math.PI;for(;r>b;)r-=Math.PI;for(;p>e;)p-=2*Math.PI;return new t(r*n,p*n)},parse:function(p){if(p)if(typeof p.lat!=="undefined")return s.copy(p);else{if(p.split)for(var r=[" ",","],w=0;w<r.length;w++){var A=p.split(r[w]);if(A.length===2)return new t(A[0],A[1])}}else return new t;
return null},parseArray:function(p){var r=p.length,w=Array(r);for(r=r;r--;)w[r]=s.parse(p[r]);return w},fromMercatorPixels:function(p,r){return new t(T5.Geo.pix2lat(r),T5.Geo.normalizeLon(T5.Geo.pix2lon(p)))},toMercatorPixels:function(p){return T5.XY.init(T5.Geo.lon2pix(p.lon),T5.Geo.lat2pix(p.lat))},generalize:function(p,r,w){var A=p.length,F=[],H=null;w||(w=250);w/=1E3;COG.Log.info("generalizing positions, must include "+r.length+" positions");for(var L=A;L--;)if(L===0)F.unshift(p[L]);else{var Q=
!H||x.inArray(p[L],r)?w:x.calcDistance(H,p[L]);if(p[L]&&Q>=w){F.unshift(p[L]);H=p[L]}}COG.Log.info("generalized "+A+" positions into "+F.length+" positions");return F},vectorize:function(p,r){var w=p.length,A=Array(w);r=T5.ex({chunkSize:B.VECTORIZE_PER_CYCLE,async:true},r);if(!r.async){for(var F=w;F--;)A[F]=T5.GeoXY.init(p[F]);return A}return COG.Loopage.join({frequency:10,execute:function(H,L){for(var Q=0,ja=r.chunkSize,U=w;U--;){A[U]=T5.GeoXY.init(p[U]);Q+=1;if(Q>ja)break}w=U;w<=0&&L.trigger("complete",
A)}})},toString:function(p){return p?p.lat+" "+p.lon:""}};return s}(),O=function(){var s={calcSize:function(p,r,w){var A=T5.XY.init(0,r.lat-p.lat);if(typeof w==="undefined")w=true;A.x=w&&p.lon>r.lon?360-p.lon+r.lon:r.lon-p.lon;return A},createBoundsFromCenter:function(p,r){var w=r/6371,A=p.lat*f,F=p.lon*f,H=A-w,L=A+w;if(H>g&&L<b){A=Math.asin(Math.sin(w)/Math.cos(A));w=F-A;if(w<o)w+=2*Math.PI;F=F+A;if(F>e)F-=2*Math.PI}else{H=Math.max(H,g);L=Math.min(L,b);w=o;F=e}return new u(new t(H*n,w*n),new t(L*
n,F*n))},expand:function(p,r){return new u(new t(p.min.lat-r,p.min.lon-N.normalizeLon(r)),new t(p.max.lat+r,p.max.lon+N.normalizeLon(r)))},forPositions:function(p,r){var w=null,A=T5.ticks();r||(r="auto");for(var F=p.length;F--;)if(w){var H=s.calcSize(w.min,p[F],false),L=s.calcSize(p[F],w.max,false);if(H.x<0)w.min.lon=p[F].lon;if(H.y<0)w.min.lat=p[F].lat;if(L.x<0)w.max.lon=p[F].lon;if(L.y<0)w.max.lat=p[F].lat}else w=new T5.Geo.BoundingBox(p[F],p[F]);if(r){if(r=="auto"){F=s.calcSize(w.min,w.max);r=
Math.max(F.x,F.y)*0.3}w=s.expand(w,r)}COG.Log.trace("calculated bounds for "+p.length+" positions",A);return w},getCenter:function(p){var r=O.calcSize(p.min,p.max);return new T5.Geo.Position(p.min.lat+r.y/2,p.min.lon+r.x/2)},getGeoHash:function(p){var r=T5.Geo.GeoHash.encode(p.min.lat,p.min.lon);p=T5.Geo.GeoHash.encode(p.max.lat,p.max.lon);COG.Log.info("min hash = "+r+", max hash = "+p)},getZoomLevel:function(p,r){var w=s.getCenter(p),A=d[Math.min(Math.round(Math.abs(w.lat)*0.05),d.length)],F=s.calcSize(p.min,
p.max);w=Math.ceil(Math.log(d[3]*r.height/F.y)/Math.log(2));A=Math.ceil(Math.log(A*r.width/F.x)/Math.log(2));return Math.min(isNaN(w)?1E3:w,isNaN(A)?1E3:A)},isEmpty:function(p){return!p||x.empty(p.min)||x.empty(p.max)},toString:function(p){return"min: "+x.toString(p.min)+", max: "+x.toString(p.max)}};return s}(),I=function(){var s=/^(\d+).*$/,p=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(r,w){s.lastIndex=-1;if(s.test(r))for(var A=r.replace(s,"$1"),F=w.split(","),H=0;H<F.length;H++){p.lastIndex=
-1;if(p.test(F[H])){var L=p.exec(F[H]);if(A>=parseInt(L[1],10)&&A<=parseInt(L[2],10))return true}else if(A==F[H])return true}return false},normalize:function(r){if(!r)return"";r=r.toUpperCase();if(!q){var w=[];for(var A in v)w.push(A);q=RegExp("(\\s)("+w.join("|")+")(\\s|$)","i")}q.lastIndex=-1;if(w=q.exec(r))r=r.replace(q,"$1"+v[w[2]]);return r},toString:function(r){return r.streetDetails+" "+r.location}}}(),V={},N={P:x,B:O,A:I,Radius:function(s,p){return{distance:parseInt(s,10),uom:p}},Position:t,
BoundingBox:u,Address:z,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(s){if(!s.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var p=T5.ex({remove:function(){delete V[p.id]}},s);return V[p.id]=p},GeoSearchResult:function(s){s=T5.ex({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},s);return T5.ex(s,{toString:function(){return s.caption+(s.matchWeight?" ("+s.matchWeight+")":"")}})},GeoSearchAgent:function(s){return new T5.Dispatcher.Agent(s)},
GeocodingAgent:function(s){s=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(p,r){try{if(!p.reverse&&!p.freeform)address=new z(p);var w=N.getEngine("geocode");if(w)w.geocode({addresses:[p.freeform?p.freeform:address],complete:function(F,H){if(r){var L=H;if(p.freeform)L=N.rankGeocodeResponses(p.freeform,L,N.getEngine("geocode"));r(L,s)}}})}catch(A){COG.Log.exception(A)}}},s);return new N.GeoSearchAgent(s)}};T5.GeoXY=function(){function s(r,w){if(r.length){for(var A,F,H,L,
Q=r.length;Q--;){s(r[Q],w);A=typeof A==="undefined"||r.x<A?r.x:A;F=typeof F==="undefined"||r.y<F?r.y:F;H=typeof H==="undefined"||r.x>H?r.x:H;L=typeof L==="undefined"||r.y>L?r.y:L}return T5.XYRect.init(A,F,L,L)}else if(r.mercXY){A=r.mercXY;r.x=~~(A.x/w);r.y=~~((Math.PI-A.y)/w);r.radsPerPixel=w}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");return r}function p(r,w,A){r.pos=w;r.mercXY=x.toMercatorPixels(w);(A=typeof A!=="undefined"?A:r.radsPerPixel)&&s(r,A)}return{init:function(r,
w){var A=T5.XY.init();p(A,r,w);return A},sync:s,toPos:function(r,w){w=w?w:self.radsPerPixel;return x.fromMercatorPixels(r.x*w,Math.PI-r.y*w)},updatePos:p}}();N.GeoVector=function(s){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return T5.GeoXY.init(s)};return T5.ex(N,B,C)}();
T5.Geo.GeoHash=function(){function l(m,k,d){if(k&d)m[0]=(m[0]+m[1])/2;else m[1]=(m[0]+m[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(m){var k=1,d=[],a=[];d[0]=-90;d[1]=90;a[0]=-180;a[1]=180;lat_err=90;lon_err=180;for(i=0;i<m.length;i++){c=m[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(k){lon_err/=2;l(a,cd,mask)}else{lat_err/=2;l(d,cd,mask)}k=!k}}d[2]=(d[0]+
d[1])/2;a[2]=(a[0]+a[1])/2;return{latitude:d,longitude:a}},encode:function(m,k,d){var a=1,e=[],g=[],b=0,o=0;d=d?d:12;geohash="";e[0]=-90;e[1]=90;g[0]=-180;for(g[1]=180;geohash.length<d;){if(a){mid=(g[0]+g[1])/2;if(k>mid){o|=BITS[b];g[0]=mid}else g[1]=mid}else{mid=(e[0]+e[1])/2;if(m>mid){o|=BITS[b];e[0]=mid}else e[1]=mid}a=!a;if(b<4)b++;else{geohash+=BASE32[o];o=b=0}}return geohash}}}();
T5.Geo.JSON=function(){function l(n,h,q,v){h=k(h);n.add(v.line(h,q));return h.length}function m(n,h,q,v){h=k(h);n.add(v.poly(h,q));return h.length}function k(n){var h=n?n.length:0,q=Array(h);for(h=h;h--;)q[h]=new T5.Geo.Position(n[h][1],n[h][0]);return T5.Geo.P.vectorize(q,g)}function d(n,h,q){return new f(n,h,q)}var a="featurecollection",e="feature",g={async:false},b={processor:null,group:"shapes",layerClass:T5.ShapeLayer},o={point:T5.ex({},b,{processor:function(n,h,q,v){h=k([h.coordinates],g);if(h.length>
0)if(q=v.marker(h[0],q)){n.add(q);return h.length}},group:"markers",layerClass:T5.MarkerLayer}),linestring:T5.ex({},b,{processor:function(n,h,q,v){h=k(h&&h.coordinates?h.coordinates:[]);return l(n,h,q,v)}}),multilinestring:T5.ex({},b,{processor:function(n,h,q,v){h=h&&h.coordinates?h.coordinates:[];for(var B=0,C=h.length;C--;)B+=l(n,h[C],q,v);return B}}),polygon:T5.ex({},b,{processor:function(n,h,q,v){h=h&&h.coordinates?h.coordinates:[];if(h.length>0)return m(n,h[0],q,v);return 0}}),multipolygon:T5.ex({},
b,{processor:function(n,h,q,v){h=h&&h.coordinates?h.coordinates:[];for(var B=0,C=0;C<h.length;C++)B+=m(n,h[C][0],q,v);return B}})},f=function(n,h,q,v){function B(p,r){var w=p.processor,A=z+p.group,F=T5.ex({},p,q,{properties:r.properties});if(w){var H=N[A];if(!H){H=new p.layerClass({id:A});N[A]=H}globalLayers=N;return w(H,r.data,F,v)}return 0}function C(p,r){var w=p&&p.type?p.type.toLowerCase():null;return w&&w===e?C(p.geometry,p.properties):{type:w,isCollection:w?w===a:false,definition:o[w],data:p,
properties:r?r:p.properties}}q=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},q);v=T5.ex({marker:function(p){return new T5.Marker({xy:p})},line:function(p,r){return new T5.Poly(p,r)},poly:function(p,r){return new T5.Poly(p,T5.ex({fill:true},r))}},v);var t=q.vectorsPerCycle,u=q.rowPreParse,z=q.layerPrefix,x=0,O=0,I=null,V=0,N={},s;if(!n)return null;if(typeof n.length==="undefined")n=[n];O=n.length;s=COG.Loopage.join({frequency:10,execute:function(p,
r){var w=0,A=x;if(!I){for(;A<O;A++){var F=C(u?u(n[A]):n[A]),H=null;if(F.isCollection){V+=1;I=d(F.data.features,function(L){I=null;for(var Q in L)N[Q]=L[Q]},{layerPrefix:z+V+"-"});H+=1}else if(F.definition)H=B(F.definition,F);w+=H?H:1;if(w>=t)break}x=A+1;!I&&x>=O&&r.trigger("complete")}}});s.bind("complete",function(){h&&h(N)});return s};return{parse:d}}();
T5.Geo.LocationSearch=function(l){function m(g,b){navigator.geolocation.clearWatch(d);d=0;if(a){clearTimeout(a);a=0}b&&b([g],l)}function k(g){COG.Log.info("caught location tracking error:",g)}l=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},l);var d=0,a=0,e=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(g,b){if(navigator.geolocation&&!d){d=navigator.geolocation.watchPosition(function(o){var f=new T5.Geo.Position(o.coords.latitude,o.coords.longitude);
o=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:f,accuracy:o.coords.accuracy/1E3,matchWeight:100});if(!e||o.accuracy<e.accuracy)e=o;if(!l.requiredAccuracy||e.accuracy<l.requiredAccuracy)m(e,b)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(l.searchTimeout)a=setTimeout(function(){e&&m(e,b)},l.searchTimeout)}}},l))};
T5.Map=function(l){function m(u){try{var z=new T5.Geo.Position(u.coords.latitude,u.coords.longitude),x=u.coords.accuracy/1E3;t.trigger("locationUpdate",u,x);if(v){if(!h){h=new T5.Geo.UI.LocationOverlay({pos:z,accuracy:x});h.update(t.getTileLayer());t.setLayer("location",h)}var O=T5.Geo.B.createBoundsFromCenter(z,Math.max(x,1));t.gotoBounds(O)}else{h.pos=z;h.accuracy=x;h.update(t.getTileLayer());g(z,null,T5.easing("sine.out"))}v=false}catch(I){COG.Log.exception(I)}}function k(u){COG.Log.info("caught location tracking error:",
u)}function d(){var u=t.getViewRect();if(u){u=T5.XY.init(u.x1+u.width/2,u.y1+u.height/2);return T5.GeoXY.toPos(u,B)}return null}function a(u){if(u&&C!==u){var z=d();C=u;B=T5.Geo.radsPerPixel(C);g(z);t.trigger("zoomLevelChange",C);t.triggerAll("resync",t)}}function e(u,z,x){COG.Log.info("position updated to: ",u);a(z);T5.Images.cancelLoad();T5.cancelAnimation();g(u,x)}function g(u,z,x,O){u=T5.GeoXY.init(u,T5.Geo.radsPerPixel(C));t.updateOffset(u.x,u.y,x,O,z);t.trigger("wake");t.trigger("boundsChange",
t.getBoundingBox());z&&typeof x==="undefined"&&z(t)}l=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,zoomAnimation:T5.easing("quad.out")},l);var b={NONE:0,SINGLE:1,WATCH:2},o=T5.XY.init(),f=b.NONE,n=false,h=null,q=0,v=true,B=0,C=l.zoomLevel;if(!l.provider)l.provider=new T5.Geo.MapProvider;l.adjustScaleFactor=function(u){return Math.pow(2,(u<1?Math.floor:Math.ceil)(Math.log(u)))};var t=T5.ex(new T5.View(l),{getBoundingBox:function(){var u=t.getViewRect();return new T5.Geo.BoundingBox(T5.GeoXY.toPos(T5.XY.init(u.x1,
u.y2),B),T5.GeoXY.toPos(T5.XY.init(u.x2,u.y1),B))},getCenterPosition:d,getZoomLevel:function(){return C},setZoomLevel:a,gotoBounds:function(u,z){var x=T5.Geo.B.getZoomLevel(u,t.getDimensions());e(T5.Geo.B.getCenter(u),x,z)},gotoPosition:e,panToPosition:g,syncXY:function(u){return T5.GeoXY.sync(u,B)},locate:function(){t.trackStart(b.SINGLE);setTimeout(t.trackCancel,1E4)},trackStart:function(u){if(navigator.geolocation&&!q){f=u?u:b.WATCH;v=true;q=navigator.geolocation.watchPosition(m,k,{enableHighAccuracy:true,
timeout:1E4,maximumAge:5E3})}},trackCancel:function(){q&&navigator.geolocation&&navigator.geolocation.clearWatch(q);t.removeLayer("location");h=null;f=b.NONE;q=0},zoomIn:function(){T5.Geo.radsPerPixel(C);T5.Geo.radsPerPixel(C+1);t.scale(2,T5.easing("sine.out"))||t.setZoomLevel(C+1)},zoomOut:function(){T5.Geo.radsPerPixel(C);T5.Geo.radsPerPixel(C-1);t.scale(0.5,T5.easing("sine.out"))||t.setZoomLevel(C-1)},animateRoute:function(u,z,x,O){var I=t.getLayer("route");if(I)(u=I.getAnimation(u,z,x,O))&&u.addToView(t)}});
t.bind("pan",function(){f===b.SINGLE&&t.trackCancel()});t.bind("tap",function(){});t.bind("doubleTap",function(u,z,x){t.scalable()&&t.animate(2,T5.D.getCenter(t.getDimensions()),T5.XY.init(x.x,x.y),l.zoomAnimation)});t.bind("scale",function(u,z,x){u=0;z=Math.sqrt(z);if(z<1)u=-(0.5/z);else if(z>1)u=z;COG.Log.info("zoom xy = ",x);e(T5.GeoXY.toPos(x,B),C+u>>0)});t.bind("idle",function(){if(T5.XY.absSize(T5.XY.diff(o,t.getOffset()))>l.boundsChangeThreshold){o=T5.XY.copy(t.getOffset());t.trigger("boundsChange",
t.getBoundingBox())}});COG.configurable(t,["provider"],COG.paramTweaker(l,null,{provider:function(){t.cleanup();n=false}}),true);return t};
T5.Geo.MapProvider=function(){var l=1,m=20;return{zoomLevel:0,checkZoomLevel:function(k){return Math.min(Math.max(k,l),m)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:l,max:m}},prepTileGridArgs:function(k,d,a,e,g){var b=null;if(g.tileBackgroundColor){b=T5.Images.newCanvas(a,a);var o=b.getContext("2d");o.fillStyle=g.tileBackgroundColor;o.fillRect(0,0,a,a)}return T5.ex({tileSize:a,width:k,height:d,center:e,tileDrawArgs:{background:b}},
g)},setZoomRange:function(k,d){l=k;m=d}}};T5.MapTileGenerator=function(l){function m(e,g){COG.Log.info("ZOOM LEVEL CHANGED");k=g;a.reset()}var k=0,d=null,a=T5.ex(new T5.TileGenerator(l),{getTileCreatorArgs:function(e){d=e.getCenterPosition();return{zoomLevel:k,position:d}},requireRefresh:function(){return!d}});a.bind("bindView",function(e,g){if(g.getZoomLevel){k=g.getZoomLevel();g.bind("zoomLevelChange",m)}});return a};
T5.Geo.Routing=function(){var l={calculate:function(m){m=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},m);var k=T5.Geo.getEngine("route");k&&k.route(m,function(d){if(m.generalize)d.geometry=T5.Geo.P.generalize(d.geometry,d.getInstructionPositions());if(m.map){l.createMapOverlay(m.map,d);m.autoFit&&m.map.gotoBounds(d.boundingBox)}m.success&&m.success(d)})},createMapOverlay:function(m,k){var d=m.getDimensions();d=new T5.Geo.UI.RouteOverlay({data:k,width:d.width,
height:d.height});m.setLayer("route",d)},parseTurnType:function(m){for(var k=l.TurnType.Unknown,d=T5.Geo.Routing.TurnTypeRules,a=0;a<d.length;a++){d[a].regex.lastIndex=-1;var e=d[a].regex.exec(m);if(e){k=d[a].customCheck?d[a].customCheck(m,e):d[a].turnType;break}}return k},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(m){var k=m=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},m),d=m.description;d=d.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");k.description=d;if(!m.turnType)m.turnType=l.parseTurnType(m.description);return m},RouteData:function(m){m=T5.ex({geometry:[],instructions:[],boundingBox:null},
m);if(!m.boundingBox)m.boundingBox=T5.Geo.B.forPositions(m.geometry);return T5.ex({getInstructionPositions:function(){for(var k=[],d=0;d<m.instructions.length;d++)m.instructions[d].position&&k.push(m.instructions[d].position);return k}},m)}};return l}();T5.Geo.Search=function(){return{bestResults:function(l,m){m||(m=20);for(var k=l.length>0?l[0]:null,d=[],a=0;a<l.length;a++)if(k&&l[a]&&k.matchWeight-l[a].matchWeight<=m)d.push(l[a]);else break;return d}}}();
T5.Geo.UI=function(){var l={AnnotationTween:null,RouteOverlay:function(m){m=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},m);var k=[],d=[],a=new T5.PathLayer(m);(function(){if(m.data&&m.data.instructions){for(var e=m.data.instructions,g=Array(e.length),b=e.length;b--;)g[b]=e[b].position;T5.Geo.P.vectorize(g).bind("complete",function(o,f){d=f})}m.data&&m.data.geometry&&T5.Geo.P.vectorize(m.data.geometry).bind("complete",
function(o,f){k=f;a.updateCoordinates(k,d,true)})})();return a},Poly:function(m,k){k=T5.ex({autoParse:true},k);for(var d=Array(m.length),a=k.autoParse,e=T5.Geo.P.parse,g=m.length;g--;)d[g]=T5.GeoXY.init(a?e(m[g]):m[g]);return new T5.Poly(d,k)},Annotation:function(m){m=T5.ex({pos:null},m);m.xy=T5.GeoXY.init(m.pos);return new T5.ImageAnnotation(m)},LocationOverlay:function(m){m=T5.ex({pos:null,accuracy:null,zindex:90},m);var k=new Image,d=T5.XY.init(),a=T5.XY.init(),e=null;k.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
k.onload=function(){d=T5.XY.init(k.width/2,k.height/2)};var g=T5.ex(new T5.ViewLayer(m),{pos:m.pos,accuracy:m.accuracy,drawAccuracyIndicator:false,draw:function(b,o){var f=a.x-o.x,n=a.y-o.y;if(e){b.fillStyle="rgba(30, 30, 30, 0.2)";b.beginPath();b.arc(f,n,e,0,Math.PI*2,false);b.fill()}k.complete&&k.width>0&&b.drawImage(k,f-d.x,n-d.y,k.width,k.height);g.changed()},update:function(b){if(b){e=Math.floor(b.getPixelDistance(g.accuracy)*0.5);a=b.getGridXYForPosition(g.pos);g.changed()}}});g.bind("gridUpdate",
function(b,o){g.update(o)});return g},AnnotationsOverlay:function(m){function k(b,o){var f=b.length,n=g.getParent();if(o=o?o:n?n.getTileLayer():null)for(f=f;f--;)o.syncVectors([b[f].xy]);b.sort(function(h,q){var v=q.xy.y-h.xy.y;if(v===0)v=q.xy.x-h.xy.x;return v})}m=T5.ex({pois:null,map:null,zindex:100},m);var d=[],a=false,e=[],g=T5.ex(new T5.ViewLayer(m),{cycle:function(){return a},draw:function(b,o,f,n,h){a=false;b.fillStyle="rgba(255, 0, 0, 0.75)";b.globalCompositeOperation="source-over";for(f=
d.length;f--;){d[f].draw(b,o,n,g,h);a=a||d[f].isAnimating()}for(f=e.length;f--;){e[f].draw(b,o,n,g,h);a=a||e[f].isAnimating()}return a?1:0},add:function(b){if(b&&b.length)for(var o=b.length;o--;)e[e.length]=b[o];else if(b)e[e.length]=b;k(e);g.changed()},clear:function(b){e=[];k(e);if(b){d=[];k(d)}g.changed()}});COG.listen("geo.pois-updated",function(b){if(m.pois&&m.pois.id==b.srcID){b=b.pois;try{d=[];for(var o=0;o<b.length;o++)if(b[o].pos){var f;var n=b[o];if(n&&n.pos){var h={poi:n,annotation:null};
m.map&&m.map.trigger("getAnnotationForPOI",h);if(!h.annotation)h.annotation=new T5.Annotation({xy:T5.GeoXY.init(n.pos)});if(h.annotation){h.annotation.isNew=n.isNew;n.isNew=false}f=h.annotation}else f=void 0;f&&d.push(f)}k(d)}catch(q){COG.Log.exception(q)}g.changed()}});g.bind("gridUpdate",function(b,o){k(d,o);k(e,o);g.changed()});return g}};l.ImageAnnotation=l.Annotation;return l}();
T5.Geo.Routing.TurnTypeRules=function(){var l=T5.Geo.Routing.TurnType,m=[];m.push({regex:/continue/i,turnType:l.Continue});m.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(k,d){return/bear/i.test(d[1])?l.TurnLeftSlight:l.TurnLeft}});m.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(k,d){return/bear/i.test(d[1])?l.TurnRightSlight:l.TurnRight}});m.push({regex:/enter\s(roundabout|rotaty)/i,turnType:l.EnterRoundabout});m.push({regex:/take.*?ramp/i,turnType:l.Ramp});m.push({regex:/take.*?exit/i,
turnType:l.RampExit});m.push({regex:/make(.*?)u\-turn/i,customCheck:function(k,d){return/right/i.test(d[1])?l.UTurnRight:l.UTurnLeft}});m.push({regex:/proceed/i,turnType:l.Start});m.push({regex:/arrive/i,turnType:l.Arrive});m.push({regex:/fell\sthrough/i,turnType:l.Merge});return m}();
