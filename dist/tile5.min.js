COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var ia=arguments[0]||{},ta,M=1,I=arguments.length;M<I;M++)if((ta=arguments[M])!==null)for(var z in ta){var C=ta[z];if(ia!==C)if(C!==undefined)ia[z]=C}return ia};
(function(){var ia=Object.prototype.hasOwnProperty,ta=0,M={};M.toID=function(I){return I.replace(/\s/g,"-")};M.objId=function(I){return(I?I:"obj")+ta++};M.isFunction=function(I){return toString.call(I)==="[object Function]"};M.isArray=function(I){return toString.call(I)==="[object Array]"};M.isPlainObject=function(I){if(!I||toString.call(I)!=="[object Object]"||I.nodeType||I.setInterval)return false;if(I.constructor&&!ia.call(I,"constructor")&&!ia.call(I.constructor.prototype,"isPrototypeOf"))return false;
var z;for(z in I);return z===undefined||ia.call(I,z)};M.isEmptyObject=function(I){for(var z in I)return false;return true};M.isXmlDocument=function(I){return toString.call(I)==="[object Document]"};M.contains=function(I,z){var C=I,G=arguments,U=1;if(z&&module.isArray(z)){G=z;U=0}for(U=U;U<G;U++)C=C&&typeof foo[G[U]]!=="undefined";return C};M.formatStr=function(I){if(arguments.length<=1)return I;for(var z=arguments.length-2,C=0;C<=z;C++)I=I.replace(RegExp("\\{"+C+"\\}","gi"),arguments[C+1]);return I};
M.wordExists=function(I,z){var C="";if(z.toString)z=z.toString();for(var G=0;G<z.length;G++)C+=!/\w/.test(z[G])?"\\"+z[G]:z[G];return RegExp("(^|\\s|\\,)"+C+"(\\,|\\s|$)","i").test(I)};COG.extend(COG,M)})();
(function(){function ia(C){return typeof console!=="undefined"?function(){console[C](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var ta=window.console&&window.console.markTimeline,M=ia("error"),I=ia("info"),z=function(){return ta?function(C,G){console.markTimeline(C+(G?": "+((new Date).getTime()-G)+"ms":""))}:function(){}}();COG.extend(COG,{trace:z,debug:ia("debug"),info:I,warn:ia("warn"),error:M,exception:function(C){if(M)for(var G in C)I("ERROR DETAIL: "+
G+": "+C[G])}})})();
COG.Loopage=function(){function ia(u){return COG.extend({id:C++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},u)}function ta(u){U.push(u);M()}function M(){ua&&clearTimeout(ua);ua=setTimeout(I,0);N=true}function I(){for(var u,H=(new Date).getTime(),$=G.length;U.length>0;){var ea=U.shift();for(u=$;u--;)if(G[u].id===ea){G.splice(u,1);break}N=true;$=G.length}if(N){ja=z;for(u=$;u--;)ja=G[u].frequency<ja?G[u].frequency:ja}for(u=$;u--;){ea=H-G[u].lastTick;if(G[u].lastTick===0||ea>=G[u].frequency){G[u].execute(H,
G[u]);G[u].lastTick=H;G[u].single&&G[u].trigger("complete")}}ua=$?setTimeout(I,ja):0}var z=6E4,C=0,G=[],U=[],ua=0,ja=z,N=true;return{join:function(u){var H=new ia(u);if(H.after>0)H.lastTick=(new Date).getTime()+H.after;COG.observable(H);H.bind("complete",function(){ta(H.id)});G.unshift(H);M();return H},leave:ta}}();
(function(){function ia(M,I){var z=M.obsHandlers;z[I]||(z[I]=[]);return z[I]}var ta=0;COG.observable=function(M){if(!M)return null;if(!M.obsHandlers)M.obsHandlers={};if(!(M.bind||M.trigger||M.unbind)){M.bind=function(I,z){var C="callback"+ta++;ia(M,I).unshift({fn:z,id:C});return C};M.trigger=function(I){var z=ia(M,I),C={cancel:false,name:I,tickCount:(new Date).getTime()},G;if(!z)return null;G=Array.prototype.slice.call(arguments,1);M.eventInterceptor&&M.eventInterceptor(I,C,G);G.unshift(C);for(var U=
z.length;U--&&!C.cancel;)z[U].fn.apply(self,G);return C};M.unbind=function(I,z){if(typeof I==="undefined")M.obsHandlers={};else for(var C=ia(M,I),G=0;C&&G<C.length;G++)if(C[G].id===z){C.splice(G,1);break}return M}}return M}})();
(function(){function ia(z,C){z[C]||(z[C]=function(G){return z.configure(C,G)})}function ta(z){z.gtConfId="configurable"+I++;z.gtConfig={};z.gtConfigFns=[];return z.gtConfig}var M={},I=0;COG.paramTweaker=function(z,C,G){return function(U,ua){if(typeof ua!=="undefined"){if(U in z)z[U]=ua;G&&U in G&&G[U](U,ua)}else return C&&U in C?C[U](U):z[U]}};COG.configurable=function(z,C,G,U){if(z){z.gtConfId||ta(z);var ua=z.gtConfId,ja=z.gtConfig,N=z.gtConfigFns;M[ua]=z;N.push(G);for(G=C.length;G--;){ja[C[G]]=
true;U&&ia(z,C[G])}if(!z.configure)z.configure=function(u,H){if(ja[u]){for(var $=N.length;$--;){var ea=N[$](u,H);if(typeof ea!=="undefined")return ea}return M[ua]}return null}}}})();
(function(){function ia(z){var C=document.createElement("script"),G=false;C.src=z;C.async=true;C.onload=C.onreadystatechange=function(){if(!G&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){G=true;C.onload=C.onreadystatechange=null;C&&C.parentNode&&C.parentNode.removeChild(C)}};M||(M=document.getElementsByTagName("head")[0]);M.appendChild(C)}var ta=0,M,I=this;COG.jsonp=function(z,C,G){z+=z.indexOf("?")>=0?"&":"?";var U="json"+ ++ta;I[U]=function(ua){C(ua);I[U]=null;
try{delete I[U]}catch(ja){}};ia(z+(G?G:"callback")+"="+U);return U}})();
(function(){function ia(f){if(u)return ja.length;u=true;try{for(var t=0;t<ja.length;)if(ja[t].isComplete()){ja[t].triggerComplete(false);ja.splice(t,1)}else{ja[t].update(f);t++}}finally{u=false}ja.length===0&&N.trigger("complete");return ja.length}function ta(){if(!N){N=COG.Loopage.join({execute:ia,frequency:20});N.bind("complete",function(){N=null})}}var M=1.70158,I=Math.PI/2,z=Math.abs,C=Math.pow,G=Math.sin,U=Math.asin,ua=Math.cos,ja=[],N=null,u=false,H={linear:function(f,t,v,A){return v*f/A+t},
backin:function(f,t,v,A){return v*(f/=A)*f*((M+1)*f-M)+t},backout:function(f,t,v,A){return v*((f=f/A-1)*f*((M+1)*f+M)+1)+t},backinout:function(f,t,v,A){return(f/=A/2)<1?v/2*f*f*(((M*=1.525)+1)*f-M)+t:v/2*((f-=2)*f*(((M*=1.525)+1)*f+M)+2)+t},bouncein:function(f,t,v,A){return v-H.bounceout(A-f,0,v,A)+t},bounceout:function(f,t,v,A){return(f/=A)<1/2.75?v*7.5625*f*f+t:f<2/2.75?v*(7.5625*(f-=1.5/2.75)*f+0.75)+t:f<2.5/2.75?v*(7.5625*(f-=2.25/2.75)*f+0.9375)+t:v*(7.5625*(f-=2.625/2.75)*f+0.984375)+t},bounceinout:function(f,
t,v,A){return f<A/2?H.bouncein(f*2,0,v,A)/2+t:H.bounceout(f*2-A,0,v,A)/2+v/2+t},cubicin:function(f,t,v,A){return v*(f/=A)*f*f+t},cubicout:function(f,t,v,A){return v*((f=f/A-1)*f*f+1)+t},cubicinout:function(f,t,v,A){if((f/=A/2)<1)return v/2*f*f*f+t;return v/2*((f-=2)*f*f+2)+t},elasticin:function(f,t,v,A,W,V){if(f==0)return t;if((f/=A)==1)return t+v;V||(V=A*0.3);if(!W||W<z(v)){W=v;v=V/4}else v=V/TWO_PI*U(v/W);return-(W*C(2,10*(f-=1))*G((f*A-v)*TWO_PI/V))+t},elasticout:function(f,t,v,A,W,V){var na;if(f==
0)return t;if((f/=A)==1)return t+v;V||(V=A*0.3);if(!W||W<z(v)){W=v;na=V/4}else na=V/TWO_PI*U(v/W);return W*C(2,-10*f)*G((f*A-na)*TWO_PI/V)+v+t},elasticinout:function(f,t,v,A,W,V){var na;if(f==0)return t;if((f/=A/2)==2)return t+v;V||(V=A*0.3*1.5);if(!W||W<z(v)){W=v;na=V/4}else na=V/TWO_PI*U(v/W);if(f<1)return-0.5*W*C(2,10*(f-=1))*G((f*A-na)*TWO_PI/V)+t;return W*C(2,-10*(f-=1))*G((f*A-na)*TWO_PI/V)*0.5+v+t},quadin:function(f,t,v,A){return v*(f/=A)*f+t},quadout:function(f,t,v,A){return-v*(f/=A)*(f-2)+
t},quadinout:function(f,t,v,A){if((f/=A/2)<1)return v/2*f*f+t;return-v/2*(--f*(f-2)-1)+t},sinein:function(f,t,v,A){return-v*ua(f/A*I)+v+t},sineout:function(f,t,v,A){return v*G(f/A*I)+t},sineinout:function(f,t,v,A){return-v/2*(ua(Math.PI*f/A)-1)+t}},$=COG.Tween=function(f){f=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:ea("sine.out"),complete:null},f);var t=(new Date).getTime(),v=[],A=false,W=0,V=0,na={isComplete:function(){return A},triggerComplete:function(za){f.complete&&
f.complete(za)},update:function(za){try{var va=f.tweenFn(za-t,W,V,f.duration);if(f.target)f.target[f.property]=va;for(var Da=v.length;Da--;)v[Da](va,void 0);if(A=t+f.duration<=za){if(f.target)f.target[f.property]=f.tweenFn(f.duration,W,V,f.duration);for(var pa=v.length;pa--;)v[pa](va,true)}}catch(xa){COG.exception(xa)}},requestUpdates:function(za){v.push(za)}};W=f.target&&f.property&&f.target[f.property]?f.target[f.property]:f.startValue;if(typeof f.endValue!=="undefined")V=f.endValue-W;if(V==0)A=
true;ta();return na};COG.tweenValue=function(f,t,v,A,W){f=new $({startValue:f,endValue:t,tweenFn:v,complete:A,duration:W});ja.push(f);return f};COG.tween=function(f,t,v,A,W,V){f=new $({target:f,property:t,endValue:v,tweenFn:A,duration:V,complete:W});ja.push(f);return f};COG.endTweens=function(f){if(!u){u=true;try{for(var t=0;t<ja.length;)if(!f||f(ja[t])){ja[t].triggerComplete(true);ja.splice(t,1)}else t++}finally{u=false}}};COG.getTweens=function(){return[].concat(ja)};var ea=COG.easing=function(f){return H[f.replace(/[\-\_\s\.]/g,
"").toLowerCase()]};COG.registerEasingType=function(f,t){H[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]=t}})();
INTERACT=function(){function ia(N){return function(u,H,$){($?$:N?document.body:document).addEventListener(u,H,false)}}function ta(N){return function(u,H,$){($?$:N?document.body:document).removeEventListener(u,H,false)}}function M(N,u,H){(H?H:document).attachEvent("on"+N,u)}function I(N,u,H){(H?H:document).detachEvent("on"+N,u)}function z(N,u){return{x:N?N:0,y:u?u:0,count:1}}function C(N,u){ua.push(COG.extend({handler:null,checks:{},type:N},u))}function G(N){var u=0,H=0;if(N.offsetParent){do{u+=N.offsetLeft;
H+=N.offsetTop;N=N.offsetParent}while(N)}return{x:u,y:H}}function U(N,u){return{x:N.x-(u?u.x:0),y:N.y-(u?u.y:0)}}var ua=[],ja=function(N,u,H){function $(A,W,V,na){ea.trigger("pan",na.x,na.y)}H=COG.extend({binder:null,unbinder:null,observable:null},H);for(var ea=H.observable,f=[],t={bind:function(){return ea.bind.apply(null,arguments)},pannable:function(A){COG.extend({inertia:true},A);ea.bind("pointerMove",$);return t},unbind:function(){ea.unbind();for(var A=0;A<f.length;A++)f[A].unbind();return t}},
v=0;v<u.length;v++)f.push(u[v](N,ea,H));return t};C("pointer",{handler:function(N,u,H){function $(n){var ma=n.target?n.target:n.srcElement;if(V||ma&&ma===N)if(na=n.button===0){xa=n.pageX?n.pageX:n.screenX;Aa=n.pageY?n.pageY:n.screenY;za=z(xa,Aa);va=G(N);u.trigger("pointerDown",za,U(za,va))}}function ea(n){var ma=n.target?n.target:n.srcElement;Da=n.pageX?n.pageX:n.screenX;pa=n.pageY?n.pageY:n.screenY;if(na&&(V||ma&&ma===N))v("pointerMove")}function f(n){var ma=n.target?n.target:n.srcElement;if(na&&
n.button===0){na=false;if(V||ma&&ma===N)v("pointerUp")}}function t(n){var ma=n.target?n.target:n.srcElement;if(V||ma&&ma===N){ma=n.detail?n.axis===2?-n.detail*A:0:n.wheelDeltaY;if(ma!==0){var ya=z(Da,pa);u.trigger("zoom",ya,U(ya,va),ma/W);if(n.preventDefault){n.preventDefault();n.stopPropagation()}else n.cancelBubble&&n.cancelBubble()}}}function v(n){var ma=z(Da,pa);u.trigger(n,ma,U(ma,va),z(Da-xa,pa-Aa));xa=Da;Aa=pa}H=COG.extend({inertia:false},H);var A=120,W=A*8,V=false,na=false,za,va,Da,pa,xa,
Aa;H.binder("mousedown",$,false);H.binder("mousemove",ea,false);H.binder("mouseup",f,false);H.binder("click",function(n){var ma=n.target?n.target:n.srcElement;if(V||ma&&ma===N){n=z(n.pageX?n.pageX:n.screenX,n.pageY?n.pageY:n.screenY);u.trigger("pointerTap",n,U(n,G(N)))}},false);H.binder("mousewheel",t,window);H.binder("DOMMouseScroll",t,window);return{unbind:function(){H.unbinder("mousedown",$,false);H.unbinder("mousemove",ea,false);H.unbinder("mouseup",f,false);H.unbinder("mousewheel",t,window);
H.unbinder("DOMMouseScroll",t,window)}}},checks:{touch:false}});C("pointer",{handler:function(N,u,H){function $(R){if(R.count<2)return 0;var X=R.x-R.next.x;R=R.y-R.next.y;return~~Math.sqrt(X*X+R*R)}function ea(R,X,fa){X=X?X:0;fa=fa?fa:0;for(var Ha={x:R.x-X,y:R.y-fa,id:R.id,count:R.count},Ia=Ha;R.next;){R=R.next;Ia=Ia.next={x:R.x-X,y:R.y-fa,id:R.id}}return Ha}function f(R,X){var fa=R[X?X:"touches"],Ha,Ia;if(fa.length===0)return null;Ia=Ha={x:fa[0].pageX,y:fa[0].pageY,id:fa[0].identifier,count:fa.length};
for(var Ja=1,Ya=fa.length;Ja<Ya;Ja++)Ia=Ia.next={x:fa[Ja].pageX,y:fa[Ja].pageY,id:fa[Ja].identifier};return Ha}function t(R){var X=R.target?R.target:R.srcElement;if(X&&X===N){pa=G(N);X=f(R,"changedTouches");var fa=ea(X,pa.x,pa.y);if(!Aa){xa=za;u.trigger("pointerDown",X,fa)}Qa&&u.trigger("pointerDownMulti",X,fa);Aa=f(R);if(Aa.count>1)ma=$(Aa);Ea=1;ya=ea(Aa)}}function v(R){var X=R.target?R.target:R.srcElement;if(X&&X===N){R.preventDefault();n=f(R);if(xa==za)xa=Math.abs(Aa.x-n.x)>V||Math.abs(Aa.y-n.y)>
V?na:za;if(xa!=za){xa=n.count>1?Da:va;if(xa==Da)if(Aa.count===1){Aa=ea(n);ma=$(Aa)}else{R=$(n);if(Math.abs(ma-R)<W)xa=va;else{X=n.x;var fa=n.next.x,Ha=n.y,Ia=n.next.y,Ja=Ha<Ia?Ha:Ia;X={x:(X<fa?X:fa)+(Math.abs(X-fa)>>1),y:Ja+(Math.abs(Ha-Ia)>>1)};R=R/ma;fa=R-Ea;u.trigger("zoom",X,U(X,pa),fa);Ea=R}}xa==va&&u.trigger("pointerMove",n,ea(n,pa.x,pa.y),z(n.x-ya.x,n.y-ya.y));Qa&&u.trigger("pointerMoveMulti",n,ea(n,pa.x,pa.y))}ya=ea(n)}}function A(R){var X=R.target?R.target:R.srcElement;if(X&&X===N){X=f(R,
"changedTouches");var fa=ea(X,pa.x,pa.y);n=f(R);if(!n){xa===za&&u.trigger("pointerTap",X,fa);u.trigger("pointerUp",X,fa);Aa=null}Qa&&u.trigger("pointerUpMulti",X,fa)}}H=COG.extend({detailed:false,inertia:false},H);var W=20,V=7,na=0,za=1,va=2,Da=3,pa,xa,Aa,n,ma,ya,Qa=H.detailed,Ea=1;H.binder("touchstart",t,false);H.binder("touchmove",v,false);H.binder("touchend",A,false);COG.info("initialized touch handler");return{unbind:function(){H.unbinder("touchstart",t,false);H.unbinder("touchmove",v,false);
H.unbinder("touchend",A,false)}}},checks:{touch:true}});return{register:C,watch:function(N,u,H){u=COG.extend({bindToBody:false,observable:null,isIE:false,types:null},u);capabilities=COG.extend({touch:"ontouchstart"in window},H);if(!u.observable){COG.info("creating observable");u.observable=COG.observable({});globalOpts=u}u.binder=u.isIE?M:ia(u.bindToBody);u.unbinder=u.isIE?I:ta(u.bindToBody);H=u.types;for(var $=capabilities,ea=[],f=ua.length;f--;){var t=ua[f],v=!H||H.indexOf(t.type)>=0,A=true;for(var W in t.checks){var V=
t.checks[W];COG.info("checking "+W+" capability. require: "+V+", capability = "+$[W]);A=A&&V===$[W]}if(v&&A)ea[ea.length]=t.handler}return new ja(N,ea,u)}}}();
T5=function(){function ia(){return(new Date).getTime()}function ta(){for(;Ha.length>0;){var c=Ha.shift();document.location=c}fa=0}function M(c){for(var p=true,h=Ia.length;h--;)p=p&&c!=Ia[h];return p}function I(c,p){var h=[];for(var b in p)b&&h.push(b+"="+escape(p[b]));return"tile5://"+c+"/"+(h.length>0?"?"+h.join("&"):"")}function z(c,p){M(c)&&COG.info("would push url: "+I(c,p))}function C(c,p){if(M(c)){Ha.push(I(c,p));fa||(fa=setTimeout(ta,100))}}function G(c){return function(p,h,b){(b?b:c?document.body:
document).addEventListener(p,h,false)}}function U(c){return function(p,h,b){(b?b:c?document.body:document).removeEventListener(p,h,false)}}function ua(c,p,h){(h?h:document).attachEvent("on"+c,p)}function ja(c,p,h){(h?h:document).detachEvent("on"+c,p)}function N(){Ea={base:{name:"Unknown",bindEvent:G(),unbindEvent:U(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:z,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:ua,unbindEvent:ja,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:C,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:C},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:C},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:G(true),unbindEvent:U(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:C},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:C}};R=[Ea.froyo,Ea.android,Ea.ipod,Ea.iphone,Ea.ipad,Ea.ie]}function u(){Ea||N();if(!X){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<R.length;c++){var p=R[c];if(p.regex&&p.regex.test(navigator.userAgent)){X=COG.extend({},Ea.base,p);COG.info("PLATFORM DETECTED AS: "+X.name);break}}if(!X){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
X=Ea.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return X}function H(c,p){function h(d,i){if(d&&b!==d){var l=c.triggerAll("zoomLevelChange",d,i);if(l)b=d;return l}}p=COG.extend({initial:1,min:0,max:null,zoomAnimation:COG.easing("quad.out")},p);var b=p.initial;COG.extend(c,{getZoomLevel:function(){return b},setZoomLevel:h});c.bind("scale",function(d,i,l){var o=Math.log(i)/Math.LN2;COG.endTweens(function(w){return w.cancelOnInteract});d.cancel=!h(b+o,l);d.cancel||c.updateOffset(l.x*
i,l.y*i)});c.bind("doubleTap",function(d,i,l){if(c.scalable()){COG.endTweens(function(o){return o.cancelOnInteract});c.scale(2,n.init(l.x,l.y))}})}function $(){for(var c=0,p=arguments.length;p--;){var h=ob[arguments[p].toUpperCase()];if(h)c|=h}return c}var ea=Math.PI*2,f=Math.PI/2,t=Math.abs,v=Math.min,A=Math.max,W=Math.pow,V=Math.sqrt,na=Math.log,za=Math.round,va=Math.sin,Da=Math.asin,pa=Math.cos,xa=Math.atan,Aa=Math.atan2,n=function(){function c(b,d){return h(b.x-d.x,b.y-d.y)}function p(b,d){if(!d)d=
b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var i={edges:Array(d-1),accrued:Array(d-1),total:0},l=0;l<d-1;l++){var o=c(b[l],b[l+1]);i.edges[l]=V(o.x*o.x+o.y*o.y);i.accrued[l]=i.total+i.edges[l];i.total+=i.edges[l]}return i}function h(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,i=arguments.length;i--;){b+=arguments[i].x;d+=arguments[i].y}return h(b,d)},absSize:function(b){return A(t(b.x),
t(b.y))},copy:function(b){return b?h(b.x,b.y):null},diff:c,distance:function(b,d){return p(b,d).total},edges:p,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,i){var l=pa(d)*i;d=va(d)*i;return h(b.x-l,b.y-d)},floor:function(b){for(var d=Array(b.length),i=b.length;i--;)d[i]=h(~~b[i].x,~~b[i].y);return d},getRect:function(b){for(var d,i,l,o,w=b.length;w--;){var q=b[w];d=typeof d==="undefined"||q.x<d?q.x:d;i=typeof i==="undefined"||q.y<i?q.y:i;l=typeof l==="undefined"||q.x>l?
q.x:l;o=typeof o==="undefined"||q.y>o?q.y:o}return ya.init(d,i,l,o)},init:h,invert:function(b){return h(-b.x,-b.y)},min:function(b,d){return h(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return h(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,i){return h(b.x+d,b.y+(i?i:d))},simplify:function(b,d){if(!b)return null;d=d?d:n.VECTOR_SIMPLIFICATION;for(var i=[],l=null,o=b.length;o--;){var w=b[o];if(include=!l||o===0||t(w.x-l.x)+t(w.y-l.y)>d){i.unshift(w);l=w}}return i},theta:function(b,
d,i){i=Da((b.y-d.y)/i);return b.x>d.x?i:Math.PI-i}}}(),ma=function(){return{dotProduct:function(c,p){return c.x*p.x+c.y*p.y}}}(),ya=function(){function c(h){return p(h.x1,h.y1,h.x2,h.y2)}function p(h,b,d,i){h=h?h:0;b=b?b:0;d=typeof d!=="undefined"?d:h;i=typeof i!=="undefined "?i:i;return{x1:h,y1:b,x2:d,y2:i,width:d-h,height:i-b}}return{center:function(h){return n.init(h.x1+h.width/2,h.y1+h.height/2)},copy:c,diagonalSize:function(h){return V(h.width*h.width+h.height*h.height)},fromCenter:function(h,
b,d,i){d=d>>1;i=i>>1;return p(h-d,b-i,h+d,b+i)},init:p,intersect:function(h,b){var d=A(h.x1,b.x1),i=A(h.y1,b.y1),l=v(h.x2,b.x2),o=v(h.y2,b.y2);d=p(d,i,l,o);return d.width>0&&d.height>0?d:null},union:function(h,b){if(h.width===0||h.height===0)return c(b);else if(b.width===0||b.height===0)return c(h);else{var d=v(h.x1,b.x1),i=v(h.y1,b.y1),l=A(h.x2,b.x2),o=A(h.y2,b.y2);d=p(d,i,l,o);return d.width>0&&d.height>0?d:null}}}}(),Qa=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:
1},getCenter:function(c){return n.init(c.width>>1,c.height>>1)},getSize:function(c){return V(W(c.width,2)+W(c.height,2))},init:function(c,p){c=c?c:0;return{width:c,height:p?p:c}}}}(),Ea=null,R=[],X=null,fa=0,Ha=[],Ia=["view.wake","tile.loaded"],Ja=function(){function c(){if(!T){var B=u().maxImageLoads;T=COG.Loopage.join({execute:function(K,S){if(!B||s.length<B){var D=q.shift();if(D){s[s.length]=D;D.image.onload=h;D.image.src=D.url;D.requested=T5.ticks()}else S.trigger("complete")}},frequency:10});
T.bind("complete",function(){T=null})}}function p(){O=true;try{var B=x.length>>1;if(B>0){x.sort(function(S,D){return S.created-D.created});for(var K=B;K--;)delete i[x[K].url];x.splice(0,B)}}finally{O=false}Y.trigger("cacheCleared")}function h(){var B=o[this.id],K;if(B&&B.image.complete&&B.image.width>0){B.loaded=true;B.hitCount=1;for(K=s.length;K--;)if(s[K].image.src==this.src){s.splice(K,1);break}if(B.background||B.postProcess||B.drawBackground||B.customDraw)if(B.image){globalImageData=B;K=d(B.realSize?
B.realSize.width:B.image.width,B.realSize?B.realSize.height:B.image.height);var S=K.getContext("2d"),D=B.offset?B.offset:T5.XY.init();B.background&&S.drawImage(B.background,0,0);B.drawBackground&&B.drawBackground(S);B.customDraw?B.customDraw(S,B):S.drawImage(B.image,D.x,D.y);B.postProcess&&B.postProcess(S,B);B.image=K}for(K=B.callbacks.length;K--;)B.callbacks[K]&&B.callbacks[K](this,false);B.callbacks=[];x[x.length]={url:this.src,created:B.requested};delete o[this.id];c()}}function b(B,K,S){var D=
i[B];if(D){D.hitCount++;D.image.complete&&D.image.width>0&&K?K(D.image,true):D.callbacks.push(K)}else{D=COG.extend({url:B,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[K]},S);D.image.id="resourceLoaderImage"+w++;i[B]=D;o[D.image.id]=D;q[q.length]=D;c()}return D}function d(B,K){var S=document.createElement("canvas");S.width=B?B:0;S.height=K?K:0;if(typeof FlashCanvas!=="undefined"){S.id="tmpCanvas"+l++;S.style.cssText="position: absolute; top: -"+(K-1)+"px; left: -"+
(B-1)+"px;";document.body.appendChild(S);FlashCanvas.initElement(S)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(S);return S}var i={},l=0,o={},w=0,q=[],s=[],x=[],J=0,T=null,O=false,Y={avgImageSize:25,loadTimeout:10,cancelLoad:function(){s=[]},get:function(B,K,S){var D=null,ba=null;O||(D=i[B]);if((ba=D?D.image:null)&&(ba.getContext||ba.complete&&ba.width>0))return ba;else K&&b(B,K,S);return null},load:b,newCanvas:d,reset:function(){i={}},stats:function(){return{imageLoadingCount:s.length,
queuedImageCount:q.length,imageCacheFullness:J}}};COG.observable(Y);COG.Loopage.join({execute:function(B){for(var K=false,S=0,D=u();S<s.length;)if(B-s[S].requested>Y.loadTimeout*1E3){s.splice(S,1);K=true}else S++;K&&c();if(D&&D.imageCacheMaxSize){J=x.length*Y.avgImageSize/D.imageCacheMaxSize;J>=1&&p()}},frequency:2E4});return Y}(),Ya=function(){var c={};return{init:function(p,h){var b=c[p];if(!b)throw Error("Unable to locate requested generator: "+p);return new b(h)},register:function(p,h){c[p]=h},
Template:function(){}}}(),Ua=function(){function c(l,o){d[l]=h(o);return l}function p(l){for(var o in l)c(o,l[o])}function h(l){function o(x){var J=l[x];typeof J!=="undefined"&&q.push(function(T){T[x]=J})}function w(){q=[];for(var x in l)o(x)}l=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},l);var q=[],s={applyToContext:function(x){for(var J=q.length;J--;)q[J](x)},
update:function(x,J){l[x]=J;w()}};w();return s}var b={},d={},i={apply:function(l,o){var w=d[o]?d[o]:d.basic,q;if(l&&l.canvas){q=b[l.canvas.id];b[l.canvas.id]=o}w.applyToContext(l);return q},define:c,defineMany:p,get:function(l){return d[l]},init:h,load:function(l){COG.jsonp(l,function(o){p(o)})}};p({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return i}(),ob={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},
jb=function(c){function p(y,F,ca,oa){La=Fa;O();if(oa&&c.inertia)o(da-F,Ba-ca,c.panAnimationEasing,c.panAnimationDuration);else oa||o(da-F,Ba-ca);clearTimeout(r);r=setTimeout(h,100)}function h(){La=qa;e=false;O()}function b(y,F,ca,oa){sa.zoom(ca,oa)}function d(y){x();var F=n.init(ga-(Ca.width/(aa*2)>>0),ka-(Ca.height/(aa*2)>>0)),ca=Math.log(aa)/Math.LN2>>0;if(aa!==1)La=Ka;if(ca!==0){aa=Math.pow(2,ca);if(!sa.trigger("scale",aa,F).cancel){for(y=K.length;y--;)K[y].trigger("scale",aa,F);aa=1;la=null;La=
qa;y=true}}O(y)}function i(y){Za=n.init(da,Ba);$a=n.offset(y,da,Ba)}function l(){clearTimeout(ha);ha=setTimeout(w,50)}function o(y,F,ca,oa,ra){function wa(){Ga+=1;if(Ga>=2){h();ra&&ra()}}var Ga=0,Sa=a?n.offset(a,-Va,-Ra):null,Ta=j?n.offset(j,-Va,-Ra):null;if(Sa){y=y<Sa.x?Sa.x:y;F=F<Sa.y?Sa.y:F}if(Ta){y=y>Ta.x?Ta.x:y;F=F>Ta.y?Ta.y:F}if(ca){if(!e){y=COG.tweenValue(da,y,ca,wa,oa);F=COG.tweenValue(Ba,F,ca,wa,oa);y.cancelOnInteract=true;y.requestUpdates(function(fb){da=fb>>0;e=true;O()});F.cancelOnInteract=
true;F.requestUpdates(function(fb){Ba=fb>>0;e=true;O()})}}else{da=y>>0;Ba=F>>0}}function w(){var y;if(D){Q&&Q.unbind();if(c.autoSize&&D.parentNode){y=D.parentNode.getBoundingClientRect();if(y.height!==0&&y.width!==0){D.height=y.height;D.width=y.width}}try{if(!D.id)D.id=c.id+"_canvas";ba=D.getContext("2d")}catch(F){COG.exception(F);throw Error("Could not initialise canvas on specified view element");}if(Pa.height!==D.height||Pa.width!==D.width){Pa=Qa.init(D.width,D.height);Va=Pa.width>>1;Ra=Pa.height>>
1;sa.trigger("resize",D.width,D.height);for(y=S;y--;)K[y].trigger("resize",D.width,D.height)}if(c.interactive)Q=INTERACT.watch(D,{observable:sa}).pannable();for(y=S;y--;)K[y].trigger("contextChanged",ba);O()}}function q(y,F){F.setId(y);F.added=ia();F.bind("remove",function(){sa.removeLayer(y)});F.trigger("contextChanged",ba);F.setParent(sa);K.push(F);K.sort(function(ca,oa){var ra=oa.zindex-ca.zindex;if(ra===0)ra=oa.added-ca.added;return ra});S=K.length;return F}function s(){B("idle",sa);g=true;k=
0}function x(y){var F=1/aa;ga=$a.x+(da-Za.x);ka=$a.y+(Ba-Za.y);if(y)return ya.fromCenter(ga>>0,ka>>0,y.width*F>>0,y.height*F>>0)}function J(y,F,ca,oa){var ra=ya.copy(F),wa,Ga=0;ca&&ba.clearRect(0,0,D.width,D.height);ba.save();try{ba.globalCompositeOperation="source-over";if(aa!==1){ra=x(ra);ba.scale(aa,aa)}ba.translate(-ra.x1,-ra.y1);j=a=null;ba.beginPath();ab=false;for(Ga=S;Ga--;)if(K[Ga].clip){K[Ga].clip(ba,ra,y,sa,ca,oa);ab=true}ba.closePath();ab&&ba.clip();for(Ga=S;Ga--;){wa=K[Ga];var Sa=wa.style,
Ta=Sa?Ua.apply(ba,Sa):null;if(wa.minXY)a=a?n.min(a,wa.minXY):n.copy(wa.minXY);if(wa.maxXY)j=j?n.max(j,wa.maxXY):n.copy(wa.maxXY);wa.draw(ba,ra,y,sa,ca,oa);Ta&&Ua.apply(ba,Ta)}}finally{ba.restore()}if(db){ba.globalCompositeOperation="source-over";ba.strokeStyle="#f00";ba.beginPath();ba.moveTo(D.width>>1,0);ba.lineTo(D.width>>1,D.height);ba.moveTo(0,D.height>>1);ba.lineTo(D.width,D.height>>1);ba.stroke()}B("drawComplete",F,oa);COG.trace("draw complete",oa)}function T(y,F){var ca=false,oa=E?E:e?Fa:La,
ra=!e&&(oa===Ka||oa===Fa),wa=L||oa===Fa||oa===Ka||COG.getTweens().length>0;Ca=Y();if(ra){COG.endTweens(function(Ga){return Ga.cancelOnInteract});g=false;if(k!==0){clearTimeout(k);k=0}}for(ra=S;ra--;){if(K[ra].animated)La|=bb;K[ra].cycle(y,Ca,La,wa);ca=K[ra].shouldDraw(La,Ca,wa)||ca}wa=wa||(La&bb)!==0;if(ca=ca||wa||aa!==1&&aa!==Ma){J(oa,Ca,wa,y);Ma=aa;L=false}if(!ca&&cb===0&&!P){if(!g&&k===0)k=setTimeout(s,500);F.trigger("complete")}cb=0;COG.trace("Completed draw cycle",y)}function O(y){L=y?true:false;
cb+=1;if(!Wa){Wa=COG.Loopage.join({execute:T,frequency:Z});Wa.bind("complete",function(){Wa=null})}}function Y(){return ya.init(da,Ba,da+Pa.width,Ba+Pa.height)}function B(){for(var y=sa.trigger.apply(null,arguments).cancel,F=K.length;F--;)y=K[F].trigger.apply(null,arguments).cancel||y;return!y}c=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,interactive:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,
adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},c);var K=[],S=0,D=document.getElementById(c.container),ba=null,da=0,Ba=0,ab=false,Ca=null,Wa=null,db=c.guides,eb=1,Pa=Qa.init(),cb=0,Va=0,Ra=0,Za=null,$a=null,g=false,e=false,k=0,r=0,a=null,j=null,m=0,E=null,L=false,ha=0,la=null,aa=1,Ma=0,Q=null,P=typeof FlashCanvas!=="undefined",Z=~~(1E3/c.fps),ga,ka,qa=$("ACTIVE"),Fa=$("PAN"),Ka=$("ZOOM"),bb=$("ANIMATING"),La=qa,sa={id:c.id,deviceScaling:eb,fastDraw:c.fastDraw||u().requireFastDraw,
getDimensions:function(){return Pa},getLayer:function(y){for(var F=0;F<S;F++)if(K[F].getId()==y)return K[F];return null},setLayer:function(y,F){for(var ca=0;ca<S;ca++)if(K[ca].getId()===y){K.splice(ca,1);break}F&&q(y,F);O();return F},eachLayer:function(y){for(var F=S;F--;)y(K[F])},invalidate:O,resize:function(y,F){if(D){c.autoSize=false;D.width=y;D.height=F;w();sa.trigger("resize",D.width,D.height)}},scale:function(y,F,ca,oa){function ra(){aa=Math.pow(2,Math.round(Math.log(aa)/Math.LN2));oa&&oa();
d(true)}var wa=aa;F||(F=Qa.getCenter(Pa));i(F);if(ca)COG.tweenValue(0,y-wa,ca,ra,1E3).requestUpdates(function(Ga){aa=wa+Ga;d()});else{aa=y;ra()}return sa},triggerAll:B,removeLayer:function(y){a:{for(var F=S;F--;)if(K[F].getId()==y){y=F;break a}y=-1}if(y>=0&&y<S){sa.trigger("layerRemoved",K[y]);K.splice(y,1);O()}S=K.length},stateOverride:function(y){E=y},getOffset:function(){return n.init(da,Ba)},getViewRect:Y,updateOffset:o,pan:function(y,F,ca,oa,ra){o(da+y,Ba+F,ca,oa,ra)},zoom:function(y,F){i(y);
e=false;aa=Math.max(aa+Math.pow(2,F)-1,0.25);d()}};eb=u().getScaling();sa.markers=q("markers",new gb);COG.observable(sa);sa.bind("invalidate",function(y,F){O(F)});if(c.pannable){sa.bind("pan",p);sa.bind("inertiaCancel",function(){e=false;O()})}c.scalable&&sa.bind("zoom",b);sa.bind("pointerTap",function(y,F,ca){B("tap",F,ca,n.offset(ca,da,Ba))});sa.bind("resync",function(){j=a=null});COG.configurable(sa,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(c,null,{container:function(y,
F){D=document.getElementById(F);w()},rotation:function(y,F){m=F}}),true);w();c.autoSize&&window.addEventListener("resize",l,false);return sa},Xa=function(c){c=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:$("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var p=null,h=false,b=false,d=c.supportFastDraw,i=c.id,l=$("ACTIVE"),o=c.validStates,w=0,q=0,s=COG.extend({addToView:function(x){x.setLayer(i,s)},shouldDraw:function(x,J,T){return(b||T||w!==J.x1||
q!==J.y1)&&(x&o)!==0&&(h?d:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){s.trigger("remove",s)},changed:function(x){b=true;s.trigger("changed",s);p&&p.trigger("invalidate",x)},getId:function(){return i},setId:function(x){i=x},getParent:function(){return p},setParent:function(x){h=(p=x)?p.fastDraw&&displayState!==l:false;s.trigger("parentChange",p)}},c);COG.observable(s);s.bind("drawComplete",function(x,J){b=false;w=J.x1;q=J.y1});s.bind("resync",function(x,J){if(J.syncXY){s.minXY&&
J.syncXY(s.minXY);s.maxXY&&J.syncXY(s.maxXY)}});return s},hb=function(c){function p(w,q,s,x){b=w;d=q;i=s;l=x}c=COG.extend({xy:n.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var h=false,b=0,d=0,i=0,l=0,o=COG.extend(c,{isAnimating:function(){return h},draw:function(w,q,s,x,J){if(o.isNew&&c.tweenIn){var T=o.xy.y;o.xy.y=q.y1-20;h=true;COG.tween(o.xy,"y",T,c.tweenIn,function(){o.xy.y=T>>0;h=false},c.animationSpeed?c.animationSpeed:250+Math.random()*500)}o.drawMarker(w,q,o.xy.x,o.xy.y,
s,x,J);o.isNew=false},drawMarker:function(w,q,s,x){w.beginPath();w.arc(s,x,4,0,Math.PI*2,false);w.fill();p(s-4,x-4,8,8)},hitTest:function(w,q){return w>=b&&w<=b+i&&q>=d&&q<=d+l},updateBounds:p});COG.observable(o);return o},gb=function(c){function p(){d.changed();d.trigger("markerUpdate",b)}function h(){var i=d.getParent();if(i&&i.syncXY)for(var l=b.length;l--;)i.syncXY([b[l].xy])}c=COG.extend({zindex:100,style:"basic"},c);var b=[],d=COG.extend(new Xa(c),{draw:function(i,l,o,w){for(var q=b.length;q--;)b[q].draw(i,
l,o,d,w)},add:function(i){if(i&&typeof i.length!=="undefined")for(var l=i.length;l--;){if(i[l])b[b.length]=i[l]}else if(i)b[b.length]=i;p()},clear:function(i){if(i)for(var l=0;l<b.length;l++)i(b[l])&&b.splice(l,1);else b=[];p()},each:function(i){if(i)for(var l=b.length;l--;)i(b[l])},find:function(i){for(var l=[],o=b.length;o--;)if(!i||i(b[o]))l[l.length]=b[o];return l}});d.bind("tap",function(i,l,o,w){var q=[],s=w.x;w=w.y;for(var x=b.length;x--;)if(b[x].hitTest(s,w))q[q.length]=b[x];if(q.length>0)i.cancel=
d.trigger("markerTap",l,o,q).cancel});d.bind("parentChange",h);d.bind("resync",h);d.bind("changed",h);return d},kb=function(c){function p(o,w,q){o.fillStyle="#FFFFFF";o.strokeStyle="#222222";o.beginPath();o.arc(q.x,q.y,4,0,Math.PI*2,false);o.stroke();o.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:$("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},c);var h=n.edges(c.path),b,d=null,i=0;COG.tweenValue(0,h.total,c.easing,function(){l.remove()},
c.duration).requestUpdates(function(o,w){i=o;w&&l.remove()});var l=COG.extend(new Xa(c),{cycle:function(){for(var o=0;o<h.accrued.length&&h.accrued[o]<i;)o++;d=null;if(o<c.path.length-1){var w=i-(o>0?h.accrued[o-1]:0),q=c.path[o];b=n.theta(q,c.path[o+1],h.edges[o]);d=n.extendBy(q,b,w)}return d},draw:function(o,w){if(d)(c.drawIndicator?c.drawIndicator:p)(o,w,n.init(d.x,d.y),b)}});return l},lb=function(c){c=COG.extend({style:null,properties:{}},c);return COG.extend(c,{rect:null,draw:function(){},resync:function(){}})},
ib=function(c,p){p=COG.extend({fill:false,simplify:false},p);var h=false,b=p.fill,d=p.simplify,i=$("ZOOM"),l=[],o=COG.extend(new lb(p),{draw:function(w,q,s,x,J,T){if(h){q=true;s=(T&i)!==0;w.beginPath();for(T=l.length;T--;){s=l[T].x;x=l[T].y;if(q){w.moveTo(s,x);q=false}else w.lineTo(s,x);s=true}if(s){b&&w.fill();w.stroke()}}},resync:function(w){o.xy=w.syncXY(c);l=n.floor(d?n.simplify(c):c)}});h=c&&c.length>=2;return o},mb=function(c){function p(i){for(var l=b.length;l--;)b[l].resync(i);b.sort(function(o,
w){var q=w.xy.y-o.xy.y;if(q===0)q=w.xy.x-o.xy.y;return q});d.changed()}function h(i,l){l.syncXY&&p(l)}c=COG.extend({zindex:80},c);var b=[],d=COG.extend(new Xa(c),{add:function(i){b[b.length]=i},each:function(i){for(var l=b.length;l--;)i(b[l])},draw:function(i,l,o){var w=l.x1,q=l.y1,s=l.width;l=l.height;for(var x=b.length;x--;){var J=b[x].style;J=J?Ua.apply(i,J):null;b[x].draw(i,w,q,s,l,o);J&&Ua.apply(i,J)}}});d.bind("parentChange",h);d.bind("resync",h);return d},pb=function(){return{tileSize:256,
init:function(c,p,h,b,d){return COG.extend({x:c,y:p,width:h,height:b},d)}}}(),nb=function(c){function p(O,Y,B,K){function S(){if(T.initTileCreator){o=true;T.initTileCreator(O,Y,B,K)}}T.prepTileCreator?T.prepTileCreator(O,Y,B,S):S()}function h(O,Y){for(var B=~~((O.x1-i.x)/w),K=~~((O.y1-i.y)/q),S=[],D=-l;D<x;D++)for(var ba=-l;ba<J;ba++){var da=s(B+D,K+ba);if(da)S[S.length]=da}Y&&Y(S);d=ya.copy(O)}c=COG.extend({tileWidth:256,tileHeight:256,relative:false,padding:2},c);var b=null,d=null,i=n.init(),l=
c.padding,o=false,w=c.tileWidth,q=c.tileHeight,s=null,x=0,J=0,T={bindToView:function(O){COG.info("initializing generator");b=O;T.trigger("bindView",O)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){s=null;o=false;d=null},run:function(O,Y){if(!d||Math.abs(O.x1-d.x1)>w||Math.abs(O.y1-d.y1)>q){if(!s&&!o||T.requireRefresh()){i=c.relative?n.init(O.x1,O.y1):n.init();x=Math.ceil(O.width/w)+l;J=Math.ceil(O.height/q)+l;p(w,q,T.getTileCreatorArgs?
T.getTileCreatorArgs(b):{},function(B){s=B;o=false;h(O,Y)})}s&&h(O,Y)}}};COG.observable(T);T.bind("update",function(){COG.info("captured generator update");d=null});return T},Na={ex:COG.extend,ticks:ia,getConfig:u,userMessage:function(c,p,h){Na.trigger("userMessage",c,p,h)},XY:n,XYRect:ya,Dimensions:Qa,Vector:ma,D:Qa,Images:Ja,Generator:Ya,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ua,viewState:$,View:jb,ViewLayer:Xa,ImageLayer:function(c,p){function h(q,s,x){for(s=
i.length;s--;){var J=i[s],T=J.x,O=J.y,Y=ya.init(J.x,J.y,J.x+J.width,J.y+J.height);if(x&&ya.intersect(q,Y)){Y=Ja.get(J.url,function(){w.changed()},o);x(Y,T,O,J.width,J.height)}}}function b(q){d&&d.run(q,function(s){i=[].concat(s);w.changed()})}p=COG.extend({imageLoadArgs:{}},p);var d=c?Ya.init(c,p):null,i=[],l=ya.init(),o=p.imageLoadArgs,w=COG.extend(new Xa(p),{changeGenerator:function(q,s){d=Ya.init(q,COG.extend({},p,s));d.bindToView(w.getParent());i=null;b(l)},clip:function(q,s,x){h(s,x,function(J,
T,O,Y,B){J&&q.rect(T,O,Y,B)})},cycle:function(q,s){b(s)},draw:function(q,s,x){h(s,x,function(J,T,O,Y,B){w.drawImage(q,J,T,O,Y,B,s,x)});l=ya.copy(s)},drawImage:function(q,s,x,J){s&&q.drawImage(s,x,J,s.width,s.height)}});w.bind("idle",function(){b(l)});w.bind("parentChange",function(q,s){d&&d.bindToView(s)});w.bind("tap",function(q,s,x,J){q=[];var T=J.x,O=J.y,Y,B;if(i)for(var K=i.length;K--;){Y=i[K];if(B=T>=Y.x&&T<=Y.x+Y.width&&O>=Y.y&&O<=Y.y+Y.height)q[q.length]=Y}q.length>0&&w.trigger("tapImage",
q,s,x,J)});return w},Marker:hb,ImageMarker:function(c){c=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},c);var p=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,h=COG.extend(new hb(c),{drawMarker:function(b,d,i,l){if((d=h.isAnimating()&&h.animatingImage?h.animatingImage:h.image)&&d.width>0){p||(p=n.init(-d.width>>1,-d.height>>1));var o=h.scale,w=i+~~(p.x*o),q=l+~~(p.y*o),s=~~(d.width*o),x=~~(d.height*o);h.updateBounds(w,
q,s,s);if(h.rotation||h.opacity!==1){b.save();try{b.globalAlpha=h.opacity;b.translate(i,l);b.rotate(h.rotation);b.drawImage(d,p.x*o,p.y*o,s,x)}finally{b.restore()}}else b.drawImage(d,w,q,s,x)}}});if(!h.image)h.image=Ja.get(c.imageUrl,function(b){h.image=b});if(!h.animatingImage)h.animatingImage=Ja.get(c.animatingImageUrl,function(b){h.animatingImage=b});return h},MarkerLayer:gb,PathLayer:function(c){c=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},c);var p=false,h=[],b=null,d=[],i=
null,l=0,o=[],w=COG.extend(new Xa(c),{getAnimation:function(q,s,x,J){var T="pathAnimation"+l++;o.push(T);return new kb({id:T,path:h,zindex:c.zindex+1,easing:q?q:COG.easing("sine.inout"),duration:s?s:5E3,drawIndicator:x,autoCenter:J?J:false})},cycle:function(q,s,x,J){return J},draw:function(q){var s,x=h.length;q.save();try{Ua.apply(q,c.style);if(x>0){q.beginPath();q.moveTo(h[x-1].x,h[x-1].y);for(s=x;s--;)q.lineTo(h[s].x,h[s].y);q.stroke();if(b){q.fillStyle=c.waypointFillStyle;for(s=b.length;s--;){q.beginPath();
q.arc(b[s].x,b[s].y,2,0,Math.PI*2,false);q.stroke();q.fill()}}}}finally{q.restore()}p=false},updateCoordinates:function(q,s){d=q;i=s;var x=w.getParent();if(x&&x.syncXY){x.syncXY(d);i&&x.syncXY(i);w.trigger("tidy")}}});w.bind("tidy",function(){h=n.simplify(d,c.pixelGeneralization);b=n.simplify(i,c.pixelGeneralization);p=true;w.changed()});return w},AnimatedPathLayer:kb,Shape:lb,Arc:function(c,p){p=COG.extend({size:4},p);var h=n.init(),b=COG.extend(p,{draw:function(d){d.beginPath();d.arc(h.x,h.y,b.size,
0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([c]);h=n.floor([c])[0]}});COG.info("created arc = ",c);return b},Poly:ib,ShapeLayer:mb,Tiling:pb,TileGenerator:nb};COG.observable(Na);var Oa=Na.Geo=function(){function c(g){g=parseFloat(g)*O;g=va(g);var e=B*g;return na((1+g)/(1-g)*W((1-e)/(1+e),B))/2}function p(g){return parseFloat(g)*O}function h(g){g=W(Math.E,-g);for(var e=f-2*xa(g),k=i(e,g),r=0;r<S&&t(e-k)>K;){e=k;k=i(e,g);r++}return k*Y}function b(g){return g%360*Y}function d(g,
e){var k=null;for(var r in engines)if(e){if(r==e&&engines[r][g]){k=engines[r];break}}else if(engines[r][g]){k=engines[r];break}return k}function i(g,e){var k=B*va(g);return f-2*xa(e*W((1-k)/(1+k),B/2))}function l(g,e,k,r){e=w(e);g.add(r.line(e,k));return e.length}function o(g,e,k,r){e=w(e);g.add(r.poly(e,k));return e.length}function w(g){var e=g?g.length:0,k=Array(e);for(e=e;e--;)k[e]=Oa.Position.init(g[e][1],g[e][0]);return Oa.Position.vectorize(k,Va)}function q(g,e,k){return new $a(g,e,k)}var s=
[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],x=-f,J=f,T=-ea,O=Math.PI/180,Y=180/Math.PI,B=0.08181919084262157,K=1.0E-7,S=12,D=null,ba={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},da=function(){function g(a){return a?k(a.lat,a.lon):null}function e(a){return!a||a.lat===0&&a.lon===0}function k(a,j){return{lat:parseFloat(a?a:0),lon:parseFloat(j?j:0)}}function r(a){if(a)if(typeof a.lat!=="undefined")return g(a);
else{if(a.split)for(var j=[" ",","],m=0;m<j.length;m++){var E=a.split(j[m]);if(E.length===2)return k(E[0],E[1])}}else return k();return null}return{calcDistance:function(a,j){if(e(a)||e(j))return 0;var m=(j.lat-a.lat)*O>>1,E=(j.lon-a.lon)*O>>1;m=va(m)*va(m)+pa(a.lat*O)*pa(j.lat*O)*va(E)*va(E);return 6371*2*Aa(V(m),V(1-m))},copy:g,empty:e,equal:function(a,j){return a&&j&&a.lat==j.lat&&a.lon==j.lon},fromMercatorPixels:function(a,j){return k(h(j),b(a))},generalize:function(a,j,m){var E=a.length,L=[],
ha=null;m||(m=250);m/=1E3;COG.info("generalizing positions, must include "+j.length+" positions");for(var la=E;la--;)if(la===0)L.unshift(a[la]);else{var aa=!ha||da.inArray(a[la],j)?m:da.calcDistance(ha,a[la]);if(a[la]&&aa>=m){L.unshift(a[la]);ha=a[la]}}COG.info("generalized "+E+" positions into "+L.length+" positions");return L},inArray:function(a,j){for(var m=da.equal,E=j.length;E--;)if(m(a,j[E]))return true;return false},inBounds:function(a,j){var m=!(da.empty(a)||da.empty(j));return m=(m=m&&a.lat>=
j.min.lat&&a.lat<=j.max.lat)&&a.lon>=j.min.lon&&a.lon<=j.max.lon},init:k,offset:function(a,j,m){var E=a.lat*O;a=a.lon*O;j=E+j/6371;m=Da(va(m/6371)/pa(E));m=a+m;j=(j+f)%Math.PI-f;m%=ea;return k(j*Y,m*Y)},parse:r,parseArray:function(a){var j=a.length,m=Array(j);for(j=j;j--;)m[j]=r(a[j]);return m},toMercatorPixels:function(a){return T5.XY.init(p(a.lon),c(a.lat))},toString:function(a){return a?a.lat+" "+a.lon:""},vectorize:function(a,j){var m=a.length,E=Array(m);j=COG.extend({chunkSize:500,async:true},
j);if(!j.async){for(var L=m;L--;)E[L]=T5.GeoXY.init(a[L]);return E}return COG.Loopage.join({frequency:10,execute:function(ha,la){for(var aa=0,Ma=j.chunkSize,Q=m;Q--;){E[Q]=T5.GeoXY.init(a[Q]);aa+=1;if(aa>Ma)break}m=Q;m<=0&&la.trigger("complete",E)}})}}}(),Ba=function(){function g(a,j,m){var E=T5.XY.init(0,j.lat-a.lat);if(typeof m==="undefined")m=true;E.x=m&&a.lon>j.lon?360-a.lon+j.lon:j.lon-a.lon;return E}function e(a,j){return Ba.init(da.init(a.min.lat-j,a.min.lon-j%360),da.init(a.max.lat+j,a.max.lon+
j%360))}function k(a){var j=g(a.min,a.max);return da.init(a.min.lat+(j.y>>1),a.min.lon+(j.x>>1))}function r(a,j){return{min:da.parse(a),max:da.parse(j)}}return{calcSize:g,createBoundsFromCenter:function(a,j){var m=j/6371,E=a.lat*O,L=a.lon*O,ha=E-m,la=E+m;if(ha>x&&la<J){E=Da(va(m)/pa(E));m=(L-E)%ea;L=(L+E)%ea}else{ha=A(ha,x);la=v(la,J);m=T;L=ea}return Ba.init(da.init(ha*Y,m*Y),da.init(la*Y,L*Y))},expand:e,forPositions:function(a,j){var m=null,E=T5.ticks();j||(j="auto");for(var L=a.length;L--;)if(m){var ha=
g(m.min,a[L],false),la=g(a[L],m.max,false);if(ha.x<0)m.min.lon=a[L].lon;if(ha.y<0)m.min.lat=a[L].lat;if(la.x<0)m.max.lon=a[L].lon;if(la.y<0)m.max.lat=a[L].lat}else m=r(a[L],a[L]);if(j){if(j=="auto"){L=g(m.min,m.max);j=A(L.x,L.y)*0.3}m=e(m,j)}COG.trace("calculated bounds for "+a.length+" positions",E);return m},getCenter:k,getGeoHash:function(a){var j=T5.Geo.GeoHash.encode(a.min.lat,a.min.lon);a=T5.Geo.GeoHash.encode(a.max.lat,a.max.lon);COG.info("min hash = "+j+", max hash = "+a)},getZoomLevel:function(a,
j){var m=k(a);m=v(za(t(m.lat)*0.05),s.length);var E=s[m],L=g(a.min,a.max);m=ceil(na(s[3]*j.height/L.y)/na(2));E=ceil(na(E*j.width/L.x)/na(2));return v(isNaN(m)?1E3:m,isNaN(E)?1E3:E)},init:r,isEmpty:function(a){return!a||da.empty(a.min)||da.empty(a.max)},toString:function(a){return"min: "+da.toString(a.min)+", max: "+da.toString(a.max)}}}(),ab=function(){var g=/^(\d+).*$/,e=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(k,r){g.lastIndex=-1;if(g.test(k))for(var a=k.replace(g,"$1"),j=r.split(","),
m=0;m<j.length;m++){e.lastIndex=-1;if(e.test(j[m])){var E=e.exec(j[m]);if(a>=parseInt(E[1],10)&&a<=parseInt(E[2],10))return true}else if(a==j[m])return true}return false},normalize:function(k){if(!k)return"";k=k.toUpperCase();if(!D){var r=[];for(var a in ba)r.push(a);D=RegExp("(\\s)("+r.join("|")+")(\\s|$)","i")}D.lastIndex=-1;if(r=D.exec(k))k=k.replace(D,"$1"+ba[r[2]]);return k},toString:function(k){return k.streetDetails+" "+k.location}}}(),Ca=Na.GeoXY=function(){function g(k,r){if(k.length){for(var a,
j,m,E,L=k.length;L--;){g(k[L],r);a=typeof a==="undefined"||k.x<a?k.x:a;j=typeof j==="undefined"||k.y<j?k.y:j;m=typeof m==="undefined"||k.x>m?k.x:m;E=typeof E==="undefined"||k.y>E?k.y:E}return ya.init(a,j,E,E)}else if(k.mercXY){a=k.mercXY;k.x=~~(a.x/r);k.y=~~((Math.PI-a.y)/r);k.rpp=r}else COG.warn("Attempted to sync an XY composite, not a GeoXY");return k}function e(k,r,a){k.pos=r;k.mercXY=da.toMercatorPixels(r);(a=typeof a!=="undefined"?a:k.rpp)&&g(k,a)}return{init:function(k,r){var a=n.init();e(a,
k,r);return a},sync:g,toPos:function(k,r){r=r?r:self.rpp;return da.fromMercatorPixels(k.x*r,Math.PI-k.y*r)},updatePos:e}}();Na.GeoVector=function(g){COG.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return Ca.init(g)};var Wa=function(){return{bestResults:function(g,e){e||(e=20);for(var k=g.length>0?g[0]:null,r=[],a=0;a<g.length;a++)if(k&&g[a]&&k.matchWeight-g[a].matchWeight<=e)r.push(g[a]);else break;return r}}}(),db=function(g){g=COG.extend({id:null,caption:"",
resultType:"",data:null,pos:null,matchWeight:0},g);return COG.extend(g,{toString:function(){return g.caption+(g.matchWeight?" ("+g.matchWeight+")":"")}})},eb=function(){var g={calculate:function(e){e=COG.extend({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},e);var k=T5.Geo.getEngine("route");k&&k.route(e,function(r){if(e.generalize)r.geometry=T5.Geo.Position.generalize(r.geometry,r.getInstructionPositions());if(e.map){g.createMapOverlay(e.map,r);e.autoFit&&
e.map.gotoBounds(r.boundingBox)}e.success&&e.success(r)})},createMapOverlay:function(e,k){var r=e.getDimensions();r=new T5.Geo.UI.RouteOverlay({data:k,width:r.width,height:r.height});e.setLayer("route",r)},parseTurnType:function(e){for(var k=g.TurnType.Unknown,r=T5.Geo.Routing.TurnTypeRules,a=0;a<r.length;a++){r[a].regex.lastIndex=-1;var j=r[a].regex.exec(e);if(j){k=r[a].customCheck?r[a].customCheck(e,j):r[a].turnType;break}}return k},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",
Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(e){var k=e=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},e),r=e.description;r=r.replace(/(\w)(\/)(\w)/g,
"$1 $2 $3");k.description=r;if(!e.turnType)e.turnType=g.parseTurnType(e.description);return e},RouteData:function(e){e=COG.extend({geometry:[],instructions:[],boundingBox:null},e);if(!e.boundingBox)e.boundingBox=T5.Geo.BoundingBox.forPositions(e.geometry);return COG.extend({getInstructionPositions:function(){for(var k=[],r=0;r<e.instructions.length;r++)e.instructions[r].position&&k.push(e.instructions[r].position);return k}},e)}};return g}(),Pa="featurecollection",cb="feature",Va={async:false},Ra=
{processor:null,group:"shapes",layerClass:mb},Za={point:COG.extend({},Ra,{processor:function(g,e,k,r){e=w([e.coordinates],Va);if(e.length>0)if(k=r.marker(e[0],k)){g.add(k);return e.length}},group:"markers",layerClass:gb}),linestring:COG.extend({},Ra,{processor:function(g,e,k,r){e=w(e&&e.coordinates?e.coordinates:[]);return l(g,e,k,r)}}),multilinestring:COG.extend({},Ra,{processor:function(g,e,k,r){e=e&&e.coordinates?e.coordinates:[];for(var a=0,j=e.length;j--;)a+=l(g,e[j],k,r);return a}}),polygon:COG.extend({},
Ra,{processor:function(g,e,k,r){e=e&&e.coordinates?e.coordinates:[];if(e.length>0)return o(g,e[0],k,r);return 0}}),multipolygon:COG.extend({},Ra,{processor:function(g,e,k,r){e=e&&e.coordinates?e.coordinates:[];for(var a=0,j=0;j<e.length;j++)a+=o(g,e[j][0],k,r);return a}})},$a=function(g,e,k,r){function a(Z,ga){var ka=Z.processor,qa=L+Z.group,Fa=COG.extend({},Z,k,{properties:ga.properties});if(ka){var Ka=Q[qa];if(!Ka){Ka=new Z.layerClass({id:qa});Q[qa]=Ka}globalLayers=Q;return ka(Ka,ga.data,Fa,r)}return 0}
function j(Z,ga){var ka=Z&&Z.type?Z.type.toLowerCase():null;return ka&&ka===cb?j(Z.geometry,Z.properties):{type:ka,isCollection:ka?ka===Pa:false,definition:Za[ka],data:Z,properties:ga?ga:Z.properties}}k=COG.extend({vectorsPerCycle:Oa.VECTORIZE_PER_CYCLE,rowPreParse:null,simplify:false,layerPrefix:"geojson-"},k);r=COG.extend({marker:function(Z){return new hb({xy:Z})},line:function(Z,ga){return new ib(Z,ga)},poly:function(Z,ga){return new ib(Z,COG.extend({fill:true},ga))}},r);var m=k.vectorsPerCycle,
E=k.rowPreParse,L=k.layerPrefix,ha=0,la=0,aa=null,Ma=0,Q={},P;if(!g)return null;if(typeof g.length==="undefined")g=[g];la=g.length;P=COG.Loopage.join({frequency:10,execute:function(Z,ga){var ka=0,qa=ha;if(!aa){for(;qa<la;qa++){var Fa=j(E?E(g[qa]):g[qa]),Ka=null;if(Fa.isCollection){Ma+=1;aa=q(Fa.data.features,function(bb){aa=null;for(var La in bb)Q[La]=bb[La]},{layerPrefix:L+Ma+"-"});Ka+=1}else if(Fa.definition)Ka=a(Fa.definition,Fa);ka+=Ka?Ka:1;if(ka>=m)break}ha=qa+1;!aa&&ha>=la&&ga.trigger("complete")}}});
P.bind("complete",function(){e&&e(Q)});return P};Na.GeoJSON={parse:q};Na.Map=function(g){function e(P){try{var Z=Oa.Position.init(P.coords.latitude,P.coords.longitude),ga=P.coords.accuracy/1E3;Q.trigger("locationUpdate",P,ga);if(la){if(!L){L=new Oa.UI.LocationOverlay({pos:Z,accuracy:ga});L.update(Q.getTileLayer());Q.setLayer("location",L)}var ka=Oa.BoundingBox.createBoundsFromCenter(Z,Math.max(ga,1));Q.gotoBounds(ka)}else{L.pos=Z;L.accuracy=ga;L.update(Q.getTileLayer());a(Z,null,COG.easing("sine.out"))}la=
false}catch(qa){COG.exception(qa)}}function k(P){COG.info("caught location tracking error:",P)}function r(P,Z,ga){Q.setZoomLevel(Z);Ja.cancelLoad();COG.endTweens();a(P,ga)}function a(P,Z,ga,ka){P=Ca.init(P,Oa.radsPerPixel(Q.getZoomLevel()));var qa=Q.getDimensions();Q.updateOffset(P.x-(qa.width>>1),P.y-(qa.height>>1),ga,ka,Z);Q.trigger("wake");Q.trigger("boundsChange",Q.getBoundingBox());Z&&typeof ga==="undefined"&&Z(Q)}g=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},
g);var j={NONE:0,SINGLE:1,WATCH:2},m=n.init(),E=j.NONE,L=null,ha=0,la=true,aa=0,Ma=g.tapExtent;g.adjustScaleFactor=function(P){return Math.pow(2,(P<1?Math.floor:Math.ceil)(Math.log(P)))};var Q=COG.extend(new jb(g),{getBoundingBox:function(){var P=Q.getViewRect();return Oa.BoundingBox.init(Ca.toPos(n.init(P.x1,P.y2),aa),Ca.toPos(n.init(P.x2,P.y1),aa))},getCenterPosition:function(){var P=Q.getViewRect();if(P){P=n.init(P.x1+(P.width>>1),P.y1+(P.height>>1));return Ca.toPos(P,aa)}return null},gotoBounds:function(P,
Z){var ga=Oa.BoundingBox.getZoomLevel(P,Q.getDimensions());r(Oa.BoundingBox.getCenter(P),ga,Z)},gotoPosition:r,panToPosition:a,syncXY:function(P){return Ca.sync(P,aa)},locate:function(){Q.trackStart(j.SINGLE);setTimeout(Q.trackCancel,1E4)},trackStart:function(P){if(navigator.geolocation&&!ha){E=P?P:j.WATCH;la=true;ha=navigator.geolocation.watchPosition(e,k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){ha&&navigator.geolocation&&navigator.geolocation.clearWatch(ha);
Q.removeLayer("location");L=null;E=j.NONE;ha=0},animateRoute:function(P,Z,ga,ka){var qa=Q.getLayer("route");if(qa)(P=qa.getAnimation(P,Z,ga,ka))&&P.addToView(Q)}});Q.bind("pan",function(){E===j.SINGLE&&Q.trackCancel()});Q.bind("tap",function(P,Z,ga,ka){var qa=Oa.radsPerPixel(Q.getZoomLevel());P=Ca.toPos(ka,qa);var Fa=Ca.toPos(n.offset(ka,-Ma,Ma),qa);ka=Ca.toPos(n.offset(ka,Ma,-Ma),qa);Q.trigger("geotap",Z,ga,P,Ba.init(Fa,ka))});Q.bind("idle",function(){var P=n.absSize(n.diff(m,Q.getOffset()));COG.info("idle detected, change delta = "+
P);if(P>g.boundsChangeThreshold){m=n.copy(Q.getOffset());Q.trigger("boundsChange",Q.getBoundingBox())}});H(Q,g);Q.bind("zoomLevelChange",function(P,Z){aa=Oa.radsPerPixel(Z);Q.triggerAll("resync",Q)});return Q};Na.MapTileGenerator=function(g){function e(j,m){var E=m>=a.minLevel&&(!a.maxLevel||m<=a.maxLevel);COG.info("new zoom level = "+m+", zoom ok = "+E);j.cancel=!E;if(E){k=m;a.reset()}}g=COG.extend({relative:true},g);var k=0,r=null,a=COG.extend(new nb(g),{minLevel:2,maxLevel:20,getTileCreatorArgs:function(j){r=
j.getCenterPosition();return{zoomLevel:k,position:r}},requireRefresh:function(){return!r}});a.bind("bindView",function(j,m){if(m.getZoomLevel){k=m.getZoomLevel();m.bind("zoomLevelChange",e)}});return a};Na.GeoPoly=function(g,e){e=COG.extend({autoParse:true},e);for(var k=Array(g.length),r=e.autoParse,a=T5.Geo.Position.parse,j=g.length;j--;)k[j]=T5.GeoXY.init(r?a(g[j]):g[j]);return new T5.Poly(k,e)};Na.RouteOverlay=function(g){g=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",
waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},g);var e=[],k=[],r=new T5.PathLayer(g);(function(){if(g.data&&g.data.instructions){for(var a=g.data.instructions,j=Array(a.length),m=a.length;m--;)j[m]=a[m].position;T5.Geo.Position.vectorize(j).bind("complete",function(E,L){k=L})}g.data&&g.data.geometry&&T5.Geo.Position.vectorize(g.data.geometry).bind("complete",function(E,L){e=L;r.updateCoordinates(e,k,true)})})();return r};Na.LocationOverlay=function(g){g=COG.extend({pos:null,accuracy:null,zindex:90},
g);var e=new Image,k=T5.XY.init(),r=T5.XY.init(),a=null;e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
e.onload=function(){k=T5.XY.init(e.width>>1,e.height>>1)};var j=COG.extend(new T5.ViewLayer(g),{pos:g.pos,accuracy:g.accuracy,drawAccuracyIndicator:false,draw:function(m,E){var L=r.x-E.x,ha=r.y-E.y;if(a){m.fillStyle="rgba(30, 30, 30, 0.2)";m.beginPath();m.arc(L,ha,a,0,Math.PI*2,false);m.fill()}e.complete&&e.width>0&&m.drawImage(e,L-k.x,ha-k.y,e.width,e.height);j.changed()},update:function(m){if(m){a=m.getPixelDistance(j.accuracy)>>1;r=m.getGridXYForPosition(j.pos);j.changed()}}});j.bind("gridUpdate",
function(m,E){j.update(E)});return j};return{distanceToString:function(g){if(g>1E3)return~~(g/10)/100+" km";return g?g+" m":""},dist2rad:function(g){return g/6371},getEngine:function(g){for(var e=null,k=1;!e&&k<arguments.length;k++)e=d(g,arguments[k]);e=e?e:d(g);if(!e)throw Error("Unable to find GEO engine with "+g+" capability");return e},lat2pix:c,lon2pix:p,pix2lat:h,pix2lon:b,radsPerPixel:function(g){return ea/(256<<g)},Position:da,BoundingBox:Ba,Radius:function(g,e){return{distance:parseInt(g,
10),uom:e}},Address:function(g){return g=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},g)},A:ab,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(g){if(!g.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var e=COG.extend({remove:function(){delete engines[e.id]}},g);return engines[e.id]=e},Search:Wa,GeoSearchResult:db,LocationSearch:function(g){function e(m,E){navigator.geolocation.clearWatch(r);
r=0;if(a){clearTimeout(a);a=0}E&&E([m],g)}function k(m){COG.info("caught location tracking error:",m)}g=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},g);var r=0,a=0,j=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(m,E){if(navigator.geolocation&&!r){r=navigator.geolocation.watchPosition(function(L){var ha=da.init(L.coords.latitude,L.coords.longitude);L=new db({id:1,caption:"Current Location",pos:ha,accuracy:L.coords.accuracy/1E3,matchWeight:100});
if(!j||L.accuracy<j.accuracy)j=L;if(!g.requiredAccuracy||j.accuracy<g.requiredAccuracy)e(j,E)},k,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)a=setTimeout(function(){j&&e(j,E)},g.searchTimeout)}}},g))},Routing:eb}}();return Na}();
