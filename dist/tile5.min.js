COG=function(){var g=/\$\{(.*?)\}/ig,k=Object.prototype.hasOwnProperty,h=0,e={id:"grunt.core",extend:function(){var b=arguments[0]||{},f=1,d=arguments.length,a=false,m,l,p,o;if(typeof b==="boolean"){a=b;b=arguments[1]||{};f=2}if(typeof b!=="object"&&!e.isFunction(b))b={};if(d===f){b=this;--f}for(;f<d;f++)if((m=arguments[f])!=null)for(l in m){p=b[l];o=m[l];if(b!==o)if(a&&o&&(e.isPlainObject(o)||e.isArray(o))){p=p&&(e.isPlainObject(p)||e.isArray(p))?p:e.isArray(o)?[]:{};b[l]=e.extend(a,p,o)}else if(o!==
undefined)b[l]=o}return b},isFunction:function(b){return toString.call(b)==="[object Function]"},isArray:function(b){return toString.call(b)==="[object Array]"},isPlainObject:function(b){if(!b||toString.call(b)!=="[object Object]"||b.nodeType||b.setInterval)return false;if(b.constructor&&!k.call(b,"constructor")&&!k.call(b.constructor.prototype,"isPrototypeOf"))return false;var f;for(f in b);return f===undefined||k.call(b,f)},isEmptyObject:function(b){for(var f in b)return false;return true},isXmlDocument:function(b){return toString.call(b)===
"[object Document]"},contains:function(b,f){var d=b,a=arguments,m=1;if(f&&e.isArray(f)){a=f;m=0}for(m=m;m<a;m++)d=d&&typeof foo[a[m]]!=="undefined";return d},newModule:function(b){b=e.extend({id:null,requires:[],parent:null},b);if(b.parent)b=e.extend({},b.parent,b);return b},toID:function(b){return b.replace(/\s/g,"-")},objId:function(b){return(b?b:"obj")+h++},formatStr:function(b){if(arguments.length<=1)return b;for(var f=arguments.length-2,d=0;d<=f;d++)b=b.replace(RegExp("\\{"+d+"\\}","gi"),arguments[d+
1]);return b},wordExists:function(b,f){var d="";if(f.toString)f=f.toString();for(var a=0;a<f.length;a++)d+=!/\w/.test(f[a])?"\\"+f[a]:f[a];return RegExp("(^|\\s|\\,)"+d+"(\\,|\\s|$)","i").test(b)},parseTemplate:function(b,f){for(var d=g.exec(b);d;){b=b.replace(d[0],COG.XPath.first(d[1],f));g.lastIndex=0;d=g.exec(b)}return b}};return e}();
COG.Log=function(){function g(f,d){var a,m=d&&d.length>0?d[0]:"";for(a=1;d&&a<d.length;a++)m+=" "+(h&&COG.isPlainObject(d[a])?JSON.stringify(d[a]):d[a]);typeof console!=="undefined"&&console[f](m);for(a=0;a<k.length;a++)k[a].call(b,m,f)}var k=[],h=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,b={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(f,d){if(e)console.markTimeline(f+(d?": "+(b.getTraceTicks()-d)+"ms":""))},debug:function(){g("debug",
arguments)},info:function(){g("info",arguments)},warn:function(){g("warn",arguments)},error:function(){g("error",arguments)},exception:function(f){b.error(arguments);for(var d in f)b.info("ERROR DETAIL: "+d+": "+f[d])},watch:function(f,d){try{d()}catch(a){b.exception(a,f)}},throwError:function(f){b.error(f);throw Error(f);},requestUpdates:function(f){k.push(f)}};return b}();
(function(){function g(e,b){e[b]||(e[b]=function(f){return e.configure(b,f)})}function k(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var h={};COG.paramTweaker=function(e,b,f){return function(d,a){if(typeof a!=="undefined"){if(d in e)e[d]=a;f&&d in f&&f[d](d,a)}else return b&&d in b?b[d](d):e[d]}};COG.configurable=function(e,b,f,d){if(e){e.gtConfId||k(e);var a=e.gtConfId,m=e.gtConfig,l=e.gtConfigFns;h[a]=e;l.push(f);for(f=b.length;f--;){m[b[f]]=true;d&&
g(e,b[f])}if(!e.configure)e.configure=function(p,o){if(m[p]){for(var n=l.length;n--;){var r=l[n](p,o);if(typeof r!=="undefined")return r}return h[a]}return null}}}})();
(function(){function g(k,h){var e=k.gtObsHandlers;e[h]||(e[h]=[]);return e[h]}COG.observable=function(k){if(k){if(!k.gtObsHandlers)k.gtObsHandlers={};if(!(k.bind||k.trigger||k.unbind)){k.bind=function(h,e){var b=COG.objId("callback");g(k,h).unshift({fn:e,id:b});return b};k.trigger=function(h){var e=g(k,h),b={cancel:false,tickCount:(new Date).getTime()},f;if(!e)return null;f=Array.prototype.slice.call(arguments,1);f.unshift(b);for(var d=e.length;d--&&!b.cancel;)e[d].fn.apply(self,f);return b};k.unbind=
function(h,e){for(var b=g(k,h),f=0;b&&f<b.length;f++)if(b[f].id===e){b.splice(f,1);break}return k}}}}})();(function(){var g={},k=[];COG.addPipe=function(h){h("pipe.test",{});k.push(h)};COG.listen=function(h,e){g[h]||(g[h]=[]);e&&g[h].push(e)};COG.say=function(h,e){var b;for(b=k.length;b--;)k[b](h,e);if(g[h])for(b=g[h].length;b--;)g[h][b](e)}})();
COG.Loopage=function(){function g(o){return COG.extend({id:f++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},o)}function k(o){a.push(o);h()}function h(){m&&clearTimeout(m);m=setTimeout(e,0);p=true}function e(){for(var o,n=(new Date).getTime(),r=d.length;a.length>0;){var B=a.shift();for(o=r;o--;)if(d[o].id===B){d.splice(o,1);break}p=true;r=d.length}if(p){l=b;for(o=r;o--;)l=d[o].frequency<l?d[o].frequency:l}for(o=r;o--;){B=n-d[o].lastTick;if(d[o].lastTick===0||B>=d[o].frequency){d[o].execute(n,
d[o]);d[o].lastTick=n;d[o].single&&d[o].trigger("complete")}}m=r?setTimeout(e,l):0}var b=6E4,f=0,d=[],a=[],m=0,l=b,p=true;return{join:function(o){var n=new g(o);if(n.after>0)n.lastTick=(new Date).getTime()+n.after;COG.observable(n);n.bind("complete",function(){k(n.id)});d.unshift(n);h();return n},leave:k}}();if(!this.JSON)this.JSON={};
(function(){function g(l){return l<10?"0"+l:l}function k(l){b.lastIndex=0;return b.test(l)?'"'+l.replace(b,function(p){var o=a[p];return typeof o==="string"?o:"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+l+'"'}function h(l,p){var o,n,r,B,s=f,y,u=p[l];if(u&&typeof u==="object"&&typeof u.toJSON==="function")u=u.toJSON(l);if(typeof m==="function")u=m.call(p,l,u);switch(typeof u){case "string":return k(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";f+=d;y=[];if(Object.prototype.toString.apply(u)==="[object Array]"){B=u.length;for(o=0;o<B;o+=1)y[o]=h(o,u)||"null";r=y.length===0?"[]":f?"[\n"+f+y.join(",\n"+f)+"\n"+s+"]":"["+y.join(",")+"]";f=s;return r}if(m&&typeof m==="object"){B=m.length;for(o=0;o<B;o+=1){n=m[o];if(typeof n==="string")if(r=h(n,u))y.push(k(n)+(f?": ":":")+r)}}else for(n in u)if(Object.hasOwnProperty.call(u,n))if(r=h(n,u))y.push(k(n)+(f?": ":":")+r);r=y.length===0?"{}":f?"{\n"+f+y.join(",\n"+f)+
"\n"+s+"}":"{"+y.join(",")+"}";f=s;return r}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+g(this.getUTCMonth()+1)+"-"+g(this.getUTCDate())+"T"+g(this.getUTCHours())+":"+g(this.getUTCMinutes())+":"+g(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,d,a={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;if(typeof JSON.stringify!=="function")JSON.stringify=function(l,p,o){var n;d=f="";if(typeof o==="number")for(n=0;n<o;n+=1)d+=" ";else if(typeof o==="string")d=o;if((m=p)&&typeof p!=="function"&&(typeof p!=="object"||typeof p.length!=="number"))throw Error("JSON.stringify");return h("",
{"":l})};if(typeof JSON.parse!=="function")JSON.parse=function(l,p){function o(r,B){var s,y,u=r[B];if(u&&typeof u==="object")for(s in u)if(Object.hasOwnProperty.call(u,s)){y=o(u,s);if(y!==undefined)u[s]=y;else delete u[s]}return p.call(r,B,u)}var n;l=String(l);e.lastIndex=0;if(e.test(l))l=l.replace(e,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){n=eval("("+l+")");return typeof p==="function"?o({"":n},""):n}throw new SyntaxError("JSON.parse");}})();
(function(){function g(h,e){var b=h.split("|"),f={};for(var d in e){var a=e[d];f[d]=b.length>a?b[a]:null}return f}var k={JSON:{parse:function(h){return JSON.parse(h)}},PDON:{parse:function(h){var e=null,b=[];h=h.split("\n");for(var f=0;f<h.length;f++){var d=h[f];if(e)b.push(g(d,e));else if(d){e=d.split("|");d={};for(var a=0;a<e.length;a++)d[e[a]]=a;e=d}else e=null}return b}}};COG.parseData=function(h,e){e=e?e.toUpperCase():"JSON";if(!k[e])throw Error("Unsupported data format: "+e);try{return k[e].parse(h)}catch(b){COG.Log.exception(b)}return{}}})();
COG.XPath=function(){function g(b){for(var f=null,d=0;d<k.length;d++)if(f=k[d](b))break;return f}var k=[],h=[null,function(b){return b.numberValue},function(b){return b.stringValue},function(b){return b.booleanValue},null,null,null,null,function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null},function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(b){return{toString:function(){var f=
null;if(b){var d=null;if(b.resultType>=0&&b.resultType<h.length)d=h[b.resultType];if(d)f=d(b)}return f?f:""}}},first:function(b,f){var d=e.SearchResult,a;var m=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!m)m=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(f))a=f.evaluate(b,f,g,m,null);else{COG.Log.warn("attempted xpath expression: "+b+" on a non-xml document");a=null}}catch(l){COG.Log.warn("invalid xpath expression: "+b+" on node: "+f);a=null}return new d(a)},registerResolver:function(b){k.push(b)}};return e}();
COG.Storage=function(){function g(k){if(k&&k=="session")return sessionStorage;return localStorage}return{get:function(k,h){var e=g(h).getItem(k);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(k,h,e){h=jQuery.isArray(h)||jQuery.isPlainObject(h)?JSON.stringify(h):h;g(e).setItem(k,h)},remove:function(k,h){g(h).removeItem(k)}}}();
COG.ParseRules=function(){var g=[];return{add:function(k,h){g.push({regex:k,handler:h})},each:function(k,h,e){function b(){f++;e&&f>=g.length&&e(h)}for(var f=0,d=0;d<g.length;d++){var a=g[d].regex,m=g[d].handler,l=false;if(a){a.lastIndex=-1;if((a=a.exec(k))&&m){l=true;m(a,h,b)&&b()}}l||b()}}}};
(function(){function g(a){var m=[],l=function(o,n){n=COG.isFunction(n)?n():n;m[m.length]=encodeURIComponent(o)+"="+encodeURIComponent(n)};if(COG.isArray(a))for(var p=0;p<a.length;p++)l(a[p].name,a[p].value);else for(p in a)l(p,a[p]);return m.join("&").replace(/%20/g,"+")}var k={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},h={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],b=/^(\w+:)?\/\/([^\/?#]+)/,f={XML:function(a){return a.responseXML},JSON:function(a){return COG.parseData(a.responseText)},
PDON:function(a){return COG.parseData(a.responseText,"PDON")},DEFAULT:function(a){return a.responseText}},d={CONTENT_TYPE:"Content-Type"};COG.xhr=function(a){function m(){if(this.readyState===4){var n=null,r=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(r)if(a.handleResponse)a.handleResponse(this);else{var B=a,s=this.getResponseHeader(d.CONTENT_TYPE),y,u=false;for(y in k)if(s&&s.indexOf(k[y])>=0){u=true;
break}s=!u;for(u=0;u<e.length;u++)s=s||e[u]==y;if(s)b:{s=y;for(var F in h)for(u=0;u<h[F].length;u++)if(RegExp(h[F][u]+"$","i").test(B.url)){y=F;break b}y=s?s:"DEFAULT"}try{n=f[y](this,B)}catch(J){n=f.DEFAULT(this,B)}}else a.error&&a.error(this)}catch(M){COG.Log.exception(M,"PROCESSING AJAX RESPONSE")}r&&n&&a.success&&a.success.call(this,n)}}try{a=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},a);var l=
b.exec(a.url),p=l&&(l[1]&&l[1]!==location.protocol||l[2]!==location.host);if(a.data)a.method="POST";if(a.url){l=null;if(a.xhr)l=a.xhr(a);l||(l=new XMLHttpRequest);l.open(a.method,a.url,a.async);a.data&&l.setRequestHeader("Content-Type",a.contentType);p||l.setRequestHeader("X-Requested-With","XMLHttpRequest");l.onreadystatechange=m;l.send(a.method=="POST"?g(a.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(o){COG.Log.exception(o)}}})();
(function(){function g(b){var f=document.createElement("script"),d=false;f.src=b;f.async=true;f.onload=f.onreadystatechange=function(){if(!d&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){d=true;f.onload=f.onreadystatechange=null;f&&f.parentNode&&f.parentNode.removeChild(f)}};h||(h=document.getElementsByTagName("head")[0]);h.appendChild(f)}var k=0,h,e=this;COG.jsonp=function(b,f,d){b+=b.indexOf("?")>=0?"&":"?";var a="json"+ ++k;e[a]=function(m){f(m);e[a]=null;try{delete e[a]}catch(l){}};
g(b+(d?d:"callback")+"="+a);return a}})();
COG.Touch=function(){function g(t,q){return{x:t.x-q.x,y:t.y-q.y}}function k(t,q){var z=g(t,q);return Math.sqrt(z.x*z.x+z.y*z.y)}function h(t){if(t.count>1)return k(t.touches[0],t.touches[1]);return 0}function e(t,q){var z=t&&t.count>0?t.touches[0]:null;if(z&&q&&q.count>0)return g(z,q.touches[0]);return null}function b(t,q){t.count=q.count;for(var z=l;z--;){t.touches[z].x=q.touches[z].x;t.touches[z].y=q.touches[z].y}}function f(){for(var t={count:0,touches:Array(l)},q=l;q--;)t.touches[q]=m();return t}
function d(t){if(t.preventDefault){t.preventDefault();t.stopPropagation()}else t.cancelBubble&&t.cancelBubble()}function a(t,q,z){if(v){q=q[z?z:"touches"];z=q.length;for(z=t.count=z;z--;){t.touches[z].x=q[z].pageX;t.touches[z].y=q[z].pageY}}else if(q.button===0){t.count=1;t.touches[0].x=q.pageX?q.pageX:q.screenX;t.touches[0].y=q.pageY?q.pageY:q.screenY}else t.count=0}function m(t,q){return{x:t?t:0,y:q?q:0}}var l=10,p=120,o=100,n=250,r=300,B=5,s=0,y=1,u=2,F=7,J=0,M=0,v=undefined,x=function(t){function q(E,
w,C,I){var L=Math.asin((E.y-w.y)/C);C=C*(na/I)>>0;C=C>ja?ja:C;L=w.x>E.x?L:Math.PI-L;H("pan",Math.cos(L)*-C,Math.sin(L)*C,true)}function z(E,w){var C,I;if(v){C=w-ha;if(C<n){I=k(P.touches[0],E);I>t.inertiaTrigger&&q(P.touches[0],E,I,C)}}else{X.x=E.x;X.y=E.y;COG.Loopage.join({execute:function(L,Q){C=L-w;I=k(E,X);if(C<o&&I>t.inertiaTrigger){Q.trigger("complete");q(E,X,I,C)}else C>o&&Q.trigger("complete")},frequency:10})}}function D(E){var w=0,C=0;if(E.offsetParent){do{w+=E.offsetLeft;C+=E.offsetTop;E=
E.offsetParent}while(E)}return m(w,C)}function G(E){var w=E.count,C=Array(w),I=D(V);for(w=w;w--;)C[w]=m(E.touches[w].x-I.x,E.touches[w].y-I.y);return C}function H(){oa&&oa.trigger.apply(null,arguments)}function K(E){var w=E.target?E.target:E.srcElement;if(ka||w&&w===V){a(P,E);if(P.count!==0){ca=null;da.x=0;da.y=0;la=true;T=false;ha=(new Date).getTime();d(E);w.style.cursor="move";H("inertiaCancel");ma=ha;if(E=P.count>0?P.touches[0]:null){H("touchStart",E.x,E.y);if(ma-ia<r)if((E=g(P.touches[0],Z.touches[0]))&&
Math.abs(E.x)<t.maxDistDoubleTap&&Math.abs(E.y)<t.maxDistDoubleTap)T=true;N=s;b(Z,P)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function R(E){var w=E.target?E.target:E.srcElement,C=0;if(ka||w&&w===V){a(U,E);if(U.count>0){X.x=U.touches[0].x;X.y=U.touches[0].y}if(la){v&&d(E);if(U.count>1){P.count===1&&b(P,U);C=h(P)-h(U)}if(N===s)if((E=e(U,P))&&(Math.abs(E.x)>=F||Math.abs(E.y)>=F))N=y;if(N!==s)if(!C||Math.abs(C)<B){if(ca=e(U,Z)){da.x-=ca.x;da.y-=ca.y;ea.x-=ca.x;ea.y-=ca.y}H("pan",
ea.x,ea.y);ea.x=0;ea.y=0;N=y}else{H("pinchZoom",G(P),G(U));N=u}b(Z,U)}}}function O(E){var w=E.target?E.target:E.srcElement;if(la&&(ka||w&&w===V)){a($,E,"changedTouches");var C=$.touches[0];v&&d(E);E=(new Date).getTime();ia=ma;if(N===s)Y||(Y=setTimeout(function(){Y=0;var I=T?"doubleTap":"tap",L=P.touches[0],Q=D(V);Q=m(L.x-Q.x,L.y-Q.y);H(I,L,Q)},r+50));else if(N==y){H("panEnd",da.x,da.y);pa&&z(C,E)}else N==u&&H("pinchZoomEnd",G(P),G(Z),E-ha);w.style.cursor="default";la=false}}function S(E){var w=E.target?
E.target:E.srcElement;if(ka||w&&w===V){if(E.detail){w=-E.detail*p;w=m(E.axis===1?w:0,E.axis===2?w:0)}else w=m(E.wheelDeltaX,E.wheelDeltaY);var C=w.y!==0?Math.abs(w.y/p):0;if(X&&C!==0){var I=m(X.x-V.offsetLeft,X.y-V.offsetTop);H("wheelZoom",I,Math.pow(2,w.y>0?C:-C))}d(E)}}t=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},
t);var T=false,Y=0,W=T5.getConfig(),P=f(),U=f(),Z=f(),$=f(),ca=null,da=m(),ea=m(),N=null,la=false,ha=0,fa=[],X=m(),pa=false,na,ja,ma=0,ia=0,V=t.element,oa=t.observable,ka=typeof FlashCanvas!=="undefined",ra={supportsTouch:v,addListeners:function(E){fa.push(E)},decoupleListeners:function(E){for(var w=0;E&&w<fa.length;w++)if(fa[w].listenerId===E){fa.splice(w,1);break}},release:function(){W.unbindEvent(v?"touchstart":"mousedown",K,false);W.unbindEvent(v?"touchmove":"mousemove",R,false);W.unbindEvent(v?
"touchend":"mouseup",O,false);if(!v){window.removeEventListener("mousewheel",S,false);window.removeEventListener("DOMMouseScroll",S,false)}},inertiaEnable:function(E,w){pa=true;na=E;ja=w?Math.min(w.width,w.height):500},inertiaDisable:function(){pa=false}};if(typeof v==="undefined")v=T5.getConfig().supportsTouch;W.bindEvent(v?"touchstart":"mousedown",K,false);W.bindEvent(v?"touchmove":"mousemove",R,false);W.bindEvent(v?"touchend":"mouseup",O,false);if(!v){W.bindEvent("mousewheel",S,window);W.bindEvent("DOMMouseScroll",
S,window)}return ra},A=[];return{capture:function(t,q){if(!t)throw Error("Unable to capture touch of null element");if(!t.id)t.id="touchable_"+J++;var z=A[t.id];if(!z){z=new x(COG.extend({element:t},q));A[t.id]=z}if(q){q.listenerId&&z.decoupleListeners(q.listenerId);q.listenerId=++M;z.addListeners(q)}return z},release:function(t){if(t&&t.id&&A[t.id]){A[t.id].release();delete A[t.id]}}}}();
T5=function(){var g=function(d,a){return{x:d?d:0,y:a?a:0}},k=function(){function d(a,m){if(!m)m=a.length;if(m<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var l={edges:Array(m-1),accrued:Array(m-1),total:0},p=k.diff,o=0;o<m-1;o++){var n=p(a[o],a[o+1]);l.edges[o]=Math.sqrt(n.x*n.x+n.y*n.y);l.accrued[o]=l.total+l.edges[o];l.total+=l.edges[o]}return l}return{VECTOR_SIMPLIFICATION:4,create:function(a,m){return new g(a,m)},add:function(){for(var a=new g,m=
arguments.length;m--;){a.x+=arguments[m].x;a.y+=arguments[m].y}return a},absSize:function(a){return Math.max(Math.abs(a.x),Math.abs(a.y))},diff:function(a,m){return new g(a.x-m.x,a.y-m.y)},copy:function(a){return a?new g(a.x,a.y):null},invert:function(a){return new g(-a.x,-a.y)},offset:function(a,m,l){return new g(a.x+m,a.y+(l?l:m))},edges:d,distance:function(a,m){return d(a,m).total},simplify:function(a,m){if(!a)return null;m=m?m:k.VECTOR_SIMPLIFICATION;for(var l=[],p=null,o=a.length;o--;){var n=
a[o];if(include=!p||o===0||Math.abs(n.x-p.x)+Math.abs(n.y-p.y)>m){l.unshift(n);p=n}}return l},theta:function(a,m,l){l=Math.asin((a.y-m.y)/l);return a.x>m.x?l:Math.PI-l},pointOnEdge:function(a,m,l,p){m=new g(Math.cos(l)*p,Math.sin(l)*p);return new g(a.x-m.x,a.y-m.y)},getRect:function(a){var m=a.length;if(m>1)return new h(Math.min(a[0].x,a[m-1].x),Math.min(a[0].y,a[m-1].y),Math.abs(a[0].x-a[m-1].x),Math.abs(a[0].y-a[m-1].y))},toString:function(a){return a.x+", "+a.y}}}(),h=function(d,a,m,l){return{origin:new g(d,
a),dimensions:new b(m,l),invalid:false}},e=function(){return{bottomRight:function(d){return k.offset(d.origin,d.dimensions.width,d.dimensions.height)},empty:function(){return new h(0,0,0,0)},copy:function(d){return d?new h(d.origin.x,d.origin.y,d.dimensions.width,d.dimensions.height):null},getCenter:function(d){return new g(d.origin.x+d.dimensions.width/2,d.origin.y+d.dimensions.height/2)},isEmpty:function(d){return d.dimensions.width===0||d.dimensions.height===0},union:function(){if(!(arguments.length<
2)){for(var d=arguments[0].origin.y,a=arguments[0].origin.x,m=d+arguments[0].dimensions.height,l=a+arguments[0].dimensions.width,p=Array.prototype.slice.call(arguments,1),o=p.length;o--;){var n=p[o].origin.y,r=p[o].origin.x,B=n+p[o].dimensions.height,s=r+p[o].dimensions.width;d=d<n?d:n;a=a<r?a:r;m=m>B?m:B;l=l>s?l:s}arguments[0].origin.x=a;arguments[0].origin.y=d;arguments[0].dimensions.width=l-a;arguments[0].dimensions.height=m-d}}}}(),b=function(d,a){return{width:d?d:0,height:a?a:0}},f=function(){return{getAspectRatio:function(d){return d.height!==
0?d.width/d.height:1},getCenter:function(d){return new g(d.width/2,d.height/2)},getSize:function(d){return Math.sqrt(Math.pow(d.width,2)+Math.pow(d.height,2))}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},Vector:g,V:k,Dimensions:b,D:f,Rect:h,R:e}}();
(function(){function g(){for(;B.length>0;){var y=B.shift();document.location=y}r=0}function k(y){for(var u=true,F=s.length;F--;)u=u&&y!=s[F];return u}function h(y,u){var F=[];for(var J in u)J&&F.push(J+"="+escape(u[J]));return"tile5://"+y+"/"+(F.length>0?"?"+F.join("&"):"")}function e(y,u){k(y)&&COG.Log.info("would push url: "+h(y,u))}function b(y,u){if(k(y)){B.push(h(y,u));r||(r=setTimeout(g,100))}}function f(y){return function(u,F,J){(J?J:y?document.body:document).addEventListener(u,F,false)}}function d(y){return function(u,
F,J){(J?J:y?document.body:document).removeEventListener(u,F,false)}}function a(y,u,F){(F?F:document).attachEvent("on"+y,u)}function m(y,u,F){(F?F:document).detachEvent("on"+y,u)}function l(){p={base:{name:"Unknown",bindEvent:f(),unbindEvent:d(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:a,unbindEvent:m,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:b,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:b},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:b},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:f(true),unbindEvent:d(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:b},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:b}};o=[p.froyo,p.android,p.ipod,p.iphone,p.ipad,p.ie]}var p=null,o=[],n=null,r=0,B=[],s=["view.wake","tile.loaded"];T5.getConfig=function(){p||l();if(!n){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var y=0;y<o.length;y++){var u=o[y];if(u.regex&&u.regex.test(navigator.userAgent)){n=T5.ex({},p.base,u);COG.Log.info("PLATFORM DETECTED AS: "+n.name);break}}if(!n){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
n=p.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return n}})();
T5.Dispatcher=function(){var g=[],k={execute:function(h){var e=k.findAction(h);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(h){for(var e=g.length;e--;)if(g[e].id==h)return g[e];return null},getRegisteredActions:function(){return[].concat(g)},getRegisteredActionIds:function(){for(var h=[],e=g.length;e--;)g[e].id&&h.push(g[e].id);return h},registerAction:function(h){h&&h.id&&g.push(h)},Action:function(h){h=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},h);var e={id:h.id,execute:function(){h.execute&&h.execute.apply(this,arguments)},getParam:function(b){return h[b]?h[b]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,h.title,h.icon)}};h.autoRegister&&k.registerAction(e);return e},Agent:function(h){h=COG.extend({name:"Untitled",translator:null,execute:null},h);var e={getName:function(){return h.name},getParam:function(b){return h[b]},getId:function(){return COG.toID(e.getName())},run:function(b,f){if(h.execute){var d=
h.translator?h.translator(b):b;h.execute.call(e,d,function(a,m){f&&f(a,m,d)})}}};return e},runAgents:function(h,e,b){for(var f=0;f<h.length;f++)h[f].run(e,b)}};return k}();
T5.Resources=function(){var g="",k={},h={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:g+e},setBasePath:function(e){g=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var b=function(f){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(f)})};e.cacheable&&k[e.filename]?b(k[e.filename]):COG.xhr({url:h.getPath(e.filename),dataType:e.dataType,success:function(f){if(e.cacheable)k[e.filename]=f;b(f)},error:function(f,d,a){COG.Log.error("error loading resource ["+
e.filename+"], error = "+a)}})},loadSnippet:function(e,b){/\.\w+$/.test(e)||(e+=".html");h.loadResource({filename:"snippets/"+e,callback:b,dataType:"html"})}};return h}();
T5.Images=function(){function g(s,y){var u=document.createElement("canvas");u.width=s?s:0;u.height=y?y:0;if(typeof FlashCanvas!=="undefined"){u.id="tmpCanvas"+f++;u.style.cssText="position: absolute; top: -"+(y-1)+"px; left: -"+(s-1)+"px;";document.body.appendChild(u);FlashCanvas.initElement(u)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(u);return u}function k(){var s=d[this.id];if(s&&s.image.complete&&s.image.width>0){s.loaded=true;s.hitCount=1;for(var y=l.length;y--;)if(l[y].image.src==
this.src){l.splice(y,1);break}if(s.background||s.postProcess||s.drawBackground||s.customDraw)if(s.image){y=g(s.realSize?s.realSize.width:image.width,s.realSize?s.realSize.height:image.height);var u=y.getContext("2d"),F=s.offset?s.offset:new T5.Vector;s.background&&u.drawImage(s.background,0,0);s.drawBackground&&s.drawBackground(u);s.customDraw?s.customDraw(u,s):u.drawImage(s.image,F.x,F.y);s.postProcess&&s.postProcess(u,s);s.image=y}s.loadCallback&&s.loadCallback(this,false);p[p.length]={url:this.src,
created:s.requested};delete d[this.id];h()}}function h(){if(!n){var s=T5.getConfig().maxImageLoads;n=COG.Loopage.join({execute:function(y,u){if(!s||l.length<s){var F=m.shift();if(F){l[l.length]=F;F.image.onload=k;F.image.src=T5.Resources.getPath(F.url);F.requested=T5.ticks()}else u.trigger("complete")}},frequency:10});n.bind("complete",function(){n=null})}}function e(){r=true;try{var s=p.length/2>>0;if(s>0){p.sort(function(u,F){return u.created-F.created});for(var y=s;y--;)delete b[p[y].url];p.splice(0,
s)}}finally{r=false}COG.say("imagecache.cleared")}var b={},f=0,d={},a=0,m=[],l=[],p=[],o=0,n=null,r=false,B={avgImageSize:25,loadTimeout:10,cancelLoad:function(){l=[]},get:function(s){var y=null,u=null;r||(y=b[s]);if((u=y?y.image:null)&&(u.getContext||u.complete&&u.width>0))return u},load:function(s,y,u){var F=b[s];if(F){F.hitCount++;F.image.complete&&y&&y(F.image,true)}else{F=T5.ex({url:s,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,loadCallback:y},u);F.image.id="resourceLoaderImage"+
a++;b[s]=F;d[F.image.id]=F;m[m.length]=F;h()}return F},newCanvas:g,stats:function(){return{imageLoadingCount:l.length,queuedImageCount:m.length,imageCacheFullness:o}}};COG.Loopage.join({execute:function(s){for(var y=false,u=0,F=T5.getConfig();u<l.length;)if(s-l[u].requested>B.loadTimeout*1E3){l.splice(u,1);y=true}else u++;y&&h();if(F&&F.imageCacheMaxSize){o=p.length*B.avgImageSize/F.imageCacheMaxSize;o>=1&&e()}},frequency:2E4});return B}();
T5.TimeLord=function(){var g=/^P(\d+Y)?(\d+M)?(\d+D)?$/,k=/^(\d+H)?(\d+M)?(\d+S)?$/,h=function(b,f){return{days:b?b:0,seconds:f?f:0}},e={8601:function(b){b=b.split("T");var f=null;f=null;var d=0,a=0;g.lastIndex=-1;f=g.exec(b[0]);d+=f[3]?parseInt(f[3].slice(0,-1),10):0;k.lastIndex=-1;f=k.exec(b[1]);a+=f[1]?parseInt(f[1].slice(0,-1),10)*3600:0;a+=f[2]?parseInt(f[2].slice(0,-1),10)*60:0;a+=f[3]?parseInt(f[3].slice(0,-1),10):0;return new h(d,a)}};return{Duration:h,addDuration:function(){for(var b=new h,
f=arguments.length;f--;){b.days+=arguments[f].days;b.seconds+=arguments[f].seconds}if(b.seconds>=86400){b.days+=~~(b.seconds/86400);b.seconds%=86400}return b},parseDuration:function(b,f){var d=f?e[f]:null;if(d)return d(b);COG.Log.warn("Could not find duration parser for specified format: "+f);return new h},formatDuration:function(b){var f,d,a="";if(b.days)a=b.days+" days ";if(b.seconds){b=b.seconds;if(b>=3600){f=~~(b/3600);b-=f*3600}if(b>=60){d=Math.round(b/60);b-=d*60}if(f)a=a+f+(f>1?" hrs ":" hr ")+
(d?(d>10?d:"0"+d)+" min ":"");else if(d)a=a+d+" min";else if(b>0)a=a+(b>10?b:"0"+b)+" sec"}return a}}}();
(function(){var g=Math.PI*2,k=Math.PI/2,h=Math.abs,e=Math.pow,b=Math.sin,f=Math.asin,d=Math.cos,a=1.70158,m={linear:function(l,p,o,n){return o*l/n+p},backin:function(l,p,o,n){return o*(l/=n)*l*((a+1)*l-a)+p},backout:function(l,p,o,n){return o*((l=l/n-1)*l*((a+1)*l+a)+1)+p},backinout:function(l,p,o,n){return(l/=n/2)<1?o/2*l*l*(((a*=1.525)+1)*l-a)+p:o/2*((l-=2)*l*(((a*=1.525)+1)*l+a)+2)+p},bouncein:function(l,p,o,n){return o-m.bounceout(n-l,0,o,n)+p},bounceout:function(l,p,o,n){return(l/=n)<1/2.75?
o*7.5625*l*l+p:l<2/2.75?o*(7.5625*(l-=1.5/2.75)*l+0.75)+p:l<2.5/2.75?o*(7.5625*(l-=2.25/2.75)*l+0.9375)+p:o*(7.5625*(l-=2.625/2.75)*l+0.984375)+p},bounceinout:function(l,p,o,n){return l<n/2?m.bouncein(l*2,0,o,n)/2+p:m.bounceout(l*2-n,0,o,n)/2+o/2+p},cubicin:function(l,p,o,n){return o*(l/=n)*l*l+p},cubicout:function(l,p,o,n){return o*((l=l/n-1)*l*l+1)+p},cubicinout:function(l,p,o,n){if((l/=n/2)<1)return o/2*l*l*l+p;return o/2*((l-=2)*l*l+2)+p},elasticin:function(l,p,o,n,r,B){if(l==0)return p;if((l/=
n)==1)return p+o;B||(B=n*0.3);if(!r||r<h(o)){r=o;o=B/4}else o=B/g*f(o/r);return-(r*e(2,10*(l-=1))*b((l*n-o)*g/B))+p},elasticout:function(l,p,o,n,r,B){var s;if(l==0)return p;if((l/=n)==1)return p+o;B||(B=n*0.3);if(!r||r<h(o)){r=o;s=B/4}else s=B/g*f(o/r);return r*e(2,-10*l)*b((l*n-s)*g/B)+o+p},elasticinout:function(l,p,o,n,r,B){var s;if(l==0)return p;if((l/=n/2)==2)return p+o;B||(B=n*0.3*1.5);if(!r||r<h(o)){r=o;s=B/4}else s=B/g*f(o/r);if(l<1)return-0.5*r*e(2,10*(l-=1))*b((l*n-s)*g/B)+p;return r*e(2,
-10*(l-=1))*b((l*n-s)*g/B)*0.5+o+p},quadin:function(l,p,o,n){return o*(l/=n)*l+p},quadout:function(l,p,o,n){return-o*(l/=n)*(l-2)+p},quadinout:function(l,p,o,n){if((l/=n/2)<1)return o/2*l*l+p;return-o/2*(--l*(l-2)-1)+p},sinein:function(l,p,o,n){return-o*d(l/n*k)+o+p},sineout:function(l,p,o,n){return o*b(l/n*k)+p},sineinout:function(l,p,o,n){return-o/2*(d(Math.PI*l/n)-1)+p}};T5.easing=function(l){return m[l.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(l,p){m[l.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=p}})();
T5.Tween=function(g){g=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},g);var k=T5.ticks(),h=[],e=false,b=0,f=0,d={cancelOnInteract:g.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(a){g.complete&&g.complete(a)},update:function(a){try{var m=g.tweenFn(a-k,b,f,g.duration);if(g.target)g.target[g.property]=m;for(var l=h.length;l--;)h[l](m,void 0);if(e=k+g.duration<=a){if(g.target)g.target[g.property]=
g.tweenFn(g.duration,b,f,g.duration);for(var p=h.length;p--;)h[p](m,true)}}catch(o){COG.Log.exception(o)}},requestUpdates:function(a){h.push(a)}};b=g.target&&g.property&&g.target[g.property]?g.target[g.property]:g.startValue;if(typeof g.endValue!=="undefined")f=g.endValue-b;if(f==0)e=true;T5.wakeTweens();return d};
(function(){function g(b){if(e)return k.length;e=true;try{for(var f=0;f<k.length;)if(k[f].isComplete()){k[f].triggerComplete(false);k.splice(f,1)}else{k[f].update(b);f++}}finally{e=false}k.length===0&&h.trigger("complete");return k.length}var k=[],h=null,e=false;T5.tweenValue=function(b,f,d,a,m){b=new T5.Tween({startValue:b,endValue:f,tweenFn:d,complete:a,duration:m});k.push(b);return b};T5.tween=function(b,f,d,a,m,l){b=new T5.Tween({target:b,property:f,endValue:d,tweenFn:a,duration:l,complete:m});
k.push(b);return b};T5.tweenVector=function(b,f,d,a,m,l){var p=[];if(b){var o=b.x==f,n=b.y==d;o||p.push(T5.tween(b,"x",f,a,function(){(o=true)&&n&&m()},l));n||p.push(T5.tween(b,"y",d,a,function(){n=true;o&&n&&m()},l))}return p};T5.cancelAnimation=function(b){if(!e){e=true;try{for(var f=0;f<k.length;)if(!b||b(k[f])){k[f].triggerComplete(true);k.splice(f,1)}else f++}finally{e=false}}};T5.isTweening=function(){return k.length>0};T5.wakeTweens=function(){if(!h){h=COG.Loopage.join({execute:g,frequency:20});
h.bind("complete",function(){h=null})}}})();(function(){var g={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,PINCH:16,FREEZE:128};T5.viewState=function(){for(var k=0,h=arguments.length;h--;){var e=g[arguments[h].toUpperCase()];if(e)k|=e}return k}})();
T5.ViewLayer=function(g){g=T5.ex({id:"",zindex:0,supportFastDraw:false,transparent:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","PINCH")},g);var k=null,h=false,e=g.supportFastDraw,b=g.id,f=T5.viewState("ACTIVE"),d=g.validStates,a=0,m=0,l=g.transparent,p=T5.ex({addToView:function(o){o.setLayer(b,p)},shouldDraw:function(o,n,r){if((o=(o&d)!==0&&(h?e:true))&&l)if(o=r||a!==n.x||m!==n.y){a=n.x;m=n.y}return o},cycle:function(){},draw:function(){},remove:function(){COG.say("layer.remove",{id:b})},
wakeParent:function(o){if(k)k.trigger(o?"invalidate":"wake")},getId:function(){return b},setId:function(o){b=o},getParent:function(){return k},setParent:function(o){h=(k=o)?k.fastDraw&&displayState!==f:false;p.trigger("parentChange",k)}},g);COG.observable(p);return p};
T5.View=function(g){function k(w,C,I,L){V=ma;F();if(L&&g.inertia){T=true;l(A+C,t+I,g.panAnimationEasing,g.panAnimationDuration)}else L||l(A+C,t+I)}function h(){V=ja;T=false;COG.Loopage.join({execute:F,after:50,single:true})}function e(w,C){$=oa(w);ca=oa(C);var I=ka($.dimensions),L=ka(ca.dimensions);X=ra($);O=ra(ca);N=$&&I!==0?L/I:1}function b(w,C,I){e(C,I);if(Z=N!==1){V=ia;F()}}function f(w,C,I,L){e(C,I);if(g.adjustScaleFactor){N=g.adjustScaleFactor(N);COG.Log.info("scale factor adjusted to: "+N)}if(L<
g.pinchZoomAnimateTrigger){n(ha,N,X,r(),T5.easing("sine.out"),function(){a();N=1},300);N=ha}else{a();N=1}}function d(w,C,I){E.zoom(C,Math.min(Math.pow(2,Math.round(Math.log(I))),8),500)}function a(){Z=false;E.trigger("scale",N,$?r():O);V=ja;F()}function m(){clearTimeout(ea);ea=setTimeout(p,50)}function l(w,C,I,L,Q){function aa(){ga+=1;if(ga>=2){h(0,0);Q&&Q()}}var ga=0;if(I){w=T5.tweenValue(A,w,I,aa,L);C=T5.tweenValue(t,C,I,aa,L);w.cancelOnInteract=true;w.requestUpdates(function(ba){A=ba;T=true;F()});
C.cancelOnInteract=true;C.requestUpdates(function(ba){t=ba;T=true;F()})}else{A=w;t=C}}function p(){var w;if(v){COG.Touch.release(v);if(g.autoSize&&v.parentNode){w=v.parentNode.getBoundingClientRect();if(w.height!==0&&w.width!==0){v.height=w.height;v.width=w.width}}try{x=v.getContext("2d");x.clearRect(0,0,v.width,v.height)}catch(C){COG.Log.exception(C);throw Error("Could not initialise canvas on specified view element");}na=COG.Touch.capture(v,{observable:E});if(K.height!==v.height||K.width!==v.width){K=
new T5.Dimensions(v.width,v.height);E.trigger("resize",v.width,v.height);for(w=M;w--;)J[w].trigger("resize",v.width,v.height)}g.inertia&&na.inertiaEnable(g.panAnimationDuration,K);for(w=M;w--;)J[w].trigger("contextChanged",x);u()}}function o(w,C){C.setId(w);C.added=T5.ticks();C.trigger("contextChanged",x);C.setParent(E);J.push(C);J.sort(function(I,L){var Q=L.zindex-I.zindex;if(Q===0)Q=L.added-I.added;return Q});M=J.length;return C}function n(w,C,I,L,Q,aa,ga){function ba(){aa&&aa();a();N=1;fa=null}
Z=true;X=T5.V.copy(I);O=T5.V.copy(L);$=null;if(Q)T5.tweenValue(0,C-w,Q,ba,ga?ga:1E3).requestUpdates(function(qa){fa=qa/(C-w);N=w+qa;V=ia;F();E.trigger("animate")});else{N=targetScaleFactor;ba()}}function r(){var w=T5.D.getCenter(K),C=T5.V.distance([O,w]),I=T5.V.theta(O,w,C),L=T5.V.diff(X,O);w=T5.V.pointOnEdge(O,w,I,C/N);w.x+=L.x;w.y+=L.y;return w}function B(){E.trigger("idle");S=true;Y=0}function s(w,C,I,L){var Q=0,aa=T?ma:G?T5.viewState("FROZEN"):V,ga=(aa&ia)!==0,ba=0;if(z||ga){w.clearRect(0,0,v.width,
v.height);z=false}if(ga){T5.D.getCenter(K);var qa=(fa?fa:1)/2,sa=T5.V.diff(X,O);if($){P.x=O.x+sa.x;P.y=O.y+sa.y}else{P.x=O.x-sa.x*qa;P.y=O.y-sa.y*qa}C=T5.V.offset(C,P.x,P.y)}w.save();try{ha=N;if(H!==1)w.scale(H,H);else if(ga){w.translate(O.x,O.y);w.scale(N,N)}for(ba=M;ba--;)if(J[ba].shouldDraw(aa,C,I)){var ta=J[ba].draw(w,C,K,aa,E,I,L);Q+=ta?ta:0}}finally{w.restore()}COG.Log.trace("draw complete",L);return Q}function y(w,C){var I=false;I=!T&&(V===ia||V===ma);var L=da||V===T5.viewState("PAN")||V===
T5.viewState("PINCH")||T5.isTweening();q.x=A>>0;q.y=t>>0;if(I){T5.cancelAnimation(function(aa){return aa.cancelOnInteract});S=false;if(Y!==0){clearTimeout(Y);Y=0}}I=L||N!==1&&N!==la;for(var Q=M;Q--;)I=J[Q].cycle(w,q,V,L)||I;if(I){s(x,q,L,w);la=N;da=false}if(!I&&R===0&&!pa){if(!S&&Y===0)Y=setTimeout(B,500);C.trigger("complete")}R=0;COG.Log.trace("Completed draw cycle",w)}function u(){da=true;F()}function F(){R++;if(!(G||D)){D=COG.Loopage.join({execute:y,frequency:30});D.bind("complete",function(){D=
null})}}g=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10},g);var J=[],M=0,v=document.getElementById(g.container),x=null,A=0,t=0,q=new T5.Vector,z=false,D=null,G=false,H=1,K=new T5.Dimensions,R=0,O=null,S=false,T=false,Y=0,W=0,P=new T5.Vector,U=0,Z=false,$=null,ca=null,da=false,ea=0,N=1,la=0,ha=1,fa=null,X=
null,pa=typeof FlashCanvas!=="undefined",na=null,ja=T5.viewState("ACTIVE"),ma=T5.viewState("PAN"),ia=T5.viewState("PINCH"),V=ja,oa=T5.V.getRect,ka=T5.D.getSize,ra=T5.R.getCenter,E={id:g.id,deviceScaling:H,fastDraw:g.fastDraw||T5.getConfig().requireFastDraw,animate:function(w,C,I,L,Q){n(N,w,C,I,L,Q)},centerOn:function(w){A=w.x-v.width/2;t=w.y-v.height/2},getDimensions:function(){return K},getZoomCenter:function(){return P},getLayer:function(w){for(var C=0;C<M;C++)if(J[C].getId()==w)return J[C];return null},
setLayer:function(w,C){for(var I=0;I<M;I++)if(J[I].getId()===w){J.splice(I,1);break}C&&o(w,C);u()},eachLayer:function(w){for(var C=M;C--;)w(J[C])},clearBackground:function(){z=true;u()},freeze:function(){G=true},unfreeze:function(){G=false;F()},resize:function(w,C){if(v){v.width=w;v.height=C;p()}},scale:function(w,C,I,L,Q){L||(L=T5.D.getCenter(K));Q||(Q=T5.D.getCenter(K));E.animate(w,L,Q,C,I);return E},removeLayer:function(w){a:{for(var C=M;C--;)if(J[C].getId()==w){w=C;break a}w=-1}if(w>=0&&w<M){COG.say("layer.removed",
{layer:J[w]});J.splice(w,1);u()}M=J.length},getOffset:function(){return q},updateOffset:l,zoom:function(w,C,I){T=false;N=C;Z=N!==1;X=T5.D.getCenter(K);O=N>1?T5.V.copy(w):T5.D.getCenter(K);$=null;clearTimeout(W);if(Z){V=ia;F();if(I)W=setTimeout(function(){a();N=1},parseInt(I,10))}}};COG.listen("layer.remove",function(w){w.id&&E.removeLayer(w.id)});H=T5.getConfig().getScaling();E.markers=o("markers",new T5.MarkerLayer);COG.observable(E);E.bind("wake",F);E.bind("invalidate",u);if(g.pannable){E.bind("pan",
k);E.bind("panEnd",h);E.bind("inertiaCancel",function(){T=false;F()})}if(g.scalable){E.bind("pinchZoom",b);E.bind("pinchZoomEnd",f);E.bind("wheelZoom",d)}E.bind("tap",function(w,C,I){for(var L=T5.V.offset(I,A,t),Q=J.length;Q--;)w.cancel=w.cancel||J[Q].trigger("tap",C,I,L).cancel});COG.configurable(E,["inertia","container","rotation","tapExtent"],COG.paramTweaker(g,null,{container:function(w,C){v=document.getElementById(C);p()},rotation:function(w,C){U=C}}),true);p();g.autoSize&&window.addEventListener("resize",
m,false);return E};
T5.PathLayer=function(g){function k(p){p.syncVectors(f);d&&p.syncVectors(d);l.trigger("tidy")}g=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},g);var h=false,e=[],b=null,f=[],d=null,a=0,m=[],l=T5.ex(new T5.ViewLayer(g),{getAnimation:function(p,o,n,r){var B="pathAnimation"+a++;m.push(B);return new T5.AnimatedPathLayer({id:B,path:e,zindex:g.zindex+1,easing:p?p:T5.easing("sine.inout"),duration:o?o:5E3,drawIndicator:n,autoCenter:r?r:false})},cycle:function(p,o,n,r){return r},draw:function(p,
o){var n,r=e.length;p.save();try{T5.applyStyle(p,g.style);if(r>0){p.beginPath();p.moveTo(e[r-1].x-o.x,e[r-1].y-o.y);for(n=r;n--;)p.lineTo(e[n].x-o.x,e[n].y-o.y);p.stroke();if(b){p.fillStyle=g.waypointFillStyle;for(n=b.length;n--;){p.beginPath();p.arc(b[n].x-o.x,b[n].y-o.y,2,0,Math.PI*2,false);p.stroke();p.fill()}}}}finally{p.restore()}h=false},updateCoordinates:function(p,o){var n=l.getParent();n=n?n.getTileLayer():null;f=p;d=o;COG.Log.info("updating coordinates, grid = "+n);n&&k(n)}});l.bind("gridUpdate",
function(p,o){k(o);for(var n=m.length;n--;)COG.say("layer.remove",{id:m[n]});m=[]});l.bind("tidy",function(){e=T5.V.simplify(f,g.pixelGeneralization);b=T5.V.simplify(d,g.pixelGeneralization);h=true;l.wakeParent(true)});return l};
T5.Poly=function(g,k){k=T5.ex({fill:false},k);var h=false,e=k.fill,b=[],f={draw:function(d,a,m){if(h){var l=true;d.beginPath();for(var p=b.length;p--;){var o=b[p].x-a,n=b[p].y-m;if(l){d.moveTo(o,n);l=false}else d.lineTo(o,n)}e&&d.fill();d.stroke()}},resync:function(d){d.syncVectors(g);b=g.length<=3?g:T5.V.simplify(g)}};h=g&&g.length>=2;return f};
T5.PolyLayer=function(g){g=T5.ex({zindex:80,transparent:true,style:null},g);var k=[],h=false,e=T5.ex(new T5.ViewLayer(g),{add:function(b){k.unshift(b)},cycle:function(){return h},draw:function(b,f,d,a){d=f.x;f=f.y;b.save();try{T5.applyStyle(b,g.style);for(var m=k.length;m--;)k[m].draw(b,d,f,a)}finally{b.restore()}h=false}});e.bind("gridUpdate",function(b,f){for(var d=k.length;d--;)k[d].resync(f);h=true;e.wakeParent(true)});e.bind("parentChange",function(b,f){var d=f?f.getTileLayer():null;if(d)for(var a=
k.length;a--;)k[a].resync(d)});COG.configurable(e,["style"],COG.paramTweaker(g,null,null),true);return e};
T5.AnimatedPathLayer=function(g){function k(a,m,l){a.fillStyle="#FFFFFF";a.strokeStyle="#222222";a.beginPath();a.arc(l.x,l.y,4,0,Math.PI*2,false);a.stroke();a.fill()}g=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","PINCH"),drawIndicator:null,duration:2E3,autoCenter:false},g);var h=T5.V.edges(g.path),e,b=null,f=0;T5.tweenValue(0,h.total,g.easing,function(){d.remove()},g.duration).requestUpdates(function(a,m){f=a;m&&d.remove()});var d=
T5.ex(new T5.ViewLayer(g),{cycle:function(){for(var a=0;a<h.accrued.length&&h.accrued[a]<f;)a++;b=null;if(a<g.path.length-1){var m=f-(a>0?h.accrued[a-1]:0),l=g.path[a],p=g.path[a+1];e=T5.V.theta(l,p,h.edges[a]);b=T5.V.pointOnEdge(l,p,e,m);if(g.autoCenter)(a=d.getParent())&&a.centerOn(b)}return b},draw:function(a,m){if(b)(g.drawIndicator?g.drawIndicator:k)(a,m,new T5.Vector(b.x-m.x,b.y-m.y),e)}});return d};
T5.Annotation=function(g){g=T5.ex({xy:null,tweenIn:null,animationSpeed:null},g);var k=false,h=T5.ex(g,{xy:g.xy,isNew:true,isAnimating:function(){return k},draw:function(e,b,f,d,a){if(h.xy){if(h.isNew&&g.tweenIn){var m=h.xy.y;h.xy.y=b.y-20;k=true;T5.tween(h.xy,"y",m,g.tweenIn,function(){h.xy.y=m;k=false},g.animationSpeed?g.animationSpeed:250+Math.random()*500)}h.drawMarker(e,b,new T5.Vector(h.xy.x-b.x,h.xy.y-b.y),f,d,a);h.isNew=false}},drawMarker:function(e,b,f){e.beginPath();e.arc(f.x,f.y,4,0,Math.PI*
2,false);e.fill()},hitTest:function(e){return Math.abs(e.x-h.xy.x)<=4&&Math.abs(e.y-h.xy.y)<=4}});return h};
T5.ImageAnnotation=function(g){g=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null},g);var k=g.imageAnchor?T5.V.invert(g.imageAnchor):null,h=g.image,e=g.animatingImage;if(!h)(h=T5.Images.get(g.imageUrl))||T5.Images.load(g.imageUrl,function(f){h=f});if(!e)(e=T5.Images.get(g.imageUrl))||T5.Images.load(g.animatingImageUrl,function(f){e=f});var b=T5.ex(new T5.Annotation(g),{drawMarker:function(f,d,a){if((d=b.isAnimating()&&e?e:h)&&d.complete&&d.width>0){k||(k=
new T5.Vector(-d.width>>1,-d.height>>1));a=T5.V.offset(a,k.x,k.y);f.drawImage(d,a.x,a.y,d.width,d.height)}},hitTest:function(f){var d=b.xy.x,a=b.xy.y;return f.x>=d+k.x&&f.x<=d+(h.width+k.x)&&f.y>=a+k.y&&f.y<=a+(h.height+k.y)}});return b};
T5.MarkerLayer=function(g){function k(d,a){for(var m=e.length;m--;)a.syncVectors([e[m].xy])}function h(){var d=f.getParent().getTileLayer();d&&k(null,d);f.trigger("markerUpdate",e);f.wakeParent(true)}g=T5.ex({zindex:100},g);var e=[],b=false,f=T5.ex(new T5.ViewLayer(g),{cycle:function(){return b},draw:function(d,a,m,l,p){b=false;for(m=e.length;m--;){e[m].draw(d,a,l,f,p);b=b||e[m].isAnimating()}return b?1:0},add:function(d){if(d&&typeof d.length!=="undefined")for(var a=d.length;a--;){if(d[a])e[e.length]=
d[a]}else if(d)e[e.length]=d;h()},clear:function(d){if(d)for(var a=0;a<e.length;a++)d(e[a])&&e.splice(a,1);else e=[];h()},find:function(d){var a=[];if(d)for(var m=e.length;m--;)if(d(e[m]))a[a.length]=e[m];return a}});f.bind("tap",function(d,a,m,l){for(var p=[],o=e.length;o--;)if(e[o].hitTest(l))p[p.length]=e[o];if(p.length>0)d.cancel=f.trigger("markerTap",a,m,p).cancel});f.bind("gridUpdate",k);return f};
T5.Style=function(g){function k(f){var d=g[f];typeof d!=="undefined"&&h.push(function(a){a[f]=d})}g=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var h=[],e={applyToContext:function(f){for(var d=h.length;d--;)h[d](f)}};for(var b in g)k(b);return e};
(function(){var g={basic:new T5.Style({lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),waypoints:new T5.Style({lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"})};T5.applyStyle=function(k,h){(T5.styles[h]?T5.styles[h]:T5.styles.basic).applyToContext(k)};T5.loadStyles=function(k){COG.jsonp(k,function(h){T5.resetStyles(h)})};T5.resetStyles=function(k){var h={};for(var e in k)h[e]=new T5.Style(k[e]);T5.styles=T5.ex({},g,h)};T5.styles=g})();
(function(){T5.tileSize=256;T5.Tile=function(g){return g=T5.ex({x:0,y:0,gridX:0,gridY:0,dirty:true},g)};T5.EmptyTile=function(g){g=new T5.Tile(g);g.empty=true;return g};T5.ImageTile=function(g){g=T5.ex({url:"",sessionParamRegex:null,loading:false,loaded:false},g);return new T5.Tile(g)}})();
T5.TileGrid=function(g){function k(q,z){var D=T5.Vector(q*a-p.x,z*a-p.y);return new T5.EmptyTile({gridX:D.x,gridY:D.y,empty:true})}function h(q,z,D,G){var H=d*0.2>>0,K=new T5.Vector;if(q<0||q+D>d)K.x=q<0?-H:H;if(z<0||z+G>d)K.y=z<0?-H:H;return K}function e(q,z,D){var G=COG.Log.getTraceTicks(),H=0;new T5.Vector(d/2,d/2);if(D)f=[];if(q)for(D=0;D<d;D++)for(var K=0;K<d;K++){if(!f[H]){var R=q(K,D,m,d);R.gridX=K*a-p.x;R.gridY=D*a-p.y;f[H]=R}H++}l=q;n=z;COG.Log.trace("tile grid populated",G);t.wakeParent()}
function b(q,z,D,G){var H,K=[],R=false;q=new T5.Vector((q.x+p.x)*B>>0,(q.y+p.y)*B>>0);tilesNeeded=false;if(!A){H=t.getParent().getDimensions();v=Math.ceil(H.width*B)+1;x=Math.ceil(H.height*B)+1;A=new T5.Vector((v-1)/2>>0,(x-1)/2>>0)}for(var O=x;O--;)for(var S=v;S--;){H=S+q.x>=0&&S+q.x<d?f[(O+q.y)*d+(S+q.x)]:null;var T=new T5.Vector(S-A.x,O-A.y);if(!H){J=h(q.x,q.y,v,x);H=k(S+q.x,O+q.y)}R=H?(H.dirty=D||H.dirty)||R:R;K[K.length]={tile:H,centerness:T5.V.absSize(T)}}K.sort(function(Y,W){return W.centerness-
Y.centerness});y||(y=Array(K.length));for(D=K.length;D--;){y[D]=K[D].tile;t.prepTile(y[D],z)}F=G;return R}g=T5.ex({tileSize:T5.tileSize,center:new T5.Vector,gridSize:25,shiftOrigin:null,supportFastDraw:true,allowShift:true},g);var f=Array(Math.pow(g.gridSize,2)),d=g.gridSize,a=g.tileSize,m=T5.V.offset(g.center,-Math.ceil(g.gridSize>>1)),l=null,p=new T5.Vector,o=false,n=null,r=Math.round(a/2),B=a?1/a:0,s=true,y=null,u=false,F=0;new T5.Vector;var J=new T5.Vector;T5.getConfig();var M=d*a,v,x,A,t=T5.ex(new T5.ViewLayer(g),
{gridDimensions:new T5.Dimensions(M,M),cycle:function(q,z,D,G){var H=false;if(J.x!==0||J.y!==0){G=J;var K=g.shiftOrigin;if(!(!g.allowShift||G.x===0&&G.y===0)){var R=COG.Log.getTraceTicks(),O=Array(f.length);O.length=f.length;for(var S=0;S<d;S++)for(var T=0;T<d;T++)O[T*d+S]=S+G.x>=0&&S+G.x<d?f[(T+G.y)*d+(S+G.x)]:null;f=O;m=K?K(m,G):T5.V.add(m,G);p.x+=-G.x*a;p.y+=-G.y*a;COG.Log.trace("tile storage shifted",R);e(l,n)}J=new T5.Vector;G=true}if(D!==T5.viewState("PINCH"))H=b(z,D,G,q);o=T5.isTweening();
return H},deactivate:function(){s=false},find:function(q){if(!q)return null;for(var z=f.length;z--;){var D=f[z];if(D&&q(D))return D}return null},prepTile:function(){},drawTile:function(){return false},getTileSize:function(){return a},clearTileRect:function(q,z,D,G){q.clearRect(z,D,G,G)},draw:function(q,z,D,G,H,K){if(s){var R=z.x;z=z.y;var O=D.width,S=D.height,T=true;if(y){K||q.beginPath();for(var Y=y.length;Y--;){var W=y[Y],P=W.gridX-R,U=W.gridY-z;K||q.rect(P,U,a,a);W.x=P;W.y=U;if(W.empty){COG.Log.info("empty tile @ x: "+
P+", y: "+U);t.clearTileRect(q,P,U,a,G);T=false}else if(K||W.dirty){o&&t.clearTileRect(q,P,U,a,G);T=t.drawTile(q,W,P,U,G)&&T}O=P<O?P:O;S=U<S?U:S}K||q.clip();O>0&&q.clearRect(0,0,O,D.height);S>0&&q.clearRect(0,0,D.width,S);T&&!u&&H.trigger("tileDrawComplete");u=T}}},getTileAtXY:function(q,z){for(var D=null,G=y?y.length:0;G--;){var H=y[G];if(H&&q>=H.x&&z>=H.y)if(q<=H.x+a&&z<=H.y+a){D=H;break}}COG.Log.info("looking for tile @ x: "+q+", y: "+z+", found: "+D);return D},getTileVirtualXY:function(q,z,D){q=
T5.V.add(new T5.Vector(q,z),T5.V.invert(m),p);q=new T5.Vector(q.x*a,q.y*a);if(D){q.x+=r;q.y+=r}return q},populate:function(q){e(q,null,true)}});t.bind("resize",function(){COG.Log.info("captured resize");A=null});COG.listen("imagecache.cleared",function(){for(var q=f.length;q--;)if(f[q])f[q].loaded=false});COG.listen("tiler.repaint",function(){for(var q=f.length;q--;)if(f[q]){f[q].x=null;f[q].y=null}});return t};
T5.ImageTileGrid=function(g){function k(n){function r(){var B=T5.Images.newCanvas(32,32),s=B.getContext("2d");s.fillStyle="#BBBBBB";s.fillRect(0,0,32,32);s.fillStyle="#C3C3C3";s.fillRect(0,0,16,16);s.fillRect(16,16,16,16);return B}if(!e||n!==e.width){e=T5.Images.newCanvas(n,n);n=e.getContext("2d");n.fillStyle=typeof FlashCanvas!=="undefined"?"#666666":n.createPattern(r(),"repeat");n.fillRect(0,0,e.width,e.height)}return e}g=T5.ex({emptyTile:function(n){if(!h||n!==h.width){h=T5.Images.newCanvas(n,
n);n=h.getContext("2d");n.fillStyle="rgba(150, 150, 150, 0.1)";n.fillRect(0,0,h.width,h.height)}return h}(T5.tileSize),panningTile:null,tileOffset:new T5.Vector,tileDrawArgs:{}},g);var h=g.emptyTile,e=g.panningTile?g.panningTile:k(T5.tileSize),b=T5.viewState("ACTIVE"),f=T5.viewState("PAN"),d=T5.getConfig().requireFastDraw,a=g.tileSize?g.tileSize:T5.tileSize,m=T5.Images.get,l=T5.Images.load,p=T5.ex({background:null,overlay:null,offset:new T5.Vector,realSize:new T5.Dimensions(a,a)},g.tileDrawArgs),
o=T5.ex(new T5.TileGrid(g),{clearTileRect:function(n,r,B,s,y){(y&f)===0&&n.clearRect(r,B,s,s)},drawTile:function(n,r,B,s,y){var u=r.url?m(r.url):null,F=false;if(u){n.drawImage(u,B,s);F=true}else if((y&f)!==0)n.drawImage(e,B,s);else if(h&&!r.drawnEmpty){n.drawImage(h,B,s);r.drawnEmpty=true}r.dirty=false;return F},initTileUrl:function(){},prepTile:function(n,r){if(n&&!n.loading&&(!d||r===b)){n.url||o.initTileUrl(n);if(!m(n.url)){n.loading=true;l(n.url,function(){n.loaded=true;n.dirty=true;o.wakeParent()},
p)}}}});return o};
T5.Tiler=function(g){g=T5.ex({container:"",drawCenter:false,datasources:{},tileLoadThreshold:"first"},g);var k=T5.ex(new T5.View(g),{getTileLayer:function(){return k.getLayer("grid0")},setTileLayer:function(h){k.setLayer("grid0",h);k.trigger("gridUpdate",h);k.eachLayer(function(e){e.trigger("gridUpdate",h)})},viewPixToGridPix:function(h){var e=k.getOffset();return new T5.Vector(h.x+e.x,h.y+e.y)},centerOn:function(h,e,b,f){var d=k.getTileLayer(),a=k.getDimensions();(d=d?d.getTileSize():0)&&k.updateOffset(h.gridX-
(a.width-d)*0.5>>0,h.gridY-(a.height-d)*0.5>>0,e,b,f)},cleanup:function(){k.removeLayer("grid0")},repaint:function(){COG.say("tiler.repaint");k.trigger("wake")},select:function(h){k.trigger("selectTile",h)}});k.bind("tap",function(h,e,b){if(h=k.getTileLayer())(b=h.getTileAtXY(b.x,b.y))&&k.trigger("selectTile",b)});return k};
T5.Geo=function(){function g(v,x){var A=null;for(var t in J)if(x){if(t==x&&J[t][v]){A=J[t];break}}else if(J[t][v]){A=J[t];break}return A}function k(v,x){var A=m*Math.sin(v);return d-2*Math.atan(x*Math.pow((1-A)/(1+A),m/2))}function h(v,x,A,t){var q=0;v=v.toUpperCase();for(var z in t){var D=x[z];if(D){var G=A[z];D=G?G(v,D):COG.wordExists(v,D)?1:0;q+=D*t[z]}}return q}var e=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],b=Math.PI/180,f=180/Math.PI,d=Math.PI/
2,a=Math.PI*2,m=0.08181919084262157,l=null,p={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},o={VECTORIZE_PER_CYCLE:500},n={getEngine:function(v){for(var x=null,A=1;!x&&A<arguments.length;A++)x=g(v,arguments[A]);x=x?x:g(v);if(!x)throw Error("Unable to find GEO engine with "+v+" capability");return x},rankGeocodeResponses:function(v,x,A){var t=[],q=M.AddressCompareFns;if(A&&A.compareFns)q=T5.ex({},q,A.compareFns);for(A=0;A<x.length;A++)t.push(new M.GeoSearchResult({caption:F.toString(x[A]),
data:x[A],pos:x[A].pos,matchWeight:h(v,x[A],q,M.GeocodeFieldWeights)}));t.sort(function(z,D){return D.matchWeight-z.matchWeight});return t},distanceToString:function(v){if(v>1E3)return~~(v/10)/100+" km";return v?v+" m":""},dist2rad:function(v){return v/6371},lat2pix:function(v){v=parseFloat(v)*b;v=Math.sin(v);var x=m*v;return Math.log((1+v)/(1-v)*Math.pow((1-x)/(1+x),m))/2},lon2pix:function(v){return parseFloat(v)*b},pix2lon:function(v){return M.normalizeLon(v)*f},pix2lat:function(v){v=Math.pow(Math.E,
-v);for(var x=d-2*Math.atan(v),A=k(x,v),t=0;t<12&&Math.abs(x-A)>1.0E-7;){x=A;A=k(x,v);t++}return A*f},normalizeLon:function(v){for(;v<-180;)v+=360;for(;v>180;)v-=360;return v}},r=function(v,x){return{lat:parseFloat(v?v:0),lon:parseFloat(x?x:0)}},B=function(v,x){return{min:y.parse(v),max:y.parse(x)}},s=function(v){return v=T5.ex({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},v)},y=function(){var v={calcDistance:function(x,A){if(v.empty(x)||v.empty(A))return 0;var t=
(A.lat-x.lat)*b/2,q=(A.lon-x.lon)*b/2;t=Math.sin(t)*Math.sin(t)+Math.cos(x.lat*b)*Math.cos(A.lat*b)*Math.sin(q)*Math.sin(q);return 6371*2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t))},copy:function(x){return x?new r(x.lat,x.lon):null},empty:function(x){return!x||x.lat===0&&x.lon===0},equal:function(x,A){return x&&A&&x.lat==A.lat&&x.lon==A.lon},inArray:function(x,A){for(var t=y.equal,q=A.length;q--;)if(t(x,A[q]))return true;return false},inBounds:function(x,A){var t=!(y.empty(x)||y.empty(A));return t=(t=
t&&x.lat>=A.min.lat&&x.lat<=A.max.lat)&&x.lon>=A.min.lon&&x.lon<=A.max.lon},parse:function(x){if(x)if(typeof x.lat!=="undefined")return v.copy(x);else{if(x.split)for(var A=[" ",","],t=0;t<A.length;t++){var q=x.split(A[t]);if(q.length===2)return new r(q[0],q[1])}}else return new r;return null},parseArray:function(x){var A=x.length,t=Array(A);for(A=A;A--;)t[A]=v.parse(x[A]);return t},fromMercatorPixels:function(x,A){return new r(T5.Geo.pix2lat(A),T5.Geo.normalizeLon(T5.Geo.pix2lon(x)))},toMercatorPixels:function(x){return new T5.Vector(T5.Geo.lon2pix(x.lon),
T5.Geo.lat2pix(x.lat))},generalize:function(x,A,t){var q=x.length,z=[],D=null;t||(t=250);t/=1E3;COG.Log.info("generalizing positions, must include "+A.length+" positions");for(var G=q;G--;)if(G===0)z.unshift(x[G]);else{var H=!D||y.inArray(x[G],A)?t:y.calcDistance(D,x[G]);if(x[G]&&H>=t){z.unshift(x[G]);D=x[G]}}COG.Log.info("generalized "+q+" positions into "+z.length+" positions");return z},vectorize:function(x,A){var t=x.length,q=Array(t);A=T5.ex({chunkSize:o.VECTORIZE_PER_CYCLE,async:true},A);if(!A.async){for(var z=
t;z--;)q[z]=new T5.Geo.GeoVector(x[z]);return q}return COG.Loopage.join({frequency:10,execute:function(D,G){for(var H=0,K=A.chunkSize,R=t;R--;){q[R]=new T5.Geo.GeoVector(x[R]);H+=1;if(H>K)break}t=R;t<=0&&G.trigger("complete",q)}})},toString:function(x){return x?x.lat+" "+x.lon:""}};return v}(),u=function(){var v=-d,x=d,A=-a,t={calcSize:function(q,z,D){var G=new T5.Vector(0,z.lat-q.lat);if(typeof D==="undefined")D=true;G.x=D&&q.lon>z.lon?360-q.lon+z.lon:z.lon-q.lon;return G},createBoundsFromCenter:function(q,
z){var D=z/6371,G=q.lat*b,H=q.lon*b,K=G-D,R=G+D;if(K>v&&R<x){G=Math.asin(Math.sin(D)/Math.cos(G));D=H-G;if(D<A)D+=2*Math.PI;H=H+G;if(H>a)H-=2*Math.PI}else{K=Math.max(K,v);R=Math.min(R,x);D=A;H=a}return new B(new r(K*f,D*f),new r(R*f,H*f))},expand:function(q,z){return new B(new r(q.min.lat-z,q.min.lon-M.normalizeLon(z)),new r(q.max.lat+z,q.max.lon+M.normalizeLon(z)))},forPositions:function(q,z){var D=null,G=T5.ticks();z||(z="auto");for(var H=q.length;H--;)if(D){var K=t.calcSize(D.min,q[H],false),R=
t.calcSize(q[H],D.max,false);if(K.x<0)D.min.lon=q[H].lon;if(K.y<0)D.min.lat=q[H].lat;if(R.x<0)D.max.lon=q[H].lon;if(R.y<0)D.max.lat=q[H].lat}else D=new T5.Geo.BoundingBox(q[H],q[H]);if(z){if(z=="auto"){H=t.calcSize(D.min,D.max);z=Math.max(H.x,H.y)*0.3}D=t.expand(D,z)}COG.Log.trace("calculated bounds for "+q.length+" positions",G);return D},getCenter:function(q){var z=u.calcSize(q.min,q.max);return new T5.Geo.Position(q.min.lat+z.y/2,q.min.lon+z.x/2)},getGeoHash:function(q){var z=T5.Geo.GeoHash.encode(q.min.lat,
q.min.lon);q=T5.Geo.GeoHash.encode(q.max.lat,q.max.lon);COG.Log.info("min hash = "+z+", max hash = "+q)},getZoomLevel:function(q,z){var D=t.getCenter(q),G=e[Math.min(Math.round(Math.abs(D.lat)*0.05),e.length)],H=t.calcSize(q.min,q.max);D=Math.ceil(Math.log(e[3]*z.height/H.y)/Math.log(2));G=Math.ceil(Math.log(G*z.width/H.x)/Math.log(2));return Math.min(isNaN(D)?1E3:D,isNaN(G)?1E3:G)},isEmpty:function(q){return!q||y.empty(q.min)||y.empty(q.max)},toString:function(q){return"min: "+y.toString(q.min)+
", max: "+y.toString(q.max)}};return t}(),F=function(){var v=/^(\d+).*$/,x=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(A,t){v.lastIndex=-1;if(v.test(A))for(var q=A.replace(v,"$1"),z=t.split(","),D=0;D<z.length;D++){x.lastIndex=-1;if(x.test(z[D])){var G=x.exec(z[D]);if(q>=parseInt(G[1],10)&&q<=parseInt(G[2],10))return true}else if(q==z[D])return true}return false},normalize:function(A){if(!A)return"";A=A.toUpperCase();if(!l){var t=[];for(var q in p)t.push(q);l=RegExp("(\\s)("+t.join("|")+")(\\s|$)",
"i")}l.lastIndex=-1;if(t=l.exec(A))A=A.replace(l,"$1"+p[t[2]]);return A},toString:function(A){return A.streetDetails+" "+A.location}}}(),J={},M={P:y,B:u,A:F,Radius:function(v,x){return{distance:parseInt(v,10),uom:x}},Position:r,BoundingBox:B,GeoVector:function(v){var x=new T5.Vector;T5.ex(x,{radsPerPixel:null,setRadsPerPixel:function(A,t,q){var z=x.mercXY;x.x=Math.abs((z.x/A>>0)+(t?t:0));x.y=Math.abs((z.y/A>>0)+(q?q:0));x.radsPerPixel=A}});(function(A){x.pos=A;x.mercXY=y.toMercatorPixels(A)})(v);
return x},Address:s,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(v){if(!v.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var x=T5.ex({remove:function(){delete J[x.id]}},v);return J[x.id]=x},GeoSearchResult:function(v){v=T5.ex({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},v);return T5.ex(v,{toString:function(){return v.caption+(v.matchWeight?" ("+v.matchWeight+")":"")}})},GeoSearchAgent:function(v){return new T5.Dispatcher.Agent(v)},
GeocodingAgent:function(v){v=T5.ex({name:"Geocoding Search Agent",paramTranslator:null,execute:function(x,A){try{if(!x.reverse&&!x.freeform)address=new s(x);var t=M.getEngine("geocode");if(t)t.geocode({addresses:[x.freeform?x.freeform:address],complete:function(z,D){if(A){var G=D;if(x.freeform)G=M.rankGeocodeResponses(x.freeform,G,M.getEngine("geocode"));A(G,v)}}})}catch(q){COG.Log.exception(q)}}},v);return new M.GeoSearchAgent(v)}};return T5.ex(M,o,n)}();
T5.Geo.GeoHash=function(){function g(k,h,e){if(h&e)k[0]=(k[0]+k[1])/2;else k[1]=(k[0]+k[1])/2}BITS=[16,8,4,2,1];BASE32="0123456789bcdefghjkmnpqrstuvwxyz";NEIGHBORS={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}};BORDERS={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};NEIGHBORS.bottom.odd=NEIGHBORS.left.even;NEIGHBORS.top.odd=
NEIGHBORS.right.even;NEIGHBORS.left.odd=NEIGHBORS.bottom.even;NEIGHBORS.right.odd=NEIGHBORS.top.even;BORDERS.bottom.odd=BORDERS.left.even;BORDERS.top.odd=BORDERS.right.even;BORDERS.left.odd=BORDERS.bottom.even;BORDERS.right.odd=BORDERS.top.even;return{decode:function(k){var h=1,e=[],b=[];e[0]=-90;e[1]=90;b[0]=-180;b[1]=180;lat_err=90;lon_err=180;for(i=0;i<k.length;i++){c=k[i];cd=BASE32.indexOf(c);for(j=0;j<5;j++){mask=BITS[j];if(h){lon_err/=2;g(b,cd,mask)}else{lat_err/=2;g(e,cd,mask)}h=!h}}e[2]=(e[0]+
e[1])/2;b[2]=(b[0]+b[1])/2;return{latitude:e,longitude:b}},encode:function(k,h,e){var b=1,f=[],d=[],a=0,m=0;e=e?e:12;geohash="";f[0]=-90;f[1]=90;d[0]=-180;for(d[1]=180;geohash.length<e;){if(b){mid=(d[0]+d[1])/2;if(h>mid){m|=BITS[a];d[0]=mid}else d[1]=mid}else{mid=(f[0]+f[1])/2;if(k>mid){m|=BITS[a];f[0]=mid}else f[1]=mid}b=!b;if(a<4)a++;else{geohash+=BASE32[m];m=a=0}}return geohash}}}();
T5.Geo.JSON=function(){function g(d,a){var m=h(a);d.add(new T5.Poly(m))}function k(d,a){var m=h(a[0]);d.add(new T5.Poly(m,{fill:true}))}function h(d){var a=d.length,m=Array(a);for(a=a;a--;)m[a]=new T5.Geo.Position(d[a][1],d[a][0]);return T5.Geo.P.vectorize(m,e)}var e={async:false},b={linestring:g,multilinestring:function(d,a){for(var m=0;m<a.length;m++)g(d,a[m])},polygon:k,multipolygon:function(d,a){for(var m=0;m<a.length;m++)k(d,a[m])}},f=function(d,a,m){m=T5.ex({vectorsPerCycle:T5.Geo.VECTORIZE_PER_CYCLE,
rowPreParse:null,targetLayer:null},m);var l=m.vectorsPerCycle,p=m.targetLayer,o=m.rowPreParse,n=0,r=0;if(!d)return null;if(typeof d.length==="undefined")d=[d];r=d.length;p||(p=new T5.PolyLayer);m=COG.Loopage.join({frequency:10,execute:function(B,s){for(var y=0,u=n;u<r;u++){var F=o?o(d[u]):d[u],J=F.type?F.type.toLowerCase():null;J=b[J];var M=null;if(J)M=J(p,F.coordinates);y+=M?M:1;if(y>=l)break}n=u+1;n>=r&&s.trigger("complete")}});m.bind("complete",function(){a&&a(p)});return m};return{parse:function(d,
a,m){return new f(d,a,m)}}}();
T5.Geo.LocationSearch=function(g){function k(d,a){navigator.geolocation.clearWatch(e);e=0;if(b){clearTimeout(b);b=0}a&&a([d],g)}function h(d){COG.Log.info("caught location tracking error:",d)}g=T5.ex({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},g);var e=0,b=0,f=null;return new T5.Geo.GeoSearchAgent(T5.ex({execute:function(d,a){if(navigator.geolocation&&!e){e=navigator.geolocation.watchPosition(function(m){var l=new T5.Geo.Position(m.coords.latitude,m.coords.longitude);
m=new T5.Geo.GeoSearchResult({id:1,caption:"Current Location",pos:l,accuracy:m.coords.accuracy/1E3,matchWeight:100});if(!f||m.accuracy<f.accuracy)f=m;if(!g.requiredAccuracy||f.accuracy<g.requiredAccuracy)k(f,a)},h,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(g.searchTimeout)b=setTimeout(function(){f&&k(f,a)},g.searchTimeout)}}},g))};
T5.Map=function(g){function k(r){try{var B=new T5.Geo.Position(r.coords.latitude,r.coords.longitude),s=r.coords.accuracy/1E3;n.trigger("locationUpdate",r,s);if(p){if(!m){m=new T5.Geo.UI.LocationOverlay({pos:B,accuracy:s});m.update(n.getTileLayer());n.setLayer("location",m)}var y=T5.Geo.B.createBoundsFromCenter(B,Math.max(s,1));n.gotoBounds(y)}else{m.pos=B;m.accuracy=s;m.update(n.getTileLayer());n.panToPosition(B,null,T5.easing("sine.out"))}p=false}catch(u){COG.Log.exception(u)}}function h(r){COG.Log.info("caught location tracking error:",
r)}g=T5.ex({tapExtent:10,provider:null,crosshair:false,zoomLevel:0,boundsChangeThreshold:30,zoomAnimation:T5.easing("quad.out")},g);var e={NONE:0,SINGLE:1,WATCH:2},b=new T5.Vector,f=e.NONE,d=false,a=null,m=null,l=0,p=true,o=g.zoomLevel;if(!g.provider)g.provider=new T5.Geo.MapProvider;g.adjustScaleFactor=function(r){return Math.pow(2,(r<1?Math.floor:Math.ceil)(Math.log(r)))};var n=T5.ex({},new T5.Tiler(g),{annotations:null,getBoundingBox:function(){var r=n.getTileLayer(),B=n.getOffset(),s=n.getDimensions();
if(r)return r.getBoundingBox(B.x,B.y,s.width,s.height);return null},getCenterPosition:function(){return n.getXYPosition(T5.D.getCenter(n.getDimensions()))},getXYPosition:function(r){return n.getTileLayer().pixelsToPos(n.viewPixToGridPix(r))},gotoBounds:function(r,B){var s=T5.Geo.B.getZoomLevel(r,n.getDimensions());n.gotoPosition(T5.Geo.B.getCenter(r),s,B)},gotoPosition:function(r,B,s){function y(M){n.setTileLayer(M);n.panToPosition(r,function(){n.unfreeze();n.trigger("zoomLevelChange",o);s&&s()});
d=true}var u=o,F=!d,J=n.getBoundingBox();if(J)F=F||!T5.Geo.P.inBounds(r,J);o=B?B:o;if(!o)throw Error("Zoom level required to goto a position.");if(g.provider)o=g.provider.checkZoomLevel(o);if(F||o!==u){T5.Images.cancelLoad();(B=n.getTileLayer())&&B.deactivate();T5.cancelAnimation();d&&n.freeze();g.provider.zoomLevel=o;g.provider.getMapTiles(n,r,y)}else n.panToPosition(r,s)},panToPosition:function(r,B,s,y){var u=n.getTileLayer();if(u){r=u.getGridXYForPosition(r);u=n.getDimensions();r.x-=u.width/2;
r.y-=u.height/2;if(a)a=null;n.updateOffset(r.x,r.y,s,y,B);n.trigger("wake");n.trigger("boundsChange",n.getBoundingBox());B&&typeof s==="undefined"&&B(n)}},locate:function(){n.trackStart(e.SINGLE);setTimeout(n.trackCancel,1E4)},trackStart:function(r){if(navigator.geolocation&&!l){f=r?r:e.WATCH;p=true;l=navigator.geolocation.watchPosition(k,h,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){l&&navigator.geolocation&&navigator.geolocation.clearWatch(l);n.removeLayer("location");
m=null;f=e.NONE;l=0},getZoomLevel:function(){return o},setZoomLevel:function(r){try{n.gotoPosition(n.getCenterPosition(),r)}catch(B){COG.Log.exception(B)}},zoomIn:function(){n.scale(2,T5.easing("sine.out"))||n.setZoomLevel(o+1)},zoomOut:function(){n.scale(0.5,T5.easing("sine.out"))||n.setZoomLevel(o-1)},animateRoute:function(r,B,s,y){var u=n.getLayer("route");if(u)(r=u.getAnimation(r,B,s,y))&&r.addToView(n)}});n.bind("pan",function(){f===e.SINGLE&&n.trackCancel()});n.bind("tap",function(r,B,s){var y=
n.getTileLayer(),u=null;if(y){var F=n.viewPixToGridPix(new T5.Vector(s.x,s.y));r=y.pixelsToPos(F);u=y.pixelsToPos(T5.V.offset(F,-g.tapExtent,g.tapExtent));y=y.pixelsToPos(T5.V.offset(F,g.tapExtent,-g.tapExtent));u=new T5.Geo.BoundingBox(u,y);n.trigger("geotap",B,s,r,u)}});n.bind("doubleTap",function(r,B,s){n.animate(2,T5.D.getCenter(n.getDimensions()),new T5.Vector(s.x,s.y),g.zoomAnimation)});n.bind("scale",function(r,B,s){r=0;B=Math.sqrt(B);if(B<1)r=-(0.5/B);else if(B>1)r=B;n.gotoPosition(n.getXYPosition(s),
o+r>>0)});n.markers.bind("markerUpdate",function(r,B){for(var s=n.getTileLayer(),y=B.length;y--;)s.syncVectors([B[y].xy])});g.crosshair&&n.setLayer("crosshair",new CrosshairOverlay);n.bind("idle",function(){if(T5.V.absSize(T5.V.diff(b,n.getOffset()))>g.boundsChangeThreshold){b=T5.V.copy(n.getOffset());n.trigger("boundsChange",n.getBoundingBox())}});COG.configurable(n,["provider"],COG.paramTweaker(g,null,{provider:function(){n.cleanup();d=false}}),true);return n};
T5.Geo.MapProvider=function(){var g=1,k=20;return{zoomLevel:0,checkZoomLevel:function(h){return Math.min(Math.max(h,g),k)},getCopyright:function(){},getLogoUrl:function(){},getMapTiles:function(){},getZoomRange:function(){return{min:g,max:k}},setZoomRange:function(h,e){g=h;k=e}}};
T5.Geo.Routing=function(){var g={calculate:function(k){k=T5.ex({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},k);var h=T5.Geo.getEngine("route");h&&h.route(k,function(e){if(k.generalize)e.geometry=T5.Geo.P.generalize(e.geometry,e.getInstructionPositions());if(k.map){g.createMapOverlay(k.map,e);k.autoFit&&k.map.gotoBounds(e.boundingBox)}k.success&&k.success(e)})},createMapOverlay:function(k,h){var e=k.getDimensions();e=new T5.Geo.UI.RouteOverlay({data:h,width:e.width,
height:e.height});k.setLayer("route",e)},parseTurnType:function(k){for(var h=g.TurnType.Unknown,e=T5.Geo.Routing.TurnTypeRules,b=0;b<e.length;b++){e[b].regex.lastIndex=-1;var f=e[b].regex.exec(k);if(f){h=e[b].customCheck?e[b].customCheck(k,f):e[b].turnType;break}}return h},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",
TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(k){var h=k=T5.ex({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},k),e=k.description;e=e.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");h.description=e;if(!k.turnType)k.turnType=g.parseTurnType(k.description);return k},RouteData:function(k){k=T5.ex({geometry:[],instructions:[],boundingBox:null},
k);if(!k.boundingBox)k.boundingBox=T5.Geo.B.forPositions(k.geometry);return T5.ex({getInstructionPositions:function(){for(var h=[],e=0;e<k.instructions.length;e++)k.instructions[e].position&&h.push(k.instructions[e].position);return h}},k)}};return g}();T5.Geo.Search=function(){return{bestResults:function(g,k){k||(k=20);for(var h=g.length>0?g[0]:null,e=[],b=0;b<g.length;b++)if(h&&g[b]&&h.matchWeight-g[b].matchWeight<=k)e.push(g[b]);else break;return e}}}();
T5.Geo.UI=function(){var g={AnnotationTween:null,GeoTileGrid:function(k){k=T5.ex({grid:null,centerPos:new T5.Geo.Position,centerXY:new T5.Vector,radsPerPixel:0},k);var h=k.radsPerPixel,e=T5.Geo.P.toMercatorPixels(k.centerPos),b=e.x/h-k.centerXY.x>>0,f=e.y/h-k.centerXY.y>>0,d=null,a=T5.ex({},k.grid,{getBoundingBox:function(m,l,p,o){return new T5.Geo.BoundingBox(a.pixelsToPos(new T5.Vector(m,l+o)),a.pixelsToPos(new T5.Vector(m+p,l)))},getGridXYForPosition:function(m){m=new T5.Geo.GeoVector(m);a.syncVectors([m]);
return m},syncVectors:function(m){for(var l=m.length;l--;)m[l]&&m[l].setRadsPerPixel&&m[l].setRadsPerPixel(h,-b,-d)},getPixelDistance:function(m){return T5.Geo.dist2rad(m)/h>>0},pixelsToPos:function(m){return T5.Geo.P.fromMercatorPixels((b+m.x)*h,(f+a.gridDimensions.height-m.y)*h)}});d=f+a.gridDimensions.height;return a},RouteOverlay:function(k){k=T5.ex({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},k);var h=
[],e=[],b=new T5.PathLayer(k);(function(){if(k.data&&k.data.instructions){for(var f=k.data.instructions,d=Array(f.length),a=f.length;a--;)d[a]=f[a].position;T5.Geo.P.vectorize(d).bind("complete",function(m,l){e=l})}k.data&&k.data.geometry&&T5.Geo.P.vectorize(k.data.geometry).bind("complete",function(m,l){h=l;b.updateCoordinates(h,e,true)})})();return b},Annotation:function(k){k=T5.ex({pos:null},k);k.xy=new T5.Geo.GeoVector(k.pos);return new T5.ImageAnnotation(k)},LocationOverlay:function(k){k=T5.ex({pos:null,
accuracy:null,zindex:90},k);var h=new Image,e=new T5.Vector,b=new T5.Vector,f=null;h.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
h.onload=function(){e=new T5.Vector(h.width/2,h.height/2)};var d=T5.ex(new T5.ViewLayer(k),{pos:k.pos,accuracy:k.accuracy,drawAccuracyIndicator:false,draw:function(a,m){var l=b.x-m.x,p=b.y-m.y;if(f){a.fillStyle="rgba(30, 30, 30, 0.2)";a.beginPath();a.arc(l,p,f,0,Math.PI*2,false);a.fill()}h.complete&&h.width>0&&a.drawImage(h,l-e.x,p-e.y,h.width,h.height);d.wakeParent(true)},update:function(a){if(a){f=Math.floor(a.getPixelDistance(d.accuracy)*0.5);b=a.getGridXYForPosition(d.pos);d.wakeParent(true)}}});
d.bind("gridUpdate",function(a,m){d.update(m)});return d},AnnotationsOverlay:function(k){function h(a,m){var l=a.length,p=d.getParent();if(m=m?m:p?p.getTileLayer():null)for(l=l;l--;)m.syncVectors([a[l].xy]);a.sort(function(o,n){var r=n.xy.y-o.xy.y;if(r===0)r=n.xy.x-o.xy.x;return r})}k=T5.ex({pois:null,map:null,zindex:100},k);var e=[],b=false,f=[],d=T5.ex(new T5.ViewLayer(k),{cycle:function(){return b},draw:function(a,m,l,p,o){b=false;a.fillStyle="rgba(255, 0, 0, 0.75)";a.globalCompositeOperation=
"source-over";for(l=e.length;l--;){e[l].draw(a,m,p,d,o);b=b||e[l].isAnimating()}for(l=f.length;l--;){f[l].draw(a,m,p,d,o);b=b||f[l].isAnimating()}return b?1:0},add:function(a){if(a&&a.length)for(var m=a.length;m--;)f[f.length]=a[m];else if(a)f[f.length]=a;h(f);d.wakeParent(true)},clear:function(a){f=[];h(f);if(a){e=[];h(e)}d.wakeParent(true)}});COG.listen("geo.pois-updated",function(a){if(k.pois&&k.pois.id==a.srcID){a=a.pois;try{e=[];for(var m=0;m<a.length;m++)if(a[m].pos){var l;var p=a[m];if(p&&
p.pos){var o={poi:p,annotation:null};k.map&&k.map.trigger("getAnnotationForPOI",o);if(!o.annotation)o.annotation=new T5.Annotation({xy:new T5.Geo.GeoVector(p.pos)});if(o.annotation){o.annotation.isNew=p.isNew;p.isNew=false}l=o.annotation}else l=void 0;l&&e.push(l)}h(e)}catch(n){COG.Log.exception(n)}d.wakeParent(true)}});d.bind("gridUpdate",function(a,m){h(e,m);h(f,m);d.wakeParent(true)});return d}};g.ImageAnnotation=g.Annotation;return g}();
T5.Geo.Routing.TurnTypeRules=function(){var g=T5.Geo.Routing.TurnType,k=[];k.push({regex:/continue/i,turnType:g.Continue});k.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(h,e){return/bear/i.test(e[1])?g.TurnLeftSlight:g.TurnLeft}});k.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(h,e){return/bear/i.test(e[1])?g.TurnRightSlight:g.TurnRight}});k.push({regex:/enter\s(roundabout|rotaty)/i,turnType:g.EnterRoundabout});k.push({regex:/take.*?ramp/i,turnType:g.Ramp});k.push({regex:/take.*?exit/i,
turnType:g.RampExit});k.push({regex:/make(.*?)u\-turn/i,customCheck:function(h,e){return/right/i.test(e[1])?g.UTurnRight:g.UTurnLeft}});k.push({regex:/proceed/i,turnType:g.Start});k.push({regex:/arrive/i,turnType:g.Arrive});k.push({regex:/fell\sthrough/i,turnType:g.Merge});return k}();
