COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var C=arguments[0]||{},T,t=1,r=arguments.length;t<r;t++)if((T=arguments[t])!==null)for(var m in T){var n=T[m];if(C!==n)if(n!==undefined)C[m]=n}return C};
(function(){var C=Object.prototype.hasOwnProperty,T=0,t={};t.toID=function(r){return r.replace(/\s/g,"-")};t.objId=function(r){return(r?r:"obj")+T++};t.isFunction=function(r){return toString.call(r)==="[object Function]"};t.isArray=function(r){return toString.call(r)==="[object Array]"};t.isPlainObject=function(r){if(!r||toString.call(r)!=="[object Object]"||r.nodeType||r.setInterval)return false;if(r.constructor&&!C.call(r,"constructor")&&!C.call(r.constructor.prototype,"isPrototypeOf"))return false;
var m;for(m in r);return m===undefined||C.call(r,m)};t.isEmptyObject=function(r){for(var m in r)return false;return true};t.isXmlDocument=function(r){return toString.call(r)==="[object Document]"};t.contains=function(r,m){var n=r,s=arguments,x=1;if(m&&module.isArray(m)){s=m;x=0}for(x=x;x<s;x++)n=n&&typeof foo[s[x]]!=="undefined";return n};t.formatStr=function(r){if(arguments.length<=1)return r;for(var m=arguments.length-2,n=0;n<=m;n++)r=r.replace(RegExp("\\{"+n+"\\}","gi"),arguments[n+1]);return r};
t.wordExists=function(r,m){var n="";if(m.toString)m=m.toString();for(var s=0;s<m.length;s++)n+=!/\w/.test(m[s])?"\\"+m[s]:m[s];return RegExp("(^|\\s|\\,)"+n+"(\\,|\\s|$)","i").test(r)};COG.extend(COG,t)})();
(function(){function C(n){return typeof console!=="undefined"?function(){console[n](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var T=window.console&&window.console.markTimeline,t=C("error"),r=C("info"),m=function(){return T?function(n,s){console.markTimeline(n+(s?": "+((new Date).getTime()-s)+"ms":""))}:function(){}}();COG.extend(COG,{trace:m,debug:C("debug"),info:r,warn:C("warn"),error:t,exception:function(n){if(t)for(var s in n)r("ERROR DETAIL: "+s+
": "+n[s])}})})();
(function(){function C(t,r){var m=t.hasOwnProperty("obsHandlers")?t.obsHandlers:null;m[r]||(m[r]=[]);return m[r]}var T=0;COG.observable=function(t){if(!t)return null;if(!(t.hasOwnProperty("obsHandlers")?t.obsHandlers:null))t.obsHandlers={};if(!t.hasOwnProperty("bind")){t.bind=function(r,m){var n="callback"+T++;C(t,r).unshift({fn:m,id:n});return n};t.triggerCustom=function(r,m){var n=C(t,r),s={cancel:false,name:r,source:this},x;m&&COG.extend(s,m);if(!n)return null;x=Array.prototype.slice.call(arguments,2);
t.eventInterceptor&&t.eventInterceptor(r,s,x);x.unshift(s);for(var N=n.length;N--&&!s.cancel;)n[N].fn.apply(this,x);return s};t.trigger=function(r){var m=Array.prototype.slice.call(arguments,1);m.splice(0,0,r,null);return t.triggerCustom.apply(this,m)};t.unbind=function(r,m){if(typeof r==="undefined")t.obsHandlers={};else for(var n=C(t,r),s=0;n&&s<n.length;s++)if(n[s].id===m){n.splice(s,1);break}return t}}return t}})();
(function(){function C(m,n){m[n]||(m[n]=function(s){return m.configure(n,s)})}function T(m){m.gtConfId="configurable"+r++;m.gtConfig={};m.gtConfigFns=[];return m.gtConfig}var t={},r=0;COG.paramTweaker=function(m,n,s){return function(x,N){if(typeof N!=="undefined"){if(x in m)m[x]=N;s&&x in s&&s[x](x,N)}else return n&&x in n?n[x](x):m[x]}};COG.configurable=function(m,n,s,x){if(m){m.gtConfId||T(m);var N=m.gtConfId,ka=m.gtConfig,q=m.gtConfigFns;t[N]=m;q.push(s);for(s=n.length;s--;){ka[n[s]]=true;x&&C(m,
n[s])}if(!m.configure)m.configure=function(A,i){if(ka[A]){for(var o=q.length;o--;){var w=q[o](A,i);if(typeof w!=="undefined")return w}return t[N]}return null}}}})();
(function(){function C(m){var n=document.createElement("script"),s=false;n.src=m;n.async=true;n.onload=n.onreadystatechange=function(){if(!s&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){s=true;n.onload=n.onreadystatechange=null;n&&n.parentNode&&n.parentNode.removeChild(n)}};t||(t=document.getElementsByTagName("head")[0]);t.appendChild(n)}var T=0,t,r=this;COG.jsonp=function(m,n,s){m+=m.indexOf("?")>=0?"&":"?";var x="json"+ ++T;r[x]=function(N){n(N);r[x]=null;try{delete r[x]}catch(ka){}};
C(m+(s?s:"callback")+"="+x);return x}})();
(function(){var C=1.70158,T=Math.PI/2,t=Math.PI*2,r=1E3/60|0,m=Math.abs,n=Math.pow,s=Math.sin,x=Math.asin,N=Math.cos,ka={linear:function(q,A,i,o){return i*q/o+A},backin:function(q,A,i,o){return i*(q/=o)*q*((C+1)*q-C)+A},backout:function(q,A,i,o){return i*((q=q/o-1)*q*((C+1)*q+C)+1)+A},backinout:function(q,A,i,o){return(q/=o/2)<1?i/2*q*q*(((C*=1.525)+1)*q-C)+A:i/2*((q-=2)*q*(((C*=1.525)+1)*q+C)+2)+A},bouncein:function(q,A,i,o){return i-ka.bounceout(o-q,0,i,o)+A},bounceout:function(q,A,i,o){return(q/=
o)<1/2.75?i*7.5625*q*q+A:q<2/2.75?i*(7.5625*(q-=1.5/2.75)*q+0.75)+A:q<2.5/2.75?i*(7.5625*(q-=2.25/2.75)*q+0.9375)+A:i*(7.5625*(q-=2.625/2.75)*q+0.984375)+A},bounceinout:function(q,A,i,o){return q<o/2?ka.bouncein(q*2,0,i,o)/2+A:ka.bounceout(q*2-o,0,i,o)/2+i/2+A},cubicin:function(q,A,i,o){return i*(q/=o)*q*q+A},cubicout:function(q,A,i,o){return i*((q=q/o-1)*q*q+1)+A},cubicinout:function(q,A,i,o){if((q/=o/2)<1)return i/2*q*q*q+A;return i/2*((q-=2)*q*q+2)+A},elasticin:function(q,A,i,o,w,F){if(q==0)return A;
if((q/=o)==1)return A+i;F||(F=o*0.3);if(!w||w<m(i)){w=i;i=F/4}else i=F/t*x(i/w);return-(w*n(2,10*(q-=1))*s((q*o-i)*t/F))+A},elasticout:function(q,A,i,o,w,F){var P;if(q==0)return A;if((q/=o)==1)return A+i;F||(F=o*0.3);if(!w||w<m(i)){w=i;P=F/4}else P=F/t*x(i/w);return w*n(2,-10*q)*s((q*o-P)*t/F)+i+A},elasticinout:function(q,A,i,o,w,F){var P;if(q==0)return A;if((q/=o/2)==2)return A+i;F||(F=o*0.3*1.5);if(!w||w<m(i)){w=i;P=F/4}else P=F/t*x(i/w);if(q<1)return-0.5*w*n(2,10*(q-=1))*s((q*o-P)*t/F)+A;return w*
n(2,-10*(q-=1))*s((q*o-P)*t/F)*0.5+i+A},quadin:function(q,A,i,o){return i*(q/=o)*q+A},quadout:function(q,A,i,o){return-i*(q/=o)*(q-2)+A},quadinout:function(q,A,i,o){if((q/=o/2)<1)return i/2*q*q+A;return-i/2*(--q*(q-2)-1)+A},sinein:function(q,A,i,o){return-i*N(q/o*T)+i+A},sineout:function(q,A,i,o){return i*s(q/o*T)+A},sineinout:function(q,A,i,o){return-i/2*(N(Math.PI*q/o)-1)+A}};COG.tweenValue=function(q,A,i,o,w){function F(H){H=H?H:(new Date).getTime();if(ga+r<H){var $=H-P,la=i($,q,ea,o),na=P+o<=
H;H=!na;if(w){$=w(la,na,$);H=typeof $!="undefined"?$&&H:H}H&&animFrame(F)}}var P=(new Date).getTime(),ga=0,ea=A-q;animFrame(F);return{}};COG.easing=function(q){return ka[q.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(q,A){ka[q.replace(/[\-\_\s\.]/g,"").toLowerCase()]=A}})();
(function(){var C=/^P(\d+Y)?(\d+M)?(\d+D)?$/,T=/^(\d+H)?(\d+M)?(\d+S)?$/,t={8601:function(m){m=m.split("T");var n=null;n=null;var s=0,x=0;C.lastIndex=-1;n=C.exec(m[0]);s+=n[3]?parseInt(n[3].slice(0,-1),10):0;T.lastIndex=-1;n=T.exec(m[1]);x+=n[1]?parseInt(n[1].slice(0,-1),10)*3600:0;x+=n[2]?parseInt(n[2].slice(0,-1),10)*60:0;x+=n[3]?parseInt(n[3].slice(0,-1),10):0;return new r(s,x)}},r=COG.Duration=function(m,n){return{days:m?m:0,seconds:n?n:0}};COG.addDuration=function(){for(var m=new r,n=arguments.length;n--;){m.days+=
arguments[n].days;m.seconds+=arguments[n].seconds}if(m.seconds>=86400){m.days+=~~(m.seconds/86400);m.seconds%=86400}return m};COG.formatDuration=function(m){var n,s,x="";if(m.days)x=m.days+" days ";if(m.seconds){m=m.seconds;if(m>=3600){n=~~(m/3600);m-=n*3600}if(m>=60){s=Math.round(m/60);m-=s*60}if(n)x=x+n+(n>1?" hrs ":" hr ")+(s?(s>10?s:"0"+s)+" min ":"");else if(s)x=x+s+" min";else if(m>0)x=x+(m>10?m:"0"+m)+" sec"}return x};COG.parseDuration=function(m,n){var s=n?t[n]:null;if(s)return s(m);COG.Log.warn("Could not find duration parser for specified format: "+
n);return new r}})();COG.ObjectStore=function(){var C={},T={},t="obj_"+(new Date).getTime(),r=0,m=Object.prototype.hasOwnProperty;return{add:function(n,s){var x;s=s?s:"default";if(n&&n.constructor)if(!m.call(n,"id"))n.id=t+ ++r;x=T[s]?T[s]:T[s]=[];C[n.id]=x.length;x[n.length]=n}}};var CANI={};
(function(C){var T=[],t=0,r=false,m=C.register=function(n,s){T.push({section:n,run:s})};C.init=function(n){function s(){if(t<T.length){var N=T[t++];x[N.section]||(x[N.section]={});N.run(x[N.section],s)}else{for(N in x)C[N]=x[N];r=true;n&&n(C)}}var x={};if(r&&n)n(C);else{t=0;s()}};m("canvas",function(n,s){function x(){var A,i=N.getContext("2d");i.save();try{i.translate(50,50);i.beginPath();i.rect(0,0,20,20);A=i.isPointInPath(10,10)}finally{i.restore()}return A}var N=document.createElement("canvas"),
ka=typeof FlashCanvas!="undefined",q=typeof G_vmlCanvasManager!="undefnined";N.width=200;N.height=200;n.pipTransformed=ka||q?false:x();s()})})(CANI);
INTERACT=function(){function C(i){return function(o,w){i.addEventListener(o,w,false)}}function T(i){return function(o,w){i.removeEventListener(o,w,false)}}function t(i){return function(o,w){i.attachEvent("on"+o,w)}}function r(i,o){return{x:i?i:0,y:o?o:0,count:1}}function m(i,o){q.push(COG.extend({handler:null,checks:{},type:i},o))}function n(i){var o=0,w=0;if(i.offsetParent){do{o+=i.offsetLeft;w+=i.offsetTop;i=i.offsetParent}while(i)}return{left:o,top:w}}function s(i,o){return{source:i,target:o.target?
o.target:o.srcElement}}function x(i,o){for(var w=i.target?i.target:i.srcElement;w&&w!==o;)w=w.parentNode;return w&&w===o}function N(i,o){return{x:i.x-(o?o.left:0),y:i.y-(o?o.top:0)}}function ka(i,o){if(i.preventDefault){i.preventDefault();i.stopPropagation()}else if(typeof i.cancelBubble!="undefined")i.cancelBubble=true;o&&i.stopImmediatePropagation&&i.stopImmediatePropagation()}var q=[],A=function(i,o,w){w=COG.extend({binder:null,unbinder:null,observable:null},w);for(var F=w.observable,P=[],ga,ea,
H={bind:function(){return F.bind.apply(null,arguments)},unbind:function(){F.unbind();for($=0;$<P.length;$++)P[$].unbind();return H}},$=0;$<o.length;$++)P.push(o[$](i,F,w));F.bind("pointerDown",function(){ea=ga=0});F.bind("pointerMove",function(la,na,Ha,sa){ga+=sa.x||0;ea+=sa.y||0});F.bind("pointerUp",function(la,na,Ha){Math.abs(ga)>20||Math.abs(ea)>20||F.triggerCustom("tap",la,na,Ha)});return H};m("pointer",{handler:function(i,o,w){function F(y){if(y.pageX&&y.pageY)return r(y.pageX,y.pageY);else{var G=
document.documentElement,R=document.body;return r(y.clientX+(G&&G.scrollLeft||R&&R.scrollLeft||0)-(G&&G.clientLeft||R&&R.clientLeft||0),y.clientY+(G&&G.scrollTop||R&&R.scrollTop||0)-(G&&G.clientTop||R&&R.clientTop||0))}}function P(y){if(x(y,i))if(sa=$(y)){var G=F(y);i.style.cursor="move";ka(y,true);X=G.x;ia=G.y;Ma=r(X,ia);o.triggerCustom("pointerDown",s("mouse",y),Ma,N(Ma,n(i)))}}function ga(y){var G=F(y);za=G.x;ha=G.y;if(x(y,i))la(y,sa?"pointerMove":"pointerHover")}function ea(y){if(sa&&$(y)){sa=
false;if(x(y,i)){i.style.cursor="default";la(y,"pointerUp")}}}function H(y){if(x(y,i)){var G;y=y||window.event;if(y.detail)G=y.axis===2?-y.detail*na:0;else{G=y.wheelDeltaY?y.wheelDeltaY:y.wheelDelta;if(window.opera)G=-G}if(G!==0){var R=r(za,ha);o.triggerCustom("zoom",s("mouse",y),R,N(R,n(i)),G/Ha,"wheel");ka(y);y.returnValue=false}}}function $(y){y=y||window.event;return(y.which||y.button)==1}function la(y,G,R,ja,Ia){R=typeof R!="undefined"?R:za;ja=typeof ja!="undefined"?ja:ha;var E=R-X,M=ja-ia,O=
r(R,ja);o.triggerCustom(G,s("mouse",y),O,N(O,n(i)),r(E,M));if(typeof Ia=="undefined"||Ia){X=R;ia=ja}}w=COG.extend({},w);var na=120,Ha=na*8,sa=false,Ma,za,ha,X,ia;w.binder("mousedown",P);w.binder("mousemove",ga);w.binder("mouseup",ea);w.binder("dblclick",function(y){COG.info("captured double click");if(x(y,i)){var G=F(y);o.triggerCustom("doubleTap",s("mouse",y),G,N(G,n(i)))}});w.binder("mousewheel",H);w.binder("DOMMouseScroll",H);return{unbind:function(){w.unbinder("mousedown",P);w.unbinder("mousemove",
ga);w.unbinder("mouseup",ea);w.unbinder("mousewheel",H);w.unbinder("DOMMouseScroll",H)}}},checks:{touch:false}});m("pointer",{handler:function(i,o,w){function F(E){if(E.count<2)return 0;var M=E.x-E.next.x;E=E.y-E.next.y;return~~Math.sqrt(M*M+E*E)}function P(E,M,O){M=M?M:0;O=O?O:0;for(var oa={x:E.x-M,y:E.y-O,id:E.id,count:E.count},Aa=oa;E.next;){E=E.next;Aa=Aa.next={x:E.x-M,y:E.y-O,id:E.id}}return oa}function ga(E,M){var O=E[M?M:"touches"],oa,Aa;if(O.length===0)return null;Aa=oa={x:O[0].pageX,y:O[0].pageY,
id:O[0].identifier,count:O.length};for(var Ja=1,cb=O.length;Ja<cb;Ja++)Aa=Aa.next={x:O[Ja].pageX,y:O[Ja].pageY,id:O[Ja].identifier};return oa}function ea(E){if(x(E,i)){ha=n(i);var M=ga(E,"changedTouches"),O=P(M,ha.left,ha.top);if(!ia){X=sa;o.triggerCustom("pointerDown",s("touch",E),M,O)}ja&&o.triggerCustom("pointerDownMulti",s("touch",E),M,O);ia=ga(E);if(ia.count>1)G=F(ia);Ia=1;R=P(ia)}}function H(E){if(x(E,i)){ka(E);y=ga(E);if(X==sa)X=Math.abs(ia.x-y.x)>na||Math.abs(ia.y-y.y)>na?Ha:sa;if(X!=sa){X=
y.count>1?za:Ma;if(X==za)if(ia.count===1){ia=P(y);G=F(ia)}else{var M=F(y);if(Math.abs(G-M)<la)X=Ma;else{var O;O=y.x;var oa=y.next.x,Aa=y.y,Ja=y.next.y,cb=Aa<Ja?Aa:Ja;O={x:(O<oa?O:oa)+(Math.abs(O-oa)>>1),y:cb+(Math.abs(Aa-Ja)>>1)};M=M/G;oa=M-Ia;o.triggerCustom("zoom",s("touch",E),O,N(O,ha),oa,"pinch");Ia=M}}X==Ma&&o.triggerCustom("pointerMove",s("touch",E),y,P(y,ha.left,ha.top),r(y.x-R.x,y.y-R.y));ja&&o.triggerCustom("pointerMoveMulti",s("touch",E),y,P(y,ha.left,ha.top))}R=P(y)}}function $(E){if(x(E,
i)){var M=ga(E,"changedTouches"),O=P(M,ha.left,ha.top);y=ga(E);if(!y){o.triggerCustom("pointerUp",s("touch",E),M,O);ia=null}ja&&o.triggerCustom("pointerUpMulti",s("touch",E),M,O)}}w=COG.extend({detailed:false,inertia:false},w);var la=20,na=7,Ha=0,sa=1,Ma=2,za=3,ha,X,ia,y,G,R,ja=w.detailed,Ia=1;w.binder("touchstart",ea);w.binder("touchmove",H);w.binder("touchend",$);COG.info("initialized touch handler");return{unbind:function(){w.unbinder("touchstart",ea);w.unbinder("touchmove",H);w.unbinder("touchend",
$)}}},checks:{touch:true}});return{register:m,watch:function(i,o,w){o=COG.extend({bindTarget:null,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},o);capabilities=COG.extend({touch:"ontouchstart"in window},w);if(!o.observable){COG.info("creating observable");o.observable=COG.observable({});globalOpts=o}o.binder=(o.isIE?t:C)(o.bindTarget||document);o.unbinder=(o.isIE?t:T)(o.bindTarget||document);w=o.types;for(var F=capabilities,P=[],ga=q.length;ga--;){var ea=q[ga],H=!w||w.indexOf(ea.type)>=
0,$=true;for(var la in ea.checks){var na=ea.checks[la];COG.info("checking "+la+" capability. require: "+na+", capability = "+F[la]);$=$&&na===F[la]}if(H&&$)P[P.length]=ea.handler}return new A(i,P,o)}}}();var T5={};
(function(C){function T(){return(new Date).getTime()}function t(a,e){e=Yb.call(e);if(e=="finite")return!Zb[cb](+a);return e=="null"&&a===null||e==typeof a||e=="object"&&a===Object(a)||e=="array"&&Array.isArray&&Array.isArray(a)||$b.call(a).slice(8,-1).toLowerCase()==e}function r(a,e){this.x=a||0;this.y=e||0}function m(a,e,d,c){this.x=a||0;this.y=e||0;this.w=d||0;this.h=c||0;this.x2=this.x+this.w;this.y2=this.y+this.h}function n(a,e){var d=new Fb(Math.sqrt(256<<a)|0);e&&e.zoomLevel===a&&e.copyInto(d);
d.zoomLevel=a;return d}function s(a){a=a||(new Date).getTime();for(var e=0;e<Za.length;){var d=Za[e],c=Wa[d],b=Wa[d].image&&Wa[d].image.complete&&Wa[d].image.width>0,f=a-c.start;f=b||f>=ac;if(b){b=c.callbacks;Gb[d]=c.image;for(var g=0;g<b.length;g++)b[g](c.image,true)}if(f){Za.splice(e,1);delete Wa[d]}else e++}Za.length>0&&animFrame(s)}function x(a,e){var d=a&&e?Gb[a]:null;if(d&&d&&d.complete&&d.width>0)e(d);else{if(d=Wa[a])d.callbacks.push(e);else{d=new Image;d.id="_ldimg"+ ++bc;Wa[a]={start:(new Date).getTime(),
image:d,callbacks:[e]};d.src=a;Za[Za.length]=a}animFrame(s)}}function N(a,e,d,c,b,f){this.x=a;this.y=e;this.w=c||256;this.h=c||256;this.x2=this.x+this.w;this.y2=this.y+this.h;this.url=d;this.id=f||a+"_"+e;this.loaded=false;this.image=null}function ka(a){a=a?a:(new Date).getTime();if(a-Hb>cc){for(var e=db.splice(0),d=e.length;d--;)e[d](a);Hb=a}db.length&&animFrame(ka)}function q(a){var e=db.length==0;db[db.length]=a;e&&animFrame(ka)}function A(a,e,d,c,b){b=COG.extend({easing:"sine.out",duration:1E3,
progress:null,complete:null,autoInvalidate:true},b);var f=(new Date).getTime(),g=a[e],h=e=="translate",l=b.autoInvalidate,j=d.length&&c.length&&d.length==c.length?d.length:0,k=Array(j),B=Array(j),I=COG.easing(b.easing),S=b.duration,J=b.progress,D=function(L){var V=L-f;L=f+S<=L;for(var fa=a.layer?a.layer.view:null,ca,ma=j;ma--;){ca=I(V,d[ma],k[ma],S);B[ma]=h?ca|0:ca}g.apply(a,B);l&&fa&&fa.invalidate();if(J){V=[].concat(L?c:B);V.unshift(L);J.apply(a,V)}if(L){a.animations--;g.apply(a,c);b.complete&&
b.complete.apply(a,c)}else q(D)};if(g&&g.apply&&j>0){S=S?S:DEFAULT_DURATION;for(e=j;e--;)k[e]=c[e]-d[e];a.animations++;q(D)}}function i(a){a=COG.extend({fill:true,stroke:false,markerStyle:"simple",hoverStyle:"highlight",typeName:"Marker"},a);Da.call(this,a)}function o(a,e){e=COG.extend({simplify:false,fill:true,typeName:"Poly"},e);var d=e.simplify;Da.call(this,e);COG.extend(this,{getPoints:function(){return[].concat(a)},resync:function(c){var b,f,g,h,l,j;c.syncXY(a);j=this.points=Xa.floor(d?Xa.simplify(a):
a);for(var k=j.length;k--;){c=j[k].x;b=j[k].y;h=t(h,wa)||c<h?c:h;l=t(l,wa)||b<l?b:l;f=t(f,wa)||c>f?c:f;g=t(g,wa)||b>g?b:g}this.updateBounds(new m(h,l,f-h,g-l),true)}});this.haveData=a&&a.length>=2}function w(a,e){e.fill=false;o.call(this,a,e)}function F(a){function e(){if(g&&g.width>0){if(!this.centerOffset)this.centerOffset=new r(-g.width>>1,-g.height>>1);this.updateBounds(new m(this.xy.x+this.centerOffset.x,this.xy.y+this.centerOffset.y,g.width,g.height),false)}}function d(l){if(this.imageUrl=l){var j=
this;x(this.imageUrl,function(k,B){g=k;if(B){var I=h.layer?h.layer.view:null;I&&I.invalidate()}e.apply(j)})}}a=COG.extend({image:null,imageUrl:null,centerOffset:null,typeName:"Image"},a);var c=Da.prototype.resync,b=0,f=0,g=a.image;Da.call(this,a);var h=COG.extend(this,{changeImage:d,getProps:function(){this.bounds||e(this,g);return{image:g,x:this.xy.x+b,y:this.xy.y+f}},resync:function(l){c.call(this,l);e.call(this)}});g||d.call(this,this.imageUrl);if(this.centerOffset){b=this.centerOffset.x;f=this.centerOffset.y}}
function P(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.centerOffset=Xa.invert(a.imageAnchor);F.call(this,a)}function ga(a){a=COG.extend({startAngle:0,endAngle:Math.PI*2,typeName:"Arc"},a);Da.call(this,a)}function ea(a){a=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,style:null,minXY:null,maxXY:null},a);this.view=null;this.visible=true;COG.observable(COG.extend(this,a))}function H(a,e){if(a&&a.split){var d=a.split(dc);if(d.length>1){a=d[0];e=d[1]}}else if(a&&a.lat){e=a.lon;
a=a.lat}this.lat=parseFloat(a||0);this.lon=parseFloat(e||0)}function $(a){a=parseFloat(a)*Na;a=M(a);var e=kb*a;return E((1+a)/(1-a)*ja((1-e)/(1+e),kb))/2}function la(a){return za/(256<<a)}function na(a,e){var d=kb*M(a);return ha-2*Aa(e*ja((1-d)/(1+d),kb/2))}function Ha(a,e,d,c){e=sa(e);a.add(c(e,d));return e.length}function sa(a){var e=a?a.length:0,d=Array(e);for(e=e;e--;)d[e]=new H(a[e][1],a[e][0]);return xa.vectorize(d,Ib)}COG.observable(C);window.animFrame=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},1E3/60)}}();var Ma=Array.prototype.indexOf||function(a){for(var e=0;e<this.length;e++)if(this[e]===a)return e;return-1},za=Math.PI*2,ha=Math.PI/2,X=Math.abs,ia=Math.ceil,y=Math.round,G=Math.min,R=Math.max,ja=Math.pow,Ia=Math.sqrt,E=Math.log,M=Math.sin,O=Math.asin,oa=Math.cos,Aa=Math.atan,Ja=Math.atan2,cb="hasOwnProperty",
Zb={NaN:1,Infinity:1,"-Infinity":1},Yb=String.prototype.toLowerCase,$b=Object.prototype.toString,wa="undefined",ec="number",dc=/[\,\s]/,fc=T5.newCanvas=function(a,e){var d=document.createElement("canvas");d.width=a?a:0;d.height=e?e:0;T5.trigger("createCanvas",d);return d},Jb=function(){var a={};return{init:function(e,d){var c=a[e];if(!c)throw Error("Unable to locate requested generator: "+e);return new c(d)},register:function(e,d){a[e]=d}}}(),tb=function(){var a={};return{find:function(e){return(a[e]||
[])[0]},register:function(e,d){a[e]||(a[e]=[]);a[e].push(d())}}}(),ya=function(){function a(c){for(var b=0;b<c.length;b++){var f=c[b];if(typeof document.body.style[f]!="undefined")return f}}var e={"-webkit-user-select":"none",position:"absolute",overflow:"hidden"},d;d=a(["-webkit-transform","MozTransform"]);css3DTransformProp=a(["WebkitPerspective","MozPerspective"]);return{supportTransforms:d,create:function(c,b,f){c=document.createElement(c);var g=[];f=f||{};c.className=b||"";for(var h in f)g[g.length]=
h+": "+f[h];c.style.cssText=g.join(";");return c},move:function(c,b,f,g){if(d)c.style[d]="translate("+b+"px, "+f+"px) "+(g||[]).join(" ");else{c.style.left=b+"px";c.style.top=f+"px"}},styles:function(c){return COG.extend({},e,c)}}}();r.prototype={constructor:r,add:function(){for(var a=this.x,e=this.y,d=arguments.length;d--;){a+=arguments[d].x;e+=arguments[d].y}return new r(a,e)},equals:function(a){return this.x===a.x&&this.y===a.y}};m.prototype={constructor:m};var Xa=function(){function a(c,b){return d(c.x-
b.x,c.y-b.y)}function e(c,b){b=b||c.length;if(b<=1)return null;for(var f=Array(b-1),g=Array(b-1),h=0,l,j=0;j<b-1;j++){l=a(c[j],c[j+1]);f[j]=Ia(l.x*l.x+l.y*l.y);g[j]=h+=f[j]}return{edges:f,accrued:g,tota:h}}function d(c,b){return new r(c,b)}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var c=0,b=0,f=arguments.length;f--;){c+=arguments[f].x;b+=arguments[f].y}return d(c,b)},absSize:function(c){return R(X(c.x),X(c.y))},copy:function(c){return c?d(c.x,c.y):null},diff:a,
distance:function(c,b){return e(c,b).total},edges:e,equals:function(c,b){return c.equals(b)},extendBy:function(c,b,f){var g=oa(b)*f|0;b=M(b)*f|0;return d(c.x-g,c.y-b)},floor:function(c){for(var b=Array(c.length),f=c.length;f--;)b[f]=d(c[f].x|0,c[f].y|0);return b},getRect:function(c){for(var b,f,g,h,l=c.length;l--;){var j=c[l];b=t(b,wa)||j.x<b?j.x:b;f=t(f,wa)||j.y<f?j.y:f;g=t(g,wa)||j.x>g?j.x:g;h=t(h,wa)||j.y>h?j.y:h}return new m(b,f,g-b,h-f)},init:d,invert:function(c){return d(-c.x,-c.y)},min:function(c,
b){return d(c.x<b.x?c.x:b.x,c.y<b.y?c.y:b.y)},max:function(c,b){return d(c.x>b.x?c.x:b.x,c.y>b.y?c.y:b.y)},offset:function(c,b,f){return d(c.x+b,c.y+(f||b))},scale:function(c,b){return d(c.x/b|0,c.y/b|0)},simplify:function(c,b){if(!c)return null;b=b?b:Xa.VECTOR_SIMPLIFICATION;for(var f=[],g=null,h=c.length;h--;){var l=c[h];if(include=!g||h===0||X(l.x-g.x)+X(l.y-g.y)>b){f.unshift(l);g=l}}return f},theta:function(c,b,f){f=O((c.y-b.y)/f);return c.x>b.x?f:Math.PI-f},toString:function(c){return c?c.x+
", "+c.y:""}}}(),Qa=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),eb=function(){function a(d){return e(d.x,d.y,d.x2,d.y2)}function e(d,c,b,f){return new m(d,c,(b||d)-d,(f||c)-c)}return{buffer:function(d,c,b){return eb.init(d.x-c,d.y-(b||c),d.x2+c,d.y2+(b||c))},center:function(d){return new r(d.x+(d.w>>1),d.y+(d.h>>1))},copy:a,diagonalSize:function(d){return Ia(d.w*d.w+d.h*d.h)},fromCenter:function(d,c,b,f){b=b>>1;f=f>>1;return e(d-b,c-f,d+b,c+f)},init:e,intersect:function(d,
c){var b=R(d.x,c.x),f=R(d.y,c.y),g=G(d.x2,c.x2),h=G(d.y2,c.y2);b=e(b,f,g,h);return b.w>0&&b.h>0?b:null},toString:function(d){return d?"["+d.x+", "+d.y+", "+d.x2+", "+d.y2+"]":""},union:function(d,c){if(d.w===0||d.h===0)return a(c);else if(c.w===0||c.h===0)return a(d);else{var b=G(d.x,c.x),f=G(d.y,c.y),g=R(d.x2,c.x2),h=R(d.y2,c.y2);b=e(b,f,g,h);return b.w>0&&b.h>0?b:null}}}}();Hits=function(){return{diffHits:function(a,e){var d=[],c={},b;for(b=e.length;b--;)c[e[b].target.id]=true;for(b=a.length;b--;)c[a[b].target.id]||
(d[d.length]=a[b]);return d},init:function(a,e,d,c){return{type:a,x:c.x|0,y:c.y|0,elements:[],absXY:e,relXY:d}},initHit:function(a,e,d){return{type:a,target:e,drag:d}},triggerEvent:function(a,e,d,c){e.triggerCustom(a.type+(d?d:"Hit"),{hitType:a.type},c?c:a.elements,a.absXY,a.relXY,new r(a.x,a.y))}}}();var Fb=function(a){function e(b,f){var g=d[b],h;g||(g=d[b]=[]);(h=g[f])||(h=g[f]=[]);return h}a=a||128;var d=[],c={};return{copyInto:function(b){for(var f in c){var g=c[f];b.insert(g.bounds||g,g,f)}},
insert:function(b,f,g){var h=b.x/a|0,l=b.y/a|0,j=(b.x+b.w)/a|0;b=(b.y+b.h)/a|0;g=g||f.id||COG.objId("spatial");c[g]=f;for(f=h;f<=j;f++)for(h=l;h<=b;h++)e(f,h).push(g)},remove:function(b,f,g){g=g||f.id;if(c[g]){var h=b.x/a|0;f=b.y/a|0;var l=(b.x+b.w)/a|0;b=(b.y+b.h)/a|0;delete c[g];for(h=h;h<=l;h++)for(var j=f;j<=b;j++){var k=e(h,j),B=Ma.call(k,g);B>=0&&k.splice(B,1)}}},search:function(b){var f=b.y/a|0,g=(b.x+b.w)/a|0,h=(b.y+b.h)/a|0,l=[],j=[];for(b=b.x/a|0;b<=g;b++)for(var k=f;k<=h;k++)l=l.concat(e(b,
k));l.sort();for(f=l.length;f--;){g=l[f];if(h=c[g])j[j.length]=h;for(;f>0&&l[f-1]==g;)f--}return j}}},ac=3E4,Gb={},bc=0;(new Date).getTime();var Wa={},Za=[];N.prototype={constructor:N,load:function(a){var e=this;x(this.url,function(d){e.loaded=true;e.image=d;a&&a()})}};var gc=function(){return COG.observable({fastpan:true,applyStyle:function(){},applyTransform:function(a,e,d){return{restore:null,x:e,y:d}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getOffset:function(){return new r},
getViewport:function(){},hitTest:function(){return false},prepare:function(){},projectXY:null,reset:function(){}})},Kb={},fb=C.registerRenderer=function(a,e){Kb[a]=e},hc=C.attachRenderer=function(a,e,d,c,b){a=a.split("/");for(var f=new gc(e,d,c,b),g=0;g<a.length;g++){var h=Kb[a[g]];if(h)f=new h(e,d,c,b,f)}return f};fb("canvas",function(a,e,d,c,b){function f(v,Y,W){var K,da;S[Y]=function(Z){for(K=ca.length;K--;)if(da=W[ca[K]])Z[ma[K]]=da}}function g(v,Y,W){var K=false;if(Y)K=k.isPointInPath(D?Y.x-
B:Y.relXY.x,D?Y.y-I:Y.relXY.y);return{draw:W||fa,viewport:v,hit:K,vpX:B,vpY:I,context:k}}c=COG.extend({},c);var h,l,j,k,B=0,I=0,S={},J=null,D=CANI.canvas.pipTransformed,L={},V=function(){},fa=function(){this.fill&&k.fill();this.stroke&&k.stroke()},ca=["fill","stroke","lineWidth","opacity"],ma=["fillStyle","strokeStyle","lineWidth","globalAlpha"];if(e){h=e.offsetWidth;l=e.offsetHeight;j=fc(h,l);j.style.cssText="position: absolute; z-index: 1;";a.attachFrame(j,true);k=null}d=COG.extend(b,{applyStyle:function(v){var Y=
S[v],W=k&&k.canvas?k.canvas.id:"default",K;L[W]||(L[W]=[]);K=L[W].pop()||"basic";if(Y){L[W].push(v);Y(k);return K}},applyTransform:function(v){if(v.translateX!==0||v.translateY!==0||v.scaling!==1||v.rotation!==0){k.save();J={undo:function(){k.restore();J=null},x:v.xy.x,y:v.xy.y};k.translate(v.xy.x-B+v.translateX,v.xy.y-I+v.translateY);v.rotation!==0&&k.rotate(v.rotation);v.scaling!==1&&k.scale(v.scaling,v.scaling)}return J},drawTiles:function(v,Y,W){for(var K,da=B-256,Z=I-256,pa=v.x2,aa=v.y2,va=Y.length;va--;){v=
Y[va];if(K=v.x>=da&&v.x<=pa&&v.y>=Z&&v.y<=aa)if(!v.loaded&&W)v.load(a.invalidate);else v.image&&k.drawImage(v.image,v.x-B,v.y-I)}},prepare:function(v,Y){var W,K=false,da=Y.scaled||Y;if(k)k.restore();else k=j.getContext("2d");for(W=v.length;W--;)K=K||v[W].clip;B=da.x;I=da.y;if(k){K||k.clearRect(0,0,h,l);k.save()}k.globalCompositeOperation="source-over";return k},prepArc:function(v,Y,W){k.beginPath();k.arc(v.xy.x-(J?J.x:B),v.xy.y-(J?J.y:I),v.size>>1,v.startAngle,v.endAngle,false);return g(Y,W)},prepImage:function(v,
Y,W,K){var da=(K.x||v.xy.x)-(J?J.x:B),Z=(K.y||v.xy.y)-(J?J.y:I),pa=K.image||v.image;if(pa){k.beginPath();k.rect(da,Z,K.width||pa.width,K.height||pa.height);return g(Y,W,function(){k.drawImage(pa,da,Z,K.width||pa.width,K.height||pa.height)})}},prepMarker:function(v,Y,W){var K=v.xy.x-(J?J.x:B),da=v.xy.y-(J?J.y:I),Z=v.size,pa=undefined;k.beginPath();switch(v.markerStyle.toLowerCase()){case "image":pa=V;k.rect(K-(Z>>1),da-(Z>>1),Z,Z);if(v.reset&&v.image){v.image=null;v.reset=false}v.image?k.drawImage(v.image,
K-(Z>>1),da-(Z>>1),Z,Z):x(v.imageUrl,function(aa){v.image=aa;k.drawImage(v.image,K-(Z>>1),da-(Z>>1),Z,Z)});break;default:k.moveTo(K,da);k.lineTo(K-(Z>>1),da-Z);k.lineTo(K+(Z>>1),da-Z);k.lineTo(K,da);break}return g(Y,W,pa)},prepPoly:function(v,Y,W,K){var da=true;v=K.points||v.points;K=J?J.x:B;var Z=J?J.y:I;k.beginPath();for(var pa=v.length;pa--;){var aa=v[pa].x-K,va=v[pa].y-Z;if(da){k.moveTo(aa,va);da=false}else k.lineTo(aa,va)}return g(Y,W)},getContext:function(){return k}});(function(){for(var v in T5.styles)f(null,
v,T5.styles[v]);T5.bind("styleDefined",f)})();d.bind("detach",function(){e.removeChild(j)});return d});fb("dom",function(a,e,d,c,b){function f(k){var B=k.image=new Image;l[k.id]=k;B.src=k.url;B.onload=function(){if(j[k.id])h.appendChild(this);else k.image=null};B.style.cssText="-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;";
return B}function g(k,B,I){var S=[];for(var J in k){var D=k[J];if(I?D[I]:!B[J]){if(D.image&&D.image.parentNode){h.removeChild(D.image);D.image=null}S[S.length]=J}}for(B=S.length;B--;)delete k[S[B]]}var h=null,l={},j={};h=ya.create("div","",ya.styles({width:e.offsetWidth+"px",height:e.offsetHeight+"px"}));e.childNodes.length>0?e.insertBefore(h,e.childNodes[0]):e.appendChild(h);a.attachFrame(h);a=COG.extend(b,{drawTiles:function(k,B,I){for(var S,J=k.x,D=k.y,L=B.length;L--;){k=B[L];if(k.url){(S=k.image||
(I?f(k):null))&&ya.move(S,k.x-J,k.y-D);j[k.id]=k}}}});a.bind("predraw",function(){g(l,j);j={}});a.bind("detach",function(){e.removeChild(h)});a.bind("reset",function(){for(g(l,j={});h.childNodes.length>0;)h.removeChild(h.childNodes[0])});return a});var ub=C.styles={},ic=C.defineStyle=function(a,e){ub[a]=e;C.trigger("styleDefined",a,ub[a]);return a},Lb=C.defineStyles=function(a){for(var e in a)ic(e,a[e])};C.getStyle=function(a){return ub[a]};C.loadStyles=function(a){COG.jsonp(a,function(e){Lb(e)})};
Lb({basic:{fill:"#ffffff"},highlight:{fill:"#ff0000"},waypoints:{lineWidth:4,stroke:"#003377",fill:"#ffffff"},waypointsHover:{lineWidth:4,stroke:"#ff0000",fill:"#ffffff"}});var Sb=function(a){function e(p,u,z,Q){v(G(R(qa+ja(2,Q)-1,0.5),2))}function d(p){var u=p|0;p=u+Math.round((p-u)*50)/50;if(p!==qa){qa=p;p=E(qa)/Math.LN2|0;if(Ea){Oa.removeChild(Ea.element);Ea=null}if(p!==0){qa=ja(2,p);Y($a+p,jc,kc)}Fa++}}function c(p,u){var z=renderer&&renderer.projectXY?renderer.projectXY(p,u):null;if(!z){z=ba.getViewport();
var Q=1/qa;z=new r(z?z.x+p*Q:p,z?z.y+u*Q:u)}return z}function b(p,u,z){W("doubleTap",u,z,c(z.x,z.y));a.scalable&&v(2,c(z.x,z.y),lc,null,mc)}function f(p,u,z){Pa=null;vb=true;V("down",u,z)}function g(p,u,z){V("hover",u,z)}function h(p,u,z,Q){J(u,z,false);if(!Pa){Ka=Q.x;La=Q.y}}function l(p,u,z){J(u,z,true);vb=false}function j(){clearTimeout(Mb);Mb=setTimeout(function(){renderer.checkSize()},250)}function k(p,u,z){V("tap",u,z);W("tap",u,z,c(z.x,z.y,true))}function B(p){renderer=hc(p||a.renderer,ba,
Ra,Sa,a);Nb=a.fastpan&&renderer.fastpan;S()}function I(p,u){u.id=p;u.added=T();u.view=ba;u.trigger("parentChange",ba,Ra,nc);aa.push(u);aa.sort(function(z,Q){var U=Q.zindex-z.zindex;if(U===0)U=Q.added-z.added;return U});va=aa.length;return u}function S(){Ga&&Ga.unbind();if(renderer){Ga=INTERACT.watch(renderer.interactTarget||Sa);if(a.scalable){Ga.bind("zoom",e);Ga.bind("doubleTap",b)}Ga.bind("pointerDown",f);Ga.bind("pointerMove",h);Ga.bind("pointerUp",l);a.captureHover&&Ga.bind("pointerHover",g);
Ga.bind("tap",k)}}function J(p,u,z){if(Pa){p=c(u.x,u.y);Pa.drag.call(Pa.target,Pa,p.x,p.y,z)&&Fa++;if(z)Pa=null}}function D(p,u){Sa=document.getElementById(u);Sa.appendChild(Oa=ya.create("div","",ya.styles({width:Sa.offsetWidth+"px",height:Sa.offsetHeight+"px"})));lb=Oa.offsetWidth+gb*2;mb=Oa.offsetHeight+gb*2;wb=lb/2;xb=mb/2;oc=Sa.offsetWidth/2;pc=Sa.offsetHeight/2;Oa.appendChild(Ra=ya.create("div","",ya.styles({width:lb+"px",height:mb+"px","z-index":2,margin:-gb+"px 0 0 "+-gb+"px"})));B()}function L(p){var u=
[],z,Q=false,U;p=p||(new Date).getTime();if(Q=p-Ob>qc){self.panSpeed=panSpeed=X(Ka)+X(La);U=X(ta-yb)>=Pb||X(ua-zb)>=Pb;z=qa!==Qb;if(panSpeed>0||z)Fa++;U&&panSpeed<da&&ma();nb.index++;nb.draw=Fa||panSpeed||rc||sc;ba.trigger("enterFrame",p,nb);Ob=p}if(renderer&&Q&&nb.draw){ob+=Ka;pb+=La;if(Ka||La)ba.trigger("pan");if(qa!==1&&ya.supportTransforms)u[u.length]="scale("+qa+")";if(!Nb||qa!==1||panSpeed<Z){ta=ta-ob|0;ua=ua-pb|0;U=ca();renderer.trigger("predraw",U);if(renderer.prepare(aa,U,p,Ba)){Q=pb=z=ob=
Fa=0;for(ii=va;ii--;){var ra=aa[ii];if(ra.visible){var Ca=ra.style?renderer.applyStyle(ra.style,true):null;ra.draw(renderer,U,ba,p,Ba);Ca&&renderer.applyStyle(Ca)}}renderer.trigger("render",U);ba.trigger("drawComplete",U,p);Qb=qa;ya.move(Ra,z,Q,u)}}else ya.move(Ra,ob,pb,u);if(Ea)ya.move(Ea.element,Ea.x+=Ka,Ea.y+=La,Ea.extraTransforms);if(vb||!a.inertia)La=Ka=0;else if(Ka!=0||La!=0){Ka*=0.8;La*=0.8;if(X(Ka)<0.5)Ka=0;if(X(La)<0.5)La=0}if(Ba){p=Ba?Ba.elements:[];if(hb&&hb.type==="hover"){u=Hits.diffHits(hb.elements,
p);u.length>0&&Hits.triggerEvent(hb,ba,"Out",u)}if(p.length>0){z=Ba.x;Q=Ba.y;for(u=p.length;u--;){U=p[u];ra=z;Ca=Q;var Ua=U&&U.drag&&(!U.canDrag||U.canDrag(U,ra,Ca));if(Ua){Pa=U;Pa.startX=ra;Pa.startY=Ca}if(Ua)break}Hits.triggerEvent(Ba,ba)}hb=p.length>0?COG.extend({},Ba):null;Ba=null}}animFrame(L)}function V(p,u,z){Ba=Hits.init(p,u,z,c(z.x,z.y,true));for(p=va;p--;)Ab=Ab||(aa[p].hitGuess?aa[p].hitGuess(Ba.x,Ba.y,ba):false);Ab&&Fa++}function fa(){Fa++}function ca(){var p=new m(ta,ua,lb,mb);p.scaleFactor=
qa;return p}function ma(){var p=ca();if(p){if(ab||bb)if(p){var u=qb?ta+(p.w>>1):ta,z=rb?ua+(p.h>>1):ua,Q=p.w,U=p.h;if(ab&&ab>Q)if(u+Q>ab)ta=qb?ta:ab-Q;else if(u<0)ta=qb?ta:0;if(bb&&bb>U)if(z+U>bb)ua=rb?ua:bb-U;else if(z<0)ua=rb?ua:0}yb=ta;zb=ua;W("refresh",ba,p);Fa++}}function v(p,u,z,Q,U){var ra;if(!tc){z=false;ra=y(E(p)/Math.LN2);p=ja(2,ra)}z?COG.tweenValue(qa,p,z,U,function(Ca,Ua){p=Ca;if(Ua){ra=y(E(p)/Math.LN2);p=ja(2,ra);Q&&Q()}d(p)}):d(p);return ba}function Y(p,u,z){p=R(a.minZoom,G(a.maxZoom,
p));if(p!==$a){var Q=ja(2,p-$a),U=wb/Q|0,ra=xb/Q|0;if(ya.supportTransforms&&X(p-$a)<=1){var Ca=Ra.cloneNode(true);Ea&&Oa.removeChild(Ea.element);Oa.insertBefore(Ca,Ra);Ea={element:Ca,x:0,y:0,extraTransforms:ya.supportTransforms?["scale("+qa+")"]:[]}}$a=p;K(((u?u:ta+wb)-U)*Q,((z?z:ua+xb)-ra)*Q);zb=yb=0;W("zoomLevelChange",p);qa=1;renderer.trigger("reset");ma()}}function W(){for(var p=ba.trigger.apply(null,arguments).cancel,u=aa.length;u--;)p=aa[u].trigger.apply(null,arguments).cancel||p;return!p}function K(p,
u,z,Q,U){function ra(){Ca+=1;if(Ca>=2){Rb=false;U&&U()}}var Ca=0;if(z&&panSpeed===0){COG.tweenValue(ta,p,z,Q,function(Ua,Bb){ta=Ua|0;(Bb?ra:fa)();return panSpeed===0});COG.tweenValue(ua,u,z,Q,function(Ua,Bb){ua=Ua|0;(Bb?ra:fa)();return panSpeed===0});Rb=true}else{ta=p|0;ua=u|0;U&&U()}}a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastpan:true,fastpanPadding:128,inertia:true,refreshDistance:256,pannable:false,scalable:false,fps:60,minZoom:1,maxZoom:1,renderer:"canvas",zoomLevel:1},
a);var da=2,Z=5,pa={},aa=[],va=0,Ra=null,Ea=null,Oa=null,Sa,Pa=null,nc=null,uc=!t(window.attachEvent,wa),Ab=false,Nb=true,vb=false,Ka=0,La=0,rc=0,sc=0,Pb=a.refreshDistance,ta=0,ua=0,ob=0,pb=0,yb=0,zb=0,ab=null,bb=null,qb=false,rb=false,gb=a.fastpan?a.fastpanPadding:0,Cb=[],Ba=null,hb=null,Mb=0,qa=1,Qb=1,Ob=0,Ga=null,nb={index:0,draw:false},tc=true,Rb=false,qc=1E3/a.fps|0,Fa=0,lb,mb,wb,xb,oc,pc,jc,kc,$a=a.zoomLevel,lc=COG.easing("quad.out"),mc=300,ba={id:a.id,padding:gb,panSpeed:0,attachFrame:function(p,
u){Cb[Cb.length]=p;u&&Ra.appendChild(p)},detach:function(){renderer&&renderer.trigger("detach");Ga&&Ga.unbind();if(Oa){Sa.removeChild(Oa);Ea=Ra=Oa=null}Cb=[]},eachLayer:function(p){for(var u=va;u--;)p(aa[u])},getLayer:function(p){for(var u=0;u<va;u++)if(aa[u].id===p)return aa[u];return null},getZoomLevel:function(){return $a},setLayer:function(p,u){for(var z=0;z<va;z++)if(aa[z].id===p){aa.splice(z,1);break}if(u){I(p,u);u.trigger("refresh",ba,ca());ba.trigger("layerChange",ba,u)}Fa++;return u},invalidate:fa,
refresh:ma,resetScale:function(){qa=1},scale:v,setZoomLevel:Y,syncXY:function(){},triggerAll:W,removeLayer:function(p){a:{for(var u=va;u--;)if(aa[u].id===p){p=u;break a}p=-1}if(p>=0&&p<va){ba.trigger("layerRemove",ba,aa[p]);aa.splice(p,1);Fa++}va=aa.length},getOffset:function(){return new r(ta,ua)},getRenderer:function(){return renderer},getScaleFactor:function(){return qa},setMaxOffset:function(p,u,z,Q){ab=p;bb=u;qb=z;rb=Q},getViewport:ca,updateOffset:K,pan:function(p,u){Ka=p;La=u;Fa++}};COG.observable(ba);
ba.bind("resync",function(){});ba.bind("resize",function(){renderer.checkSize()});COG.configurable(ba,["container","captureHover","scalable","pannable","inertia","minZoom","maxZoom","renderer","zoom"],COG.paramTweaker(a,null,{container:D,captureHover:S,scalable:S,pannable:S,renderer:function(p,u){if(renderer){renderer.trigger("detach");renderer=null}B(u);Fa++}}),true);CANI.init(function(p){ba.markers=I("markers",new sb({zindex:20}));pa=p;D(null,a.container);uc?window.attachEvent("onresize",j):window.addEventListener("resize",
j,false)});animFrame(L);return ba},Da=function(a){a=COG.extend({style:null,xy:null,size:10,fill:false,stroke:true,draggable:false,observable:true,properties:{},typeName:"Shape"},a);COG.extend(this,a);this.id=COG.objId(this.typeName);this.view=this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};Da.prototype={constructor:Da,animate:function(a,e,d,c){A(this,a,e,d,c)},drag:null,draw:null,getProps:null,resync:function(a){if(this.xy){a.syncXY([this.xy]);
this.size&&this.updateBounds(eb.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},rotate:function(a){this.rotation=a},scale:function(a){this.scaling=a},translate:function(a,e){this.translateX=a;this.translateY=e},updateBounds:function(a,e){a&&(!this.bounds||a.x!=this.bounds.x||a.y!=this.bounds.y)&&this.trigger("move",this,a,this.bounds);this.bounds=a;if(e)this.xy=eb.center(this.bounds)}};var cc=1E3/60|0,db=[],Hb=0;i.prototype=COG.extend(Da.prototype,{constructor:i});o.prototype=COG.extend({},
Da.prototype,{constructor:o});w.prototype=COG.extend({},o.prototype);F.prototype=COG.extend({},Da.prototype,{constructor:F});P.prototype=COG.extend({},F.prototype,{constructor:P});ga.prototype=COG.extend(Da.prototype,{constructor:ga});ea.prototype={constructor:ea,clip:null,cycle:function(){},draw:function(){},hitGuess:null};fb=function(a,e){function d(h,l){var j=l&&l.getZoomLevel?l.getZoomLevel():0;f[j]||(f[j]=n(j));b=f[j]}e=COG.extend({imageLoadArgs:{}},e);var c=a?Jb.init(a,e).run:null,b=null,f=
[],g=COG.extend(new ea(e),{draw:function(h,l,j){h.drawTiles&&h.drawTiles(l,b.search(eb.buffer(l,128)),j.panSpeed<2)}});g.bind("refresh",function(h,l,j){var k=(new Date).getTime();b&&c(l,j,b,function(){l.invalidate();COG.info("GEN COMPLETED IN "+((new Date).getTime()-k)+" ms")})});g.bind("parentChange",d);g.bind("resync",d);return g};var Tb=function(a){function e(j,k,B,I){var S=this.dragOffset;if(!S)S=this.dragOffset=new r(j.startX-this.xy.x,j.startY-this.xy.y);this.xy.x=k-S.x;this.xy.y=B-S.y;if(I){delete this.dragOffset;
if(j=l.view){j.syncXY([this.xy],true);j.invalidate()}this.trigger("dragDrop")}return true}function d(j){clearTimeout(h);h=setTimeout(function(){f.sort(function(k,B){if(B.xy&&k.xy){var I=B.xy.y-k.xy.y;return I!=0?I:B.xy.x-k.xy.x}});j&&j.invalidate()},50)}function c(j,k,B,I){I&&g.remove(I,k);g.insert(B,k)}function b(j,k){g=n(k.getZoomLevel(),g);for(var B=f.length;B--;)f[B].resync(k)}a=COG.extend({zindex:10},a);var f=[],g,h=0,l=COG.extend(new ea(a),{itemCount:0,add:function(j,k){if(j){j.layer=l;if(k)f.unshift(j);
else f[f.length]=j;var B=l.view;if(B){j.resync(B);g&&j.bounds&&g.insert(j.bounds,j);d(B)}j.bind("move",c)}l.itemCount=f.length},clear:function(){g=new Fb;f=[];l.itemCount=0},draw:function(j,k,B,I,S){B={};I=g&&k?g.search(k):[];for(var J=I.length;J--;){var D=I[J],L=D.style||l.style,V,fa=j.applyTransform(D),ca=D.getProps?D.getProps(j):B;if(ca=(V=j["prep"+D.typeName])?V.call(j,D,k,S,ca):null){if(S&&ca.hit){S.elements.push(Hits.initHit(D.type,D,D.draggable?e:null));V=S.type+"Style";L=D[V]||l[V]||L}L=L?
j.applyStyle(L,true):null;(V=D.draw||ca.draw)&&V.call(D,ca);L&&j.applyStyle(L)}fa&&fa.undo&&fa.undo()}},find:function(){return[].concat(f)},hitGuess:function(j,k){return g&&g.search({x:j-10,y:k-10,w:20,h:20}).length>0}});l.bind("parentChange",b);l.bind("resync",b);return l},sb=function(a){return new Tb(a)};H.prototype={constructor:H,offset:function(a,e){var d=this.lat*Na,c=this.lon*Na,b=d+a/ib;d=O(M(e/ib)/oa(d));c=c+d;b=(b+ha)%Math.PI-ha;c%=za;return new H(b*Va,c*Va)},toString:function(a){return this.lat+
(a||" ")+this.lon}};COG.extend(C,{ex:COG.extend,is:t,ticks:T,userMessage:function(a,e,d){C.trigger("userMessage",a,e,d)},indexOf:Ma,DOM:ya,Rect:m,XY:Xa,XYRect:eb,Vector:Qa,Hits:Hits,Generator:Jb,Service:tb,tweenValue:COG.tweenValue,easing:COG.easing,Tile:N,TileLayer:fb,getImage:x,View:Sb,ViewLayer:ea,ImageLayer:fb,Drawable:Da,Marker:i,Poly:o,Line:w,Arc:ga,ImageDrawable:F,ImageMarker:P,DrawLayer:Tb,ShapeLayer:sb,Map:function(a){function e(h,l,j){g.setZoomLevel(l);d(h,j)}function d(h,l,j,k){h=Ta.init(h,
la(g.getZoomLevel()));var B=g.getViewport();g.updateOffset(h.x-(B.w>>1),h.y-(B.h>>1),j,k,function(){l&&l(g)})}a=COG.extend({zoomLevel:1,minZoom:1,maxZoom:18,pannable:true,scalable:true},a);var c=new r,b=0,f=a.tapExtent;a.adjustScaleFactor=function(h){return Math.pow(2,(h<1?Math.floor:Math.ceil)(Math.log(h)))};var g=COG.extend(new Sb(a),{getBoundingBox:function(){var h=g.getViewport();return h?Ya.init(Ta.toPos(new r(h.x,h.y2),b),Ta.toPos(new r(h.x2,h.y),b)):null},getCenterPosition:function(){var h=
g.getViewport();if(h){h=new r(h.x+(h.w>>1),h.y+(h.h>>1));return Ta.toPos(h,b)}return null},gotoBounds:function(h,l){var j=Ya.getZoomLevel(h,g.getViewport());e(Ya.getCenter(h),j,l)},gotoPosition:e,panToPosition:d,syncXY:function(h,l){return(l?Ta.syncPos:Ta.sync)(h,b)}});g.bind("tap",function(h,l,j,k){h=Ta.toPos(k,b);var B=Ta.toPos(Xa.offset(k,-f,f),b);k=Ta.toPos(Xa.offset(k,f,-f),b);g.trigger("geotap",l,j,h,Ya.init(B,k))});g.bind("refresh",function(h,l,j){if(c.x!=j.x||c.y!=j.y){g.trigger("boundsChange",
g.getBoundingBox());c.x=j.x;c.y=j.y}});g.bind("zoomLevelChange",function(h,l){var j;b=la(l);j=za/b|0;g.setMaxOffset(j,j,true,false);g.resetScale();g.triggerAll("resync",g)});return g},Pos:H});var Db=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],Na=Math.PI/180,Va=180/Math.PI,Eb=ha,Ub=-Eb,Vb=za,vc=-Vb,ib=6371,kb=0.08181919084262157,jb=null,Wb={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},xa=function(){function a(d){return!d||
d.lat===0&&d.lon===0}function e(d,c){return new H(d,c)}return{calcDistance:function(d,c){if(a(d)||a(c))return 0;var b=(c.lat-d.lat)*Na>>1,f=(c.lon-d.lon)*Na>>1;b=M(b)*M(b)+oa(d.lat*Na)*oa(c.lat*Na)*M(f)*M(f);b=2*Ja(Ia(b),Ia(1-b));return ib*b},copy:function(d){return d?e(d.lat,d.lon):null},empty:a,equal:function(d,c){return d&&c&&d.lat==c.lat&&d.lon==c.lon},fromMercatorPixels:function(d,c){for(var b=ja(Math.E,-c),f=ha-2*Aa(b),g=na(f,b),h=0;h<12&&X(f-g)>1.0E-7;){f=g;g=na(f,b);h++}return e(g*Va,d%360*
Va)},generalize:function(d,c,b){var f=d.length,g=[],h=null;b||(b=250);b/=1E3;COG.info("generalizing positions, must include "+c.length+" positions");for(var l=f;l--;)if(l===0)g.unshift(d[l]);else{var j=!h||xa.inArray(d[l],c)?b:xa.calcDistance(h,d[l]);if(d[l]&&j>=b){g.unshift(d[l]);h=d[l]}}COG.info("generalized "+f+" positions into "+g.length+" positions");return g},inArray:function(d,c){for(var b=xa.equal,f=c.length;f--;)if(b(d,c[f]))return true;return false},inBounds:function(d,c){var b=!(xa.empty(d)||
xa.empty(c));return b=(b=b&&d.lat>=c.min.lat&&d.lat<=c.max.lat)&&d.lon>=c.min.lon&&d.lon<=c.max.lon},init:e,offset:function(d,c,b){return d.offset(c,b)},parse:function(d){return new H(d)},parseArray:function(d){var c=d.length,b=Array(c);for(c=c;c--;)b[c]=new H(d[c]);return b},toMercatorPixels:function(d){return T5.XY.init(parseFloat(d.lon)*Na,$(d.lat))},toString:function(d){return d?d.toString():""},vectorize:function(d,c){function b(){for(var l=0,j=c.chunkSize,k=f;k--;){g[k]=T5.GeoXY.init(d[k]);
l+=1;if(l>j)break}f=k;if(f<=0)c.callback&&c.callback(g);else animFrame(b)}var f=d.length,g=Array(f);c=COG.extend({chunkSize:500,async:true,callback:null},c);if(!c.async){for(var h=f;h--;)g[h]=T5.GeoXY.init(d[h]);return g}animFrame(b);return null}}}(),Ya=function(){function a(b,f,g){var h=new r(0,f.lat-b.lat);h.x=(g||t(g,wa))&&b.lon>f.lon?360-b.lon+f.lon:f.lon-b.lon;return h}function e(b,f){return Ya.init(new H(b.min.lat-f,b.min.lon-f%360),new H(b.max.lat+f,b.max.lon+f%360))}function d(b){var f=a(b.min,
b.max);return new H(b.min.lat+(f.y>>1),b.min.lon+(f.x>>1))}function c(b,f){return{min:new H(b),max:new H(f)}}return{calcSize:a,createBoundsFromCenter:function(b,f){var g=f/ib,h=b.lat*Na,l=b.lon*Na,j=h-g,k=h+g;if(j>Ub&&k<Eb){h=O(M(g)/oa(h));g=(l-h)%za;l=(l+h)%za}else{j=R(j,Ub);k=G(k,Eb);g=vc;l=Vb}return Ya.init(new H(j*Va,g*Va),new H(k*Va,l*Va))},expand:e,forPositions:function(b,f){var g=null,h=T5.ticks();f||(f="auto");for(var l=b.length;l--;)if(g){var j=a(g.min,b[l],false),k=a(b[l],g.max,false);if(j.x<
0)g.min.lon=b[l].lon;if(j.y<0)g.min.lat=b[l].lat;if(k.x<0)g.max.lon=b[l].lon;if(k.y<0)g.max.lat=b[l].lat}else g=c(b[l],b[l]);if(f){if(f=="auto"){l=a(g.min,g.max);f=R(l.x,l.y)*0.3}g=e(g,f)}COG.trace("calculated bounds for "+b.length+" positions",h);return g},getCenter:d,getZoomLevel:function(b,f){var g=d(b);g=G(y(X(g.lat)*0.05),Db.length);var h=Db[g],l=a(b.min,b.max);g=ia(E(Db[3]*f.h/l.y)/E(2));h=ia(E(h*f.w/l.x)/E(2));return G(isNaN(g)?1E3:g,isNaN(h)?1E3:h)},init:c,isEmpty:function(b){return!b||xa.empty(b.min)||
xa.empty(b.max)},toString:function(b){return"min: "+xa.toString(b.min)+", max: "+xa.toString(b.max)}}}();tb=function(){var a=/^(\d+).*$/,e=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(d,c){a.lastIndex=-1;if(a.test(d))for(var b=d.replace(a,"$1"),f=c.split(","),g=0;g<f.length;g++){e.lastIndex=-1;if(e.test(f[g])){var h=e.exec(f[g]);if(b>=parseInt(h[1],10)&&b<=parseInt(h[2],10))return true}else if(b==f[g])return true}return false},normalize:function(d){if(!d)return"";d=d.toUpperCase();if(!jb){var c=
[];for(var b in Wb)c.push(b);jb=RegExp("(\\s)("+c.join("|")+")(\\s|$)","i")}jb.lastIndex=-1;if(c=jb.exec(d))d=d.replace(jb,"$1"+Wb[c[2]]);return d},toString:function(d){return d.streetDetails+" "+d.location}}}();var Ta=C.GeoXY=function(){function a(c,b){if(c.length){for(var f,g,h,l,j=c.length;j--;){a(c[j],b);f=t(f,wa)||c.x<f?c.x:f;g=t(g,wa)||c.y<g?c.y:g;h=t(h,wa)||c.x>h?c.x:h;l=t(l,wa)||c.y>l?c.y:l}return new m(f,g,h-f,l-g)}else if(c.mercXY){f=c.mercXY;c.x=y((f.x+Math.PI)/b);c.y=y((Math.PI-f.y)/b);
c.rpp=b}return c}function e(c,b){if(c.length)for(var f=c.length;f--;)e(c[f],b);else{c.mercXY=new r(c.x*b-Math.PI,Math.PI-c.y*b);c.pos=xa.fromMercatorPixels(c.mercXY.x,c.mercXY.y)}return c}function d(c,b,f){c.pos=b;c.mercXY=xa.toMercatorPixels(b);(f=t(f,ec)?f:c.rpp)&&a(c,f)}return{init:function(c,b){var f=new r;d(f,c,b);return f},sync:a,syncPos:e,toPos:function(c,b){b=b||c.rpp;return xa.fromMercatorPixels(c.x*b-Math.PI,Math.PI-c.y*b)},updatePos:d}}(),wc="featurecollection",xc="feature",Ib={async:false};
Qa={processor:null,group:"shapes",layerClass:sb};var yc={point:COG.extend({},Qa,{processor:function(a,e,d,c){e=sa([e.coordinates],Ib);if(e.length>0)if(d=c.marker(e[0],d)){a.add(d);return e.length}},group:"markers",layerClass:sb}),linestring:COG.extend({},Qa,{processor:function(a,e,d,c){e=sa(e&&e.coordinates?e.coordinates:[]);return Ha(a,e,d,c.line)}}),multilinestring:COG.extend({},Qa,{processor:function(a,e,d,c){e=e&&e.coordinates?e.coordinates:[];for(var b=0,f=e.length;f--;)b+=Ha(a,e[f],d,c.line);
return b}}),polygon:COG.extend({},Qa,{processor:function(a,e,d,c){e=e&&e.coordinates?e.coordinates:[];if(e.length>0)return Ha(a,e[0],d,c.poly);return 0}}),multipolygon:COG.extend({},Qa,{processor:function(a,e,d,c){e=e&&e.coordinates?e.coordinates:[];for(var b=0,f=0;f<e.length;f++)b+=Ha(a,e[f][0],d,c.poly);return b}})},Xb=function(a,e,d,c){function b(D,L){var V=D.processor,fa=j+D.group,ca=COG.extend({},D,d,{properties:L.properties});if(V){var ma=J[fa];if(!ma){ma=new D.layerClass({id:fa});J[fa]=ma}return V(ma,
L.data,ca,c)}return 0}function f(D,L){var V=D&&D.type?D.type.toLowerCase():null;return V&&V===xc?f(D.geometry,D.properties):{type:V,isCollection:V?V===wc:false,definition:yc[V],data:D,properties:L?L:D.properties}}function g(D){var L=0,V=COG.extend({},d),fa=k;D=D?D:(new Date).getTime();if(!I){for(;fa<B;fa++){D=f(l?l(a[fa]):a[fa]);var ca=null;if(D.isCollection){V.layerPrefix=j+S++ +"-";I=new Xb(D.data.features,function(ma){I=null;for(var v in ma)J[v]=ma[v];k>=B&&e&&e(J)},V);ca+=1}else if(D.definition)ca=
b(D.definition,D);L+=ca?ca:1;if(L>=h)break}k=fa+1;if(I||k<B)animFrame(g);else e&&e(J)}}d=COG.extend({rowPreParse:null,simplify:false,layerPrefix:"geojson-"},d);c=COG.extend({marker:function(D){return new i({xy:D})},line:function(D,L){return new o(D,COG.extend({},d,L))},poly:function(D,L){return new o(D,COG.extend({fill:true},d,L))}},c);var h=500,l=d.rowPreParse,j=d.layerPrefix,k=0,B=0,I=null,S=0,J={};if(a){t(a,"array")||(a=[a]);B=a.length;animFrame(g)}};Qa=C.GeoJSON={parse:function(a,e,d){return new Xb(a,
e,d)}};C.GeoShape=function(a,e){e=COG.extend({autoParse:true},e);for(var d=Array(a.length),c=e.autoParse,b=T5.Geo.Position.parse,f=a.length;f--;)d[f]=T5.GeoXY.init(c?b(a[f]):a[f]);return new T5.Poly(d,e)};C.Geo={distanceToString:function(a){if(a>1E3)return~~(a/10)/100+" km";return a?a+" m":""},dist2rad:function(a){return a/ib},radsPerPixel:la,Position:xa,BoundingBox:Ya,Radius:function(a,e){return{distance:parseInt(a,10),uom:e}},Address:function(a){return a=COG.extend({streetDetails:"",location:"",
country:"",postalCode:"",pos:null,boundingBox:null},a)},A:tb,GeoJSON:Qa}})(T5);
