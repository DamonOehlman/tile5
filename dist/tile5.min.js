if(!this.JSON)this.JSON={};
(function(){function pa(aa){return aa<10?"0"+aa:aa}function Ka(aa){La.lastIndex=0;return La.test(aa)?'"'+aa.replace(La,function(ia){var m=Oa[ia];return typeof m==="string"?m:"\\u"+("0000"+ia.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+aa+'"'}function Ea(aa,ia){var m,y,C,F,G=U,D,v=ia[aa];if(v&&typeof v==="object"&&typeof v.toJSON==="function")v=v.toJSON(aa);if(typeof wa==="function")v=wa.call(ia,aa,v);switch(typeof v){case "string":return Ka(v);case "number":return isFinite(v)?String(v):"null";
case "boolean":case "null":return String(v);case "object":if(!v)return"null";U+=Aa;D=[];if(Object.prototype.toString.apply(v)==="[object Array]"){F=v.length;for(m=0;m<F;m+=1)D[m]=Ea(m,v)||"null";C=D.length===0?"[]":U?"[\n"+U+D.join(",\n"+U)+"\n"+G+"]":"["+D.join(",")+"]";U=G;return C}if(wa&&typeof wa==="object"){F=wa.length;for(m=0;m<F;m+=1){y=wa[m];if(typeof y==="string")if(C=Ea(y,v))D.push(Ka(y)+(U?": ":":")+C)}}else for(y in v)if(Object.hasOwnProperty.call(v,y))if(C=Ea(y,v))D.push(Ka(y)+(U?": ":
":")+C);C=D.length===0?"{}":U?"{\n"+U+D.join(",\n"+U)+"\n"+G+"}":"{"+D.join(",")+"}";U=G;return C}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+pa(this.getUTCMonth()+1)+"-"+pa(this.getUTCDate())+"T"+pa(this.getUTCHours())+":"+pa(this.getUTCMinutes())+":"+pa(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var Ba=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
La=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,U,Aa,Oa={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},wa;if(typeof JSON.stringify!=="function")JSON.stringify=function(aa,ia,m){var y;Aa=U="";if(typeof m==="number")for(y=0;y<m;y+=1)Aa+=" ";else if(typeof m==="string")Aa=m;if((wa=ia)&&typeof ia!=="function"&&(typeof ia!=="object"||typeof ia.length!=="number"))throw Error("JSON.stringify");
return Ea("",{"":aa})};if(typeof JSON.parse!=="function")JSON.parse=function(aa,ia){function m(C,F){var G,D,v=C[F];if(v&&typeof v==="object")for(G in v)if(Object.hasOwnProperty.call(v,G)){D=m(v,G);if(D!==undefined)v[G]=D;else delete v[G]}return ia.call(C,F,v)}var y;aa=String(aa);Ba.lastIndex=0;if(Ba.test(aa))aa=aa.replace(Ba,function(C){return"\\u"+("0000"+C.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(aa.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){y=eval("("+aa+")");return typeof ia==="function"?m({"":y},""):y}throw new SyntaxError("JSON.parse");}})();
COG=function(){function pa(m,y){var C=m.gtObsHandlers;C[y]||(C[y]=[]);return C[y]}function Ka(m,y){m[y]||(m[y]=function(C){return m.configure(y,C)})}function Ea(m){m.gtConfId=Aa("configurable");m.gtConfig={};m.gtConfigFns=[];return m.gtConfig}var Ba=Object.prototype.hasOwnProperty,La=0,U={};U.toID=function(m){return m.replace(/\s/g,"-")};var Aa=U.objId=function(m){return(m?m:"obj")+La++};U.Log=function(){function m(D,v){var N,da=v&&v.length>0?v[0]:"";for(N=1;v&&N<v.length;N++)da+=" "+(C&&wa(v[N])?
JSON.stringify(v[N]):v[N]);typeof console!=="undefined"&&console[D](da);for(N=0;N<y.length;N++)y[N].call(G,da,D)}var y=[],C=typeof JSON!=="undefined",F=window.console&&window.console.markTimeline,G={getTraceTicks:function(){return F?(new Date).getTime():null},trace:function(D,v){if(F)console.markTimeline(D+(v?": "+(G.getTraceTicks()-v)+"ms":""))},debug:function(){m("debug",arguments)},info:function(){m("info",arguments)},warn:function(){m("warn",arguments)},error:function(){m("error",arguments)},
exception:function(D){G.error(arguments);for(var v in D)G.info("ERROR DETAIL: "+v+": "+D[v])},watch:function(D,v){try{v()}catch(N){G.exception(N,D)}},throwError:function(D){G.error(D);throw Error(D);},requestUpdates:function(D){y.push(D)}};return G}();U.contains=function(m,y){var C=m,F=arguments,G=1;if(y&&module.isArray(y)){F=y;G=0}for(G=G;G<F;G++)C=C&&typeof foo[F[G]]!=="undefined";return C};var Oa=U.extend=function(){var m=arguments[0]||{},y=1,C=arguments.length,F=false,G,D,v,N;if(typeof m==="boolean"){F=
m;m=arguments[1]||{};y=2}if(typeof m!=="object"&&!module.isFunction(m))m={};if(C===y){m=this;--y}for(;y<C;y++)if((G=arguments[y])!=null)for(D in G){v=m[D];N=G[D];if(m!==N)if(F&&N&&(module.isPlainObject(N)||module.isArray(N))){v=v&&(module.isPlainObject(v)||module.isArray(v))?v:module.isArray(N)?[]:{};m[D]=module.extend(F,v,N)}else if(N!==undefined)m[D]=N}return m};U.formatStr=function(m){if(arguments.length<=1)return m;for(var y=arguments.length-2,C=0;C<=y;C++)m=m.replace(RegExp("\\{"+C+"\\}","gi"),
arguments[C+1]);return m};U.wordExists=function(m,y){var C="";if(y.toString)y=y.toString();for(var F=0;F<y.length;F++)C+=!/\w/.test(y[F])?"\\"+y[F]:y[F];return RegExp("(^|\\s|\\,)"+C+"(\\,|\\s|$)","i").test(m)};U.isFunction=function(m){return toString.call(m)==="[object Function]"};U.isArray=function(m){return toString.call(m)==="[object Array]"};var wa=U.isPlainObject=function(m){if(!m||toString.call(m)!=="[object Object]"||m.nodeType||m.setInterval)return false;if(m.constructor&&!Ba.call(m,"constructor")&&
!Ba.call(m.constructor.prototype,"isPrototypeOf"))return false;var y;for(y in m);return y===undefined||Ba.call(m,y)};U.isEmptyObject=function(m){for(var y in m)return false;return true};U.isXmlDocument=function(m){return toString.call(m)==="[object Document]"};U.Loopage=function(){function m(Z){return Oa({id:D++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},Z)}function y(Z){N.push(Z);C()}function C(){da&&clearTimeout(da);da=setTimeout(F,0);qa=true}function F(){for(var Z,ja=(new Date).getTime(),
xa=v.length;N.length>0;){var Ma=N.shift();for(Z=xa;Z--;)if(v[Z].id===Ma){v.splice(Z,1);break}qa=true;xa=v.length}if(qa){ga=G;for(Z=xa;Z--;)ga=v[Z].frequency<ga?v[Z].frequency:ga}for(Z=xa;Z--;){Ma=ja-v[Z].lastTick;if(v[Z].lastTick===0||Ma>=v[Z].frequency){v[Z].execute(ja,v[Z]);v[Z].lastTick=ja;v[Z].single&&v[Z].trigger("complete")}}da=xa?setTimeout(F,ga):0}var G=6E4,D=0,v=[],N=[],da=0,ga=G,qa=true;return{join:function(Z){var ja=new m(Z);if(ja.after>0)ja.lastTick=(new Date).getTime()+ja.after;aa(ja);
ja.bind("complete",function(){y(ja.id)});v.unshift(ja);C();return ja},leave:y}}();var aa=U.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(y,C){var F=Aa("callback");pa(m,y).unshift({fn:C,id:F});return F};m.trigger=function(y){var C=pa(m,y),F={cancel:false,tickCount:(new Date).getTime()},G;if(!C)return null;G=Array.prototype.slice.call(arguments,1);G.unshift(F);for(var D=C.length;D--&&!F.cancel;)C[D].fn.apply(self,G);return F};
m.unbind=function(y,C){for(var F=pa(m,y),G=0;F&&G<F.length;G++)if(F[G].id===C){F.splice(G,1);break}return m}}}},ia={};U.paramTweaker=function(m,y,C){return function(F,G){if(typeof G!=="undefined"){if(F in m)m[F]=G;C&&F in C&&C[F](F,G)}else return y&&F in y?y[F](F):m[F]}};U.configurable=function(m,y,C,F){if(m){m.gtConfId||Ea(m);var G=m.gtConfId,D=m.gtConfig,v=m.gtConfigFns;ia[G]=m;v.push(C);for(C=y.length;C--;){D[y[C]]=true;F&&Ka(m,y[C])}if(!m.configure)m.configure=function(N,da){if(D[N]){for(var ga=
v.length;ga--;){var qa=v[ga](N,da);if(typeof qa!=="undefined")return qa}return ia[G]}return null}}};(function(){function m(G){var D=document.createElement("script"),v=false;D.src=G;D.async=true;D.onload=D.onreadystatechange=function(){if(!v&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){v=true;D.onload=D.onreadystatechange=null;D&&D.parentNode&&D.parentNode.removeChild(D)}};C||(C=document.getElementsByTagName("head")[0]);C.appendChild(D)}var y=0,C,F=this;U.jsonp=function(G,
D,v){G+=G.indexOf("?")>=0?"&":"?";var N="json"+ ++y;F[N]=function(da){D(da);F[N]=null;try{delete F[N]}catch(ga){}};m(G+(v?v:"callback")+"="+N);return N}})();return U}();
T5=function(){function pa(){return(new Date).getTime()}function Ka(){for(;bb.length>0;){var a=bb.shift();document.location=a}cb=0}function Ea(a){for(var f=true,c=lb.length;c--;)f=f&&a!=lb[c];return f}function Ba(a,f){var c=[];for(var b in f)b&&c.push(b+"="+escape(f[b]));return"tile5://"+a+"/"+(c.length>0?"?"+c.join("&"):"")}function La(a,f){Ea(a)&&COG.Log.info("would push url: "+Ba(a,f))}function U(a,f){if(Ea(a)){bb.push(Ba(a,f));cb||(cb=setTimeout(Ka,100))}}function Aa(a){return function(f,c,b){(b?
b:a?document.body:document).addEventListener(f,c,false)}}function Oa(a){return function(f,c,b){(b?b:a?document.body:document).removeEventListener(f,c,false)}}function wa(a,f,c){(c?c:document).attachEvent("on"+a,f)}function aa(a,f,c){(c?c:document).detachEvent("on"+a,f)}function ia(){Ca={base:{name:"Unknown",bindEvent:Aa(),unbindEvent:Oa(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:La,targetFps:null},
ie:{name:"MSIE",regex:/msie/i,bindEvent:wa,unbindEvent:aa,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:U,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:U},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:U},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:Aa(true),unbindEvent:Oa(true),supportsTouch:true,getScaling:function(){return 1/
window.devicePixelRatio},bridgeNotify:U},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:U}};db=[Ca.froyo,Ca.android,Ca.ipod,Ca.iphone,Ca.ipad,Ca.ie]}function m(){Ca||ia();if(!Pa){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<db.length;a++){var f=db[a];if(f.regex&&f.regex.test(navigator.userAgent)){Pa=COG.extend({},Ca.base,f);COG.Log.info("PLATFORM DETECTED AS: "+Pa.name);break}}if(!Pa){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
Pa=Ca.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return Pa}function y(a,f){function c(e,g){if(e&&b!==e){var k=a.triggerAll("zoomLevelChange",e,g);if(k)b=e;return k}}f=COG.extend({initial:1,min:0,max:null,zoomAnimation:N("quad.out")},f);var b=f.initial;COG.extend(a,{getZoomLevel:function(){return b},setZoomLevel:c});a.bind("scale",function(e,g,k){var n=Math.log(g)/Math.LN2;F(function(s){return s.cancelOnInteract});e.cancel=!c(b+n,k);e.cancel||a.updateOffset(k.x*g,k.y*
g)});a.bind("doubleTap",function(e,g,k){if(a.scalable()){F(function(n){return n.cancelOnInteract});a.scale(2,S.init(k.x,k.y))}})}function C(a){if(Qa)return la.length;Qa=true;try{for(var f=0;f<la.length;)if(la[f].isComplete()){la[f].triggerComplete(false);la.splice(f,1)}else{la[f].update(a);f++}}finally{Qa=false}la.length===0&&Va.trigger("complete");return la.length}function F(a){if(!Qa){Qa=true;try{for(var f=0;f<la.length;)if(!a||a(la[f])){la[f].triggerComplete(true);la.splice(f,1)}else f++}finally{Qa=
false}}}function G(){if(!Va){Va=COG.Loopage.join({execute:C,frequency:20});Va.bind("complete",function(){Va=null})}}function D(a,f,c,b,e){a=new eb({startValue:a,endValue:f,tweenFn:c,complete:b,duration:e});la.push(a);return a}function v(a,f,c,b,e,g){a=new eb({target:a,property:f,endValue:c,tweenFn:b,duration:g,complete:e});la.push(a);return a}function N(a){return Wa[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]}function da(){for(var a=0,f=arguments.length;f--;){var c=ub[arguments[f].toUpperCase()];if(c)a|=
c}return a}var ga=Math.PI*2,qa=Math.PI/2,Z=Math.abs,ja=Math.pow,xa=Math.sin,Ma=Math.asin,mb=Math.cos,S=function(){function a(b,e){return c(b.x-e.x,b.y-e.y)}function f(b,e){if(!e)e=b.length;if(e<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var g={edges:Array(e-1),accrued:Array(e-1),total:0},k=0;k<e-1;k++){var n=a(b[k],b[k+1]);g.edges[k]=Math.sqrt(n.x*n.x+n.y*n.y);g.accrued[k]=g.total+g.edges[k];g.total+=g.edges[k]}return g}function c(b,e){return{x:b?b:
0,y:e?e:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,e=0,g=arguments.length;g--;){b+=arguments[g].x;e+=arguments[g].y}return c(b,e)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?c(b.x,b.y):null},diff:a,distance:function(b,e){return f(b,e).total},edges:f,equals:function(b,e){return b.x===e.x&&b.y===e.y},extendBy:function(b,e,g){return c(b.x-Math.cos(e)*g,b.y-Math.sin(e)*g)},floor:function(b){for(var e=Array(b.length),
g=b.length;g--;)e[g]=c(~~b[g].x,~~b[g].y);return e},getRect:function(b){for(var e,g,k,n,s=b.length;s--;){var p=b[s];e=typeof e==="undefined"||p.x<e?p.x:e;g=typeof g==="undefined"||p.y<g?p.y:g;k=typeof k==="undefined"||p.x>k?p.x:k;n=typeof n==="undefined"||p.y>n?p.y:n}return ra.init(e,g,k,n)},init:c,invert:function(b){return c(-b.x,-b.y)},min:function(b,e){return c(b.x<e.x?b.x:e.x,b.y<e.y?b.y:e.y)},max:function(b,e){return c(b.x>e.x?b.x:e.x,b.y>e.y?b.y:e.y)},offset:function(b,e,g){return c(b.x+e,b.y+
(g?g:e))},simplify:function(b,e){if(!b)return null;e=e?e:S.VECTOR_SIMPLIFICATION;for(var g=[],k=null,n=b.length;n--;){var s=b[n];if(include=!k||n===0||Math.abs(s.x-k.x)+Math.abs(s.y-k.y)>e){g.unshift(s);k=s}}return g},theta:function(b,e,g){g=Math.asin((b.y-e.y)/g);return b.x>e.x?g:Math.PI-g}}}(),vb=function(){return{dotProduct:function(a,f){return a.x*f.x+a.y*f.y}}}(),ra=function(){function a(c){return f(c.x1,c.y1,c.x2,c.y2)}function f(c,b,e,g){c=c?c:0;b=b?b:0;e=typeof e!=="undefined"?e:c;g=typeof g!==
"undefined "?g:g;return{x1:c,y1:b,x2:e,y2:g,width:e-c,height:g-b}}return{center:function(c){return S.init(c.x1+c.width/2,c.y1+c.height/2)},copy:a,diagonalSize:function(c){return Math.sqrt(c.width*c.width+c.height*c.height)},fromCenter:function(c,b,e,g){e=~~(e/2);g=~~(g/2);return f(c-e,b-g,c+e,b+g)},init:f,intersect:function(c,b){var e=f(Math.max(c.x1,b.x1),Math.max(c.y1,b.y1),Math.min(c.x2,b.x2),Math.min(c.y2,b.y2));return e.width>0&&e.height>0?e:null},union:function(c,b){if(c.width===0||c.height===
0)return a(b);else if(b.width===0||b.height===0)return a(c);else{var e=f(Math.min(c.x1,b.x1),Math.min(c.y1,b.y1),Math.max(c.x2,b.x2),Math.max(c.y2,b.y2));return e.width>0&&e.height>0?e:null}}}}(),Ra=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return S.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,f){a=a?a:0;return{width:a,height:f?f:a}}}}(),Ca=null,db=[],Pa=
null,cb=0,bb=[],lb=["view.wake","tile.loaded"],Xa=function(){function a(){if(!L){var x=m().maxImageLoads;L=COG.Loopage.join({execute:function(O,E){if(!x||r.length<x){var H=p.shift();if(H){r[r.length]=H;H.image.onload=c;H.image.src=H.url;H.requested=T5.ticks()}else E.trigger("complete")}},frequency:10});L.bind("complete",function(){L=null})}}function f(){M=true;try{var x=u.length/2>>0;if(x>0){u.sort(function(E,H){return E.created-H.created});for(var O=x;O--;)delete g[u[O].url];u.splice(0,x)}}finally{M=
false}J.trigger("cacheCleared")}function c(){var x=n[this.id],O;if(x&&x.image.complete&&x.image.width>0){x.loaded=true;x.hitCount=1;for(O=r.length;O--;)if(r[O].image.src==this.src){r.splice(O,1);break}if(x.background||x.postProcess||x.drawBackground||x.customDraw)if(x.image){globalImageData=x;O=e(x.realSize?x.realSize.width:x.image.width,x.realSize?x.realSize.height:x.image.height);var E=O.getContext("2d"),H=x.offset?x.offset:T5.XY.init();x.background&&E.drawImage(x.background,0,0);x.drawBackground&&
x.drawBackground(E);x.customDraw?x.customDraw(E,x):E.drawImage(x.image,H.x,H.y);x.postProcess&&x.postProcess(E,x);x.image=O}for(O=x.callbacks.length;O--;)x.callbacks[O]&&x.callbacks[O](this,false);x.callbacks=[];u[u.length]={url:this.src,created:x.requested};delete n[this.id];a()}}function b(x,O,E){var H=g[x];if(H){H.hitCount++;H.image.complete&&H.image.width>0&&O?O(H.image,true):H.callbacks.push(O)}else{H=COG.extend({url:x,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,
callbacks:[O]},E);H.image.id="resourceLoaderImage"+s++;g[x]=H;n[H.image.id]=H;p[p.length]=H;a()}return H}function e(x,O){var E=document.createElement("canvas");E.width=x?x:0;E.height=O?O:0;if(typeof FlashCanvas!=="undefined"){E.id="tmpCanvas"+k++;E.style.cssText="position: absolute; top: -"+(O-1)+"px; left: -"+(x-1)+"px;";document.body.appendChild(E);FlashCanvas.initElement(E)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(E);return E}var g={},k=0,n={},s=0,p=[],r=[],u=[],
A=0,L=null,M=false,J={avgImageSize:25,loadTimeout:10,cancelLoad:function(){r=[]},get:function(x,O,E){var H=null,P=null;M||(H=g[x]);if((P=H?H.image:null)&&(P.getContext||P.complete&&P.width>0))return P;else O&&b(x,O,E);return null},load:b,newCanvas:e,reset:function(){g={}},stats:function(){return{imageLoadingCount:r.length,queuedImageCount:p.length,imageCacheFullness:A}}};COG.observable(J);COG.Loopage.join({execute:function(x){for(var O=false,E=0,H=m();E<r.length;)if(x-r[E].requested>J.loadTimeout*
1E3){r.splice(E,1);O=true}else E++;O&&a();if(H&&H.imageCacheMaxSize){A=u.length*J.avgImageSize/H.imageCacheMaxSize;A>=1&&f()}},frequency:2E4});return J}(),fb=function(){var a={};return{init:function(f,c){var b=a[f];if(!b)throw Error("Unable to locate requested generator: "+f);return new b(c)},register:function(f,c){a[f]=c},Template:function(){}}}(),la=[],Va=null,Qa=false,Ga=1.70158,Wa={linear:function(a,f,c,b){return c*a/b+f},backin:function(a,f,c,b){return c*(a/=b)*a*((Ga+1)*a-Ga)+f},backout:function(a,
f,c,b){return c*((a=a/b-1)*a*((Ga+1)*a+Ga)+1)+f},backinout:function(a,f,c,b){return(a/=b/2)<1?c/2*a*a*(((Ga*=1.525)+1)*a-Ga)+f:c/2*((a-=2)*a*(((Ga*=1.525)+1)*a+Ga)+2)+f},bouncein:function(a,f,c,b){return c-Wa.bounceout(b-a,0,c,b)+f},bounceout:function(a,f,c,b){return(a/=b)<1/2.75?c*7.5625*a*a+f:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+0.75)+f:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+0.9375)+f:c*(7.5625*(a-=2.625/2.75)*a+0.984375)+f},bounceinout:function(a,f,c,b){return a<b/2?Wa.bouncein(a*2,0,c,b)/2+f:Wa.bounceout(a*
2-b,0,c,b)/2+c/2+f},cubicin:function(a,f,c,b){return c*(a/=b)*a*a+f},cubicout:function(a,f,c,b){return c*((a=a/b-1)*a*a+1)+f},cubicinout:function(a,f,c,b){if((a/=b/2)<1)return c/2*a*a*a+f;return c/2*((a-=2)*a*a+2)+f},elasticin:function(a,f,c,b,e,g){if(a==0)return f;if((a/=b)==1)return f+c;g||(g=b*0.3);if(!e||e<Z(c)){e=c;c=g/4}else c=g/ga*Ma(c/e);return-(e*ja(2,10*(a-=1))*xa((a*b-c)*ga/g))+f},elasticout:function(a,f,c,b,e,g){var k;if(a==0)return f;if((a/=b)==1)return f+c;g||(g=b*0.3);if(!e||e<Z(c)){e=
c;k=g/4}else k=g/ga*Ma(c/e);return e*ja(2,-10*a)*xa((a*b-k)*ga/g)+c+f},elasticinout:function(a,f,c,b,e,g){var k;if(a==0)return f;if((a/=b/2)==2)return f+c;g||(g=b*0.3*1.5);if(!e||e<Z(c)){e=c;k=g/4}else k=g/ga*Ma(c/e);if(a<1)return-0.5*e*ja(2,10*(a-=1))*xa((a*b-k)*ga/g)+f;return e*ja(2,-10*(a-=1))*xa((a*b-k)*ga/g)*0.5+c+f},quadin:function(a,f,c,b){return c*(a/=b)*a+f},quadout:function(a,f,c,b){return-c*(a/=b)*(a-2)+f},quadinout:function(a,f,c,b){if((a/=b/2)<1)return c/2*a*a+f;return-c/2*(--a*(a-2)-
1)+f},sinein:function(a,f,c,b){return-c*mb(a/b*qa)+c+f},sineout:function(a,f,c,b){return c*xa(a/b*qa)+f},sineinout:function(a,f,c,b){return-c/2*(mb(Math.PI*a/b)-1)+f}},eb=function(a){a=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:N("sine.out"),complete:null,cancelOnInteract:false},a);var f=pa(),c=[],b=false,e=0,g=0,k={cancelOnInteract:a.cancelOnInteract,isComplete:function(){return b},triggerComplete:function(n){a.complete&&a.complete(n)},update:function(n){try{var s=
a.tweenFn(n-f,e,g,a.duration);if(a.target)a.target[a.property]=s;for(var p=c.length;p--;)c[p](s,void 0);if(b=f+a.duration<=n){if(a.target)a.target[a.property]=a.tweenFn(a.duration,e,g,a.duration);for(var r=c.length;r--;)c[r](s,true)}}catch(u){COG.Log.exception(u)}},requestUpdates:function(n){c.push(n)}};e=a.target&&a.property&&a.target[a.property]?a.target[a.property]:a.startValue;if(typeof a.endValue!=="undefined")g=a.endValue-e;if(g==0)b=true;G();return k},Sa=function(){function a(k,n){e[k]=c(n);
return k}function f(k){for(var n in k)a(n,k[n])}function c(k){function n(u){var A=k[u];typeof A!=="undefined"&&p.push(function(L){L[u]=A})}function s(){p=[];for(var u in k)n(u)}k=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},k);var p=[],r={applyToContext:function(u){for(var A=p.length;A--;)p[A](u)},update:function(u,A){k[u]=A;s()}};s();return r}var b={},e={},
g={apply:function(k,n){var s=e[n]?e[n]:e.basic,p;if(k&&k.canvas){p=b[k.canvas.id];b[k.canvas.id]=n}s.applyToContext(k);return p},define:a,defineMany:f,get:function(k){return e[k]},init:c,load:function(k){COG.jsonp(k,function(n){f(n)})}};f({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return g}(),ub={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},pb=function(a){function f(t,w,Q,W){sa=na;J();if(W&&a.inertia)s(ka+
w,ma+Q,a.panAnimationEasing,a.panAnimationDuration);else W||s(ka+w,ma+Q)}function c(){sa=ba;l=false;J()}function b(t,w,Q){X||(X=[].concat(Q));t=Ya(X);nb(t);w=ob(t);var W=Ya(Q);Q=nb(W);W=ob(W);k(Q);T=t&&w!==0?W/w:1;g()}function e(t,w,Q){ca.zoom(Ra.getCenter(ta),Q)}function g(t){A();var w=S.init(V-(Ha.width/(T*2)>>0),ha-(Ha.height/(T*2)>>0)),Q=Math.log(T)/Math.LN2>>0;if(T!==1)sa=ya;COG.Log.info("scale factor = "+T+", exp = "+Q);if(Q!==0){T=Math.pow(2,Q);if(!ca.trigger("scale",T,w).cancel){COG.Log.info("ok to scale");
for(t=E.length;t--;)E[t].trigger("scale",T,w);T=1;X=null;sa=ba;t=true}}J(t)}function k(t){Za=S.init(ka,ma);i=S.offset(t,ka,ma)}function n(){clearTimeout(Y);Y=setTimeout(p,50)}function s(t,w,Q,W,$){function ea(){oa+=1;if(oa>=2){c(0,0);$&&$()}}var oa=0,Ia=d?S.offset(d,-Fa,-$a):null,Ja=j?S.offset(j,-Fa,-$a):null;if(Ia){t=t<Ia.x?Ia.x:t;w=w<Ia.y?Ia.y:w}if(Ja){t=t>Ja.x?Ja.x:t;w=w>Ja.y?Ja.y:w}if(Q){if(!l){t=D(ka,t,Q,ea,W);w=D(ma,w,Q,ea,W);t.cancelOnInteract=true;t.requestUpdates(function(gb){ka=gb>>0;l=
true;J()});w.cancelOnInteract=true;w.requestUpdates(function(gb){ma=gb>>0;l=true;J()})}}else{ka=t>>0;ma=w>>0}}function p(){var t;if(P){if(a.autoSize&&P.parentNode){t=P.parentNode.getBoundingClientRect();if(t.height!==0&&t.width!==0){P.height=t.height;P.width=t.width}}try{if(!P.id)P.id=a.id+"_canvas";K=P.getContext("2d")}catch(w){COG.Log.exception(w);throw Error("Could not initialise canvas on specified view element");}if(ta.height!==P.height||ta.width!==P.width){ta=Ra.init(P.width,P.height);Fa=ta.width/
2>>0;$a=ta.height/2>>0;ca.trigger("resize",P.width,P.height);for(t=H;t--;)E[t].trigger("resize",P.width,P.height)}for(t=H;t--;)E[t].trigger("contextChanged",K);J()}}function r(t,w){w.setId(t);w.added=pa();w.bind("remove",function(){ca.removeLayer(t)});w.trigger("contextChanged",K);w.setParent(ca);E.push(w);E.sort(function(Q,W){var $=W.zindex-Q.zindex;if($===0)$=W.added-Q.added;return $});H=E.length;return w}function u(){O("idle",ca);h=true;o=0}function A(t){var w=1/T;V=i.x+(ka-Za.x);ha=i.y+(ma-Za.y);
if(t)return ra.fromCenter(V>>0,ha>>0,t.width*w>>0,t.height*w>>0)}function L(t,w,Q,W){var $=ra.copy(w),ea,oa=0;Q&&K.clearRect(0,0,P.width,P.height);K.save();try{K.globalCompositeOperation="source-over";if(T!==1){$=A($);K.scale(T,T)}K.translate(-$.x1,-$.y1);j=d=null;K.beginPath();Da=false;for(oa=H;oa--;)if(E[oa].clip){E[oa].clip(K,$,t,ca,Q,W);Da=true}K.closePath();Da&&K.clip();for(oa=H;oa--;){ea=E[oa];var Ia=ea.style,Ja=Ia?Sa.apply(K,Ia):null;if(ea.minXY)d=d?S.min(d,ea.minXY):S.copy(ea.minXY);if(ea.maxXY)j=
j?S.max(j,ea.maxXY):S.copy(ea.maxXY);ea.draw(K,$,t,ca,Q,W);Ja&&Sa.apply(K,Ja)}}finally{K.restore()}if(hb){K.globalCompositeOperation="source-over";K.strokeStyle="#f00";K.beginPath();K.moveTo(P.width/2,0);K.lineTo(P.width/2,P.height);K.moveTo(0,P.height/2);K.lineTo(P.width,P.height/2);K.stroke()}O("drawComplete",w,W);COG.Log.trace("draw complete",W)}function M(t,w){var Q=false,W=z?z:l?na:sa,$=!l&&(W===ya||W===na),ea=B||W===na||W===ya||la.length>0;Ha=x();if($){F(function(oa){return oa.cancelOnInteract});
h=false;if(o!==0){clearTimeout(o);o=0}}for($=H;$--;){if(E[$].animated)sa|=ua;E[$].cycle(t,Ha,sa,ea);Q=E[$].shouldDraw(sa,Ha,ea)||Q}ea=ea||(sa&ua)!==0;if(Q=Q||ea||T!==1&&T!==R){L(W,Ha,ea,t);R=T;B=false}if(!Q&&Ta===0&&!I){if(!h&&o===0)o=setTimeout(u,500);w.trigger("complete")}Ta=0;COG.Log.trace("Completed draw cycle",t)}function J(t){B=t?true:false;Ta+=1;if(!Na){Na=COG.Loopage.join({execute:M,frequency:fa});Na.bind("complete",function(){Na=null})}}function x(){return ra.init(ka,ma,ka+ta.width,ma+ta.height)}
function O(){for(var t=ca.trigger.apply(null,arguments).cancel,w=E.length;w--;)t=E[w].trigger.apply(null,arguments).cancel||t;return!t}a=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:N("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},a);var E=[],H=0,P=document.getElementById(a.container),K=null,ka=0,ma=0,Da=false,Ha=null,Na=null,
hb=a.guides,ab=1,ta=Ra.init(),Ta=0,Fa=0,$a=0,Za=null,i=null,h=false,l=false,o=0,d=null,j=null,q=0,z=null,B=false,Y=0,X=null,T=1,R=0,I=typeof FlashCanvas!=="undefined",fa=~~(1E3/a.fps),V,ha,ba=da("ACTIVE"),na=da("PAN"),ya=da("ZOOM"),ua=da("ANIMATING"),sa=ba,Ya=S.getRect,ob=ra.diagonalSize,nb=ra.center,ca={id:a.id,deviceScaling:ab,fastDraw:a.fastDraw||m().requireFastDraw,getDimensions:function(){return ta},getLayer:function(t){for(var w=0;w<H;w++)if(E[w].getId()==t)return E[w];return null},setLayer:function(t,
w){for(var Q=0;Q<H;Q++)if(E[Q].getId()===t){E.splice(Q,1);break}w&&r(t,w);J();return w},eachLayer:function(t){for(var w=H;w--;)t(E[w])},invalidate:J,resize:function(t,w){if(P){a.autoSize=false;P.width=t;P.height=w;p();ca.trigger("resize",P.width,P.height)}},scale:function(t,w,Q,W){function $(){T=Math.pow(2,Math.round(Math.log(T)/Math.LN2));W&&W();g(true)}var ea=T;w||(w=Ra.getCenter(ta));k(w);if(Q)D(0,t-ea,Q,$,1E3).requestUpdates(function(oa){T=ea+oa;g()});else{T=t;$()}return ca},triggerAll:O,removeLayer:function(t){a:{for(var w=
H;w--;)if(E[w].getId()==t){t=w;break a}t=-1}if(t>=0&&t<H){ca.trigger("layerRemoved",E[t]);E.splice(t,1);J()}H=E.length},stateOverride:function(t){z=t},getOffset:function(){return S.init(ka,ma)},getViewRect:x,updateOffset:s,pan:function(t,w,Q,W,$){s(ka+t,ma+w,Q,W,$)},zoom:function(t,w){k(t);l=false;T=Math.max(T+Math.pow(2,w)-1,0.25);COG.Log.info("zooming, scale change = "+w+", targetXY = ",t);g()}};ab=m().getScaling();ca.markers=r("markers",new ib);COG.observable(ca);ca.bind("invalidate",function(t,
w){J(w)});if(a.pannable){ca.bind("pan",f);ca.bind("panEnd",c);ca.bind("inertiaCancel",function(){l=false;J()})}if(a.scalable){ca.bind("pinchZoom",b);ca.bind("wheelZoom",e)}ca.bind("tap",function(t,w,Q){for(var W=S.offset(Q,ka,ma),$=E.length;$--;)t.cancel=t.cancel||E[$].trigger("tap",w,Q,W).cancel});ca.bind("resync",function(){j=d=null});COG.configurable(ca,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(a,null,{container:function(t,w){P=document.getElementById(w);
p()},rotation:function(t,w){q=w}}),true);p();a.autoSize&&window.addEventListener("resize",n,false);return ca},Ua=function(a){a=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:da("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);var f=null,c=false,b=false,e=a.supportFastDraw,g=a.id,k=da("ACTIVE"),n=a.validStates,s=0,p=0,r=COG.extend({addToView:function(u){u.setLayer(g,r)},shouldDraw:function(u,A,L){return(b||L||s!==A.x1||p!==A.y1)&&(u&n)!==0&&(c?e:
true)},clip:null,cycle:function(){},draw:function(){},remove:function(){r.trigger("remove",r)},changed:function(u){b=true;r.trigger("changed",r);f&&f.trigger("invalidate",u)},getId:function(){return g},setId:function(u){g=u},getParent:function(){return f},setParent:function(u){c=(f=u)?f.fastDraw&&displayState!==k:false;r.trigger("parentChange",f)}},a);COG.observable(r);r.bind("drawComplete",function(u,A){b=false;s=A.x1;p=A.y1});r.bind("resync",function(u,A){if(A.syncXY){r.minXY&&A.syncXY(r.minXY);
r.maxXY&&A.syncXY(r.maxXY)}});return r},jb=function(a){function f(s,p,r,u){b=s;e=p;g=r;k=u}a=COG.extend({xy:S.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},a);var c=false,b=0,e=0,g=0,k=0,n=COG.extend(a,{isAnimating:function(){return c},draw:function(s,p,r,u,A){if(n.isNew&&a.tweenIn){var L=n.xy.y;n.xy.y=p.y1-20;c=true;v(n.xy,"y",L,a.tweenIn,function(){n.xy.y=L>>0;c=false},a.animationSpeed?a.animationSpeed:250+Math.random()*500)}n.drawMarker(s,p,n.xy.x,n.xy.y,r,u,A);n.isNew=false},
drawMarker:function(s,p,r,u){s.beginPath();s.arc(r,u,4,0,Math.PI*2,false);s.fill();f(r-4,u-4,8,8)},hitTest:function(s,p){return s>=b&&s<=b+g&&p>=e&&p<=e+k},updateBounds:f});COG.observable(n);return n},ib=function(a){function f(){e.changed();e.trigger("markerUpdate",b)}function c(){var g=e.getParent();if(g&&g.syncXY)for(var k=b.length;k--;)g.syncXY([b[k].xy])}a=COG.extend({zindex:100,style:"basic"},a);var b=[],e=COG.extend(new Ua(a),{draw:function(g,k,n,s){for(var p=b.length;p--;)b[p].draw(g,k,n,e,
s)},add:function(g){if(g&&typeof g.length!=="undefined")for(var k=g.length;k--;){if(g[k])b[b.length]=g[k]}else if(g)b[b.length]=g;f()},clear:function(g){if(g)for(var k=0;k<b.length;k++)g(b[k])&&b.splice(k,1);else b=[];f()},each:function(g){if(g)for(var k=b.length;k--;)g(b[k])},find:function(g){for(var k=[],n=b.length;n--;)if(!g||g(b[n]))k[k.length]=b[n];return k}});e.bind("tap",function(g,k,n){for(var s=[],p=n.x,r=n.y,u=b.length;u--;)if(b[u].hitTest(p,r))s[s.length]=b[u];if(s.length>0)g.cancel=e.trigger("markerTap",
k,n,s).cancel});e.bind("parentChange",c);e.bind("resync",c);e.bind("changed",c);return e},qb=function(a){function f(n,s,p){n.fillStyle="#FFFFFF";n.strokeStyle="#222222";n.beginPath();n.arc(p.x,p.y,4,0,Math.PI*2,false);n.stroke();n.fill()}a=COG.extend({path:[],id:COG.objId("pathAni"),easing:N("sine.inout"),validStates:da("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},a);var c=S.edges(a.path),b,e=null,g=0;D(0,c.total,a.easing,function(){k.remove()},a.duration).requestUpdates(function(n,s){g=
n;s&&k.remove()});var k=COG.extend(new Ua(a),{cycle:function(){for(var n=0;n<c.accrued.length&&c.accrued[n]<g;)n++;e=null;if(n<a.path.length-1){var s=g-(n>0?c.accrued[n-1]:0),p=a.path[n];b=S.theta(p,a.path[n+1],c.edges[n]);e=S.extendBy(p,b,s)}return e},draw:function(n,s){if(e)(a.drawIndicator?a.drawIndicator:f)(n,s,S.init(e.x,e.y),b)}});return k},rb=function(a){a=COG.extend({style:null,properties:{}},a);return COG.extend(a,{rect:null,draw:function(){},resync:function(){}})},kb=function(a,f){f=COG.extend({fill:false,
simplify:false},f);var c=false,b=f.fill,e=f.simplify,g=da("ZOOM"),k=[],n=COG.extend(new rb(f),{draw:function(s,p,r,u,A,L){if(c){p=true;r=(L&g)!==0;s.beginPath();for(L=k.length;L--;){r=k[L].x;u=k[L].y;if(p){s.moveTo(r,u);p=false}else s.lineTo(r,u);r=true}if(r){b&&s.fill();s.stroke()}}},resync:function(s){n.xy=s.syncXY(a);k=S.floor(e?S.simplify(a):a)}});c=a&&a.length>=2;return n},sb=function(a){function f(g){for(var k=b.length;k--;)b[k].resync(g);b.sort(function(n,s){var p=s.xy.y-n.xy.y;if(p===0)p=
s.xy.x-n.xy.y;return p});e.changed()}function c(g,k){k.syncXY&&f(k)}a=COG.extend({zindex:80},a);var b=[],e=COG.extend(new Ua(a),{add:function(g){b[b.length]=g},each:function(g){for(var k=b.length;k--;)g(b[k])},draw:function(g,k,n){var s=k.x1,p=k.y1,r=k.width;k=k.height;for(var u=b.length;u--;){var A=b[u].style;A=A?Sa.apply(g,A):null;b[u].draw(g,s,p,r,k,n);A&&Sa.apply(g,A)}}});e.bind("parentChange",c);e.bind("resync",c);return e},wb=function(){return{tileSize:256,init:function(a,f,c,b,e){return COG.extend({x:a,
y:f,width:c,height:b},e)}}}(),tb=function(a){function f(M,J,x,O){function E(){if(L.initTileCreator){n=true;L.initTileCreator(M,J,x,O)}}L.prepTileCreator?L.prepTileCreator(M,J,x,E):E()}function c(M,J){for(var x=~~((M.x1-g.x)/s),O=~~((M.y1-g.y)/p),E=[],H=-k;H<u;H++)for(var P=-k;P<A;P++){var K=r(x+H,O+P);if(K)E[E.length]=K}J&&J(E);e=ra.copy(M)}a=COG.extend({tileWidth:256,tileHeight:256,relative:false,padding:2},a);var b=null,e=null,g=S.init(),k=a.padding,n=false,s=a.tileWidth,p=a.tileHeight,r=null,u=
0,A=0,L={bindToView:function(M){COG.Log.info("initializing generator");b=M;L.trigger("bindView",M)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){r=null;n=false;e=null},run:function(M,J){if(!e||Math.abs(M.x1-e.x1)>s||Math.abs(M.y1-e.y1)>p){if(!r&&!n||L.requireRefresh()){g=a.relative?S.init(M.x1,M.y1):S.init();u=Math.ceil(M.width/s)+k;A=Math.ceil(M.height/p)+k;f(s,p,L.getTileCreatorArgs?L.getTileCreatorArgs(b):{},function(x){r=
x;n=false;c(M,J)})}r&&c(M,J)}}};COG.observable(L);L.bind("update",function(){COG.Log.info("captured generator update");e=null});return L},va={ex:COG.extend,ticks:pa,getConfig:m,userMessage:function(a,f,c){va.trigger("userMessage",a,f,c)},XY:S,XYRect:ra,Dimensions:Ra,Vector:vb,D:Ra,Images:Xa,Generator:fb,tween:v,tweenValue:D,easing:N,registerEasingType:function(a,f){Wa[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]=f},Tween:eb,Style:Sa,viewState:da,View:pb,ViewLayer:Ua,ImageLayer:function(a,f){function c(p,
r,u){for(r=g.length;r--;){var A=g[r],L=A.x,M=A.y,J=ra.init(A.x,A.y,A.x+A.width,A.y+A.height);if(u&&ra.intersect(p,J)){J=Xa.get(A.url,function(){s.changed()},n);u(J,L,M,A.width,A.height)}}}function b(p){e&&e.run(p,function(r){g=[].concat(r);s.changed()})}f=COG.extend({imageLoadArgs:{}},f);var e=a?fb.init(a,f):null,g=[],k=ra.init(),n=f.imageLoadArgs,s=COG.extend(new Ua(f),{changeGenerator:function(p,r){e=fb.init(p,COG.extend({},f,r));e.bindToView(s.getParent());g=null;b(k)},clip:function(p,r,u){c(r,
u,function(A,L,M,J,x){A&&p.rect(L,M,J,x)})},cycle:function(p,r){b(r)},draw:function(p,r,u){c(r,u,function(A,L,M,J,x){s.drawImage(p,A,L,M,J,x,r,u)});k=ra.copy(r)},drawImage:function(p,r,u,A){r&&p.drawImage(r,u,A,r.width,r.height)}});s.bind("idle",function(){b(k)});s.bind("parentChange",function(p,r){e&&e.bindToView(r)});s.bind("tap",function(p,r,u,A){p=[];var L=A.x,M=A.y,J,x;if(g)for(var O=g.length;O--;){J=g[O];if(x=L>=J.x&&L<=J.x+J.width&&M>=J.y&&M<=J.y+J.height)p[p.length]=J}p.length>0&&s.trigger("tapImage",
p,r,u,A)});return s},Marker:jb,ImageMarker:function(a){a=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},a);var f=a.imageAnchor?T5.XY.invert(a.imageAnchor):null,c=COG.extend(new jb(a),{drawMarker:function(b,e,g,k){if((e=c.isAnimating()&&c.animatingImage?c.animatingImage:c.image)&&e.width>0){f||(f=S.init(-e.width>>1,-e.height>>1));var n=c.scale,s=g+~~(f.x*n),p=k+~~(f.y*n),r=~~(e.width*n),u=~~(e.height*n);c.updateBounds(s,
p,r,r);if(c.rotation||c.opacity!==1){b.save();try{b.globalAlpha=c.opacity;b.translate(g,k);b.rotate(c.rotation);b.drawImage(e,f.x*n,f.y*n,r,u)}finally{b.restore()}}else b.drawImage(e,s,p,r,u)}}});if(!c.image)c.image=Xa.get(a.imageUrl,function(b){c.image=b});if(!c.animatingImage)c.animatingImage=Xa.get(a.animatingImageUrl,function(b){c.animatingImage=b});return c},MarkerLayer:ib,PathLayer:function(a){a=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},a);var f=false,c=[],b=null,e=[],g=
null,k=0,n=[],s=COG.extend(new Ua(a),{getAnimation:function(p,r,u,A){var L="pathAnimation"+k++;n.push(L);return new qb({id:L,path:c,zindex:a.zindex+1,easing:p?p:N("sine.inout"),duration:r?r:5E3,drawIndicator:u,autoCenter:A?A:false})},cycle:function(p,r,u,A){return A},draw:function(p){var r,u=c.length;p.save();try{Sa.apply(p,a.style);if(u>0){p.beginPath();p.moveTo(c[u-1].x,c[u-1].y);for(r=u;r--;)p.lineTo(c[r].x,c[r].y);p.stroke();if(b){p.fillStyle=a.waypointFillStyle;for(r=b.length;r--;){p.beginPath();
p.arc(b[r].x,b[r].y,2,0,Math.PI*2,false);p.stroke();p.fill()}}}}finally{p.restore()}f=false},updateCoordinates:function(p,r){e=p;g=r;var u=s.getParent();if(u&&u.syncXY){u.syncXY(e);g&&u.syncXY(g);s.trigger("tidy")}}});s.bind("tidy",function(){c=S.simplify(e,a.pixelGeneralization);b=S.simplify(g,a.pixelGeneralization);f=true;s.changed()});return s},AnimatedPathLayer:qb,Shape:rb,Arc:function(a,f){f=COG.extend({size:4},f);var c=S.init(),b=COG.extend(f,{draw:function(e){e.beginPath();e.arc(c.x,c.y,b.size,
0,Math.PI*2,false);e.fill();e.stroke()},resync:function(e){e.syncXY([a]);c=S.floor([a])[0]}});COG.Log.info("created arc = ",a);return b},Poly:kb,ShapeLayer:sb,Tiling:wb,TileGenerator:tb};COG.observable(va);var za=va.Geo=function(){function a(i){i=parseFloat(i)*M;i=Math.sin(i);var h=x*i;return Math.log((1+i)/(1-i)*Math.pow((1-h)/(1+h),x))/2}function f(i){return parseFloat(i)*M}function c(i){i=Math.pow(Math.E,-i);for(var h=qa-2*Math.atan(i),l=g(h,i),o=0;o<E&&Math.abs(h-l)>O;){h=l;l=g(h,i);o++}return l*
J}function b(i){return i%360*J}function e(i,h){var l=null;for(var o in engines)if(h){if(o==h&&engines[o][i]){l=engines[o];break}}else if(engines[o][i]){l=engines[o];break}return l}function g(i,h){var l=x*Math.sin(i);return qa-2*Math.atan(h*Math.pow((1-l)/(1+l),x/2))}function k(i,h,l,o){h=s(h);i.add(o.line(h,l));return h.length}function n(i,h,l,o){h=s(h);i.add(o.poly(h,l));return h.length}function s(i){var h=i?i.length:0,l=Array(h);for(h=h;h--;)l[h]=za.Position.init(i[h][1],i[h][0]);return za.Position.vectorize(l,
Ta)}function p(i,h,l){return new Za(i,h,l)}var r=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],u=-qa,A=qa,L=-ga,M=Math.PI/180,J=180/Math.PI,x=0.08181919084262157,O=1.0E-7,E=12,H=null,P={RD:"ROAD",ST:"STREET",CR:"CRESCENT",CRES:"CRESCENT",CT:"COURT",LN:"LANE",HWY:"HIGHWAY",MWY:"MOTORWAY"},K=function(){function i(d){return d?l(d.lat,d.lon):null}function h(d){return!d||d.lat===0&&d.lon===0}function l(d,j){return{lat:parseFloat(d?d:0),lon:parseFloat(j?j:0)}}
function o(d){if(d)if(typeof d.lat!=="undefined")return i(d);else{if(d.split)for(var j=[" ",","],q=0;q<j.length;q++){var z=d.split(j[q]);if(z.length===2)return l(z[0],z[1])}}else return l();return null}return{calcDistance:function(d,j){if(h(d)||h(j))return 0;var q=(j.lat-d.lat)*M/2,z=(j.lon-d.lon)*M/2;q=Math.sin(q)*Math.sin(q)+Math.cos(d.lat*M)*Math.cos(j.lat*M)*Math.sin(z)*Math.sin(z);return 6371*2*Math.atan2(Math.sqrt(q),Math.sqrt(1-q))},copy:i,empty:h,equal:function(d,j){return d&&j&&d.lat==j.lat&&
d.lon==j.lon},fromMercatorPixels:function(d,j){return l(c(j),b(d))},generalize:function(d,j,q){var z=d.length,B=[],Y=null;q||(q=250);q/=1E3;COG.Log.info("generalizing positions, must include "+j.length+" positions");for(var X=z;X--;)if(X===0)B.unshift(d[X]);else{var T=!Y||K.inArray(d[X],j)?q:K.calcDistance(Y,d[X]);if(d[X]&&T>=q){B.unshift(d[X]);Y=d[X]}}COG.Log.info("generalized "+z+" positions into "+B.length+" positions");return B},inArray:function(d,j){for(var q=K.equal,z=j.length;z--;)if(q(d,j[z]))return true;
return false},inBounds:function(d,j){var q=!(K.empty(d)||K.empty(j));return q=(q=q&&d.lat>=j.min.lat&&d.lat<=j.max.lat)&&d.lon>=j.min.lon&&d.lon<=j.max.lon},init:l,offset:function(d,j,q){var z=d.lat*M;j=z+j/6371;for(d=d.lon*M+Math.asin(Math.sin(q/6371)/Math.cos(z));j<u;)j+=Math.PI;for(;j>A;)j-=Math.PI;for(;d>ga;)d-=2*Math.PI;return l(j*J,d*J)},parse:o,parseArray:function(d){var j=d.length,q=Array(j);for(j=j;j--;)q[j]=o(d[j]);return q},toMercatorPixels:function(d){return T5.XY.init(f(d.lon),a(d.lat))},
toString:function(d){return d?d.lat+" "+d.lon:""},vectorize:function(d,j){var q=d.length,z=Array(q);j=COG.extend({chunkSize:500,async:true},j);if(!j.async){for(var B=q;B--;)z[B]=T5.GeoXY.init(d[B]);return z}return COG.Loopage.join({frequency:10,execute:function(Y,X){for(var T=0,R=j.chunkSize,I=q;I--;){z[I]=T5.GeoXY.init(d[I]);T+=1;if(T>R)break}q=I;q<=0&&X.trigger("complete",z)}})}}}(),ka=function(){function i(d,j,q){var z=T5.XY.init(0,j.lat-d.lat);if(typeof q==="undefined")q=true;z.x=q&&d.lon>j.lon?
360-d.lon+j.lon:j.lon-d.lon;return z}function h(d,j){return ka.init(K.init(d.min.lat-j,d.min.lon-j%360),K.init(d.max.lat+j,d.max.lon+j%360))}function l(d){var j=i(d.min,d.max);return K.init(d.min.lat+j.y/2,d.min.lon+j.x/2)}function o(d,j){return{min:K.parse(d),max:K.parse(j)}}return{calcSize:i,createBoundsFromCenter:function(d,j){var q=j/6371,z=d.lat*M,B=d.lon*M,Y=z-q,X=z+q;if(Y>u&&X<A){z=Math.asin(Math.sin(q)/Math.cos(z));q=B-z;if(q<L)q+=2*Math.PI;B=B+z;if(B>ga)B-=2*Math.PI}else{Y=Math.max(Y,u);
X=Math.min(X,A);q=L;B=ga}return ka.init(K.init(Y*J,q*J),K.init(X*J,B*J))},expand:h,forPositions:function(d,j){var q=null,z=T5.ticks();j||(j="auto");for(var B=d.length;B--;)if(q){var Y=i(q.min,d[B],false),X=i(d[B],q.max,false);if(Y.x<0)q.min.lon=d[B].lon;if(Y.y<0)q.min.lat=d[B].lat;if(X.x<0)q.max.lon=d[B].lon;if(X.y<0)q.max.lat=d[B].lat}else q=o(d[B],d[B]);if(j){if(j=="auto"){B=i(q.min,q.max);j=Math.max(B.x,B.y)*0.3}q=h(q,j)}COG.Log.trace("calculated bounds for "+d.length+" positions",z);return q},
getCenter:l,getGeoHash:function(d){var j=T5.Geo.GeoHash.encode(d.min.lat,d.min.lon);d=T5.Geo.GeoHash.encode(d.max.lat,d.max.lon);COG.Log.info("min hash = "+j+", max hash = "+d)},getZoomLevel:function(d,j){var q=l(d),z=r[Math.min(Math.round(Math.abs(q.lat)*0.05),r.length)],B=i(d.min,d.max);q=Math.ceil(Math.log(r[3]*j.height/B.y)/Math.log(2));z=Math.ceil(Math.log(z*j.width/B.x)/Math.log(2));return Math.min(isNaN(q)?1E3:q,isNaN(z)?1E3:z)},init:o,isEmpty:function(d){return!d||K.empty(d.min)||K.empty(d.max)},
toString:function(d){return"min: "+K.toString(d.min)+", max: "+K.toString(d.max)}}}(),ma=function(){var i=/^(\d+).*$/,h=/(\d+)\s?\-\s?(\d+)/;return{buildingMatch:function(l,o){i.lastIndex=-1;if(i.test(l))for(var d=l.replace(i,"$1"),j=o.split(","),q=0;q<j.length;q++){h.lastIndex=-1;if(h.test(j[q])){var z=h.exec(j[q]);if(d>=parseInt(z[1],10)&&d<=parseInt(z[2],10))return true}else if(d==j[q])return true}return false},normalize:function(l){if(!l)return"";l=l.toUpperCase();if(!H){var o=[];for(var d in P)o.push(d);
H=RegExp("(\\s)("+o.join("|")+")(\\s|$)","i")}H.lastIndex=-1;if(o=H.exec(l))l=l.replace(H,"$1"+P[o[2]]);return l},toString:function(l){return l.streetDetails+" "+l.location}}}(),Da=va.GeoXY=function(){function i(l,o){if(l.length){for(var d,j,q,z,B=l.length;B--;){i(l[B],o);d=typeof d==="undefined"||l.x<d?l.x:d;j=typeof j==="undefined"||l.y<j?l.y:j;q=typeof q==="undefined"||l.x>q?l.x:q;z=typeof z==="undefined"||l.y>z?l.y:z}return ra.init(d,j,z,z)}else if(l.mercXY){d=l.mercXY;l.x=~~(d.x/o);l.y=~~((Math.PI-
d.y)/o);l.rpp=o}else COG.Log.warn("Attempted to sync an XY composite, not a GeoXY");return l}function h(l,o,d){l.pos=o;l.mercXY=K.toMercatorPixels(o);(d=typeof d!=="undefined"?d:l.rpp)&&i(l,d)}return{init:function(l,o){var d=S.init();h(d,l,o);return d},sync:i,toPos:function(l,o){o=o?o:self.rpp;return K.fromMercatorPixels(l.x*o,Math.PI-l.y*o)},updatePos:h}}();va.GeoVector=function(i){COG.Log.warn("The T5.Geo.GeoVector class has been deprecated, please use T5.GeoXY.init instead");return Da.init(i)};
var Ha=function(){return{bestResults:function(i,h){h||(h=20);for(var l=i.length>0?i[0]:null,o=[],d=0;d<i.length;d++)if(l&&i[d]&&l.matchWeight-i[d].matchWeight<=h)o.push(i[d]);else break;return o}}}(),Na=function(i){i=COG.extend({id:null,caption:"",resultType:"",data:null,pos:null,matchWeight:0},i);return COG.extend(i,{toString:function(){return i.caption+(i.matchWeight?" ("+i.matchWeight+")":"")}})},hb=function(){var i={calculate:function(h){h=COG.extend({engineId:"",waypoints:[],map:null,error:null,
autoFit:true,success:null,generalize:false},h);var l=T5.Geo.getEngine("route");l&&l.route(h,function(o){if(h.generalize)o.geometry=T5.Geo.Position.generalize(o.geometry,o.getInstructionPositions());if(h.map){i.createMapOverlay(h.map,o);h.autoFit&&h.map.gotoBounds(o.boundingBox)}h.success&&h.success(o)})},createMapOverlay:function(h,l){var o=h.getDimensions();o=new T5.Geo.UI.RouteOverlay({data:l,width:o.width,height:o.height});h.setLayer("route",o)},parseTurnType:function(h){for(var l=i.TurnType.Unknown,
o=T5.Geo.Routing.TurnTypeRules,d=0;d<o.length;d++){o[d].regex.lastIndex=-1;var j=o[d].regex.exec(h);if(j){l=o[d].customCheck?o[d].customCheck(h,j):o[d].turnType;break}}return l},TurnType:{Unknown:"turn-unknown",Start:"turn-none-start",Continue:"turn-none",Arrive:"turn-none-arrive",TurnLeft:"turn-left",TurnLeftSlight:"turn-left-slight",TurnLeftSharp:"turn-left-sharp",TurnRight:"turn-right",TurnRightSlight:"turn-right-slight",TurnRightSharp:"turn-right-sharp",Merge:"merge",UTurnLeft:"uturn-left",UTurnRight:"uturn-right",
EnterRoundabout:"roundabout-enter",Ramp:"ramp",RampExit:"ramp-exit"},Instruction:function(h){var l=h=COG.extend({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},h),o=h.description;o=o.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");l.description=o;if(!h.turnType)h.turnType=i.parseTurnType(h.description);return h},RouteData:function(h){h=COG.extend({geometry:[],instructions:[],boundingBox:null},h);if(!h.boundingBox)h.boundingBox=T5.Geo.BoundingBox.forPositions(h.geometry);
return COG.extend({getInstructionPositions:function(){for(var l=[],o=0;o<h.instructions.length;o++)h.instructions[o].position&&l.push(h.instructions[o].position);return l}},h)}};return i}(),ab="featurecollection",ta="feature",Ta={async:false},Fa={processor:null,group:"shapes",layerClass:sb},$a={point:COG.extend({},Fa,{processor:function(i,h,l,o){h=s([h.coordinates],Ta);if(h.length>0)if(l=o.marker(h[0],l)){i.add(l);return h.length}},group:"markers",layerClass:ib}),linestring:COG.extend({},Fa,{processor:function(i,
h,l,o){h=s(h&&h.coordinates?h.coordinates:[]);return k(i,h,l,o)}}),multilinestring:COG.extend({},Fa,{processor:function(i,h,l,o){h=h&&h.coordinates?h.coordinates:[];for(var d=0,j=h.length;j--;)d+=k(i,h[j],l,o);return d}}),polygon:COG.extend({},Fa,{processor:function(i,h,l,o){h=h&&h.coordinates?h.coordinates:[];if(h.length>0)return n(i,h[0],l,o);return 0}}),multipolygon:COG.extend({},Fa,{processor:function(i,h,l,o){h=h&&h.coordinates?h.coordinates:[];for(var d=0,j=0;j<h.length;j++)d+=n(i,h[j][0],l,
o);return d}})},Za=function(i,h,l,o){function d(V,ha){var ba=V.processor,na=B+V.group,ya=COG.extend({},V,l,{properties:ha.properties});if(ba){var ua=I[na];if(!ua){ua=new V.layerClass({id:na});I[na]=ua}globalLayers=I;return ba(ua,ha.data,ya,o)}return 0}function j(V,ha){var ba=V&&V.type?V.type.toLowerCase():null;return ba&&ba===ta?j(V.geometry,V.properties):{type:ba,isCollection:ba?ba===ab:false,definition:$a[ba],data:V,properties:ha?ha:V.properties}}l=COG.extend({vectorsPerCycle:za.VECTORIZE_PER_CYCLE,
rowPreParse:null,simplify:false,layerPrefix:"geojson-"},l);o=COG.extend({marker:function(V){return new jb({xy:V})},line:function(V,ha){return new kb(V,ha)},poly:function(V,ha){return new kb(V,COG.extend({fill:true},ha))}},o);var q=l.vectorsPerCycle,z=l.rowPreParse,B=l.layerPrefix,Y=0,X=0,T=null,R=0,I={},fa;if(!i)return null;if(typeof i.length==="undefined")i=[i];X=i.length;fa=COG.Loopage.join({frequency:10,execute:function(V,ha){var ba=0,na=Y;if(!T){for(;na<X;na++){var ya=j(z?z(i[na]):i[na]),ua=null;
if(ya.isCollection){R+=1;T=p(ya.data.features,function(sa){T=null;for(var Ya in sa)I[Ya]=sa[Ya]},{layerPrefix:B+R+"-"});ua+=1}else if(ya.definition)ua=d(ya.definition,ya);ba+=ua?ua:1;if(ba>=q)break}Y=na+1;!T&&Y>=X&&ha.trigger("complete")}}});fa.bind("complete",function(){h&&h(I)});return fa};va.GeoJSON={parse:p};va.Map=function(i){function h(I){try{var fa=za.Position.init(I.coords.latitude,I.coords.longitude),V=I.coords.accuracy/1E3;R.trigger("locationUpdate",I,V);if(X){if(!B){B=new za.UI.LocationOverlay({pos:fa,
accuracy:V});B.update(R.getTileLayer());R.setLayer("location",B)}var ha=za.BoundingBox.createBoundsFromCenter(fa,Math.max(V,1));R.gotoBounds(ha)}else{B.pos=fa;B.accuracy=V;B.update(R.getTileLayer());d(fa,null,N("sine.out"))}X=false}catch(ba){COG.Log.exception(ba)}}function l(I){COG.Log.info("caught location tracking error:",I)}function o(I,fa,V){R.setZoomLevel(fa);Xa.cancelLoad();F();d(I,V)}function d(I,fa,V,ha){I=Da.init(I,za.radsPerPixel(R.getZoomLevel()));var ba=R.getDimensions();R.updateOffset(I.x-
ba.width/2,I.y-ba.height/2,V,ha,fa);R.trigger("wake");R.trigger("boundsChange",R.getBoundingBox());fa&&typeof V==="undefined"&&fa(R)}i=COG.extend({tapExtent:10,crosshair:false,zoomLevel:0,boundsChangeThreshold:30},i);var j={NONE:0,SINGLE:1,WATCH:2},q=S.init(),z=j.NONE,B=null,Y=0,X=true,T=0;i.adjustScaleFactor=function(I){return Math.pow(2,(I<1?Math.floor:Math.ceil)(Math.log(I)))};var R=COG.extend(new pb(i),{getBoundingBox:function(){var I=R.getViewRect();return za.BoundingBox.init(Da.toPos(S.init(I.x1,
I.y2),T),Da.toPos(S.init(I.x2,I.y1),T))},getCenterPosition:function(){var I=R.getViewRect();if(I){I=S.init(I.x1+I.width/2,I.y1+I.height/2);return Da.toPos(I,T)}return null},gotoBounds:function(I,fa){var V=za.BoundingBox.getZoomLevel(I,R.getDimensions());o(za.BoundingBox.getCenter(I),V,fa)},gotoPosition:o,panToPosition:d,syncXY:function(I){return Da.sync(I,T)},locate:function(){R.trackStart(j.SINGLE);setTimeout(R.trackCancel,1E4)},trackStart:function(I){if(navigator.geolocation&&!Y){z=I?I:j.WATCH;
X=true;Y=navigator.geolocation.watchPosition(h,l,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3})}},trackCancel:function(){Y&&navigator.geolocation&&navigator.geolocation.clearWatch(Y);R.removeLayer("location");B=null;z=j.NONE;Y=0},animateRoute:function(I,fa,V,ha){var ba=R.getLayer("route");if(ba)(I=ba.getAnimation(I,fa,V,ha))&&I.addToView(R)}});R.bind("pan",function(){z===j.SINGLE&&R.trackCancel()});R.bind("tap",function(){});R.bind("idle",function(){if(S.absSize(S.diff(q,R.getOffset()))>i.boundsChangeThreshold){q=
S.copy(R.getOffset());R.trigger("boundsChange",R.getBoundingBox())}});y(R,i);R.bind("zoomLevelChange",function(I,fa){T=za.radsPerPixel(fa);R.triggerAll("resync",R)});return R};va.MapTileGenerator=function(i){function h(j,q){var z=q>=d.minLevel&&(!d.maxLevel||q<=d.maxLevel);COG.Log.info("new zoom level = "+q+", zoom ok = "+z);j.cancel=!z;if(z){l=q;d.reset()}}i=COG.extend({relative:true},i);var l=0,o=null,d=COG.extend(new tb(i),{minLevel:2,maxLevel:20,getTileCreatorArgs:function(j){o=j.getCenterPosition();
return{zoomLevel:l,position:o}},requireRefresh:function(){return!o}});d.bind("bindView",function(j,q){if(q.getZoomLevel){l=q.getZoomLevel();q.bind("zoomLevelChange",h)}});return d};va.GeoPoly=function(i,h){h=COG.extend({autoParse:true},h);for(var l=Array(i.length),o=h.autoParse,d=T5.Geo.Position.parse,j=i.length;j--;)l[j]=T5.GeoXY.init(o?d(i[j]):i[j]);return new T5.Poly(l,h)};va.RouteOverlay=function(i){i=COG.extend({data:null,pixelGeneralization:8,partialDraw:false,strokeStyle:"rgba(0, 51, 119, 0.9)",
waypointFillStyle:"#FFFFFF",lineWidth:4,zindex:50},i);var h=[],l=[],o=new T5.PathLayer(i);(function(){if(i.data&&i.data.instructions){for(var d=i.data.instructions,j=Array(d.length),q=d.length;q--;)j[q]=d[q].position;T5.Geo.Position.vectorize(j).bind("complete",function(z,B){l=B})}i.data&&i.data.geometry&&T5.Geo.Position.vectorize(i.data.geometry).bind("complete",function(z,B){h=B;o.updateCoordinates(h,l,true)})})();return o};va.LocationOverlay=function(i){i=COG.extend({pos:null,accuracy:null,zindex:90},
i);var h=new Image,l=T5.XY.init(),o=T5.XY.init(),d=null;h.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACIQAAAiEBPhEQkwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAG+SURBVCiRlZHNahNRAIW/O7mTTJPahLZBA1YUyriINRAE3bQIKm40m8K8gLj0CRQkO32ELHUlKbgoIu4EqeJPgtCaoBuNtjXt5LeTMZk0mbmuWiuuPLsD3+HAOUIpxf9IHjWmaUbEyWv5ROrsVULhcHP761rUfnN3Y2Otc8CIg4YT85lzuVsPP+Qupw1vpPjRCvhS9ymvV0e77x7nNj+uvADQAIQQ+uLyvdfLV9JGZi7EdEwQlqBpEJ019f0z1mo2u5Q8DMydv25lshemmj1FueZTawbs7inarqLbV7Qjab1upB9YlhWSAHLavLHZCvg1VEhN0PMU9W7At4bPVidg7CtkLLXkut+lBPD6/Ub155jJiADAHSpaLmx3ApyBQoYEUd0PBoOBkAC6+3llvda/YxgGgYL+UNHf/zN3KiExGlsvTdP0NYDkhPdWrz35ZDsBzV5wCMuQwEyFmXFeeadjzfuFQmGkAZRKpdGC/n7x+M6jqvA9Zo6FWDhlcHE+wqT93J1tP7vpOE7rrx8ALMuasPf8S12St4WmJ6bYWTUC52k8Hm8Vi0X/nwBAPp/XKpWKdF1X2LYdlMvlsToC/QYTls7DLFr/PAAAAABJRU5ErkJggg%3D%3D";
h.onload=function(){l=T5.XY.init(h.width/2,h.height/2)};var j=COG.extend(new T5.ViewLayer(i),{pos:i.pos,accuracy:i.accuracy,drawAccuracyIndicator:false,draw:function(q,z){var B=o.x-z.x,Y=o.y-z.y;if(d){q.fillStyle="rgba(30, 30, 30, 0.2)";q.beginPath();q.arc(B,Y,d,0,Math.PI*2,false);q.fill()}h.complete&&h.width>0&&q.drawImage(h,B-l.x,Y-l.y,h.width,h.height);j.changed()},update:function(q){if(q){d=Math.floor(q.getPixelDistance(j.accuracy)*0.5);o=q.getGridXYForPosition(j.pos);j.changed()}}});j.bind("gridUpdate",
function(q,z){j.update(z)});return j};return{distanceToString:function(i){if(i>1E3)return~~(i/10)/100+" km";return i?i+" m":""},dist2rad:function(i){return i/6371},getEngine:function(i){for(var h=null,l=1;!h&&l<arguments.length;l++)h=e(i,arguments[l]);h=h?h:e(i);if(!h)throw Error("Unable to find GEO engine with "+i+" capability");return h},lat2pix:a,lon2pix:f,pix2lat:c,pix2lon:b,radsPerPixel:function(i){return 2*Math.PI/(256<<i)},Position:K,BoundingBox:ka,Radius:function(i,h){return{distance:parseInt(i,
10),uom:h}},Address:function(i){return i=COG.extend({streetDetails:"",location:"",country:"",postalCode:"",pos:null,boundingBox:null},i)},A:ma,GeocodeFieldWeights:{streetDetails:50,location:50},AddressCompareFns:{},Engine:function(i){if(!i.id)throw Error("A GEO.Engine cannot be registered without providing an id.");var h=COG.extend({remove:function(){delete engines[h.id]}},i);return engines[h.id]=h},Search:Ha,GeoSearchResult:Na,LocationSearch:function(i){function h(q,z){navigator.geolocation.clearWatch(o);
o=0;if(d){clearTimeout(d);d=0}z&&z([q],i)}function l(q){COG.Log.info("caught location tracking error:",q)}i=COG.extend({name:"Geolocation Search",requiredAccuracy:null,searchTimeout:5E3,watch:false},i);var o=0,d=0,j=null;return new T5.Geo.GeoSearchAgent(COG.extend({execute:function(q,z){if(navigator.geolocation&&!o){o=navigator.geolocation.watchPosition(function(B){var Y=K.init(B.coords.latitude,B.coords.longitude);B=new Na({id:1,caption:"Current Location",pos:Y,accuracy:B.coords.accuracy/1E3,matchWeight:100});
if(!j||B.accuracy<j.accuracy)j=B;if(!i.requiredAccuracy||j.accuracy<i.requiredAccuracy)h(j,z)},l,{enableHighAccuracy:true,timeout:1E4,maximumAge:5E3});if(i.searchTimeout)d=setTimeout(function(){j&&h(j,z)},i.searchTimeout)}}},i))},Routing:hb}}();return va}();
