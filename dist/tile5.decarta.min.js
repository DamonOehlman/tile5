(function(mb){function M(){var a=arguments[0]||{},c=Array.prototype.slice.call(arguments,1),b=c.length,f,i;for(i=0;i<b;i++)if((f=c[i])!==null)for(var e in f){var k=f[e];if(a!==k)if(k!==undefined)a[e]=k}return a}function ca(a,c){if(typeof console!=="undefined")console[c||"debug"](a)}function qa(a){var c=a.match(Eb),b=[],f=0,i;for(i=c?c.length:0;i--;){var e=c[i].slice(1);b[e]||(b[e]=RegExp("\\{"+e+"\\}","g"))}f=b.length;return function(){var k=a;for(i=0;i<f;i++){var d=arguments[i];if(typeof d=="undefined")d=
"";k=k.replace(b[i],d)}return k}}function Fb(a){a=a.replace(/[\-\_\s\.]/g,"").toLowerCase();return Ha[a]||Ha.linear}function Gb(a,c,b,f,i){function e(j){j=j?j:(new Date).getTime();var h=j-k,g=b(h,a,d,f),n=k+f<=j;j=!n;if(i){h=i(g,n,h);j=typeof h!="undefined"?h&&j:j}j&&animFrame(e)}var k=(new Date).getTime(),d=c-a;animFrame(e);return{}}function nb(a,c){var b=Na*xa(a);return Ia-2*ob(c*ya((1-b)/(1+b),Na/2))}function fa(a,c){if(R(a,ra)){var b=a.split(Xa);this.x=parseFloat(b[0]);this.y=parseFloat(b[1])}else{this.x=
a||0;this.y=c||0}}function ia(a,c){this.mercY=this.mercX=null;if(R(a,ra))pb.parseXY(a,this);else if(a&&a.toPixels){var b=a.toPixels();this.mercX=b.x;this.mercY=b.y}else fa.call(this,a,c)}function sa(a,c,b,f){this.x=a||0;this.y=c||0;this.w=b||0;this.h=f||0;this.x2=this.x+this.w;this.y2=this.y+this.h}function qb(a,c){if(!a)return null;c=c||Hb;for(var b=[],f=null,i=a.length;i--;){var e=a[i];if(include=!f||i===0||ga(e.x-f.x)+ga(e.y-f.y)>c){b.unshift(e);f=e}}return b}function rb(a,c){var b=new sb(Math.sqrt(256<<
a)|0);c&&c.zoomLevel===a&&c.copyInto(b);b.zoomLevel=a;return b}function tb(a){a=a||(new Date).getTime();for(var c=0;c<Ca.length;){var b=Ca[c],f=za[b],i=za[b].image&&za[b].image.complete&&za[b].image.width>0,e=a-f.start;e=i||e>=Ib;if(i){i=f.callbacks;ub[b]=f.image;for(var k=0;k<i.length;k++)i[k](f.image,true)}if(e){Ca.splice(c,1);delete za[b]}else c++}Ca.length>0&&animFrame(tb)}function Oa(a,c){var b=a&&c?ub[a]:null;if(b&&b&&b.complete&&b.width>0)c(b);else{if(b=za[a])b.callbacks.push(c);else{b=new Image;
b.id="_ldimg"+ ++Jb;za[a]={start:(new Date).getTime(),image:b,callbacks:[c]};b.src=a;Ca[Ca.length]=a}animFrame(tb)}}function Ya(a,c,b,f,i,e){this.x=a;this.y=c;this.w=f||256;this.h=f||256;this.x2=this.x+this.w;this.y2=this.y+this.h;this.url=b;this.id=e||a+"_"+c;this.loaded=false;this.image=null}function Pa(a,c){c=M({id:"layer_"+Kb++,zindex:0,animated:false,style:null,minXY:null,maxXY:null},c);this.visible=true;this.view=a;ja(M(this,c))}function Qa(){ja(this)}function ka(a,c){if(a&&a.split){var b=a.split(Xa);
if(b.length>1){a=b[0];c=b[1]}}else if(a&&a.lat){c=a.lon;a=a.lat}this.lat=parseFloat(a||0);this.lon=parseFloat(c||0)}function Ra(a,c){if(R(a,vb)){for(var b=c,f=new ka(wb,xb),i=new ka(Lb,Mb),e=a.length;e--;){var k=a[e];if(k.lat<f.lat)f.lat=k.lat;if(k.lat>i.lat)i.lat=k.lat;if(k.lon<f.lon)f.lon=k.lon;if(k.lon>i.lon)i.lon=k.lon}this.min=f;this.max=i;if(R(b,la)){b=this.size();b=Za(b.x,b.y)*0.3}this.expand(b)}else{this.min=a;this.max=c}}var $a={};(function(a){var c=[],b=0,f=false,i=a.register=function(e,
k){c.push({section:e,run:k})};a.init=function(e){function k(){if(b<c.length){var j=c[b++];d[j.section]||(d[j.section]={});j.run(d[j.section],k)}else{for(j in d)a[j]=d[j];f=true;e&&e(a)}}var d={};if(f&&e)e(a);else{b=0;k()}};i("canvas",function(e,k){function d(){var n,l=j.getContext("2d");l.save();try{l.translate(50,50);l.beginPath();l.rect(0,0,20,20);n=l.isPointInPath(10,10)}finally{l.restore()}return n}var j=document.createElement("canvas"),h=typeof FlashCanvas!="undefined",g=typeof G_vmlCanvasManager!=
"undefnined";j.width=200;j.height=200;e.pipTransformed=h||g?false:d();k()})})($a);window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},1E3/60)}}();var Eb=/\{(\d+)(?=\})/g,Ha=function(){var a=1.70158,c=Math.PI/2,b=Math.abs,f=Math.pow,i=Math.sin,e=Math.asin,k=Math.cos;return{linear:function(d,j,h,g){return h*
d/g+j},backin:function(d,j,h,g){return h*(d/=g)*d*((a+1)*d-a)+j},backout:function(d,j,h,g){return h*((d=d/g-1)*d*((a+1)*d+a)+1)+j},backinout:function(d,j,h,g){return(d/=g/2)<1?h/2*d*d*(((a*=1.525)+1)*d-a)+j:h/2*((d-=2)*d*(((a*=1.525)+1)*d+a)+2)+j},bouncein:function(d,j,h,g){return h-Ha.bounceout(g-d,0,h,g)+j},bounceout:function(d,j,h,g){return(d/=g)<1/2.75?h*7.5625*d*d+j:d<2/2.75?h*(7.5625*(d-=1.5/2.75)*d+0.75)+j:d<2.5/2.75?h*(7.5625*(d-=2.25/2.75)*d+0.9375)+j:h*(7.5625*(d-=2.625/2.75)*d+0.984375)+
j},bounceinout:function(d,j,h,g){return d<g/2?Ha.bouncein(d*2,0,h,g)/2+j:Ha.bounceout(d*2-g,0,h,g)/2+h/2+j},cubicin:function(d,j,h,g){return h*(d/=g)*d*d+j},cubicout:function(d,j,h,g){return h*((d=d/g-1)*d*d+1)+j},cubicinout:function(d,j,h,g){if((d/=g/2)<1)return h/2*d*d*d+j;return h/2*((d-=2)*d*d+2)+j},elasticin:function(d,j,h,g,n,l){if(d==0)return j;if((d/=g)==1)return j+h;l||(l=g*0.3);if(!n||n<b(h)){n=h;h=l/4}else h=l/aa*e(h/n);return-(n*f(2,10*(d-=1))*i((d*g-h)*aa/l))+j},elasticout:function(d,
j,h,g,n,l){var p;if(d==0)return j;if((d/=g)==1)return j+h;l||(l=g*0.3);if(!n||n<b(h)){n=h;p=l/4}else p=l/aa*e(h/n);return n*f(2,-10*d)*i((d*g-p)*aa/l)+h+j},elasticinout:function(d,j,h,g,n,l){var p;if(d==0)return j;if((d/=g/2)==2)return j+h;l||(l=g*0.3*1.5);if(!n||n<b(h)){n=h;p=l/4}else p=l/aa*e(h/n);if(d<1)return-0.5*n*f(2,10*(d-=1))*i((d*g-p)*aa/l)+j;return n*f(2,-10*(d-=1))*i((d*g-p)*aa/l)*0.5+h+j},quadin:function(d,j,h,g){return h*(d/=g)*d+j},quadout:function(d,j,h,g){return-h*(d/=g)*(d-2)+j},
quadinout:function(d,j,h,g){if((d/=g/2)<1)return h/2*d*d+j;return-h/2*(--d*(d-2)-1)+j},sinein:function(d,j,h,g){return-h*k(d/g*c)+h+j},sineout:function(d,j,h,g){return h*i(d/g*c)+j},sineinout:function(d,j,h,g){return-h/2*(k(Math.PI*d/g)-1)+j}}}();if(typeof animFrame==="undefined")throw Error("animFrame COG required for tweening support");var ja=function(){function a(b,f){var i=b.hasOwnProperty("obsHandlers")?b.obsHandlers:null;i[f]||(i[f]=[]);return i[f]}var c=0;return function(b){if(!b)return null;
if(!(b.hasOwnProperty("obsHandlers")?b.obsHandlers:null))b.obsHandlers={};if(!b.hasOwnProperty("bind")){b.bind=function(f,i){var e="callback"+c++;a(b,f).unshift({fn:i,id:e});return e};b.triggerCustom=function(f,i){var e=a(b,f),k={cancel:false,name:f,source:this},d;for(d in i)k[d]=i[d];if(!e)return null;d=Array.prototype.slice.call(arguments,2);b.eventInterceptor&&b.eventInterceptor(f,k,d);d.unshift(k);for(var j=e.length;j--&&!k.cancel;)e[j].fn.apply(this,d);return k};b.trigger=function(f){var i=Array.prototype.slice.call(arguments,
1);i.splice(0,0,f,null);return b.triggerCustom.apply(this,i)};b.unbind=function(f,i){if(typeof f==="undefined")b.obsHandlers={};else for(var e=a(b,f),k=0;e&&k<e.length;k++)if(e[k].id===i){e.splice(k,1);break}return b}}return b}}(),yb=function(){function a(c,b,f,i){if(typeof c[i]=="undefined")c[i]=function(e){if(typeof e!="undefined"){b[i]=e;f[i]&&f[i](e);return c}else return b[i]}}return function(c,b,f){for(var i in b)a(c,b,f,i)}}(),ab=Array.prototype.indexOf||function(a){for(var c=0;c<this.length;c++)if(this[c]===
a)return c;return-1},R=function(){return function(a,c){c=Nb.call(c);if(c=="finite")return!Ob[Pb](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||Qb.call(a).slice(8,-1).toLowerCase()==c}}(),Rb=function(){function a(i){var e=document.createElement("script"),k=false;e.src=i;e.async=true;e.onload=e.onreadystatechange=function(){if(!k&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){k=true;e.onload=e.onreadystatechange=
null;e&&e.parentNode&&e.parentNode.removeChild(e)}};b||(b=document.getElementsByTagName("head")[0]);b.appendChild(e)}var c=0,b,f=this;return function(i,e,k){i+=i.indexOf("?")>=0?"&":"?";var d="json"+ ++c;f[d]=function(j){e(j);f[d]=null;try{delete f[d]}catch(h){}};a(i+(k?k:"callback")+"="+d);return d}}();INTERACT=function(){function a(l){return function(p,r){l.addEventListener(p,r,false)}}function c(l){return function(p,r){l.removeEventListener(p,r,false)}}function b(l){return function(p,r){l.attachEvent("on"+
p,r)}}function f(l,p){return{x:l?l:0,y:p?p:0,count:1}}function i(l,p){g.push(M({handler:null,checks:{},type:l},p))}function e(l){var p=0,r=0;if(l.offsetParent){do{p+=l.offsetLeft;r+=l.offsetTop;l=l.offsetParent}while(l)}return{left:p,top:r}}function k(l,p){return{source:l,target:p.target?p.target:p.srcElement}}function d(l,p){for(var r=l.target?l.target:l.srcElement;r&&r!==p;)r=r.parentNode;return r&&r===p}function j(l,p){return{x:l.x-(p?p.left:0),y:l.y-(p?p.top:0)}}function h(l,p){if(l.preventDefault){l.preventDefault();
l.stopPropagation()}else if(typeof l.cancelBubble!="undefined")l.cancelBubble=true;p&&l.stopImmediatePropagation&&l.stopImmediatePropagation()}var g=[],n=function(l,p,r){r=M({binder:null,unbinder:null,observable:null},r);for(var m=r.observable,t=[],q,u,D={bind:function(){return m.bind.apply(null,arguments)},unbind:function(){m.unbind();for(B=0;B<t.length;B++)t[B].unbind();return D}},B=0;B<p.length;B++)t.push(p[B](l,m,r));m.bind("pointerDown",function(){u=q=0});m.bind("pointerMove",function(o,z,s,
w){q+=w.x||0;u+=w.y||0});m.bind("pointerUp",function(o,z,s){Math.abs(q)>20||Math.abs(u)>20||m.triggerCustom("tap",o,z,s)});return D};i("pointer",{handler:function(l,p,r){function m(y){if(y.pageX&&y.pageY)return f(y.pageX,y.pageY);else{var L=document.documentElement,P=document.body;return f(y.clientX+(L&&L.scrollLeft||P&&P.scrollLeft||0)-(L&&L.clientLeft||P&&P.clientLeft||0),y.clientY+(L&&L.scrollTop||P&&P.scrollTop||0)-(L&&L.clientTop||P&&P.clientTop||0))}}function t(y){if(d(y,l))if(w=B(y)){var L=
m(y);l.style.cursor="move";h(y,true);K=L.x;Q=L.y;E=f(K,Q);p.triggerCustom("pointerDown",k("mouse",y),E,j(E,e(l)))}}function q(y){var L=m(y);C=L.x;F=L.y;if(d(y,l))o(y,w?"pointerMove":"pointerHover")}function u(y){if(w&&B(y)){w=false;if(d(y,l)){l.style.cursor="default";o(y,"pointerUp")}}}function D(y){if(d(y,l)){var L;y=y||window.event;if(y.detail)L=y.axis===2?-y.detail*z:0;else{L=y.wheelDeltaY?y.wheelDeltaY:y.wheelDelta;if(window.opera)L=-L}if(L!==0){var P=f(C,F);p.triggerCustom("zoom",k("mouse",y),
P,j(P,e(l)),L/s,"wheel");h(y);y.returnValue=false}}}function B(y){y=y||window.event;return(y.which||y.button)==1}function o(y,L,P,S,W){P=typeof P!="undefined"?P:C;S=typeof S!="undefined"?S:F;var I=P-K,J=S-Q,H=f(P,S);p.triggerCustom(L,k("mouse",y),H,j(H,e(l)),f(I,J));if(typeof W=="undefined"||W){K=P;Q=S}}r=M({},r);var z=120,s=z*8,w=false,E,C,F,K,Q;r.binder("mousedown",t);r.binder("mousemove",q);r.binder("mouseup",u);r.binder("dblclick",function(y){ca("captured double click");if(d(y,l)){var L=m(y);
p.triggerCustom("doubleTap",k("mouse",y),L,j(L,e(l)))}});r.binder("mousewheel",D);r.binder("DOMMouseScroll",D);return{unbind:function(){r.unbinder("mousedown",t);r.unbinder("mousemove",q);r.unbinder("mouseup",u);r.unbinder("mousewheel",D);r.unbinder("DOMMouseScroll",D)}}},checks:{touch:false}});i("pointer",{handler:function(l,p,r){function m(I){if(I.count<2)return 0;var J=I.x-I.next.x;I=I.y-I.next.y;return~~Math.sqrt(J*J+I*I)}function t(I,J,H){J=J?J:0;H=H?H:0;for(var X={x:I.x-J,y:I.y-H,id:I.id,count:I.count},
Y=X;I.next;){I=I.next;Y=Y.next={x:I.x-J,y:I.y-H,id:I.id}}return X}function q(I,J){var H=I[J?J:"touches"],X,Y;if(H.length===0)return null;Y=X={x:H[0].pageX,y:H[0].pageY,id:H[0].identifier,count:H.length};for(var da=1,Sa=H.length;da<Sa;da++)Y=Y.next={x:H[da].pageX,y:H[da].pageY,id:H[da].identifier};return X}function u(I){if(d(I,l)){F=e(l);var J=q(I,"changedTouches"),H=t(J,F.left,F.top);if(!Q){K=w;p.triggerCustom("pointerDown",k("touch",I),J,H)}S&&p.triggerCustom("pointerDownMulti",k("touch",I),J,H);
Q=q(I);if(Q.count>1)L=m(Q);W=1;P=t(Q)}}function D(I){if(d(I,l)){h(I);y=q(I);if(K==w)K=Math.abs(Q.x-y.x)>z||Math.abs(Q.y-y.y)>z?s:w;if(K!=w){K=y.count>1?C:E;if(K==C)if(Q.count===1){Q=t(y);L=m(Q)}else{var J=m(y);if(Math.abs(L-J)<o)K=E;else{var H;H=y.x;var X=y.next.x,Y=y.y,da=y.next.y;H={x:(H<X?H:X)+(Math.abs(H-X)>>1),y:(Y<da?Y:da)+(Math.abs(Y-da)>>1)};J=J/L;X=J-W;p.triggerCustom("zoom",k("touch",I),H,j(H,F),X,"pinch");W=J}}K==E&&p.triggerCustom("pointerMove",k("touch",I),y,t(y,F.left,F.top),f(y.x-P.x,
y.y-P.y));S&&p.triggerCustom("pointerMoveMulti",k("touch",I),y,t(y,F.left,F.top))}P=t(y)}}function B(I){if(d(I,l)){var J=q(I,"changedTouches"),H=t(J,F.left,F.top);y=q(I);if(!y){p.triggerCustom("pointerUp",k("touch",I),J,H);Q=null}S&&p.triggerCustom("pointerUpMulti",k("touch",I),J,H)}}r=M({detailed:false,inertia:false},r);var o=20,z=7,s=0,w=1,E=2,C=3,F,K,Q,y,L,P,S=r.detailed,W=1;r.binder("touchstart",u);r.binder("touchmove",D);r.binder("touchend",B);ca("initialized touch handler");return{unbind:function(){r.unbinder("touchstart",
u);r.unbinder("touchmove",D);r.unbinder("touchend",B)}}},checks:{touch:true}});return{register:i,watch:function(l,p,r){p=M({bindTarget:null,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},p);capabilities=M({touch:"ontouchstart"in window},r);if(!p.observable){ca("creating observable");p.observable=ja({});globalOpts=p}p.binder=(p.isIE?b:a)(p.bindTarget||document);p.unbinder=(p.isIE?b:c)(p.bindTarget||document);r=p.types;for(var m=capabilities,t=[],q=g.length;q--;){var u=g[q],
D=!r||r.indexOf(u.type)>=0,B=true,o;for(o in u.checks){var z=u.checks[o];ca("checking "+o+" capability. require: "+z+", capability = "+m[o]);B=B&&z===m[o]}if(D&&B)t[t.length]=u.handler}return new n(l,t,p)}}}();var Ta=function(){var a={};return{create:function(c,b){if(a[c][b])return a[c][b].apply(null,Array.prototype.slice.call(arguments,2))},get:function(c,b){return a[c]?a[c][b]:null},register:function(c,b,f){a[c]||(a[c]={});a[c][b]&&ca(Sb(c,b),"warn");a[c][b]=f}}}(),Sb=qa("Registration of {0}: {1} will override existing definition"),
Tb=qa("Could not create drawable of type: {0}"),bb=[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],aa=Math.PI*2,Ia=Math.PI/2,Hb=3,ma=Math.PI/180,Da=180/Math.PI,wb=Ia,Lb=-wb,xb=aa,Mb=-xb,Na=0.08181919084262157,ga=Math.abs,zb=Math.ceil,Ja=Math.round,cb=Math.min,Za=Math.max,ya=Math.pow,Ab=Math.sqrt,Aa=Math.log,xa=Math.sin,Ub=Math.asin,db=Math.cos,ob=Math.atan,Vb=Math.atan2,Pb="hasOwnProperty",Ob={NaN:1,Infinity:1,"-Infinity":1},Nb=String.prototype.toLowerCase,
Qb=Object.prototype.toString,la="undefined",ra="string",ta="number",vb="array",Z=Ta.register,ua=Ta.create,Wb=Ta.get,Xb=0,Kb=0,Xa=/[\,\s]+/,eb=function(){function a(i){f++;i=i||(new Date).getTime();for(var e=b.length;e--;){var k=b[e];f%k.every===0&&k.cb(i)}animFrame(a)}var c=1E3/60,b=[],f=0;animFrame(a);return{attach:function(i,e){b[b.length]={cb:i,every:e?Ja(e/c):1}},detach:function(i){for(var e=b.length;e--;)if(b[e]===i){b.splice(e,1);break}}}}(),pb=function(){var a=/^xy\((.*)\).*$/i;return{parseXY:function(c,
b){b=b||new ia;if(!a.test(c)){var f=c.split(Xa);f=Ua(f[1],f[0]);b.mercX=f.x;b.mercY=f.y}return b}}}(),V=function(){function a(f){for(var i=0;i<f.length;i++){var e=f[i];if(typeof document.body.style[e]!="undefined")return e}}var c={"-webkit-user-select":"none",position:"absolute"},b;b=a(["-webkit-transform","MozTransform"]);css3DTransformProp=a(["WebkitPerspective","MozPerspective"]);return{transforms:R(b,ra),create:function(f,i,e){f=document.createElement(f);var k=[];e=e||{};f.className=i||"";for(var d in e)k[k.length]=
d+": "+e[d];f.style.cssText=k.join(";");return f},move:function(f,i,e,k){if(b)f.style[b]="translate("+i+"px, "+e+"px) "+(k||[]).join(" ");else{f.style.left=i+"px";f.style.top=e+"px"}},styles:function(f){return M({},c,f)}}}(),Bb=function(){function a(){for(var i=f.length,e=i;e--;)f[e](i)}var c=20,b=50,f=[];return{process:function(i,e,k){function d(g){g=(j||b)/g;if(h<i.length){var n=i.slice(h,h+g);g=n.length;var l=j?0:(new Date).getTime();e(n,g);if(!j){j=(n=((new Date).getTime()-l)/g)?c/n|0:i.length;
ca("calculated that we can process "+j+" items per cycle")}h+=g}else{for(g=f.length;g--;)if(f[g]===d){f.splice(g,1);break}f.length===0&&eb.detach(a);k&&k()}}var j,h=0;f.push(d)===1&&eb.attach(a)}}}(),Ua=Ua||function(a,c){var b=parseFloat(c)*ma;b=xa(b);var f=Na*b;b=Aa((1+b)/(1-b)*ya((1-f)/(1+f),Na))/2;return new ia(parseFloat(a)*ma,b)},fb=fb||function(a,c){for(var b=ya(Math.E,-c),f=Ia-2*ob(b),i=nb(f,b),e=0;e<12&&ga(f-i)>1.0E-7;){f=i;i=nb(f,b);e++}return new ka(i*Da,a%360*Da)};fa.prototype={constructor:fa,
add:function(){for(var a=this.x,c=this.y,b=arguments.length;b--;){a+=arguments[b].x;c+=arguments[b].y}return this.copy(a,c)},copy:function(a,c){var b=M({},this);b.x=a||b.x;b.y=c||b.y;return b},equals:function(a){return this.x===a.x&&this.y===a.y},offset:function(a,c){return this.copy(this.x+a,this.y+c)},sync:function(){return this},toString:function(){return this.x+", "+this.y}};ia.prototype=M(new fa,{constructor:ia,pos:function(){return fb(this.mercX,this.mercY)},sync:function(a,c){var b;if(!(b=
a.rpp)){b=a.zoom();b=aa/(256<<b)}b=b;if(c){this.mercX=this.x*b-Math.PI;this.mercY=Math.PI-this.y*b}else if(this.mercX||this.mercY){this.x=Ja((this.mercX+Math.PI)/b);this.y=Ja((Math.PI-this.mercY)/b)}return this}});sa.prototype={constructor:sa,buffer:function(a,c){return new sa(this.x-a,this.y-(c||a),this.w+a*2,this.h+(c||a)*2)},center:function(){return new fa(this.x+(this.w>>1),this.y+(this.h>>1))}};Z("fn","simplify",qb);Hits=function(){return{diffHits:function(a,c){var b=[],f={},i;for(i=c.length;i--;)f[c[i].target.id]=
true;for(i=a.length;i--;)f[a[i].target.id]||(b[b.length]=a[i]);return b},init:function(a,c,b,f){return{type:a,x:f.x|0,y:f.y|0,elements:[],absXY:c,relXY:b}},initHit:function(a,c,b){return{type:a,target:c,drag:b}},triggerEvent:function(a,c,b,f){c.triggerCustom(a.type+(b?b:"Hit"),{hitType:a.type},f?f:a.elements,a.absXY,a.relXY,new ia(a.x,a.y))}}}();var sb=function(a){function c(e,k){var d=b[e],j;d||(d=b[e]=[]);(j=d[k])||(j=d[k]=[]);return j}a=a||128;var b=[],f={},i=0;return{copyInto:function(e){for(var k in f){var d=
f[k];e.insert(d.bounds||d,d,k)}},insert:function(e,k,d){var j=e.x/a|0,h=e.y/a|0,g=(e.x+e.w)/a|0;e=(e.y+e.h)/a|0;d=d||k.id||"obj_"+i++;f[d]=k;for(k=j;k<=g;k++)for(j=h;j<=e;j++)c(k,j).push(d)},remove:function(e,k,d){d=d||k.id;if(f[d]){var j=e.x/a|0;k=e.y/a|0;var h=(e.x+e.w)/a|0;e=(e.y+e.h)/a|0;delete f[d];for(j=j;j<=h;j++)for(var g=k;g<=e;g++){var n=c(j,g),l=ab.call(n,d);l>=0&&n.splice(l,1)}}},search:function(e){var k=e.y/a|0,d=(e.x+e.w)/a|0,j=(e.y+e.h)/a|0,h=[],g=[];for(e=e.x/a|0;e<=d;e++)for(var n=
k;n<=j;n++)h=h.concat(c(e,n));h.sort();for(k=h.length;k--;){d=h[k];if(j=f[d])g[g.length]=j;for(;k>0&&h[k-1]==d;)k--}return g}}},Ib=3E4,ub={},Jb=0;(new Date).getTime();var za={},Ca=[];Ya.prototype={constructor:Ya,load:function(a){var c=this;Oa(this.url,function(b){c.loaded=true;c.image=b;a&&a()})}};var Yb=function(){return ja({fastpan:true,applyStyle:function(){},applyTransform:function(a,c,b){return{restore:null,x:c,y:b}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getViewport:function(){},
hitTest:function(){return false},prepare:function(){},projectXY:null,reset:function(){}})};Z("renderer","canvas",function(a,c,b,f,i){function e(o,z,s){var w,E;p[z]=function(C){for(w=D.length;w--;)if(E=s[D[w]])C[B[w]]=E}}function k(o,z,s){var w=false;if(z)w=g.isPointInPath(m?z.x-n:z.relXY.x,m?z.y-l:z.relXY.y);return{draw:s||u,viewport:o,hit:w,vpX:n,vpY:l,context:g}}f=M({},f);var d,j,h,g,n=0,l=0,p={},r=null,m=$a.canvas.pipTransformed,t={},q=function(){},u=function(){this.fill&&g.fill();this.stroke&&
g.stroke()},D=["fill","stroke","lineWidth","opacity"],B=["fillStyle","strokeStyle","lineWidth","globalAlpha"];if(c){d=c.offsetWidth;j=c.offsetHeight;h=V.create("canvas",null,{position:"absolute","z-index":1});h.width=d;h.height=j;a.attachFrame(h,true);g=null}b=M(i,{applyStyle:function(o){var z=p[o],s=g&&g.canvas?g.canvas.id:"default",w;t[s]||(t[s]=[]);w=t[s].pop()||"basic";if(z){t[s].push(o);z(g);return w}},applyTransform:function(o){if(o.translateX!==0||o.translateY!==0||o.scaling!==1||o.rotation!==
0){g.save();r={undo:function(){g.restore();r=null},x:o.xy.x,y:o.xy.y};g.translate(o.xy.x-n+o.translateX,o.xy.y-l+o.translateY);o.rotation!==0&&g.rotate(o.rotation);o.scaling!==1&&g.scale(o.scaling,o.scaling)}return r},drawTiles:function(o,z,s){for(var w=z.length;w--;){o=z[w];if(!o.loaded&&s)o.load(a.invalidate);else o.image&&g.drawImage(o.image,o.x-n,o.y-l)}},prepare:function(o,z){var s,w=false,E=z.scaled||z;if(g)g.restore();else g=h.getContext("2d");for(s=o.length;s--;)w=w||o[s].clip;n=E.x;l=E.y;
if(g){w||g.clearRect(0,0,d,j);g.save()}g.globalCompositeOperation="source-over";return g},prepArc:function(o,z,s){g.beginPath();g.arc(o.xy.x-(r?r.x:n),o.xy.y-(r?r.y:l),o.size>>1,o.startAngle,o.endAngle,false);return k(z,s)},prepImage:function(o,z,s,w){var E=(w.x||o.xy.x)-(r?r.x:n),C=(w.y||o.xy.y)-(r?r.y:l),F=w.image||o.image;if(F){g.beginPath();g.rect(E,C,w.width||F.width,w.height||F.height);return k(z,s,function(){g.drawImage(F,E,C,w.width||F.width,w.height||F.height)})}},prepMarker:function(o,z,
s){var w=o.xy.x-(r?r.x:n),E=o.xy.y-(r?r.y:l),C=o.size,F=undefined;g.beginPath();switch(o.markerStyle.toLowerCase()){case "image":F=q;g.rect(w-(C>>1),E-(C>>1),C,C);if(o.reset&&o.image){o.image=null;o.reset=false}o.image?g.drawImage(o.image,w-(C>>1),E-(C>>1),C,C):Oa(o.imageUrl,function(K){o.image=K;g.drawImage(o.image,w-(C>>1),E-(C>>1),C,C)});break;default:g.moveTo(w,E);g.lineTo(w-(C>>1),E-C);g.lineTo(w+(C>>1),E-C);g.lineTo(w,E)}return k(z,s,F)},prepPoly:function(o,z,s,w){var E=true;o=w.points||o.points;
w=r?r.x:n;var C=r?r.y:l;g.beginPath();for(var F=o.length;F--;){var K=o[F].x-w,Q=o[F].y-C;if(E){g.moveTo(K,Q);E=false}else g.lineTo(K,Q)}return k(z,s)},getContext:function(){return g}});(function(){for(var o in G.styles)e(null,o,G.styles[o]);Cb.bind("defined",e)})();b.bind("detach",function(){c.removeChild(h)});return b});Z("renderer","dom",function(a,c,b,f,i){function e(g){var n=g.image=new Image;j[g.id]=g;n.src=g.url;n.onload=function(){if(h[g.id])d.appendChild(this);else g.image=null};n.style.cssText=
"-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;";return n}function k(g,n,l){var p=[],r;for(r in g){var m=g[r];if(l?m[l]:!n[r]){if(m.image&&
m.image.parentNode){d.removeChild(m.image);m.image=null}p[p.length]=r}}for(n=p.length;n--;)delete g[p[n]]}var d=null,j={},h={};d=V.create("div","",V.styles({width:c.offsetWidth+"px",height:c.offsetHeight+"px"}));c.childNodes.length>0?c.insertBefore(d,c.childNodes[0]):c.appendChild(d);a.attachFrame(d);a=M(i,{drawTiles:function(g,n,l){for(var p,r=g.x,m=g.y,t=n.length;t--;){g=n[t];if(g.url){(p=g.image||(l?e(g):null))&&V.move(p,g.x-r,g.y-m);h[g.id]=g}}}});a.bind("predraw",function(){k(j,h);h={}});a.bind("detach",
function(){c.removeChild(d)});a.bind("reset",function(){for(k(j,h={});d.childNodes.length>0;)d.removeChild(d.childNodes[0])});return a});var Cb=function(){function a(f,i){if(R(f,ra)){b.trigger("defined",f,c[f]=i);return f}else{var e=[],k;for(k in f)e[e.length]=a(k,f[k]);return e}}var c={},b=ja({get:function(f){return c[f]},define:a});a({basic:{fill:"#ffffff"},highlight:{fill:"#ff0000"},waypoints:{lineWidth:4,stroke:"#003377",fill:"#ffffff"},waypointsHover:{lineWidth:4,stroke:"#ff0000",fill:"#ffffff"}});
return b}();Z("view","view",function(a){function c(v,x,A,N){D(Za(U+ya(2,N)-1,0.125),false,true)}function b(v,x){var A=renderer&&renderer.projectXY?renderer.projectXY(v,x):null;if(!A){A=O.getViewport();var N=1/U;A=new O.XY(A?A.x+v*N:v,A?A.y+x*N:x)}return A.sync(O,true)}function f(v,x,A){B("doubleTap",x,A,b(A.x,A.y));a.scalable&&D(2,{easing:"quad.out",duration:300},true)}function i(v,x,A){K=null;P=true;m("down",x,A)}function e(v,x,A){m("hover",x,A)}function k(v,x,A,N){l(x,A,false);if(!K){S=N.x;W=N.y}}
function d(v,x,A){l(x,A,true);P=false}function j(){clearTimeout(Db);Db=setTimeout(function(){renderer.checkSize()},250)}function h(v,x,A){m("tap",x,A);O.trigger("tap",x,A,b(A.x,A.y,true))}function g(v){var x=O,A=O,N=E,T=F,ha=a;v=(v||a.renderer).split("/");for(var na=new Yb(A,N,T,ha),Ea=0;Ea<v.length;Ea++)na=ua("renderer",v[Ea],A,N,T,ha,na);renderer=x.renderer=na;L=a.fastpan&&renderer.fastpan&&V.transforms;n()}function n(){ea&&ea.unbind();if(renderer){ea=INTERACT.watch(renderer.interactTarget||F);
if(a.scalable){ea.bind("zoom",c);ea.bind("doubleTap",f)}ea.bind("pointerDown",i);ea.bind("pointerMove",k);ea.bind("pointerUp",d);a.captureHover&&ea.bind("pointerHover",e);ea.bind("tap",h)}}function l(v,x,A){if(K){v=b(x.x,x.y);K.drag.call(K.target,K,v.x,v.y,A)&&$++;if(A)K=null}}function p(v){for(var x=w;x--;)if(s[x].id===v)return x;return w}function r(v){F=document.getElementById(v);F.appendChild(C=V.create("div","",V.styles({overflow:"hidden",width:F.offsetWidth+"px",height:F.offsetHeight+"px"})));
gb=C.offsetWidth+oa*2;hb=C.offsetHeight+oa*2;ib=F.offsetWidth/2;jb=F.offsetHeight/2;C.appendChild(E=V.create("div","",V.styles({width:gb+"px",height:hb+"px","z-index":2,margin:-oa+"px 0 0 "+-oa+"px"})));g()}function m(v,x,A){ba=Hits.init(v,x,A,b(A.x,A.y,true));for(v=w;v--;)y=y||(s[v].hitGuess?s[v].hitGuess(ba.x,ba.y,O):false);y&&$++}function t(){var v=new sa(J,H,gb,hb);v.scaleFactor=U;return v}function q(v,x,A){if(R(v,ra)&&R(x,la))for(x=0;x<w;x++){if(s[x].id===v)return s[x]}else if(R(v,ra)){x=ua("layer",
x,O,A);x.added=(new Date).getTime();x.id=v;s[p(v)]=x;s.sort(function(N,T){return T.zindex-N.zindex||T.added-N.added});w=s.length;O.trigger("resync");u();O.trigger("layerChange",O,x);$++;return x}else return[].concat(s)}function u(){var v=t();if(v){if(Fa||Ga)if(v){var x=Va?J+(v.w>>1):J,A=Wa?H+(v.h>>1):H,N=v.w,T=v.h;if(Fa&&Fa>N)if(x+N>Fa)J=Va?J:Fa-N;else if(x<0)J=Va?J:0;if(Ga&&Ga>T)if(A+T>Ga)H=Wa?H:Ga-T;else if(A<0)H=Wa?H:0}da=J;Sa=H;O.trigger("refresh",O,v);$++}}function D(v,x,A){if(R(v,ta)){var N=
A?v:U*v;if(!Zb){x=null;v=Ja(Aa(N)/Math.LN2);N=ya(2,v)}if(x)Ka=pa.tween([U],[N],x,function(){U=N;Ka=null;$++});else{U=N;$++}return O}else return U}function B(){for(var v=O.trigger.apply(null,arguments).cancel,x=s.length;x--;)v=s[x].trigger.apply(null,arguments).cancel||v;return!v}function o(v,x,A){if(R(v,ta)){if(A)va=pa.tween([J,H],[v,x],A,function(){va=null});else{J=v|0;H=x|0}return O}else return(new O.XY(J,H)).sync(O,true)}a=M({container:"",captureHover:true,controls:[],drawOnScale:true,fastpan:true,
padding:0,inertia:true,refreshDistance:256,pannable:true,scalable:true,renderer:"canvas"},a);var z=[],s=[],w=0,E=null,C=null,F,K=null,Q=!R(window.attachEvent,la),y=false,L,P=false,S=0,W=0,I=a.refreshDistance,J=0,H=0,X=0,Y=0,da=0,Sa=0,Fa=null,Ga=null,Va=false,Wa=false,va=null,oa=a.padding,ba=null,La=null,Db=0,wa=0,Ma=null,U=1,Ka=null,kb=1,ea=null,lb={index:0,draw:false},Zb=true,$=0,gb,hb,ib,jb,O={XY:fa,id:a.id,padding:oa,panSpeed:0,attachFrame:function(v,x){x&&E.appendChild(v)},center:function(v,x,
A){if(R(v,ra)){x=pb.parseXY(v).sync(O);v=x.x;x=x.y}if(R(v,ta)){o(v-ib-oa,x-jb-oa,A);return O}else return o().offset(ib+oa|0,jb+oa|0).sync(O,true)},detach:function(){renderer&&renderer.trigger("detach");ea&&ea.unbind();if(C){F.removeChild(C);E=C=null}},layer:q,invalidate:function(){$++},pan:function(v,x,A){o(J+v,H+x,A)},refresh:u,rotate:function(v,x,A){if(R(v,ta)){var N=A?v:wa+v;if(x)Ma=pa.tween([wa],[N],x,function(){wa=N%360;Ma=null;$++});else{wa=N%360;$++}return O}else return wa},scale:D,triggerAll:B,
setMaxOffset:function(v,x,A,N){Fa=v;Ga=x;Va=A;Wa=N},getViewport:t,offset:o};ja(O);O.bind("resize",function(){renderer.checkSize()});O.bind("layerRemove",function(v,x){var A=ab(s,x.id);if(A>=0&&A<w){s.splice(A,1);$++}w=s.length});yb(O,a,{container:r,captureHover:n,scalable:n,pannable:n,renderer:function(v){if(renderer){renderer.trigger("detach");renderer=null}g(v);$++}});$a.init(function(){q("markers","draw",{zindex:20});r(a.container);Q?window.attachEvent("onresize",j):window.addEventListener("resize",
j,false)});eb.attach(function(v){var x=[],A,N,T;self.panSpeed=panSpeed=ga(S)+ga(W);A=U!==kb;if(panSpeed>0||A||va||Ka||Ma){$++;if(va&&panSpeed>0){va(true);va=null}}if(panSpeed<2&&(ga(J-da)>=I||ga(H-Sa)>=I))u();lb.index++;lb.draw=$||panSpeed||0;if(renderer&&lb.draw){if(Ka)U=Ka()[0];if(Ma)wa=Ma()[0];X+=S;Y+=W;if(S||W)O.trigger("pan");if(V.transforms){if(U!==1)x[x.length]="scale("+U+")";if(wa!==0)x[x.length]="rotate("+wa+"deg)"}if(A=!L||(a.drawOnScale||U===1)&&panSpeed<5){if(va){A=va();J=A[0]|0;H=A[1]|
0}else{J=J-X/U|0;H=H-Y/U|0}T=t();renderer.trigger("predraw",T);if(renderer.prepare(s,T,v,ba)){N=Y=A=X=$=0;for(ii=w;ii--;){var ha=s[ii];if(ha.visible){var na=ha.style?renderer.applyStyle(ha.style,true):null;ha.draw(renderer,T,O,v,ba);na&&renderer.applyStyle(na)}}renderer.trigger("render",T);O.trigger("drawComplete",T,v);V.move(E,A,N,x)}}else V.move(E,X,Y,x);if(P||!a.inertia)W=S=0;else if(S!=0||W!=0){S*=0.8;W*=0.8;if(ga(S)<0.5)S=0;if(ga(W)<0.5)W=0}if(ba){v=ba?ba.elements:[];if(La&&La.type==="hover"){x=
Hits.diffHits(La.elements,v);x.length>0&&Hits.triggerEvent(La,O,"Out",x)}if(v.length>0){A=ba.x;N=ba.y;for(x=v.length;x--;){T=v[x];ha=A;na=N;var Ea=T&&T.drag&&(!T.canDrag||T.canDrag(T,ha,na));if(Ea){K=T;K.startX=ha;K.startY=na}if(Ea)break}Hits.triggerEvent(ba,O)}La=v.length>0?M({},ba):null;ba=null}if(kb!==U){O.trigger("scaleChanged",U);kb=U}}});(function(v){z=[];for(var x=0;x<v.length;x++)z[z.length]=ua("control",v[x],O,C,F,a[v[x]])})(a.controls);return O});Z("view","map",function(a){function c(j){var h=
d.getViewport();return j?b(j.bestZoomLevel(h)).center(j.center()):new Ra((new ia(h.x,h.y2)).sync(d,true).pos(),(new ia(h.x2,h.y)).sync(d,true).pos())}function b(j,h,g){if(R(j,ta)){j=Za(a.minZoom,cb(a.maxZoom,j|0));if(j!==e){var n=d.getViewport(),l=d.offset(),p=n.w/2;n=n.h/2;var r=ya(2,j-e),m=p/r|0,t=n/r|0;e=j;d.offset(((h||l.x+p)-m)*r,((g||l.y+n)-t)*r);refreshY=refreshX=0;d.trigger("zoom",j);i=d.rpp=aa/(256<<e);d.setMaxOffset(aa/i|0,aa/i|0,true,false);d.scale(1,false,true);d.trigger("resync");d.renderer.trigger("reset");
d.refresh()}return d}else return e}a=M({container:"",captureHover:true,controls:["zoombar"],drawOnScale:true,padding:50,inertia:true,refreshDistance:256,pannable:true,scalable:true,minZoom:1,maxZoom:18,renderer:"canvas/dom",zoom:1,zoombar:{}},a);var f=new ia,i,e=a.zoom||a.zoomLevel,k=0,d=M(ua("view","view",a),{XY:ia,bounds:c,zoom:b});d.bind("refresh",function(){var j=d.getViewport();if(f.x!=j.x||f.y!=j.y){d.trigger("boundsChange",c());f.x=j.x;f.y=j.y}});d.bind("scaleChanged",function(j,h){var g=Aa(h)/
Math.LN2|0;if(g!==0){h=ya(2,g);clearTimeout(k);k=setTimeout(function(){b(e+g)},500)}});return d});var pa=function(){return{tween:function(a,c,b,f,i){function e(n){Gb(a[n],c[n],Fb(b.easing),b.duration,function(l,p){d[n]=l;if(p){j++;if(h&&j>=k){var r=f?f():true;if(b.callback&&(R(r,la)||r))b.callback()}}i&&i.invalidate();return h})}b=M({easing:"sine.out",duration:1E3,callback:f},b);var k=a.length,d=[].concat(a),j=0,h=true,g;for(g=k;g--;)e(g);return function(n){h=!n;return d}},tweenDrawable:function(a,
c,b,f,i){var e=pa.tween([b],[f],i,function(){a[c]=f;for(var d=a.tweens.length;d--;)if(a.tweens[d]===k){a.tweens.splice(d,1);break}},a.view),k=function(){a[c]=e()[0]};return k}}}(),Ba=function(a,c,b){b=M({style:null,xy:null,size:20,fill:false,stroke:true,draggable:false,observable:true,properties:{},typeName:"Shape"},b);M(this,b);if(R(this.xy,ra))this.xy=new a.XY(this.xy);this.id="drawable_"+Xb++;this.bounds=null;this.view=a;this.layer=c;this.tweens=[];this.rotation=this.animations=0;this.scaling=
1;this.translateY=this.translateX=0;this.observable&&ja(this)};Ba.prototype={constructor:Ba,applyTweens:function(){for(var a=this.tweens.length;a--;)this.tweens[a]()},drag:null,draw:null,getProps:null,resync:function(){if(this.xy){this.xy.sync(this.view);if(this.size){var a=this.size>>1;this.updateBounds(new sa(this.xy.x-a,this.xy.y-a,this.size,this.size))}}},rotate:function(a,c,b){if(R(a,ta)){a=(b?a:this.rotation*Da+a)*ma;if(c)this.tweens.push(pa.tweenDrawable(this,"rotation",this.rotation,a,c));
else{this.rotation=a;this.view.invalidate()}return this}else return this.rotation*Da},scale:function(a,c,b){if(R(a,ta)){a=b?a:this.scaling*a;if(c)this.tweens.push(pa.tweenDrawable(this,"scaling",this.scaling,a,c));else{this.scaling=a;this.view.invalidate()}return this}else return this.scaling},translate:function(a,c,b,f){if(R(a,ta)){a=f?a:this.translateX+a;c=f?c:this.translateY+c;if(b){this.tweens.push(pa.tweenDrawable(this,"translateX",this.translateX,a,b));this.tweens.push(pa.tweenDrawable(this,
"translateY",this.translateY,c,b))}else{this.translateX=a;this.translateY=c;this.view.invalidate()}return this}else return new fa(this.translateX,this.translateY)},updateBounds:function(a,c){a&&(!this.bounds||a.x!=this.bounds.x||a.y!=this.bounds.y)&&this.trigger("move",this,a,this.bounds);this.bounds=a;if(c)this.xy=this.bounds.center()}};Z("drawable","marker",function(a,c,b){b=M({fill:true,stroke:false,markerStyle:"simple",hoverStyle:"highlight",typeName:"Marker"},b);return new Ba(a,c,b)});Z("drawable",
"poly",function(a,c,b){function f(){var j,h,g,n,l,p,r,m;m=d.points=b.simplify?qb(k):k;for(j=m.length;j--;){h=m[j].x;g=m[j].y;p=R(p,la)||h<p?h:p;r=R(r,la)||g<r?g:r;n=R(n,la)||h>n?h:n;l=R(l,la)||g>l?g:l}d.updateBounds(new sa(p,r,n-p,l-r),true)}function i(j){R(j,vb)&&Bb.process(j,function(h,g){for(var n=0;n<g;n++)k[n]=new a.XY(h[n])},e)}function e(){k.length&&Bb.process(k,function(j,h){for(var g=h;g--;)j[g].sync(a)},f)}b=M({simplify:false,fill:true,points:[],typeName:"Poly"},b);var k=[],d=M(new Ba(a,
c,b),{points:[],getPoints:function(){return[].concat(k)},resync:e});yb(d,b,{points:i});i(b.points);return d});Z("drawable","line",function(a,c,b){b.fill=false;return ua("drawable","poly",a,c,b)});Z("drawable","image",function(a,c,b){function f(){if(j&&j.width>0){if(!this.centerOffset)this.centerOffset=new fa(-j.width>>1,-j.height>>1);this.updateBounds(new sa(this.xy.x+this.centerOffset.x,this.xy.y+this.centerOffset.y,j.width,j.height),false)}}function i(g){if(this.imageUrl=g){var n=this;Oa(this.imageUrl,
function(l,p){j=l;if(p){var r=h.layer?h.layer.view:null;r&&r.invalidate()}f.apply(n)})}}b=M({image:null,imageUrl:null,centerOffset:null,typeName:"Image"},b);var e=Ba.prototype.resync,k=0,d=0,j=b.image,h=M(new Ba(a,c,b),{changeImage:i,getProps:function(){this.bounds||f(this,j);return{image:j,x:this.xy.x+k,y:this.xy.y+d}},resync:function(g){e.call(this,g);f.call(this)}});j||i.call(this,this.imageUrl);if(this.centerOffset){k=this.centerOffset.x;d=this.centerOffset.y}});Z("drawable","arc",function(a,
c,b){b=M({startAngle:0,endAngle:Math.PI*2,typeName:"Arc"},b);return new Ba(a,c,b)});Pa.prototype={constructor:Pa,clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){this.view.trigger("layerRemove",this)}};Z("layer","tile",function(a,c){c=M({generator:"osm",imageLoadArgs:{}},c);var b=ua("generator",c.generator,c).run,f=null,i=[],e=M(new Pa(a,c),{draw:function(k,d,j){k.drawTiles&&k.drawTiles(d,f.search(d.buffer(128)),j.panSpeed<2)}});a.bind("resync",function(){var k=a&&a.zoom?
a.zoom():0;i[k]||(i[k]=rb(k));f=i[k]});a.bind("refresh",function(k,d,j){f&&b(d,j,f,function(){d.invalidate()})});return e});Z("layer","draw",function(a,c){function b(h,g,n,l){var p=this.dragOffset;if(!p)p=this.dragOffset=new a.XY(h.startX-this.xy.x,h.startY-this.xy.y);this.xy.x=g-p.x;this.xy.y=n-p.y;if(l){delete this.dragOffset;a.invalidate();this.trigger("dragDrop")}return true}function f(h){clearTimeout(d);d=setTimeout(function(){e.sort(function(g,n){if(n.xy&&g.xy){var l=n.xy.y-g.xy.y;return l!=
0?l:n.xy.x-g.xy.x}});h&&h.invalidate()},50)}function i(h,g,n,l){l&&k.remove(l,g);k.insert(n,g)}c=M({zindex:10},c);var e=[],k,d=0,j=M(new Pa(a,c),{itemCount:0,clear:function(){k=new sb;e=[];j.trigger("cleared");j.itemCount=0},create:function(h,g,n){g=ua("drawable",h,a,j,g);if(!g)throw Tb(h);if(n)e.unshift(g);else e[e.length]=g;g.resync();k&&g.bounds&&k.insert(g.bounds,g);f(a);g.bind("move",i);j.itemCount=e.length;j.trigger(h+"Added",g);return g},draw:function(h,g,n,l,p){n={};l=k&&g?k.search(g):[];
for(var r=l.length;r--;){var m=l[r],t=m.style||j.style,q,u,D=m.getProps?m.getProps(h):n;q=h["prep"+m.typeName];m.tweens.length>0&&m.applyTweens();u=h.applyTransform(m);if(D=q?q.call(h,m,g,p,D):null){if(p&&D.hit){p.elements.push(Hits.initHit(m.type,m,m.draggable?b:null));q=p.type+"Style";t=m[q]||j[q]||t}t=t?h.applyStyle(t,true):null;(q=m.draw||D.draw)&&q.call(m,D);t&&h.applyStyle(t)}u&&u.undo&&u.undo()}},find:function(){return[].concat(e)},hitGuess:function(h,g){return k&&k.search({x:h-10,y:g-10,w:20,
h:20}).length>0}});a.bind("resync",function(){k=rb(a.zoom(),k);for(var h=e.length;h--;)e[h].resync()});return j});Qa.prototype={constructor:Qa};Z("control","zoombar",function(a,c,b,f){function i(s,w){var E=D[s]=V.create("div","t5-zoombar-button",{position:"absolute",background:e(s),"z-index":51,width:f.width+"px",height:f.buttonHeight+"px","margin-top":(w||0)+"px"});B.appendChild(E)}function e(s,w){return"url("+f.images+") 0 -"+(n+p*3+(s||0)*h*3+(w||0)*h)+"px"}function k(s){return"url("+f.images+
") 0 -"+(n+(s||0)*p)+"px"}function d(s,w){var E;if(s===l){l.style.background=k(w);E="thumb"}else for(var C=0;C<D.length;C++)if(s===D[C]){E="button"+C;D[C].style.background=e(C,w);break}return E}function j(s){if(s!==q){q=s;t=m-q/u*(m-r)|0;V.move(l,0,t-r);clearTimeout(o);o=setTimeout(function(){a.zoom(q)},500)}}f=M({width:24,height:200,images:"img/zoom.png",align:"right",marginTop:10,spacing:10,thumbHeight:16,buttonHeight:16},f);var h=f.buttonHeight,g,n=f.height,l,p=f.thumbHeight,r=f.spacing+h-(p>>
1),m=f.height-h-(p>>1),t=r,q=-1;c=a.minZoom();var u=a.maxZoom()-c+1,D=[],B,o=0,z={button0:function(){a.zoom(a.zoom()+1)},button1:function(){a.zoom(a.zoom()-1)}};B=V.create("div","t5-zoombar",{position:"absolute",background:"url("+f.images+")","z-index":50,overflow:"hidden",width:f.width+"px",height:f.height+"px",margin:function(){var s=f.spacing,w=qa("{0}px 0 0 {1}px");if(f.align==="right")s=b.offsetWidth-f.width-f.spacing;return w(f.marginTop,s)}()});b.childNodes[0]?b.insertBefore(B,b.childNodes[0]):
b.appendChild(B);B.appendChild(l=V.create("div","t5-zoombar-thumb",{position:"absolute",background:k(),"z-index":51,width:f.width+"px",height:f.thumbHeight+"px",margin:"10px 0 0 0",top:t-r+"px"}));i(0);i(1,f.height-f.buttonHeight);g=INTERACT.watch(B,{bindTarget:B});g.bind("pointerMove",function(s,w,E){t=Math.min(Math.max(r,E.y-(p>>1)),m);j(u-(t-r)/m*u|0)});g.bind("pointerDown",function(s){d(s.target,2)});g.bind("pointerUp",function(s){d(s.target,0)});g.bind("tap",function(s){(s=z[d(s.target,2)])&&
s()});c=new Qa(a);c.bind("detach",function(){g.unbind();b.removeChild(B)});a.bind("zoom",function(s,w){j(w)});j(a.zoom());return c});ka.prototype={constructor:ka,distanceTo:function(){if(!targetPos||this.empty()||targetPos.empty())return 0;var a=(targetPos.lat-this.lat)*ma>>1,c=(targetPos.lon-this.lon)*ma>>1;a=xa(a)*xa(a)+db(this.lat*ma)*db(targetPos.lat*ma)*xa(c)*xa(c);return 6371*2*Vb(Ab(a),Ab(1-a))},equalTo:function(a){return pos&&this.lat===a.lat&&this.lon===a.lon},empty:function(){return this.lat===
0&&this.lon===0},inArray:function(a){for(var c=a.length;c--;)if(this.equal(a[c]))return true;return false},offset:function(a,c){var b=this.lat*ma,f=this.lon*ma,i=b+a/6371;b=Ub(xa(c/6371)/db(b));f=f+b;i=(i+Ia)%Math.PI-Ia;f%=aa;return new ka(i*Da,f*Da)},toPixels:function(){return Ua(this.lon,this.lat)},toString:function(a){return this.lat+(a||" ")+this.lon}};(function(){Z("fn","generalize",function(a,c,b){var f=a.length,i=[],e=null;b=(b||250)/1E3;for(f=f;f--;)if(f===0)i.unshift(a[f]);else{var k=!e||
a[f].inArray(c)?b:e.distanceTo(a[f]);if(a[f]&&k>=b){i.unshift(a[f]);e=a[f]}}return i})})();Ra.prototype={constructor:Ra,bestZoomLevel:function(a){var c=this.center();c=cb(Ja(ga(c.lat)*0.05),bb.length);var b=bb[c],f=this.size();c=zb(Aa(bb[3]*a.h/f.y)/Aa(2));a=zb(Aa(b*a.w/f.x)/Aa(2));return cb(isNaN(c)?1E3:c,isNaN(a)?1E3:a)},center:function(){var a=this.size();return new ka(this.min.lat+(a.y>>1),this.min.lon+(a.x>>1))},expand:function(a){this.min.lat-=a;this.max.lat+=a;this.min.lon-=a%360;this.max.lon+=
a%360},size:function(a){var c=new fa(0,this.max.lat-this.min.lat);c.x=(a||R(a,la))&&this.min.lon>this.max.lon?360-this.min.lon+this.max.lon:this.max.lon-this.min.lon;return c},toString:function(){return"min: "+this.min+", max: "+this.max}};var G={ex:M,log:ca,observable:ja,formatter:qa,wordExists:function(a,c){for(var b=a.split(/\s|\,/).length;b--;)if(a.toLowerCase()==c.toLowerCase())return true;return false},is:R,indexOf:ab,fn:function(a){return Wb("fn",a)},project:Ua,unproject:fb,userMessage:function(a,
c,b){G.trigger("userMessage",a,c,b)},Registry:Ta,Style:Cb,DOM:V,Rect:sa,XY:fa,Hits:Hits,Control:Qa,Tile:Ya,Tweener:pa,getImage:Oa,Pos:ka,BBox:Ra};ja(G);G.RouteTools=function(){function a(h){if(e.test(h))return"-slight";return""}function c(h,g){g.geometry&&h.layer("route","draw").create("line",{points:g.geometry,style:"waypoints",simplify:true})}function b(h){for(var g="unknown",n=f||d,l=0;l<n.length;l++){n[l].regex.lastIndex=-1;var p=n[l].regex.exec(h);if(p){g=n[l].customCheck?n[l].customCheck(h,
p):n[l].turnType;break}}return g}var f=undefined,i=G.fn("generalize"),e=/bear/i,k=/right/i,d=function(){var h=[];h.push({regex:/continue/i,turnType:"continue"});h.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(g,n){return"turn-left"+a(n[1])}});h.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(g,n){return"turn-right"+a(n[1])}});h.push({regex:/enter\s(roundabout|rotary)/i,turnType:"roundabout"});h.push({regex:/take.*?ramp/i,turnType:"ramp"});h.push({regex:/take.*?exit/i,
turnType:"ramp-exit"});h.push({regex:/make(.*?)u\-turn/i,customCheck:function(g,n){return"uturn"+(k.test(n[1])?"-right":"-left")}});h.push({regex:/proceed/i,turnType:"start"});h.push({regex:/arrive/i,turnType:"arrive"});h.push({regex:/fell\sthrough/i,turnType:"merge"});return h}(),j={calculate:function(h){h=M({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},h);var g=G.Registry.create("service","routing");g&&g.calculate(h,function(n){if(h.generalize)n.geometry=
i(n.geometry,n.getInstructionPositions());if(h.map){c(h.map,n);h.autoFit&&h.map.bounds(n.boundingBox)}h.success&&h.success(n)})},createMapOverlay:c,parseTurnType:b,Instruction:function(h){var g=h=M({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},h),n=h.description;n=n.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");g.description=n;if(!h.turnType)h.turnType=b(h.description);return h},RouteData:function(h){h=M({geometry:[],instructions:[],boundingBox:null},h);if(!h.boundingBox)h.boundingBox=
new G.BBox(h.geometry);return M({getInstructionPositions:function(){for(var g=[],n=0;n<h.instructions.length;n++)h.instructions[n].position&&g.push(h.instructions[n].position);return g}},h)}};G.observable(j);return j}();COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var a=arguments[0]||{},c,b=1,f=arguments.length;b<f;b++)if((c=arguments[b])!==null)for(var i in c){var e=c[i];if(a!==e)if(e!==undefined)a[i]=e}return a};(function(){var a=/^P(\d+Y)?(\d+M)?(\d+D)?$/,c=/^(\d+H)?(\d+M)?(\d+S)?$/,
b={8601:function(i){i=i.split("T");var e=null;e=null;var k=0,d=0;a.lastIndex=-1;e=a.exec(i[0]);k+=e[3]?parseInt(e[3].slice(0,-1),10):0;c.lastIndex=-1;e=c.exec(i[1]);d+=e[1]?parseInt(e[1].slice(0,-1),10)*3600:0;d+=e[2]?parseInt(e[2].slice(0,-1),10)*60:0;d+=e[3]?parseInt(e[3].slice(0,-1),10):0;return new f(k,d)}},f=COG.Duration=function(i,e){return{days:i?i:0,seconds:e?e:0}};COG.addDuration=function(){for(var i=new f,e=arguments.length;e--;){i.days+=arguments[e].days;i.seconds+=arguments[e].seconds}if(i.seconds>=
86400){i.days+=~~(i.seconds/86400);i.seconds%=86400}return i};COG.formatDuration=function(i){var e,k,d="";if(i.days)d=i.days+" days ";if(i.seconds){i=i.seconds;if(i>=3600){e=~~(i/3600);i-=e*3600}if(i>=60){k=Math.round(i/60);i-=k*60}if(e)d=d+e+(e>1?" hrs ":" hr ")+(k?(k>10?k:"0"+k)+" min ":"");else if(k)d=d+k+" min";else if(i>0)d=d+(i>10?i:"0"+i)+" sec"}return d};COG.parseDuration=function(i,e){var k=e?b[e]:null;if(k)return k(i);COG.Log.warn("Could not find duration parser for specified format: "+
e);return new f}})();G.Decarta=function(){function a(m){return j(e.clientName,e.clientPassword,e.sessionID,e.configuration,e.release,m)}function c(m,t){return h(m.maxResponses,m.version,m.requestID,m.methodName,t)}function b(m,t){e.server||ca("No server configured for deCarta - we are going to have issues","warn");return g(e.server,m.requestID,escape(t))}function f(m,t){Rb(b(m,a(c(m,m.getRequestBody()))),function(q){var u=q.response.XLS.Response;if(u.numberOfResponses>0&&u[m.methodName+"Response"]){q=
null;if(m.parseResponse)q=m.parseResponse(u[m.methodName+"Response"]);t&&t(q)}else ca("no responses from server: "+q.response,"error")})}function i(m,t){var q=new l({json:m.StreetAddress}),u=new n({countryCode:m.countryCode});u.parse(m.Place);return new G.Geo.Address({streetDetails:q,location:u,country:m.countryCode?m.countryCode:"",postalCode:m.PostalCode?m.PostalCode:"",pos:t})}var e={sessionID:(new Date).getTime(),server:"",clientName:"",clientPassword:"",configuration:"",maxResponses:25,release:"4.4.2sp03",
tileFormat:"PNG",fixedGrid:true,useCache:true,tileHosts:[],requestTimeout:3E4,geocoding:{countryCode:"US",language:"EN"}},k={DEFAULT:function(m){for(var t=["landmark","municipalitySubdivision","municipality","countrySubdivision"],q="",u=0;u<t.length;u++)if(m[t[u]])q+=m[t[u]]+" ";return q}},d=1,j=qa("<xls:XLS version='1' xls:lang='en' xmlns:xls='http://www.opengis.net/xls' rel='{4}' xmlns:gml='http://www.opengis.net/gml'><xls:RequestHeader clientName='{0}' clientPassword='{1}' sessionID='{2}' configuration='{3}' />{5}</xls:XLS>"),
h=qa("<xls:Request maximumResponses='{0}' version='{1}' requestID='{2}' methodName='{3}Request'>{4}</xls:Request>"),g=qa("{0}/JSON?reqID={1}&chunkNo=1&numChunks=1&data={2}&responseFormat=JSON"),n=function(m){m=G.ex({landmark:"",municipality:"",municipalitySubdivision:"",countrySubdivision:"",countryCode:""},m);var t=G.ex({calcMatchPercentage:function(q){var u=0;if(m.landmark&&m.landmarkSubType){if(G.wordExists(q,m.landmarkSubType)){u+=0.4;u+=G.wordExists(q,m.landmark)?0.6:0}}else{u+=G.wordExists(q,
m.municipalitySubdivision)?0.8:0;if(u===0&&m.municipality)u+=G.wordExists(q,m.municipality)?0.7:0}if(m.countrySubdivision)u+=G.wordExists(q,m.countrySubdivision)?0.2:0;return u},getCountryCode:function(){if(m.countryCode)return m.countryCode.toUpperCase();return""},parse:function(q){for(var u=0;q&&u<q.length;u++){var D=q[u].type?q[u].type.slice(0,1).toLowerCase()+q[u].type.slice(1):"";if(typeof m[D]!=="undefined"){m[D]=q[u].content;if(q[u].subType)m[D+"SubType"]=q[u].subType}}G.ex(t,m)},toString:function(){var q=
k[t.getCountryCode()];if(!q)q=k.DEFAULT;return q(m)}},m);return t},l=function(m){m=G.ex({json:{}},m);var t="",q="";if(m.json.Street)t=m.json.Street.content?m.json.Street.content:m.json.Street;t=t&&t.replace?t.replace(/\/\d+$/,""):"";if(m.json.Building)if(m.json.Building.number)q=m.json.Building.number;return{building:q,street:t,calcMatchPercentage:function(u){var D=0,B=G.Geo.A.normalize(u),o=G.Geo.A.normalize(t);if(m.json.Building)if(G.Geo.A.buildingMatch(u,m.json.Building.number.toString()))D+=0.2;
if(B&&o&&G.wordExists(B,o))D+=0.8;return D},toString:function(){if(t)return(q?q+" ":"")+t;return""}}},p=function(){return{methodName:"",maxResponses:25,version:"1.0",requestID:d++,getRequestBody:function(){return""},parseResponse:function(m){return m}}},r=function(){return G.ex(new p,{methodName:"RUOK",parseResponse:function(m){return{aliasCount:m.maxHostAliases,host:m.hostName}}})};G.Registry.register("generator","decarta",function(m){function t(D,B,o,z){if(D=D.zoom?D.zoom():0){var s=2<<D-1,w=s>>
1,E=m.tileSize,C=(B.w/E|0)+1,F=(B.h/E|0)+1,K=(B.x/E|0)-w;B=s-(B.y/E|0)-w-F;var Q=o.search({x:(w+K)*E,y:(w+B*-1-F)*E,w:C*E,h:F*E});s={};var y;for(y=Q.length;y--;)s[Q[y].id]=true;for(Q=0;Q<=C;Q++)for(y=0;y<=F;y++){var L=K+Q,P=B+y-1,S=L+"_"+P;if(!s[S]){L=new G.Tile((w+K+Q)*E,(w+B*-1-y)*E,u[Q%u.length]+"/openls/image-cache/TILE?LLMIN=0.0,0.0&LLMAX="+q[D]+"&CACHEABLE=true&DS=navteq-world&WIDTH=256&HEIGHT=256&CLIENTNAME="+e.clientName+"&SESSIONID="+e.sessionID+"&FORMAT=PNG&CONFIG="+e.configuration+"&N="+
P+"&E="+L,E,E,S);o.insert(L,L)}}z&&z()}}m=G.ex({tileSize:256},m);var q=["89.787438015348100000,360.00000000000000000","85.084059050110410000,180.00000000000000000","66.653475896509040000,90.00000000000000000","41.170427238429790000,45.000000000000000000","22.076741328793200000,22.500000000000000000","11.251819676168665000,11.250000000000000000","5.653589942659626000,5.625000000000000000","2.830287664051185000,2.812500000000000000","1.415581451872543800,1.406250000000000000","0.707845460801532700,0.703125000000000000",
"0.353929573271679340,0.351562500000000000","0.176965641673330230,0.175781250000000000","0.088482927761462040,0.087890625000000000","0.044241477246363230,0.043945312500000000","0.022120740293895182,0.021972656250000000","0.011060370355776452,0.010986328125000000","0.005530185203987857,0.005493164062500000","0.002765092605263539,0.002746582031250000","0.001382546303032519,0.001373291015625000","0.000691272945568983,0.000686645507812500","0.000345636472797214,0.000343322753906250"],u=null;G.userMessage("ack",
"decarta","&copy; deCarta, Inc. Map and Imagery Data &copy; NAVTEQ or Tele Atlas or DigitalGlobe");return{run:function(D,B,o,z){u?t(D,B,o,z):f(new r,function(s){u=[];if(s.aliasCount)for(var w=0;w<s.aliasCount;w++)u[w]="http://"+s.host.replace("^(.*?).(.*)$","\u0001-0"+(w+1)+".\u0002");else u=["http://"+s.host];t(D,B,o,z)})}}});G.Registry.register("service","geocoder",function(){var m=function(q){function u(o){var z=[],s=o?o.numberOfGeocodedAddresses:0,w=[];if(s>1)w=o.GeocodedAddress;else if(s==1)w=
[o.GeocodedAddress];try{for(o=0;w&&o<w.length;o++){var E,C=w[o],F=s=null;if(C&&C.GeocodeMatchCode&&C.GeocodeMatchCode.matchType!=="NO_MATCH"){if(C&&C.Point)F=new G.Pos(C.Point.pos);if(C&&C.Address)s=i(C.Address,F)}(E=s)&&z.push(E)}}catch(K){ca(K,"error")}return z}q=G.ex({addresses:[],parserReport:false,parseOnly:false,returnSpatialKeys:false},q);var D=qa('<xls:GeocodeRequest parserReport="{0}" parseOnly="{1}" returnSpatialKeys="{2}">'),B=new p;return G.ex({},B,{methodName:"Geocode",getRequestBody:function(){for(var o=
D(q.parserReport,q.parseOnly,q.returnSpatialKeys),z=0;z<q.addresses.length;z++)o+=q.addresses[z].getXML();return o+"</xls:GeocodeRequest>"},parseResponse:function(o){if(q.addresses.length===1)return[u(o.GeocodeResponseList)];else{for(var z=[],s=0;s<q.addresses.length;s++)z.push(u(o.GeocodeResponseList[s]));return z}}})},t=function(q){q=G.ex({position:null,geocodePreference:"StreetAddress"},q);return G.ex(new p,{methodName:"ReverseGeocode",getRequestBody:function(){return"<xls:ReverseGeocodeRequest><xls:Position><gml:Point><gml:pos>"+
q.position.toString()+"</gml:pos></gml:Point></xls:Position><xls:ReverseGeocodePreference>"+q.geocodePreference+"</xls:ReverseGeocodePreference></xls:ReverseGeocodeRequest>"},parseResponse:function(u){var D=null;if(u&&u.Point)D=new G.Pos(match.Point.pos);if(u&&u.ReverseGeocodedLocation&&u.ReverseGeocodedLocation.Address)return i(u.ReverseGeocodedLocation.Address,D);return null}})};return{forward:function(q){q=G.ex({addresses:[],complete:null},q);var u,D=[];if(q.addresses&&!G.is(q.addresses,"array"))q.addresses=
[q.addresses];for(u=0;u<q.addresses.length;u++)G.is(q.addresses[u],"object")?ca("attempting to geocode a simple object - not implemented","warn"):D.push(new types.Address({freeform:q.addresses[u]}));if(D.length>0){D=new m({addresses:D});f(D,function(B){if(q.complete)for(u=0;u<B.length;u++)q.complete(q.addresses[u],B[u])})}},reverse:function(q){q=G.ex({position:null,complete:null},q);if(!q.position)throw Error("Cannot reverse geocode without a position");var u=new t(q);f(u,function(D){q.complete&&
q.complete(D)})}}});G.Registry.register("service","routing",function(){var m=function(t){t=G.ex({waypoints:[],provideRouteHandle:false,distanceUnit:"KM",routeQueryType:"RMAN",routePreference:"Fastest",routeInstructions:true,routeGeometry:true},t);var q=new p,u=G.formatter('<xls:DetermineRouteRequest provideRouteHandle="{0}" distanceUnit="{1}" routeQueryType="{2}">'),D=G.formatter("<xls:{0}><xls:Position><gml:Point><gml:pos>{1}</gml:pos></gml:Point></xls:Position></xls:{0}>");return G.ex({},q,{methodName:"DetermineRoute",
getRequestBody:function(){if(t.waypoints.length<2)throw Error("Cannot send RouteRequest, less than 2 waypoints specified");var B=u(t.provideRouteHandle,t.distanceUnit,t.routeQueryType);B+="<xls:RoutePlan>";B+="<xls:RoutePreference>"+t.routePreference+"</xls:RoutePreference>";B+="<xls:WayPointList>";for(var o=0;o<t.waypoints.length;o++)B+=D(o===0?"StartPoint":o===t.waypoints.length-1?"EndPoint":"ViaPoint",t.waypoints[o].toString());B+="</xls:WayPointList>";B+="</xls:RoutePlan>";if(t.routeInstructions)B+=
'<xls:RouteInstructionsRequest rules="maneuver-rules" providePoint="true" />';if(t.routeGeometry)B+="<xls:RouteGeometryRequest />";B+="</xls:DetermineRouteRequest>";return B},parseResponse:function(B){var o=G.RouteTools.RouteData,z=B.RouteGeometry.LineString.pos,s=z.length,w=Array(s);for(s=s;s--;)w[s]=new ka(z[s]);z=B.RouteInstructionsList;B=[];z=z&&z.RouteInstruction?z.RouteInstruction:[];s=0;for(var E=new COG.Duration,C=0;C<z.length;C++){var F;F=z[C].distance;var K={M:1,KM:1E3}[F.uom?F.uom.toUpperCase():
"M"];F=F.value&&K?F.value*K:0;K=COG.parseDuration(z[C].duration,"8601");s+=F;E=COG.addDuration(E,K);B.push(new G.RouteTools.Instruction({position:new G.Pos(z[C].Point),description:z[C].Instruction,distance:F,distanceTotal:s,time:K,timeTotal:E}))}return new o({geometry:w,instructions:B})}})};return{calculate:function(t,q){t=G.ex({waypoints:[]},t);if(typeof G.RouteTools!=="undefined"){var u=new m(t);f(u,function(D){q&&q(D)})}else ca("Could not generate route, T5.RouteTools plugin not found","warn")}}});
return{applyConfig:function(m){G.ex(e,m)},compareFns:function(){return{streetDetails:function(m,t){return t.calcMatchPercentage(m)},location:function(m,t){return t.calcMatchPercentage(m)}}}()}}();mb.T5=G;mb.Tile5=function(a,c){c=M({container:a,type:"map",renderer:"canvas",starpos:null,zoom:1,fastpan:false,drawOnScale:true,zoombar:{}},c);return ua("view",c.type,c)}})(window);
