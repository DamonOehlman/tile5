(function(mb){function L(){var a=arguments[0]||{},c=Array.prototype.slice.call(arguments,1),b=c.length,e,i;for(i=0;i<b;i++)if((e=c[i])!==null)for(var g in e){var h=e[g];if(a!==h)if(h!==undefined)a[g]=h}return a}function Z(a,c){if(typeof console!=="undefined")console[c||"debug"](a)}function pa(a){var c=a.match(Db),b=[],e=0,i;for(i=c?c.length:0;i--;){var g=c[i].slice(1);b[g]||(b[g]=RegExp("\\{"+g+"\\}","g"))}e=b.length;return function(){var h=a;for(i=0;i<e;i++){var k=arguments[i];if(typeof k=="undefined")k=
"";h=h.replace(b[i],k)}return h}}function nb(a,c){var b=Ma*qa(a);return Na-2*ob(c*za((1-b)/(1+b),Ma/2))}function ha(a,c){if(R(a,ra)){var b=a.split(Za);this.x=parseFloat(b[0]);this.y=parseFloat(b[1])}else{this.x=a||0;this.y=c||0}}function sa(a,c,b,e){this.mercX=b;this.mercY=e;if(R(a,ra))L(this,Eb.parseXY(a));else a&&a.toPixels?L(this,a.toPixels()):ha.call(this,a,c)}function ta(a,c,b,e){this.x=a||0;this.y=c||0;this.w=b||0;this.h=e||0;this.x2=this.x+this.w;this.y2=this.y+this.h}function pb(a,c){if(!a)return null;
c=c||Fb;for(var b=[],e=null,i=a.length;i--;){var g=a[i];if(include=!e||i===0||ia(g.x-e.x)+ia(g.y-e.y)>c){b.unshift(g);e=g}}return b}function qb(a,c){var b=new rb(Math.sqrt(256<<a)|0);c&&c.zoomLevel===a&&c.copyInto(b);b.zoomLevel=a;return b}function $a(a,c,b,e,i,g){this.x=a;this.y=c;this.w=e||256;this.h=e||256;this.x2=this.x+this.w;this.y2=this.y+this.h;this.url=b;this.id=g||a+"_"+c;this.loaded=false;this.image=null}function Oa(a,c){c=L({id:"layer_"+Gb++,zindex:0,animated:false,style:null,minXY:null,
maxXY:null},c);this.visible=true;this.view=a;la(L(this,c))}function Pa(){la(this)}function ga(a,c){if(a&&a.split){var b=a.split(Za);if(b.length>1){a=b[0];c=b[1]}}else if(a&&a.lat){c=a.lon;a=a.lat}this.lat=parseFloat(a||0);this.lon=parseFloat(c||0)}function Ga(a,c){if(R(a,sb)){for(var b=c,e=new ga(ab,Qa),i=new ga(Hb,tb),g=a.length;g--;){var h=a[g];if(h.lat<e.lat)e.lat=h.lat;if(h.lat>i.lat)i.lat=h.lat;if(h.lon<e.lon)e.lon=h.lon;if(h.lon>i.lon)i.lon=h.lon}this.min=e;this.max=i;if(R(b,ua)){b=this.size();
b=Ha(b.x,b.y)*0.3}this.expand(b)}else{this.min=a;this.max=c}}var bb={};(function(a){var c=[],b=0,e=false,i=a.register=function(g,h){c.push({section:g,run:h})};a.init=function(g){function h(){if(b<c.length){var f=c[b++];k[f.section]||(k[f.section]={});f.run(k[f.section],h)}else{for(f in k)a[f]=k[f];e=true;g&&g(a)}}var k={};if(e&&g)g(a);else{b=0;h()}};i("canvas",function(g,h){function k(){var l,m=f.getContext("2d");m.save();try{m.translate(50,50);m.beginPath();m.rect(0,0,20,20);l=m.isPointInPath(10,
10)}finally{m.restore()}return l}var f=document.createElement("canvas"),j=typeof FlashCanvas!="undefined",d=typeof G_vmlCanvasManager!="undefnined";f.width=200;f.height=200;g.pipTransformed=j||d?false:k();h()})})(bb);var Db=/\{(\d+)(?=\})/g,Ib=function(){var a=1.70158,c=Math.PI/2,b=Math.abs,e=Math.pow,i=Math.sin,g=Math.asin,h=Math.cos,k={linear:function(f,j,d,l){return d*f/l+j},backin:function(f,j,d,l){return d*(f/=l)*f*((a+1)*f-a)+j},backout:function(f,j,d,l){return d*((f=f/l-1)*f*((a+1)*f+a)+1)+
j},backinout:function(f,j,d,l){return(f/=l/2)<1?d/2*f*f*(((a*=1.525)+1)*f-a)+j:d/2*((f-=2)*f*(((a*=1.525)+1)*f+a)+2)+j},bouncein:function(f,j,d,l){return d-k.bounceout(l-f,0,d,l)+j},bounceout:function(f,j,d,l){return(f/=l)<1/2.75?d*7.5625*f*f+j:f<2/2.75?d*(7.5625*(f-=1.5/2.75)*f+0.75)+j:f<2.5/2.75?d*(7.5625*(f-=2.25/2.75)*f+0.9375)+j:d*(7.5625*(f-=2.625/2.75)*f+0.984375)+j},bounceinout:function(f,j,d,l){return f<l/2?k.bouncein(f*2,0,d,l)/2+j:k.bounceout(f*2-l,0,d,l)/2+d/2+j},cubicin:function(f,j,
d,l){return d*(f/=l)*f*f+j},cubicout:function(f,j,d,l){return d*((f=f/l-1)*f*f+1)+j},cubicinout:function(f,j,d,l){if((f/=l/2)<1)return d/2*f*f*f+j;return d/2*((f-=2)*f*f+2)+j},elasticin:function(f,j,d,l,m,o){if(f==0)return j;if((f/=l)==1)return j+d;o||(o=l*0.3);if(!m||m<b(d)){m=d;d=o/4}else d=o/$*g(d/m);return-(m*e(2,10*(f-=1))*i((f*l-d)*$/o))+j},elasticout:function(f,j,d,l,m,o){var p;if(f==0)return j;if((f/=l)==1)return j+d;o||(o=l*0.3);if(!m||m<b(d)){m=d;p=o/4}else p=o/$*g(d/m);return m*e(2,-10*
f)*i((f*l-p)*$/o)+d+j},elasticinout:function(f,j,d,l,m,o){var p;if(f==0)return j;if((f/=l/2)==2)return j+d;o||(o=l*0.3*1.5);if(!m||m<b(d)){m=d;p=o/4}else p=o/$*g(d/m);if(f<1)return-0.5*m*e(2,10*(f-=1))*i((f*l-p)*$/o)+j;return m*e(2,-10*(f-=1))*i((f*l-p)*$/o)*0.5+d+j},quadin:function(f,j,d,l){return d*(f/=l)*f+j},quadout:function(f,j,d,l){return-d*(f/=l)*(f-2)+j},quadinout:function(f,j,d,l){if((f/=l/2)<1)return d/2*f*f+j;return-d/2*(--f*(f-2)-1)+j},sinein:function(f,j,d,l){return-d*h(f/l*c)+d+j},sineout:function(f,
j,d,l){return d*i(f/l*c)+j},sineinout:function(f,j,d,l){return-d/2*(h(Math.PI*f/l)-1)+j}};return function(f){f=f.replace(/[\-\_\s\.]/g,"").toLowerCase();return k[f]||k.linear}}(),la=function(){function a(b,e){var i=b.hasOwnProperty("obsHandlers")?b.obsHandlers:null;i[e]||(i[e]=[]);return i[e]}var c=0;return function(b){if(!b)return null;if(!(b.hasOwnProperty("obsHandlers")?b.obsHandlers:null))b.obsHandlers={};if(!b.hasOwnProperty("bind")){b.bind=function(e,i){var g="callback"+c++;a(b,e).unshift({fn:i,
id:g});return g};b.triggerCustom=function(e,i){var g=a(b,e),h={cancel:false,name:e,source:this},k;for(k in i)h[k]=i[k];if(!g)return null;k=Array.prototype.slice.call(arguments,2);b.eventInterceptor&&b.eventInterceptor(e,h,k);k.unshift(h);for(var f=g.length;f--&&!h.cancel;)g[f].fn.apply(this,k);return h};b.trigger=function(e){var i=Array.prototype.slice.call(arguments,1);i.splice(0,0,e,null);return b.triggerCustom.apply(this,i)};b.unbind=function(e,i){if(typeof e==="undefined")b.obsHandlers={};else for(var g=
a(b,e),h=0;g&&h<g.length;h++)if(g[h].id===i){g.splice(h,1);break}return b}}return b}}(),ub=function(){function a(c,b,e,i){if(typeof c[i]=="undefined")c[i]=function(g){if(typeof g!="undefined"){b[i]=g;e[i]&&e[i](g);return c}else return b[i]}}return function(c,b,e){b=b||c;for(var i in b)typeof b[i]!="function"&&a(c,b,e,i);return c}}(),cb=Array.prototype.indexOf||function(a){for(var c=0;c<this.length;c++)if(this[c]===a)return c;return-1},R=function(){return function(a,c){c=Jb.call(c);if(c=="finite")return!Kb[Lb](+a);
return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||Mb.call(a).slice(8,-1).toLowerCase()==c}}(),Nb=function(){function a(i){var g=document.createElement("script"),h=false;g.src=i;g.async=true;g.onload=g.onreadystatechange=function(){if(!h&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){h=true;g.onload=g.onreadystatechange=null;g&&g.parentNode&&g.parentNode.removeChild(g)}};b||(b=document.getElementsByTagName("head")[0]);
b.appendChild(g)}var c=0,b,e=this;return function(i,g,h){i+=i.indexOf("?")>=0?"&":"?";var k="json"+ ++c;e[k]=function(f){g(f);e[k]=null;try{delete e[k]}catch(j){}};a(i+(h?h:"callback")+"="+k);return k}}();INTERACT=function(){function a(m){return function(o,p){m.addEventListener(o,p,false)}}function c(m){return function(o,p){m.removeEventListener(o,p,false)}}function b(m){return function(o,p){m.attachEvent("on"+o,p)}}function e(m,o){return{x:m?m:0,y:o?o:0,count:1}}function i(m,o){d.push(L({handler:null,
checks:{},type:m},o))}function g(m){var o=0,p=0;if(m.offsetParent){do{o+=m.offsetLeft;p+=m.offsetTop;m=m.offsetParent}while(m)}return{left:o,top:p}}function h(m,o){return{source:m,target:o.target?o.target:o.srcElement}}function k(m,o){for(var p=m.target?m.target:m.srcElement;p&&p!==o;)p=p.parentNode;return p&&p===o}function f(m,o){return{x:m.x-(o?o.left:0),y:m.y-(o?o.top:0)}}function j(m,o){if(m.preventDefault){m.preventDefault();m.stopPropagation()}else if(typeof m.cancelBubble!="undefined")m.cancelBubble=
true;o&&m.stopImmediatePropagation&&m.stopImmediatePropagation()}var d=[],l=function(m,o,p){p=L({binder:null,unbinder:null,observable:null},p);for(var n=p.observable,s=[],r,u,D={bind:function(){return n.bind.apply(null,arguments)},unbind:function(){n.unbind();for(B=0;B<s.length;B++)s[B].unbind();return D}},B=0;B<o.length;B++)s.push(o[B](m,n,p));n.bind("pointerDown",function(){u=r=0});n.bind("pointerMove",function(q,z,t,w){r+=w.x||0;u+=w.y||0});n.bind("pointerUp",function(q,z,t){Math.abs(r)>20||Math.abs(u)>
20||n.triggerCustom("tap",q,z,t)});return D};i("pointer",{handler:function(m,o,p){function n(y){if(y.pageX&&y.pageY)return e(y.pageX,y.pageY);else{var M=document.documentElement,P=document.body;return e(y.clientX+(M&&M.scrollLeft||P&&P.scrollLeft||0)-(M&&M.clientLeft||P&&P.clientLeft||0),y.clientY+(M&&M.scrollTop||P&&P.scrollTop||0)-(M&&M.clientTop||P&&P.clientTop||0))}}function s(y){if(k(y,m))if(w=B(y)){var M=n(y);m.style.cursor="move";j(y,true);K=M.x;Q=M.y;E=e(K,Q);o.triggerCustom("pointerDown",
h("mouse",y),E,f(E,g(m)))}}function r(y){var M=n(y);C=M.x;F=M.y;if(k(y,m))q(y,w?"pointerMove":"pointerHover")}function u(y){if(w&&B(y)){w=false;if(k(y,m)){m.style.cursor="default";q(y,"pointerUp")}}}function D(y){if(k(y,m)){var M;y=y||window.event;if(y.detail)M=y.axis===2?-y.detail*z:0;else{M=y.wheelDeltaY?y.wheelDeltaY:y.wheelDelta;if(window.opera)M=-M}if(M!==0){var P=e(C,F);o.triggerCustom("zoom",h("mouse",y),P,f(P,g(m)),M/t,"wheel");j(y);y.returnValue=false}}}function B(y){y=y||window.event;return(y.which||
y.button)==1}function q(y,M,P,S,W){P=typeof P!="undefined"?P:C;S=typeof S!="undefined"?S:F;var I=P-K,J=S-Q,H=e(P,S);o.triggerCustom(M,h("mouse",y),H,f(H,g(m)),e(I,J));if(typeof W=="undefined"||W){K=P;Q=S}}p=L({},p);var z=120,t=z*8,w=false,E,C,F,K,Q;p.binder("mousedown",s);p.binder("mousemove",r);p.binder("mouseup",u);p.binder("dblclick",function(y){Z("captured double click");if(k(y,m)){var M=n(y);o.triggerCustom("doubleTap",h("mouse",y),M,f(M,g(m)))}});p.binder("mousewheel",D);p.binder("DOMMouseScroll",
D);return{unbind:function(){p.unbinder("mousedown",s);p.unbinder("mousemove",r);p.unbinder("mouseup",u);p.unbinder("mousewheel",D);p.unbinder("DOMMouseScroll",D)}}},checks:{touch:false}});i("pointer",{handler:function(m,o,p){function n(I){if(I.count<2)return 0;var J=I.x-I.next.x;I=I.y-I.next.y;return~~Math.sqrt(J*J+I*I)}function s(I,J,H){J=J?J:0;H=H?H:0;for(var X={x:I.x-J,y:I.y-H,id:I.id,count:I.count},Y=X;I.next;){I=I.next;Y=Y.next={x:I.x-J,y:I.y-H,id:I.id}}return X}function r(I,J){var H=I[J?J:"touches"],
X,Y;if(H.length===0)return null;Y=X={x:H[0].pageX,y:H[0].pageY,id:H[0].identifier,count:H.length};for(var ea=1,Ra=H.length;ea<Ra;ea++)Y=Y.next={x:H[ea].pageX,y:H[ea].pageY,id:H[ea].identifier};return X}function u(I){if(k(I,m)){F=g(m);var J=r(I,"changedTouches"),H=s(J,F.left,F.top);if(!Q){K=w;o.triggerCustom("pointerDown",h("touch",I),J,H)}S&&o.triggerCustom("pointerDownMulti",h("touch",I),J,H);Q=r(I);if(Q.count>1)M=n(Q);W=1;P=s(Q)}}function D(I){if(k(I,m)){j(I);y=r(I);if(K==w)K=Math.abs(Q.x-y.x)>
z||Math.abs(Q.y-y.y)>z?t:w;if(K!=w){K=y.count>1?C:E;if(K==C)if(Q.count===1){Q=s(y);M=n(Q)}else{var J=n(y);if(Math.abs(M-J)<q)K=E;else{var H;H=y.x;var X=y.next.x,Y=y.y,ea=y.next.y;H={x:(H<X?H:X)+(Math.abs(H-X)>>1),y:(Y<ea?Y:ea)+(Math.abs(Y-ea)>>1)};J=J/M;X=J-W;o.triggerCustom("zoom",h("touch",I),H,f(H,F),X,"pinch");W=J}}K==E&&o.triggerCustom("pointerMove",h("touch",I),y,s(y,F.left,F.top),e(y.x-P.x,y.y-P.y));S&&o.triggerCustom("pointerMoveMulti",h("touch",I),y,s(y,F.left,F.top))}P=s(y)}}function B(I){if(k(I,
m)){var J=r(I,"changedTouches"),H=s(J,F.left,F.top);y=r(I);if(!y){o.triggerCustom("pointerUp",h("touch",I),J,H);Q=null}S&&o.triggerCustom("pointerUpMulti",h("touch",I),J,H)}}p=L({detailed:false,inertia:false},p);var q=20,z=7,t=0,w=1,E=2,C=3,F,K,Q,y,M,P,S=p.detailed,W=1;p.binder("touchstart",u);p.binder("touchmove",D);p.binder("touchend",B);Z("initialized touch handler");return{unbind:function(){p.unbinder("touchstart",u);p.unbinder("touchmove",D);p.unbinder("touchend",B)}}},checks:{touch:true}});
return{register:i,watch:function(m,o,p){o=L({bindTarget:null,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},o);capabilities=L({touch:"ontouchstart"in window},p);if(!o.observable){Z("creating observable");o.observable=la({});globalOpts=o}o.binder=(o.isIE?b:a)(o.bindTarget||document);o.unbinder=(o.isIE?b:c)(o.bindTarget||document);p=o.types;for(var n=capabilities,s=[],r=d.length;r--;){var u=d[r],D=!p||p.indexOf(u.type)>=0,B=true,q;for(q in u.checks){var z=u.checks[q];Z("checking "+
q+" capability. require: "+z+", capability = "+n[q]);B=B&&z===n[q]}if(D&&B)s[s.length]=u.handler}return new l(m,s,o)}}}();var Sa=function(){var a={};return{create:function(c,b){if(a[c][b])return a[c][b].apply(null,Array.prototype.slice.call(arguments,2))},get:function(c,b){return a[c]?a[c][b]:null},register:function(c,b,e){a[c]||(a[c]={});a[c][b]&&Z(Ob(c,b),"warn");a[c][b]=e}}}(),Ob=pa("Registration of {0}: {1} will override existing definition"),Pb=pa("Could not create drawable of type: {0}"),db=
[1.406245461070741,1.321415085624082,1.077179995861952,0.703119412486786,0.488332580888611],$=Math.PI*2,Na=Math.PI/2,Fb=3,ca=Math.PI/180,ja=180/Math.PI,ab=90,Hb=-ab,Qa=180,tb=-Qa,eb=ab*ca,vb=-eb,wb=Qa*ca,Qb=-wb,Ma=0.08181919084262157,ia=Math.abs,xb=Math.ceil,Ia=Math.round,Ta=Math.min,Ha=Math.max,za=Math.pow,yb=Math.sqrt,Aa=Math.log,qa=Math.sin,zb=Math.asin,Ua=Math.cos,ob=Math.atan,Rb=Math.atan2,Lb="hasOwnProperty",Kb={NaN:1,Infinity:1,"-Infinity":1},Jb=String.prototype.toLowerCase,Mb=Object.prototype.toString,
ua="undefined",ra="string",va="number",sb="array",aa=Sa.register,wa=Sa.create,Sb=Sa.get,Tb=0,Gb=0,Za=/[\,\s]+/,Ca=function(){function a(h){i++;h=h||(new Date).getTime();for(var k=e.length;k--;){var f=e[k];i%f.every===0&&f.cb(h)}g&&animFrame(a)}var c=1E3/60,b=["r","webkitR","mozR","oR","msR"],e=[],i=0,g=function(){for(var h=0;h<b.length;h++)window.animFrame=window.animFrame||window[b[h]+"equestAnimationFrame"];window.animFrame&&Z("Using request animation frame");return animFrame}();g?animFrame(a):
setInterval(a,1E3/60);return{attach:function(h,k){e[e.length]={cb:h,every:k?Ia(k/c):1}},detach:function(h){for(var k=e.length;k--;)if(e[k].cb===h){e.splice(k,1);break}}}}(),Eb=function(){var a=/^xy\((.*)\).*$/i;return{parseXY:function(c){if(!a.test(c)){c=c.split(Za);return Va(c[1],c[0])}}}}(),V=function(){function a(e){for(var i=0;i<e.length;i++){var g=e[i];if(typeof document.body.style[g]!="undefined")return g}}var c={"-webkit-user-select":"none",position:"absolute"},b;b=a(["-webkit-transform","MozTransform"]);
css3DTransformProp=a(["WebkitPerspective","MozPerspective"]);return{transforms:R(b,ra),create:function(e,i,g){e=document.createElement(e);var h=[];g=g||{};e.className=i||"";for(var k in g)h[h.length]=k+": "+g[k];e.style.cssText=h.join(";");return e},move:function(e,i,g,h){if(b)e.style[b]="translate("+i+"px, "+g+"px) "+(h||[]).join(" ");else{e.style.left=i+"px";e.style.top=g+"px"}},styles:function(e){return L({},c,e)}}}(),Ab=function(){function a(){for(var i=e.length,g=i;g--;)try{e[g](i)}catch(h){Z(h.toString(),
"error")}}var c=20,b=50,e=[];return{process:function(i,g,h){function k(d){d=(f||b)/d;if(j<i.length){var l=i.slice(j,j+d);d=l.length;var m=f?0:(new Date).getTime();g(l,d);if(!f){f=(l=((new Date).getTime()-m)/d)?c/l|0:i.length;Z("calculated that we can process "+f+" items per cycle")}j+=d}else{for(d=e.length;d--;)if(e[d]===k){e.splice(d,1);break}e.length===0&&Ca.detach(a);h&&h()}}var f,j=0;e.push(k)===1&&Ca.attach(a)}}}(),Va=Va||function(a,c){var b=parseFloat(c)*ca;b=qa(b);var e=Ma*b;b=Aa((1+b)/(1-
b)*za((1-e)/(1+e),Ma))/2;return new sa(0,0,parseFloat(a)*ca,b)},fb=fb||function(a,c){for(var b=za(Math.E,-c),e=Na-2*ob(b),i=nb(e,b),g=0;g<12&&ia(e-i)>1.0E-7;){e=i;i=nb(e,b);g++}return new ga(i*ja,a%360*ja)};ha.prototype={constructor:ha,add:function(){for(var a=this.x,c=this.y,b=arguments.length;b--;){a+=arguments[b].x;c+=arguments[b].y}return this.copy(a,c)},copy:function(a,c){var b=L({},this);b.x=a||b.x;b.y=c||b.y;return b},equals:function(a){return this.x===a.x&&this.y===a.y},offset:function(a,
c){return this.copy(this.x+a,this.y+c)},sync:function(){return this},toString:function(){return this.x+", "+this.y}};sa.prototype=L(new ha,{constructor:sa,pos:function(){return fb(this.mercX,this.mercY)},sync:function(a,c){var b;if(!(b=a.rpp)){b=a.zoom();b=$/(256<<b)}b=b;if(c){this.mercX=this.x*b-Math.PI;this.mercY=Math.PI-this.y*b}else{this.x=Ia(((this.mercX||0)+Math.PI)/b);this.y=Ia((Math.PI-(this.mercY||0))/b)}return this}});ta.prototype={constructor:ta,buffer:function(a,c){return new ta(this.x-
a,this.y-(c||a),this.w+a*2,this.h+(c||a)*2)},center:function(){return new ha(this.x+(this.w>>1),this.y+(this.h>>1))}};aa("fn","simplify",pb);Hits=function(){return{diffHits:function(a,c){var b=[],e={},i;for(i=c.length;i--;)e[c[i].target.id]=true;for(i=a.length;i--;)e[a[i].target.id]||(b[b.length]=a[i]);return b},init:function(a,c,b,e){return{type:a,x:e.x|0,y:e.y|0,elements:[],absXY:c,relXY:b}},initHit:function(a,c,b){return{type:a,target:c,drag:b}},triggerEvent:function(a,c,b,e){c.triggerCustom(a.type+
(b?b:"Hit"),{hitType:a.type},e?e:a.elements,a.absXY,a.relXY,new sa(a.x,a.y))}}}();var rb=function(a){function c(g,h){var k=b[g],f;k||(k=b[g]=[]);(f=k[h])||(f=k[h]=[]);return f}a=a||128;var b=[],e={},i=0;return{copyInto:function(g){for(var h in e){var k=e[h];g.insert(k.bounds||k,k,h)}},insert:function(g,h,k){var f=g.x/a|0,j=g.y/a|0,d=(g.x+g.w)/a|0;g=(g.y+g.h)/a|0;k=k||h.id||"obj_"+i++;e[k]=h;for(h=f;h<=d;h++)for(f=j;f<=g;f++)c(h,f).push(k)},remove:function(g,h,k){k=k||h.id;if(e[k]){var f=g.x/a|0;h=
g.y/a|0;var j=(g.x+g.w)/a|0;g=(g.y+g.h)/a|0;delete e[k];for(f=f;f<=j;f++)for(var d=h;d<=g;d++){var l=c(f,d),m=cb.call(l,k);m>=0&&l.splice(m,1)}}},search:function(g){var h=g.y/a|0,k=(g.x+g.w)/a|0,f=(g.y+g.h)/a|0,j=[],d=[];for(g=g.x/a|0;g<=k;g++)for(var l=h;l<=f;l++)j=j.concat(c(g,l));j.sort();for(h=j.length;h--;){k=j[h];if(f=e[k])d[d.length]=f;for(;h>0&&j[h-1]==k;)h--}return d}}},Wa=function(){var a={},c=0;(new Date).getTime();var b={},e=[];Ca.attach(function(i){i=i||(new Date).getTime();for(var g=
0;g<e.length;){var h=e[g],k=b[h],f=b[h].image&&b[h].image.complete&&b[h].image.width>0,j=i-k.start;j=f||j>=3E4;if(f){f=k.callbacks;a[h]=k.image;for(var d=0;d<f.length;d++)f[d](k.image,true)}if(j){e.splice(g,1);delete b[h]}else g++}},250);return function(i,g){var h=i&&g?a[i]:null;if(h&&h&&h.complete&&h.width>0)g(h);else if(h=b[i])h.callbacks.push(g);else{h=new Image;h.id="_ldimg"+ ++c;b[i]={start:(new Date).getTime(),image:h,callbacks:[g]};h.src=i;e[e.length]=i}}}();$a.prototype={constructor:$a,load:function(a){var c=
this;Wa(this.url,function(b){c.loaded=true;c.image=b;a&&a()})}};var Ub=function(){return la({fastpan:true,applyStyle:function(){},applyTransform:function(a,c,b){return{restore:null,x:c,y:b}},checkSize:function(){},getDimensions:function(){return{width:0,height:0}},getViewport:function(){},hitTest:function(){return false},prepare:function(){},projectXY:null,reset:function(){}})};aa("renderer","canvas",function(a,c,b,e,i){function g(q,z,t){var w,E;o[z]=function(C){for(w=D.length;w--;)if(E=t[D[w]])C[B[w]]=
E}}function h(q,z,t){var w=false;if(z)w=d.isPointInPath(n?z.x-l:z.relXY.x,n?z.y-m:z.relXY.y);return{draw:t||u,viewport:q,hit:w,vpX:l,vpY:m,context:d}}e=L({},e);var k,f,j,d,l=0,m=0,o={},p=null,n=bb.canvas.pipTransformed,s={},r=function(){},u=function(){this.fill&&d.fill();this.stroke&&d.stroke()},D=["fill","stroke","lineWidth","opacity"],B=["fillStyle","strokeStyle","lineWidth","globalAlpha"];if(c){k=c.offsetWidth;f=c.offsetHeight;j=V.create("canvas",null,{position:"absolute","z-index":1});j.width=
k;j.height=f;a.attachFrame(j,true);d=null}b=L(i,{applyStyle:function(q){var z=o[q],t=d&&d.canvas?d.canvas.id:"default",w;s[t]||(s[t]=[]);w=s[t].pop()||"basic";if(z){s[t].push(q);z(d);return w}},applyTransform:function(q){if(q.translateX!==0||q.translateY!==0||q.scaling!==1||q.rotation!==0){d.save();p={undo:function(){d.restore();p=null},x:q.xy.x,y:q.xy.y};d.translate(q.xy.x-l+q.translateX,q.xy.y-m+q.translateY);q.rotation!==0&&d.rotate(q.rotation);q.scaling!==1&&d.scale(q.scaling,q.scaling)}return p},
drawTiles:function(q,z,t){for(var w=z.length;w--;){q=z[w];if(!q.loaded&&t)q.load(a.invalidate);else q.image&&d.drawImage(q.image,q.x-l,q.y-m)}},prepare:function(q,z){var t,w=false,E=z.scaled||z;if(d)d.restore();else d=j.getContext("2d");for(t=q.length;t--;)w=w||q[t].clip;l=E.x;m=E.y;if(d){w||d.clearRect(0,0,k,f);d.save()}d.globalCompositeOperation="source-over";return d},prepArc:function(q,z,t){d.beginPath();d.arc(q.xy.x-(p?p.x:l),q.xy.y-(p?p.y:m),q.size>>1,q.startAngle,q.endAngle,false);return h(z,
t)},prepImage:function(q,z,t,w){var E=(w.x||q.xy.x)-(p?p.x:l),C=(w.y||q.xy.y)-(p?p.y:m),F=w.image||q.image;if(F){d.beginPath();d.rect(E,C,w.width||F.width,w.height||F.height);return h(z,t,function(){d.drawImage(F,E,C,w.width||F.width,w.height||F.height)})}},prepMarker:function(q,z,t){var w=q.xy.x-(p?p.x:l),E=q.xy.y-(p?p.y:m),C=q.size,F=undefined;d.beginPath();switch(q.markerStyle.toLowerCase()){case "image":F=r;d.rect(w-(C>>1),E-(C>>1),C,C);if(q.reset&&q.image){q.image=null;q.reset=false}q.image?
d.drawImage(q.image,w-(C>>1),E-(C>>1),C,C):Wa(q.imageUrl,function(K){q.image=K;d.drawImage(q.image,w-(C>>1),E-(C>>1),C,C)});break;default:d.moveTo(w,E);d.lineTo(w-(C>>1),E-C);d.lineTo(w+(C>>1),E-C);d.lineTo(w,E)}return h(z,t,F)},prepPoly:function(q,z,t,w){var E=true;q=w.points||q.points;w=p?p.x:l;var C=p?p.y:m;d.beginPath();for(var F=q.length;F--;){var K=q[F].x-w,Q=q[F].y-C;if(E){d.moveTo(K,Q);E=false}else d.lineTo(K,Q)}return h(z,t)},getContext:function(){return d}});(function(){for(var q in G.styles)g(null,
q,G.styles[q]);Bb.bind("defined",g)})();b.bind("detach",function(){c.removeChild(j)});return b});aa("renderer","dom",function(a,c,b,e,i){function g(d){var l=d.image=new Image;f[d.id]=d;l.src=d.url;l.onload=function(){if(j[d.id])k.appendChild(this);else d.image=null};l.style.cssText="-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;";
return l}function h(d,l,m){var o=[],p;for(p in d){var n=d[p];if(m?n[m]:!l[p]){if(n.image&&n.image.parentNode){k.removeChild(n.image);n.image=null}o[o.length]=p}}for(l=o.length;l--;)delete d[o[l]]}var k=null,f={},j={};k=V.create("div","",V.styles({width:c.offsetWidth+"px",height:c.offsetHeight+"px"}));c.childNodes.length>0?c.insertBefore(k,c.childNodes[0]):c.appendChild(k);a.attachFrame(k);a=L(i,{drawTiles:function(d,l,m){for(var o,p=d.x,n=d.y,s=l.length;s--;){d=l[s];if(d.url){(o=d.image||(m?g(d):
null))&&V.move(o,d.x-p,d.y-n);j[d.id]=d}}}});a.bind("predraw",function(){h(f,j);j={}});a.bind("detach",function(){c.removeChild(k)});a.bind("reset",function(){for(h(f,j={});k.childNodes.length>0;)k.removeChild(k.childNodes[0])});return a});var Bb=function(){function a(e,i){if(R(e,ra)){b.trigger("defined",e,c[e]=i);return e}else{var g=[],h;for(h in e)g[g.length]=a(h,e[h]);return g}}var c={},b=la({get:function(e){return c[e]},define:a});a({basic:{fill:"#ffffff"},highlight:{fill:"#ff0000"},waypoints:{lineWidth:4,
stroke:"#003377",fill:"#ffffff"},waypointsHover:{lineWidth:4,stroke:"#ff0000",fill:"#ffffff"}});return b}();aa("view","view",function(a){function c(v,x,A,O){D(Ha(U+za(2,O)-1,0.125),false,true)}function b(v,x){var A=renderer&&renderer.projectXY?renderer.projectXY(v,x):null;if(!A){A=N.getViewport();var O=1/U;A=new N.XY(A?A.x+v*O:v,A?A.y+x*O:x)}return A.sync(N,true)}function e(v,x,A){B("doubleTap",x,A,b(A.x,A.y));a.scalable&&D(2,{easing:"quad.out",duration:300},true)}function i(v,x,A){K=null;P=true;
n("down",x,A)}function g(v,x,A){n("hover",x,A)}function h(v,x,A,O){m(x,A,false);if(!K){S=O.x;W=O.y}}function k(v,x,A){m(x,A,true);P=false}function f(){clearTimeout(Cb);Cb=setTimeout(function(){renderer.checkSize()},250)}function j(v,x,A){n("tap",x,A);N.trigger("tap",x,A,b(A.x,A.y,true))}function d(v){var x=N,A=N,O=E,T=F,ka=a;v=(v||a.renderer).split("/");for(var ma=new Ub(A,O,T,ka),Da=0;Da<v.length;Da++)ma=wa("renderer",v[Da],A,O,T,ka,ma);renderer=x.renderer=ma;M=a.fastpan&&renderer.fastpan&&V.transforms;
l()}function l(){fa&&fa.unbind();if(renderer){fa=INTERACT.watch(renderer.interactTarget||F);if(a.scalable){fa.bind("zoom",c);fa.bind("doubleTap",e)}fa.bind("pointerDown",i);fa.bind("pointerMove",h);fa.bind("pointerUp",k);a.captureHover&&fa.bind("pointerHover",g);fa.bind("tap",j)}}function m(v,x,A){if(K){v=b(x.x,x.y);K.drag.call(K.target,K,v.x,v.y,A)&&ba++;if(A)K=null}}function o(v){for(var x=w;x--;)if(t[x].id===v)return x;return w}function p(v){F=document.getElementById(v);F.appendChild(C=V.create("div",
"",V.styles({overflow:"hidden",width:F.offsetWidth+"px",height:F.offsetHeight+"px"})));gb=C.offsetWidth+na*2;hb=C.offsetHeight+na*2;ib=F.offsetWidth/2;jb=F.offsetHeight/2;C.appendChild(E=V.create("div","",V.styles({width:gb+"px",height:hb+"px","z-index":2,margin:-na+"px 0 0 "+-na+"px"})));d()}function n(v,x,A){da=Hits.init(v,x,A,b(A.x,A.y,true));for(v=w;v--;)y=y||(t[v].hitGuess?t[v].hitGuess(da.x,da.y,N):false);y&&ba++}function s(){var v=new ta(J,H,gb,hb);v.scaleFactor=U;return v}function r(v,x,A){if(R(v,
ra)&&R(x,ua))for(x=0;x<w;x++){if(t[x].id===v)return t[x]}else if(R(v,ra)){x=wa("layer",x,N,A);x.added=(new Date).getTime();x.id=v;t[o(v)]=x;t.sort(function(O,T){return T.zindex-O.zindex||T.added-O.added});w=t.length;N.trigger("resync");u();N.trigger("layerChange",N,x);ba++;return x}else return[].concat(t)}function u(){var v=s();if(v){if(Ea||Fa)if(v){var x=Xa?J+(v.w>>1):J,A=Ya?H+(v.h>>1):H,O=v.w,T=v.h;if(Ea&&Ea>O)if(x+O>Ea)J=Xa?J:Ea-O;else if(x<0)J=Xa?J:0;if(Fa&&Fa>T)if(A+T>Fa)H=Ya?H:Fa-T;else if(A<
0)H=Ya?H:0}ea=J;Ra=H;N.trigger("refresh",N,v);ba++}}function D(v,x,A){if(R(v,va)){var O=A?v:U*v;if(!Vb){x=null;v=Ia(Aa(O)/Math.LN2);O=za(2,v)}if(x)Ja=oa.tween([U],[O],x,function(){U=O;Ja=null;ba++});else{U=O;ba++}return N}else return U}function B(){for(var v=N.trigger.apply(null,arguments).cancel,x=t.length;x--;)v=t[x].trigger.apply(null,arguments).cancel||v;return!v}function q(v,x,A){if(R(v,va)){if(A)xa=oa.tween([J,H],[v,x],A,function(){xa=null});else{J=v|0;H=x|0}return N}else return(new N.XY(J,
H)).sync(N,true)}a=L({container:"",captureHover:true,controls:[],drawOnScale:true,fastpan:true,padding:0,inertia:true,refreshDistance:256,pannable:true,scalable:true,renderer:"canvas"},a);var z=[],t=[],w=0,E=null,C=null,F,K=null,Q=!R(window.attachEvent,ua),y=false,M,P=false,S=0,W=0,I=a.refreshDistance,J=0,H=0,X=0,Y=0,ea=0,Ra=0,Ea=null,Fa=null,Xa=false,Ya=false,xa=null,na=a.padding,da=null,Ka=null,Cb=0,ya=0,La=null,U=1,Ja=null,kb=1,fa=null,lb={index:0,draw:false},Vb=true,ba=0,gb,hb,ib,jb,N={XY:ha,
id:a.id,padding:na,panSpeed:0,attachFrame:function(v,x){x&&E.appendChild(v)},center:function(v,x,A){if(R(v,ra)||R(v,"object")){x=new N.XY(v);x.sync(N);v=x.x;x=x.y}if(R(v,va)){q(v-ib-na,x-jb-na,A);return N}else return q().offset(ib+na|0,jb+na|0).sync(N,true)},detach:function(){renderer&&renderer.trigger("detach");fa&&fa.unbind();if(C){F.removeChild(C);E=C=null}},layer:r,invalidate:function(){ba++},pan:function(v,x,A){q(J+v,H+x,A)},refresh:u,rotate:function(v,x,A){if(R(v,va)){var O=A?v:ya+v;if(x)La=
oa.tween([ya],[O],x,function(){ya=O%360;La=null;ba++});else{ya=O%360;ba++}return N}else return ya},scale:D,triggerAll:B,setMaxOffset:function(v,x,A,O){Ea=v;Fa=x;Xa=A;Ya=O},getViewport:s,offset:q};la(N);N.bind("resize",function(){renderer.checkSize()});N.bind("layerRemove",function(v,x){var A=cb(t,x.id);if(A>=0&&A<w){t.splice(A,1);ba++}w=t.length});ub(N,a,{container:p,captureHover:l,scalable:l,pannable:l,renderer:function(v){if(renderer){renderer.trigger("detach");renderer=null}d(v);ba++}});bb.init(function(){r("markers",
"draw",{zindex:20});p(a.container);Q?window.attachEvent("onresize",f):window.addEventListener("resize",f,false)});Ca.attach(function(v){var x=[],A,O,T;self.panSpeed=panSpeed=ia(S)+ia(W);A=U!==kb;if(panSpeed>0||A||xa||Ja||La){ba++;if(xa&&panSpeed>0){xa(true);xa=null}}if(panSpeed<2&&(ia(J-ea)>=I||ia(H-Ra)>=I))u();lb.index++;lb.draw=ba||panSpeed||0;if(renderer&&lb.draw){if(Ja)U=Ja()[0];if(La)ya=La()[0];X+=S;Y+=W;if(S||W)N.trigger("pan");if(V.transforms){if(U!==1)x[x.length]="scale("+U+")";if(ya!==0)x[x.length]=
"rotate("+ya+"deg)"}if(A=!M||(a.drawOnScale||U===1)&&panSpeed<5){if(xa){A=xa();J=A[0]|0;H=A[1]|0}else{J=J-X/U|0;H=H-Y/U|0}T=s();renderer.trigger("predraw",T);if(renderer.prepare(t,T,v,da)){O=Y=A=X=ba=0;for(ii=w;ii--;){var ka=t[ii];if(ka.visible){var ma=ka.style?renderer.applyStyle(ka.style,true):null;ka.draw(renderer,T,N,v,da);ma&&renderer.applyStyle(ma)}}renderer.trigger("render",T);N.trigger("drawComplete",T,v);V.move(E,A,O,x)}}else V.move(E,X,Y,x);if(P||!a.inertia)W=S=0;else if(S!=0||W!=0){S*=
0.8;W*=0.8;if(ia(S)<0.5)S=0;if(ia(W)<0.5)W=0}if(da){v=da?da.elements:[];if(Ka&&Ka.type==="hover"){x=Hits.diffHits(Ka.elements,v);x.length>0&&Hits.triggerEvent(Ka,N,"Out",x)}if(v.length>0){A=da.x;O=da.y;for(x=v.length;x--;){T=v[x];ka=A;ma=O;var Da=T&&T.drag&&(!T.canDrag||T.canDrag(T,ka,ma));if(Da){K=T;K.startX=ka;K.startY=ma}if(Da)break}Hits.triggerEvent(da,N)}Ka=v.length>0?L({},da):null;da=null}if(kb!==U){N.trigger("scaleChanged",U);kb=U}}});(function(v){z=[];for(var x=0;x<v.length;x++)z[z.length]=
wa("control",v[x],N,C,F,a[v[x]])})(a.controls);return N});aa("view","map",function(a){function c(f,j){var d=k.getViewport();if(f){d=Ha(f.bestZoomLevel(d),j||0);return b(d).center(f.center())}else return new Ga((new sa(d.x,d.y2)).sync(k,true).pos(),(new sa(d.x2,d.y)).sync(k,true).pos())}function b(f,j,d){if(R(f,va)){f=Ha(a.minZoom,Ta(a.maxZoom,f|0));if(f!==g){var l=k.getViewport(),m=k.offset(),o=l.w/2;l=l.h/2;var p=za(2,f-g),n=o/p|0,s=l/p|0;g=f;k.offset(((j||m.x+o)-n)*p,((d||m.y+l)-s)*p);refreshY=
refreshX=0;k.trigger("zoom",f);i=k.rpp=$/(256<<g);k.setMaxOffset($/i|0,$/i|0,true,false);k.scale(1,false,true);k.trigger("resync");k.renderer.trigger("reset");k.refresh()}return k}else return g}a=L({container:"",captureHover:true,controls:["zoombar"],drawOnScale:true,padding:50,inertia:true,refreshDistance:256,pannable:true,scalable:true,minZoom:1,maxZoom:18,renderer:"canvas/dom",zoom:1,zoombar:{}},a);var e=new sa,i,g=a.zoom||a.zoomLevel,h=0,k=L(wa("view","view",a),{XY:sa,bounds:c,zoom:b});k.bind("refresh",
function(){var f=k.getViewport();if(e.x!=f.x||e.y!=f.y){k.trigger("boundsChange",c());e.x=f.x;e.y=f.y}});k.bind("scaleChanged",function(f,j){var d=Aa(j)/Math.LN2|0;if(d!==0){j=za(2,d);clearTimeout(h);h=setTimeout(function(){b(g+d)},500)}});return k});var oa=function(){return{tween:function(a,c,b,e,i){function g(p){var n=p-o;p=o+m<=p;for(var s=h;s--;){k[s]=j(n,a[s],d[s],m);i&&i.invalidate()}if(p||l){Ca.detach(g);for(s=0;s<f.length;s++)f[s]&&f[s](k,n,l)}}b=L({easing:"sine.out",duration:1E3,complete:null},
b);var h=a.length,k=[].concat(a),f=[e,b.complete],j=Ib(b.easing),d=[],l=false,m=b.duration,o=(new Date).getTime();for(b=h;b--;)d[b]=c[b]-a[b];Ca.attach(g);return function(p){l=p;return k}},tweenDrawable:function(a,c,b,e,i){var g=oa.tween([b],[e],i,function(){a[c]=e;for(var k=a.tweens.length;k--;)if(a.tweens[k]===h){a.tweens.splice(k,1);break}},a.view),h=function(){a[c]=g()[0]};return h}}}(),Ba=function(a,c,b){b=L({style:null,xy:null,size:20,fill:false,stroke:true,draggable:false,observable:true,properties:{},
typeName:"Shape"},b);L(this,b);if(R(this.xy,ra))this.xy=new a.XY(this.xy);this.id="drawable_"+Tb++;this.bounds=null;this.view=a;this.layer=c;this.tweens=[];this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&la(this)};Ba.prototype={constructor:Ba,applyTweens:function(){for(var a=this.tweens.length;a--;)this.tweens[a]()},drag:null,draw:null,getProps:null,resync:function(){if(this.xy){this.xy.sync(this.view);if(this.size){var a=this.size>>1;this.updateBounds(new ta(this.xy.x-
a,this.xy.y-a,this.size,this.size))}}},rotate:function(a,c,b){if(R(a,va)){a=(b?a:this.rotation*ja+a)*ca;if(c)this.tweens.push(oa.tweenDrawable(this,"rotation",this.rotation,a,c));else{this.rotation=a;this.view.invalidate()}return this}else return this.rotation*ja},scale:function(a,c,b){if(R(a,va)){a=b?a:this.scaling*a;if(c)this.tweens.push(oa.tweenDrawable(this,"scaling",this.scaling,a,c));else{this.scaling=a;this.view.invalidate()}return this}else return this.scaling},translate:function(a,c,b,e){if(R(a,
va)){a=e?a:this.translateX+a;c=e?c:this.translateY+c;if(b){this.tweens.push(oa.tweenDrawable(this,"translateX",this.translateX,a,b));this.tweens.push(oa.tweenDrawable(this,"translateY",this.translateY,c,b))}else{this.translateX=a;this.translateY=c;this.view.invalidate()}return this}else return new ha(this.translateX,this.translateY)},updateBounds:function(a,c){a&&(!this.bounds||a.x!=this.bounds.x||a.y!=this.bounds.y)&&this.trigger("move",this,a,this.bounds);this.bounds=a;if(c)this.xy=this.bounds.center()}};
aa("drawable","marker",function(a,c,b){b=L({fill:true,stroke:false,markerStyle:"simple",hoverStyle:"highlight",typeName:"Marker"},b);return new Ba(a,c,b)});aa("drawable","poly",function(a,c,b){function e(){var f,j,d,l,m,o,p,n;n=k.points=b.simplify?pb(h):h;for(f=n.length;f--;){j=n[f].x;d=n[f].y;o=R(o,ua)||j<o?j:o;p=R(p,ua)||d<p?d:p;l=R(l,ua)||j>l?j:l;m=R(m,ua)||d>m?d:m}k.updateBounds(new ta(o,p,l-o,m-p),true)}function i(f){if(R(f,sb)){h=[];Ab.process(f,function(j,d){for(var l=0;l<d;l++)h[h.length]=
new a.XY(j[l])},g)}}function g(){h.length&&Ab.process(h,function(f,j){for(var d=j;d--;)f[d].sync(a)},e)}b=L({simplify:false,fill:true,points:[],typeName:"Poly"},b);var h=[],k=L(new Ba(a,c,b),{points:[],getPoints:function(){return[].concat(h)},resync:g});ub(k,b,{points:i});i(b.points);return k});aa("drawable","line",function(a,c,b){b.fill=false;return wa("drawable","poly",a,c,b)});aa("drawable","image",function(a,c,b){function e(){if(f&&f.width>0){if(!this.centerOffset)this.centerOffset=new ha(-f.width>>
1,-f.height>>1);this.updateBounds(new ta(this.xy.x+this.centerOffset.x,this.xy.y+this.centerOffset.y,f.width,f.height),false)}}function i(d){if(this.imageUrl=d){var l=this;Wa(this.imageUrl,function(m,o){f=m;if(o){var p=j.layer?j.layer.view:null;p&&p.invalidate()}e.apply(l)})}}b=L({image:null,imageUrl:null,centerOffset:null,typeName:"Image"},b);var g=Ba.prototype.resync,h=0,k=0,f=b.image,j=L(new Ba(a,c,b),{changeImage:i,getProps:function(){this.bounds||e(this,f);return{image:f,x:this.xy.x+h,y:this.xy.y+
k}},resync:function(d){g.call(this,d);e.call(this)}});f||i.call(this,this.imageUrl);if(this.centerOffset){h=this.centerOffset.x;k=this.centerOffset.y}});aa("drawable","arc",function(a,c,b){b=L({startAngle:0,endAngle:Math.PI*2,typeName:"Arc"},b);return new Ba(a,c,b)});Oa.prototype={constructor:Oa,clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){this.view.trigger("layerRemove",this)}};aa("layer","tile",function(a,c){c=L({generator:"osm",imageLoadArgs:{}},c);var b=wa("generator",
c.generator,c).run,e=null,i=[],g=L(new Oa(a,c),{draw:function(h,k,f){h.drawTiles&&h.drawTiles(k,e.search(k.buffer(128)),f.panSpeed<2)}});a.bind("resync",function(){var h=a&&a.zoom?a.zoom():0;i[h]||(i[h]=qb(h));e=i[h]});a.bind("refresh",function(h,k,f){e&&b(k,f,e,function(){k.invalidate()})});return g});aa("layer","draw",function(a,c){function b(j,d,l,m){var o=this.dragOffset;if(!o)o=this.dragOffset=new a.XY(j.startX-this.xy.x,j.startY-this.xy.y);this.xy.x=d-o.x;this.xy.y=l-o.y;if(m){delete this.dragOffset;
a.invalidate();this.xy.sync(a,true);this.trigger("dragDrop")}return true}function e(j){clearTimeout(k);k=setTimeout(function(){g.sort(function(d,l){if(l.xy&&d.xy){var m=l.xy.y-d.xy.y;return m!=0?m:l.xy.x-d.xy.x}});j&&j.invalidate()},50)}function i(j,d,l,m){m&&h.remove(m,d);h.insert(l,d)}c=L({zindex:10},c);var g=[],h,k=0,f=L(new Oa(a,c),{itemCount:0,clear:function(){h=new rb;g=[];f.trigger("cleared");f.itemCount=0;a.invalidate()},create:function(j,d,l){d=wa("drawable",j,a,f,d);if(!d)throw Pb(j);if(l)g.unshift(d);
else g[g.length]=d;d.resync();h&&d.bounds&&h.insert(d.bounds,d);e(a);d.bind("move",i);f.itemCount=g.length;f.trigger(j+"Added",d);return d},draw:function(j,d,l,m,o){l={};m=h&&d?h.search(d):[];for(var p=m.length;p--;){var n=m[p],s=n.style||f.style,r,u,D=n.getProps?n.getProps(j):l;r=j["prep"+n.typeName];n.tweens.length>0&&n.applyTweens();u=j.applyTransform(n);if(D=r?r.call(j,n,d,o,D):null){if(o&&D.hit){o.elements.push(Hits.initHit(n.type,n,n.draggable?b:null));r=o.type+"Style";s=n[r]||f[r]||s}s=s?j.applyStyle(s,
true):null;(r=n.draw||D.draw)&&r.call(n,D);s&&j.applyStyle(s)}u&&u.undo&&u.undo()}},find:function(){return[].concat(g)},hitGuess:function(j,d){return h&&h.search({x:j-10,y:d-10,w:20,h:20}).length>0}});a.bind("resync",function(){h=qb(a.zoom(),h);for(var j=g.length;j--;)g[j].resync()});return f});Pa.prototype={constructor:Pa};aa("control","zoombar",function(a,c,b,e){function i(t,w){var E=D[t]=V.create("div","t5-zoombar-button",{position:"absolute",background:g(t),"z-index":51,width:e.width+"px",height:e.buttonHeight+
"px","margin-top":(w||0)+"px"});B.appendChild(E)}function g(t,w){return"url("+e.images+") 0 -"+(l+o*3+(t||0)*j*3+(w||0)*j)+"px"}function h(t){return"url("+e.images+") 0 -"+(l+(t||0)*o)+"px"}function k(t,w){var E;if(t===m){m.style.background=h(w);E="thumb"}else for(var C=0;C<D.length;C++)if(t===D[C]){E="button"+C;D[C].style.background=g(C,w);break}return E}function f(t){if(t!==r){r=t;s=n-r/u*(n-p)|0;V.move(m,0,s-p);clearTimeout(q);q=setTimeout(function(){a.zoom(r)},500)}}e=L({width:24,height:200,images:"img/zoom.png",
align:"right",marginTop:10,spacing:10,thumbHeight:16,buttonHeight:16},e);var j=e.buttonHeight,d,l=e.height,m,o=e.thumbHeight,p=e.spacing+j-(o>>1),n=e.height-j-(o>>1),s=p,r=-1;c=a.minZoom();var u=a.maxZoom()-c+1,D=[],B,q=0,z={button0:function(){a.zoom(a.zoom()+1)},button1:function(){a.zoom(a.zoom()-1)}};B=V.create("div","t5-zoombar",{position:"absolute",background:"url("+e.images+")","z-index":50,overflow:"hidden",width:e.width+"px",height:e.height+"px",margin:function(){var t=e.spacing,w=pa("{0}px 0 0 {1}px");
if(e.align==="right")t=b.offsetWidth-e.width-e.spacing;return w(e.marginTop,t)}()});b.childNodes[0]?b.insertBefore(B,b.childNodes[0]):b.appendChild(B);B.appendChild(m=V.create("div","t5-zoombar-thumb",{position:"absolute",background:h(),"z-index":51,width:e.width+"px",height:e.thumbHeight+"px",margin:"10px 0 0 0",top:s-p+"px"}));i(0);i(1,e.height-e.buttonHeight);d=INTERACT.watch(B,{bindTarget:B});d.bind("pointerMove",function(t,w,E){s=Math.min(Math.max(p,E.y-(o>>1)),n);f(u-(s-p)/n*u|0)});d.bind("pointerDown",
function(t){k(t.target,2)});d.bind("pointerUp",function(t){k(t.target,0)});d.bind("tap",function(t){(t=z[k(t.target,2)])&&t()});c=new Pa(a);c.bind("detach",function(){d.unbind();b.removeChild(B)});a.bind("zoom",function(t,w){f(w)});f(a.zoom());return c});ga.prototype={constructor:ga,distanceTo:function(){if(!targetPos||this.empty()||targetPos.empty())return 0;var a=(targetPos.lat-this.lat)*ca>>1,c=(targetPos.lon-this.lon)*ca>>1;a=qa(a)*qa(a)+Ua(this.lat*ca)*Ua(targetPos.lat*ca)*qa(c)*qa(c);return 6371*
2*Rb(yb(a),yb(1-a))},equalTo:function(a){return pos&&this.lat===a.lat&&this.lon===a.lon},empty:function(){return this.lat===0&&this.lon===0},inArray:function(a){for(var c=a.length;c--;)if(this.equal(a[c]))return true;return false},offset:function(a,c){var b=this.lat*ca,e=this.lon*ca,i=b+a/6371;b=zb(qa(c/6371)/Ua(b));e=e+b;i=(i+Na)%Math.PI-Na;e%=$;return new ga(i*ja,e*ja)},toPixels:function(){return Va(this.lon,this.lat)},toBounds:function(a){var c=a/6371,b=this.lat*ca,e=this.lon*ca;a=b-c;var i=b+
c;if(a>vb&&i<eb){b=zb(qa(c)/Ua(b));c=e-b;if(c<Qb)c+=$;e=e+b;if(e>wb)e-=$}else{a=Ha(a,vb);i=Ta(i,eb);c=tb;e=Qa}return new Ga(new ga(a*ja,c*ja),new ga(i*ja,e*ja))},toString:function(a){return this.lat+(a||" ")+this.lon}};(function(){aa("fn","generalize",function(a,c,b){var e=a.length,i=[],g=null;b=(b||250)/1E3;for(e=e;e--;)if(e===0)i.unshift(a[e]);else{var h=!g||a[e].inArray(c)?b:g.distanceTo(a[e]);if(a[e]&&h>=b){i.unshift(a[e]);g=a[e]}}return i})})();Ga.prototype={constructor:Ga,bestZoomLevel:function(a){var c=
this.center();c=Ta(Ia(ia(c.lat)*0.05),db.length);var b=db[c],e=this.size();c=xb(Aa(db[3]*a.h/e.y)/Aa(2));a=xb(Aa(b*a.w/e.x)/Aa(2));return Ta(isNaN(c)?1E3:c,isNaN(a)?1E3:a)},center:function(){var a=this.size();return new ga(this.min.lat+(a.y>>1),this.min.lon+(a.x>>1))},expand:function(a){this.min.lat-=a;this.max.lat+=a;this.min.lon-=a%360;this.max.lon+=a%360},size:function(a){var c=new ha(0,this.max.lat-this.min.lat);c.x=(a||R(a,ua))&&this.min.lon>this.max.lon?360-this.min.lon+this.max.lon:this.max.lon-
this.min.lon;return c},toString:function(){return"min: "+this.min+", max: "+this.max}};var G={ex:L,log:Z,observable:la,formatter:pa,wordExists:function(a,c){for(var b=a.split(/\s|\,/).length;b--;)if(a.toLowerCase()==c.toLowerCase())return true;return false},is:R,indexOf:cb,fn:function(a){return Sb("fn",a)},project:Va,unproject:fb,userMessage:function(a,c,b){G.trigger("userMessage",a,c,b)},Registry:Sa,Style:Bb,DOM:V,Rect:ta,XY:ha,Hits:Hits,Control:Pa,Tile:$a,Tweener:oa,getImage:Wa,Pos:ga,BBox:Ga};
la(G);G.RouteTools=function(){function a(j){if(g.test(j))return"-slight";return""}function c(j,d){d.geometry&&j.layer("route","draw").create("line",{points:d.geometry,style:"waypoints",simplify:true})}function b(j){for(var d="unknown",l=e||k,m=0;m<l.length;m++){l[m].regex.lastIndex=-1;var o=l[m].regex.exec(j);if(o){d=l[m].customCheck?l[m].customCheck(j,o):l[m].turnType;break}}return d}var e=undefined,i=G.fn("generalize"),g=/bear/i,h=/right/i,k=function(){var j=[];j.push({regex:/continue/i,turnType:"continue"});
j.push({regex:/(take|bear|turn)(.*?)left/i,customCheck:function(d,l){return"turn-left"+a(l[1])}});j.push({regex:/(take|bear|turn)(.*?)right/i,customCheck:function(d,l){return"turn-right"+a(l[1])}});j.push({regex:/enter\s(roundabout|rotary)/i,turnType:"roundabout"});j.push({regex:/take.*?ramp/i,turnType:"ramp"});j.push({regex:/take.*?exit/i,turnType:"ramp-exit"});j.push({regex:/make(.*?)u\-turn/i,customCheck:function(d,l){return"uturn"+(h.test(l[1])?"-right":"-left")}});j.push({regex:/proceed/i,turnType:"start"});
j.push({regex:/arrive/i,turnType:"arrive"});j.push({regex:/fell\sthrough/i,turnType:"merge"});return j}(),f={calculate:function(j){j=L({engineId:"",waypoints:[],map:null,error:null,autoFit:true,success:null,generalize:false},j);var d=G.Registry.create("service","routing");d&&d.calculate(j,function(l){if(j.generalize)l.geometry=i(l.geometry,l.getInstructionPositions());if(j.map){c(j.map,l);j.autoFit&&j.map.bounds(l.boundingBox)}j.success&&j.success(l)})},createMapOverlay:c,parseTurnType:b,Instruction:function(j){var d=
j=L({position:null,description:"",distance:0,distanceTotal:0,time:0,timeTotal:0,turnType:null},j),l=j.description;l=l.replace(/(\w)(\/)(\w)/g,"$1 $2 $3");d.description=l;if(!j.turnType)j.turnType=b(j.description);return j},RouteData:function(j){j=L({geometry:[],instructions:[],boundingBox:null},j);if(!j.boundingBox)j.boundingBox=new G.BBox(j.geometry);return L({getInstructionPositions:function(){for(var d=[],l=0;l<j.instructions.length;l++)j.instructions[l].position&&d.push(j.instructions[l].position);
return d}},j)}};G.observable(f);return f}();COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var a=arguments[0]||{},c,b=1,e=arguments.length;b<e;b++)if((c=arguments[b])!==null)for(var i in c){var g=c[i];if(a!==g)if(g!==undefined)a[i]=g}return a};(function(){var a=/^P(\d+Y)?(\d+M)?(\d+D)?$/,c=/^(\d+H)?(\d+M)?(\d+S)?$/,b={8601:function(i){i=i.split("T");var g=null;g=null;var h=0,k=0;a.lastIndex=-1;g=a.exec(i[0]);h+=g[3]?parseInt(g[3].slice(0,-1),10):0;c.lastIndex=-1;g=c.exec(i[1]);k+=g[1]?
parseInt(g[1].slice(0,-1),10)*3600:0;k+=g[2]?parseInt(g[2].slice(0,-1),10)*60:0;k+=g[3]?parseInt(g[3].slice(0,-1),10):0;return new e(h,k)}},e=COG.Duration=function(i,g){return{days:i?i:0,seconds:g?g:0}};COG.addDuration=function(){for(var i=new e,g=arguments.length;g--;){i.days+=arguments[g].days;i.seconds+=arguments[g].seconds}if(i.seconds>=86400){i.days+=~~(i.seconds/86400);i.seconds%=86400}return i};COG.formatDuration=function(i){var g,h,k="";if(i.days)k=i.days+" days ";if(i.seconds){i=i.seconds;
if(i>=3600){g=~~(i/3600);i-=g*3600}if(i>=60){h=Math.round(i/60);i-=h*60}if(g)k=k+g+(g>1?" hrs ":" hr ")+(h?(h>10?h:"0"+h)+" min ":"");else if(h)k=k+h+" min";else if(i>0)k=k+(i>10?i:"0"+i)+" sec"}return k};COG.parseDuration=function(i,g){var h=g?b[g]:null;if(h)return h(i);COG.Log.warn("Could not find duration parser for specified format: "+g);return new e}})();G.Decarta=function(){function a(n){return f(g.clientName,g.clientPassword,g.sessionID,g.configuration,g.release,n)}function c(n,s){return j(n.maxResponses,
n.version,n.requestID,n.methodName,s)}function b(n,s){g.server||Z("No server configured for deCarta - we are going to have issues","warn");return d(g.server,n.requestID,escape(s))}function e(n,s){Nb(b(n,a(c(n,n.getRequestBody()))),function(r){var u=r.response.XLS.Response;if(u.numberOfResponses>0&&u[n.methodName+"Response"]){r=null;if(n.parseResponse)r=n.parseResponse(u[n.methodName+"Response"]);s&&s(r)}else Z("no responses from server: "+r.response,"error")})}function i(n,s){var r=new m({json:n.StreetAddress}),
u=new l({countryCode:n.countryCode});u.parse(n.Place);return new G.Geo.Address({streetDetails:r,location:u,country:n.countryCode?n.countryCode:"",postalCode:n.PostalCode?n.PostalCode:"",pos:s})}var g={sessionID:(new Date).getTime(),server:"",clientName:"",clientPassword:"",configuration:"",maxResponses:25,release:"4.4.2sp03",tileFormat:"PNG",fixedGrid:true,useCache:true,tileHosts:[],requestTimeout:3E4,geocoding:{countryCode:"US",language:"EN"}},h={DEFAULT:function(n){for(var s=["landmark","municipalitySubdivision",
"municipality","countrySubdivision"],r="",u=0;u<s.length;u++)if(n[s[u]])r+=n[s[u]]+" ";return r}},k=1,f=pa("<xls:XLS version='1' xls:lang='en' xmlns:xls='http://www.opengis.net/xls' rel='{4}' xmlns:gml='http://www.opengis.net/gml'><xls:RequestHeader clientName='{0}' clientPassword='{1}' sessionID='{2}' configuration='{3}' />{5}</xls:XLS>"),j=pa("<xls:Request maximumResponses='{0}' version='{1}' requestID='{2}' methodName='{3}Request'>{4}</xls:Request>"),d=pa("{0}/JSON?reqID={1}&chunkNo=1&numChunks=1&data={2}&responseFormat=JSON"),
l=function(n){n=G.ex({landmark:"",municipality:"",municipalitySubdivision:"",countrySubdivision:"",countryCode:""},n);var s=G.ex({calcMatchPercentage:function(r){var u=0;if(n.landmark&&n.landmarkSubType){if(G.wordExists(r,n.landmarkSubType)){u+=0.4;u+=G.wordExists(r,n.landmark)?0.6:0}}else{u+=G.wordExists(r,n.municipalitySubdivision)?0.8:0;if(u===0&&n.municipality)u+=G.wordExists(r,n.municipality)?0.7:0}if(n.countrySubdivision)u+=G.wordExists(r,n.countrySubdivision)?0.2:0;return u},getCountryCode:function(){if(n.countryCode)return n.countryCode.toUpperCase();
return""},parse:function(r){for(var u=0;r&&u<r.length;u++){var D=r[u].type?r[u].type.slice(0,1).toLowerCase()+r[u].type.slice(1):"";if(typeof n[D]!=="undefined"){n[D]=r[u].content;if(r[u].subType)n[D+"SubType"]=r[u].subType}}G.ex(s,n)},toString:function(){var r=h[s.getCountryCode()];if(!r)r=h.DEFAULT;return r(n)}},n);return s},m=function(n){n=G.ex({json:{}},n);var s="",r="";if(n.json.Street)s=n.json.Street.content?n.json.Street.content:n.json.Street;s=s&&s.replace?s.replace(/\/\d+$/,""):"";if(n.json.Building)if(n.json.Building.number)r=
n.json.Building.number;return{building:r,street:s,calcMatchPercentage:function(u){var D=0,B=G.Geo.A.normalize(u),q=G.Geo.A.normalize(s);if(n.json.Building)if(G.Geo.A.buildingMatch(u,n.json.Building.number.toString()))D+=0.2;if(B&&q&&G.wordExists(B,q))D+=0.8;return D},toString:function(){if(s)return(r?r+" ":"")+s;return""}}},o=function(){return{methodName:"",maxResponses:25,version:"1.0",requestID:k++,getRequestBody:function(){return""},parseResponse:function(n){return n}}},p=function(){return G.ex(new o,
{methodName:"RUOK",parseResponse:function(n){return{aliasCount:n.maxHostAliases,host:n.hostName}}})};G.Registry.register("generator","decarta",function(n){function s(D,B,q,z){if(D=D.zoom?D.zoom():0){var t=2<<D-1,w=t>>1,E=n.tileSize,C=(B.w/E|0)+1,F=(B.h/E|0)+1,K=(B.x/E|0)-w;B=t-(B.y/E|0)-w-F;var Q=q.search({x:(w+K)*E,y:(w+B*-1-F)*E,w:C*E,h:F*E});t={};var y;for(y=Q.length;y--;)t[Q[y].id]=true;for(Q=0;Q<=C;Q++)for(y=0;y<=F;y++){var M=K+Q,P=B+y-1,S=M+"_"+P;if(!t[S]){M=new G.Tile((w+K+Q)*E,(w+B*-1-y)*
E,u[Q%u.length]+"/openls/image-cache/TILE?LLMIN=0.0,0.0&LLMAX="+r[D]+"&CACHEABLE=true&DS=navteq-world&WIDTH=256&HEIGHT=256&CLIENTNAME="+g.clientName+"&SESSIONID="+g.sessionID+"&FORMAT=PNG&CONFIG="+g.configuration+"&N="+P+"&E="+M,E,E,S);q.insert(M,M)}}z&&z()}}n=G.ex({tileSize:256},n);var r=["89.787438015348100000,360.00000000000000000","85.084059050110410000,180.00000000000000000","66.653475896509040000,90.00000000000000000","41.170427238429790000,45.000000000000000000","22.076741328793200000,22.500000000000000000",
"11.251819676168665000,11.250000000000000000","5.653589942659626000,5.625000000000000000","2.830287664051185000,2.812500000000000000","1.415581451872543800,1.406250000000000000","0.707845460801532700,0.703125000000000000","0.353929573271679340,0.351562500000000000","0.176965641673330230,0.175781250000000000","0.088482927761462040,0.087890625000000000","0.044241477246363230,0.043945312500000000","0.022120740293895182,0.021972656250000000","0.011060370355776452,0.010986328125000000","0.005530185203987857,0.005493164062500000",
"0.002765092605263539,0.002746582031250000","0.001382546303032519,0.001373291015625000","0.000691272945568983,0.000686645507812500","0.000345636472797214,0.000343322753906250"],u=null;G.userMessage("ack","decarta","&copy; deCarta, Inc. Map and Imagery Data &copy; NAVTEQ or Tele Atlas or DigitalGlobe");return{run:function(D,B,q,z){u?s(D,B,q,z):e(new p,function(t){u=[];if(t.aliasCount)for(var w=0;w<t.aliasCount;w++)u[w]="http://"+t.host.replace("^(.*?).(.*)$","\u0001-0"+(w+1)+".\u0002");else u=["http://"+
t.host];s(D,B,q,z)})}}});G.Registry.register("service","geocoder",function(){var n=function(r){function u(q){var z=[],t=q?q.numberOfGeocodedAddresses:0,w=[];if(t>1)w=q.GeocodedAddress;else if(t==1)w=[q.GeocodedAddress];try{for(q=0;w&&q<w.length;q++){var E,C=w[q],F=t=null;if(C&&C.GeocodeMatchCode&&C.GeocodeMatchCode.matchType!=="NO_MATCH"){if(C&&C.Point)F=new G.Pos(C.Point.pos);if(C&&C.Address)t=i(C.Address,F)}(E=t)&&z.push(E)}}catch(K){Z(K,"error")}return z}r=G.ex({addresses:[],parserReport:false,
parseOnly:false,returnSpatialKeys:false},r);var D=pa('<xls:GeocodeRequest parserReport="{0}" parseOnly="{1}" returnSpatialKeys="{2}">'),B=new o;return G.ex({},B,{methodName:"Geocode",getRequestBody:function(){for(var q=D(r.parserReport,r.parseOnly,r.returnSpatialKeys),z=0;z<r.addresses.length;z++)q+=r.addresses[z].getXML();return q+"</xls:GeocodeRequest>"},parseResponse:function(q){if(r.addresses.length===1)return[u(q.GeocodeResponseList)];else{for(var z=[],t=0;t<r.addresses.length;t++)z.push(u(q.GeocodeResponseList[t]));
return z}}})},s=function(r){r=G.ex({position:null,geocodePreference:"StreetAddress"},r);return G.ex(new o,{methodName:"ReverseGeocode",getRequestBody:function(){return"<xls:ReverseGeocodeRequest><xls:Position><gml:Point><gml:pos>"+r.position.toString()+"</gml:pos></gml:Point></xls:Position><xls:ReverseGeocodePreference>"+r.geocodePreference+"</xls:ReverseGeocodePreference></xls:ReverseGeocodeRequest>"},parseResponse:function(u){var D=null;if(u&&u.Point)D=new G.Pos(match.Point.pos);if(u&&u.ReverseGeocodedLocation&&
u.ReverseGeocodedLocation.Address)return i(u.ReverseGeocodedLocation.Address,D);return null}})};return{forward:function(r){r=G.ex({addresses:[],complete:null},r);var u,D=[];if(r.addresses&&!G.is(r.addresses,"array"))r.addresses=[r.addresses];for(u=0;u<r.addresses.length;u++)G.is(r.addresses[u],"object")?Z("attempting to geocode a simple object - not implemented","warn"):D.push(new types.Address({freeform:r.addresses[u]}));if(D.length>0){D=new n({addresses:D});e(D,function(B){if(r.complete)for(u=0;u<
B.length;u++)r.complete(r.addresses[u],B[u])})}},reverse:function(r){r=G.ex({position:null,complete:null},r);if(!r.position)throw Error("Cannot reverse geocode without a position");var u=new s(r);e(u,function(D){r.complete&&r.complete(D)})}}});G.Registry.register("service","routing",function(){var n=function(s){s=G.ex({waypoints:[],provideRouteHandle:false,distanceUnit:"KM",routeQueryType:"RMAN",routePreference:"Fastest",routeInstructions:true,routeGeometry:true},s);var r=new o,u=G.formatter('<xls:DetermineRouteRequest provideRouteHandle="{0}" distanceUnit="{1}" routeQueryType="{2}">'),
D=G.formatter("<xls:{0}><xls:Position><gml:Point><gml:pos>{1}</gml:pos></gml:Point></xls:Position></xls:{0}>");return G.ex({},r,{methodName:"DetermineRoute",getRequestBody:function(){if(s.waypoints.length<2)throw Error("Cannot send RouteRequest, less than 2 waypoints specified");var B=u(s.provideRouteHandle,s.distanceUnit,s.routeQueryType);B+="<xls:RoutePlan>";B+="<xls:RoutePreference>"+s.routePreference+"</xls:RoutePreference>";B+="<xls:WayPointList>";for(var q=0;q<s.waypoints.length;q++)B+=D(q===
0?"StartPoint":q===s.waypoints.length-1?"EndPoint":"ViaPoint",s.waypoints[q].toString());B+="</xls:WayPointList>";B+="</xls:RoutePlan>";if(s.routeInstructions)B+='<xls:RouteInstructionsRequest rules="maneuver-rules" providePoint="true" />';if(s.routeGeometry)B+="<xls:RouteGeometryRequest />";B+="</xls:DetermineRouteRequest>";return B},parseResponse:function(B){var q=G.RouteTools.RouteData,z=B.RouteGeometry.LineString.pos,t=z.length,w=Array(t);for(t=t;t--;)w[t]=new ga(z[t]);z=B.RouteInstructionsList;
B=[];z=z&&z.RouteInstruction?z.RouteInstruction:[];t=0;for(var E=new COG.Duration,C=0;C<z.length;C++){var F;F=z[C].distance;var K={M:1,KM:1E3}[F.uom?F.uom.toUpperCase():"M"];F=F.value&&K?F.value*K:0;K=COG.parseDuration(z[C].duration,"8601");t+=F;E=COG.addDuration(E,K);B.push(new G.RouteTools.Instruction({position:new G.Pos(z[C].Point),description:z[C].Instruction,distance:F,distanceTotal:t,time:K,timeTotal:E}))}return new q({geometry:w,instructions:B})}})};return{calculate:function(s,r){s=G.ex({waypoints:[]},
s);if(typeof G.RouteTools!=="undefined"){var u=new n(s);e(u,function(D){r&&r(D)})}else Z("Could not generate route, T5.RouteTools plugin not found","warn")}}});return{applyConfig:function(n){G.ex(g,n)},compareFns:function(){return{streetDetails:function(n,s){return s.calcMatchPercentage(n)},location:function(n,s){return s.calcMatchPercentage(n)}}}()}}();mb.T5=G;mb.Tile5=function(a,c){c=L({container:a,type:"map",renderer:"canvas",starpos:null,zoom:1,fastpan:false,drawOnScale:true,zoombar:{}},c);return wa("view",
c.type,c)}})(window);
