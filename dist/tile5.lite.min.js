COG=function(){var i=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,j=0,f={id:"grunt.core",extend:function(){var a=arguments[0]||{},d=1,e=arguments.length,b=false,k,c,g,h;if(typeof a==="boolean"){b=a;a=arguments[1]||{};d=2}if(typeof a!=="object"&&!f.isFunction(a))a={};if(e===d){a=this;--d}for(;d<e;d++)if((k=arguments[d])!=null)for(c in k){g=a[c];h=k[c];if(a!==h)if(b&&h&&(f.isPlainObject(h)||f.isArray(h))){g=g&&(f.isPlainObject(g)||f.isArray(g))?g:f.isArray(h)?[]:{};a[c]=f.extend(b,g,h)}else if(h!==
undefined)a[c]=h}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var d;for(d in a);return d===undefined||m.call(a,d)},isEmptyObject:function(a){for(var d in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,d){var e=a,b=arguments,k=1;if(d&&f.isArray(d)){b=d;k=0}for(k=k;k<b;k++)e=e&&typeof foo[b[k]]!=="undefined";return e},newModule:function(a){a=f.extend({id:null,requires:[],parent:null},a);if(a.parent)a=f.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+j++},formatStr:function(a){if(arguments.length<=1)return a;for(var d=arguments.length-2,e=0;e<=d;e++)a=a.replace(RegExp("\\{"+e+"\\}","gi"),arguments[e+
1]);return a},wordExists:function(a,d){var e="";if(d.toString)d=d.toString();for(var b=0;b<d.length;b++)e+=!/\w/.test(d[b])?"\\"+d[b]:d[b];return RegExp("(^|\\s|\\,)"+e+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,d){for(var e=i.exec(a);e;){a=a.replace(e[0],COG.XPath.first(e[1],d));i.lastIndex=0;e=i.exec(a)}return a}};return f}();
COG.Log=function(){function i(d,e){var b,k=e&&e.length>0?e[0]:"";for(b=1;e&&b<e.length;b++)k+=" "+(j&&COG.isPlainObject(e[b])?JSON.stringify(e[b]):e[b]);typeof console!=="undefined"&&console[d](k);for(b=0;b<m.length;b++)m[b].call(a,k,d)}var m=[],j=typeof JSON!=="undefined",f=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return f?(new Date).getTime():null},trace:function(d,e){if(f)console.markTimeline(d+(e?": "+(a.getTraceTicks()-e)+"ms":""))},debug:function(){i("debug",
arguments)},info:function(){i("info",arguments)},warn:function(){i("warn",arguments)},error:function(){i("error",arguments)},exception:function(d){a.error(arguments);for(var e in d)a.info("ERROR DETAIL: "+e+": "+d[e])},watch:function(d,e){try{e()}catch(b){a.exception(b,d)}},throwError:function(d){a.error(d);throw Error(d);},requestUpdates:function(d){m.push(d)}};return a}();
(function(){function i(f,a){f[a]||(f[a]=function(d){return f.configure(a,d)})}function m(f){f.gtConfId=COG.objId("configurable");f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var j={};COG.paramTweaker=function(f,a,d){return function(e,b){if(typeof b!=="undefined"){if(e in f)f[e]=b;d&&e in d&&d[e](e,b)}else return a&&e in a?a[e](e):f[e]}};COG.configurable=function(f,a,d,e){if(f){f.gtConfId||m(f);var b=f.gtConfId,k=f.gtConfig,c=f.gtConfigFns;j[b]=f;c.push(d);for(d=a.length;d--;){k[a[d]]=true;e&&
i(f,a[d])}if(!f.configure)f.configure=function(g,h){if(k[g]){for(var l=c.length;l--;){var n=c[l](g,h);if(typeof n!=="undefined")return n}return j[b]}return null}}}})();
(function(){function i(m,j){var f=m.gtObsHandlers;f[j]||(f[j]=[]);return f[j]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(j,f){var a=COG.objId("callback");i(m,j).unshift({fn:f,id:a});return a};m.trigger=function(j){var f=i(m,j),a={cancel:false,tickCount:(new Date).getTime()},d;if(!f)return null;d=Array.prototype.slice.call(arguments,1);d.unshift(a);for(var e=f.length;e--&&!a.cancel;)f[e].fn.apply(self,d);return a};m.unbind=
function(j,f){for(var a=i(m,j),d=0;a&&d<a.length;d++)if(a[d].id===f){a.splice(d,1);break}return m}}}}})();(function(){var i={},m=[];COG.addPipe=function(j){j("pipe.test",{});m.push(j)};COG.listen=function(j,f){i[j]||(i[j]=[]);f&&i[j].push(f)};COG.say=function(j,f){var a;for(a=m.length;a--;)m[a](j,f);if(i[j])for(a=i[j].length;a--;)i[j][a](f)}})();
COG.Loopage=function(){function i(h){return COG.extend({id:d++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},h)}function m(h){b.push(h);j()}function j(){k&&clearTimeout(k);k=setTimeout(f,0);g=true}function f(){for(var h,l=(new Date).getTime(),n=e.length;b.length>0;){var v=b.shift();for(h=n;h--;)if(e[h].id===v){e.splice(h,1);break}g=true;n=e.length}if(g){c=a;for(h=n;h--;)c=e[h].frequency<c?e[h].frequency:c}for(h=n;h--;){v=l-e[h].lastTick;if(e[h].lastTick===0||v>=e[h].frequency){e[h].execute(l,
e[h]);e[h].lastTick=l;e[h].single&&e[h].trigger("complete")}}k=n?setTimeout(f,c):0}var a=6E4,d=0,e=[],b=[],k=0,c=a,g=true;return{join:function(h){var l=new i(h);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});e.unshift(l);j();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function i(c){return c<10?"0"+c:c}function m(c){a.lastIndex=0;return a.test(c)?'"'+c.replace(a,function(g){var h=b[g];return typeof h==="string"?h:"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+c+'"'}function j(c,g){var h,l,n,v,x=d,o,p=g[c];if(p&&typeof p==="object"&&typeof p.toJSON==="function")p=p.toJSON(c);if(typeof k==="function")p=k.call(g,c,p);switch(typeof p){case "string":return m(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";d+=e;o=[];if(Object.prototype.toString.apply(p)==="[object Array]"){v=p.length;for(h=0;h<v;h+=1)o[h]=j(h,p)||"null";n=o.length===0?"[]":d?"[\n"+d+o.join(",\n"+d)+"\n"+x+"]":"["+o.join(",")+"]";d=x;return n}if(k&&typeof k==="object"){v=k.length;for(h=0;h<v;h+=1){l=k[h];if(typeof l==="string")if(n=j(l,p))o.push(m(l)+(d?": ":":")+n)}}else for(l in p)if(Object.hasOwnProperty.call(p,l))if(n=j(l,p))o.push(m(l)+(d?": ":":")+n);n=o.length===0?"{}":d?"{\n"+d+o.join(",\n"+d)+
"\n"+x+"}":"{"+o.join(",")+"}";d=x;return n}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,e,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(c,g,h){var l;e=d="";if(typeof h==="number")for(l=0;l<h;l+=1)e+=" ";else if(typeof h==="string")e=h;if((k=g)&&typeof g!=="function"&&(typeof g!=="object"||typeof g.length!=="number"))throw Error("JSON.stringify");return j("",
{"":c})};if(typeof JSON.parse!=="function")JSON.parse=function(c,g){function h(n,v){var x,o,p=n[v];if(p&&typeof p==="object")for(x in p)if(Object.hasOwnProperty.call(p,x)){o=h(p,x);if(o!==undefined)p[x]=o;else delete p[x]}return g.call(n,v,p)}var l;c=String(c);f.lastIndex=0;if(f.test(c))c=c.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+c+")");return typeof g==="function"?h({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function i(j,f){var a=j.split("|"),d={};for(var e in f){var b=f[e];d[e]=a.length>b?a[b]:null}return d}var m={JSON:{parse:function(j){return JSON.parse(j)}},PDON:{parse:function(j){var f=null,a=[];j=j.split("\n");for(var d=0;d<j.length;d++){var e=j[d];if(f)a.push(i(e,f));else if(e){f=e.split("|");e={};for(var b=0;b<f.length;b++)e[f[b]]=b;f=e}else f=null}return a}}};COG.parseData=function(j,f){f=f?f.toUpperCase():"JSON";if(!m[f])throw Error("Unsupported data format: "+f);try{return m[f].parse(j)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function i(a){for(var d=null,e=0;e<m.length;e++)if(d=m[e](a))break;return d}var m=[],j=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var f={SearchResult:function(a){return{toString:function(){var d=
null;if(a){var e=null;if(a.resultType>=0&&a.resultType<j.length)e=j[a.resultType];if(e)d=e(a)}return d?d:""}}},first:function(a,d){var e=f.SearchResult,b;var k=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!k)k=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(d))b=d.evaluate(a,d,i,k,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(c){COG.Log.warn("invalid xpath expression: "+a+" on node: "+d);b=null}return new e(b)},registerResolver:function(a){m.push(a)}};return f}();
COG.Storage=function(){function i(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,j){var f=i(j).getItem(m);return/^(\{|\[).*(\}|\])$/.test(f)?JSON.parse(f):f},set:function(m,j,f){j=jQuery.isArray(j)||jQuery.isPlainObject(j)?JSON.stringify(j):j;i(f).setItem(m,j)},remove:function(m,j){i(j).removeItem(m)}}}();
COG.ParseRules=function(){var i=[];return{add:function(m,j){i.push({regex:m,handler:j})},each:function(m,j,f){function a(){d++;f&&d>=i.length&&f(j)}for(var d=0,e=0;e<i.length;e++){var b=i[e].regex,k=i[e].handler,c=false;if(b){b.lastIndex=-1;if((b=b.exec(m))&&k){c=true;k(b,j,a)&&a()}}c||a()}}}};
(function(){function i(b){var k=[],c=function(h,l){l=COG.isFunction(l)?l():l;k[k.length]=encodeURIComponent(h)+"="+encodeURIComponent(l)};if(COG.isArray(b))for(var g=0;g<b.length;g++)c(b[g].name,b[g].value);else for(g in b)c(g,b[g]);return k.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},j={JSON:["json"],PDON:["pdon.txt"]},f=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,d={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},e={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function k(){if(this.readyState===4){var l=null,n=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(n)if(b.handleResponse)b.handleResponse(this);else{var v=b,x=this.getResponseHeader(e.CONTENT_TYPE),o,p=false;for(o in m)if(x&&x.indexOf(m[o])>=0){p=true;
break}x=!p;for(p=0;p<f.length;p++)x=x||f[p]==o;if(x)b:{x=o;for(var u in j)for(p=0;p<j[u].length;p++)if(RegExp(j[u][p]+"$","i").test(v.url)){o=u;break b}o=x?x:"DEFAULT"}try{l=d[o](this,v)}catch(z){l=d.DEFAULT(this,v)}}else b.error&&b.error(this)}catch(D){COG.Log.exception(D,"PROCESSING AJAX RESPONSE")}n&&l&&b.success&&b.success.call(this,l)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var c=
a.exec(b.url),g=c&&(c[1]&&c[1]!==location.protocol||c[2]!==location.host);if(b.data)b.method="POST";if(b.url){c=null;if(b.xhr)c=b.xhr(b);c||(c=new XMLHttpRequest);c.open(b.method,b.url,b.async);b.data&&c.setRequestHeader("Content-Type",b.contentType);g||c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.onreadystatechange=k;c.send(b.method=="POST"?i(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(h){COG.Log.exception(h)}}})();
(function(){function i(a){var d=document.createElement("script"),e=false;d.src=a;d.async=true;d.onload=d.onreadystatechange=function(){if(!e&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){e=true;d.onload=d.onreadystatechange=null;d&&d.parentNode&&d.parentNode.removeChild(d)}};j||(j=document.getElementsByTagName("head")[0]);j.appendChild(d)}var m=0,j,f=this;COG.jsonp=function(a,d,e){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++m;f[b]=function(k){d(k);f[b]=null;try{delete f[b]}catch(c){}};
i(a+(e?e:"callback")+"="+b);return b}})();
COG.Touch=function(){function i(t,y){return{x:t.x-y.x,y:t.y-y.y}}function m(t,y){var C=i(t,y);return Math.sqrt(C.x*C.x+C.y*C.y)}function j(t){if(t.count>1)return m(t.touches[0],t.touches[1]);return 0}function f(t,y){var C=t&&t.count>0?t.touches[0]:null;if(C&&y&&y.count>0)return i(C,y.touches[0]);return null}function a(t,y){t.count=y.count;for(var C=c;C--;){t.touches[C].x=y.touches[C].x;t.touches[C].y=y.touches[C].y}}function d(){for(var t={count:0,touches:Array(c)},y=c;y--;)t.touches[y]=k();return t}
function e(t){if(t.preventDefault){t.preventDefault();t.stopPropagation()}else t.cancelBubble&&t.cancelBubble()}function b(t,y,C){if(J){y=y[C?C:"touches"];C=y.length;for(C=t.count=C;C--;){t.touches[C].x=y[C].pageX;t.touches[C].y=y[C].pageY}}else if(y.button===0){t.count=1;t.touches[0].x=y.pageX?y.pageX:y.screenX;t.touches[0].y=y.pageY?y.pageY:y.screenY}else t.count=0}function k(t,y){return{x:t?t:0,y:y?y:0}}var c=10,g=120,h=100,l=250,n=300,v=5,x=0,o=1,p=2,u=7,z=0,D=0,J=undefined,G=function(t){function y(s,
w,B,Q){var da=Math.asin((s.y-w.y)/B);B=B*(la/Q)>>0;B=B>$?$:B;da=w.x>s.x?da:Math.PI-da;U("pan",Math.cos(da)*-B,Math.sin(da)*B,true)}function C(s,w){var B,Q;if(J){B=w-ma;if(B<l){Q=m(K.touches[0],s);Q>t.inertiaTrigger&&y(K.touches[0],s,Q,B)}}else{X.x=s.x;X.y=s.y;COG.Loopage.join({execute:function(da,H){B=da-w;Q=m(s,X);if(B<h&&Q>t.inertiaTrigger){H.trigger("complete");y(s,X,Q,B)}else B>h&&H.trigger("complete")},frequency:10})}}function V(s){var w=0,B=0;if(s.offsetParent){do{w+=s.offsetLeft;B+=s.offsetTop;
s=s.offsetParent}while(s)}return k(w,B)}function ha(s){var w=s.count,B=Array(w),Q=V(aa);for(w=w;w--;)B[w]=k(s.touches[w].x-Q.x,s.touches[w].y-Q.y);return B}function U(){oa&&oa.trigger.apply(null,arguments)}function ra(s,w){var B=V(aa);B=k(w.x-B.x,w.y-B.y);U(s,w,B)}function O(s){var w=s.target?s.target:s.srcElement;if(ga||w&&w===aa){b(K,s);if(K.count!==0){Y=null;S.x=0;S.y=0;ia=true;Z=false;ma=(new Date).getTime();e(s);w.style.cursor="move";U("inertiaCancel");sa=ma;if(s=K.count>0?K.touches[0]:null){U("touchStart",
s.x,s.y);if(sa-ua<n)if((s=i(K.touches[0],R.touches[0]))&&Math.abs(s.x)<t.maxDistDoubleTap&&Math.abs(s.y)<t.maxDistDoubleTap)Z=true;W=x;a(R,K)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function pa(s){var w=s.target?s.target:s.srcElement,B=0;if(ga||w&&w===aa){b(L,s);if(L.count>0){X.x=L.touches[0].x;X.y=L.touches[0].y}if(ia){J&&e(s);if(L.count>1){K.count===1&&a(K,L);B=j(K)-j(L)}if(W===x)if((s=f(L,K))&&(Math.abs(s.x)>=u||Math.abs(s.y)>=u))W=o;if(W!==x)if(!B||Math.abs(B)<v){if(Y=
f(L,R)){S.x-=Y.x;S.y-=Y.y;ea.x-=Y.x;ea.y-=Y.y}U("pan",ea.x,ea.y);ea.x=0;ea.y=0;W=o}else{U("pinchZoom",ha(K),ha(L));W=p}a(R,L)}}}function M(s){var w=s.target?s.target:s.srcElement;if(ia&&(ga||w&&w===aa)){b(va,s,"changedTouches");var B=va.touches[0];J&&e(s);s=(new Date).getTime();ua=sa;if(W===x){ra("tap",K.touches[0]);fa||(fa=setTimeout(function(){fa=0;Z&&ra("doubleTap",K.touches[0])},n+50))}else if(W==o){U("panEnd",S.x,S.y);na&&C(B,s)}else W==p&&U("pinchZoomEnd",ha(K),ha(R),s-ma);w.style.cursor="default";
ia=false}}function ja(s){var w=s.target?s.target:s.srcElement;if(ga||w&&w===aa){if(s.detail){w=-s.detail*g;w=k(s.axis===1?w:0,s.axis===2?w:0)}else w=k(s.wheelDeltaX,s.wheelDeltaY);var B=w.y!==0?Math.abs(w.y/g):0;if(X&&B!==0){var Q=k(X.x-aa.offsetLeft,X.y-aa.offsetTop);U("wheelZoom",Q,Math.pow(2,w.y>0?B:-B))}e(s)}}t=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,
tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},t);var Z=false,fa=0,ba=T5.getConfig(),K=d(),L=d(),R=d(),va=d(),Y=null,S=k(),ea=k(),W=null,ia=false,ma=0,E=[],X=k(),na=false,la,$,sa=0,ua=0,aa=t.element,oa=t.observable,ga=typeof FlashCanvas!=="undefined",ka={supportsTouch:J,addListeners:function(s){E.push(s)},decoupleListeners:function(s){for(var w=0;s&&w<E.length;w++)if(E[w].listenerId===s){E.splice(w,1);break}},release:function(){ba.unbindEvent(J?"touchstart":"mousedown",O,false);ba.unbindEvent(J?
"touchmove":"mousemove",pa,false);ba.unbindEvent(J?"touchend":"mouseup",M,false);if(!J){window.removeEventListener("mousewheel",ja,false);window.removeEventListener("DOMMouseScroll",ja,false)}},inertiaEnable:function(s,w){na=true;la=s;$=w?Math.min(w.width,w.height):500},inertiaDisable:function(){na=false}};if(typeof J==="undefined")J=T5.getConfig().supportsTouch;ba.bindEvent(J?"touchstart":"mousedown",O,false);ba.bindEvent(J?"touchmove":"mousemove",pa,false);ba.bindEvent(J?"touchend":"mouseup",M,
false);if(!J){ba.bindEvent("mousewheel",ja,window);ba.bindEvent("DOMMouseScroll",ja,window)}return ka},ca=[];return{capture:function(t,y){if(!t)throw Error("Unable to capture touch of null element");if(!t.id)t.id="touchable_"+z++;var C=ca[t.id];if(!C){C=new G(COG.extend({element:t},y));ca[t.id]=C}if(y){y.listenerId&&C.decoupleListeners(y.listenerId);y.listenerId=++D;C.addListeners(y)}return C},release:function(t){if(t&&t.id&&ca[t.id]){ca[t.id].release();delete ca[t.id]}}}}();
T5=function(){var i=function(){function a(b,k){return e(b.x-k.x,b.y-k.y)}function d(b,k){if(!k)k=b.length;if(k<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var c={edges:Array(k-1),accrued:Array(k-1),total:0},g=0;g<k-1;g++){var h=a(b[g],b[g+1]);c.edges[g]=Math.sqrt(h.x*h.x+h.y*h.y);c.accrued[g]=c.total+c.edges[g];c.total+=c.edges[g]}return c}function e(b,k){return{x:b?b:0,y:k?k:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,k=0,c=arguments.length;c--;){b+=arguments[c].x;k+=arguments[c].y}return e(b,k)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?e(b.x,b.y):null},diff:a,distance:function(b,k){return d(b,k).total},edges:d,equals:function(b,k){return b.x===k.x&&b.y===k.y},extendBy:function(b,k,c){return e(b.x-Math.cos(k)*c,b.y-Math.sin(k)*c)},floor:function(b){for(var k=Array(b.length),c=b.length;c--;)k[c]=e(~~b[c].x,~~b[c].y);return k},getRect:function(b){for(var k,c,g,
h,l=b.length;l--;){var n=b[l];k=typeof k==="undefined"||n.x<k?n.x:k;c=typeof c==="undefined"||n.y<c?n.y:c;g=typeof g==="undefined"||n.x>g?n.x:g;h=typeof h==="undefined"||n.y>h?n.y:h}return j.init(k,c,h,h)},init:e,invert:function(b){return e(-b.x,-b.y)},min:function(b,k){return e(b.x<k.x?b.x:k.x,b.y<k.y?b.y:k.y)},max:function(b,k){return e(b.x>k.x?b.x:k.x,b.y>k.y?b.y:k.y)},offset:function(b,k,c){return e(b.x+k,b.y+(c?c:k))},simplify:function(b,k){if(!b)return null;k=k?k:i.VECTOR_SIMPLIFICATION;for(var c=
[],g=null,h=b.length;h--;){var l=b[h];if(include=!g||h===0||Math.abs(l.x-g.x)+Math.abs(l.y-g.y)>k){c.unshift(l);g=l}}return c},theta:function(b,k,c){c=Math.asin((b.y-k.y)/c);return b.x>k.x?c:Math.PI-c}}}(),m=function(){return{dotProduct:function(a,d){return a.x*d.x+a.y*d.y}}}(),j=function(){function a(e){return d(e.x1,e.y1,e.x2,e.y2)}function d(e,b,k,c){e=e?e:0;b=b?b:0;k=typeof k!=="undefined"?k:e;c=typeof c!=="undefined "?c:c;return{x1:e,y1:b,x2:k,y2:c,width:k-e,height:c-b}}return{center:function(e){return i.init(e.x1+
e.width/2,e.y1+e.height/2)},copy:a,diagonalSize:function(e){return Math.sqrt(e.width*e.width+e.height*e.height)},fromCenter:function(e,b,k,c){k=~~(k/2);c=~~(c/2);return d(e-k,b-c,e+k,b+c)},init:d,intersect:function(e,b){var k=d(Math.max(e.x1,b.x1),Math.max(e.y1,b.y1),Math.min(e.x2,b.x2),Math.min(e.y2,b.y2));return k.width>0&&k.height>0?k:null},union:function(e,b){if(e.width===0||e.height===0)return a(b);else if(b.width===0||b.height===0)return a(e);else{var k=d(Math.min(e.x1,b.x1),Math.min(e.y1,b.y1),
Math.max(e.x2,b.x2),Math.max(e.y2,b.y2));return k.width>0&&k.height>0?k:null}}}}(),f=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return i.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,d){a=a?a:0;return{width:a,height:d?d:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:i,XYRect:j,Vector:function(a,d){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return i.init(a,d)},V:COG.extend(i,m),D:f}}();
(function(){function i(){for(;v.length>0;){var o=v.shift();document.location=o}n=0}function m(o){for(var p=true,u=x.length;u--;)p=p&&o!=x[u];return p}function j(o,p){var u=[];for(var z in p)z&&u.push(z+"="+escape(p[z]));return"tile5://"+o+"/"+(u.length>0?"?"+u.join("&"):"")}function f(o,p){m(o)&&COG.Log.info("would push url: "+j(o,p))}function a(o,p){if(m(o)){v.push(j(o,p));n||(n=setTimeout(i,100))}}function d(o){return function(p,u,z){(z?z:o?document.body:document).addEventListener(p,u,false)}}function e(o){return function(p,
u,z){(z?z:o?document.body:document).removeEventListener(p,u,false)}}function b(o,p,u){(u?u:document).attachEvent("on"+o,p)}function k(o,p,u){(u?u:document).detachEvent("on"+o,p)}function c(){g={base:{name:"Unknown",bindEvent:d(),unbindEvent:e(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:f,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:k,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:d(true),unbindEvent:e(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};h=[g.froyo,g.android,g.ipod,g.iphone,g.ipad,g.ie]}var g=null,h=[],l=null,n=0,v=[],x=["view.wake","tile.loaded"];T5.getConfig=function(){g||c();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var o=0;o<h.length;o++){var p=h[o];if(p.regex&&p.regex.test(navigator.userAgent)){l=T5.ex({},g.base,p);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=g.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var i=[],m={execute:function(j){var f=m.findAction(j);f&&f.execute.apply(f,Array.prototype.slice.call(arguments,1))},findAction:function(j){for(var f=i.length;f--;)if(i[f].id==j)return i[f];return null},getRegisteredActions:function(){return[].concat(i)},getRegisteredActionIds:function(){for(var j=[],f=i.length;f--;)i[f].id&&j.push(i[f].id);return j},registerAction:function(j){j&&j.id&&i.push(j)},Action:function(j){j=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},j);var f={id:j.id,execute:function(){j.execute&&j.execute.apply(this,arguments)},getParam:function(a){return j[a]?j[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",f.id,j.title,j.icon)}};j.autoRegister&&m.registerAction(f);return f},Agent:function(j){j=COG.extend({name:"Untitled",translator:null,execute:null},j);var f={getName:function(){return j.name},getParam:function(a){return j[a]},getId:function(){return COG.toID(f.getName())},run:function(a,d){if(j.execute){var e=
j.translator?j.translator(a):a;j.execute.call(f,e,function(b,k){d&&d(b,k,e)})}}};return f},runAgents:function(j,f,a){for(var d=0;d<j.length;d++)j[d].run(f,a)}};return m}();
T5.Resources=function(){var i="",m={},j={getPath:function(f){return/^(file|https?|\/)/.test(f)?f:i+f},setBasePath:function(f){i=f},loadResource:function(f){f=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},f);var a=function(d){f.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){f.callback(d)})};f.cacheable&&m[f.filename]?a(m[f.filename]):COG.xhr({url:j.getPath(f.filename),dataType:f.dataType,success:function(d){if(f.cacheable)m[f.filename]=d;a(d)},error:function(d,e,b){COG.Log.error("error loading resource ["+
f.filename+"], error = "+b)}})},loadSnippet:function(f,a){/\.\w+$/.test(f)||(f+=".html");j.loadResource({filename:"snippets/"+f,callback:a,dataType:"html"})}};return j}();
T5.Images=function(){function i(){if(!n){var o=T5.getConfig().maxImageLoads;n=COG.Loopage.join({execute:function(p,u){if(!o||g.length<o){var z=c.shift();if(z){g[g.length]=z;z.image.onload=j;z.image.src=T5.Resources.getPath(z.url);z.requested=T5.ticks()}else u.trigger("complete")}},frequency:10});n.bind("complete",function(){n=null})}}function m(){v=true;try{var o=h.length/2>>0;if(o>0){h.sort(function(u,z){return u.created-z.created});for(var p=o;p--;)delete d[h[p].url];h.splice(0,o)}}finally{v=false}COG.say("imagecache.cleared")}
function j(){var o=b[this.id],p;if(o&&o.image.complete&&o.image.width>0){o.loaded=true;o.hitCount=1;for(p=g.length;p--;)if(g[p].image.src==this.src){g.splice(p,1);break}if(o.background||o.postProcess||o.drawBackground||o.customDraw)if(o.image){globalImageData=o;p=a(o.realSize?o.realSize.width:o.image.width,o.realSize?o.realSize.height:o.image.height);var u=p.getContext("2d"),z=o.offset?o.offset:T5.XY.init();o.background&&u.drawImage(o.background,0,0);o.drawBackground&&o.drawBackground(u);o.customDraw?
o.customDraw(u,o):u.drawImage(o.image,z.x,z.y);o.postProcess&&o.postProcess(u,o);o.image=p}for(p=o.callbacks.length;p--;)o.callbacks[p]&&o.callbacks[p](this,false);o.callbacks=[];h[h.length]={url:this.src,created:o.requested};delete b[this.id];i()}}function f(o,p,u){var z=d[o];if(z){z.hitCount++;z.image.complete&&z.image.width>0&&p?p(z.image,true):z.callbacks.push(p)}else{z=T5.ex({url:o,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[p]},u);z.image.id="resourceLoaderImage"+
k++;d[o]=z;b[z.image.id]=z;c[c.length]=z;i()}return z}function a(o,p){var u=document.createElement("canvas");u.width=o?o:0;u.height=p?p:0;if(typeof FlashCanvas!=="undefined"){u.id="tmpCanvas"+e++;u.style.cssText="position: absolute; top: -"+(p-1)+"px; left: -"+(o-1)+"px;";document.body.appendChild(u);FlashCanvas.initElement(u)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(u);return u}var d={},e=0,b={},k=0,c=[],g=[],h=[],l=0,n=null,v=false,x={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){g=[]},get:function(o,p,u){var z=null,D=null;v||(z=d[o]);if((D=z?z.image:null)&&(D.getContext||D.complete&&D.width>0))return D;else p&&f(o,p,u);return null},load:f,newCanvas:a,reset:function(){d={}},stats:function(){return{imageLoadingCount:g.length,queuedImageCount:c.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(o){for(var p=false,u=0,z=T5.getConfig();u<g.length;)if(o-g[u].requested>x.loadTimeout*1E3){g.splice(u,1);p=true}else u++;p&&i();if(z&&z.imageCacheMaxSize){l=
h.length*x.avgImageSize/z.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return x}();T5.Generator=function(){var i={};return{init:function(m,j){var f=i[m];if(!f)throw Error("Unable to locate requested generator: "+m);return new f(j)},register:function(m,j){i[m]=j},Template:function(){}}}();
T5.TimeLord=function(){var i=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,j=function(a,d){return{days:a?a:0,seconds:d?d:0}},f={8601:function(a){a=a.split("T");var d=null;d=null;var e=0,b=0;i.lastIndex=-1;d=i.exec(a[0]);e+=d[3]?parseInt(d[3].slice(0,-1),10):0;m.lastIndex=-1;d=m.exec(a[1]);b+=d[1]?parseInt(d[1].slice(0,-1),10)*3600:0;b+=d[2]?parseInt(d[2].slice(0,-1),10)*60:0;b+=d[3]?parseInt(d[3].slice(0,-1),10):0;return new j(e,b)}};return{Duration:j,addDuration:function(){for(var a=new j,
d=arguments.length;d--;){a.days+=arguments[d].days;a.seconds+=arguments[d].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,d){var e=d?f[d]:null;if(e)return e(a);COG.Log.warn("Could not find duration parser for specified format: "+d);return new j},formatDuration:function(a){var d,e,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){d=~~(a/3600);a-=d*3600}if(a>=60){e=Math.round(a/60);a-=e*60}if(d)b=b+d+(d>1?" hrs ":" hr ")+
(e?(e>10?e:"0"+e)+" min ":"");else if(e)b=b+e+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
T5.zoomable=function(i,m){function j(a,d){if(a&&f!==a){f=a;i.triggerAll("zoomLevelChange",f,d)}}m=T5.ex({initial:0,min:0,max:null,zoomAnimation:T5.easing("quad.out")},m);var f=m.initial;T5.ex(i,{getZoomLevel:function(){return f},setZoomLevel:j,zoomIn:function(){i.scale(2,T5.easing("sine.out"))||i.setZoomLevel(f+1)},zoomOut:function(){i.scale(0.5,T5.easing("sine.out"))||i.setZoomLevel(f-1)}});i.bind("scale",function(a,d,e){a=0;d=Math.sqrt(d);if(d<1)a=-(0.5/d);else if(d>1)a=d;j(f+a>>0,e)});i.bind("doubleTap",
function(a,d,e){i.scalable()&&i.animate(2,T5.D.getCenter(i.getDimensions()),T5.XY.init(e.x,e.y),m.zoomAnimation)})};
(function(){var i=Math.PI*2,m=Math.PI/2,j=Math.abs,f=Math.pow,a=Math.sin,d=Math.asin,e=Math.cos,b=1.70158,k={linear:function(c,g,h,l){return h*c/l+g},backin:function(c,g,h,l){return h*(c/=l)*c*((b+1)*c-b)+g},backout:function(c,g,h,l){return h*((c=c/l-1)*c*((b+1)*c+b)+1)+g},backinout:function(c,g,h,l){return(c/=l/2)<1?h/2*c*c*(((b*=1.525)+1)*c-b)+g:h/2*((c-=2)*c*(((b*=1.525)+1)*c+b)+2)+g},bouncein:function(c,g,h,l){return h-k.bounceout(l-c,0,h,l)+g},bounceout:function(c,g,h,l){return(c/=l)<1/2.75?
h*7.5625*c*c+g:c<2/2.75?h*(7.5625*(c-=1.5/2.75)*c+0.75)+g:c<2.5/2.75?h*(7.5625*(c-=2.25/2.75)*c+0.9375)+g:h*(7.5625*(c-=2.625/2.75)*c+0.984375)+g},bounceinout:function(c,g,h,l){return c<l/2?k.bouncein(c*2,0,h,l)/2+g:k.bounceout(c*2-l,0,h,l)/2+h/2+g},cubicin:function(c,g,h,l){return h*(c/=l)*c*c+g},cubicout:function(c,g,h,l){return h*((c=c/l-1)*c*c+1)+g},cubicinout:function(c,g,h,l){if((c/=l/2)<1)return h/2*c*c*c+g;return h/2*((c-=2)*c*c+2)+g},elasticin:function(c,g,h,l,n,v){if(c==0)return g;if((c/=
l)==1)return g+h;v||(v=l*0.3);if(!n||n<j(h)){n=h;h=v/4}else h=v/i*d(h/n);return-(n*f(2,10*(c-=1))*a((c*l-h)*i/v))+g},elasticout:function(c,g,h,l,n,v){var x;if(c==0)return g;if((c/=l)==1)return g+h;v||(v=l*0.3);if(!n||n<j(h)){n=h;x=v/4}else x=v/i*d(h/n);return n*f(2,-10*c)*a((c*l-x)*i/v)+h+g},elasticinout:function(c,g,h,l,n,v){var x;if(c==0)return g;if((c/=l/2)==2)return g+h;v||(v=l*0.3*1.5);if(!n||n<j(h)){n=h;x=v/4}else x=v/i*d(h/n);if(c<1)return-0.5*n*f(2,10*(c-=1))*a((c*l-x)*i/v)+g;return n*f(2,
-10*(c-=1))*a((c*l-x)*i/v)*0.5+h+g},quadin:function(c,g,h,l){return h*(c/=l)*c+g},quadout:function(c,g,h,l){return-h*(c/=l)*(c-2)+g},quadinout:function(c,g,h,l){if((c/=l/2)<1)return h/2*c*c+g;return-h/2*(--c*(c-2)-1)+g},sinein:function(c,g,h,l){return-h*e(c/l*m)+h+g},sineout:function(c,g,h,l){return h*a(c/l*m)+g},sineinout:function(c,g,h,l){return-h/2*(e(Math.PI*c/l)-1)+g}};T5.easing=function(c){return k[c.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(c,g){k[c.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=g}})();
T5.Tween=function(i){i=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},i);var m=T5.ticks(),j=[],f=false,a=0,d=0,e={cancelOnInteract:i.cancelOnInteract,isComplete:function(){return f},triggerComplete:function(b){i.complete&&i.complete(b)},update:function(b){try{var k=i.tweenFn(b-m,a,d,i.duration);if(i.target)i.target[i.property]=k;for(var c=j.length;c--;)j[c](k,void 0);if(f=m+i.duration<=b){if(i.target)i.target[i.property]=
i.tweenFn(i.duration,a,d,i.duration);for(var g=j.length;g--;)j[g](k,true)}}catch(h){COG.Log.exception(h)}},requestUpdates:function(b){j.push(b)}};a=i.target&&i.property&&i.target[i.property]?i.target[i.property]:i.startValue;if(typeof i.endValue!=="undefined")d=i.endValue-a;if(d==0)f=true;T5.wakeTweens();return e};
(function(){function i(a){if(f)return m.length;f=true;try{for(var d=0;d<m.length;)if(m[d].isComplete()){m[d].triggerComplete(false);m.splice(d,1)}else{m[d].update(a);d++}}finally{f=false}m.length===0&&j.trigger("complete");return m.length}var m=[],j=null,f=false;T5.tweenValue=function(a,d,e,b,k){a=new T5.Tween({startValue:a,endValue:d,tweenFn:e,complete:b,duration:k});m.push(a);return a};T5.tween=function(a,d,e,b,k,c){a=new T5.Tween({target:a,property:d,endValue:e,tweenFn:b,duration:c,complete:k});
m.push(a);return a};T5.tweenVector=function(a,d,e,b,k,c){var g=[];if(a){var h=a.x==d,l=a.y==e;h||g.push(T5.tween(a,"x",d,b,function(){(h=true)&&l&&k()},c));l||g.push(T5.tween(a,"y",e,b,function(){l=true;h&&l&&k()},c))}return g};T5.cancelAnimation=function(a){if(!f){f=true;try{for(var d=0;d<m.length;)if(!a||a(m[d])){m[d].triggerComplete(true);m.splice(d,1)}else d++}finally{f=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!j){j=COG.Loopage.join({execute:i,frequency:20});
j.bind("complete",function(){j=null})}}})();(function(){var i={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,j=arguments.length;j--;){var f=i[arguments[j].toUpperCase()];if(f)m|=f}return m}})();
T5.ViewLayer=function(i){i=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},i);var m=null,j=false,f=false,a=i.supportFastDraw,d=i.id,e=T5.viewState("ACTIVE"),b=i.validStates,k=0,c=0,g=T5.ex({addToView:function(h){h.setLayer(d,g)},shouldDraw:function(h,l,n){h=(h&b)!==0&&(j?a:true);return h=f||n||k!==l.x||c!==l.y},cycle:function(){},draw:function(){},remove:function(){g.trigger("remove",g)},changed:function(){f=
true;g.trigger("changed",g);m&&m.trigger("invalidate")},getId:function(){return d},setId:function(h){d=h},getParent:function(){return m},setParent:function(h){j=(m=h)?m.fastDraw&&displayState!==e:false;g.trigger("parentChange",m)}},i);COG.observable(g);g.bind("drawComplete",function(h,l){f=false;k=l.x;c=l.y});g.bind("resync",function(h,l){if(l.syncXY){if(g.minXY){l.syncXY(g.minXY);COG.Log.info("resyncing min",g.minXY)}if(g.maxXY){l.syncXY(g.maxXY);COG.Log.info("resyncing max",g.maxXY)}}});return g};
T5.View=function(i){function m(q,r,A,F){w=ga;u();if(F&&i.inertia){Z=true;c(t+r,y+A,i.panAnimationEasing,i.panAnimationDuration)}else F||c(t+r,y+A)}function j(){w=oa;Z=false;COG.Loopage.join({execute:u,after:50,single:true})}function f(q,r){S=B(q);ea=B(r);var A=Q(S),F=Q(ea);$=da(S);M=da(ea);E=S&&A!==0?F/A:1}function a(q,r,A){f(r,A);if(Y=E!==1){w=ka;u()}}function d(q,r,A,F){f(r,A);if(i.adjustScaleFactor){E=i.adjustScaleFactor(E);COG.Log.info("scale factor adjusted to: "+E)}if(F<i.pinchZoomAnimateTrigger){l(na,
E,$,n(),T5.easing("sine.out"),function(){b();E=1},300);E=na}else{b();E=1}}function e(q,r,A){H.zoom(r,Math.min(Math.pow(2,Math.round(Math.log(A))),8),500)}function b(){var q=S?n():M;E=Math.round(E*10)/10;Y=false;for(var r=D.length;r--;)D[r].trigger("scale",E,q);H.trigger("scale",E,q);w=oa;u()}function k(){clearTimeout(ma);ma=setTimeout(g,50)}function c(q,r,A,F,I){function N(){T+=1;if(T>=2){j(0,0);I&&I()}}var T=0;if(L){q=q<L.x?L.x:q;r=r<L.y?L.y:r}if(R){q=q>R.x?R.x:q;r=r>R.y?R.y:r}if(A){q=T5.tweenValue(t,
q,A,N,F);r=T5.tweenValue(y,r,A,N,F);q.cancelOnInteract=true;q.requestUpdates(function(P){t=P;Z=true;u()});r.cancelOnInteract=true;r.requestUpdates(function(P){y=P;Z=true;u()})}else{t=q;y=r}}function g(){var q;if(G){COG.Touch.release(G);if(i.autoSize&&G.parentNode){q=G.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){G.height=q.height;G.width=q.width}}try{if(!G.id)G.id=i.id+"_canvas";ca=G.getContext("2d");ca.clearRect(0,0,G.width,G.height)}catch(r){COG.Log.exception(r);throw Error("Could not initialise canvas on specified view element");
}aa=COG.Touch.capture(G,{observable:H});if(O.height!==G.height||O.width!==G.width){O=T5.D.init(G.width,G.height);H.trigger("resize",G.width,G.height);for(q=J;q--;)D[q].trigger("resize",G.width,G.height)}i.inertia&&aa.inertiaEnable(i.panAnimationDuration,O);for(q=J;q--;)D[q].trigger("contextChanged",ca);p()}}function h(q,r){r.setId(q);r.added=T5.ticks();r.bind("remove",function(){H.removeLayer(q)});r.trigger("contextChanged",ca);r.setParent(H);D.push(r);D.sort(function(A,F){var I=F.zindex-A.zindex;
if(I===0)I=F.added-A.added;return I});J=D.length;return r}function l(q,r,A,F,I,N,T){function P(){N&&N();b();E=1;la=null}Y=true;$=T5.XY.offset(A,V.x1,V.y1);M=T5.XY.offset(F,V.x1,V.y1);S=null;COG.Log.info("zoom from: ",$);COG.Log.info("zoom to:   ",M);if(I)T5.tweenValue(0,r-q,I,P,T?T:1E3).requestUpdates(function(qa){la=qa/(r-q);E=q+qa;w=ka;u();H.trigger("animate")});else{E=r;P()}}function n(){var q=T5.D.getCenter(O),r=T5.XY.distance([M,q]);q=T5.XY.theta(M,q,r);var A=T5.XY.diff($,M);q=T5.XY.extendBy(M,
q,r/E);q.x+=A.x;q.y+=A.y;return q}function v(){z("idle",H);ja=true;fa=0}function x(q,r,A,F,I){var N=(r&ka)!==0,T=T5.XYRect.copy(A),P,qa=0;q.clearRect(0,0,G.width,G.height);if(ha||N)ha=false;if(N){T5.D.getCenter(O);var ta=(la?la:1)/2,wa=T5.XY.diff($,M);if(S){K.x=M.x+wa.x;K.y=M.y+wa.y}else{K.x=M.x-wa.x*ta;K.y=M.y-wa.y*ta}}q.save();try{na=E;if(N){N=1/E;ta=(N-0.5)/0.5;T=T5.XYRect.fromCenter(M.x-(M.x-t)*ta,M.y-(M.y-y)*ta,~~(T.width*N),~~(T.height*N));q.scale(E,E)}q.translate(-T.x1,-T.y1);R=L=null;for(qa=
J;qa--;){P=D[qa];if(P.shouldDraw(r,A,F)){var xa=P.style,ya=xa?T5.Style.apply(q,xa):null;if(P.minXY)L=L?T5.XY.min(L,P.minXY):T5.XY.copy(P.minXY);if(P.maxXY)R=R?T5.XY.max(R,P.maxXY):T5.XY.copy(P.maxXY);P.draw(q,T,r,H,F,I);ya&&T5.Style.apply(q,ya);P.trigger("drawComplete",T,I)}}}finally{q.restore()}H.trigger("drawComplete",A,I);COG.Log.trace("draw complete",I)}function o(q,r){var A=false,F=W?W:Z?ga:w,I=!Z&&(F===ka||F===ga),N=ia||F===ga||F===ka||T5.isTweening();C=T5.XY.init(t>>0,y>>0);V=T5.XYRect.fromCenter(C.x,
C.y,O.width,O.height);if(I){T5.cancelAnimation(function(T){return T.cancelOnInteract});ja=false;if(fa!==0){clearTimeout(fa);fa=0}}for(I=J;I--;){if(D[I].animated)w|=s;A=D[I].cycle(q,V,w,N)||A}N=N||(w&s)!==0;if(A=A||N||E!==1&&E!==X){x(ca,F,V,N,q);X=E;ia=false}if(!A&&pa===0&&!sa){if(!ja&&fa===0)fa=setTimeout(v,500);r.trigger("complete")}pa=0;COG.Log.trace("Completed draw cycle",q)}function p(){ia=true;u()}function u(){pa+=1;if(!U){U=COG.Loopage.join({execute:o,frequency:ua});U.bind("complete",function(){U=
null})}}function z(){H.trigger.apply(null,arguments);for(var q=D.length;q--;)D[q].trigger.apply(null,arguments)}i=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},i);var D=[],J=0,G=document.getElementById(i.container),ca=null,t=0,y=0,C=null,V=null,ha=false,U=null,ra=1,O=T5.D.init(),pa=0,M=null,ja=false,
Z=false,fa=0,ba=0,K=T5.XY.init(),L=null,R=null,va=0,Y=false,S=null,ea=null,W=null,ia=false,ma=0,E=1,X=0,na=1,la=null,$=null,sa=typeof FlashCanvas!=="undefined",ua=~~(1E3/i.fps),aa=null,oa=T5.viewState("ACTIVE"),ga=T5.viewState("PAN"),ka=T5.viewState("ZOOM"),s=T5.viewState("ANIMATING"),w=oa,B=T5.XY.getRect,Q=T5.XYRect.diagonalSize,da=T5.XYRect.center,H={id:i.id,deviceScaling:ra,fastDraw:i.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,r,A,F,I){l(E,q,r,A,F,I)},centerOn:function(q){t=q.x-
G.width/2;y=q.y-G.height/2},getDimensions:function(){return O},getZoomCenter:function(){return K},getLayer:function(q){for(var r=0;r<J;r++)if(D[r].getId()==q)return D[r];return null},setLayer:function(q,r){for(var A=0;A<J;A++)if(D[A].getId()===q){D.splice(A,1);break}r&&h(q,r);p();return r},eachLayer:function(q){for(var r=J;r--;)q(D[r])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");ha=true;p()},invalidate:p,resize:function(q,r){if(G){i.autoSize=false;G.width=
q;G.height=r;g();H.trigger("resize",G.width,G.height)}},scale:function(q,r,A,F,I){F||(F=T5.D.getCenter(O));I||(I=T5.D.getCenter(O));H.animate(q,F,I,r,A);return H},triggerAll:z,removeLayer:function(q){a:{for(var r=J;r--;)if(D[r].getId()==q){q=r;break a}q=-1}if(q>=0&&q<J){COG.say("layer.removed",{layer:D[q]});D.splice(q,1);p()}J=D.length},stateOverride:function(q){W=q},getOffset:function(){return C?C:T5.XY.init(t,y)},getViewRect:function(){return V?V:T5.XYRect.fromCenter(t,y,O.width,O.height)},updateOffset:c,
pan:function(q,r,A,F,I){c(t+q,y+r,A,F,I)},zoom:function(q,r,A){Z=false;E=r;Y=E!==1;$=T5.D.getCenter(O);M=T5.XY.offset(E>1?T5.XY.copy(q):T5.D.getCenter(O),V.x1,V.y1);S=null;clearTimeout(ba);if(Y){w=ka;u();if(A)ba=setTimeout(function(){b();E=1},parseInt(A,10))}}};ra=T5.getConfig().getScaling();H.markers=h("markers",new T5.MarkerLayer);COG.observable(H);H.bind("wake",u);H.bind("invalidate",p);if(i.pannable){H.bind("pan",m);H.bind("panEnd",j);H.bind("inertiaCancel",function(){Z=false;u()})}if(i.scalable){H.bind("pinchZoom",
a);H.bind("pinchZoomEnd",d);H.bind("wheelZoom",e)}H.bind("tap",function(q,r,A){for(var F=T5.XY.offset(A,t,y),I=D.length;I--;)q.cancel=q.cancel||D[I].trigger("tap",r,A,F).cancel});H.bind("resync",function(){R=L=null});COG.configurable(H,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(i,null,{container:function(q,r){G=document.getElementById(r);g()},rotation:function(q,r){va=r}}),true);g();i.autoSize&&window.addEventListener("resize",k,false);return H};
T5.PathLayer=function(i){i=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},i);var m=false,j=[],f=null,a=[],d=null,e=0,b=[],k=T5.ex(new T5.ViewLayer(i),{getAnimation:function(c,g,h,l){var n="pathAnimation"+e++;b.push(n);return new T5.AnimatedPathLayer({id:n,path:j,zindex:i.zindex+1,easing:c?c:T5.easing("sine.inout"),duration:g?g:5E3,drawIndicator:h,autoCenter:l?l:false})},cycle:function(c,g,h,l){return l},draw:function(c){var g,h=j.length;c.save();try{T5.Style.apply(c,i.style);if(h>0){c.beginPath();
c.moveTo(j[h-1].x,j[h-1].y);for(g=h;g--;)c.lineTo(j[g].x,j[g].y);c.stroke();if(f){c.fillStyle=i.waypointFillStyle;for(g=f.length;g--;){c.beginPath();c.arc(f[g].x,f[g].y,2,0,Math.PI*2,false);c.stroke();c.fill()}}}}finally{c.restore()}m=false},updateCoordinates:function(c,g){a=c;d=g;var h=k.getParent();if(h&&h.syncXY){h.syncXY(a);d&&h.syncXY(d);k.trigger("tidy")}}});k.bind("tidy",function(){j=T5.XY.simplify(a,i.pixelGeneralization);f=T5.XY.simplify(d,i.pixelGeneralization);m=true;k.changed()});return k};
T5.ShapeLayer=function(i){function m(e){for(var b=f.length;b--;)f[b].resync(e);f.sort(function(k,c){var g=c.xy.y-k.xy.y;if(g===0)g=c.xy.x-k.xy.y;return g});a=true;d.changed()}function j(e,b){b.syncXY&&m(b)}i=T5.ex({zindex:80},i);var f=[],a=false,d=T5.ex(new T5.ViewLayer(i),{add:function(e){f[f.length]=e},each:function(e){for(var b=f.length;b--;)e(f[b])},cycle:function(){return a},draw:function(e,b,k){var c=b.x1,g=b.y1,h=b.width;b=b.height;for(var l=f.length;l--;){var n=f[l].style;n=n?T5.Style.apply(e,
n):null;f[l].draw(e,c,g,h,b,k);n&&T5.Style.apply(e,n)}a=false}});d.bind("parentChange",j);d.bind("resync",j);return d};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(i){i=T5.ex({style:null,properties:{}},i);return T5.ex(i,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(i,m){m=T5.ex({size:4},m);var j=T5.XY.init(),f=T5.ex(m,{draw:function(a){a.beginPath();a.arc(j.x,j.y,f.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([i]);j=T5.XY.floor([i])[0]}});COG.Log.info("created arc = ",i);return f};
T5.Poly=function(i,m){m=T5.ex({fill:false,simplify:false},m);var j=false,f=m.fill,a=m.simplify,d=T5.viewState("ZOOM"),e=[],b=T5.ex(new T5.Shape(m),{draw:function(k,c,g,h,l,n){if(j){c=true;g=(n&d)!==0;k.beginPath();for(n=e.length;n--;){g=e[n].x;h=e[n].y;if(c){k.moveTo(g,h);c=false}else k.lineTo(g,h);g=true}if(g){f&&k.fill();k.stroke()}}},resync:function(k){b.xy=k.syncXY(i);e=T5.XY.floor(a?T5.XY.simplify(i):i)}});j=i&&i.length>=2;return b};
T5.AnimatedPathLayer=function(i){function m(b,k,c){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(c.x,c.y,4,0,Math.PI*2,false);b.stroke();b.fill()}i=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},i);var j=T5.XY.edges(i.path),f,a=null,d=0;T5.tweenValue(0,j.total,i.easing,function(){e.remove()},i.duration).requestUpdates(function(b,k){d=b;k&&e.remove()});var e=
T5.ex(new T5.ViewLayer(i),{cycle:function(){for(var b=0;b<j.accrued.length&&j.accrued[b]<d;)b++;a=null;if(b<i.path.length-1){var k=d-(b>0?j.accrued[b-1]:0),c=i.path[b];f=T5.XY.theta(c,i.path[b+1],j.edges[b]);a=T5.XY.extendBy(c,f,k);if(i.autoCenter)(b=e.getParent())&&b.centerOn(a)}return a},draw:function(b,k){if(a)(i.drawIndicator?i.drawIndicator:m)(b,k,T5.XY.init(a.x,a.y),f)}});return e};
T5.Marker=function(i){function m(k,c,g,h){f=k;a=c;d=g;e=h}i=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},i);var j=false,f=0,a=0,d=0,e=0,b=T5.ex(i,{isNew:true,isAnimating:function(){return j},draw:function(k,c,g,h,l){if(b.isNew&&i.tweenIn){var n=b.xy.y;b.xy.y=c.y1-20;j=true;T5.tween(b.xy,"y",n,i.tweenIn,function(){b.xy.y=n;j=false},i.animationSpeed?i.animationSpeed:250+Math.random()*500)}b.drawMarker(k,c,b.xy.x,b.xy.y,g,h,l);b.isNew=false},drawMarker:function(k,c,g,h){k.beginPath();
k.arc(g,h,4,0,Math.PI*2,false);k.fill();m(g-4,h-4,8,8)},hitTest:function(k,c){return k>=f&&k<=f+d&&c>=a&&c<=a+e},updateBounds:m});COG.observable(b);return b};
T5.ImageMarker=function(i){i=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},i);var m=i.imageAnchor?T5.XY.invert(i.imageAnchor):null,j=T5.ex(new T5.Marker(i),{drawMarker:function(f,a,d,e){if((a=j.isAnimating()&&j.animatingImage?j.animatingImage:j.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var b=j.scale,k=d+~~(m.x*b),c=e+~~(m.y*b),g=~~(a.width*b),h=~~(a.height*b);j.updateBounds(k,c,g,g);if(j.rotation||
j.opacity!==1){f.save();try{f.globalAlpha=j.opacity;f.translate(d,e);f.rotate(j.rotation);f.drawImage(a,m.x*b,m.y*b,g,h)}finally{f.restore()}}else f.drawImage(a,k,c,g,h)}}});if(!j.image)j.image=T5.Images.get(i.imageUrl,function(f){COG.Log.info("updating marker image to: "+f.src);j.image=f});if(!j.animatingImage)j.animatingImage=T5.Images.get(i.animatingImageUrl,function(f){j.animatingImage=f});return j};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(i){function m(){d.changed();d.trigger("markerUpdate",f)}function j(){var e=d.getParent();if(e&&e.syncXY)for(var b=f.length;b--;)e.syncXY([f[b].xy])}i=T5.ex({zindex:100,style:"basic"},i);var f=[],a=false,d=T5.ex(new T5.ViewLayer(i),{cycle:function(){return a},draw:function(e,b,k,c){a=false;for(var g=f.length;g--;){f[g].draw(e,b,k,d,c);a=a||f[g].isAnimating()}return a?1:0},add:function(e){if(e&&typeof e.length!=="undefined")for(var b=e.length;b--;){if(e[b])f[f.length]=e[b]}else if(e)f[f.length]=
e;m()},clear:function(e){if(e)for(var b=0;b<f.length;b++)e(f[b])&&f.splice(b,1);else f=[];m()},find:function(e){for(var b=[],k=f.length;k--;)if(!e||e(f[k]))b[b.length]=f[k];return b}});d.bind("tap",function(e,b,k){for(var c=[],g=k.x,h=k.y,l=f.length;l--;)if(f[l].hitTest(g,h))c[c.length]=f[l];if(c.length>0)e.cancel=d.trigger("markerTap",b,k,c).cancel});d.bind("parentChange",j);d.bind("changed",j);return d};
T5.ImageLayer=function(i,m){function j(g){a&&a.run(g,function(h){d=h;(h=c.getParent())&&h.trigger("invalidate")})}function f(){var g=c.getParent();g&&g.trigger("invalidate")}m=T5.ex({imageLoadArgs:{}},m);var a=i?T5.Generator.init(i,m):null,d=null,e=T5.XYRect.init(),b=m.imageLoadArgs,k=T5.viewState("ZOOM"),c=T5.ex(new T5.ViewLayer(m),{changeGenerator:function(g,h){a=T5.Generator.init(g,T5.ex({},m,h));a.bindToView(c.getParent());d=null;j(e)},cycle:function(g,h){j(h)},draw:function(g,h,l){g.save();try{g.strokeStyle=
"#555";g.beginPath();if(d)for(var n=d.length;n--;){var v=d[n].x,x=d[n].y,o=T5.XYRect.init(d[n].x,d[n].y,d[n].x+d[n].width,d[n].y+d[n].height);T5.XYRect.intersect(h,o)&&c.drawImage(g,h,v,x,d[n],l)}g.clip()}finally{g.restore()}e=T5.XYRect.copy(h)},drawImage:function(g,h,l,n,v,x){if(h=T5.Images.get(v.url,(x&k)===0?f:null,b)){g.rect(l,n,v.width,v.height);g.drawImage(h,l,n,h.width,h.height)}}});c.bind("idle",function(){j(e)});c.bind("parentChange",function(g,h){a&&a.bindToView(h)});c.bind("tap",function(g,
h,l,n){g=[];var v=n.x,x=n.y,o,p;if(d)for(var u=d.length;u--;){o=d[u];if(p=v>=o.x&&v<=o.x+o.width&&x>=o.y&&x<=o.y+o.height)g[g.length]=o}g.length>0&&c.trigger("tapImage",g,h,l,n)});return c};
T5.Style=function(){function i(e,b){a[e]=j(b);return e}function m(e){for(var b in e)i(b,e[b])}function j(e){function b(h){var l=e[h];typeof l!=="undefined"&&c.push(function(n){n[h]=l})}function k(){c=[];for(var h in e)b(h)}e=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},e);var c=[],g={applyToContext:function(h){for(var l=c.length;l--;)c[l](h)},update:function(h,
l){e[h]=l;k()}};k();return g}var f={},a={},d={apply:function(e,b){var k=a[b]?a[b]:a.basic,c;if(e&&e.canvas){c=f[e.canvas.id];f[e.canvas.id]=b}k.applyToContext(e);return c},define:i,defineMany:m,get:function(e){return a[e]},init:j,load:function(e){COG.jsonp(e,function(b){T5.resetStyles(b)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return d}();
T5.Tiling=function(){return{tileSize:256,init:function(i,m,j,f,a){return T5.ex({x:i,y:m,width:j,height:f},a)}}}();
T5.TileGenerator=function(i){function m(n,v,x,o){function p(){if(l.initTileCreator){e=true;l.initTileCreator(n,v,x,o)}}l.prepTileCreator?l.prepTileCreator(n,v,x,p):p()}function j(n,v){for(var x=~~((n.x1-d.x)/b),o=~~((n.y1-d.y)/k),p=[],u=-g;u<g;u++)for(var z=-h;z<h;z++){var D=c(x+u,o+z);if(D)p[p.length]=D}v&&v(p);a=T5.XYRect.copy(n)}i=T5.ex({tileWidth:256,tileHeight:256},i);var f=null,a=null,d=T5.XY.init(),e=false,b=i.tileWidth,k=i.tileHeight,c=null,g=0,h=0,l={bindToView:function(n){COG.Log.info("initializing generator");
f=n;l.trigger("bindView",n)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){c=null;e=false;a=null},run:function(n,v){if(!a||Math.abs(n.x1-a.x1)>b||Math.abs(n.y1-a.y1)>k){if(!c&&!e||l.requireRefresh()){COG.Log.info("generating tiles, view rect = ",n);d=T5.XY.init(n.x1,n.y1);g=Math.ceil(n.width/b)+1;h=Math.ceil(n.height/k)+1;m(b,k,l.getTileCreatorArgs?l.getTileCreatorArgs(f):{},function(x){c=x;e=false;j(n,v)})}c&&j(n,v)}}};
COG.observable(l);l.bind("update",function(){COG.Log.info("captured generator update");a=null});return l};
