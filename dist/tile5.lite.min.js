COG=function(){var f=/\$\{(.*?)\}/ig,l=Object.prototype.hasOwnProperty,g=0,e={id:"grunt.core",extend:function(){var b=arguments[0]||{},c=1,d=arguments.length,a=false,m,h,j,i;if(typeof b==="boolean"){a=b;b=arguments[1]||{};c=2}if(typeof b!=="object"&&!e.isFunction(b))b={};if(d===c){b=this;--c}for(;c<d;c++)if((m=arguments[c])!=null)for(h in m){j=b[h];i=m[h];if(b!==i)if(a&&i&&(e.isPlainObject(i)||e.isArray(i))){j=j&&(e.isPlainObject(j)||e.isArray(j))?j:e.isArray(i)?[]:{};b[h]=e.extend(a,j,i)}else if(i!==
undefined)b[h]=i}return b},isFunction:function(b){return toString.call(b)==="[object Function]"},isArray:function(b){return toString.call(b)==="[object Array]"},isPlainObject:function(b){if(!b||toString.call(b)!=="[object Object]"||b.nodeType||b.setInterval)return false;if(b.constructor&&!l.call(b,"constructor")&&!l.call(b.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in b);return c===undefined||l.call(b,c)},isEmptyObject:function(b){for(var c in b)return false;return true},isXmlDocument:function(b){return toString.call(b)===
"[object Document]"},contains:function(b,c){var d=b,a=arguments,m=1;if(c&&e.isArray(c)){a=c;m=0}for(m=m;m<a;m++)d=d&&typeof foo[a[m]]!=="undefined";return d},newModule:function(b){b=e.extend({id:null,requires:[],parent:null},b);if(b.parent)b=e.extend({},b.parent,b);return b},toID:function(b){return b.replace(/\s/g,"-")},objId:function(b){return(b?b:"obj")+g++},formatStr:function(b){if(arguments.length<=1)return b;for(var c=arguments.length-2,d=0;d<=c;d++)b=b.replace(RegExp("\\{"+d+"\\}","gi"),arguments[d+
1]);return b},wordExists:function(b,c){var d="";if(c.toString)c=c.toString();for(var a=0;a<c.length;a++)d+=!/\w/.test(c[a])?"\\"+c[a]:c[a];return RegExp("(^|\\s|\\,)"+d+"(\\,|\\s|$)","i").test(b)},parseTemplate:function(b,c){for(var d=f.exec(b);d;){b=b.replace(d[0],COG.XPath.first(d[1],c));f.lastIndex=0;d=f.exec(b)}return b}};return e}();
COG.Log=function(){function f(c,d){var a,m=d&&d.length>0?d[0]:"";for(a=1;d&&a<d.length;a++)m+=" "+(g&&COG.isPlainObject(d[a])?JSON.stringify(d[a]):d[a]);typeof console!=="undefined"&&console[c](m);for(a=0;a<l.length;a++)l[a].call(b,m,c)}var l=[],g=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,b={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(c,d){if(e)console.markTimeline(c+(d?": "+(b.getTraceTicks()-d)+"ms":""))},debug:function(){f("debug",
arguments)},info:function(){f("info",arguments)},warn:function(){f("warn",arguments)},error:function(){f("error",arguments)},exception:function(c){b.error(arguments);for(var d in c)b.info("ERROR DETAIL: "+d+": "+c[d])},watch:function(c,d){try{d()}catch(a){b.exception(a,c)}},throwError:function(c){b.error(c);throw Error(c);},requestUpdates:function(c){l.push(c)}};return b}();
(function(){function f(e,b){e[b]||(e[b]=function(c){return e.configure(b,c)})}function l(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var g={};COG.paramTweaker=function(e,b,c){return function(d,a){if(typeof a!=="undefined"){if(d in e)e[d]=a;c&&d in c&&c[d](d,a)}else return b&&d in b?b[d](d):e[d]}};COG.configurable=function(e,b,c,d){if(e){e.gtConfId||l(e);var a=e.gtConfId,m=e.gtConfig,h=e.gtConfigFns;g[a]=e;h.push(c);for(c=b.length;c--;){m[b[c]]=true;d&&
f(e,b[c])}if(!e.configure)e.configure=function(j,i){if(m[j]){for(var k=h.length;k--;){var q=h[k](j,i);if(typeof q!=="undefined")return q}return g[a]}return null}}}})();
(function(){function f(l,g){var e=l.gtObsHandlers;e[g]||(e[g]=[]);return e[g]}COG.observable=function(l){if(l){if(!l.gtObsHandlers)l.gtObsHandlers={};if(!(l.bind||l.trigger||l.unbind)){l.bind=function(g,e){var b=COG.objId("callback");f(l,g).unshift({fn:e,id:b});return b};l.trigger=function(g){var e=f(l,g),b={cancel:false,tickCount:(new Date).getTime()},c;if(!e)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(b);for(var d=e.length;d--&&!b.cancel;)e[d].fn.apply(self,c);return b};l.unbind=
function(g,e){for(var b=f(l,g),c=0;b&&c<b.length;c++)if(b[c].id===e){b.splice(c,1);break}return l}}}}})();(function(){var f={},l=[];COG.addPipe=function(g){g("pipe.test",{});l.push(g)};COG.listen=function(g,e){f[g]||(f[g]=[]);e&&f[g].push(e)};COG.say=function(g,e){var b;for(b=l.length;b--;)l[b](g,e);if(f[g])for(b=f[g].length;b--;)f[g][b](e)}})();
COG.Loopage=function(){function f(i){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},i)}function l(i){a.push(i);g()}function g(){m&&clearTimeout(m);m=setTimeout(e,0);j=true}function e(){for(var i,k=(new Date).getTime(),q=d.length;a.length>0;){var x=a.shift();for(i=q;i--;)if(d[i].id===x){d.splice(i,1);break}j=true;q=d.length}if(j){h=b;for(i=q;i--;)h=d[i].frequency<h?d[i].frequency:h}for(i=q;i--;){x=k-d[i].lastTick;if(d[i].lastTick===0||x>=d[i].frequency){d[i].execute(k,
d[i]);d[i].lastTick=k;d[i].single&&d[i].trigger("complete")}}m=q?setTimeout(e,h):0}var b=6E4,c=0,d=[],a=[],m=0,h=b,j=true;return{join:function(i){var k=new f(i);if(k.after>0)k.lastTick=(new Date).getTime()+k.after;COG.observable(k);k.bind("complete",function(){l(k.id)});d.unshift(k);g();return k},leave:l}}();if(!this.JSON)this.JSON={};
(function(){function f(h){return h<10?"0"+h:h}function l(h){b.lastIndex=0;return b.test(h)?'"'+h.replace(b,function(j){var i=a[j];return typeof i==="string"?i:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+h+'"'}function g(h,j){var i,k,q,x,p=c,r,n=j[h];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(h);if(typeof m==="function")n=m.call(j,h,n);switch(typeof n){case "string":return l(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";c+=d;r=[];if(Object.prototype.toString.apply(n)==="[object Array]"){x=n.length;for(i=0;i<x;i+=1)r[i]=g(i,n)||"null";q=r.length===0?"[]":c?"[\n"+c+r.join(",\n"+c)+"\n"+p+"]":"["+r.join(",")+"]";c=p;return q}if(m&&typeof m==="object"){x=m.length;for(i=0;i<x;i+=1){k=m[i];if(typeof k==="string")if(q=g(k,n))r.push(l(k)+(c?": ":":")+q)}}else for(k in n)if(Object.hasOwnProperty.call(n,k))if(q=g(k,n))r.push(l(k)+(c?": ":":")+q);q=r.length===0?"{}":c?"{\n"+c+r.join(",\n"+c)+
"\n"+p+"}":"{"+r.join(",")+"}";c=p;return q}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,d,a={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;if(typeof JSON.stringify!=="function")JSON.stringify=function(h,j,i){var k;d=c="";if(typeof i==="number")for(k=0;k<i;k+=1)d+=" ";else if(typeof i==="string")d=i;if((m=j)&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number"))throw Error("JSON.stringify");return g("",
{"":h})};if(typeof JSON.parse!=="function")JSON.parse=function(h,j){function i(q,x){var p,r,n=q[x];if(n&&typeof n==="object")for(p in n)if(Object.hasOwnProperty.call(n,p)){r=i(n,p);if(r!==undefined)n[p]=r;else delete n[p]}return j.call(q,x,n)}var k;h=String(h);e.lastIndex=0;if(e.test(h))h=h.replace(e,function(q){return"\\u"+("0000"+q.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(h.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){k=eval("("+h+")");return typeof j==="function"?i({"":k},""):k}throw new SyntaxError("JSON.parse");}})();
(function(){function f(g,e){var b=g.split("|"),c={};for(var d in e){var a=e[d];c[d]=b.length>a?b[a]:null}return c}var l={JSON:{parse:function(g){return JSON.parse(g)}},PDON:{parse:function(g){var e=null,b=[];g=g.split("\n");for(var c=0;c<g.length;c++){var d=g[c];if(e)b.push(f(d,e));else if(d){e=d.split("|");d={};for(var a=0;a<e.length;a++)d[e[a]]=a;e=d}else e=null}return b}}};COG.parseData=function(g,e){e=e?e.toUpperCase():"JSON";if(!l[e])throw Error("Unsupported data format: "+e);try{return l[e].parse(g)}catch(b){COG.Log.exception(b)}return{}}})();
COG.XPath=function(){function f(b){for(var c=null,d=0;d<l.length;d++)if(c=l[d](b))break;return c}var l=[],g=[null,function(b){return b.numberValue},function(b){return b.stringValue},function(b){return b.booleanValue},null,null,null,null,function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null},function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(b){return{toString:function(){var c=
null;if(b){var d=null;if(b.resultType>=0&&b.resultType<g.length)d=g[b.resultType];if(d)c=d(b)}return c?c:""}}},first:function(b,c){var d=e.SearchResult,a;var m=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!m)m=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))a=c.evaluate(b,c,f,m,null);else{COG.Log.warn("attempted xpath expression: "+b+" on a non-xml document");a=null}}catch(h){COG.Log.warn("invalid xpath expression: "+b+" on node: "+c);a=null}return new d(a)},registerResolver:function(b){l.push(b)}};return e}();
COG.Storage=function(){function f(l){if(l&&l=="session")return sessionStorage;return localStorage}return{get:function(l,g){var e=f(g).getItem(l);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(l,g,e){g=jQuery.isArray(g)||jQuery.isPlainObject(g)?JSON.stringify(g):g;f(e).setItem(l,g)},remove:function(l,g){f(g).removeItem(l)}}}();
COG.ParseRules=function(){var f=[];return{add:function(l,g){f.push({regex:l,handler:g})},each:function(l,g,e){function b(){c++;e&&c>=f.length&&e(g)}for(var c=0,d=0;d<f.length;d++){var a=f[d].regex,m=f[d].handler,h=false;if(a){a.lastIndex=-1;if((a=a.exec(l))&&m){h=true;m(a,g,b)&&b()}}h||b()}}}};
(function(){function f(a){var m=[],h=function(i,k){k=COG.isFunction(k)?k():k;m[m.length]=encodeURIComponent(i)+"="+encodeURIComponent(k)};if(COG.isArray(a))for(var j=0;j<a.length;j++)h(a[j].name,a[j].value);else for(j in a)h(j,a[j]);return m.join("&").replace(/%20/g,"+")}var l={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},g={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],b=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(a){return a.responseXML},JSON:function(a){return COG.parseData(a.responseText)},
PDON:function(a){return COG.parseData(a.responseText,"PDON")},DEFAULT:function(a){return a.responseText}},d={CONTENT_TYPE:"Content-Type"};COG.xhr=function(a){function m(){if(this.readyState===4){var k=null,q=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(q)if(a.handleResponse)a.handleResponse(this);else{var x=a,p=this.getResponseHeader(d.CONTENT_TYPE),r,n=false;for(r in l)if(p&&p.indexOf(l[r])>=0){n=true;
break}p=!n;for(n=0;n<e.length;n++)p=p||e[n]==r;if(p)b:{p=r;for(var w in g)for(n=0;n<g[w].length;n++)if(RegExp(g[w][n]+"$","i").test(x.url)){r=w;break b}r=p?p:"DEFAULT"}try{k=c[r](this,x)}catch(G){k=c.DEFAULT(this,x)}}else a.error&&a.error(this)}catch(Q){COG.Log.exception(Q,"PROCESSING AJAX RESPONSE")}q&&k&&a.success&&a.success.call(this,k)}}try{a=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},a);var h=
b.exec(a.url),j=h&&(h[1]&&h[1]!==location.protocol||h[2]!==location.host);if(a.data)a.method="POST";if(a.url){h=null;if(a.xhr)h=a.xhr(a);h||(h=new XMLHttpRequest);h.open(a.method,a.url,a.async);a.data&&h.setRequestHeader("Content-Type",a.contentType);j||h.setRequestHeader("X-Requested-With","XMLHttpRequest");h.onreadystatechange=m;h.send(a.method=="POST"?f(a.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(i){COG.Log.exception(i)}}})();
(function(){function f(b){var c=document.createElement("script"),d=false;c.src=b;c.async=true;c.onload=c.onreadystatechange=function(){if(!d&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){d=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};g||(g=document.getElementsByTagName("head")[0]);g.appendChild(c)}var l=0,g,e=this;COG.jsonp=function(b,c,d){b+=b.indexOf("?")>=0?"&":"?";var a="json"+ ++l;e[a]=function(m){c(m);e[a]=null;try{delete e[a]}catch(h){}};
f(b+(d?d:"callback")+"="+a);return a}})();
COG.Touch=function(){function f(t,C){return{x:t.x-C.x,y:t.y-C.y}}function l(t,C){var H=f(t,C);return Math.sqrt(H.x*H.x+H.y*H.y)}function g(t){if(t.count>1)return l(t.touches[0],t.touches[1]);return 0}function e(t,C){var H=t&&t.count>0?t.touches[0]:null;if(H&&C&&C.count>0)return f(H,C.touches[0]);return null}function b(t,C){t.count=C.count;for(var H=h;H--;){t.touches[H].x=C.touches[H].x;t.touches[H].y=C.touches[H].y}}function c(){for(var t={count:0,touches:Array(h)},C=h;C--;)t.touches[C]=m();return t}
function d(t){if(t.preventDefault){t.preventDefault();t.stopPropagation()}else t.cancelBubble&&t.cancelBubble()}function a(t,C,H){if(D){C=C[H?H:"touches"];H=C.length;for(H=t.count=H;H--;){t.touches[H].x=C[H].pageX;t.touches[H].y=C[H].pageY}}else if(C.button===0){t.count=1;t.touches[0].x=C.pageX?C.pageX:C.screenX;t.touches[0].y=C.pageY?C.pageY:C.screenY}else t.count=0}function m(t,C){return{x:t?t:0,y:C?C:0}}var h=10,j=120,i=100,k=250,q=300,x=5,p=0,r=1,n=2,w=7,G=0,Q=0,D=undefined,$=function(t){function C(v,
u,o,s){var z=Math.asin((v.y-u.y)/o);o=o*(na/s)>>0;o=o>ia?ia:o;z=u.x>v.x?z:Math.PI-z;E("pan",Math.cos(z)*-o,Math.sin(z)*o,true)}function H(v,u){var o,s;if(D){o=u-ga;if(o<k){s=l(K.touches[0],v);s>t.inertiaTrigger&&C(K.touches[0],v,s,o)}}else{X.x=v.x;X.y=v.y;COG.Loopage.join({execute:function(z,F){o=z-u;s=l(v,X);if(o<i&&s>t.inertiaTrigger){F.trigger("complete");C(v,X,s,o)}else o>i&&F.trigger("complete")},frequency:10})}}function Y(v){var u=0,o=0;if(v.offsetParent){do{u+=v.offsetLeft;o+=v.offsetTop;v=
v.offsetParent}while(v)}return m(u,o)}function y(v){var u=v.count,o=Array(u),s=Y(aa);for(u=u;u--;)o[u]=m(v.touches[u].x-s.x,v.touches[u].y-s.y);return o}function E(){W&&W.trigger.apply(null,arguments)}function A(v){var u=v.target?v.target:v.srcElement;if(ja||u&&u===aa){a(K,v);if(K.count!==0){U=null;V.x=0;V.y=0;ka=true;O=false;ga=(new Date).getTime();d(v);u.style.cursor="move";E("inertiaCancel");la=ga;if(v=K.count>0?K.touches[0]:null){E("touchStart",v.x,v.y);if(la-ha<q)if((v=f(K.touches[0],Z.touches[0]))&&
Math.abs(v.x)<t.maxDistDoubleTap&&Math.abs(v.y)<t.maxDistDoubleTap)O=true;J=p;b(Z,K)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function I(v){var u=v.target?v.target:v.srcElement,o=0;if(ja||u&&u===aa){a(R,v);if(R.count>0){X.x=R.touches[0].x;X.y=R.touches[0].y}if(ka){D&&d(v);if(R.count>1){K.count===1&&b(K,R);o=g(K)-g(R)}if(J===p)if((v=e(R,K))&&(Math.abs(v.x)>=w||Math.abs(v.y)>=w))J=r;if(J!==p)if(!o||Math.abs(o)<x){if(U=e(R,Z)){V.x-=U.x;V.y-=U.y;da.x-=U.x;da.y-=U.y}E("pan",
da.x,da.y);da.x=0;da.y=0;J=r}else{E("pinchZoom",y(K),y(R));J=n}b(Z,R)}}}function B(v){var u=v.target?v.target:v.srcElement;if(ka&&(ja||u&&u===aa)){a(S,v,"changedTouches");var o=S.touches[0];D&&d(v);v=(new Date).getTime();ha=la;if(J===p)P||(P=setTimeout(function(){P=0;var s=O?"doubleTap":"tap",z=K.touches[0],F=Y(aa);F=m(z.x-F.x,z.y-F.y);E(s,z,F)},q+50));else if(J==r){E("panEnd",V.x,V.y);oa&&H(o,v)}else J==n&&E("pinchZoomEnd",y(K),y(Z),v-ga);u.style.cursor="default";ka=false}}function L(v){var u=v.target?
v.target:v.srcElement;if(ja||u&&u===aa){if(v.detail){u=-v.detail*j;u=m(v.axis===1?u:0,v.axis===2?u:0)}else u=m(v.wheelDeltaX,v.wheelDeltaY);var o=u.y!==0?Math.abs(u.y/j):0;if(X&&o!==0){var s=m(X.x-aa.offsetLeft,X.y-aa.offsetTop);E("wheelZoom",s,Math.pow(2,u.y>0?o:-o))}d(v)}}t=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,
wheelZoomHandler:null},t);var O=false,P=0,M=T5.getConfig(),K=c(),R=c(),Z=c(),S=c(),U=null,V=m(),da=m(),J=null,ka=false,ga=0,ea=[],X=m(),oa=false,na,ia,la=0,ha=0,aa=t.element,W=t.observable,ja=typeof FlashCanvas!=="undefined",pa={supportsTouch:D,addListeners:function(v){ea.push(v)},decoupleListeners:function(v){for(var u=0;v&&u<ea.length;u++)if(ea[u].listenerId===v){ea.splice(u,1);break}},release:function(){M.unbindEvent(D?"touchstart":"mousedown",A,false);M.unbindEvent(D?"touchmove":"mousemove",I,
false);M.unbindEvent(D?"touchend":"mouseup",B,false);if(!D){window.removeEventListener("mousewheel",L,false);window.removeEventListener("DOMMouseScroll",L,false)}},inertiaEnable:function(v,u){oa=true;na=v;ia=u?Math.min(u.width,u.height):500},inertiaDisable:function(){oa=false}};if(typeof D==="undefined")D=T5.getConfig().supportsTouch;M.bindEvent(D?"touchstart":"mousedown",A,false);M.bindEvent(D?"touchmove":"mousemove",I,false);M.bindEvent(D?"touchend":"mouseup",B,false);if(!D){M.bindEvent("mousewheel",
L,window);M.bindEvent("DOMMouseScroll",L,window)}return pa},T=[];return{capture:function(t,C){if(!t)throw Error("Unable to capture touch of null element");if(!t.id)t.id="touchable_"+G++;var H=T[t.id];if(!H){H=new $(COG.extend({element:t},C));T[t.id]=H}if(C){C.listenerId&&H.decoupleListeners(C.listenerId);C.listenerId=++Q;H.addListeners(C)}return H},release:function(t){if(t&&t.id&&T[t.id]){T[t.id].release();delete T[t.id]}}}}();
T5=function(){var f=function(d,a){return{x:d?d:0,y:a?a:0}},l=function(){function d(a,m){if(!m)m=a.length;if(m<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var h={edges:Array(m-1),accrued:Array(m-1),total:0},j=l.diff,i=0;i<m-1;i++){var k=j(a[i],a[i+1]);h.edges[i]=Math.sqrt(k.x*k.x+k.y*k.y);h.accrued[i]=h.total+h.edges[i];h.total+=h.edges[i]}return h}return{VECTOR_SIMPLIFICATION:4,create:function(a,m){return new f(a,m)},add:function(){for(var a=new f,m=
arguments.length;m--;){a.x+=arguments[m].x;a.y+=arguments[m].y}return a},absSize:function(a){return Math.max(Math.abs(a.x),Math.abs(a.y))},diff:function(a,m){return new f(a.x-m.x,a.y-m.y)},copy:function(a){return a?new f(a.x,a.y):null},invert:function(a){return new f(-a.x,-a.y)},offset:function(a,m,h){return new f(a.x+m,a.y+(h?h:m))},edges:d,distance:function(a,m){return d(a,m).total},simplify:function(a,m){if(!a)return null;m=m?m:l.VECTOR_SIMPLIFICATION;for(var h=[],j=null,i=a.length;i--;){var k=
a[i];if(include=!j||i===0||Math.abs(k.x-j.x)+Math.abs(k.y-j.y)>m){h.unshift(k);j=k}}return h},theta:function(a,m,h){h=Math.asin((a.y-m.y)/h);return a.x>m.x?h:Math.PI-h},pointOnEdge:function(a,m,h,j){m=new f(Math.cos(h)*j,Math.sin(h)*j);return new f(a.x-m.x,a.y-m.y)},getRect:function(a){var m=a.length;if(m>1)return new g(Math.min(a[0].x,a[m-1].x),Math.min(a[0].y,a[m-1].y),Math.abs(a[0].x-a[m-1].x),Math.abs(a[0].y-a[m-1].y))},toString:function(a){return a.x+", "+a.y}}}(),g=function(d,a,m,h){return{origin:new f(d,
a),dimensions:new b(m,h),invalid:false}},e=function(){return{bottomRight:function(d){return l.offset(d.origin,d.dimensions.width,d.dimensions.height)},empty:function(){return new g(0,0,0,0)},copy:function(d){return d?new g(d.origin.x,d.origin.y,d.dimensions.width,d.dimensions.height):null},getCenter:function(d){return new f(d.origin.x+d.dimensions.width/2,d.origin.y+d.dimensions.height/2)},isEmpty:function(d){return d.dimensions.width===0||d.dimensions.height===0},union:function(){if(!(arguments.length<
2)){for(var d=arguments[0].origin.y,a=arguments[0].origin.x,m=d+arguments[0].dimensions.height,h=a+arguments[0].dimensions.width,j=Array.prototype.slice.call(arguments,1),i=j.length;i--;){var k=j[i].origin.y,q=j[i].origin.x,x=k+j[i].dimensions.height,p=q+j[i].dimensions.width;d=d<k?d:k;a=a<q?a:q;m=m>x?m:x;h=h>p?h:p}arguments[0].origin.x=a;arguments[0].origin.y=d;arguments[0].dimensions.width=h-a;arguments[0].dimensions.height=m-d}}}}(),b=function(d,a){return{width:d?d:0,height:a?a:0}},c=function(){return{getAspectRatio:function(d){return d.height!==
0?d.width/d.height:1},getCenter:function(d){return new f(d.width/2,d.height/2)},getSize:function(d){return Math.sqrt(Math.pow(d.width,2)+Math.pow(d.height,2))}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},Vector:f,V:l,Dimensions:b,D:c,Rect:g,R:e}}();
(function(){function f(){for(;x.length>0;){var r=x.shift();document.location=r}q=0}function l(r){for(var n=true,w=p.length;w--;)n=n&&r!=p[w];return n}function g(r,n){var w=[];for(var G in n)G&&w.push(G+"="+escape(n[G]));return"tile5://"+r+"/"+(w.length>0?"?"+w.join("&"):"")}function e(r,n){l(r)&&COG.Log.info("would push url: "+g(r,n))}function b(r,n){if(l(r)){x.push(g(r,n));q||(q=setTimeout(f,100))}}function c(r){return function(n,w,G){(G?G:r?document.body:document).addEventListener(n,w,false)}}function d(r){return function(n,
w,G){(G?G:r?document.body:document).removeEventListener(n,w,false)}}function a(r,n,w){(w?w:document).attachEvent("on"+r,n)}function m(r,n,w){(w?w:document).detachEvent("on"+r,n)}function h(){j={base:{name:"Unknown",bindEvent:c(),unbindEvent:d(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:a,unbindEvent:m,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:b,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:b},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:b},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:d(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:b},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:b}};i=[j.froyo,j.android,j.ipod,j.iphone,j.ipad,j.ie]}var j=null,i=[],k=null,q=0,x=[],p=["view.wake","tile.loaded"];T5.getConfig=function(){j||h();if(!k){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var r=0;r<i.length;r++){var n=i[r];if(n.regex&&n.regex.test(navigator.userAgent)){k=T5.ex({},j.base,n);COG.Log.info("PLATFORM DETECTED AS: "+k.name);break}}if(!k){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
k=j.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return k}})();
T5.Dispatcher=function(){var f=[],l={execute:function(g){var e=l.findAction(g);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(g){for(var e=f.length;e--;)if(f[e].id==g)return f[e];return null},getRegisteredActions:function(){return[].concat(f)},getRegisteredActionIds:function(){for(var g=[],e=f.length;e--;)f[e].id&&g.push(f[e].id);return g},registerAction:function(g){g&&g.id&&f.push(g)},Action:function(g){g=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},g);var e={id:g.id,execute:function(){g.execute&&g.execute.apply(this,arguments)},getParam:function(b){return g[b]?g[b]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,g.title,g.icon)}};g.autoRegister&&l.registerAction(e);return e},Agent:function(g){g=COG.extend({name:"Untitled",translator:null,execute:null},g);var e={getName:function(){return g.name},getParam:function(b){return g[b]},getId:function(){return COG.toID(e.getName())},run:function(b,c){if(g.execute){var d=
g.translator?g.translator(b):b;g.execute.call(e,d,function(a,m){c&&c(a,m,d)})}}};return e},runAgents:function(g,e,b){for(var c=0;c<g.length;c++)g[c].run(e,b)}};return l}();
T5.Resources=function(){var f="",l={},g={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:f+e},setBasePath:function(e){f=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var b=function(c){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(c)})};e.cacheable&&l[e.filename]?b(l[e.filename]):COG.xhr({url:g.getPath(e.filename),dataType:e.dataType,success:function(c){if(e.cacheable)l[e.filename]=c;b(c)},error:function(c,d,a){COG.Log.error("error loading resource ["+
e.filename+"], error = "+a)}})},loadSnippet:function(e,b){/\.\w+$/.test(e)||(e+=".html");g.loadResource({filename:"snippets/"+e,callback:b,dataType:"html"})}};return g}();
T5.Images=function(){function f(p,r){var n=document.createElement("canvas");n.width=p?p:0;n.height=r?r:0;if(typeof FlashCanvas!=="undefined"){n.id="tmpCanvas"+c++;n.style.cssText="position: absolute; top: -"+(r-1)+"px; left: -"+(p-1)+"px;";document.body.appendChild(n);FlashCanvas.initElement(n)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(n);return n}function l(){var p=d[this.id];if(p&&p.image.complete&&p.image.width>0){p.loaded=true;p.hitCount=1;for(var r=h.length;r--;)if(h[r].image.src==
this.src){h.splice(r,1);break}if(p.background||p.postProcess||p.drawBackground||p.customDraw)if(p.image){r=f(p.realSize?p.realSize.width:image.width,p.realSize?p.realSize.height:image.height);var n=r.getContext("2d"),w=p.offset?p.offset:new T5.Vector;p.background&&n.drawImage(p.background,0,0);p.drawBackground&&p.drawBackground(n);p.customDraw?p.customDraw(n,p):n.drawImage(p.image,w.x,w.y);p.postProcess&&p.postProcess(n,p);p.image=r}p.loadCallback&&p.loadCallback(this,false);j[j.length]={url:this.src,
created:p.requested};delete d[this.id];g()}}function g(){if(!k){var p=T5.getConfig().maxImageLoads;k=COG.Loopage.join({execute:function(r,n){if(!p||h.length<p){var w=m.shift();if(w){h[h.length]=w;w.image.onload=l;w.image.src=T5.Resources.getPath(w.url);w.requested=T5.ticks()}else n.trigger("complete")}},frequency:10});k.bind("complete",function(){k=null})}}function e(){q=true;try{var p=j.length/2>>0;if(p>0){j.sort(function(n,w){return n.created-w.created});for(var r=p;r--;)delete b[j[r].url];j.splice(0,
p)}}finally{q=false}COG.say("imagecache.cleared")}var b={},c=0,d={},a=0,m=[],h=[],j=[],i=0,k=null,q=false,x={avgImageSize:25,loadTimeout:10,cancelLoad:function(){h=[]},get:function(p){var r=null,n=null;q||(r=b[p]);if((n=r?r.image:null)&&(n.getContext||n.complete&&n.width>0))return n},load:function(p,r,n){var w=b[p];if(w){w.hitCount++;w.image.complete&&r&&r(w.image,true)}else{w=T5.ex({url:p,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,loadCallback:r},n);w.image.id="resourceLoaderImage"+
a++;b[p]=w;d[w.image.id]=w;m[m.length]=w;g()}return w},newCanvas:f,stats:function(){return{imageLoadingCount:h.length,queuedImageCount:m.length,imageCacheFullness:i}}};COG.Loopage.join({execute:function(p){for(var r=false,n=0,w=T5.getConfig();n<h.length;)if(p-h[n].requested>x.loadTimeout*1E3){h.splice(n,1);r=true}else n++;r&&g();if(w&&w.imageCacheMaxSize){i=j.length*x.avgImageSize/w.imageCacheMaxSize;i>=1&&e()}},frequency:2E4});return x}();
T5.TimeLord=function(){var f=/^P(\d+Y)?(\d+M)?(\d+D)?$/,l=/^(\d+H)?(\d+M)?(\d+S)?$/,g=function(b,c){return{days:b?b:0,seconds:c?c:0}},e={8601:function(b){b=b.split("T");var c=null;c=null;var d=0,a=0;f.lastIndex=-1;c=f.exec(b[0]);d+=c[3]?parseInt(c[3].slice(0,-1),10):0;l.lastIndex=-1;c=l.exec(b[1]);a+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;a+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;a+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new g(d,a)}};return{Duration:g,addDuration:function(){for(var b=new g,
c=arguments.length;c--;){b.days+=arguments[c].days;b.seconds+=arguments[c].seconds}if(b.seconds>=86400){b.days+=~~(b.seconds/86400);b.seconds%=86400}return b},parseDuration:function(b,c){var d=c?e[c]:null;if(d)return d(b);COG.Log.warn("Could not find duration parser for specified format: "+c);return new g},formatDuration:function(b){var c,d,a="";if(b.days)a=b.days+" days ";if(b.seconds){b=b.seconds;if(b>=3600){c=~~(b/3600);b-=c*3600}if(b>=60){d=Math.round(b/60);b-=d*60}if(c)a=a+c+(c>1?" hrs ":" hr ")+
(d?(d>10?d:"0"+d)+" min ":"");else if(d)a=a+d+" min";else if(b>0)a=a+(b>10?b:"0"+b)+" sec"}return a}}}();
(function(){var f=Math.PI*2,l=Math.PI/2,g=Math.abs,e=Math.pow,b=Math.sin,c=Math.asin,d=Math.cos,a=1.70158,m={linear:function(h,j,i,k){return i*h/k+j},backin:function(h,j,i,k){return i*(h/=k)*h*((a+1)*h-a)+j},backout:function(h,j,i,k){return i*((h=h/k-1)*h*((a+1)*h+a)+1)+j},backinout:function(h,j,i,k){return(h/=k/2)<1?i/2*h*h*(((a*=1.525)+1)*h-a)+j:i/2*((h-=2)*h*(((a*=1.525)+1)*h+a)+2)+j},bouncein:function(h,j,i,k){return i-m.bounceout(k-h,0,i,k)+j},bounceout:function(h,j,i,k){return(h/=k)<1/2.75?
i*7.5625*h*h+j:h<2/2.75?i*(7.5625*(h-=1.5/2.75)*h+0.75)+j:h<2.5/2.75?i*(7.5625*(h-=2.25/2.75)*h+0.9375)+j:i*(7.5625*(h-=2.625/2.75)*h+0.984375)+j},bounceinout:function(h,j,i,k){return h<k/2?m.bouncein(h*2,0,i,k)/2+j:m.bounceout(h*2-k,0,i,k)/2+i/2+j},cubicin:function(h,j,i,k){return i*(h/=k)*h*h+j},cubicout:function(h,j,i,k){return i*((h=h/k-1)*h*h+1)+j},cubicinout:function(h,j,i,k){if((h/=k/2)<1)return i/2*h*h*h+j;return i/2*((h-=2)*h*h+2)+j},elasticin:function(h,j,i,k,q,x){if(h==0)return j;if((h/=
k)==1)return j+i;x||(x=k*0.3);if(!q||q<g(i)){q=i;i=x/4}else i=x/f*c(i/q);return-(q*e(2,10*(h-=1))*b((h*k-i)*f/x))+j},elasticout:function(h,j,i,k,q,x){var p;if(h==0)return j;if((h/=k)==1)return j+i;x||(x=k*0.3);if(!q||q<g(i)){q=i;p=x/4}else p=x/f*c(i/q);return q*e(2,-10*h)*b((h*k-p)*f/x)+i+j},elasticinout:function(h,j,i,k,q,x){var p;if(h==0)return j;if((h/=k/2)==2)return j+i;x||(x=k*0.3*1.5);if(!q||q<g(i)){q=i;p=x/4}else p=x/f*c(i/q);if(h<1)return-0.5*q*e(2,10*(h-=1))*b((h*k-p)*f/x)+j;return q*e(2,
-10*(h-=1))*b((h*k-p)*f/x)*0.5+i+j},quadin:function(h,j,i,k){return i*(h/=k)*h+j},quadout:function(h,j,i,k){return-i*(h/=k)*(h-2)+j},quadinout:function(h,j,i,k){if((h/=k/2)<1)return i/2*h*h+j;return-i/2*(--h*(h-2)-1)+j},sinein:function(h,j,i,k){return-i*d(h/k*l)+i+j},sineout:function(h,j,i,k){return i*b(h/k*l)+j},sineinout:function(h,j,i,k){return-i/2*(d(Math.PI*h/k)-1)+j}};T5.easing=function(h){return m[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(h,j){m[h.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=j}})();
T5.Tween=function(f){f=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},f);var l=T5.ticks(),g=[],e=false,b=0,c=0,d={cancelOnInteract:f.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(a){f.complete&&f.complete(a)},update:function(a){try{var m=f.tweenFn(a-l,b,c,f.duration);if(f.target)f.target[f.property]=m;for(var h=g.length;h--;)g[h](m,void 0);if(e=l+f.duration<=a){if(f.target)f.target[f.property]=
f.tweenFn(f.duration,b,c,f.duration);for(var j=g.length;j--;)g[j](m,true)}}catch(i){COG.Log.exception(i)}},requestUpdates:function(a){g.push(a)}};b=f.target&&f.property&&f.target[f.property]?f.target[f.property]:f.startValue;if(typeof f.endValue!=="undefined")c=f.endValue-b;if(c==0)e=true;T5.wakeTweens();return d};
(function(){function f(b){if(e)return l.length;e=true;try{for(var c=0;c<l.length;)if(l[c].isComplete()){l[c].triggerComplete(false);l.splice(c,1)}else{l[c].update(b);c++}}finally{e=false}l.length===0&&g.trigger("complete");return l.length}var l=[],g=null,e=false;T5.tweenValue=function(b,c,d,a,m){b=new T5.Tween({startValue:b,endValue:c,tweenFn:d,complete:a,duration:m});l.push(b);return b};T5.tween=function(b,c,d,a,m,h){b=new T5.Tween({target:b,property:c,endValue:d,tweenFn:a,duration:h,complete:m});
l.push(b);return b};T5.tweenVector=function(b,c,d,a,m,h){var j=[];if(b){var i=b.x==c,k=b.y==d;i||j.push(T5.tween(b,"x",c,a,function(){(i=true)&&k&&m()},h));k||j.push(T5.tween(b,"y",d,a,function(){k=true;i&&k&&m()},h))}return j};T5.cancelAnimation=function(b){if(!e){e=true;try{for(var c=0;c<l.length;)if(!b||b(l[c])){l[c].triggerComplete(true);l.splice(c,1)}else c++}finally{e=false}}};T5.isTweening=function(){return l.length>0};T5.wakeTweens=function(){if(!g){g=COG.Loopage.join({execute:f,frequency:20});
g.bind("complete",function(){g=null})}}})();(function(){var f={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,PINCH:16,FREEZE:128};T5.viewState=function(){for(var l=0,g=arguments.length;g--;){var e=f[arguments[g].toUpperCase()];if(e)l|=e}return l}})();
T5.ViewLayer=function(f){f=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","PINCH")},f);var l=null,g=false,e=false,b=f.supportFastDraw,c=f.id,d=T5.viewState("ACTIVE"),a=f.validStates,m=0,h=0,j=T5.ex({addToView:function(i){i.setLayer(c,j)},shouldDraw:function(i,k,q){i=(i&a)!==0&&(g?b:true);return i=e||q||m!==k.x||h!==k.y},cycle:function(){},draw:function(){},remove:function(){COG.say("layer.remove",{id:c})},changed:function(){e=true;l&&
l.trigger("invalidate")},getId:function(){return c},setId:function(i){c=i},getParent:function(){return l},setParent:function(i){g=(l=i)?l.fastDraw&&displayState!==d:false;j.trigger("parentChange",l)}},f);COG.observable(j);j.bind("drawComplete",function(i,k){e=false;m=k.x;h=k.y});return j};
T5.View=function(f){function l(o,s,z,F){W=la;w();if(F&&f.inertia){O=true;h(T+s,t+z,f.panAnimationEasing,f.panAnimationDuration)}else F||h(T+s,t+z)}function g(){W=ia;O=false;COG.Loopage.join({execute:w,after:50,single:true})}function e(o,s){S=ja(o);U=ja(s);var z=pa(S.dimensions),F=pa(U.dimensions);X=v(S);B=v(U);J=S&&z!==0?F/z:1}function b(o,s,z){e(s,z);if(Z=J!==1){W=ha;w()}}function c(o,s,z,F){e(s,z);if(f.adjustScaleFactor){J=f.adjustScaleFactor(J);COG.Log.info("scale factor adjusted to: "+J)}if(F<
f.pinchZoomAnimateTrigger){k(ga,J,X,q(),T5.easing("sine.out"),function(){a();J=1},300);J=ga}else{a();J=1}}function d(o,s,z){u.zoom(s,Math.min(Math.pow(2,Math.round(Math.log(z))),8),500)}function a(){Z=false;u.trigger("scale",J,S?q():B);W=ia;w()}function m(){clearTimeout(da);da=setTimeout(j,50)}function h(o,s,z,F,N){function ba(){ca+=1;if(ca>=2){g(0,0);N&&N()}}var ca=0;if(z){o=T5.tweenValue(T,o,z,ba,F);s=T5.tweenValue(t,s,z,ba,F);o.cancelOnInteract=true;o.requestUpdates(function(fa){T=fa;O=true;w()});
s.cancelOnInteract=true;s.requestUpdates(function(fa){t=fa;O=true;w()})}else{T=o;t=s}}function j(){var o;if(D){COG.Touch.release(D);if(f.autoSize&&D.parentNode){o=D.parentNode.getBoundingClientRect();if(o.height!==0&&o.width!==0){D.height=o.height;D.width=o.width}}try{if(!D.id)D.id=f.id+"_canvas";$=D.getContext("2d");$.clearRect(0,0,D.width,D.height)}catch(s){COG.Log.exception(s);throw Error("Could not initialise canvas on specified view element");}na=COG.Touch.capture(D,{observable:u});if(A.height!==
D.height||A.width!==D.width){A=new T5.Dimensions(D.width,D.height);u.trigger("resize",D.width,D.height);for(o=Q;o--;)G[o].trigger("resize",D.width,D.height)}f.inertia&&na.inertiaEnable(f.panAnimationDuration,A);for(o=Q;o--;)G[o].trigger("contextChanged",$);n()}}function i(o,s){s.setId(o);s.added=T5.ticks();s.trigger("contextChanged",$);s.setParent(u);G.push(s);G.sort(function(z,F){var N=F.zindex-z.zindex;if(N===0)N=F.added-z.added;return N});Q=G.length;return s}function k(o,s,z,F,N,ba,ca){function fa(){ba&&
ba();a();J=1;ea=null}Z=true;X=T5.V.copy(z);B=T5.V.copy(F);S=null;if(N)T5.tweenValue(0,s-o,N,fa,ca?ca:1E3).requestUpdates(function(ma){ea=ma/(s-o);J=o+ma;W=ha;w();u.trigger("animate")});else{J=targetScaleFactor;fa()}}function q(){var o=T5.D.getCenter(A),s=T5.V.distance([B,o]),z=T5.V.theta(B,o,s),F=T5.V.diff(X,B);o=T5.V.pointOnEdge(B,o,z,s/J);o.x+=F.x;o.y+=F.y;return o}function x(){u.trigger("idle");L=true;P=0}function p(o,s,z,F){var N=O?la:y?T5.viewState("FROZEN"):W,ba=(N&ha)!==0,ca=0;if(H||ba){o.clearRect(0,
0,D.width,D.height);H=false}if(ba){T5.D.getCenter(A);var fa=(ea?ea:1)/2,ma=T5.V.diff(X,B);if(S){K.x=B.x+ma.x;K.y=B.y+ma.y}else{K.x=B.x-ma.x*fa;K.y=B.y-ma.y*fa}s=T5.V.offset(s,K.x,K.y)}o.save();try{ga=J;if(E!==1)o.scale(E,E);else if(ba){o.translate(B.x,B.y);o.scale(J,J)}for(ca=Q;ca--;)if(G[ca].shouldDraw(N,s,z)){G[ca].draw(o,s,A,N,u,z,F);G[ca].trigger("drawComplete",s,F)}}finally{o.restore()}COG.Log.trace("draw complete",F)}function r(o,s){var z=false,F=!O&&(W===ha||W===la),N=V||W===T5.viewState("PAN")||
W===T5.viewState("PINCH")||T5.isTweening();C.x=T>>0;C.y=t>>0;if(F){T5.cancelAnimation(function(ba){return ba.cancelOnInteract});L=false;if(P!==0){clearTimeout(P);P=0}}for(F=Q;F--;){if(G[F].animated)W|=aa;z=G[F].cycle(o,C,W,N)||z}N=N||(W&aa)!==0;if(z=z||N||J!==1&&J!==ka){p($,C,N,o);ka=J;V=false}if(!z&&I===0&&!oa){if(!L&&P===0)P=setTimeout(x,500);s.trigger("complete")}I=0;COG.Log.trace("Completed draw cycle",o)}function n(){V=true;w()}function w(){I+=1;if(!(y||Y)){Y=COG.Loopage.join({execute:r,frequency:30});
Y.bind("complete",function(){Y=null})}}f=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10},f);var G=[],Q=0,D=document.getElementById(f.container),$=null,T=0,t=0,C=new T5.Vector,H=false,Y=null,y=false,E=1,A=new T5.Dimensions,I=0,B=null,L=false,O=false,P=0,M=0,K=new T5.Vector,R=0,Z=false,S=null,U=null,V=false,
da=0,J=1,ka=0,ga=1,ea=null,X=null,oa=typeof FlashCanvas!=="undefined",na=null,ia=T5.viewState("ACTIVE"),la=T5.viewState("PAN"),ha=T5.viewState("PINCH"),aa=T5.viewState("ANIMATING"),W=ia,ja=T5.V.getRect,pa=T5.D.getSize,v=T5.R.getCenter,u={id:f.id,deviceScaling:E,fastDraw:f.fastDraw||T5.getConfig().requireFastDraw,animate:function(o,s,z,F,N){k(J,o,s,z,F,N)},centerOn:function(o){T=o.x-D.width/2;t=o.y-D.height/2},getDimensions:function(){return A},getZoomCenter:function(){return K},getLayer:function(o){for(var s=
0;s<Q;s++)if(G[s].getId()==o)return G[s];return null},setLayer:function(o,s){for(var z=0;z<Q;z++)if(G[z].getId()===o){G.splice(z,1);break}s&&i(o,s);n()},eachLayer:function(o){for(var s=Q;s--;)o(G[s])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");H=true;n()},invalidate:n,freeze:function(){y=true},unfreeze:function(){y=false;w()},resize:function(o,s){if(D){D.width=o;D.height=s;j()}},scale:function(o,s,z,F,N){F||(F=T5.D.getCenter(A));N||(N=T5.D.getCenter(A));
u.animate(o,F,N,s,z);return u},removeLayer:function(o){a:{for(var s=Q;s--;)if(G[s].getId()==o){o=s;break a}o=-1}if(o>=0&&o<Q){COG.say("layer.removed",{layer:G[o]});G.splice(o,1);n()}Q=G.length},getOffset:function(){return C},updateOffset:h,zoom:function(o,s,z){O=false;J=s;Z=J!==1;X=T5.D.getCenter(A);B=J>1?T5.V.copy(o):T5.D.getCenter(A);S=null;clearTimeout(M);if(Z){W=ha;w();if(z)M=setTimeout(function(){a();J=1},parseInt(z,10))}}};COG.listen("layer.remove",function(o){o.id&&u.removeLayer(o.id)});E=
T5.getConfig().getScaling();u.markers=i("markers",new T5.MarkerLayer);COG.observable(u);u.bind("wake",w);u.bind("invalidate",n);if(f.pannable){u.bind("pan",l);u.bind("panEnd",g);u.bind("inertiaCancel",function(){O=false;w()})}if(f.scalable){u.bind("pinchZoom",b);u.bind("pinchZoomEnd",c);u.bind("wheelZoom",d)}u.bind("tap",function(o,s,z){for(var F=T5.V.offset(z,T,t),N=G.length;N--;)o.cancel=o.cancel||G[N].trigger("tap",s,z,F).cancel});COG.configurable(u,["inertia","container","rotation","tapExtent"],
COG.paramTweaker(f,null,{container:function(o,s){D=document.getElementById(s);j()},rotation:function(o,s){R=s}}),true);j();f.autoSize&&window.addEventListener("resize",m,false);return u};
T5.PathLayer=function(f){function l(j){j.syncVectors(c);d&&j.syncVectors(d);h.trigger("tidy")}f=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},f);var g=false,e=[],b=null,c=[],d=null,a=0,m=[],h=T5.ex(new T5.ViewLayer(f),{getAnimation:function(j,i,k,q){var x="pathAnimation"+a++;m.push(x);return new T5.AnimatedPathLayer({id:x,path:e,zindex:f.zindex+1,easing:j?j:T5.easing("sine.inout"),duration:i?i:5E3,drawIndicator:k,autoCenter:q?q:false})},cycle:function(j,i,k,q){return q},draw:function(j,
i){var k,q=e.length;j.save();try{T5.applyStyle(j,f.style);if(q>0){j.beginPath();j.moveTo(e[q-1].x-i.x,e[q-1].y-i.y);for(k=q;k--;)j.lineTo(e[k].x-i.x,e[k].y-i.y);j.stroke();if(b){j.fillStyle=f.waypointFillStyle;for(k=b.length;k--;){j.beginPath();j.arc(b[k].x-i.x,b[k].y-i.y,2,0,Math.PI*2,false);j.stroke();j.fill()}}}}finally{j.restore()}g=false},updateCoordinates:function(j,i){var k=h.getParent();k=k?k.getTileLayer():null;c=j;d=i;COG.Log.info("updating coordinates, grid = "+k);k&&l(k)}});h.bind("gridUpdate",
function(j,i){l(i);for(var k=m.length;k--;)COG.say("layer.remove",{id:m[k]});m=[]});h.bind("tidy",function(){e=T5.V.simplify(c,f.pixelGeneralization);b=T5.V.simplify(d,f.pixelGeneralization);g=true;h.changed()});return h};
T5.Poly=function(f,l){l=T5.ex({fill:false,style:null},l);var g=false,e=l.fill,b=l.style,c=[],d={draw:function(a,m,h){if(g){var j=true,i=b?T5.applyStyle(a,l.style):null;a.beginPath();for(var k=c.length;k--;){var q=c[k].x-m,x=c[k].y-h;if(j){a.moveTo(q,x);j=false}else a.lineTo(q,x)}e&&a.fill();a.stroke();i&&T5.applyStyle(a,i)}},resync:function(a){a.syncVectors(f);c=f.length<=3?f:T5.V.simplify(f)}};g=f&&f.length>=2;return d};
T5.PolyLayer=function(f){f=T5.ex({zindex:80,style:null},f);var l=[],g=false,e=T5.ex(new T5.ViewLayer(f),{add:function(b){l.unshift(b)},cycle:function(){return g},draw:function(b,c,d,a){d=c.x;c=c.y;b.save();try{T5.applyStyle(b,f.style);for(var m=l.length;m--;)l[m].draw(b,d,c,a)}finally{b.restore()}g=false}});e.bind("gridUpdate",function(b,c){for(var d=l.length;d--;)l[d].resync(c);g=true;e.changed()});e.bind("parentChange",function(b,c){var d=c?c.getTileLayer():null;if(d)for(var a=l.length;a--;)l[a].resync(d)});
COG.configurable(e,["style"],COG.paramTweaker(f,null,null),true);return e};
T5.AnimatedPathLayer=function(f){function l(a,m,h){a.fillStyle="#FFFFFF";a.strokeStyle="#222222";a.beginPath();a.arc(h.x,h.y,4,0,Math.PI*2,false);a.stroke();a.fill()}f=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","PINCH"),drawIndicator:null,duration:2E3,autoCenter:false},f);var g=T5.V.edges(f.path),e,b=null,c=0;T5.tweenValue(0,g.total,f.easing,function(){d.remove()},f.duration).requestUpdates(function(a,m){c=a;m&&d.remove()});var d=
T5.ex(new T5.ViewLayer(f),{cycle:function(){for(var a=0;a<g.accrued.length&&g.accrued[a]<c;)a++;b=null;if(a<f.path.length-1){var m=c-(a>0?g.accrued[a-1]:0),h=f.path[a],j=f.path[a+1];e=T5.V.theta(h,j,g.edges[a]);b=T5.V.pointOnEdge(h,j,e,m);if(f.autoCenter)(a=d.getParent())&&a.centerOn(b)}return b},draw:function(a,m){if(b)(f.drawIndicator?f.drawIndicator:l)(a,m,new T5.Vector(b.x-m.x,b.y-m.y),e)}});return d};
T5.Annotation=function(f){f=T5.ex({xy:null,tweenIn:null,animationSpeed:null},f);var l=false,g=T5.ex(f,{xy:f.xy,isNew:true,isAnimating:function(){return l},draw:function(e,b,c,d,a){if(g.xy){if(g.isNew&&f.tweenIn){var m=g.xy.y;g.xy.y=b.y-20;l=true;T5.tween(g.xy,"y",m,f.tweenIn,function(){g.xy.y=m;l=false},f.animationSpeed?f.animationSpeed:250+Math.random()*500)}g.drawMarker(e,b,new T5.Vector(g.xy.x-b.x,g.xy.y-b.y),c,d,a);g.isNew=false}},drawMarker:function(e,b,c){e.beginPath();e.arc(c.x,c.y,4,0,Math.PI*
2,false);e.fill()},hitTest:function(e){return Math.abs(e.x-g.xy.x)<=4&&Math.abs(e.y-g.xy.y)<=4}});return g};
T5.ImageAnnotation=function(f){f=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null},f);var l=f.imageAnchor?T5.V.invert(f.imageAnchor):null,g=f.image,e=f.animatingImage;if(!g)(g=T5.Images.get(f.imageUrl))||T5.Images.load(f.imageUrl,function(c){g=c});if(!e)(e=T5.Images.get(f.imageUrl))||T5.Images.load(f.animatingImageUrl,function(c){e=c});var b=T5.ex(new T5.Annotation(f),{drawMarker:function(c,d,a){if((d=b.isAnimating()&&e?e:g)&&d.complete&&d.width>0){l||(l=
new T5.Vector(-d.width>>1,-d.height>>1));a=T5.V.offset(a,l.x,l.y);c.drawImage(d,a.x,a.y,d.width,d.height)}},hitTest:function(c){var d=b.xy.x,a=b.xy.y;return c.x>=d+l.x&&c.x<=d+(g.width+l.x)&&c.y>=a+l.y&&c.y<=a+(g.height+l.y)}});return b};
T5.MarkerLayer=function(f){function l(d,a){for(var m=e.length;m--;)a.syncVectors([e[m].xy])}function g(){var d=c.getParent().getTileLayer();d&&l(null,d);c.trigger("markerUpdate",e);c.changed()}f=T5.ex({zindex:100},f);var e=[],b=false,c=T5.ex(new T5.ViewLayer(f),{cycle:function(){return b},draw:function(d,a,m,h,j){b=false;for(m=e.length;m--;){e[m].draw(d,a,h,c,j);b=b||e[m].isAnimating()}return b?1:0},add:function(d){if(d&&typeof d.length!=="undefined")for(var a=d.length;a--;){if(d[a])e[e.length]=d[a]}else if(d)e[e.length]=
d;g()},clear:function(d){if(d)for(var a=0;a<e.length;a++)d(e[a])&&e.splice(a,1);else e=[];g()},find:function(d){var a=[];if(d)for(var m=e.length;m--;)if(d(e[m]))a[a.length]=e[m];return a}});c.bind("tap",function(d,a,m,h){for(var j=[],i=e.length;i--;)if(e[i].hitTest(h))j[j.length]=e[i];if(j.length>0)d.cancel=c.trigger("markerTap",a,m,j).cancel});c.bind("gridUpdate",l);return c};
T5.Style=function(f){function l(c){var d=f[c];typeof d!=="undefined"&&g.push(function(a){a[c]=d})}f=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var g=[],e={applyToContext:function(c){for(var d=g.length;d--;)g[d](c)}};for(var b in f)l(b);return e};
(function(){var f={},l={basic:new T5.Style({lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),waypoints:new T5.Style({lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"})};T5.applyStyle=function(g,e){var b=T5.styles[e]?T5.styles[e]:T5.styles.basic,c;if(g&&g.canvas){c=f[g.canvas.id];f[g.canvas.id]=e}b.applyToContext(g);return c};T5.loadStyles=function(g){COG.jsonp(g,function(e){T5.resetStyles(e)})};T5.resetStyles=function(g){var e={};for(var b in g)e[b]=new T5.Style(g[b]);T5.styles=T5.ex({},
l,e)};T5.styles=l})();(function(){T5.tileSize=256;T5.Tile=function(f){return f=T5.ex({x:0,y:0,gridX:0,gridY:0,dirty:true},f)};T5.EmptyTile=function(f){f=new T5.Tile(f);f.empty=true;return f};T5.ImageTile=function(f){f=T5.ex({url:"",sessionParamRegex:null,loading:false,loaded:false},f);return new T5.Tile(f)}})();
T5.TileGrid=function(f){function l(y,E){var A=T5.Vector(y*a-j.x,E*a-j.y);return new T5.EmptyTile({gridX:A.x,gridY:A.y,empty:true})}function g(y,E,A,I){var B=d*0.2>>0,L=new T5.Vector;if(y<0||y+A>d)L.x=y<0?-B:B;if(E<0||E+I>d)L.y=E<0?-B:B;return L}function e(y,E,A){var I=COG.Log.getTraceTicks(),B=0;new T5.Vector(d/2,d/2);if(A)c=[];if(y)for(A=0;A<d;A++)for(var L=0;L<d;L++){if(!c[B]){var O=y(L,A,m,d);O.gridX=L*a-j.x;O.gridY=A*a-j.y;c[B]=O}B++}h=y;k=E;COG.Log.trace("tile grid populated",I);Y.changed()}
function b(y,E,A,I){var B,L=[],O=false;y=new T5.Vector((y.x+j.x)*p>>0,(y.y+j.y)*p>>0);tilesNeeded=false;if(!t){B=Y.getParent().getDimensions();$=Math.ceil(B.width*p)+1;T=Math.ceil(B.height*p)+1;t=new T5.Vector(($-1)/2>>0,(T-1)/2>>0)}for(var P=T;P--;)for(var M=$;M--;){B=M+y.x>=0&&M+y.x<d?c[(P+y.y)*d+(M+y.x)]:null;var K=new T5.Vector(M-t.x,P-t.y);if(!B){Q=g(y.x,y.y,$,T);B=l(M+y.x,P+y.y)}O=B?(B.dirty=A||B.dirty)||O:O;L[L.length]={tile:B,centerness:T5.V.absSize(K)}}L.sort(function(R,Z){return Z.centerness-
R.centerness});n||(n=Array(L.length));for(A=L.length;A--;){n[A]=L[A].tile;Y.prepTile(n[A],E)}G=I;return O}f=T5.ex({tileSize:T5.tileSize,center:new T5.Vector,gridSize:25,shiftOrigin:null,supportFastDraw:true,allowShift:true},f);var c=Array(Math.pow(f.gridSize,2)),d=f.gridSize,a=f.tileSize,m=T5.V.offset(f.center,-Math.ceil(f.gridSize>>1)),h=null,j=new T5.Vector,i=false,k=null,q=Math.round(a/2),x=false,p=a?1/a:0,r=true,n=null,w=false,G=0;new T5.Vector;var Q=new T5.Vector;T5.getConfig();var D=d*a,$,T,
t,C=T5.viewState("ANIMATING"),H=T5.viewState("PINCH"),Y=T5.ex(new T5.ViewLayer(f),{gridDimensions:new T5.Dimensions(D,D),cycle:function(y,E,A,I){if(Q.x!==0||Q.y!==0){I=Q;var B=f.shiftOrigin;if(!(!f.allowShift||I.x===0&&I.y===0)){var L=COG.Log.getTraceTicks(),O=Array(c.length);O.length=c.length;for(var P=0;P<d;P++)for(var M=0;M<d;M++)O[M*d+P]=P+I.x>=0&&P+I.x<d?c[(M+I.y)*d+(P+I.x)]:null;c=O;m=B?B(m,I):T5.V.add(m,I);j.x+=-I.x*a;j.y+=-I.y*a;COG.Log.trace("tile storage shifted",L);e(h,k)}Q=new T5.Vector;
I=true}if(!x&&(A&H)===0)x=b(E,A,I,y);i=(A&C)!==0||T5.isTweening();return x},deactivate:function(){r=false},find:function(y){if(!y)return null;for(var E=c.length;E--;){var A=c[E];if(A&&y(A))return A}return null},prepTile:function(){},drawTile:function(){return false},getTileSize:function(){return a},clearTileRect:function(y,E,A,I){y.clearRect(E,A,I,I)},draw:function(y,E,A,I,B,L,O){if(r){var P=E.x;E=E.y;var M=A.width,K=A.height,R=true;if(n){for(var Z=n.length;Z--;){var S=n[Z],U=S.gridX-P,V=S.gridY-
E;S.x=U;S.y=V;if(S.empty){COG.Log.info("empty tile @ x: "+U+", y: "+V);Y.clearTileRect(y,U,V,a,I);R=false}else if(L||S.dirty){i&&Y.clearTileRect(y,U,V,a,I);R=Y.drawTile(y,S,U,V,I,L,O)&&R}M=U<M?U:M;K=V<K?V:K}M>0&&y.clearRect(0,0,M,A.height);K>0&&y.clearRect(0,0,A.width,K);R&&!w&&B.trigger("tileDrawComplete");x=false;w=R}}},getTileAtXY:function(y,E){for(var A=null,I=n?n.length:0;I--;){var B=n[I];if(B&&y>=B.x&&E>=B.y)if(y<=B.x+a&&E<=B.y+a){A=B;break}}COG.Log.info("looking for tile @ x: "+y+", y: "+E+
", found: "+A);return A},getTileVirtualXY:function(y,E,A){y=T5.V.add(new T5.Vector(y,E),T5.V.invert(m),j);y=new T5.Vector(y.x*a,y.y*a);if(A){y.x+=q;y.y+=q}return y},populate:function(y){e(y,null,true)}});Y.bind("resize",function(){COG.Log.info("captured resize");t=null});COG.listen("imagecache.cleared",function(){for(var y=c.length;y--;)if(c[y])c[y].loaded=false});COG.listen("tiler.repaint",function(){for(var y=c.length;y--;)if(c[y]){c[y].x=null;c[y].y=null}});return Y};
T5.ImageTileGrid=function(f){function l(k){function q(){var x=T5.Images.newCanvas(32,32),p=x.getContext("2d");p.fillStyle="#BBBBBB";p.fillRect(0,0,32,32);p.fillStyle="#C3C3C3";p.fillRect(0,0,16,16);p.fillRect(16,16,16,16);return x}if(!e||k!==e.width){e=T5.Images.newCanvas(k,k);k=e.getContext("2d");k.fillStyle=typeof FlashCanvas!=="undefined"?"#666666":k.createPattern(q(),"repeat");k.fillRect(0,0,e.width,e.height)}return e}f=T5.ex({emptyTile:function(k){if(!g||k!==g.width){g=T5.Images.newCanvas(k,
k);k=g.getContext("2d");k.fillStyle="rgba(150, 150, 150, 0.1)";k.fillRect(0,0,g.width,g.height)}return g}(T5.tileSize),panningTile:null,tileOffset:new T5.Vector,tileDrawArgs:{}},f);var g=f.emptyTile,e=f.panningTile?f.panningTile:l(T5.tileSize),b=T5.viewState("ACTIVE"),c=T5.viewState("PAN"),d=T5.getConfig().requireFastDraw,a=f.tileSize?f.tileSize:T5.tileSize,m=T5.Images.get,h=T5.Images.load,j=T5.ex({background:null,overlay:null,offset:new T5.Vector,realSize:new T5.Dimensions(a,a)},f.tileDrawArgs),
i=T5.ex(new T5.TileGrid(f),{clearTileRect:function(k,q,x,p,r){(r&c)===0&&k.clearRect(q,x,p,p)},drawTile:function(k,q,x,p,r,n){var w=q.url?m(q.url):null,G=false;if(w){k.drawImage(w,x,p);G=true}else if(n||(r&c)!==0)k.drawImage(e,x,p);else if(g&&!q.drawnEmpty){k.drawImage(g,x,p);q.drawnEmpty=true}q.dirty=false;return G},initTileUrl:function(){},prepTile:function(k,q){if(k&&!k.loading&&(!d||q===b)){k.url||i.initTileUrl(k);if(!m(k.url)){k.loading=true;h(k.url,function(){k.loaded=true;k.dirty=true;i.changed()},
j)}}}});return i};
T5.Tiler=function(f){f=T5.ex({container:"",drawCenter:false,datasources:{},tileLoadThreshold:"first"},f);var l=T5.ex(new T5.View(f),{getTileLayer:function(){return l.getLayer("grid0")},setTileLayer:function(g){l.setLayer("grid0",g);l.trigger("gridUpdate",g);l.eachLayer(function(e){e.trigger("gridUpdate",g)})},viewPixToGridPix:function(g){var e=l.getOffset();return new T5.Vector(g.x+e.x,g.y+e.y)},centerOn:function(g,e,b,c){var d=l.getTileLayer(),a=l.getDimensions();(d=d?d.getTileSize():0)&&l.updateOffset(g.gridX-
(a.width-d)*0.5>>0,g.gridY-(a.height-d)*0.5>>0,e,b,c)},cleanup:function(){l.removeLayer("grid0")},repaint:function(){COG.say("tiler.repaint");l.trigger("wake")},select:function(g){l.trigger("selectTile",g)}});l.bind("tap",function(g,e,b){if(g=l.getTileLayer())(b=g.getTileAtXY(b.x,b.y))&&l.trigger("selectTile",b)});return l};
