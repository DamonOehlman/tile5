COG=function(){var f=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,h=0,g={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,d=arguments.length,e=false,l,b,i,j;if(typeof a==="boolean"){e=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!g.isFunction(a))a={};if(d===c){a=this;--c}for(;c<d;c++)if((l=arguments[c])!=null)for(b in l){i=a[b];j=l[b];if(a!==j)if(e&&j&&(g.isPlainObject(j)||g.isArray(j))){i=i&&(g.isPlainObject(i)||g.isArray(i))?i:g.isArray(j)?[]:{};a[b]=g.extend(e,i,j)}else if(j!==
undefined)a[b]=j}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||m.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var d=a,e=arguments,l=1;if(c&&g.isArray(c)){e=c;l=0}for(l=l;l<e;l++)d=d&&typeof foo[e[l]]!=="undefined";return d},newModule:function(a){a=g.extend({id:null,requires:[],parent:null},a);if(a.parent)a=g.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+h++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,d=0;d<=c;d++)a=a.replace(RegExp("\\{"+d+"\\}","gi"),arguments[d+
1]);return a},wordExists:function(a,c){var d="";if(c.toString)c=c.toString();for(var e=0;e<c.length;e++)d+=!/\w/.test(c[e])?"\\"+c[e]:c[e];return RegExp("(^|\\s|\\,)"+d+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var d=f.exec(a);d;){a=a.replace(d[0],COG.XPath.first(d[1],c));f.lastIndex=0;d=f.exec(a)}return a}};return g}();
COG.Log=function(){function f(c,d){var e,l=d&&d.length>0?d[0]:"";for(e=1;d&&e<d.length;e++)l+=" "+(h&&COG.isPlainObject(d[e])?JSON.stringify(d[e]):d[e]);typeof console!=="undefined"&&console[c](l);for(e=0;e<m.length;e++)m[e].call(a,l,c)}var m=[],h=typeof JSON!=="undefined",g=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return g?(new Date).getTime():null},trace:function(c,d){if(g)console.markTimeline(c+(d?": "+(a.getTraceTicks()-d)+"ms":""))},debug:function(){f("debug",
arguments)},info:function(){f("info",arguments)},warn:function(){f("warn",arguments)},error:function(){f("error",arguments)},exception:function(c){a.error(arguments);for(var d in c)a.info("ERROR DETAIL: "+d+": "+c[d])},watch:function(c,d){try{d()}catch(e){a.exception(e,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return a}();
(function(){function f(g,a){g[a]||(g[a]=function(c){return g.configure(a,c)})}function m(g){g.gtConfId=COG.objId("configurable");g.gtConfig={};g.gtConfigFns=[];return g.gtConfig}var h={};COG.paramTweaker=function(g,a,c){return function(d,e){if(typeof e!=="undefined"){if(d in g)g[d]=e;c&&d in c&&c[d](d,e)}else return a&&d in a?a[d](d):g[d]}};COG.configurable=function(g,a,c,d){if(g){g.gtConfId||m(g);var e=g.gtConfId,l=g.gtConfig,b=g.gtConfigFns;h[e]=g;b.push(c);for(c=a.length;c--;){l[a[c]]=true;d&&
f(g,a[c])}if(!g.configure)g.configure=function(i,j){if(l[i]){for(var k=b.length;k--;){var n=b[k](i,j);if(typeof n!=="undefined")return n}return h[e]}return null}}}})();
(function(){function f(m,h){var g=m.gtObsHandlers;g[h]||(g[h]=[]);return g[h]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(h,g){var a=COG.objId("callback");f(m,h).unshift({fn:g,id:a});return a};m.trigger=function(h){var g=f(m,h),a={cancel:false,tickCount:(new Date).getTime()},c;if(!g)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var d=g.length;d--&&!a.cancel;)g[d].fn.apply(self,c);return a};m.unbind=
function(h,g){for(var a=f(m,h),c=0;a&&c<a.length;c++)if(a[c].id===g){a.splice(c,1);break}return m}}}}})();(function(){var f={},m=[];COG.addPipe=function(h){h("pipe.test",{});m.push(h)};COG.listen=function(h,g){f[h]||(f[h]=[]);g&&f[h].push(g)};COG.say=function(h,g){var a;for(a=m.length;a--;)m[a](h,g);if(f[h])for(a=f[h].length;a--;)f[h][a](g)}})();
COG.Loopage=function(){function f(j){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},j)}function m(j){e.push(j);h()}function h(){l&&clearTimeout(l);l=setTimeout(g,0);i=true}function g(){for(var j,k=(new Date).getTime(),n=d.length;e.length>0;){var x=e.shift();for(j=n;j--;)if(d[j].id===x){d.splice(j,1);break}i=true;n=d.length}if(i){b=a;for(j=n;j--;)b=d[j].frequency<b?d[j].frequency:b}for(j=n;j--;){x=k-d[j].lastTick;if(d[j].lastTick===0||x>=d[j].frequency){d[j].execute(k,
d[j]);d[j].lastTick=k;d[j].single&&d[j].trigger("complete")}}l=n?setTimeout(g,b):0}var a=6E4,c=0,d=[],e=[],l=0,b=a,i=true;return{join:function(j){var k=new f(j);if(k.after>0)k.lastTick=(new Date).getTime()+k.after;COG.observable(k);k.bind("complete",function(){m(k.id)});d.unshift(k);h();return k},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function f(b){return b<10?"0"+b:b}function m(b){a.lastIndex=0;return a.test(b)?'"'+b.replace(a,function(i){var j=e[i];return typeof j==="string"?j:"\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function h(b,i){var j,k,n,x,z=c,p,o=i[b];if(o&&typeof o==="object"&&typeof o.toJSON==="function")o=o.toJSON(b);if(typeof l==="function")o=l.call(i,b,o);switch(typeof o){case "string":return m(o);case "number":return isFinite(o)?String(o):"null";case "boolean":case "null":return String(o);
case "object":if(!o)return"null";c+=d;p=[];if(Object.prototype.toString.apply(o)==="[object Array]"){x=o.length;for(j=0;j<x;j+=1)p[j]=h(j,o)||"null";n=p.length===0?"[]":c?"[\n"+c+p.join(",\n"+c)+"\n"+z+"]":"["+p.join(",")+"]";c=z;return n}if(l&&typeof l==="object"){x=l.length;for(j=0;j<x;j+=1){k=l[j];if(typeof k==="string")if(n=h(k,o))p.push(m(k)+(c?": ":":")+n)}}else for(k in o)if(Object.hasOwnProperty.call(o,k))if(n=h(k,o))p.push(m(k)+(c?": ":":")+n);n=p.length===0?"{}":c?"{\n"+c+p.join(",\n"+c)+
"\n"+z+"}":"{"+p.join(",")+"}";c=z;return n}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,d,e={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;if(typeof JSON.stringify!=="function")JSON.stringify=function(b,i,j){var k;d=c="";if(typeof j==="number")for(k=0;k<j;k+=1)d+=" ";else if(typeof j==="string")d=j;if((l=i)&&typeof i!=="function"&&(typeof i!=="object"||typeof i.length!=="number"))throw Error("JSON.stringify");return h("",
{"":b})};if(typeof JSON.parse!=="function")JSON.parse=function(b,i){function j(n,x){var z,p,o=n[x];if(o&&typeof o==="object")for(z in o)if(Object.hasOwnProperty.call(o,z)){p=j(o,z);if(p!==undefined)o[z]=p;else delete o[z]}return i.call(n,x,o)}var k;b=String(b);g.lastIndex=0;if(g.test(b))b=b.replace(g,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){k=eval("("+b+")");return typeof i==="function"?j({"":k},""):k}throw new SyntaxError("JSON.parse");}})();
(function(){function f(h,g){var a=h.split("|"),c={};for(var d in g){var e=g[d];c[d]=a.length>e?a[e]:null}return c}var m={JSON:{parse:function(h){return JSON.parse(h)}},PDON:{parse:function(h){var g=null,a=[];h=h.split("\n");for(var c=0;c<h.length;c++){var d=h[c];if(g)a.push(f(d,g));else if(d){g=d.split("|");d={};for(var e=0;e<g.length;e++)d[g[e]]=e;g=d}else g=null}return a}}};COG.parseData=function(h,g){g=g?g.toUpperCase():"JSON";if(!m[g])throw Error("Unsupported data format: "+g);try{return m[g].parse(h)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function f(a){for(var c=null,d=0;d<m.length;d++)if(c=m[d](a))break;return c}var m=[],h=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var g={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var d=null;if(a.resultType>=0&&a.resultType<h.length)d=h[a.resultType];if(d)c=d(a)}return c?c:""}}},first:function(a,c){var d=g.SearchResult,e;var l=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!l)l=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))e=c.evaluate(a,c,f,l,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");e=null}}catch(b){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);e=null}return new d(e)},registerResolver:function(a){m.push(a)}};return g}();
COG.Storage=function(){function f(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,h){var g=f(h).getItem(m);return/^(\{|\[).*(\}|\])$/.test(g)?JSON.parse(g):g},set:function(m,h,g){h=jQuery.isArray(h)||jQuery.isPlainObject(h)?JSON.stringify(h):h;f(g).setItem(m,h)},remove:function(m,h){f(h).removeItem(m)}}}();
COG.ParseRules=function(){var f=[];return{add:function(m,h){f.push({regex:m,handler:h})},each:function(m,h,g){function a(){c++;g&&c>=f.length&&g(h)}for(var c=0,d=0;d<f.length;d++){var e=f[d].regex,l=f[d].handler,b=false;if(e){e.lastIndex=-1;if((e=e.exec(m))&&l){b=true;l(e,h,a)&&a()}}b||a()}}}};
(function(){function f(e){var l=[],b=function(j,k){k=COG.isFunction(k)?k():k;l[l.length]=encodeURIComponent(j)+"="+encodeURIComponent(k)};if(COG.isArray(e))for(var i=0;i<e.length;i++)b(e[i].name,e[i].value);else for(i in e)b(i,e[i]);return l.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},h={JSON:["json"],PDON:["pdon.txt"]},g=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(e){return e.responseXML},JSON:function(e){return COG.parseData(e.responseText)},
PDON:function(e){return COG.parseData(e.responseText,"PDON")},DEFAULT:function(e){return e.responseText}},d={CONTENT_TYPE:"Content-Type"};COG.xhr=function(e){function l(){if(this.readyState===4){var k=null,n=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(n)if(e.handleResponse)e.handleResponse(this);else{var x=e,z=this.getResponseHeader(d.CONTENT_TYPE),p,o=false;for(p in m)if(z&&z.indexOf(m[p])>=0){o=true;
break}z=!o;for(o=0;o<g.length;o++)z=z||g[o]==p;if(z)b:{z=p;for(var u in h)for(o=0;o<h[u].length;o++)if(RegExp(h[u][o]+"$","i").test(x.url)){p=u;break b}p=z?z:"DEFAULT"}try{k=c[p](this,x)}catch(t){k=c.DEFAULT(this,x)}}else e.error&&e.error(this)}catch(L){COG.Log.exception(L,"PROCESSING AJAX RESPONSE")}n&&k&&e.success&&e.success.call(this,k)}}try{e=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},e);var b=
a.exec(e.url),i=b&&(b[1]&&b[1]!==location.protocol||b[2]!==location.host);if(e.data)e.method="POST";if(e.url){b=null;if(e.xhr)b=e.xhr(e);b||(b=new XMLHttpRequest);b.open(e.method,e.url,e.async);e.data&&b.setRequestHeader("Content-Type",e.contentType);i||b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.onreadystatechange=l;b.send(e.method=="POST"?f(e.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(j){COG.Log.exception(j)}}})();
(function(){function f(a){var c=document.createElement("script"),d=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!d&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){d=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};h||(h=document.getElementsByTagName("head")[0]);h.appendChild(c)}var m=0,h,g=this;COG.jsonp=function(a,c,d){a+=a.indexOf("?")>=0?"&":"?";var e="json"+ ++m;g[e]=function(l){c(l);g[e]=null;try{delete g[e]}catch(b){}};
f(a+(d?d:"callback")+"="+e);return e}})();
COG.Touch=function(){function f(v,C){return{x:v.x-C.x,y:v.y-C.y}}function m(v,C){var G=f(v,C);return Math.sqrt(G.x*G.x+G.y*G.y)}function h(v){if(v.count>1)return m(v.touches[0],v.touches[1]);return 0}function g(v,C){var G=v&&v.count>0?v.touches[0]:null;if(G&&C&&C.count>0)return f(G,C.touches[0]);return null}function a(v,C){v.count=C.count;for(var G=b;G--;){v.touches[G].x=C.touches[G].x;v.touches[G].y=C.touches[G].y}}function c(){for(var v={count:0,touches:Array(b)},C=b;C--;)v.touches[C]=l();return v}
function d(v){if(v.preventDefault){v.preventDefault();v.stopPropagation()}else v.cancelBubble&&v.cancelBubble()}function e(v,C,G){if(E){C=C[G?G:"touches"];G=C.length;for(G=v.count=G;G--;){v.touches[G].x=C[G].pageX;v.touches[G].y=C[G].pageY}}else if(C.button===0){v.count=1;v.touches[0].x=C.pageX?C.pageX:C.screenX;v.touches[0].y=C.pageY?C.pageY:C.screenY}else v.count=0}function l(v,C){return{x:v?v:0,y:C?C:0}}var b=10,i=120,j=100,k=250,n=300,x=5,z=0,p=1,o=2,u=7,t=0,L=0,E=undefined,ia=function(v){function C(w,
A,y,q){var s=Math.asin((w.y-A.y)/y);y=y*(qa/q)>>0;y=y>na?na:y;s=A.x>w.x?s:Math.PI-s;W("pan",Math.cos(s)*-y,Math.sin(s)*y,true)}function G(w,A){var y,q;if(E){y=A-V;if(y<k){q=m(K.touches[0],w);q>v.inertiaTrigger&&C(K.touches[0],w,q,y)}}else{Y.x=w.x;Y.y=w.y;COG.Loopage.join({execute:function(s,B){y=s-A;q=m(w,Y);if(y<j&&q>v.inertiaTrigger){B.trigger("complete");C(w,Y,q,y)}else y>j&&B.trigger("complete")},frequency:10})}}function ea(w){var A=0,y=0;if(w.offsetParent){do{A+=w.offsetLeft;y+=w.offsetTop;w=
w.offsetParent}while(w)}return l(A,y)}function $(w){var A=w.count,y=Array(A),q=ea(aa);for(A=A;A--;)y[A]=l(w.touches[A].x-q.x,w.touches[A].y-q.y);return y}function W(){oa&&oa.trigger.apply(null,arguments)}function X(w,A){var y=ea(aa);y=l(A.x-y.x,A.y-y.y);W(w,A,y)}function da(w){var A=w.target?w.target:w.srcElement;if(ba||A&&A===aa){e(K,w);if(K.count!==0){S=null;T.x=0;T.y=0;ha=true;J=false;V=(new Date).getTime();d(w);A.style.cursor="move";W("inertiaCancel");ka=V;if(w=K.count>0?K.touches[0]:null){W("touchStart",
w.x,w.y);if(ka-la<n)if((w=f(K.touches[0],P.touches[0]))&&Math.abs(w.x)<v.maxDistDoubleTap&&Math.abs(w.y)<v.maxDistDoubleTap)J=true;F=z;a(P,K)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function r(w){var A=w.target?w.target:w.srcElement,y=0;if(ba||A&&A===aa){e(N,w);if(N.count>0){Y.x=N.touches[0].x;Y.y=N.touches[0].y}if(ha){E&&d(w);if(N.count>1){K.count===1&&a(K,N);y=h(K)-h(N)}if(F===z)if((w=g(N,K))&&(Math.abs(w.x)>=u||Math.abs(w.y)>=u))F=p;if(F!==z)if(!y||Math.abs(y)<x){if(S=
g(N,P)){T.x-=S.x;T.y-=S.y;R.x-=S.x;R.y-=S.y}W("pan",R.x,R.y);R.x=0;R.y=0;F=p}else{W("pinchZoom",$(K),$(N));F=o}a(P,N)}}}function M(w){var A=w.target?w.target:w.srcElement;if(ha&&(ba||A&&A===aa)){e(ga,w,"changedTouches");var y=ga.touches[0];E&&d(w);w=(new Date).getTime();la=ka;if(F===z){X("tap",K.touches[0]);H||(H=setTimeout(function(){H=0;J&&X("doubleTap",K.touches[0])},n+50))}else if(F==p){W("panEnd",T.x,T.y);pa&&G(y,w)}else F==o&&W("pinchZoomEnd",$(K),$(P),w-V);A.style.cursor="default";ha=false}}
function D(w){var A=w.target?w.target:w.srcElement;if(ba||A&&A===aa){if(w.detail){A=-w.detail*i;A=l(w.axis===1?A:0,w.axis===2?A:0)}else A=l(w.wheelDeltaX,w.wheelDeltaY);var y=A.y!==0?Math.abs(A.y/i):0;if(Y&&y!==0){var q=l(Y.x-aa.offsetLeft,Y.y-aa.offsetTop);W("wheelZoom",q,Math.pow(2,A.y>0?y:-y))}d(w)}}v=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,
doubleTapHandler:null,wheelZoomHandler:null},v);var J=false,H=0,I=T5.getConfig(),K=c(),N=c(),P=c(),ga=c(),S=null,T=l(),R=l(),F=null,ha=false,V=0,U=[],Y=l(),pa=false,qa,na,ka=0,la=0,aa=v.element,oa=v.observable,ba=typeof FlashCanvas!=="undefined",ra={supportsTouch:E,addListeners:function(w){U.push(w)},decoupleListeners:function(w){for(var A=0;w&&A<U.length;A++)if(U[A].listenerId===w){U.splice(A,1);break}},release:function(){I.unbindEvent(E?"touchstart":"mousedown",da,false);I.unbindEvent(E?"touchmove":
"mousemove",r,false);I.unbindEvent(E?"touchend":"mouseup",M,false);if(!E){window.removeEventListener("mousewheel",D,false);window.removeEventListener("DOMMouseScroll",D,false)}},inertiaEnable:function(w,A){pa=true;qa=w;na=A?Math.min(A.width,A.height):500},inertiaDisable:function(){pa=false}};if(typeof E==="undefined")E=T5.getConfig().supportsTouch;I.bindEvent(E?"touchstart":"mousedown",da,false);I.bindEvent(E?"touchmove":"mousemove",r,false);I.bindEvent(E?"touchend":"mouseup",M,false);if(!E){I.bindEvent("mousewheel",
D,window);I.bindEvent("DOMMouseScroll",D,window)}return ra},Z=[];return{capture:function(v,C){if(!v)throw Error("Unable to capture touch of null element");if(!v.id)v.id="touchable_"+t++;var G=Z[v.id];if(!G){G=new ia(COG.extend({element:v},C));Z[v.id]=G}if(C){C.listenerId&&G.decoupleListeners(C.listenerId);C.listenerId=++L;G.addListeners(C)}return G},release:function(v){if(v&&v.id&&Z[v.id]){Z[v.id].release();delete Z[v.id]}}}}();
T5=function(){var f=function(){function d(b,i){return l(b.x-i.x,b.y-i.y)}function e(b,i){if(!i)i=b.length;if(i<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var j={edges:Array(i-1),accrued:Array(i-1),total:0},k=0;k<i-1;k++){var n=d(b[k],b[k+1]);j.edges[k]=Math.sqrt(n.x*n.x+n.y*n.y);j.accrued[k]=j.total+j.edges[k];j.total+=j.edges[k]}return j}function l(b,i){return{x:b?b:0,y:i?i:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,i=0,j=arguments.length;j--;){b+=arguments[j].x;i+=arguments[j].y}return l(b,i)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?l(b.x,b.y):null},diff:d,distance:function(b,i){return e(b,i).total},edges:e,equals:function(b,i){return b.x===i.x&&b.y===i.y},extendBy:function(b,i,j){return l(b.x-Math.cos(i)*j,b.y-Math.sin(i)*j)},floor:function(b){for(var i=Array(b.length),j=b.length;j--;)i[j]=l(~~b[j].x,~~b[j].y);return i},getRect:function(b){var i=b.length;
if(i>1)return new h(Math.min(b[0].x,b[i-1].x),Math.min(b[0].y,b[i-1].y),Math.abs(b[0].x-b[i-1].x),Math.abs(b[0].y-b[i-1].y))},init:l,invert:function(b){return l(-b.x,-b.y)},offset:function(b,i,j){return l(b.x+i,b.y+(j?j:i))},simplify:function(b,i){if(!b)return null;i=i?i:f.VECTOR_SIMPLIFICATION;for(var j=[],k=null,n=b.length;n--;){var x=b[n];if(include=!k||n===0||Math.abs(x.x-k.x)+Math.abs(x.y-k.y)>i){j.unshift(x);k=x}}return j},theta:function(b,i,j){j=Math.asin((b.y-i.y)/j);return b.x>i.x?j:Math.PI-
j}}}(),m=function(){return{dotProduct:function(d,e){return d.x*e.x+d.y*e.y}}}(),h=function(d,e,l,b){return{origin:f.init(d,e),dimensions:new a(l,b),invalid:false}},g=function(){return{bottomRight:function(d){return m.offset(d.origin,d.dimensions.width,d.dimensions.height)},empty:function(){return new h(0,0,0,0)},copy:function(d){return d?new h(d.origin.x,d.origin.y,d.dimensions.width,d.dimensions.height):null},getCenter:function(d){return f.init(d.origin.x+d.dimensions.width/2,d.origin.y+d.dimensions.height/
2)},isEmpty:function(d){return d.dimensions.width===0||d.dimensions.height===0},union:function(){if(!(arguments.length<2)){for(var d=arguments[0].origin.y,e=arguments[0].origin.x,l=d+arguments[0].dimensions.height,b=e+arguments[0].dimensions.width,i=Array.prototype.slice.call(arguments,1),j=i.length;j--;){var k=i[j].origin.y,n=i[j].origin.x,x=k+i[j].dimensions.height,z=n+i[j].dimensions.width;d=d<k?d:k;e=e<n?e:n;l=l>x?l:x;b=b>z?b:z}arguments[0].origin.x=e;arguments[0].origin.y=d;arguments[0].dimensions.width=
b-e;arguments[0].dimensions.height=l-d}}}}(),a=function(d,e){return{width:d?d:0,height:e?e:0}},c=function(){return{getAspectRatio:function(d){return d.height!==0?d.width/d.height:1},getCenter:function(d){return f.init(d.width/2,d.height/2)},getSize:function(d){return Math.sqrt(Math.pow(d.width,2)+Math.pow(d.height,2))}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:f,Vector:function(d,e){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return f.init(d,e)},V:COG.extend(f,m),Dimensions:a,D:c,Rect:h,R:g}}();
(function(){function f(){for(;x.length>0;){var p=x.shift();document.location=p}n=0}function m(p){for(var o=true,u=z.length;u--;)o=o&&p!=z[u];return o}function h(p,o){var u=[];for(var t in o)t&&u.push(t+"="+escape(o[t]));return"tile5://"+p+"/"+(u.length>0?"?"+u.join("&"):"")}function g(p,o){m(p)&&COG.Log.info("would push url: "+h(p,o))}function a(p,o){if(m(p)){x.push(h(p,o));n||(n=setTimeout(f,100))}}function c(p){return function(o,u,t){(t?t:p?document.body:document).addEventListener(o,u,false)}}function d(p){return function(o,
u,t){(t?t:p?document.body:document).removeEventListener(o,u,false)}}function e(p,o,u){(u?u:document).attachEvent("on"+p,o)}function l(p,o,u){(u?u:document).detachEvent("on"+p,o)}function b(){i={base:{name:"Unknown",bindEvent:c(),unbindEvent:d(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:g,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:e,unbindEvent:l,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:d(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};j=[i.froyo,i.android,i.ipod,i.iphone,i.ipad,i.ie]}var i=null,j=[],k=null,n=0,x=[],z=["view.wake","tile.loaded"];T5.getConfig=function(){i||b();if(!k){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var p=0;p<j.length;p++){var o=j[p];if(o.regex&&o.regex.test(navigator.userAgent)){k=T5.ex({},i.base,o);COG.Log.info("PLATFORM DETECTED AS: "+k.name);break}}if(!k){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
k=i.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return k}})();
T5.Dispatcher=function(){var f=[],m={execute:function(h){var g=m.findAction(h);g&&g.execute.apply(g,Array.prototype.slice.call(arguments,1))},findAction:function(h){for(var g=f.length;g--;)if(f[g].id==h)return f[g];return null},getRegisteredActions:function(){return[].concat(f)},getRegisteredActionIds:function(){for(var h=[],g=f.length;g--;)f[g].id&&h.push(f[g].id);return h},registerAction:function(h){h&&h.id&&f.push(h)},Action:function(h){h=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},h);var g={id:h.id,execute:function(){h.execute&&h.execute.apply(this,arguments)},getParam:function(a){return h[a]?h[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",g.id,h.title,h.icon)}};h.autoRegister&&m.registerAction(g);return g},Agent:function(h){h=COG.extend({name:"Untitled",translator:null,execute:null},h);var g={getName:function(){return h.name},getParam:function(a){return h[a]},getId:function(){return COG.toID(g.getName())},run:function(a,c){if(h.execute){var d=
h.translator?h.translator(a):a;h.execute.call(g,d,function(e,l){c&&c(e,l,d)})}}};return g},runAgents:function(h,g,a){for(var c=0;c<h.length;c++)h[c].run(g,a)}};return m}();
T5.Resources=function(){var f="",m={},h={getPath:function(g){return/^(file|https?|\/)/.test(g)?g:f+g},setBasePath:function(g){f=g},loadResource:function(g){g=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},g);var a=function(c){g.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){g.callback(c)})};g.cacheable&&m[g.filename]?a(m[g.filename]):COG.xhr({url:h.getPath(g.filename),dataType:g.dataType,success:function(c){if(g.cacheable)m[g.filename]=c;a(c)},error:function(c,d,e){COG.Log.error("error loading resource ["+
g.filename+"], error = "+e)}})},loadSnippet:function(g,a){/\.\w+$/.test(g)||(g+=".html");h.loadResource({filename:"snippets/"+g,callback:a,dataType:"html"})}};return h}();
T5.Images=function(){function f(){if(!n){var p=T5.getConfig().maxImageLoads;n=COG.Loopage.join({execute:function(o,u){if(!p||i.length<p){var t=b.shift();if(t){i[i.length]=t;t.image.onload=h;t.image.src=T5.Resources.getPath(t.url);t.requested=T5.ticks()}else u.trigger("complete")}},frequency:10});n.bind("complete",function(){n=null})}}function m(){x=true;try{var p=j.length/2>>0;if(p>0){j.sort(function(u,t){return u.created-t.created});for(var o=p;o--;)delete c[j[o].url];j.splice(0,p)}}finally{x=false}COG.say("imagecache.cleared")}
function h(){var p=e[this.id],o;if(p&&p.image.complete&&p.image.width>0){p.loaded=true;p.hitCount=1;for(o=i.length;o--;)if(i[o].image.src==this.src){i.splice(o,1);break}if(p.background||p.postProcess||p.drawBackground||p.customDraw)if(p.image){o=a(p.realSize?p.realSize.width:image.width,p.realSize?p.realSize.height:image.height);var u=o.getContext("2d"),t=p.offset?p.offset:T5.XY.init();p.background&&u.drawImage(p.background,0,0);p.drawBackground&&p.drawBackground(u);p.customDraw?p.customDraw(u,p):
u.drawImage(p.image,t.x,t.y);p.postProcess&&p.postProcess(u,p);p.image=o}for(o=p.callbacks.length;o--;)p.callbacks[o]&&p.callbacks[o](this,false);p.callbacks=[];j[j.length]={url:this.src,created:p.requested};delete e[this.id];f()}}function g(p,o,u){var t=c[p];if(t){t.hitCount++;t.image.complete&&t.image.width>0&&o?o(t.image,true):t.callbacks.push(o)}else{t=T5.ex({url:p,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[o]},u);t.image.id="resourceLoaderImage"+l++;
c[p]=t;e[t.image.id]=t;b[b.length]=t;f()}return t}function a(p,o){var u=document.createElement("canvas");u.width=p?p:0;u.height=o?o:0;if(typeof FlashCanvas!=="undefined"){u.id="tmpCanvas"+d++;u.style.cssText="position: absolute; top: -"+(o-1)+"px; left: -"+(p-1)+"px;";document.body.appendChild(u);FlashCanvas.initElement(u)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(u);return u}var c={},d=0,e={},l=0,b=[],i=[],j=[],k=0,n=null,x=false,z={avgImageSize:25,loadTimeout:10,cancelLoad:function(){i=
[]},get:function(p,o,u){var t=null,L=null;x||(t=c[p]);if((L=t?t.image:null)&&(L.getContext||L.complete&&L.width>0))return L;else o&&g(p,o,u);return null},load:g,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:i.length,queuedImageCount:b.length,imageCacheFullness:k}}};COG.Loopage.join({execute:function(p){for(var o=false,u=0,t=T5.getConfig();u<i.length;)if(p-i[u].requested>z.loadTimeout*1E3){i.splice(u,1);o=true}else u++;o&&f();if(t&&t.imageCacheMaxSize){k=j.length*z.avgImageSize/
t.imageCacheMaxSize;k>=1&&m()}},frequency:2E4});return z}();
T5.TimeLord=function(){var f=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,h=function(a,c){return{days:a?a:0,seconds:c?c:0}},g={8601:function(a){a=a.split("T");var c=null;c=null;var d=0,e=0;f.lastIndex=-1;c=f.exec(a[0]);d+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(a[1]);e+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;e+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;e+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new h(d,e)}};return{Duration:h,addDuration:function(){for(var a=new h,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var d=c?g[c]:null;if(d)return d(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new h},formatDuration:function(a){var c,d,e="";if(a.days)e=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){d=Math.round(a/60);a-=d*60}if(c)e=e+c+(c>1?" hrs ":" hr ")+
(d?(d>10?d:"0"+d)+" min ":"");else if(d)e=e+d+" min";else if(a>0)e=e+(a>10?a:"0"+a)+" sec"}return e}}}();
(function(){var f=Math.PI*2,m=Math.PI/2,h=Math.abs,g=Math.pow,a=Math.sin,c=Math.asin,d=Math.cos,e=1.70158,l={linear:function(b,i,j,k){return j*b/k+i},backin:function(b,i,j,k){return j*(b/=k)*b*((e+1)*b-e)+i},backout:function(b,i,j,k){return j*((b=b/k-1)*b*((e+1)*b+e)+1)+i},backinout:function(b,i,j,k){return(b/=k/2)<1?j/2*b*b*(((e*=1.525)+1)*b-e)+i:j/2*((b-=2)*b*(((e*=1.525)+1)*b+e)+2)+i},bouncein:function(b,i,j,k){return j-l.bounceout(k-b,0,j,k)+i},bounceout:function(b,i,j,k){return(b/=k)<1/2.75?
j*7.5625*b*b+i:b<2/2.75?j*(7.5625*(b-=1.5/2.75)*b+0.75)+i:b<2.5/2.75?j*(7.5625*(b-=2.25/2.75)*b+0.9375)+i:j*(7.5625*(b-=2.625/2.75)*b+0.984375)+i},bounceinout:function(b,i,j,k){return b<k/2?l.bouncein(b*2,0,j,k)/2+i:l.bounceout(b*2-k,0,j,k)/2+j/2+i},cubicin:function(b,i,j,k){return j*(b/=k)*b*b+i},cubicout:function(b,i,j,k){return j*((b=b/k-1)*b*b+1)+i},cubicinout:function(b,i,j,k){if((b/=k/2)<1)return j/2*b*b*b+i;return j/2*((b-=2)*b*b+2)+i},elasticin:function(b,i,j,k,n,x){if(b==0)return i;if((b/=
k)==1)return i+j;x||(x=k*0.3);if(!n||n<h(j)){n=j;j=x/4}else j=x/f*c(j/n);return-(n*g(2,10*(b-=1))*a((b*k-j)*f/x))+i},elasticout:function(b,i,j,k,n,x){var z;if(b==0)return i;if((b/=k)==1)return i+j;x||(x=k*0.3);if(!n||n<h(j)){n=j;z=x/4}else z=x/f*c(j/n);return n*g(2,-10*b)*a((b*k-z)*f/x)+j+i},elasticinout:function(b,i,j,k,n,x){var z;if(b==0)return i;if((b/=k/2)==2)return i+j;x||(x=k*0.3*1.5);if(!n||n<h(j)){n=j;z=x/4}else z=x/f*c(j/n);if(b<1)return-0.5*n*g(2,10*(b-=1))*a((b*k-z)*f/x)+i;return n*g(2,
-10*(b-=1))*a((b*k-z)*f/x)*0.5+j+i},quadin:function(b,i,j,k){return j*(b/=k)*b+i},quadout:function(b,i,j,k){return-j*(b/=k)*(b-2)+i},quadinout:function(b,i,j,k){if((b/=k/2)<1)return j/2*b*b+i;return-j/2*(--b*(b-2)-1)+i},sinein:function(b,i,j,k){return-j*d(b/k*m)+j+i},sineout:function(b,i,j,k){return j*a(b/k*m)+i},sineinout:function(b,i,j,k){return-j/2*(d(Math.PI*b/k)-1)+i}};T5.easing=function(b){return l[b.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(b,i){l[b.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=i}})();
T5.Tween=function(f){f=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},f);var m=T5.ticks(),h=[],g=false,a=0,c=0,d={cancelOnInteract:f.cancelOnInteract,isComplete:function(){return g},triggerComplete:function(e){f.complete&&f.complete(e)},update:function(e){try{var l=f.tweenFn(e-m,a,c,f.duration);if(f.target)f.target[f.property]=l;for(var b=h.length;b--;)h[b](l,void 0);if(g=m+f.duration<=e){if(f.target)f.target[f.property]=
f.tweenFn(f.duration,a,c,f.duration);for(var i=h.length;i--;)h[i](l,true)}}catch(j){COG.Log.exception(j)}},requestUpdates:function(e){h.push(e)}};a=f.target&&f.property&&f.target[f.property]?f.target[f.property]:f.startValue;if(typeof f.endValue!=="undefined")c=f.endValue-a;if(c==0)g=true;T5.wakeTweens();return d};
(function(){function f(a){if(g)return m.length;g=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(a);c++}}finally{g=false}m.length===0&&h.trigger("complete");return m.length}var m=[],h=null,g=false;T5.tweenValue=function(a,c,d,e,l){a=new T5.Tween({startValue:a,endValue:c,tweenFn:d,complete:e,duration:l});m.push(a);return a};T5.tween=function(a,c,d,e,l,b){a=new T5.Tween({target:a,property:c,endValue:d,tweenFn:e,duration:b,complete:l});
m.push(a);return a};T5.tweenVector=function(a,c,d,e,l,b){var i=[];if(a){var j=a.x==c,k=a.y==d;j||i.push(T5.tween(a,"x",c,e,function(){(j=true)&&k&&l()},b));k||i.push(T5.tween(a,"y",d,e,function(){k=true;j&&k&&l()},b))}return i};T5.cancelAnimation=function(a){if(!g){g=true;try{for(var c=0;c<m.length;)if(!a||a(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{g=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!h){h=COG.Loopage.join({execute:f,frequency:20});
h.bind("complete",function(){h=null})}}})();(function(){var f={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,PINCH:16,FREEZE:128};T5.viewState=function(){for(var m=0,h=arguments.length;h--;){var g=f[arguments[h].toUpperCase()];if(g)m|=g}return m}})();
T5.ViewLayer=function(f){f=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","PINCH")},f);var m=null,h=false,g=false,a=f.supportFastDraw,c=f.id,d=T5.viewState("ACTIVE"),e=f.validStates,l=0,b=0,i=T5.ex({addToView:function(j){j.setLayer(c,i)},shouldDraw:function(j,k,n){j=(j&e)!==0&&(h?a:true);return j=g||n||l!==k.x||b!==k.y},cycle:function(){},draw:function(){},remove:function(){i.trigger("remove",i)},changed:function(){g=true;i.trigger("changed",
i);m&&m.trigger("invalidate")},getId:function(){return c},setId:function(j){c=j},getParent:function(){return m},setParent:function(j){h=(m=j)?m.fastDraw&&displayState!==d:false;i.trigger("parentChange",m)}},f);COG.observable(i);i.bind("drawComplete",function(j,k){g=false;l=k.x;b=k.y});return i};
T5.View=function(f){function m(q,s,B,O){ba=la;u();if(O&&f.inertia){D=true;b(Z+s,v+B,f.panAnimationEasing,f.panAnimationDuration)}else O||b(Z+s,v+B)}function h(){ba=ka;D=false;COG.Loopage.join({execute:u,after:50,single:true})}function g(q,s){P=ra(q);ga=ra(s);var B=w(P.dimensions),O=w(ga.dimensions);Y=A(P);r=A(ga);F=P&&B!==0?O/B:1}function a(q,s,B){g(s,B);if(N=F!==1){ba=aa;u()}}function c(q,s,B,O){g(s,B);if(f.adjustScaleFactor){F=f.adjustScaleFactor(F);COG.Log.info("scale factor adjusted to: "+F)}if(O<
f.pinchZoomAnimateTrigger){k(V,F,Y,n(),T5.easing("sine.out"),function(){e();F=1},300);F=V}else{e();F=1}}function d(q,s,B){y.zoom(s,Math.min(Math.pow(2,Math.round(Math.log(B))),8),500)}function e(){var q=P?n():r;F=Math.round(F*10)/10;N=false;for(var s=t.length;s--;)t[s].trigger("scale",F,q);y.trigger("scale",F,q);ba=ka;u()}function l(){clearTimeout(R);R=setTimeout(i,50)}function b(q,s,B,O,Q){function ca(){fa+=1;if(fa>=2){h(0,0);Q&&Q()}}var fa=0;if(B){q=T5.tweenValue(Z,q,B,ca,O);s=T5.tweenValue(v,s,
B,ca,O);q.cancelOnInteract=true;q.requestUpdates(function(ja){Z=ja;D=true;u()});s.cancelOnInteract=true;s.requestUpdates(function(ja){v=ja;D=true;u()})}else{Z=q;v=s}}function i(){var q;if(E){COG.Touch.release(E);if(f.autoSize&&E.parentNode){q=E.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){E.height=q.height;E.width=q.width}}try{if(!E.id)E.id=f.id+"_canvas";ia=E.getContext("2d");ia.clearRect(0,0,E.width,E.height)}catch(s){COG.Log.exception(s);throw Error("Could not initialise canvas on specified view element");
}na=COG.Touch.capture(E,{observable:y});if(X.height!==E.height||X.width!==E.width){X=new T5.Dimensions(E.width,E.height);y.trigger("resize",E.width,E.height);for(q=L;q--;)t[q].trigger("resize",E.width,E.height)}f.inertia&&na.inertiaEnable(f.panAnimationDuration,X);for(q=L;q--;)t[q].trigger("contextChanged",ia);o()}}function j(q,s){s.setId(q);s.added=T5.ticks();s.bind("remove",function(){y.removeLayer(q)});s.trigger("contextChanged",ia);s.setParent(y);t.push(s);t.sort(function(B,O){var Q=O.zindex-
B.zindex;if(Q===0)Q=O.added-B.added;return Q});L=t.length;return s}function k(q,s,B,O,Q,ca,fa){function ja(){ca&&ca();e();F=1;U=null}N=true;Y=T5.XY.copy(B);r=T5.XY.copy(O);P=null;if(Q)T5.tweenValue(0,s-q,Q,ja,fa?fa:1E3).requestUpdates(function(ma){U=ma/(s-q);F=q+ma;ba=aa;u();y.trigger("animate")});else{F=targetScaleFactor;ja()}}function n(){var q=T5.D.getCenter(X),s=T5.XY.distance([r,q]);q=T5.XY.theta(r,q,s);var B=T5.XY.diff(Y,r);q=T5.XY.extendBy(r,q,s/F);q.x+=B.x;q.y+=B.y;return q}function x(){y.trigger("idle");
M=true;J=0}function z(q,s,B,O,Q){if($)s=T5.viewState("FROZEN");var ca=(s&aa)!==0,fa=0;if(G||ca){q.clearRect(0,0,E.width,E.height);G=false}if(ca){T5.D.getCenter(X);var ja=(U?U:1)/2,ma=T5.XY.diff(Y,r);if(P){I.x=r.x+ma.x;I.y=r.y+ma.y}else{I.x=r.x-ma.x*ja;I.y=r.y-ma.y*ja}B=T5.XY.offset(B,I.x,I.y)}q.save();try{V=F;if(W!==1)q.scale(W,W);else if(ca){q.translate(r.x,r.y);q.scale(F,F)}for(fa=L;fa--;)if(t[fa].shouldDraw(s,B,O)){t[fa].draw(q,B,X,s,y,O,Q);t[fa].trigger("drawComplete",B,Q)}}finally{q.restore()}y.trigger("drawComplete",
B,Q);COG.Log.trace("draw complete",Q)}function p(q,s){var B=false,O=S?S:D?la:ba,Q=!D&&(O===aa||O===la),ca=T||O===la||O===aa||T5.isTweening();C.x=Z>>0;C.y=v>>0;if(Q){T5.cancelAnimation(function(fa){return fa.cancelOnInteract});M=false;if(J!==0){clearTimeout(J);J=0}}for(Q=L;Q--;){if(t[Q].animated)ba|=oa;B=t[Q].cycle(q,C,ba,ca)||B}ca=ca||(ba&oa)!==0;if(B=B||ca||F!==1&&F!==ha){z(ia,O,C,ca,q);ha=F;T=false}if(!B&&da===0&&!pa){if(!M&&J===0)J=setTimeout(x,500);s.trigger("complete")}da=0;COG.Log.trace("Completed draw cycle",
q)}function o(){T=true;u()}function u(){da+=1;if(!($||ea)){ea=COG.Loopage.join({execute:p,frequency:qa});ea.bind("complete",function(){ea=null})}}f=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},f);var t=[],L=0,E=document.getElementById(f.container),ia=null,Z=0,v=0,C=T5.XY.init(),G=false,ea=null,$=
false,W=1,X=new T5.Dimensions,da=0,r=null,M=false,D=false,J=0,H=0,I=T5.XY.init(),K=0,N=false,P=null,ga=null,S=null,T=false,R=0,F=1,ha=0,V=1,U=null,Y=null,pa=typeof FlashCanvas!=="undefined",qa=~~(1E3/f.fps),na=null,ka=T5.viewState("ACTIVE"),la=T5.viewState("PAN"),aa=T5.viewState("PINCH"),oa=T5.viewState("ANIMATING"),ba=ka,ra=T5.XY.getRect,w=T5.D.getSize,A=T5.R.getCenter,y={id:f.id,deviceScaling:W,fastDraw:f.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,s,B,O,Q){k(F,q,s,B,O,Q)},centerOn:function(q){Z=
q.x-E.width/2;v=q.y-E.height/2},getDimensions:function(){return X},getZoomCenter:function(){return I},getLayer:function(q){for(var s=0;s<L;s++)if(t[s].getId()==q)return t[s];return null},setLayer:function(q,s){for(var B=0;B<L;B++)if(t[B].getId()===q){t.splice(B,1);break}s&&j(q,s);o()},eachLayer:function(q){for(var s=L;s--;)q(t[s])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");G=true;o()},invalidate:o,freeze:function(){$=true},unfreeze:function(){$=false;u()},
resize:function(q,s){if(E){f.autoSize=false;E.width=q;E.height=s;i();y.trigger("resize",E.width,E.height)}},scale:function(q,s,B,O,Q){O||(O=T5.D.getCenter(X));Q||(Q=T5.D.getCenter(X));y.animate(q,O,Q,s,B);return y},removeLayer:function(q){a:{for(var s=L;s--;)if(t[s].getId()==q){q=s;break a}q=-1}if(q>=0&&q<L){COG.say("layer.removed",{layer:t[q]});t.splice(q,1);o()}L=t.length},stateOverride:function(q){S=q},getOffset:function(){return C},updateOffset:b,zoom:function(q,s,B){D=false;F=s;N=F!==1;Y=T5.D.getCenter(X);
r=F>1?T5.XY.copy(q):T5.D.getCenter(X);P=null;clearTimeout(H);if(N){ba=aa;u();if(B)H=setTimeout(function(){e();F=1},parseInt(B,10))}}};W=T5.getConfig().getScaling();y.markers=j("markers",new T5.MarkerLayer);COG.observable(y);y.bind("wake",u);y.bind("invalidate",o);if(f.pannable){y.bind("pan",m);y.bind("panEnd",h);y.bind("inertiaCancel",function(){D=false;u()})}if(f.scalable){y.bind("pinchZoom",a);y.bind("pinchZoomEnd",c);y.bind("wheelZoom",d)}y.bind("tap",function(q,s,B){for(var O=T5.XY.offset(B,Z,
v),Q=t.length;Q--;)q.cancel=q.cancel||t[Q].trigger("tap",s,B,O).cancel});COG.configurable(y,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(f,null,{container:function(q,s){E=document.getElementById(s);i()},rotation:function(q,s){K=s}}),true);i();f.autoSize&&window.addEventListener("resize",l,false);return y};
T5.PathLayer=function(f){function m(i){i.syncVectors(c);d&&i.syncVectors(d);b.trigger("tidy")}f=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},f);var h=false,g=[],a=null,c=[],d=null,e=0,l=[],b=T5.ex(new T5.ViewLayer(f),{getAnimation:function(i,j,k,n){var x="pathAnimation"+e++;l.push(x);return new T5.AnimatedPathLayer({id:x,path:g,zindex:f.zindex+1,easing:i?i:T5.easing("sine.inout"),duration:j?j:5E3,drawIndicator:k,autoCenter:n?n:false})},cycle:function(i,j,k,n){return n},draw:function(i,
j){var k,n=g.length;i.save();try{T5.applyStyle(i,f.style);if(n>0){i.beginPath();i.moveTo(g[n-1].x-j.x,g[n-1].y-j.y);for(k=n;k--;)i.lineTo(g[k].x-j.x,g[k].y-j.y);i.stroke();if(a){i.fillStyle=f.waypointFillStyle;for(k=a.length;k--;){i.beginPath();i.arc(a[k].x-j.x,a[k].y-j.y,2,0,Math.PI*2,false);i.stroke();i.fill()}}}}finally{i.restore()}h=false},updateCoordinates:function(i,j){var k=b.getParent();k=k?k.getTileLayer():null;c=i;d=j;COG.Log.info("updating coordinates, grid = "+k);k&&m(k)}});b.bind("gridUpdate",
function(i,j){m(j);for(var k=l.length;k--;)COG.say("layer.remove",{id:l[k]});l=[]});b.bind("tidy",function(){g=T5.XY.simplify(c,f.pixelGeneralization);a=T5.XY.simplify(d,f.pixelGeneralization);h=true;b.changed()});return b};
T5.ShapeLayer=function(f){function m(c){for(var d=h.length;d--;)h[d].resync(c);h.sort(function(e,l){var b=l.xy.y-e.xy.y;if(b===0)b=l.xy.x-e.xy.y;return b});g=true;a.changed()}f=T5.ex({zindex:80,style:null},f);var h=[],g=false,a=T5.ex(new T5.ViewLayer(f),{add:function(c){h[h.length]=c},each:function(c){for(var d=h.length;d--;)c(h[d])},cycle:function(){return g},draw:function(c,d,e,l){var b=d.x;d=d.y;var i=e.width;e=e.height;c.save();try{T5.applyStyle(c,f.style);for(var j=h.length;j--;){var k=h[j].style,
n=k?T5.applyStyle(c,k):null;h[j].draw(c,b,d,i,e,l);n&&T5.applyStyle(c,n)}}finally{c.restore()}g=false}});a.bind("gridUpdate",function(c,d){m(d)});a.bind("parentChange",function(c,d){var e=d?d.getTileLayer():null;e&&m(e)});COG.configurable(a,["style"],COG.paramTweaker(f,null,null),true);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(f){f=T5.ex({style:null,properties:{}},f);return T5.ex(f,{xy:T5.XY.init(0,0),draw:function(){},resync:function(){}})};
T5.Arc=function(f,m){m=T5.ex({size:4},m);var h=T5.XY.init(),g=T5.ex(m,{draw:function(a,c,d){a.beginPath();a.arc(h.x-c,h.y-d,g.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){g.xy=a.syncVectors([f]);h=T5.XY.floor([f])[0]}});COG.Log.info("created arc = ",f);return g};
T5.Poly=function(f,m){m=T5.ex({fill:false,simplify:false},m);var h=false,g=m.fill,a=m.simplify,c=T5.viewState("PINCH"),d=[],e=T5.ex(new T5.Shape(m),{draw:function(l,b,i,j,k,n){if(h){j=true;k=(n&c)!==0;l.beginPath();for(n=d.length;n--;){k=d[n].x-b;var x=d[n].y-i;if(j){l.moveTo(k,x);j=false}else l.lineTo(k,x);k=true}if(k){g&&l.fill();l.stroke()}}},resync:function(l){e.xy=l.syncVectors(f);d=T5.XY.floor(a?T5.XY.simplify(f):f)}});h=f&&f.length>=2;return e};
T5.AnimatedPathLayer=function(f){function m(e,l,b){e.fillStyle="#FFFFFF";e.strokeStyle="#222222";e.beginPath();e.arc(b.x,b.y,4,0,Math.PI*2,false);e.stroke();e.fill()}f=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","PINCH"),drawIndicator:null,duration:2E3,autoCenter:false},f);var h=T5.XY.edges(f.path),g,a=null,c=0;T5.tweenValue(0,h.total,f.easing,function(){d.remove()},f.duration).requestUpdates(function(e,l){c=e;l&&d.remove()});var d=
T5.ex(new T5.ViewLayer(f),{cycle:function(){for(var e=0;e<h.accrued.length&&h.accrued[e]<c;)e++;a=null;if(e<f.path.length-1){var l=c-(e>0?h.accrued[e-1]:0),b=f.path[e];g=T5.XY.theta(b,f.path[e+1],h.edges[e]);a=T5.XY.extendBy(b,g,l);if(f.autoCenter)(e=d.getParent())&&e.centerOn(a)}return a},draw:function(e,l){if(a)(f.drawIndicator?f.drawIndicator:m)(e,l,T5.XY.init(a.x-l.x,a.y-l.y),g)}});return d};
T5.Marker=function(f){function m(b,i,j,k){g=b;a=i;c=j;d=k}f=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},f);var h=false,g=0,a=0,c=0,d=0,e=f.offset,l=T5.ex(f,{isNew:true,isAnimating:function(){return h},draw:function(b,i,j,k,n){if(l.isNew&&f.tweenIn){var x=l.xy.y;l.xy.y=i.y-20;h=true;T5.tween(l.xy,"y",x,f.tweenIn,function(){l.xy.y=x;h=false},f.animationSpeed?f.animationSpeed:250+Math.random()*500)}l.drawMarker(b,i,l.xy.x-(e?i.x:0),l.xy.y-(e?i.y:0),j,k,n);l.isNew=false},drawMarker:function(b,
i,j,k){b.beginPath();b.arc(j,k,4,0,Math.PI*2,false);b.fill();m(j-4,k-4,8,8)},hitTest:function(b,i){return b>=g&&b<=g+c&&i>=a&&i<=a+d},updateBounds:m});COG.observable(l);return l};
T5.ImageMarker=function(f){f=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},f);var m=f.imageAnchor?T5.XY.invert(f.imageAnchor):null,h=T5.ex(new T5.Marker(f),{drawMarker:function(g,a,c,d){if((a=h.isAnimating()&&h.animatingImage?h.animatingImage:h.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var e=h.scale,l=c+~~(m.x*e),b=d+~~(m.y*e),i=~~(a.width*e),j=~~(a.height*e);h.updateBounds(l,b,i,i);if(h.rotation||
h.opacity!==1){g.save();try{g.globalAlpha=h.opacity;g.translate(c,d);g.rotate(h.rotation);g.drawImage(a,m.x*e,m.y*e,i,j)}finally{g.restore()}}else g.drawImage(a,l,b,i,j)}}});if(!h.image)h.image=T5.Images.get(f.imageUrl,function(g){COG.Log.info("updating marker image to: "+g.src);h.image=g});if(!h.animatingImage)h.animatingImage=T5.Images.get(f.animatingImageUrl,function(g){h.animatingImage=g});return h};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(f){function m(e,l){for(var b=a.length;b--;)l.syncVectors([a[b].xy])}function h(){d.changed();d.trigger("markerUpdate",a)}function g(){var e=d.getParent();(e=e&&e.getTileLayer?e.getTileLayer():null)&&m(null,e)}f=T5.ex({zindex:100},f);var a=[],c=false,d=T5.ex(new T5.ViewLayer(f),{cycle:function(){return c},draw:function(e,l,b,i,j){c=false;for(b=a.length;b--;){a[b].draw(e,l,i,d,j);c=c||a[b].isAnimating()}return c?1:0},add:function(e){if(e&&typeof e.length!=="undefined")for(var l=
e.length;l--;){if(e[l])a[a.length]=e[l]}else if(e)a[a.length]=e;h()},clear:function(e){if(e)for(var l=0;l<a.length;l++)e(a[l])&&a.splice(l,1);else a=[];h()},find:function(e){for(var l=[],b=a.length;b--;)if(!e||e(a[b]))l[l.length]=a[b];return l}});d.bind("tap",function(e,l,b){for(var i=[],j=b.x,k=b.y,n=a.length;n--;)if(a[n].hitTest(j,k))i[i.length]=a[n];if(i.length>0)e.cancel=d.trigger("markerTap",l,b,i).cancel});d.bind("gridUpdate",m);d.bind("parentChange",g);d.bind("changed",g);return d};
T5.Style=function(f){function m(c){var d=f[c];typeof d!=="undefined"&&h.push(function(e){e[c]=d})}f=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var h=[],g={applyToContext:function(c){for(var d=h.length;d--;)h[d](c)}};for(var a in f)m(a);return g};
(function(){var f={},m={basic:new T5.Style({lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),waypoints:new T5.Style({lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"})};T5.applyStyle=function(h,g){var a=T5.styles[g]?T5.styles[g]:T5.styles.basic,c;if(h&&h.canvas){c=f[h.canvas.id];f[h.canvas.id]=g}a.applyToContext(h);return c};T5.loadStyles=function(h){COG.jsonp(h,function(g){T5.resetStyles(g)})};T5.resetStyles=function(h){var g={};for(var a in h)g[a]=new T5.Style(h[a]);T5.styles=T5.ex({},
m,g)};T5.styles=m})();(function(){T5.tileSize=256;T5.Tile=function(f){return f=T5.ex({x:0,y:0,gridX:0,gridY:0,dirty:true},f)};T5.EmptyTile=function(f){f=new T5.Tile(f);f.empty=true;return f};T5.ImageTile=function(f){f=T5.ex({url:"",sessionParamRegex:null,loading:false,loaded:false},f);return new T5.Tile(f)}})();
T5.TileGrid=function(f){function m(r,M){var D=T5.Vector(r*l-n.x,M*l-n.y);return new T5.EmptyTile({gridX:D.x,gridY:D.y,empty:true})}function h(r,M,D,J){var H=Math.max(d,e)*0.2>>0,I=T5.XY.init();if(r<0||r+D>d)I.x=r<0?-H:H;if(M<0||M+J>e)I.y=M<0?-H:H;return I}function g(r,M,D){var J=COG.Log.getTraceTicks(),H=0;T5.XY.init(d/2,e/2);ia=true;try{if(D)c=[];if(r)for(D=0;D<e;D++)for(var I=0;I<d;I++){if(!c[H]){var K=r(I,D,j,d,e);K.gridX=I*l-n.x;K.gridY=D*l-n.y;c[H]=K}H++}}finally{ia=false}k=r;x=M;COG.Log.trace("tile grid populated",
J);da.changed()}function a(r,M,D,J){var H,I=[],K=false;r=T5.XY.init((r.x+n.x-l*z)*u>>0,(r.y+n.y-l*z)*u>>0);tilesNeeded=false;if(!ea){H=da.getParent().getDimensions();C=Math.ceil(H.width*u)+1+z;G=Math.ceil(H.height*u)+1+z;ea=T5.XY.init((C-1)/2>>0,(G-1)/2>>0)}for(var N=G;N--;)for(var P=C;P--;){H=P+r.x>=0&&P+r.x<d?c[(N+r.y)*d+(P+r.x)]:null;var ga=T5.XY.init(P-ea.x,N-ea.y);if(!H){v=h(r.x,r.y,C,G);H=m(P+r.x,N+r.y)}K=H?(H.dirty=D||H.dirty)||K:K;I[I.length]={tile:H,centerness:T5.XY.absSize(ga)}}I.sort(function(S,
T){return T.centerness-S.centerness});L||(L=Array(I.length));for(D=I.length;D--;){L[D]=I[D].tile;da.prepTile(L[D],M)}Z=J;return K}f=T5.ex({tileSize:T5.tileSize,bufferSize:1,center:T5.XY.init(),clearBackground:false,gridSize:25,shiftOrigin:null,supportFastDraw:true,allowShift:true},f);var c=Array(Math.pow(f.gridSize,2)),d=f.gridSize,e=f.gridSize,l=f.tileSize,b=e*l,i=d*l,j=T5.XY.offset(f.center,-Math.ceil(d>>1)),k=null,n=T5.XY.init(),x=null,z=f.bufferSize,p=Math.round(l/2),o=false,u=l?1/l:0,t=true,
L=null,E=false,ia=false,Z=0;T5.XY.init();var v=T5.XY.init();T5.getConfig();var C,G,ea,$=f.clearBackground;T5.viewState("ANIMATING");var W=T5.viewState("PAN"),X=T5.viewState("PINCH"),da=T5.ex(new T5.ViewLayer(f),{gridDimensions:new T5.Dimensions(i,b),cycle:function(r,M,D,J){if(v.x!==0||v.y!==0){J=v;var H=f.shiftOrigin;if(!(!f.allowShift||J.x===0&&J.y===0)){var I=COG.Log.getTraceTicks(),K=Array(c.length);K.length=c.length;for(var N=0;N<d;N++)for(var P=0;P<e;P++)K[P*d+N]=N+J.x>=0&&N+J.x<d?c[(P+J.y)*
d+(N+J.x)]:null;c=K;j=H?H(j,J):T5.XY.add(j,J);n.x+=-J.x*l;n.y+=-J.y*l;COG.Log.trace("tile storage shifted",I);g(k,x)}v=T5.XY.init();J=true}if(!o&&(D&X)===0)o=a(M,D,J,r);return o},find:function(r){if(!r)return null;for(var M=c.length;M--;){var D=c[M];if(D&&r(D))return D}return null},prepTile:function(){},drawTile:function(){return false},getTileSize:function(){return l},draw:function(r,M,D,J,H,I,K){var N=M.x;M=M.y;var P=D.width,ga=D.height,S=P,T=ga,R,F=true;if(L){$&&r.clearRect(0,0,P,ga);r.beginPath();
if(t)for(var ha=L.length;ha--;){R=L[ha];var V=R.gridX-N,U=R.gridY-M;if((V>=0||V+l<=P)&&(U>=0||U+l<=ga)){R.x=V;R.y=U;if(R.empty){if(!$){r.clearRect(V,U,l,l);r.rect(V,U,l,l);F=false}}else if(I||R.dirty){(R=da.drawTile(r,R,V,U,J,I,K,$))&&r.rect(V,U,l,l);F=F&&R}S=V<S?V:S;T=U<T?U:T}}if(!$&&(J&W)!==0){if(S>0){r.clearRect(0,0,S,D.height);r.rect(0,0,S,D.height)}if(T>0){r.clearRect(0,0,D.width,T);r.rect(0,0,D.width,T)}}$||r.clip();F&&!E&&H.trigger("tileDrawComplete");o=false;E=F}},getTileAtXY:function(r,M){for(var D=
null,J=L?L.length:0;J--;){var H=L[J];if(H&&r>=H.x&&M>=H.y)if(r<=H.x+l&&M<=H.y+l){D=H;break}}COG.Log.info("looking for tile @ x: "+r+", y: "+M+", found: "+D);return D},getTileVirtualXY:function(r,M,D){r=T5.XY.add(T5.XY.init(r,M),T5.XY.invert(j),n);r=T5.XY.init(r.x*l,r.y*l);if(D){r.x+=p;r.y+=p}return r},populate:function(r){g(r,null,true)},syncVectors:function(){return T5.XY.init(0,0)}});da.bind("resize",function(){COG.Log.info("captured resize");ea=null});da.bind("scale",function(){t=false});COG.listen("imagecache.cleared",
function(){for(var r=c.length;r--;)if(c[r])c[r].loaded=false});COG.listen("tiler.repaint",function(){for(var r=c.length;r--;)if(c[r]){c[r].x=null;c[r].y=null}});return da};
T5.ImageTileGrid=function(f){function m(k){function n(){var x=T5.Images.newCanvas(32,32),z=x.getContext("2d");z.fillStyle="#BBBBBB";z.fillRect(0,0,32,32);z.fillStyle="#C3C3C3";z.fillRect(0,0,16,16);z.fillRect(16,16,16,16);return x}if(!g||k!==g.width){g=T5.Images.newCanvas(k,k);k=g.getContext("2d");k.fillStyle=typeof FlashCanvas!=="undefined"?"#666666":k.createPattern(n(),"repeat");k.fillRect(0,0,g.width,g.height)}return g}f=T5.ex({emptyTile:function(k){if(!h||k!==h.width){h=T5.Images.newCanvas(k,
k);k=h.getContext("2d");k.fillStyle="rgba(150, 150, 150, 0.1)";k.fillRect(0,0,h.width,h.height)}return h}(T5.tileSize),panningTile:null,tileOffset:T5.XY.init(),tileDrawArgs:{}},f);var h=f.emptyTile,g=f.panningTile?f.panningTile:m(T5.tileSize),a=T5.viewState("ACTIVE"),c=T5.viewState("PAN"),d=T5.getConfig().requireFastDraw,e=f.tileSize?f.tileSize:T5.tileSize,l=T5.Images.get,b=T5.Images.load,i=T5.ex({background:null,overlay:null,offset:T5.XY.init(),realSize:new T5.Dimensions(e,e)},f.tileDrawArgs),j=
T5.ex(new T5.TileGrid(f),{drawTile:function(k,n,x,z,p,o,u,t){o=n.url?l(n.url):null;u=false;if(o){k.drawImage(o,x,z);n.dirty=false;u=true}else if((p&c)!==0){t||k.drawImage(g,x,z);u=true}return u},initTileUrl:function(){},prepTile:function(k,n){if(k&&!k.loading&&(!d||n===a)){k.url||j.initTileUrl(k);if(!l(k.url)){k.loading=true;b(k.url,function(){k.loadTime=(new Date).getTime();k.loaded=true;k.dirty=true;j.changed()},i)}}}});return j};
T5.Tiler=function(f){f=T5.ex({container:"",drawCenter:false,datasources:{},tileLoadThreshold:"first"},f);var m=T5.ex(new T5.View(f),{getTileLayer:function(){return m.getLayer("grid0")},setTileLayer:function(h){m.setLayer("grid0",h);m.trigger("gridUpdate",h);m.eachLayer(function(g){g.trigger("gridUpdate",h)})},viewPixToGridPix:function(h){var g=m.getOffset();return T5.XY.init(h.x+g.x,h.y+g.y)},centerOn:function(h,g,a,c){var d=m.getTileLayer(),e=m.getDimensions();(d=d?d.getTileSize():0)&&m.updateOffset(h.gridX-
(e.width-d)*0.5>>0,h.gridY-(e.height-d)*0.5>>0,g,a,c)},cleanup:function(){m.removeLayer("grid0")},repaint:function(){COG.say("tiler.repaint");m.trigger("wake")},select:function(h){m.trigger("selectTile",h)}});m.bind("tap",function(h,g,a){if(h=m.getTileLayer())(a=h.getTileAtXY(a.x,a.y))&&m.trigger("selectTile",a)});return m};
