COG=function(){var h=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,i=0,f={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,e=arguments.length,b=false,k,d,j,g;if(typeof a==="boolean"){b=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!f.isFunction(a))a={};if(e===c){a=this;--c}for(;c<e;c++)if((k=arguments[c])!=null)for(d in k){j=a[d];g=k[d];if(a!==g)if(b&&g&&(f.isPlainObject(g)||f.isArray(g))){j=j&&(f.isPlainObject(j)||f.isArray(j))?j:f.isArray(g)?[]:{};a[d]=f.extend(b,j,g)}else if(g!==
undefined)a[d]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||m.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var e=a,b=arguments,k=1;if(c&&f.isArray(c)){b=c;k=0}for(k=k;k<b;k++)e=e&&typeof foo[b[k]]!=="undefined";return e},newModule:function(a){a=f.extend({id:null,requires:[],parent:null},a);if(a.parent)a=f.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+i++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,e=0;e<=c;e++)a=a.replace(RegExp("\\{"+e+"\\}","gi"),arguments[e+
1]);return a},wordExists:function(a,c){var e="";if(c.toString)c=c.toString();for(var b=0;b<c.length;b++)e+=!/\w/.test(c[b])?"\\"+c[b]:c[b];return RegExp("(^|\\s|\\,)"+e+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var e=h.exec(a);e;){a=a.replace(e[0],COG.XPath.first(e[1],c));h.lastIndex=0;e=h.exec(a)}return a}};return f}();
COG.Log=function(){function h(c,e){var b,k=e&&e.length>0?e[0]:"";for(b=1;e&&b<e.length;b++)k+=" "+(i&&COG.isPlainObject(e[b])?JSON.stringify(e[b]):e[b]);typeof console!=="undefined"&&console[c](k);for(b=0;b<m.length;b++)m[b].call(a,k,c)}var m=[],i=typeof JSON!=="undefined",f=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return f?(new Date).getTime():null},trace:function(c,e){if(f)console.markTimeline(c+(e?": "+(a.getTraceTicks()-e)+"ms":""))},debug:function(){h("debug",
arguments)},info:function(){h("info",arguments)},warn:function(){h("warn",arguments)},error:function(){h("error",arguments)},exception:function(c){a.error(arguments);for(var e in c)a.info("ERROR DETAIL: "+e+": "+c[e])},watch:function(c,e){try{e()}catch(b){a.exception(b,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return a}();
(function(){function h(f,a){f[a]||(f[a]=function(c){return f.configure(a,c)})}function m(f){f.gtConfId=COG.objId("configurable");f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var i={};COG.paramTweaker=function(f,a,c){return function(e,b){if(typeof b!=="undefined"){if(e in f)f[e]=b;c&&e in c&&c[e](e,b)}else return a&&e in a?a[e](e):f[e]}};COG.configurable=function(f,a,c,e){if(f){f.gtConfId||m(f);var b=f.gtConfId,k=f.gtConfig,d=f.gtConfigFns;i[b]=f;d.push(c);for(c=a.length;c--;){k[a[c]]=true;e&&
h(f,a[c])}if(!f.configure)f.configure=function(j,g){if(k[j]){for(var l=d.length;l--;){var p=d[l](j,g);if(typeof p!=="undefined")return p}return i[b]}return null}}}})();
(function(){function h(m,i){var f=m.gtObsHandlers;f[i]||(f[i]=[]);return f[i]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(i,f){var a=COG.objId("callback");h(m,i).unshift({fn:f,id:a});return a};m.trigger=function(i){var f=h(m,i),a={cancel:false,tickCount:(new Date).getTime()},c;if(!f)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var e=f.length;e--&&!a.cancel;)f[e].fn.apply(self,c);return a};m.unbind=
function(i,f){for(var a=h(m,i),c=0;a&&c<a.length;c++)if(a[c].id===f){a.splice(c,1);break}return m}}}}})();(function(){var h={},m=[];COG.addPipe=function(i){i("pipe.test",{});m.push(i)};COG.listen=function(i,f){h[i]||(h[i]=[]);f&&h[i].push(f)};COG.say=function(i,f){var a;for(a=m.length;a--;)m[a](i,f);if(h[i])for(a=h[i].length;a--;)h[i][a](f)}})();
COG.Loopage=function(){function h(g){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function m(g){b.push(g);i()}function i(){k&&clearTimeout(k);k=setTimeout(f,0);j=true}function f(){for(var g,l=(new Date).getTime(),p=e.length;b.length>0;){var w=b.shift();for(g=p;g--;)if(e[g].id===w){e.splice(g,1);break}j=true;p=e.length}if(j){d=a;for(g=p;g--;)d=e[g].frequency<d?e[g].frequency:d}for(g=p;g--;){w=l-e[g].lastTick;if(e[g].lastTick===0||w>=e[g].frequency){e[g].execute(l,
e[g]);e[g].lastTick=l;e[g].single&&e[g].trigger("complete")}}k=p?setTimeout(f,d):0}var a=6E4,c=0,e=[],b=[],k=0,d=a,j=true;return{join:function(g){var l=new h(g);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});e.unshift(l);i();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function h(d){return d<10?"0"+d:d}function m(d){a.lastIndex=0;return a.test(d)?'"'+d.replace(a,function(j){var g=b[j];return typeof g==="string"?g:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function i(d,j){var g,l,p,w,v=c,o,n=j[d];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(d);if(typeof k==="function")n=k.call(j,d,n);switch(typeof n){case "string":return m(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";c+=e;o=[];if(Object.prototype.toString.apply(n)==="[object Array]"){w=n.length;for(g=0;g<w;g+=1)o[g]=i(g,n)||"null";p=o.length===0?"[]":c?"[\n"+c+o.join(",\n"+c)+"\n"+v+"]":"["+o.join(",")+"]";c=v;return p}if(k&&typeof k==="object"){w=k.length;for(g=0;g<w;g+=1){l=k[g];if(typeof l==="string")if(p=i(l,n))o.push(m(l)+(c?": ":":")+p)}}else for(l in n)if(Object.hasOwnProperty.call(n,l))if(p=i(l,n))o.push(m(l)+(c?": ":":")+p);p=o.length===0?"{}":c?"{\n"+c+o.join(",\n"+c)+
"\n"+v+"}":"{"+o.join(",")+"}";c=v;return p}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,e,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(d,j,g){var l;e=c="";if(typeof g==="number")for(l=0;l<g;l+=1)e+=" ";else if(typeof g==="string")e=g;if((k=j)&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number"))throw Error("JSON.stringify");return i("",
{"":d})};if(typeof JSON.parse!=="function")JSON.parse=function(d,j){function g(p,w){var v,o,n=p[w];if(n&&typeof n==="object")for(v in n)if(Object.hasOwnProperty.call(n,v)){o=g(n,v);if(o!==undefined)n[v]=o;else delete n[v]}return j.call(p,w,n)}var l;d=String(d);f.lastIndex=0;if(f.test(d))d=d.replace(f,function(p){return"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+d+")");return typeof j==="function"?g({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function h(i,f){var a=i.split("|"),c={};for(var e in f){var b=f[e];c[e]=a.length>b?a[b]:null}return c}var m={JSON:{parse:function(i){return JSON.parse(i)}},PDON:{parse:function(i){var f=null,a=[];i=i.split("\n");for(var c=0;c<i.length;c++){var e=i[c];if(f)a.push(h(e,f));else if(e){f=e.split("|");e={};for(var b=0;b<f.length;b++)e[f[b]]=b;f=e}else f=null}return a}}};COG.parseData=function(i,f){f=f?f.toUpperCase():"JSON";if(!m[f])throw Error("Unsupported data format: "+f);try{return m[f].parse(i)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function h(a){for(var c=null,e=0;e<m.length;e++)if(c=m[e](a))break;return c}var m=[],i=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var f={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var e=null;if(a.resultType>=0&&a.resultType<i.length)e=i[a.resultType];if(e)c=e(a)}return c?c:""}}},first:function(a,c){var e=f.SearchResult,b;var k=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!k)k=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))b=c.evaluate(a,c,h,k,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(d){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);b=null}return new e(b)},registerResolver:function(a){m.push(a)}};return f}();
COG.Storage=function(){function h(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,i){var f=h(i).getItem(m);return/^(\{|\[).*(\}|\])$/.test(f)?JSON.parse(f):f},set:function(m,i,f){i=jQuery.isArray(i)||jQuery.isPlainObject(i)?JSON.stringify(i):i;h(f).setItem(m,i)},remove:function(m,i){h(i).removeItem(m)}}}();
COG.ParseRules=function(){var h=[];return{add:function(m,i){h.push({regex:m,handler:i})},each:function(m,i,f){function a(){c++;f&&c>=h.length&&f(i)}for(var c=0,e=0;e<h.length;e++){var b=h[e].regex,k=h[e].handler,d=false;if(b){b.lastIndex=-1;if((b=b.exec(m))&&k){d=true;k(b,i,a)&&a()}}d||a()}}}};
(function(){function h(b){var k=[],d=function(g,l){l=COG.isFunction(l)?l():l;k[k.length]=encodeURIComponent(g)+"="+encodeURIComponent(l)};if(COG.isArray(b))for(var j=0;j<b.length;j++)d(b[j].name,b[j].value);else for(j in b)d(j,b[j]);return k.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},i={JSON:["json"],PDON:["pdon.txt"]},f=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},e={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function k(){if(this.readyState===4){var l=null,p=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(p)if(b.handleResponse)b.handleResponse(this);else{var w=b,v=this.getResponseHeader(e.CONTENT_TYPE),o,n=false;for(o in m)if(v&&v.indexOf(m[o])>=0){n=true;
break}v=!n;for(n=0;n<f.length;n++)v=v||f[n]==o;if(v)b:{v=o;for(var x in i)for(n=0;n<i[x].length;n++)if(RegExp(i[x][n]+"$","i").test(w.url)){o=x;break b}o=v?v:"DEFAULT"}try{l=c[o](this,w)}catch(t){l=c.DEFAULT(this,w)}}else b.error&&b.error(this)}catch(K){COG.Log.exception(K,"PROCESSING AJAX RESPONSE")}p&&l&&b.success&&b.success.call(this,l)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var d=
a.exec(b.url),j=d&&(d[1]&&d[1]!==location.protocol||d[2]!==location.host);if(b.data)b.method="POST";if(b.url){d=null;if(b.xhr)d=b.xhr(b);d||(d=new XMLHttpRequest);d.open(b.method,b.url,b.async);b.data&&d.setRequestHeader("Content-Type",b.contentType);j||d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.onreadystatechange=k;d.send(b.method=="POST"?h(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function h(a){var c=document.createElement("script"),e=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!e&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){e=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};i||(i=document.getElementsByTagName("head")[0]);i.appendChild(c)}var m=0,i,f=this;COG.jsonp=function(a,c,e){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++m;f[b]=function(k){c(k);f[b]=null;try{delete f[b]}catch(d){}};
h(a+(e?e:"callback")+"="+b);return b}})();
COG.Touch=function(){function h(u,B){return{x:u.x-B.x,y:u.y-B.y}}function m(u,B){var C=h(u,B);return Math.sqrt(C.x*C.x+C.y*C.y)}function i(u){if(u.count>1)return m(u.touches[0],u.touches[1]);return 0}function f(u,B){var C=u&&u.count>0?u.touches[0]:null;if(C&&B&&B.count>0)return h(C,B.touches[0]);return null}function a(u,B){u.count=B.count;for(var C=d;C--;){u.touches[C].x=B.touches[C].x;u.touches[C].y=B.touches[C].y}}function c(){for(var u={count:0,touches:Array(d)},B=d;B--;)u.touches[B]=k();return u}
function e(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}function b(u,B,C){if(z){B=B[C?C:"touches"];C=B.length;for(C=u.count=C;C--;){u.touches[C].x=B[C].pageX;u.touches[C].y=B[C].pageY}}else if(B.button===0){u.count=1;u.touches[0].x=B.pageX?B.pageX:B.screenX;u.touches[0].y=B.pageY?B.pageY:B.screenY}else u.count=0}function k(u,B){return{x:u?u:0,y:B?B:0}}var d=10,j=120,g=100,l=250,p=300,w=5,v=0,o=1,n=2,x=7,t=0,K=0,z=undefined,J=function(u){function B(r,
y,D,R){var E=Math.asin((r.y-y.y)/D);D=D*(ea/R)>>0;D=D>qa?qa:D;E=y.x>r.x?E:Math.PI-E;Y("pan",Math.cos(E)*-D,Math.sin(E)*D,true)}function C(r,y){var D,R;if(z){D=y-G;if(D<l){R=m(I.touches[0],r);R>u.inertiaTrigger&&B(I.touches[0],r,R,D)}}else{V.x=r.x;V.y=r.y;COG.Loopage.join({execute:function(E,q){D=E-y;R=m(r,V);if(D<g&&R>u.inertiaTrigger){q.trigger("complete");B(r,V,R,D)}else D>g&&q.trigger("complete")},frequency:10})}}function ha(r){var y=0,D=0;if(r.offsetParent){do{y+=r.offsetLeft;D+=r.offsetTop;r=
r.offsetParent}while(r)}return k(y,D)}function ma(r){var y=r.count,D=Array(y),R=ha(Z);for(y=y;y--;)D[y]=k(r.touches[y].x-R.x,r.touches[y].y-R.y);return D}function Y(){ia&&ia.trigger.apply(null,arguments)}function O(r,y){var D=ha(Z);D=k(y.x-D.x,y.y-D.y);Y(r,y,D)}function na(r){var y=r.target?r.target:r.srcElement;if($||y&&y===Z){b(I,r);if(I.count!==0){T=null;aa.x=0;aa.y=0;ja=true;ba=false;G=(new Date).getTime();e(r);y.style.cursor="move";Y("inertiaCancel");ra=G;if(r=I.count>0?I.touches[0]:null){Y("touchStart",
r.x,r.y);if(ra-sa<p)if((r=h(I.touches[0],ka.touches[0]))&&Math.abs(r.x)<u.maxDistDoubleTap&&Math.abs(r.y)<u.maxDistDoubleTap)ba=true;W=v;a(ka,I)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function M(r){var y=r.target?r.target:r.srcElement,D=0;if($||y&&y===Z){b(L,r);if(L.count>0){V.x=L.touches[0].x;V.y=L.touches[0].y}if(ja){z&&e(r);if(L.count>1){I.count===1&&a(I,L);D=i(I)-i(L)}if(W===v)if((r=f(L,I))&&(Math.abs(r.x)>=x||Math.abs(r.y)>=x))W=o;if(W!==v)if(!D||Math.abs(D)<w){if(T=
f(L,ka)){aa.x-=T.x;aa.y-=T.y;ca.x-=T.x;ca.y-=T.y}Y("pan",ca.x,ca.y);ca.x=0;ca.y=0;W=o}else{Y("pinchZoom",ma(I),ma(L));W=n}a(ka,L)}}}function oa(r){var y=r.target?r.target:r.srcElement;if(ja&&($||y&&y===Z)){b(fa,r,"changedTouches");var D=fa.touches[0];z&&e(r);r=(new Date).getTime();sa=ra;if(W===v){O("tap",I.touches[0]);pa||(pa=setTimeout(function(){pa=0;ba&&O("doubleTap",I.touches[0])},p+50))}else if(W==o){Y("panEnd",aa.x,aa.y);ga&&C(D,r)}else W==n&&Y("pinchZoomEnd",ma(I),ma(ka),r-G);y.style.cursor=
"default";ja=false}}function X(r){var y=r.target?r.target:r.srcElement;if($||y&&y===Z){if(r.detail){y=-r.detail*j;y=k(r.axis===1?y:0,r.axis===2?y:0)}else y=k(r.wheelDeltaX,r.wheelDeltaY);var D=y.y!==0?Math.abs(y.y/j):0;if(V&&D!==0){var R=k(V.x-Z.offsetLeft,V.y-Z.offsetTop);Y("wheelZoom",R,Math.pow(2,y.y>0?D:-D))}e(r)}}u=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,
tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},u);var ba=false,pa=0,U=T5.getConfig(),I=c(),L=c(),ka=c(),fa=c(),T=null,aa=k(),ca=k(),W=null,ja=false,G=0,la=[],V=k(),ga=false,ea,qa,ra=0,sa=0,Z=u.element,ia=u.observable,$=typeof FlashCanvas!=="undefined",ua={supportsTouch:z,addListeners:function(r){la.push(r)},decoupleListeners:function(r){for(var y=0;r&&y<la.length;y++)if(la[y].listenerId===r){la.splice(y,1);break}},release:function(){U.unbindEvent(z?"touchstart":"mousedown",na,false);
U.unbindEvent(z?"touchmove":"mousemove",M,false);U.unbindEvent(z?"touchend":"mouseup",oa,false);if(!z){window.removeEventListener("mousewheel",X,false);window.removeEventListener("DOMMouseScroll",X,false)}},inertiaEnable:function(r,y){ga=true;ea=r;qa=y?Math.min(y.width,y.height):500},inertiaDisable:function(){ga=false}};if(typeof z==="undefined")z=T5.getConfig().supportsTouch;U.bindEvent(z?"touchstart":"mousedown",na,false);U.bindEvent(z?"touchmove":"mousemove",M,false);U.bindEvent(z?"touchend":"mouseup",
oa,false);if(!z){U.bindEvent("mousewheel",X,window);U.bindEvent("DOMMouseScroll",X,window)}return ua},P=[];return{capture:function(u,B){if(!u)throw Error("Unable to capture touch of null element");if(!u.id)u.id="touchable_"+t++;var C=P[u.id];if(!C){C=new J(COG.extend({element:u},B));P[u.id]=C}if(B){B.listenerId&&C.decoupleListeners(B.listenerId);B.listenerId=++K;C.addListeners(B)}return C},release:function(u){if(u&&u.id&&P[u.id]){P[u.id].release();delete P[u.id]}}}}();
T5=function(){var h=function(){function a(b,k){return e(b.x-k.x,b.y-k.y)}function c(b,k){if(!k)k=b.length;if(k<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var d={edges:Array(k-1),accrued:Array(k-1),total:0},j=0;j<k-1;j++){var g=a(b[j],b[j+1]);d.edges[j]=Math.sqrt(g.x*g.x+g.y*g.y);d.accrued[j]=d.total+d.edges[j];d.total+=d.edges[j]}return d}function e(b,k){return{x:b?b:0,y:k?k:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,k=0,d=arguments.length;d--;){b+=arguments[d].x;k+=arguments[d].y}return e(b,k)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?e(b.x,b.y):null},diff:a,distance:function(b,k){return c(b,k).total},edges:c,equals:function(b,k){return b.x===k.x&&b.y===k.y},extendBy:function(b,k,d){return e(b.x-Math.cos(k)*d,b.y-Math.sin(k)*d)},floor:function(b){for(var k=Array(b.length),d=b.length;d--;)k[d]=e(~~b[d].x,~~b[d].y);return k},getRect:function(b){for(var k,d,j,
g,l=b.length;l--;){var p=b[l];k=typeof k==="undefined"||p.x<k?p.x:k;d=typeof d==="undefined"||p.y<d?p.y:d;j=typeof j==="undefined"||p.x>j?p.x:j;g=typeof g==="undefined"||p.y>g?p.y:g}return i.init(k,d,g,g)},init:e,invert:function(b){return e(-b.x,-b.y)},min:function(b,k){return e(b.x<k.x?b.x:k.x,b.y<k.y?b.y:k.y)},max:function(b,k){return e(b.x>k.x?b.x:k.x,b.y>k.y?b.y:k.y)},offset:function(b,k,d){return e(b.x+k,b.y+(d?d:k))},simplify:function(b,k){if(!b)return null;k=k?k:h.VECTOR_SIMPLIFICATION;for(var d=
[],j=null,g=b.length;g--;){var l=b[g];if(include=!j||g===0||Math.abs(l.x-j.x)+Math.abs(l.y-j.y)>k){d.unshift(l);j=l}}return d},theta:function(b,k,d){d=Math.asin((b.y-k.y)/d);return b.x>k.x?d:Math.PI-d}}}(),m=function(){return{dotProduct:function(a,c){return a.x*c.x+a.y*c.y}}}(),i=function(){function a(e){return c(e.x1,e.y1,e.x2,e.y2)}function c(e,b,k,d){e=e?e:0;b=b?b:0;k=typeof k!=="undefined"?k:e;d=typeof d!=="undefined "?d:d;return{x1:e,y1:b,x2:k,y2:d,width:k-e,height:d-b}}return{center:function(e){return h.init(e.x1+
e.width/2,e.y1+e.height/2)},copy:a,diagonalSize:function(e){return Math.sqrt(e.width*e.width+e.height*e.height)},fromCenter:function(e,b,k,d){k=~~(k/2);d=~~(d/2);return c(e-k,b-d,e+k,b+d)},init:c,intersect:function(e,b){var k=c(Math.max(e.x1,b.x1),Math.max(e.y1,b.y1),Math.min(e.x2,b.x2),Math.min(e.y2,b.y2));return k.width>0&&k.height>0?k:null},union:function(e,b){if(e.width===0||e.height===0)return a(b);else if(b.width===0||b.height===0)return a(e);else{var k=c(Math.min(e.x1,b.x1),Math.min(e.y1,b.y1),
Math.max(e.x2,b.x2),Math.max(e.y2,b.y2));return k.width>0&&k.height>0?k:null}}}}(),f=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return h.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,c){a=a?a:0;return{width:a,height:c?c:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:h,XYRect:i,Vector:function(a,c){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return h.init(a,c)},V:COG.extend(h,m),D:f}}();
(function(){function h(){for(;w.length>0;){var o=w.shift();document.location=o}p=0}function m(o){for(var n=true,x=v.length;x--;)n=n&&o!=v[x];return n}function i(o,n){var x=[];for(var t in n)t&&x.push(t+"="+escape(n[t]));return"tile5://"+o+"/"+(x.length>0?"?"+x.join("&"):"")}function f(o,n){m(o)&&COG.Log.info("would push url: "+i(o,n))}function a(o,n){if(m(o)){w.push(i(o,n));p||(p=setTimeout(h,100))}}function c(o){return function(n,x,t){(t?t:o?document.body:document).addEventListener(n,x,false)}}function e(o){return function(n,
x,t){(t?t:o?document.body:document).removeEventListener(n,x,false)}}function b(o,n,x){(x?x:document).attachEvent("on"+o,n)}function k(o,n,x){(x?x:document).detachEvent("on"+o,n)}function d(){j={base:{name:"Unknown",bindEvent:c(),unbindEvent:e(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:f,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:k,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:e(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[j.froyo,j.android,j.ipod,j.iphone,j.ipad,j.ie]}var j=null,g=[],l=null,p=0,w=[],v=["view.wake","tile.loaded"];T5.getConfig=function(){j||d();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var o=0;o<g.length;o++){var n=g[o];if(n.regex&&n.regex.test(navigator.userAgent)){l=T5.ex({},j.base,n);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=j.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var h=[],m={execute:function(i){var f=m.findAction(i);f&&f.execute.apply(f,Array.prototype.slice.call(arguments,1))},findAction:function(i){for(var f=h.length;f--;)if(h[f].id==i)return h[f];return null},getRegisteredActions:function(){return[].concat(h)},getRegisteredActionIds:function(){for(var i=[],f=h.length;f--;)h[f].id&&i.push(h[f].id);return i},registerAction:function(i){i&&i.id&&h.push(i)},Action:function(i){i=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},i);var f={id:i.id,execute:function(){i.execute&&i.execute.apply(this,arguments)},getParam:function(a){return i[a]?i[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",f.id,i.title,i.icon)}};i.autoRegister&&m.registerAction(f);return f},Agent:function(i){i=COG.extend({name:"Untitled",translator:null,execute:null},i);var f={getName:function(){return i.name},getParam:function(a){return i[a]},getId:function(){return COG.toID(f.getName())},run:function(a,c){if(i.execute){var e=
i.translator?i.translator(a):a;i.execute.call(f,e,function(b,k){c&&c(b,k,e)})}}};return f},runAgents:function(i,f,a){for(var c=0;c<i.length;c++)i[c].run(f,a)}};return m}();
T5.Resources=function(){var h="",m={},i={getPath:function(f){return/^(file|https?|\/)/.test(f)?f:h+f},setBasePath:function(f){h=f},loadResource:function(f){f=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},f);var a=function(c){f.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){f.callback(c)})};f.cacheable&&m[f.filename]?a(m[f.filename]):COG.xhr({url:i.getPath(f.filename),dataType:f.dataType,success:function(c){if(f.cacheable)m[f.filename]=c;a(c)},error:function(c,e,b){COG.Log.error("error loading resource ["+
f.filename+"], error = "+b)}})},loadSnippet:function(f,a){/\.\w+$/.test(f)||(f+=".html");i.loadResource({filename:"snippets/"+f,callback:a,dataType:"html"})}};return i}();
T5.Images=function(){function h(){if(!p){var o=T5.getConfig().maxImageLoads;p=COG.Loopage.join({execute:function(n,x){if(!o||j.length<o){var t=d.shift();if(t){j[j.length]=t;t.image.onload=i;t.image.src=T5.Resources.getPath(t.url);t.requested=T5.ticks()}else x.trigger("complete")}},frequency:10});p.bind("complete",function(){p=null})}}function m(){w=true;try{var o=g.length/2>>0;if(o>0){g.sort(function(x,t){return x.created-t.created});for(var n=o;n--;)delete c[g[n].url];g.splice(0,o)}}finally{w=false}COG.say("imagecache.cleared")}
function i(){var o=b[this.id],n;if(o&&o.image.complete&&o.image.width>0){o.loaded=true;o.hitCount=1;for(n=j.length;n--;)if(j[n].image.src==this.src){j.splice(n,1);break}if(o.background||o.postProcess||o.drawBackground||o.customDraw)if(o.image){globalImageData=o;n=a(o.realSize?o.realSize.width:o.image.width,o.realSize?o.realSize.height:o.image.height);var x=n.getContext("2d"),t=o.offset?o.offset:T5.XY.init();o.background&&x.drawImage(o.background,0,0);o.drawBackground&&o.drawBackground(x);o.customDraw?
o.customDraw(x,o):x.drawImage(o.image,t.x,t.y);o.postProcess&&o.postProcess(x,o);o.image=n}for(n=o.callbacks.length;n--;)o.callbacks[n]&&o.callbacks[n](this,false);o.callbacks=[];g[g.length]={url:this.src,created:o.requested};delete b[this.id];h()}}function f(o,n,x){var t=c[o];if(t){t.hitCount++;t.image.complete&&t.image.width>0&&n?n(t.image,true):t.callbacks.push(n)}else{t=T5.ex({url:o,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[n]},x);t.image.id="resourceLoaderImage"+
k++;c[o]=t;b[t.image.id]=t;d[d.length]=t;h()}return t}function a(o,n){var x=document.createElement("canvas");x.width=o?o:0;x.height=n?n:0;if(typeof FlashCanvas!=="undefined"){x.id="tmpCanvas"+e++;x.style.cssText="position: absolute; top: -"+(n-1)+"px; left: -"+(o-1)+"px;";document.body.appendChild(x);FlashCanvas.initElement(x)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(x);return x}var c={},e=0,b={},k=0,d=[],j=[],g=[],l=0,p=null,w=false,v={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){j=[]},get:function(o,n,x){var t=null,K=null;w||(t=c[o]);if((K=t?t.image:null)&&(K.getContext||K.complete&&K.width>0))return K;else n&&f(o,n,x);return null},load:f,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:j.length,queuedImageCount:d.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(o){for(var n=false,x=0,t=T5.getConfig();x<j.length;)if(o-j[x].requested>v.loadTimeout*1E3){j.splice(x,1);n=true}else x++;n&&h();if(t&&t.imageCacheMaxSize){l=
g.length*v.avgImageSize/t.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return v}();T5.Generator=function(){var h={};return{init:function(m,i){var f=h[m];if(!f)throw Error("Unable to locate requested generator: "+m);return new f(i)},register:function(m,i){h[m]=i},Template:function(){}}}();
T5.TimeLord=function(){var h=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,i=function(a,c){return{days:a?a:0,seconds:c?c:0}},f={8601:function(a){a=a.split("T");var c=null;c=null;var e=0,b=0;h.lastIndex=-1;c=h.exec(a[0]);e+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(a[1]);b+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;b+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;b+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new i(e,b)}};return{Duration:i,addDuration:function(){for(var a=new i,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var e=c?f[c]:null;if(e)return e(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new i},formatDuration:function(a){var c,e,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){e=Math.round(a/60);a-=e*60}if(c)b=b+c+(c>1?" hrs ":" hr ")+
(e?(e>10?e:"0"+e)+" min ":"");else if(e)b=b+e+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
T5.zoomable=function(h,m){function i(a,c){if(a&&f!==a){f=a;h.triggerAll("zoomLevelChange",f,c)}}m=T5.ex({initial:0,min:0,max:null,zoomAnimation:T5.easing("quad.out")},m);var f=m.initial;T5.ex(h,{getZoomLevel:function(){return f},setZoomLevel:i,zoomIn:function(){h.scale(2,T5.easing("sine.out"))||h.setZoomLevel(f+1)},zoomOut:function(){h.scale(0.5,T5.easing("sine.out"))||h.setZoomLevel(f-1)}});h.bind("scale",function(a,c,e){a=0;c=Math.sqrt(c);if(c<1)a=-(0.5/c);else if(c>1)a=c;T5.cancelAnimation();i(f+
a>>0,e)});h.bind("doubleTap",function(a,c,e){if(h.scalable()){T5.cancelAnimation();h.animate(2,T5.D.getCenter(h.getDimensions()),T5.XY.init(e.x,e.y),m.zoomAnimation)}})};
(function(){var h=Math.PI*2,m=Math.PI/2,i=Math.abs,f=Math.pow,a=Math.sin,c=Math.asin,e=Math.cos,b=1.70158,k={linear:function(d,j,g,l){return g*d/l+j},backin:function(d,j,g,l){return g*(d/=l)*d*((b+1)*d-b)+j},backout:function(d,j,g,l){return g*((d=d/l-1)*d*((b+1)*d+b)+1)+j},backinout:function(d,j,g,l){return(d/=l/2)<1?g/2*d*d*(((b*=1.525)+1)*d-b)+j:g/2*((d-=2)*d*(((b*=1.525)+1)*d+b)+2)+j},bouncein:function(d,j,g,l){return g-k.bounceout(l-d,0,g,l)+j},bounceout:function(d,j,g,l){return(d/=l)<1/2.75?
g*7.5625*d*d+j:d<2/2.75?g*(7.5625*(d-=1.5/2.75)*d+0.75)+j:d<2.5/2.75?g*(7.5625*(d-=2.25/2.75)*d+0.9375)+j:g*(7.5625*(d-=2.625/2.75)*d+0.984375)+j},bounceinout:function(d,j,g,l){return d<l/2?k.bouncein(d*2,0,g,l)/2+j:k.bounceout(d*2-l,0,g,l)/2+g/2+j},cubicin:function(d,j,g,l){return g*(d/=l)*d*d+j},cubicout:function(d,j,g,l){return g*((d=d/l-1)*d*d+1)+j},cubicinout:function(d,j,g,l){if((d/=l/2)<1)return g/2*d*d*d+j;return g/2*((d-=2)*d*d+2)+j},elasticin:function(d,j,g,l,p,w){if(d==0)return j;if((d/=
l)==1)return j+g;w||(w=l*0.3);if(!p||p<i(g)){p=g;g=w/4}else g=w/h*c(g/p);return-(p*f(2,10*(d-=1))*a((d*l-g)*h/w))+j},elasticout:function(d,j,g,l,p,w){var v;if(d==0)return j;if((d/=l)==1)return j+g;w||(w=l*0.3);if(!p||p<i(g)){p=g;v=w/4}else v=w/h*c(g/p);return p*f(2,-10*d)*a((d*l-v)*h/w)+g+j},elasticinout:function(d,j,g,l,p,w){var v;if(d==0)return j;if((d/=l/2)==2)return j+g;w||(w=l*0.3*1.5);if(!p||p<i(g)){p=g;v=w/4}else v=w/h*c(g/p);if(d<1)return-0.5*p*f(2,10*(d-=1))*a((d*l-v)*h/w)+j;return p*f(2,
-10*(d-=1))*a((d*l-v)*h/w)*0.5+g+j},quadin:function(d,j,g,l){return g*(d/=l)*d+j},quadout:function(d,j,g,l){return-g*(d/=l)*(d-2)+j},quadinout:function(d,j,g,l){if((d/=l/2)<1)return g/2*d*d+j;return-g/2*(--d*(d-2)-1)+j},sinein:function(d,j,g,l){return-g*e(d/l*m)+g+j},sineout:function(d,j,g,l){return g*a(d/l*m)+j},sineinout:function(d,j,g,l){return-g/2*(e(Math.PI*d/l)-1)+j}};T5.easing=function(d){return k[d.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(d,j){k[d.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=j}})();
T5.Tween=function(h){h=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},h);var m=T5.ticks(),i=[],f=false,a=0,c=0,e={cancelOnInteract:h.cancelOnInteract,isComplete:function(){return f},triggerComplete:function(b){h.complete&&h.complete(b)},update:function(b){try{var k=h.tweenFn(b-m,a,c,h.duration);if(h.target)h.target[h.property]=k;for(var d=i.length;d--;)i[d](k,void 0);if(f=m+h.duration<=b){if(h.target)h.target[h.property]=
h.tweenFn(h.duration,a,c,h.duration);for(var j=i.length;j--;)i[j](k,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(b){i.push(b)}};a=h.target&&h.property&&h.target[h.property]?h.target[h.property]:h.startValue;if(typeof h.endValue!=="undefined")c=h.endValue-a;if(c==0)f=true;T5.wakeTweens();return e};
(function(){function h(a){if(f)return m.length;f=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(a);c++}}finally{f=false}m.length===0&&i.trigger("complete");return m.length}var m=[],i=null,f=false;T5.tweenValue=function(a,c,e,b,k){a=new T5.Tween({startValue:a,endValue:c,tweenFn:e,complete:b,duration:k});m.push(a);return a};T5.tween=function(a,c,e,b,k,d){a=new T5.Tween({target:a,property:c,endValue:e,tweenFn:b,duration:d,complete:k});
m.push(a);return a};T5.tweenVector=function(a,c,e,b,k,d){var j=[];if(a){var g=a.x==c,l=a.y==e;g||j.push(T5.tween(a,"x",c,b,function(){(g=true)&&l&&k()},d));l||j.push(T5.tween(a,"y",e,b,function(){l=true;g&&l&&k()},d))}return j};T5.cancelAnimation=function(a){if(!f){f=true;try{for(var c=0;c<m.length;)if(!a||a(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{f=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!i){i=COG.Loopage.join({execute:h,frequency:20});
i.bind("complete",function(){i=null})}}})();(function(){var h={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,i=arguments.length;i--;){var f=h[arguments[i].toUpperCase()];if(f)m|=f}return m}})();
T5.ViewLayer=function(h){h=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},h);var m=null,i=false,f=false,a=h.supportFastDraw,c=h.id,e=T5.viewState("ACTIVE"),b=h.validStates,k=0,d=0,j=T5.ex({addToView:function(g){g.setLayer(c,j)},shouldDraw:function(g,l,p){return(f||p||k!==l.x1||d!==l.y1)&&(g&b)!==0&&(i?a:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){j.trigger("remove",
j)},changed:function(g){f=true;j.trigger("changed",j);m&&m.trigger("invalidate",g)},getId:function(){return c},setId:function(g){c=g},getParent:function(){return m},setParent:function(g){i=(m=g)?m.fastDraw&&displayState!==e:false;j.trigger("parentChange",m)}},h);COG.observable(j);j.bind("drawComplete",function(g,l){f=false;k=l.x1;d=l.y1});j.bind("resync",function(g,l){if(l.syncXY){j.minXY&&l.syncXY(j.minXY);j.maxXY&&l.syncXY(j.maxXY)}});return j};
T5.View=function(h){function m(q,s,A,F){r=ia;n();if(F&&h.inertia){X=true;d(P+s,u+A,h.panAnimationEasing,h.panAnimationDuration)}else F||d(P+s,u+A)}function i(){r=Z;X=false;COG.Loopage.join({execute:n,after:50,single:true})}function f(q,s){T=y(q);aa=y(s);var A=D(T),F=D(aa);ea=R(T);M=R(aa);G=T&&A!==0?F/A:1}function a(q,s,A){f(s,A);if(fa=G!==1){r=$;n()}}function c(q,s,A,F){f(s,A);if(h.adjustScaleFactor){G=h.adjustScaleFactor(G);COG.Log.info("scale factor adjusted to: "+G)}if(F<h.pinchZoomAnimateTrigger){l(V,
G,ea,p(),T5.easing("sine.out"),function(){b();G=1},300);G=V}else{b();G=1}}function e(q,s,A){E.zoom(s,Math.min(Math.pow(2,Math.round(Math.log(A))),8),500)}function b(){var q=T?p():M;G=Math.round(G*10)/10;fa=false;for(var s=t.length;s--;)t[s].trigger("scale",G,q);E.trigger("scale",G,q);r=Z;n()}function k(){clearTimeout(ja);ja=setTimeout(j,50)}function d(q,s,A,F,H){function N(){S+=1;if(S>=2){i(0,0);H&&H()}}var S=0;if(I){q=q<I.x?I.x:q;s=s<I.y?I.y:s}if(L){q=q>L.x?L.x:q;s=s>L.y?L.y:s}if(A){q=T5.tweenValue(P,
q,A,N,F);s=T5.tweenValue(u,s,A,N,F);q.cancelOnInteract=true;q.requestUpdates(function(Q){P=Q;X=true;n()});s.cancelOnInteract=true;s.requestUpdates(function(Q){u=Q;X=true;n()})}else{P=q;u=s}}function j(){var q;if(z){COG.Touch.release(z);if(h.autoSize&&z.parentNode){q=z.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){z.height=q.height;z.width=q.width}}try{if(!z.id)z.id=h.id+"_canvas";J=z.getContext("2d")}catch(s){COG.Log.exception(s);throw Error("Could not initialise canvas on specified view element");
}sa=COG.Touch.capture(z,{observable:E});if(O.height!==z.height||O.width!==z.width){O=T5.D.init(z.width,z.height);E.trigger("resize",z.width,z.height);for(q=K;q--;)t[q].trigger("resize",z.width,z.height)}h.inertia&&sa.inertiaEnable(h.panAnimationDuration,O);for(q=K;q--;)t[q].trigger("contextChanged",J);n()}}function g(q,s){s.setId(q);s.added=T5.ticks();s.bind("remove",function(){E.removeLayer(q)});s.trigger("contextChanged",J);s.setParent(E);t.push(s);t.sort(function(A,F){var H=F.zindex-A.zindex;if(H===
0)H=F.added-A.added;return H});K=t.length;return s}function l(q,s,A,F,H,N,S){function Q(){N&&N();b();G=1;ga=null}fa=true;ea=T5.XY.offset(A,C.x1,C.y1);M=T5.XY.offset(F,C.x1,C.y1);T=null;if(H)T5.tweenValue(0,s-q,H,Q,S?S:1E3).requestUpdates(function(da){ga=da/(s-q);G=q+da;r=$;n();E.trigger("animate")});else{G=s;Q()}}function p(){var q=T5.D.getCenter(O),s=T5.XY.distance([M,q]);q=T5.XY.theta(M,q,s);var A=T5.XY.diff(ea,M);q=T5.XY.extendBy(M,q,s/G);q.x+=A.x;q.y+=A.y;return q}function w(){x("idle",E);oa=
true;ba=0}function v(q,s,A,F){var H=false,N=(q&$)!==0,S=T5.XYRect.copy(s),Q,da=0;A&&J.clearRect(0,0,z.width,z.height);if(N){T5.D.getCenter(O);var ta=(ga?ga:1)/2,va=T5.XY.diff(ea,M);if(T){U.x=M.x+va.x;U.y=M.y+va.y}else{U.x=M.x-va.x*ta;U.y=M.y-va.y*ta}}J.save();try{V=G;J.globalCompositeOperation="source-over";if(N){N=1/G;ta=(N-0.5)/0.5;S=T5.XYRect.fromCenter(M.x-(M.x-P)*ta,M.y-(M.y-u)*ta,~~(S.width*N),~~(S.height*N));J.scale(G,G)}J.translate(-S.x1,-S.y1);L=I=null;J.beginPath();for(da=K;da--;)if(t[da].clip){t[da].clip(J,
S,q,E,A,F);H=true}J.closePath();H&&J.clip();for(da=K;da--;){Q=t[da];var wa=Q.style,xa=wa?T5.Style.apply(J,wa):null;if(Q.minXY)I=I?T5.XY.min(I,Q.minXY):T5.XY.copy(Q.minXY);if(Q.maxXY)L=L?T5.XY.max(L,Q.maxXY):T5.XY.copy(Q.maxXY);Q.draw(J,S,q,E,A,F);xa&&T5.Style.apply(J,xa);Q.trigger("drawComplete",S,F)}}finally{J.restore()}if(ma){J.globalCompositeOperation="source-over";J.strokeStyle="#f00";J.beginPath();J.moveTo(z.width/2,0);J.lineTo(z.width/2,z.height);J.moveTo(0,z.height/2);J.lineTo(z.width,z.height/
2);J.stroke()}E.trigger("drawComplete",s,F);COG.Log.trace("draw complete",F)}function o(q,s){var A=false,F=ca?ca:X?ia:r,H=!X&&(F===$||F===ia),N=W||F===ia||F===$||T5.isTweening();B=T5.XY.init(P>>0,u>>0);C=T5.XYRect.fromCenter(B.x,B.y,O.width,O.height);if(H){T5.cancelAnimation(function(S){return S.cancelOnInteract});oa=false;if(ba!==0){clearTimeout(ba);ba=0}}for(H=K;H--;){if(t[H].animated)r|=ua;t[H].cycle(q,C,r,N);A=t[H].shouldDraw(r,C,N)||A}N=N||(r&ua)!==0;if(A=A||N||G!==1&&G!==la){v(F,C,N,q);la=G;
W=false}if(!A&&na===0&&!qa){if(!oa&&ba===0)ba=setTimeout(w,500);s.trigger("complete")}na=0;COG.Log.trace("Completed draw cycle",q)}function n(q){W=q?true:false;na+=1;if(!ha){ha=COG.Loopage.join({execute:o,frequency:ra});ha.bind("complete",function(){ha=null})}}function x(){E.trigger.apply(null,arguments);for(var q=t.length;q--;)t[q].trigger.apply(null,arguments)}h=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),
panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},h);var t=[],K=0,z=document.getElementById(h.container),J=null,P=0,u=0,B=null,C=null,ha=null,ma=h.guides,Y=1,O=T5.D.init(),na=0,M=null,oa=false,X=false,ba=0,pa=0,U=T5.XY.init(),I=null,L=null,ka=0,fa=false,T=null,aa=null,ca=null,W=false,ja=0,G=1,la=0,V=1,ga=null,ea=null,qa=typeof FlashCanvas!=="undefined",ra=~~(1E3/h.fps),sa=null,Z=T5.viewState("ACTIVE"),ia=T5.viewState("PAN"),
$=T5.viewState("ZOOM"),ua=T5.viewState("ANIMATING"),r=Z,y=T5.XY.getRect,D=T5.XYRect.diagonalSize,R=T5.XYRect.center,E={id:h.id,deviceScaling:Y,fastDraw:h.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,s,A,F,H){l(G,q,s,A,F,H)},centerOn:function(q){P=q.x-z.width/2;u=q.y-z.height/2},getDimensions:function(){return O},getZoomCenter:function(){return U},getLayer:function(q){for(var s=0;s<K;s++)if(t[s].getId()==q)return t[s];return null},setLayer:function(q,s){for(var A=0;A<K;A++)if(t[A].getId()===
q){t.splice(A,1);break}s&&g(q,s);n();return s},eachLayer:function(q){for(var s=K;s--;)q(t[s])},invalidate:n,resize:function(q,s){if(z){h.autoSize=false;z.width=q;z.height=s;j();E.trigger("resize",z.width,z.height)}},scale:function(q,s,A,F,H){F||(F=T5.D.getCenter(O));H||(H=T5.D.getCenter(O));E.animate(q,F,H,s,A);return E},triggerAll:x,removeLayer:function(q){a:{for(var s=K;s--;)if(t[s].getId()==q){q=s;break a}q=-1}if(q>=0&&q<K){COG.say("layer.removed",{layer:t[q]});t.splice(q,1);n()}K=t.length},stateOverride:function(q){ca=
q},getOffset:function(){return B?B:T5.XY.init(P,u)},getViewRect:function(){return C?C:T5.XYRect.fromCenter(P,u,O.width,O.height)},updateOffset:d,pan:function(q,s,A,F,H){d(P+q,u+s,A,F,H)},zoom:function(q,s,A){X=false;G=s;fa=G!==1;ea=T5.D.getCenter(O);M=T5.XY.offset(G>1?T5.XY.copy(q):T5.D.getCenter(O),C.x1,C.y1);T=null;clearTimeout(pa);if(fa){r=$;n();if(A)pa=setTimeout(function(){b();G=1},parseInt(A,10))}}};Y=T5.getConfig().getScaling();E.markers=g("markers",new T5.MarkerLayer);COG.observable(E);E.bind("invalidate",
function(q,s){n(s)});if(h.pannable){E.bind("pan",m);E.bind("panEnd",i);E.bind("inertiaCancel",function(){X=false;n()})}if(h.scalable){E.bind("pinchZoom",a);E.bind("pinchZoomEnd",c);E.bind("wheelZoom",e)}E.bind("tap",function(q,s,A){for(var F=T5.XY.offset(A,P,u),H=t.length;H--;)q.cancel=q.cancel||t[H].trigger("tap",s,A,F).cancel});E.bind("resync",function(){L=I=null});COG.configurable(E,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(h,null,{container:function(q,
s){z=document.getElementById(s);j()},rotation:function(q,s){ka=s}}),true);j();h.autoSize&&window.addEventListener("resize",k,false);return E};
T5.PathLayer=function(h){h=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},h);var m=false,i=[],f=null,a=[],c=null,e=0,b=[],k=T5.ex(new T5.ViewLayer(h),{getAnimation:function(d,j,g,l){var p="pathAnimation"+e++;b.push(p);return new T5.AnimatedPathLayer({id:p,path:i,zindex:h.zindex+1,easing:d?d:T5.easing("sine.inout"),duration:j?j:5E3,drawIndicator:g,autoCenter:l?l:false})},cycle:function(d,j,g,l){return l},draw:function(d){var j,g=i.length;d.save();try{T5.Style.apply(d,h.style);if(g>0){d.beginPath();
d.moveTo(i[g-1].x,i[g-1].y);for(j=g;j--;)d.lineTo(i[j].x,i[j].y);d.stroke();if(f){d.fillStyle=h.waypointFillStyle;for(j=f.length;j--;){d.beginPath();d.arc(f[j].x,f[j].y,2,0,Math.PI*2,false);d.stroke();d.fill()}}}}finally{d.restore()}m=false},updateCoordinates:function(d,j){a=d;c=j;var g=k.getParent();if(g&&g.syncXY){g.syncXY(a);c&&g.syncXY(c);k.trigger("tidy")}}});k.bind("tidy",function(){i=T5.XY.simplify(a,h.pixelGeneralization);f=T5.XY.simplify(c,h.pixelGeneralization);m=true;k.changed()});return k};
T5.ShapeLayer=function(h){function m(c){for(var e=f.length;e--;)f[e].resync(c);f.sort(function(b,k){var d=k.xy.y-b.xy.y;if(d===0)d=k.xy.x-b.xy.y;return d});a.changed()}function i(c,e){e.syncXY&&m(e)}h=T5.ex({zindex:80},h);var f=[],a=T5.ex(new T5.ViewLayer(h),{add:function(c){f[f.length]=c},each:function(c){for(var e=f.length;e--;)c(f[e])},draw:function(c,e,b){var k=e.x1,d=e.y1,j=e.width;e=e.height;for(var g=f.length;g--;){var l=f[g].style;l=l?T5.Style.apply(c,l):null;f[g].draw(c,k,d,j,e,b);l&&T5.Style.apply(c,
l)}}});a.bind("parentChange",i);a.bind("resync",i);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(h){h=T5.ex({style:null,properties:{}},h);return T5.ex(h,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(h,m){m=T5.ex({size:4},m);var i=T5.XY.init(),f=T5.ex(m,{draw:function(a){a.beginPath();a.arc(i.x,i.y,f.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([h]);i=T5.XY.floor([h])[0]}});COG.Log.info("created arc = ",h);return f};
T5.Poly=function(h,m){m=T5.ex({fill:false,simplify:false},m);var i=false,f=m.fill,a=m.simplify,c=T5.viewState("ZOOM"),e=[],b=T5.ex(new T5.Shape(m),{draw:function(k,d,j,g,l,p){if(i){d=true;j=(p&c)!==0;k.beginPath();for(p=e.length;p--;){j=e[p].x;g=e[p].y;if(d){k.moveTo(j,g);d=false}else k.lineTo(j,g);j=true}if(j){f&&k.fill();k.stroke()}}},resync:function(k){b.xy=k.syncXY(h);e=T5.XY.floor(a?T5.XY.simplify(h):h)}});i=h&&h.length>=2;return b};
T5.AnimatedPathLayer=function(h){function m(b,k,d){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(d.x,d.y,4,0,Math.PI*2,false);b.stroke();b.fill()}h=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},h);var i=T5.XY.edges(h.path),f,a=null,c=0;T5.tweenValue(0,i.total,h.easing,function(){e.remove()},h.duration).requestUpdates(function(b,k){c=b;k&&e.remove()});var e=
T5.ex(new T5.ViewLayer(h),{cycle:function(){for(var b=0;b<i.accrued.length&&i.accrued[b]<c;)b++;a=null;if(b<h.path.length-1){var k=c-(b>0?i.accrued[b-1]:0),d=h.path[b];f=T5.XY.theta(d,h.path[b+1],i.edges[b]);a=T5.XY.extendBy(d,f,k);if(h.autoCenter)(b=e.getParent())&&b.centerOn(a)}return a},draw:function(b,k){if(a)(h.drawIndicator?h.drawIndicator:m)(b,k,T5.XY.init(a.x,a.y),f)}});return e};
T5.Marker=function(h){function m(k,d,j,g){f=k;a=d;c=j;e=g}h=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},h);var i=false,f=0,a=0,c=0,e=0,b=T5.ex(h,{isNew:true,isAnimating:function(){return i},draw:function(k,d,j,g,l){if(b.isNew&&h.tweenIn){var p=b.xy.y;b.xy.y=d.y1-20;i=true;T5.tween(b.xy,"y",p,h.tweenIn,function(){b.xy.y=p;i=false},h.animationSpeed?h.animationSpeed:250+Math.random()*500)}b.drawMarker(k,d,b.xy.x,b.xy.y,j,g,l);b.isNew=false},drawMarker:function(k,d,j,g){k.beginPath();
k.arc(j,g,4,0,Math.PI*2,false);k.fill();m(j-4,g-4,8,8)},hitTest:function(k,d){return k>=f&&k<=f+c&&d>=a&&d<=a+e},updateBounds:m});COG.observable(b);return b};
T5.ImageMarker=function(h){h=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},h);var m=h.imageAnchor?T5.XY.invert(h.imageAnchor):null,i=T5.ex(new T5.Marker(h),{drawMarker:function(f,a,c,e){if((a=i.isAnimating()&&i.animatingImage?i.animatingImage:i.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var b=i.scale,k=c+~~(m.x*b),d=e+~~(m.y*b),j=~~(a.width*b),g=~~(a.height*b);i.updateBounds(k,d,j,j);if(i.rotation||
i.opacity!==1){f.save();try{f.globalAlpha=i.opacity;f.translate(c,e);f.rotate(i.rotation);f.drawImage(a,m.x*b,m.y*b,j,g)}finally{f.restore()}}else f.drawImage(a,k,d,j,g)}}});if(!i.image)i.image=T5.Images.get(h.imageUrl,function(f){COG.Log.info("updating marker image to: "+f.src);i.image=f});if(!i.animatingImage)i.animatingImage=T5.Images.get(h.animatingImageUrl,function(f){i.animatingImage=f});return i};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(h){function m(){a.changed();a.trigger("markerUpdate",f)}function i(){var c=a.getParent();if(c&&c.syncXY)for(var e=f.length;e--;)c.syncXY([f[e].xy])}h=T5.ex({zindex:100,style:"basic"},h);var f=[],a=T5.ex(new T5.ViewLayer(h),{draw:function(c,e,b,k){for(var d=f.length;d--;)f[d].draw(c,e,b,a,k)},add:function(c){if(c&&typeof c.length!=="undefined")for(var e=c.length;e--;){if(c[e])f[f.length]=c[e]}else if(c)f[f.length]=c;m()},clear:function(c){if(c)for(var e=0;e<f.length;e++)c(f[e])&&
f.splice(e,1);else f=[];m()},find:function(c){for(var e=[],b=f.length;b--;)if(!c||c(f[b]))e[e.length]=f[b];return e}});a.bind("tap",function(c,e,b){for(var k=[],d=b.x,j=b.y,g=f.length;g--;)if(f[g].hitTest(d,j))k[k.length]=f[g];if(k.length>0)c.cancel=a.trigger("markerTap",e,b,k).cancel});a.bind("parentChange",i);a.bind("resync",i);a.bind("changed",i);return a};
T5.ImageLayer=function(h,m){function i(g,l,p){if(e)for(var w=e.length;w--;){var v=e[w],o=v.x,n=v.y,x=T5.XYRect.init(v.x,v.y,v.x+v.width,v.y+v.height);if(p&&T5.XYRect.intersect(g,x)){x=T5.Images.get(v.url,(l&d)===0?a:null,k);p(x,o,n,v.width,v.height)}}}function f(g){c&&c.run(g,function(l){e=l;j.changed()})}function a(){j.changed()}m=T5.ex({imageLoadArgs:{}},m);var c=h?T5.Generator.init(h,m):null,e=null,b=T5.XYRect.init(),k=m.imageLoadArgs,d=T5.viewState("ZOOM"),j=T5.ex(new T5.ViewLayer(m),{changeGenerator:function(g,
l){c=T5.Generator.init(g,T5.ex({},m,l));c.bindToView(j.getParent());e=null;f(b)},clip:function(g,l,p){i(l,p,function(w,v,o,n,x){w&&g.rect(v,o,n,x)})},cycle:function(g,l){f(l)},draw:function(g,l,p){i(l,p,function(w,v,o,n,x){j.drawImage(g,w,v,o,n,x,l,p)});b=T5.XYRect.copy(l)},drawImage:function(g,l,p,w){l&&g.drawImage(l,p,w,l.width,l.height)}});j.bind("idle",function(){f(b)});j.bind("parentChange",function(g,l){c&&c.bindToView(l)});j.bind("tap",function(g,l,p,w){g=[];var v=w.x,o=w.y,n,x;if(e)for(var t=
e.length;t--;){n=e[t];if(x=v>=n.x&&v<=n.x+n.width&&o>=n.y&&o<=n.y+n.height)g[g.length]=n}g.length>0&&j.trigger("tapImage",g,l,p,w)});return j};
T5.Style=function(){function h(e,b){a[e]=i(b);return e}function m(e){for(var b in e)h(b,e[b])}function i(e){function b(g){var l=e[g];typeof l!=="undefined"&&d.push(function(p){p[g]=l})}function k(){d=[];for(var g in e)b(g)}e=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},e);var d=[],j={applyToContext:function(g){for(var l=d.length;l--;)d[l](g)},update:function(g,
l){e[g]=l;k()}};k();return j}var f={},a={},c={apply:function(e,b){var k=a[b]?a[b]:a.basic,d;if(e&&e.canvas){d=f[e.canvas.id];f[e.canvas.id]=b}k.applyToContext(e);return d},define:h,defineMany:m,get:function(e){return a[e]},init:i,load:function(e){COG.jsonp(e,function(b){T5.resetStyles(b)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return c}();
T5.Tiling=function(){return{tileSize:256,init:function(h,m,i,f,a){return T5.ex({x:h,y:m,width:i,height:f},a)}}}();
T5.TileGenerator=function(h){function m(p,w,v,o){function n(){if(l.initTileCreator){e=true;l.initTileCreator(p,w,v,o)}}l.prepTileCreator?l.prepTileCreator(p,w,v,n):n()}function i(p,w){for(var v=~~((p.x1-c.x)/b),o=~~((p.y1-c.y)/k),n=[],x=-j;x<j;x++)for(var t=-g;t<g;t++){var K=d(v+x,o+t);if(K)n[n.length]=K}w&&w(n);a=T5.XYRect.copy(p)}h=T5.ex({tileWidth:256,tileHeight:256},h);var f=null,a=null,c=T5.XY.init(),e=false,b=h.tileWidth,k=h.tileHeight,d=null,j=0,g=0,l={bindToView:function(p){COG.Log.info("initializing generator");
f=p;l.trigger("bindView",p)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){d=null;e=false;a=null},run:function(p,w){if(!a||Math.abs(p.x1-a.x1)>b||Math.abs(p.y1-a.y1)>k){if(!d&&!e||l.requireRefresh()){COG.Log.info("generating tiles, view rect = ",p);c=T5.XY.init(p.x1,p.y1);j=Math.ceil(p.width/b)+1;g=Math.ceil(p.height/k)+1;m(b,k,l.getTileCreatorArgs?l.getTileCreatorArgs(f):{},function(v){d=v;e=false;i(p,w)})}d&&i(p,w)}}};
COG.observable(l);l.bind("update",function(){COG.Log.info("captured generator update");a=null});return l};
