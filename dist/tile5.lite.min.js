COG=function(){var j=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,k=0,f={id:"grunt.core",extend:function(){var b=arguments[0]||{},c=1,e=arguments.length,d=false,h,a,g,i;if(typeof b==="boolean"){d=b;b=arguments[1]||{};c=2}if(typeof b!=="object"&&!f.isFunction(b))b={};if(e===c){b=this;--c}for(;c<e;c++)if((h=arguments[c])!=null)for(a in h){g=b[a];i=h[a];if(b!==i)if(d&&i&&(f.isPlainObject(i)||f.isArray(i))){g=g&&(f.isPlainObject(g)||f.isArray(g))?g:f.isArray(i)?[]:{};b[a]=f.extend(d,g,i)}else if(i!==
undefined)b[a]=i}return b},isFunction:function(b){return toString.call(b)==="[object Function]"},isArray:function(b){return toString.call(b)==="[object Array]"},isPlainObject:function(b){if(!b||toString.call(b)!=="[object Object]"||b.nodeType||b.setInterval)return false;if(b.constructor&&!m.call(b,"constructor")&&!m.call(b.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in b);return c===undefined||m.call(b,c)},isEmptyObject:function(b){for(var c in b)return false;return true},isXmlDocument:function(b){return toString.call(b)===
"[object Document]"},contains:function(b,c){var e=b,d=arguments,h=1;if(c&&f.isArray(c)){d=c;h=0}for(h=h;h<d;h++)e=e&&typeof foo[d[h]]!=="undefined";return e},newModule:function(b){b=f.extend({id:null,requires:[],parent:null},b);if(b.parent)b=f.extend({},b.parent,b);return b},toID:function(b){return b.replace(/\s/g,"-")},objId:function(b){return(b?b:"obj")+k++},formatStr:function(b){if(arguments.length<=1)return b;for(var c=arguments.length-2,e=0;e<=c;e++)b=b.replace(RegExp("\\{"+e+"\\}","gi"),arguments[e+
1]);return b},wordExists:function(b,c){var e="";if(c.toString)c=c.toString();for(var d=0;d<c.length;d++)e+=!/\w/.test(c[d])?"\\"+c[d]:c[d];return RegExp("(^|\\s|\\,)"+e+"(\\,|\\s|$)","i").test(b)},parseTemplate:function(b,c){for(var e=j.exec(b);e;){b=b.replace(e[0],COG.XPath.first(e[1],c));j.lastIndex=0;e=j.exec(b)}return b}};return f}();
COG.Log=function(){function j(c,e){var d,h=e&&e.length>0?e[0]:"";for(d=1;e&&d<e.length;d++)h+=" "+(k&&COG.isPlainObject(e[d])?JSON.stringify(e[d]):e[d]);typeof console!=="undefined"&&console[c](h);for(d=0;d<m.length;d++)m[d].call(b,h,c)}var m=[],k=typeof JSON!=="undefined",f=window.console&&window.console.markTimeline,b={id:"grunt.log",getTraceTicks:function(){return f?(new Date).getTime():null},trace:function(c,e){if(f)console.markTimeline(c+(e?": "+(b.getTraceTicks()-e)+"ms":""))},debug:function(){j("debug",
arguments)},info:function(){j("info",arguments)},warn:function(){j("warn",arguments)},error:function(){j("error",arguments)},exception:function(c){b.error(arguments);for(var e in c)b.info("ERROR DETAIL: "+e+": "+c[e])},watch:function(c,e){try{e()}catch(d){b.exception(d,c)}},throwError:function(c){b.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return b}();
(function(){function j(f,b){f[b]||(f[b]=function(c){return f.configure(b,c)})}function m(f){f.gtConfId=COG.objId("configurable");f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var k={};COG.paramTweaker=function(f,b,c){return function(e,d){if(typeof d!=="undefined"){if(e in f)f[e]=d;c&&e in c&&c[e](e,d)}else return b&&e in b?b[e](e):f[e]}};COG.configurable=function(f,b,c,e){if(f){f.gtConfId||m(f);var d=f.gtConfId,h=f.gtConfig,a=f.gtConfigFns;k[d]=f;a.push(c);for(c=b.length;c--;){h[b[c]]=true;e&&
j(f,b[c])}if(!f.configure)f.configure=function(g,i){if(h[g]){for(var l=a.length;l--;){var r=a[l](g,i);if(typeof r!=="undefined")return r}return k[d]}return null}}}})();
(function(){function j(m,k){var f=m.gtObsHandlers;f[k]||(f[k]=[]);return f[k]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(k,f){var b=COG.objId("callback");j(m,k).unshift({fn:f,id:b});return b};m.trigger=function(k){var f=j(m,k),b={cancel:false,tickCount:(new Date).getTime()},c;if(!f)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(b);for(var e=f.length;e--&&!b.cancel;)f[e].fn.apply(self,c);return b};m.unbind=
function(k,f){for(var b=j(m,k),c=0;b&&c<b.length;c++)if(b[c].id===f){b.splice(c,1);break}return m}}}}})();(function(){var j={},m=[];COG.addPipe=function(k){k("pipe.test",{});m.push(k)};COG.listen=function(k,f){j[k]||(j[k]=[]);f&&j[k].push(f)};COG.say=function(k,f){var b;for(b=m.length;b--;)m[b](k,f);if(j[k])for(b=j[k].length;b--;)j[k][b](f)}})();
COG.Loopage=function(){function j(i){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},i)}function m(i){d.push(i);k()}function k(){h&&clearTimeout(h);h=setTimeout(f,0);g=true}function f(){for(var i,l=(new Date).getTime(),r=e.length;d.length>0;){var u=d.shift();for(i=r;i--;)if(e[i].id===u){e.splice(i,1);break}g=true;r=e.length}if(g){a=b;for(i=r;i--;)a=e[i].frequency<a?e[i].frequency:a}for(i=r;i--;){u=l-e[i].lastTick;if(e[i].lastTick===0||u>=e[i].frequency){e[i].execute(l,
e[i]);e[i].lastTick=l;e[i].single&&e[i].trigger("complete")}}h=r?setTimeout(f,a):0}var b=6E4,c=0,e=[],d=[],h=0,a=b,g=true;return{join:function(i){var l=new j(i);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});e.unshift(l);k();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function j(a){return a<10?"0"+a:a}function m(a){b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(g){var i=d[g];return typeof i==="string"?i:"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function k(a,g){var i,l,r,u,v=c,o,q=g[a];if(q&&typeof q==="object"&&typeof q.toJSON==="function")q=q.toJSON(a);if(typeof h==="function")q=h.call(g,a,q);switch(typeof q){case "string":return m(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);
case "object":if(!q)return"null";c+=e;o=[];if(Object.prototype.toString.apply(q)==="[object Array]"){u=q.length;for(i=0;i<u;i+=1)o[i]=k(i,q)||"null";r=o.length===0?"[]":c?"[\n"+c+o.join(",\n"+c)+"\n"+v+"]":"["+o.join(",")+"]";c=v;return r}if(h&&typeof h==="object"){u=h.length;for(i=0;i<u;i+=1){l=h[i];if(typeof l==="string")if(r=k(l,q))o.push(m(l)+(c?": ":":")+r)}}else for(l in q)if(Object.hasOwnProperty.call(q,l))if(r=k(l,q))o.push(m(l)+(c?": ":":")+r);r=o.length===0?"{}":c?"{\n"+c+o.join(",\n"+c)+
"\n"+v+"}":"{"+o.join(",")+"}";c=v;return r}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+j(this.getUTCMonth()+1)+"-"+j(this.getUTCDate())+"T"+j(this.getUTCHours())+":"+j(this.getUTCMinutes())+":"+j(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,e,d={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,g,i){var l;e=c="";if(typeof i==="number")for(l=0;l<i;l+=1)e+=" ";else if(typeof i==="string")e=i;if((h=g)&&typeof g!=="function"&&(typeof g!=="object"||typeof g.length!=="number"))throw Error("JSON.stringify");return k("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,g){function i(r,u){var v,o,q=r[u];if(q&&typeof q==="object")for(v in q)if(Object.hasOwnProperty.call(q,v)){o=i(q,v);if(o!==undefined)q[v]=o;else delete q[v]}return g.call(r,u,q)}var l;a=String(a);f.lastIndex=0;if(f.test(a))a=a.replace(f,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+a+")");return typeof g==="function"?i({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function j(k,f){var b=k.split("|"),c={};for(var e in f){var d=f[e];c[e]=b.length>d?b[d]:null}return c}var m={JSON:{parse:function(k){return JSON.parse(k)}},PDON:{parse:function(k){var f=null,b=[];k=k.split("\n");for(var c=0;c<k.length;c++){var e=k[c];if(f)b.push(j(e,f));else if(e){f=e.split("|");e={};for(var d=0;d<f.length;d++)e[f[d]]=d;f=e}else f=null}return b}}};COG.parseData=function(k,f){f=f?f.toUpperCase():"JSON";if(!m[f])throw Error("Unsupported data format: "+f);try{return m[f].parse(k)}catch(b){COG.Log.exception(b)}return{}}})();
COG.XPath=function(){function j(b){for(var c=null,e=0;e<m.length;e++)if(c=m[e](b))break;return c}var m=[],k=[null,function(b){return b.numberValue},function(b){return b.stringValue},function(b){return b.booleanValue},null,null,null,null,function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null},function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var f={SearchResult:function(b){return{toString:function(){var c=
null;if(b){var e=null;if(b.resultType>=0&&b.resultType<k.length)e=k[b.resultType];if(e)c=e(b)}return c?c:""}}},first:function(b,c){var e=f.SearchResult,d;var h=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!h)h=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))d=c.evaluate(b,c,j,h,null);else{COG.Log.warn("attempted xpath expression: "+b+" on a non-xml document");d=null}}catch(a){COG.Log.warn("invalid xpath expression: "+b+" on node: "+c);d=null}return new e(d)},registerResolver:function(b){m.push(b)}};return f}();
COG.Storage=function(){function j(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,k){var f=j(k).getItem(m);return/^(\{|\[).*(\}|\])$/.test(f)?JSON.parse(f):f},set:function(m,k,f){k=jQuery.isArray(k)||jQuery.isPlainObject(k)?JSON.stringify(k):k;j(f).setItem(m,k)},remove:function(m,k){j(k).removeItem(m)}}}();
COG.ParseRules=function(){var j=[];return{add:function(m,k){j.push({regex:m,handler:k})},each:function(m,k,f){function b(){c++;f&&c>=j.length&&f(k)}for(var c=0,e=0;e<j.length;e++){var d=j[e].regex,h=j[e].handler,a=false;if(d){d.lastIndex=-1;if((d=d.exec(m))&&h){a=true;h(d,k,b)&&b()}}a||b()}}}};
(function(){function j(d){var h=[],a=function(i,l){l=COG.isFunction(l)?l():l;h[h.length]=encodeURIComponent(i)+"="+encodeURIComponent(l)};if(COG.isArray(d))for(var g=0;g<d.length;g++)a(d[g].name,d[g].value);else for(g in d)a(g,d[g]);return h.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},k={JSON:["json"],PDON:["pdon.txt"]},f=["TEXT","STREAM"],b=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(d){return d.responseXML},JSON:function(d){return COG.parseData(d.responseText)},
PDON:function(d){return COG.parseData(d.responseText,"PDON")},DEFAULT:function(d){return d.responseText}},e={CONTENT_TYPE:"Content-Type"};COG.xhr=function(d){function h(){if(this.readyState===4){var l=null,r=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(r)if(d.handleResponse)d.handleResponse(this);else{var u=d,v=this.getResponseHeader(e.CONTENT_TYPE),o,q=false;for(o in m)if(v&&v.indexOf(m[o])>=0){q=true;
break}v=!q;for(q=0;q<f.length;q++)v=v||f[q]==o;if(v)b:{v=o;for(var t in k)for(q=0;q<k[t].length;q++)if(RegExp(k[t][q]+"$","i").test(u.url)){o=t;break b}o=v?v:"DEFAULT"}try{l=c[o](this,u)}catch(x){l=c.DEFAULT(this,u)}}else d.error&&d.error(this)}catch(z){COG.Log.exception(z,"PROCESSING AJAX RESPONSE")}r&&l&&d.success&&d.success.call(this,l)}}try{d=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},d);var a=
b.exec(d.url),g=a&&(a[1]&&a[1]!==location.protocol||a[2]!==location.host);if(d.data)d.method="POST";if(d.url){a=null;if(d.xhr)a=d.xhr(d);a||(a=new XMLHttpRequest);a.open(d.method,d.url,d.async);d.data&&a.setRequestHeader("Content-Type",d.contentType);g||a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.onreadystatechange=h;a.send(d.method=="POST"?j(d.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(i){COG.Log.exception(i)}}})();
(function(){function j(b){var c=document.createElement("script"),e=false;c.src=b;c.async=true;c.onload=c.onreadystatechange=function(){if(!e&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){e=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};k||(k=document.getElementsByTagName("head")[0]);k.appendChild(c)}var m=0,k,f=this;COG.jsonp=function(b,c,e){b+=b.indexOf("?")>=0?"&":"?";var d="json"+ ++m;f[d]=function(h){c(h);f[d]=null;try{delete f[d]}catch(a){}};
j(b+(e?e:"callback")+"="+d);return d}})();
COG.Touch=function(){function j(w,A){return{x:w.x-A.x,y:w.y-A.y}}function m(w,A){var C=j(w,A);return Math.sqrt(C.x*C.x+C.y*C.y)}function k(w){if(w.count>1)return m(w.touches[0],w.touches[1]);return 0}function f(w,A){var C=w&&w.count>0?w.touches[0]:null;if(C&&A&&A.count>0)return j(C,A.touches[0]);return null}function b(w,A){w.count=A.count;for(var C=a;C--;){w.touches[C].x=A.touches[C].x;w.touches[C].y=A.touches[C].y}}function c(){for(var w={count:0,touches:Array(a)},A=a;A--;)w.touches[A]=h();return w}
function e(w){if(w.preventDefault){w.preventDefault();w.stopPropagation()}else w.cancelBubble&&w.cancelBubble()}function d(w,A,C){if(F){A=A[C?C:"touches"];C=A.length;for(C=w.count=C;C--;){w.touches[C].x=A[C].pageX;w.touches[C].y=A[C].pageY}}else if(A.button===0){w.count=1;w.touches[0].x=A.pageX?A.pageX:A.screenX;w.touches[0].y=A.pageY?A.pageY:A.screenY}else w.count=0}function h(w,A){return{x:w?w:0,y:A?A:0}}var a=10,g=120,i=g*8,l=100,r=250,u=300,v=5,o=0,q=1,t=2,x=7,z=0,G=0,F=undefined,M=function(w){function A(s,
n,p,y){var B=Math.asin((s.y-n.y)/p);p=p*(fa/y)>>0;p=p>Y?Y:p;B=n.x>s.x?B:Math.PI-B;O("pan",Math.cos(B)*-p,Math.sin(B)*p,true)}function C(s,n){var p,y;if(F){p=n-ga;if(p<r){y=m(H.touches[0],s);y>w.inertiaTrigger&&A(H.touches[0],s,y,p)}}else{P.x=s.x;P.y=s.y;COG.Loopage.join({execute:function(B,D){p=B-n;y=m(s,P);if(p<l&&y>w.inertiaTrigger){D.trigger("complete");A(s,P,y,p)}else p>l&&D.trigger("complete")},frequency:10})}}function na(s){var n=0,p=0;if(s.offsetParent){do{n+=s.offsetLeft;p+=s.offsetTop;s=
s.offsetParent}while(s)}return h(n,p)}function K(s){var n=s.count,p=Array(n),y=na(J);for(n=n;n--;)p[n]=h(s.touches[n].x-y.x,s.touches[n].y-y.y);return p}function O(){oa&&oa.trigger.apply(null,arguments)}function ha(s,n){var p=na(J);p=h(n.x-p.x,n.y-p.y);O(s,n,p)}function ia(s){var n=s.target?s.target:s.srcElement;if(ba||n&&n===J){d(H,s);if(H.count!==0){V=null;T.x=0;T.y=0;ja=true;R=false;ga=(new Date).getTime();e(s);n.style.cursor="move";O("inertiaCancel");ca=ga;if(s=H.count>0?H.touches[0]:null){O("touchStart",
s.x,s.y);if(ca-pa<u)if((s=j(H.touches[0],W.touches[0]))&&Math.abs(s.x)<w.maxDistDoubleTap&&Math.abs(s.y)<w.maxDistDoubleTap)R=true;S=o;b(W,H)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function ka(s){var n=s.target?s.target:s.srcElement,p=0;if(ba||n&&n===J){d(Q,s);if(Q.count>0){P.x=Q.touches[0].x;P.y=Q.touches[0].y}if(ja){F&&e(s);if(Q.count>1){H.count===1&&b(H,Q);p=k(H)-k(Q)}if(S===o)if((s=f(Q,H))&&(Math.abs(s.x)>=x||Math.abs(s.y)>=x))S=q;if(S!==o)if(!p||Math.abs(p)<v){if(V=
f(Q,W)){T.x-=V.x;T.y-=V.y;E.x-=V.x;E.y-=V.y}O("pan",E.x,E.y);E.x=0;E.y=0;S=q}else{O("pinchZoom",K(H),K(Q));S=t}b(W,Q)}}}function la(s){var n=s.target?s.target:s.srcElement;if(ja&&(ba||n&&n===J)){d(ma,s,"changedTouches");var p=ma.touches[0];F&&e(s);s=(new Date).getTime();pa=ca;if(S===o){ha("tap",H.touches[0]);U||(U=setTimeout(function(){U=0;R&&ha("doubleTap",H.touches[0])},u+50))}else if(S==q){O("panEnd",T.x,T.y);da&&C(p,s)}else S==t&&O("pinchZoomEnd",K(H),K(W),s-ga);n.style.cursor="default";ja=false}}
function Z(s){var n=s.target?s.target:s.srcElement;if(ba||n&&n===J){if(s.detail){n=-s.detail*g;n=h(s.axis===1?n:0,s.axis===2?n:0)}else n=h(s.wheelDeltaX,s.wheelDeltaY);n=n.y/i;if(P&&n!==0){var p=h(P.x-J.offsetLeft,P.y-J.offsetTop);O("wheelZoom",p,n)}e(s)}}w=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},
w);var R=false,U=0,L=T5.getConfig(),H=c(),Q=c(),W=c(),ma=c(),V=null,T=h(),E=h(),S=null,ja=false,ga=0,ea=[],P=h(),da=false,fa,Y,ca=0,pa=0,J=w.element,oa=w.observable,ba=typeof FlashCanvas!=="undefined",qa={supportsTouch:F,addListeners:function(s){ea.push(s)},decoupleListeners:function(s){for(var n=0;s&&n<ea.length;n++)if(ea[n].listenerId===s){ea.splice(n,1);break}},release:function(){L.unbindEvent(F?"touchstart":"mousedown",ia,false);L.unbindEvent(F?"touchmove":"mousemove",ka,false);L.unbindEvent(F?
"touchend":"mouseup",la,false);if(!F){window.removeEventListener("mousewheel",Z,false);window.removeEventListener("DOMMouseScroll",Z,false)}},inertiaEnable:function(s,n){da=true;fa=s;Y=n?Math.min(n.width,n.height):500},inertiaDisable:function(){da=false}};if(typeof F==="undefined")F=T5.getConfig().supportsTouch;L.bindEvent(F?"touchstart":"mousedown",ia,false);L.bindEvent(F?"touchmove":"mousemove",ka,false);L.bindEvent(F?"touchend":"mouseup",la,false);if(!F){L.bindEvent("mousewheel",Z,window);L.bindEvent("DOMMouseScroll",
Z,window)}return qa},X=[];return{capture:function(w,A){if(!w)throw Error("Unable to capture touch of null element");if(!w.id)w.id="touchable_"+z++;var C=X[w.id];if(!C){C=new M(COG.extend({element:w},A));X[w.id]=C}if(A){A.listenerId&&C.decoupleListeners(A.listenerId);A.listenerId=++G;C.addListeners(A)}return C},release:function(w){if(w&&w.id&&X[w.id]){X[w.id].release();delete X[w.id]}}}}();
T5=function(){var j=function(){function c(h,a){return d(h.x-a.x,h.y-a.y)}function e(h,a){if(!a)a=h.length;if(a<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var g={edges:Array(a-1),accrued:Array(a-1),total:0},i=0;i<a-1;i++){var l=c(h[i],h[i+1]);g.edges[i]=Math.sqrt(l.x*l.x+l.y*l.y);g.accrued[i]=g.total+g.edges[i];g.total+=g.edges[i]}return g}function d(h,a){return{x:h?h:0,y:a?a:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var h=
0,a=0,g=arguments.length;g--;){h+=arguments[g].x;a+=arguments[g].y}return d(h,a)},absSize:function(h){return Math.max(Math.abs(h.x),Math.abs(h.y))},copy:function(h){return h?d(h.x,h.y):null},diff:c,distance:function(h,a){return e(h,a).total},edges:e,equals:function(h,a){return h.x===a.x&&h.y===a.y},extendBy:function(h,a,g){return d(h.x-Math.cos(a)*g,h.y-Math.sin(a)*g)},floor:function(h){for(var a=Array(h.length),g=h.length;g--;)a[g]=d(~~h[g].x,~~h[g].y);return a},getRect:function(h){for(var a,g,i,
l,r=h.length;r--;){var u=h[r];a=typeof a==="undefined"||u.x<a?u.x:a;g=typeof g==="undefined"||u.y<g?u.y:g;i=typeof i==="undefined"||u.x>i?u.x:i;l=typeof l==="undefined"||u.y>l?u.y:l}return k.init(a,g,i,l)},init:d,invert:function(h){return d(-h.x,-h.y)},min:function(h,a){return d(h.x<a.x?h.x:a.x,h.y<a.y?h.y:a.y)},max:function(h,a){return d(h.x>a.x?h.x:a.x,h.y>a.y?h.y:a.y)},offset:function(h,a,g){return d(h.x+a,h.y+(g?g:a))},simplify:function(h,a){if(!h)return null;a=a?a:j.VECTOR_SIMPLIFICATION;for(var g=
[],i=null,l=h.length;l--;){var r=h[l];if(include=!i||l===0||Math.abs(r.x-i.x)+Math.abs(r.y-i.y)>a){g.unshift(r);i=r}}return g},theta:function(h,a,g){g=Math.asin((h.y-a.y)/g);return h.x>a.x?g:Math.PI-g}}}(),m=function(){return{dotProduct:function(c,e){return c.x*e.x+c.y*e.y}}}(),k=function(){function c(d){return e(d.x1,d.y1,d.x2,d.y2)}function e(d,h,a,g){d=d?d:0;h=h?h:0;a=typeof a!=="undefined"?a:d;g=typeof g!=="undefined "?g:g;return{x1:d,y1:h,x2:a,y2:g,width:a-d,height:g-h}}return{center:function(d){return j.init(d.x1+
d.width/2,d.y1+d.height/2)},copy:c,diagonalSize:function(d){return Math.sqrt(d.width*d.width+d.height*d.height)},fromCenter:function(d,h,a,g){a=~~(a/2);g=~~(g/2);return e(d-a,h-g,d+a,h+g)},init:e,intersect:function(d,h){var a=e(Math.max(d.x1,h.x1),Math.max(d.y1,h.y1),Math.min(d.x2,h.x2),Math.min(d.y2,h.y2));return a.width>0&&a.height>0?a:null},union:function(d,h){if(d.width===0||d.height===0)return c(h);else if(h.width===0||h.height===0)return c(d);else{var a=e(Math.min(d.x1,h.x1),Math.min(d.y1,h.y1),
Math.max(d.x2,h.x2),Math.max(d.y2,h.y2));return a.width>0&&a.height>0?a:null}}}}(),f=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return j.init(c.width/2,c.height/2)},getSize:function(c){return Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2))},init:function(c,e){c=c?c:0;return{width:c,height:e?e:c}}}}(),b={ex:COG.extend,ticks:function(){return(new Date).getTime()},userMessage:function(c,e,d){b.trigger("userMessage",c,e,d)},XY:j,XYRect:k,
Vector:function(c,e){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return j.init(c,e)},V:COG.extend(j,m),D:f};COG.observable(b);return b}();
(function(){function j(){for(;u.length>0;){var o=u.shift();document.location=o}r=0}function m(o){for(var q=true,t=v.length;t--;)q=q&&o!=v[t];return q}function k(o,q){var t=[];for(var x in q)x&&t.push(x+"="+escape(q[x]));return"tile5://"+o+"/"+(t.length>0?"?"+t.join("&"):"")}function f(o,q){m(o)&&COG.Log.info("would push url: "+k(o,q))}function b(o,q){if(m(o)){u.push(k(o,q));r||(r=setTimeout(j,100))}}function c(o){return function(q,t,x){(x?x:o?document.body:document).addEventListener(q,t,false)}}function e(o){return function(q,
t,x){(x?x:o?document.body:document).removeEventListener(q,t,false)}}function d(o,q,t){(t?t:document).attachEvent("on"+o,q)}function h(o,q,t){(t?t:document).detachEvent("on"+o,q)}function a(){g={base:{name:"Unknown",bindEvent:c(),unbindEvent:e(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:f,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:d,unbindEvent:h,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:b,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:b},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:b},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:e(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:b},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:b}};i=[g.froyo,g.android,g.ipod,g.iphone,g.ipad,g.ie]}var g=null,i=[],l=null,r=0,u=[],v=["view.wake","tile.loaded"];T5.getConfig=function(){g||a();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var o=0;o<i.length;o++){var q=i[o];if(q.regex&&q.regex.test(navigator.userAgent)){l=T5.ex({},g.base,q);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=g.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var j=[],m={execute:function(k){var f=m.findAction(k);f&&f.execute.apply(f,Array.prototype.slice.call(arguments,1))},findAction:function(k){for(var f=j.length;f--;)if(j[f].id==k)return j[f];return null},getRegisteredActions:function(){return[].concat(j)},getRegisteredActionIds:function(){for(var k=[],f=j.length;f--;)j[f].id&&k.push(j[f].id);return k},registerAction:function(k){k&&k.id&&j.push(k)},Action:function(k){k=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},k);var f={id:k.id,execute:function(){k.execute&&k.execute.apply(this,arguments)},getParam:function(b){return k[b]?k[b]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",f.id,k.title,k.icon)}};k.autoRegister&&m.registerAction(f);return f},Agent:function(k){k=COG.extend({name:"Untitled",translator:null,execute:null},k);var f={getName:function(){return k.name},getParam:function(b){return k[b]},getId:function(){return COG.toID(f.getName())},run:function(b,c){if(k.execute){var e=
k.translator?k.translator(b):b;k.execute.call(f,e,function(d,h){c&&c(d,h,e)})}}};return f},runAgents:function(k,f,b){for(var c=0;c<k.length;c++)k[c].run(f,b)}};return m}();
T5.Resources=function(){var j="",m={},k={getPath:function(f){return/^(file|https?|\/)/.test(f)?f:j+f},setBasePath:function(f){j=f},loadResource:function(f){f=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},f);var b=function(c){f.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){f.callback(c)})};f.cacheable&&m[f.filename]?b(m[f.filename]):COG.xhr({url:k.getPath(f.filename),dataType:f.dataType,success:function(c){if(f.cacheable)m[f.filename]=c;b(c)},error:function(c,e,d){COG.Log.error("error loading resource ["+
f.filename+"], error = "+d)}})},loadSnippet:function(f,b){/\.\w+$/.test(f)||(f+=".html");k.loadResource({filename:"snippets/"+f,callback:b,dataType:"html"})}};return k}();
T5.Images=function(){function j(){if(!r){var o=T5.getConfig().maxImageLoads;r=COG.Loopage.join({execute:function(q,t){if(!o||g.length<o){var x=a.shift();if(x){g[g.length]=x;x.image.onload=k;x.image.src=T5.Resources.getPath(x.url);x.requested=T5.ticks()}else t.trigger("complete")}},frequency:10});r.bind("complete",function(){r=null})}}function m(){u=true;try{var o=i.length/2>>0;if(o>0){i.sort(function(t,x){return t.created-x.created});for(var q=o;q--;)delete c[i[q].url];i.splice(0,o)}}finally{u=false}COG.say("imagecache.cleared")}
function k(){var o=d[this.id],q;if(o&&o.image.complete&&o.image.width>0){o.loaded=true;o.hitCount=1;for(q=g.length;q--;)if(g[q].image.src==this.src){g.splice(q,1);break}if(o.background||o.postProcess||o.drawBackground||o.customDraw)if(o.image){globalImageData=o;q=b(o.realSize?o.realSize.width:o.image.width,o.realSize?o.realSize.height:o.image.height);var t=q.getContext("2d"),x=o.offset?o.offset:T5.XY.init();o.background&&t.drawImage(o.background,0,0);o.drawBackground&&o.drawBackground(t);o.customDraw?
o.customDraw(t,o):t.drawImage(o.image,x.x,x.y);o.postProcess&&o.postProcess(t,o);o.image=q}for(q=o.callbacks.length;q--;)o.callbacks[q]&&o.callbacks[q](this,false);o.callbacks=[];i[i.length]={url:this.src,created:o.requested};delete d[this.id];j()}}function f(o,q,t){var x=c[o];if(x){x.hitCount++;x.image.complete&&x.image.width>0&&q?q(x.image,true):x.callbacks.push(q)}else{x=T5.ex({url:o,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[q]},t);x.image.id="resourceLoaderImage"+
h++;c[o]=x;d[x.image.id]=x;a[a.length]=x;j()}return x}function b(o,q){var t=document.createElement("canvas");t.width=o?o:0;t.height=q?q:0;if(typeof FlashCanvas!=="undefined"){t.id="tmpCanvas"+e++;t.style.cssText="position: absolute; top: -"+(q-1)+"px; left: -"+(o-1)+"px;";document.body.appendChild(t);FlashCanvas.initElement(t)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(t);return t}var c={},e=0,d={},h=0,a=[],g=[],i=[],l=0,r=null,u=false,v={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){g=[]},get:function(o,q,t){var x=null,z=null;u||(x=c[o]);if((z=x?x.image:null)&&(z.getContext||z.complete&&z.width>0))return z;else q&&f(o,q,t);return null},load:f,newCanvas:b,reset:function(){c={}},stats:function(){return{imageLoadingCount:g.length,queuedImageCount:a.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(o){for(var q=false,t=0,x=T5.getConfig();t<g.length;)if(o-g[t].requested>v.loadTimeout*1E3){g.splice(t,1);q=true}else t++;q&&j();if(x&&x.imageCacheMaxSize){l=
i.length*v.avgImageSize/x.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return v}();T5.Generator=function(){var j={};return{init:function(m,k){var f=j[m];if(!f)throw Error("Unable to locate requested generator: "+m);return new f(k)},register:function(m,k){j[m]=k},Template:function(){}}}();
T5.TimeLord=function(){var j=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,k=function(b,c){return{days:b?b:0,seconds:c?c:0}},f={8601:function(b){b=b.split("T");var c=null;c=null;var e=0,d=0;j.lastIndex=-1;c=j.exec(b[0]);e+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(b[1]);d+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;d+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;d+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new k(e,d)}};return{Duration:k,addDuration:function(){for(var b=new k,
c=arguments.length;c--;){b.days+=arguments[c].days;b.seconds+=arguments[c].seconds}if(b.seconds>=86400){b.days+=~~(b.seconds/86400);b.seconds%=86400}return b},parseDuration:function(b,c){var e=c?f[c]:null;if(e)return e(b);COG.Log.warn("Could not find duration parser for specified format: "+c);return new k},formatDuration:function(b){var c,e,d="";if(b.days)d=b.days+" days ";if(b.seconds){b=b.seconds;if(b>=3600){c=~~(b/3600);b-=c*3600}if(b>=60){e=Math.round(b/60);b-=e*60}if(c)d=d+c+(c>1?" hrs ":" hr ")+
(e?(e>10?e:"0"+e)+" min ":"");else if(e)d=d+e+" min";else if(b>0)d=d+(b>10?b:"0"+b)+" sec"}return d}}}();
T5.zoomable=function(j,m){function k(b,c){if(b&&f!==b){var e=j.triggerAll("zoomLevelChange",b,c);if(e)f=b;return e}}m=T5.ex({initial:1,min:0,max:null,zoomAnimation:T5.easing("quad.out")},m);var f=m.initial;T5.ex(j,{getZoomLevel:function(){return f},setZoomLevel:k,zoomIn:function(){j.scale(2,T5.easing("sine.out"))||j.setZoomLevel(f+1)},zoomOut:function(){j.scale(0.5,T5.easing("sine.out"))||j.setZoomLevel(f-1)}});j.bind("scale",function(b,c,e){var d=Math.log(c)/Math.LN2;T5.cancelAnimation(function(h){return h.cancelOnInteract});
b.cancel=!k(f+d,e);b.cancel||j.updateOffset(e.x*c,e.y*c)});j.bind("doubleTap",function(b,c,e){if(j.scalable()){T5.cancelAnimation(function(d){return d.cancelOnInteract});j.scale(2,T5.XY.init(e.x,e.y))}})};
(function(){var j=Math.PI*2,m=Math.PI/2,k=Math.abs,f=Math.pow,b=Math.sin,c=Math.asin,e=Math.cos,d=1.70158,h={linear:function(a,g,i,l){return i*a/l+g},backin:function(a,g,i,l){return i*(a/=l)*a*((d+1)*a-d)+g},backout:function(a,g,i,l){return i*((a=a/l-1)*a*((d+1)*a+d)+1)+g},backinout:function(a,g,i,l){return(a/=l/2)<1?i/2*a*a*(((d*=1.525)+1)*a-d)+g:i/2*((a-=2)*a*(((d*=1.525)+1)*a+d)+2)+g},bouncein:function(a,g,i,l){return i-h.bounceout(l-a,0,i,l)+g},bounceout:function(a,g,i,l){return(a/=l)<1/2.75?
i*7.5625*a*a+g:a<2/2.75?i*(7.5625*(a-=1.5/2.75)*a+0.75)+g:a<2.5/2.75?i*(7.5625*(a-=2.25/2.75)*a+0.9375)+g:i*(7.5625*(a-=2.625/2.75)*a+0.984375)+g},bounceinout:function(a,g,i,l){return a<l/2?h.bouncein(a*2,0,i,l)/2+g:h.bounceout(a*2-l,0,i,l)/2+i/2+g},cubicin:function(a,g,i,l){return i*(a/=l)*a*a+g},cubicout:function(a,g,i,l){return i*((a=a/l-1)*a*a+1)+g},cubicinout:function(a,g,i,l){if((a/=l/2)<1)return i/2*a*a*a+g;return i/2*((a-=2)*a*a+2)+g},elasticin:function(a,g,i,l,r,u){if(a==0)return g;if((a/=
l)==1)return g+i;u||(u=l*0.3);if(!r||r<k(i)){r=i;i=u/4}else i=u/j*c(i/r);return-(r*f(2,10*(a-=1))*b((a*l-i)*j/u))+g},elasticout:function(a,g,i,l,r,u){var v;if(a==0)return g;if((a/=l)==1)return g+i;u||(u=l*0.3);if(!r||r<k(i)){r=i;v=u/4}else v=u/j*c(i/r);return r*f(2,-10*a)*b((a*l-v)*j/u)+i+g},elasticinout:function(a,g,i,l,r,u){var v;if(a==0)return g;if((a/=l/2)==2)return g+i;u||(u=l*0.3*1.5);if(!r||r<k(i)){r=i;v=u/4}else v=u/j*c(i/r);if(a<1)return-0.5*r*f(2,10*(a-=1))*b((a*l-v)*j/u)+g;return r*f(2,
-10*(a-=1))*b((a*l-v)*j/u)*0.5+i+g},quadin:function(a,g,i,l){return i*(a/=l)*a+g},quadout:function(a,g,i,l){return-i*(a/=l)*(a-2)+g},quadinout:function(a,g,i,l){if((a/=l/2)<1)return i/2*a*a+g;return-i/2*(--a*(a-2)-1)+g},sinein:function(a,g,i,l){return-i*e(a/l*m)+i+g},sineout:function(a,g,i,l){return i*b(a/l*m)+g},sineinout:function(a,g,i,l){return-i/2*(e(Math.PI*a/l)-1)+g}};T5.easing=function(a){return h[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(a,g){h[a.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=g}})();
T5.Tween=function(j){j=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},j);var m=T5.ticks(),k=[],f=false,b=0,c=0,e={cancelOnInteract:j.cancelOnInteract,isComplete:function(){return f},triggerComplete:function(d){j.complete&&j.complete(d)},update:function(d){try{var h=j.tweenFn(d-m,b,c,j.duration);if(j.target)j.target[j.property]=h;for(var a=k.length;a--;)k[a](h,void 0);if(f=m+j.duration<=d){if(j.target)j.target[j.property]=
j.tweenFn(j.duration,b,c,j.duration);for(var g=k.length;g--;)k[g](h,true)}}catch(i){COG.Log.exception(i)}},requestUpdates:function(d){k.push(d)}};b=j.target&&j.property&&j.target[j.property]?j.target[j.property]:j.startValue;if(typeof j.endValue!=="undefined")c=j.endValue-b;if(c==0)f=true;T5.wakeTweens();return e};
(function(){function j(b){if(f)return m.length;f=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(b);c++}}finally{f=false}m.length===0&&k.trigger("complete");return m.length}var m=[],k=null,f=false;T5.tweenValue=function(b,c,e,d,h){b=new T5.Tween({startValue:b,endValue:c,tweenFn:e,complete:d,duration:h});m.push(b);return b};T5.tween=function(b,c,e,d,h,a){b=new T5.Tween({target:b,property:c,endValue:e,tweenFn:d,duration:a,complete:h});
m.push(b);return b};T5.tweenVector=function(b,c,e,d,h,a){var g=[];if(b){var i=b.x==c,l=b.y==e;i||g.push(T5.tween(b,"x",c,d,function(){(i=true)&&l&&h()},a));l||g.push(T5.tween(b,"y",e,d,function(){l=true;i&&l&&h()},a))}return g};T5.cancelAnimation=function(b){if(!f){f=true;try{for(var c=0;c<m.length;)if(!b||b(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{f=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!k){k=COG.Loopage.join({execute:j,frequency:20});
k.bind("complete",function(){k=null})}}})();(function(){var j={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,k=arguments.length;k--;){var f=j[arguments[k].toUpperCase()];if(f)m|=f}return m}})();
T5.ViewLayer=function(j){j=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},j);var m=null,k=false,f=false,b=j.supportFastDraw,c=j.id,e=T5.viewState("ACTIVE"),d=j.validStates,h=0,a=0,g=T5.ex({addToView:function(i){i.setLayer(c,g)},shouldDraw:function(i,l,r){return(f||r||h!==l.x1||a!==l.y1)&&(i&d)!==0&&(k?b:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){g.trigger("remove",
g)},changed:function(i){f=true;g.trigger("changed",g);m&&m.trigger("invalidate",i)},getId:function(){return c},setId:function(i){c=i},getParent:function(){return m},setParent:function(i){k=(m=i)?m.fastDraw&&displayState!==e:false;g.trigger("parentChange",m)}},j);COG.observable(g);g.bind("drawComplete",function(i,l){f=false;h=l.x1;a=l.y1});g.bind("resync",function(i,l){if(l.syncXY){g.minXY&&l.syncXY(g.minXY);g.maxXY&&l.syncXY(g.maxXY)}});return g};
T5.View=function(j){function m(n,p,y,B){J=Y;v();if(B&&j.inertia)h(F+p,M+y,j.panAnimationEasing,j.panAnimationDuration);else B||h(F+p,M+y)}function k(){J=fa;R=false;COG.Loopage.join({execute:v,after:50,single:true})}function f(n,p,y){T||(T=[].concat(y));n=oa(T);qa(n);p=ba(n);var B=oa(y);y=qa(B);B=ba(B);e(y);E=n&&p!==0?B/p:1;c()}function b(n,p,y){s.zoom(T5.D.getCenter(K),y)}function c(n){l();var p=T5.XY.init(P-(w.width/(E*2)>>0),da-(w.height/(E*2)>>0)),y=Math.log(E)/Math.LN2>>0;if(E!==1)J=ca;COG.Log.info("scale factor = "+
E+", exp = "+y);if(y!==0){E=Math.pow(2,y);if(!s.trigger("scale",E,p).cancel){COG.Log.info("ok to scale");for(n=t.length;n--;)t[n].trigger("scale",E,p);E=1;T=null;J=fa;n=true}}v(n)}function e(n){ka=T5.XY.init(F,M);la=T5.XY.offset(n,F,M)}function d(){clearTimeout(V);V=setTimeout(a,50)}function h(n,p,y,B,D){function I(){N+=1;if(N>=2){k(0,0);D&&D()}}var N=0,$=L?T5.XY.offset(L,-ha,-ia):null,aa=H?T5.XY.offset(H,-ha,-ia):null;if($){n=n<$.x?$.x:n;p=p<$.y?$.y:p}if(aa){n=n>aa.x?aa.x:n;p=p>aa.y?aa.y:p}if(y){if(!R){n=
T5.tweenValue(F,n,y,I,B);p=T5.tweenValue(M,p,y,I,B);n.cancelOnInteract=true;n.requestUpdates(function(ra){F=ra>>0;R=true;v()});p.cancelOnInteract=true;p.requestUpdates(function(ra){M=ra>>0;R=true;v()})}}else{F=n>>0;M=p>>0}}function a(){var n;if(z){COG.Touch.release(z);if(j.autoSize&&z.parentNode){n=z.parentNode.getBoundingClientRect();if(n.height!==0&&n.width!==0){z.height=n.height;z.width=n.width}}try{if(!z.id)z.id=j.id+"_canvas";G=z.getContext("2d")}catch(p){COG.Log.exception(p);throw Error("Could not initialise canvas on specified view element");
}ea=COG.Touch.capture(z,{observable:s});if(K.height!==z.height||K.width!==z.width){K=T5.D.init(z.width,z.height);ha=K.width/2>>0;ia=K.height/2>>0;s.trigger("resize",z.width,z.height);for(n=x;n--;)t[n].trigger("resize",z.width,z.height)}j.inertia&&ea.inertiaEnable(j.panAnimationDuration,K);for(n=x;n--;)t[n].trigger("contextChanged",G);v()}}function g(n,p){p.setId(n);p.added=T5.ticks();p.bind("remove",function(){s.removeLayer(n)});p.trigger("contextChanged",G);p.setParent(s);t.push(p);t.sort(function(y,
B){var D=B.zindex-y.zindex;if(D===0)D=B.added-y.added;return D});x=t.length;return p}function i(){q("idle",s);Z=true;U=0}function l(n){var p=1/E;P=la.x+(F-ka.x);da=la.y+(M-ka.y);if(n)return T5.XYRect.fromCenter(P>>0,da>>0,n.width*p>>0,n.height*p>>0)}function r(n,p,y,B){var D=T5.XYRect.copy(p),I,N=0;y&&G.clearRect(0,0,z.width,z.height);G.save();try{G.globalCompositeOperation="source-over";if(E!==1){D=l(D);G.scale(E,E)}G.translate(-D.x1,-D.y1);H=L=null;G.beginPath();X=false;for(N=x;N--;)if(t[N].clip){t[N].clip(G,
D,n,s,y,B);X=true}G.closePath();X&&G.clip();for(N=x;N--;){I=t[N];var $=I.style,aa=$?T5.Style.apply(G,$):null;if(I.minXY)L=L?T5.XY.min(L,I.minXY):T5.XY.copy(I.minXY);if(I.maxXY)H=H?T5.XY.max(H,I.maxXY):T5.XY.copy(I.maxXY);I.draw(G,D,n,s,y,B);aa&&T5.Style.apply(G,aa)}}finally{G.restore()}if(C){G.globalCompositeOperation="source-over";G.strokeStyle="#f00";G.beginPath();G.moveTo(z.width/2,0);G.lineTo(z.width/2,z.height);G.moveTo(0,z.height/2);G.lineTo(z.width,z.height/2);G.stroke()}q("drawComplete",p,
B);COG.Log.trace("draw complete",B)}function u(n,p){var y=false,B=W?W:R?Y:J,D=!R&&(B===ca||B===Y),I=ma||B===Y||B===ca||T5.isTweening();w=o();if(D){T5.cancelAnimation(function(N){return N.cancelOnInteract});Z=false;if(U!==0){clearTimeout(U);U=0}}for(D=x;D--;){if(t[D].animated)J|=pa;t[D].cycle(n,w,J,I);y=t[D].shouldDraw(J,w,I)||y}I=I||(J&pa)!==0;if(y=y||I||E!==1&&E!==S){r(B,w,I,n);S=E;ma=false}if(!y&&O===0&&!ja){if(!Z&&U===0)U=setTimeout(i,500);p.trigger("complete")}O=0;COG.Log.trace("Completed draw cycle",
n)}function v(n){ma=n?true:false;O+=1;if(!A){A=COG.Loopage.join({execute:u,frequency:ga});A.bind("complete",function(){A=null})}}function o(){return T5.XYRect.init(F,M,F+K.width,M+K.height)}function q(){for(var n=s.trigger.apply(null,arguments).cancel,p=t.length;p--;)n=t[p].trigger.apply(null,arguments).cancel||n;return!n}j=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,
adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},j);var t=[],x=0,z=document.getElementById(j.container),G=null,F=0,M=0,X=false,w=null,A=null,C=j.guides,na=1,K=T5.D.init(),O=0,ha=0,ia=0,ka=null,la=null,Z=false,R=false,U=0,L=null,H=null,Q=0,W=null,ma=false,V=0,T=null,E=1,S=0,ja=typeof FlashCanvas!=="undefined",ga=~~(1E3/j.fps),ea=null,P,da,fa=T5.viewState("ACTIVE"),Y=T5.viewState("PAN"),ca=T5.viewState("ZOOM"),pa=T5.viewState("ANIMATING"),J=fa,oa=T5.XY.getRect,ba=T5.XYRect.diagonalSize,
qa=T5.XYRect.center,s={id:j.id,deviceScaling:na,fastDraw:j.fastDraw||T5.getConfig().requireFastDraw,getDimensions:function(){return K},getLayer:function(n){for(var p=0;p<x;p++)if(t[p].getId()==n)return t[p];return null},setLayer:function(n,p){for(var y=0;y<x;y++)if(t[y].getId()===n){t.splice(y,1);break}p&&g(n,p);v();return p},eachLayer:function(n){for(var p=x;p--;)n(t[p])},invalidate:v,resize:function(n,p){if(z){j.autoSize=false;z.width=n;z.height=p;a();s.trigger("resize",z.width,z.height)}},scale:function(n,
p,y,B){function D(){E=Math.pow(2,Math.round(Math.log(E)/Math.LN2));B&&B();c(true)}var I=E;p||(p=T5.D.getCenter(K));e(p);if(y)T5.tweenValue(0,n-I,y,D,1E3).requestUpdates(function(N){E=I+N;c()});else{E=n;D()}return s},triggerAll:q,removeLayer:function(n){a:{for(var p=x;p--;)if(t[p].getId()==n){n=p;break a}n=-1}if(n>=0&&n<x){COG.say("layer.removed",{layer:t[n]});t.splice(n,1);v()}x=t.length},stateOverride:function(n){W=n},getOffset:function(){return T5.XY.init(F,M)},getViewRect:o,updateOffset:h,pan:function(n,
p,y,B,D){h(F+n,M+p,y,B,D)},zoom:function(n,p){e(n);R=false;E=Math.max(E+Math.pow(2,p)-1,0.25);COG.Log.info("zooming, scale change = "+p+", targetXY = ",n);c()}};na=T5.getConfig().getScaling();s.markers=g("markers",new T5.MarkerLayer);COG.observable(s);s.bind("invalidate",function(n,p){v(p)});if(j.pannable){s.bind("pan",m);s.bind("panEnd",k);s.bind("inertiaCancel",function(){R=false;v()})}if(j.scalable){s.bind("pinchZoom",f);s.bind("wheelZoom",b)}s.bind("tap",function(n,p,y){for(var B=T5.XY.offset(y,
F,M),D=t.length;D--;)n.cancel=n.cancel||t[D].trigger("tap",p,y,B).cancel});s.bind("resync",function(){H=L=null});COG.configurable(s,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(j,null,{container:function(n,p){z=document.getElementById(p);a()},rotation:function(n,p){Q=p}}),true);a();j.autoSize&&window.addEventListener("resize",d,false);return s};
T5.PathLayer=function(j){j=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},j);var m=false,k=[],f=null,b=[],c=null,e=0,d=[],h=T5.ex(new T5.ViewLayer(j),{getAnimation:function(a,g,i,l){var r="pathAnimation"+e++;d.push(r);return new T5.AnimatedPathLayer({id:r,path:k,zindex:j.zindex+1,easing:a?a:T5.easing("sine.inout"),duration:g?g:5E3,drawIndicator:i,autoCenter:l?l:false})},cycle:function(a,g,i,l){return l},draw:function(a){var g,i=k.length;a.save();try{T5.Style.apply(a,j.style);if(i>0){a.beginPath();
a.moveTo(k[i-1].x,k[i-1].y);for(g=i;g--;)a.lineTo(k[g].x,k[g].y);a.stroke();if(f){a.fillStyle=j.waypointFillStyle;for(g=f.length;g--;){a.beginPath();a.arc(f[g].x,f[g].y,2,0,Math.PI*2,false);a.stroke();a.fill()}}}}finally{a.restore()}m=false},updateCoordinates:function(a,g){b=a;c=g;var i=h.getParent();if(i&&i.syncXY){i.syncXY(b);c&&i.syncXY(c);h.trigger("tidy")}}});h.bind("tidy",function(){k=T5.XY.simplify(b,j.pixelGeneralization);f=T5.XY.simplify(c,j.pixelGeneralization);m=true;h.changed()});return h};
T5.ShapeLayer=function(j){function m(c){for(var e=f.length;e--;)f[e].resync(c);f.sort(function(d,h){var a=h.xy.y-d.xy.y;if(a===0)a=h.xy.x-d.xy.y;return a});b.changed()}function k(c,e){e.syncXY&&m(e)}j=T5.ex({zindex:80},j);var f=[],b=T5.ex(new T5.ViewLayer(j),{add:function(c){f[f.length]=c},each:function(c){for(var e=f.length;e--;)c(f[e])},draw:function(c,e,d){var h=e.x1,a=e.y1,g=e.width;e=e.height;for(var i=f.length;i--;){var l=f[i].style;l=l?T5.Style.apply(c,l):null;f[i].draw(c,h,a,g,e,d);l&&T5.Style.apply(c,
l)}}});b.bind("parentChange",k);b.bind("resync",k);return b};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(j){j=T5.ex({style:null,properties:{}},j);return T5.ex(j,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(j,m){m=T5.ex({size:4},m);var k=T5.XY.init(),f=T5.ex(m,{draw:function(b){b.beginPath();b.arc(k.x,k.y,f.size,0,Math.PI*2,false);b.fill();b.stroke()},resync:function(b){b.syncXY([j]);k=T5.XY.floor([j])[0]}});COG.Log.info("created arc = ",j);return f};
T5.Poly=function(j,m){m=T5.ex({fill:false,simplify:false},m);var k=false,f=m.fill,b=m.simplify,c=T5.viewState("ZOOM"),e=[],d=T5.ex(new T5.Shape(m),{draw:function(h,a,g,i,l,r){if(k){a=true;g=(r&c)!==0;h.beginPath();for(r=e.length;r--;){g=e[r].x;i=e[r].y;if(a){h.moveTo(g,i);a=false}else h.lineTo(g,i);g=true}if(g){f&&h.fill();h.stroke()}}},resync:function(h){d.xy=h.syncXY(j);e=T5.XY.floor(b?T5.XY.simplify(j):j)}});k=j&&j.length>=2;return d};
T5.AnimatedPathLayer=function(j){function m(d,h,a){d.fillStyle="#FFFFFF";d.strokeStyle="#222222";d.beginPath();d.arc(a.x,a.y,4,0,Math.PI*2,false);d.stroke();d.fill()}j=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},j);var k=T5.XY.edges(j.path),f,b=null,c=0;T5.tweenValue(0,k.total,j.easing,function(){e.remove()},j.duration).requestUpdates(function(d,h){c=d;h&&e.remove()});var e=T5.ex(new T5.ViewLayer(j),
{cycle:function(){for(var d=0;d<k.accrued.length&&k.accrued[d]<c;)d++;b=null;if(d<j.path.length-1){var h=c-(d>0?k.accrued[d-1]:0),a=j.path[d];f=T5.XY.theta(a,j.path[d+1],k.edges[d]);b=T5.XY.extendBy(a,f,h)}return b},draw:function(d,h){if(b)(j.drawIndicator?j.drawIndicator:m)(d,h,T5.XY.init(b.x,b.y),f)}});return e};
T5.Marker=function(j){function m(h,a,g,i){f=h;b=a;c=g;e=i}j=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},j);var k=false,f=0,b=0,c=0,e=0,d=T5.ex(j,{isAnimating:function(){return k},draw:function(h,a,g,i,l){if(d.isNew&&j.tweenIn){var r=d.xy.y;d.xy.y=a.y1-20;k=true;T5.tween(d.xy,"y",r,j.tweenIn,function(){d.xy.y=r>>0;k=false},j.animationSpeed?j.animationSpeed:250+Math.random()*500)}d.drawMarker(h,a,d.xy.x,d.xy.y,g,i,l);d.isNew=false},drawMarker:function(h,a,g,i){h.beginPath();
h.arc(g,i,4,0,Math.PI*2,false);h.fill();m(g-4,i-4,8,8)},hitTest:function(h,a){return h>=f&&h<=f+c&&a>=b&&a<=b+e},updateBounds:m});COG.observable(d);return d};
T5.ImageMarker=function(j){j=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},j);var m=j.imageAnchor?T5.XY.invert(j.imageAnchor):null,k=T5.ex(new T5.Marker(j),{drawMarker:function(f,b,c,e){if((b=k.isAnimating()&&k.animatingImage?k.animatingImage:k.image)&&b.width>0){m||(m=T5.XY.init(-b.width>>1,-b.height>>1));var d=k.scale,h=c+~~(m.x*d),a=e+~~(m.y*d),g=~~(b.width*d),i=~~(b.height*d);k.updateBounds(h,a,g,g);if(k.rotation||k.opacity!==
1){f.save();try{f.globalAlpha=k.opacity;f.translate(c,e);f.rotate(k.rotation);f.drawImage(b,m.x*d,m.y*d,g,i)}finally{f.restore()}}else f.drawImage(b,h,a,g,i)}}});if(!k.image)k.image=T5.Images.get(j.imageUrl,function(f){k.image=f});if(!k.animatingImage)k.animatingImage=T5.Images.get(j.animatingImageUrl,function(f){k.animatingImage=f});return k};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(j){function m(){b.changed();b.trigger("markerUpdate",f)}function k(){var c=b.getParent();if(c&&c.syncXY)for(var e=f.length;e--;)c.syncXY([f[e].xy])}j=T5.ex({zindex:100,style:"basic"},j);var f=[],b=T5.ex(new T5.ViewLayer(j),{draw:function(c,e,d,h){for(var a=f.length;a--;)f[a].draw(c,e,d,b,h)},add:function(c){if(c&&typeof c.length!=="undefined")for(var e=c.length;e--;){if(c[e])f[f.length]=c[e]}else if(c)f[f.length]=c;m()},clear:function(c){if(c)for(var e=0;e<f.length;e++)c(f[e])&&
f.splice(e,1);else f=[];m()},each:function(c){if(c)for(var e=f.length;e--;)c(f[e])},find:function(c){for(var e=[],d=f.length;d--;)if(!c||c(f[d]))e[e.length]=f[d];return e}});b.bind("tap",function(c,e,d){for(var h=[],a=d.x,g=d.y,i=f.length;i--;)if(f[i].hitTest(a,g))h[h.length]=f[i];if(h.length>0)c.cancel=b.trigger("markerTap",e,d,h).cancel});b.bind("parentChange",k);b.bind("resync",k);b.bind("changed",k);return b};
T5.ImageLayer=function(j,m){function k(a,g,i){for(g=c.length;g--;){var l=c[g],r=l.x,u=l.y,v=T5.XYRect.init(l.x,l.y,l.x+l.width,l.y+l.height);if(i&&T5.XYRect.intersect(a,v)){v=T5.Images.get(l.url,function(){h.changed()},d);i(v,r,u,l.width,l.height)}}}function f(a){b&&b.run(a,function(g){c=[].concat(g);h.changed()})}m=T5.ex({imageLoadArgs:{}},m);var b=j?T5.Generator.init(j,m):null,c=[],e=T5.XYRect.init(),d=m.imageLoadArgs,h=T5.ex(new T5.ViewLayer(m),{changeGenerator:function(a,g){b=T5.Generator.init(a,
T5.ex({},m,g));b.bindToView(h.getParent());c=null;f(e)},clip:function(a,g,i){k(g,i,function(l,r,u,v,o){l&&a.rect(r,u,v,o)})},cycle:function(a,g){f(g)},draw:function(a,g,i){k(g,i,function(l,r,u,v,o){h.drawImage(a,l,r,u,v,o,g,i)});e=T5.XYRect.copy(g)},drawImage:function(a,g,i,l){g&&a.drawImage(g,i,l,g.width,g.height)}});h.bind("idle",function(){f(e)});h.bind("parentChange",function(a,g){b&&b.bindToView(g)});h.bind("tap",function(a,g,i,l){a=[];var r=l.x,u=l.y,v,o;if(c)for(var q=c.length;q--;){v=c[q];
if(o=r>=v.x&&r<=v.x+v.width&&u>=v.y&&u<=v.y+v.height)a[a.length]=v}a.length>0&&h.trigger("tapImage",a,g,i,l)});return h};
T5.Style=function(){function j(e,d){b[e]=k(d);return e}function m(e){for(var d in e)j(d,e[d])}function k(e){function d(i){var l=e[i];typeof l!=="undefined"&&a.push(function(r){r[i]=l})}function h(){a=[];for(var i in e)d(i)}e=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},e);var a=[],g={applyToContext:function(i){for(var l=a.length;l--;)a[l](i)},update:function(i,
l){e[i]=l;h()}};h();return g}var f={},b={},c={apply:function(e,d){var h=b[d]?b[d]:b.basic,a;if(e&&e.canvas){a=f[e.canvas.id];f[e.canvas.id]=d}h.applyToContext(e);return a},define:j,defineMany:m,get:function(e){return b[e]},init:k,load:function(e){COG.jsonp(e,function(d){T5.resetStyles(d)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return c}();
T5.Tiling=function(){return{tileSize:256,init:function(j,m,k,f,b){return T5.ex({x:j,y:m,width:k,height:f},b)}}}();
T5.TileGenerator=function(j){function m(u,v,o,q){function t(){if(r.initTileCreator){d=true;r.initTileCreator(u,v,o,q)}}r.prepTileCreator?r.prepTileCreator(u,v,o,t):t()}function k(u,v){for(var o=~~((u.x1-c.x)/h),q=~~((u.y1-c.y)/a),t=[],x=-e;x<i;x++)for(var z=-e;z<l;z++){var G=g(o+x,q+z);if(G)t[t.length]=G}v&&v(t);b=T5.XYRect.copy(u)}j=T5.ex({tileWidth:256,tileHeight:256,relative:false,padding:2},j);var f=null,b=null,c=T5.XY.init(),e=j.padding,d=false,h=j.tileWidth,a=j.tileHeight,g=null,i=0,l=0,r={bindToView:function(u){COG.Log.info("initializing generator");
f=u;r.trigger("bindView",u)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){g=null;d=false;b=null},run:function(u,v){if(!b||Math.abs(u.x1-b.x1)>h||Math.abs(u.y1-b.y1)>a){if(!g&&!d||r.requireRefresh()){c=j.relative?T5.XY.init(u.x1,u.y1):T5.XY.init();i=Math.ceil(u.width/h)+e;l=Math.ceil(u.height/a)+e;m(h,a,r.getTileCreatorArgs?r.getTileCreatorArgs(f):{},function(o){g=o;d=false;k(u,v)})}g&&k(u,v)}}};COG.observable(r);r.bind("update",
function(){COG.Log.info("captured generator update");b=null});return r};
