COG=function(){var h=/\$\{(.*?)\}/ig,l=Object.prototype.hasOwnProperty,j=0,e={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,f=arguments.length,b=false,k,d,i,g;if(typeof a==="boolean"){b=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!e.isFunction(a))a={};if(f===c){a=this;--c}for(;c<f;c++)if((k=arguments[c])!=null)for(d in k){i=a[d];g=k[d];if(a!==g)if(b&&g&&(e.isPlainObject(g)||e.isArray(g))){i=i&&(e.isPlainObject(i)||e.isArray(i))?i:e.isArray(g)?[]:{};a[d]=e.extend(b,i,g)}else if(g!==
undefined)a[d]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!l.call(a,"constructor")&&!l.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||l.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var f=a,b=arguments,k=1;if(c&&e.isArray(c)){b=c;k=0}for(k=k;k<b;k++)f=f&&typeof foo[b[k]]!=="undefined";return f},newModule:function(a){a=e.extend({id:null,requires:[],parent:null},a);if(a.parent)a=e.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+j++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,f=0;f<=c;f++)a=a.replace(RegExp("\\{"+f+"\\}","gi"),arguments[f+
1]);return a},wordExists:function(a,c){var f="";if(c.toString)c=c.toString();for(var b=0;b<c.length;b++)f+=!/\w/.test(c[b])?"\\"+c[b]:c[b];return RegExp("(^|\\s|\\,)"+f+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var f=h.exec(a);f;){a=a.replace(f[0],COG.XPath.first(f[1],c));h.lastIndex=0;f=h.exec(a)}return a}};return e}();
COG.Log=function(){function h(c,f){var b,k=f&&f.length>0?f[0]:"";for(b=1;f&&b<f.length;b++)k+=" "+(j&&COG.isPlainObject(f[b])?JSON.stringify(f[b]):f[b]);typeof console!=="undefined"&&console[c](k);for(b=0;b<l.length;b++)l[b].call(a,k,c)}var l=[],j=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(c,f){if(e)console.markTimeline(c+(f?": "+(a.getTraceTicks()-f)+"ms":""))},debug:function(){h("debug",
arguments)},info:function(){h("info",arguments)},warn:function(){h("warn",arguments)},error:function(){h("error",arguments)},exception:function(c){a.error(arguments);for(var f in c)a.info("ERROR DETAIL: "+f+": "+c[f])},watch:function(c,f){try{f()}catch(b){a.exception(b,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){l.push(c)}};return a}();
(function(){function h(e,a){e[a]||(e[a]=function(c){return e.configure(a,c)})}function l(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var j={};COG.paramTweaker=function(e,a,c){return function(f,b){if(typeof b!=="undefined"){if(f in e)e[f]=b;c&&f in c&&c[f](f,b)}else return a&&f in a?a[f](f):e[f]}};COG.configurable=function(e,a,c,f){if(e){e.gtConfId||l(e);var b=e.gtConfId,k=e.gtConfig,d=e.gtConfigFns;j[b]=e;d.push(c);for(c=a.length;c--;){k[a[c]]=true;f&&
h(e,a[c])}if(!e.configure)e.configure=function(i,g){if(k[i]){for(var m=d.length;m--;){var p=d[m](i,g);if(typeof p!=="undefined")return p}return j[b]}return null}}}})();
(function(){function h(l,j){var e=l.gtObsHandlers;e[j]||(e[j]=[]);return e[j]}COG.observable=function(l){if(l){if(!l.gtObsHandlers)l.gtObsHandlers={};if(!(l.bind||l.trigger||l.unbind)){l.bind=function(j,e){var a=COG.objId("callback");h(l,j).unshift({fn:e,id:a});return a};l.trigger=function(j){var e=h(l,j),a={cancel:false,tickCount:(new Date).getTime()},c;if(!e)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var f=e.length;f--&&!a.cancel;)e[f].fn.apply(self,c);return a};l.unbind=
function(j,e){for(var a=h(l,j),c=0;a&&c<a.length;c++)if(a[c].id===e){a.splice(c,1);break}return l}}}}})();(function(){var h={},l=[];COG.addPipe=function(j){j("pipe.test",{});l.push(j)};COG.listen=function(j,e){h[j]||(h[j]=[]);e&&h[j].push(e)};COG.say=function(j,e){var a;for(a=l.length;a--;)l[a](j,e);if(h[j])for(a=h[j].length;a--;)h[j][a](e)}})();
COG.Loopage=function(){function h(g){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function l(g){b.push(g);j()}function j(){k&&clearTimeout(k);k=setTimeout(e,0);i=true}function e(){for(var g,m=(new Date).getTime(),p=f.length;b.length>0;){var w=b.shift();for(g=p;g--;)if(f[g].id===w){f.splice(g,1);break}i=true;p=f.length}if(i){d=a;for(g=p;g--;)d=f[g].frequency<d?f[g].frequency:d}for(g=p;g--;){w=m-f[g].lastTick;if(f[g].lastTick===0||w>=f[g].frequency){f[g].execute(m,
f[g]);f[g].lastTick=m;f[g].single&&f[g].trigger("complete")}}k=p?setTimeout(e,d):0}var a=6E4,c=0,f=[],b=[],k=0,d=a,i=true;return{join:function(g){var m=new h(g);if(m.after>0)m.lastTick=(new Date).getTime()+m.after;COG.observable(m);m.bind("complete",function(){l(m.id)});f.unshift(m);j();return m},leave:l}}();if(!this.JSON)this.JSON={};
(function(){function h(d){return d<10?"0"+d:d}function l(d){a.lastIndex=0;return a.test(d)?'"'+d.replace(a,function(i){var g=b[i];return typeof g==="string"?g:"\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function j(d,i){var g,m,p,w,z=c,n,o=i[d];if(o&&typeof o==="object"&&typeof o.toJSON==="function")o=o.toJSON(d);if(typeof k==="function")o=k.call(i,d,o);switch(typeof o){case "string":return l(o);case "number":return isFinite(o)?String(o):"null";case "boolean":case "null":return String(o);
case "object":if(!o)return"null";c+=f;n=[];if(Object.prototype.toString.apply(o)==="[object Array]"){w=o.length;for(g=0;g<w;g+=1)n[g]=j(g,o)||"null";p=n.length===0?"[]":c?"[\n"+c+n.join(",\n"+c)+"\n"+z+"]":"["+n.join(",")+"]";c=z;return p}if(k&&typeof k==="object"){w=k.length;for(g=0;g<w;g+=1){m=k[g];if(typeof m==="string")if(p=j(m,o))n.push(l(m)+(c?": ":":")+p)}}else for(m in o)if(Object.hasOwnProperty.call(o,m))if(p=j(m,o))n.push(l(m)+(c?": ":":")+p);p=n.length===0?"{}":c?"{\n"+c+n.join(",\n"+c)+
"\n"+z+"}":"{"+n.join(",")+"}";c=z;return p}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,f,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(d,i,g){var m;f=c="";if(typeof g==="number")for(m=0;m<g;m+=1)f+=" ";else if(typeof g==="string")f=g;if((k=i)&&typeof i!=="function"&&(typeof i!=="object"||typeof i.length!=="number"))throw Error("JSON.stringify");return j("",
{"":d})};if(typeof JSON.parse!=="function")JSON.parse=function(d,i){function g(p,w){var z,n,o=p[w];if(o&&typeof o==="object")for(z in o)if(Object.hasOwnProperty.call(o,z)){n=g(o,z);if(n!==undefined)o[z]=n;else delete o[z]}return i.call(p,w,o)}var m;d=String(d);e.lastIndex=0;if(e.test(d))d=d.replace(e,function(p){return"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=eval("("+d+")");return typeof i==="function"?g({"":m},""):m}throw new SyntaxError("JSON.parse");}})();
(function(){function h(j,e){var a=j.split("|"),c={};for(var f in e){var b=e[f];c[f]=a.length>b?a[b]:null}return c}var l={JSON:{parse:function(j){return JSON.parse(j)}},PDON:{parse:function(j){var e=null,a=[];j=j.split("\n");for(var c=0;c<j.length;c++){var f=j[c];if(e)a.push(h(f,e));else if(f){e=f.split("|");f={};for(var b=0;b<e.length;b++)f[e[b]]=b;e=f}else e=null}return a}}};COG.parseData=function(j,e){e=e?e.toUpperCase():"JSON";if(!l[e])throw Error("Unsupported data format: "+e);try{return l[e].parse(j)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function h(a){for(var c=null,f=0;f<l.length;f++)if(c=l[f](a))break;return c}var l=[],j=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var f=null;if(a.resultType>=0&&a.resultType<j.length)f=j[a.resultType];if(f)c=f(a)}return c?c:""}}},first:function(a,c){var f=e.SearchResult,b;var k=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!k)k=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))b=c.evaluate(a,c,h,k,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(d){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);b=null}return new f(b)},registerResolver:function(a){l.push(a)}};return e}();
COG.Storage=function(){function h(l){if(l&&l=="session")return sessionStorage;return localStorage}return{get:function(l,j){var e=h(j).getItem(l);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(l,j,e){j=jQuery.isArray(j)||jQuery.isPlainObject(j)?JSON.stringify(j):j;h(e).setItem(l,j)},remove:function(l,j){h(j).removeItem(l)}}}();
COG.ParseRules=function(){var h=[];return{add:function(l,j){h.push({regex:l,handler:j})},each:function(l,j,e){function a(){c++;e&&c>=h.length&&e(j)}for(var c=0,f=0;f<h.length;f++){var b=h[f].regex,k=h[f].handler,d=false;if(b){b.lastIndex=-1;if((b=b.exec(l))&&k){d=true;k(b,j,a)&&a()}}d||a()}}}};
(function(){function h(b){var k=[],d=function(g,m){m=COG.isFunction(m)?m():m;k[k.length]=encodeURIComponent(g)+"="+encodeURIComponent(m)};if(COG.isArray(b))for(var i=0;i<b.length;i++)d(b[i].name,b[i].value);else for(i in b)d(i,b[i]);return k.join("&").replace(/%20/g,"+")}var l={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},j={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},f={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function k(){if(this.readyState===4){var m=null,p=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(p)if(b.handleResponse)b.handleResponse(this);else{var w=b,z=this.getResponseHeader(f.CONTENT_TYPE),n,o=false;for(n in l)if(z&&z.indexOf(l[n])>=0){o=true;
break}z=!o;for(o=0;o<e.length;o++)z=z||e[o]==n;if(z)b:{z=n;for(var v in j)for(o=0;o<j[v].length;o++)if(RegExp(j[v][o]+"$","i").test(w.url)){n=v;break b}n=z?z:"DEFAULT"}try{m=c[n](this,w)}catch(t){m=c.DEFAULT(this,w)}}else b.error&&b.error(this)}catch(J){COG.Log.exception(J,"PROCESSING AJAX RESPONSE")}p&&m&&b.success&&b.success.call(this,m)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var d=
a.exec(b.url),i=d&&(d[1]&&d[1]!==location.protocol||d[2]!==location.host);if(b.data)b.method="POST";if(b.url){d=null;if(b.xhr)d=b.xhr(b);d||(d=new XMLHttpRequest);d.open(b.method,b.url,b.async);b.data&&d.setRequestHeader("Content-Type",b.contentType);i||d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.onreadystatechange=k;d.send(b.method=="POST"?h(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function h(a){var c=document.createElement("script"),f=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!f&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};j||(j=document.getElementsByTagName("head")[0]);j.appendChild(c)}var l=0,j,e=this;COG.jsonp=function(a,c,f){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++l;e[b]=function(k){c(k);e[b]=null;try{delete e[b]}catch(d){}};
h(a+(f?f:"callback")+"="+b);return b}})();
COG.Touch=function(){function h(u,A){return{x:u.x-A.x,y:u.y-A.y}}function l(u,A){var E=h(u,A);return Math.sqrt(E.x*E.x+E.y*E.y)}function j(u){if(u.count>1)return l(u.touches[0],u.touches[1]);return 0}function e(u,A){var E=u&&u.count>0?u.touches[0]:null;if(E&&A&&A.count>0)return h(E,A.touches[0]);return null}function a(u,A){u.count=A.count;for(var E=d;E--;){u.touches[E].x=A.touches[E].x;u.touches[E].y=A.touches[E].y}}function c(){for(var u={count:0,touches:Array(d)},A=d;A--;)u.touches[A]=k();return u}
function f(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}function b(u,A,E){if(B){A=A[E?E:"touches"];E=A.length;for(E=u.count=E;E--;){u.touches[E].x=A[E].pageX;u.touches[E].y=A[E].pageY}}else if(A.button===0){u.count=1;u.touches[0].x=A.pageX?A.pageX:A.screenX;u.touches[0].y=A.pageY?A.pageY:A.screenY}else u.count=0}function k(u,A){return{x:u?u:0,y:A?A:0}}var d=10,i=120,g=100,m=250,p=300,w=5,z=0,n=1,o=2,v=7,t=0,J=0,B=undefined,la=function(u){function A(s,
x,D,C){var q=Math.asin((s.y-x.y)/D);D=D*(sa/C)>>0;D=D>ra?ra:D;q=x.x>s.x?q:Math.PI-q;O("pan",Math.cos(q)*-D,Math.sin(q)*D,true)}function E(s,x){var D,C;if(B){D=x-ja;if(D<m){C=l(I.touches[0],s);C>u.inertiaTrigger&&A(I.touches[0],s,C,D)}}else{P.x=s.x;P.y=s.y;COG.Loopage.join({execute:function(q,r){D=q-x;C=l(s,P);if(D<g&&C>u.inertiaTrigger){r.trigger("complete");A(s,P,C,D)}else D>g&&r.trigger("complete")},frequency:10})}}function na(s){var x=0,D=0;if(s.offsetParent){do{x+=s.offsetLeft;D+=s.offsetTop;
s=s.offsetParent}while(s)}return k(x,D)}function da(s){var x=s.count,D=Array(x),C=na(Q);for(x=x;x--;)D[x]=k(s.touches[x].x-C.x,s.touches[x].y-C.y);return D}function O(){ea&&ea.trigger.apply(null,arguments)}function ga(s,x){var D=na(Q);D=k(x.x-D.x,x.y-D.y);O(s,x,D)}function K(s){var x=s.target?s.target:s.srcElement;if(ka||x&&x===Q){b(I,s);if(I.count!==0){Z=null;$.x=0;$.y=0;F=true;T=false;ja=(new Date).getTime();f(s);x.style.cursor="move";O("inertiaCancel");oa=ja;if(s=I.count>0?I.touches[0]:null){O("touchStart",
s.x,s.y);if(oa-pa<p)if((s=h(I.touches[0],W.touches[0]))&&Math.abs(s.x)<u.maxDistDoubleTap&&Math.abs(s.y)<u.maxDistDoubleTap)T=true;U=z;a(W,I)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function qa(s){var x=s.target?s.target:s.srcElement,D=0;if(ka||x&&x===Q){b(R,s);if(R.count>0){P.x=R.touches[0].x;P.y=R.touches[0].y}if(F){B&&f(s);if(R.count>1){I.count===1&&a(I,R);D=j(I)-j(R)}if(U===z)if((s=e(R,I))&&(Math.abs(s.x)>=v||Math.abs(s.y)>=v))U=n;if(U!==z)if(!D||Math.abs(D)<w){if(Z=
e(R,W)){$.x-=Z.x;$.y-=Z.y;aa.x-=Z.x;aa.y-=Z.y}O("pan",aa.x,aa.y);aa.x=0;aa.y=0;U=n}else{O("pinchZoom",da(I),da(R));U=o}a(W,R)}}}function L(s){var x=s.target?s.target:s.srcElement;if(F&&(ka||x&&x===Q)){b(X,s,"changedTouches");var D=X.touches[0];B&&f(s);s=(new Date).getTime();pa=oa;if(U===z){ga("tap",I.touches[0]);ba||(ba=setTimeout(function(){ba=0;T&&ga("doubleTap",I.touches[0])},p+50))}else if(U==n){O("panEnd",$.x,$.y);ca&&E(D,s)}else U==o&&O("pinchZoomEnd",da(I),da(W),s-ja);x.style.cursor="default";
F=false}}function ha(s){var x=s.target?s.target:s.srcElement;if(ka||x&&x===Q){if(s.detail){x=-s.detail*i;x=k(s.axis===1?x:0,s.axis===2?x:0)}else x=k(s.wheelDeltaX,s.wheelDeltaY);var D=x.y!==0?Math.abs(x.y/i):0;if(P&&D!==0){var C=k(P.x-Q.offsetLeft,P.y-Q.offsetTop);O("wheelZoom",C,Math.pow(2,x.y>0?D:-D))}f(s)}}u=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,
doubleTapHandler:null,wheelZoomHandler:null},u);var T=false,ba=0,Y=T5.getConfig(),I=c(),R=c(),W=c(),X=c(),Z=null,$=k(),aa=k(),U=null,F=false,ja=0,ia=[],P=k(),ca=false,sa,ra,oa=0,pa=0,Q=u.element,ea=u.observable,ka=typeof FlashCanvas!=="undefined",V={supportsTouch:B,addListeners:function(s){ia.push(s)},decoupleListeners:function(s){for(var x=0;s&&x<ia.length;x++)if(ia[x].listenerId===s){ia.splice(x,1);break}},release:function(){Y.unbindEvent(B?"touchstart":"mousedown",K,false);Y.unbindEvent(B?"touchmove":
"mousemove",qa,false);Y.unbindEvent(B?"touchend":"mouseup",L,false);if(!B){window.removeEventListener("mousewheel",ha,false);window.removeEventListener("DOMMouseScroll",ha,false)}},inertiaEnable:function(s,x){ca=true;sa=s;ra=x?Math.min(x.width,x.height):500},inertiaDisable:function(){ca=false}};if(typeof B==="undefined")B=T5.getConfig().supportsTouch;Y.bindEvent(B?"touchstart":"mousedown",K,false);Y.bindEvent(B?"touchmove":"mousemove",qa,false);Y.bindEvent(B?"touchend":"mouseup",L,false);if(!B){Y.bindEvent("mousewheel",
ha,window);Y.bindEvent("DOMMouseScroll",ha,window)}return V},M=[];return{capture:function(u,A){if(!u)throw Error("Unable to capture touch of null element");if(!u.id)u.id="touchable_"+t++;var E=M[u.id];if(!E){E=new la(COG.extend({element:u},A));M[u.id]=E}if(A){A.listenerId&&E.decoupleListeners(A.listenerId);A.listenerId=++J;E.addListeners(A)}return E},release:function(u){if(u&&u.id&&M[u.id]){M[u.id].release();delete M[u.id]}}}}();
T5=function(){var h=function(){function a(b,k){return f(b.x-k.x,b.y-k.y)}function c(b,k){if(!k)k=b.length;if(k<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var d={edges:Array(k-1),accrued:Array(k-1),total:0},i=0;i<k-1;i++){var g=a(b[i],b[i+1]);d.edges[i]=Math.sqrt(g.x*g.x+g.y*g.y);d.accrued[i]=d.total+d.edges[i];d.total+=d.edges[i]}return d}function f(b,k){return{x:b?b:0,y:k?k:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,k=0,d=arguments.length;d--;){b+=arguments[d].x;k+=arguments[d].y}return f(b,k)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?f(b.x,b.y):null},diff:a,distance:function(b,k){return c(b,k).total},edges:c,equals:function(b,k){return b.x===k.x&&b.y===k.y},extendBy:function(b,k,d){return f(b.x-Math.cos(k)*d,b.y-Math.sin(k)*d)},floor:function(b){for(var k=Array(b.length),d=b.length;d--;)k[d]=f(~~b[d].x,~~b[d].y);return k},getRect:function(b){for(var k,d,i,
g,m=b.length;m--;){var p=b[m];k=typeof k==="undefined"||p.x<k?p.x:k;d=typeof d==="undefined"||p.y<d?p.y:d;i=typeof i==="undefined"||p.x>i?p.x:i;g=typeof g==="undefined"||p.y>g?p.y:g}return j.init(k,d,g,g)},init:f,invert:function(b){return f(-b.x,-b.y)},offset:function(b,k,d){return f(b.x+k,b.y+(d?d:k))},simplify:function(b,k){if(!b)return null;k=k?k:h.VECTOR_SIMPLIFICATION;for(var d=[],i=null,g=b.length;g--;){var m=b[g];if(include=!i||g===0||Math.abs(m.x-i.x)+Math.abs(m.y-i.y)>k){d.unshift(m);i=m}}return d},
theta:function(b,k,d){d=Math.asin((b.y-k.y)/d);return b.x>k.x?d:Math.PI-d}}}(),l=function(){return{dotProduct:function(a,c){return a.x*c.x+a.y*c.y}}}(),j=function(){function a(c,f,b,k){c=c?c:0;f=f?f:0;b=b?b:c;k=k?k:k;return{x1:c,y1:f,x2:b,y2:k,width:b-c,height:k-f}}return{center:function(c){return h.init(c.x1+c.width/2,c.y1+c.height/2)},copy:function(c){return a(c.x1,c.y1,c.x2,c.y2)},diagonalSize:function(c){return Math.sqrt(c.width*c.width+c.height*c.height)},fromCenter:function(c,f,b,k){b=~~(b/
2);k=~~(k/2);return a(c-b,f-k,c+b,f+k)},init:a}}(),e=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return h.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,c){a=a?a:0;return{width:a,height:c?c:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:h,XYRect:j,Vector:function(a,c){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return h.init(a,c)},V:COG.extend(h,l),D:e}}();
(function(){function h(){for(;w.length>0;){var n=w.shift();document.location=n}p=0}function l(n){for(var o=true,v=z.length;v--;)o=o&&n!=z[v];return o}function j(n,o){var v=[];for(var t in o)t&&v.push(t+"="+escape(o[t]));return"tile5://"+n+"/"+(v.length>0?"?"+v.join("&"):"")}function e(n,o){l(n)&&COG.Log.info("would push url: "+j(n,o))}function a(n,o){if(l(n)){w.push(j(n,o));p||(p=setTimeout(h,100))}}function c(n){return function(o,v,t){(t?t:n?document.body:document).addEventListener(o,v,false)}}function f(n){return function(o,
v,t){(t?t:n?document.body:document).removeEventListener(o,v,false)}}function b(n,o,v){(v?v:document).attachEvent("on"+n,o)}function k(n,o,v){(v?v:document).detachEvent("on"+n,o)}function d(){i={base:{name:"Unknown",bindEvent:c(),unbindEvent:f(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:k,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:f(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[i.froyo,i.android,i.ipod,i.iphone,i.ipad,i.ie]}var i=null,g=[],m=null,p=0,w=[],z=["view.wake","tile.loaded"];T5.getConfig=function(){i||d();if(!m){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var n=0;n<g.length;n++){var o=g[n];if(o.regex&&o.regex.test(navigator.userAgent)){m=T5.ex({},i.base,o);COG.Log.info("PLATFORM DETECTED AS: "+m.name);break}}if(!m){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
m=i.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return m}})();
T5.Dispatcher=function(){var h=[],l={execute:function(j){var e=l.findAction(j);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(j){for(var e=h.length;e--;)if(h[e].id==j)return h[e];return null},getRegisteredActions:function(){return[].concat(h)},getRegisteredActionIds:function(){for(var j=[],e=h.length;e--;)h[e].id&&j.push(h[e].id);return j},registerAction:function(j){j&&j.id&&h.push(j)},Action:function(j){j=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},j);var e={id:j.id,execute:function(){j.execute&&j.execute.apply(this,arguments)},getParam:function(a){return j[a]?j[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,j.title,j.icon)}};j.autoRegister&&l.registerAction(e);return e},Agent:function(j){j=COG.extend({name:"Untitled",translator:null,execute:null},j);var e={getName:function(){return j.name},getParam:function(a){return j[a]},getId:function(){return COG.toID(e.getName())},run:function(a,c){if(j.execute){var f=
j.translator?j.translator(a):a;j.execute.call(e,f,function(b,k){c&&c(b,k,f)})}}};return e},runAgents:function(j,e,a){for(var c=0;c<j.length;c++)j[c].run(e,a)}};return l}();
T5.Resources=function(){var h="",l={},j={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:h+e},setBasePath:function(e){h=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var a=function(c){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(c)})};e.cacheable&&l[e.filename]?a(l[e.filename]):COG.xhr({url:j.getPath(e.filename),dataType:e.dataType,success:function(c){if(e.cacheable)l[e.filename]=c;a(c)},error:function(c,f,b){COG.Log.error("error loading resource ["+
e.filename+"], error = "+b)}})},loadSnippet:function(e,a){/\.\w+$/.test(e)||(e+=".html");j.loadResource({filename:"snippets/"+e,callback:a,dataType:"html"})}};return j}();
T5.Images=function(){function h(){if(!p){var n=T5.getConfig().maxImageLoads;p=COG.Loopage.join({execute:function(o,v){if(!n||i.length<n){var t=d.shift();if(t){i[i.length]=t;t.image.onload=j;t.image.src=T5.Resources.getPath(t.url);t.requested=T5.ticks()}else v.trigger("complete")}},frequency:10});p.bind("complete",function(){p=null})}}function l(){w=true;try{var n=g.length/2>>0;if(n>0){g.sort(function(v,t){return v.created-t.created});for(var o=n;o--;)delete c[g[o].url];g.splice(0,n)}}finally{w=false}COG.say("imagecache.cleared")}
function j(){var n=b[this.id],o;if(n&&n.image.complete&&n.image.width>0){n.loaded=true;n.hitCount=1;for(o=i.length;o--;)if(i[o].image.src==this.src){i.splice(o,1);break}if(n.background||n.postProcess||n.drawBackground||n.customDraw)if(n.image){o=a(n.realSize?n.realSize.width:image.width,n.realSize?n.realSize.height:image.height);var v=o.getContext("2d"),t=n.offset?n.offset:T5.XY.init();n.background&&v.drawImage(n.background,0,0);n.drawBackground&&n.drawBackground(v);n.customDraw?n.customDraw(v,n):
v.drawImage(n.image,t.x,t.y);n.postProcess&&n.postProcess(v,n);n.image=o}for(o=n.callbacks.length;o--;)n.callbacks[o]&&n.callbacks[o](this,false);n.callbacks=[];g[g.length]={url:this.src,created:n.requested};delete b[this.id];h()}}function e(n,o,v){var t=c[n];if(t){t.hitCount++;t.image.complete&&t.image.width>0&&o?o(t.image,true):t.callbacks.push(o)}else{t=T5.ex({url:n,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[o]},v);t.image.id="resourceLoaderImage"+k++;
c[n]=t;b[t.image.id]=t;d[d.length]=t;h()}return t}function a(n,o){var v=document.createElement("canvas");v.width=n?n:0;v.height=o?o:0;if(typeof FlashCanvas!=="undefined"){v.id="tmpCanvas"+f++;v.style.cssText="position: absolute; top: -"+(o-1)+"px; left: -"+(n-1)+"px;";document.body.appendChild(v);FlashCanvas.initElement(v)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(v);return v}var c={},f=0,b={},k=0,d=[],i=[],g=[],m=0,p=null,w=false,z={avgImageSize:25,loadTimeout:10,cancelLoad:function(){i=
[]},get:function(n,o,v){var t=null,J=null;w||(t=c[n]);if((J=t?t.image:null)&&(J.getContext||J.complete&&J.width>0))return J;else o&&e(n,o,v);return null},load:e,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:i.length,queuedImageCount:d.length,imageCacheFullness:m}}};COG.Loopage.join({execute:function(n){for(var o=false,v=0,t=T5.getConfig();v<i.length;)if(n-i[v].requested>z.loadTimeout*1E3){i.splice(v,1);o=true}else v++;o&&h();if(t&&t.imageCacheMaxSize){m=g.length*z.avgImageSize/
t.imageCacheMaxSize;m>=1&&l()}},frequency:2E4});return z}();T5.Generator=function(){var h={};return{init:function(l,j){var e=h[l];if(!e)throw Error("Unable to locate requested generator: "+l);return new e(j)},register:function(l,j){h[l]=j},Template:function(){}}}();
T5.TimeLord=function(){var h=/^P(\d+Y)?(\d+M)?(\d+D)?$/,l=/^(\d+H)?(\d+M)?(\d+S)?$/,j=function(a,c){return{days:a?a:0,seconds:c?c:0}},e={8601:function(a){a=a.split("T");var c=null;c=null;var f=0,b=0;h.lastIndex=-1;c=h.exec(a[0]);f+=c[3]?parseInt(c[3].slice(0,-1),10):0;l.lastIndex=-1;c=l.exec(a[1]);b+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;b+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;b+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new j(f,b)}};return{Duration:j,addDuration:function(){for(var a=new j,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var f=c?e[c]:null;if(f)return f(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new j},formatDuration:function(a){var c,f,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){f=Math.round(a/60);a-=f*60}if(c)b=b+c+(c>1?" hrs ":" hr ")+
(f?(f>10?f:"0"+f)+" min ":"");else if(f)b=b+f+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
(function(){var h=Math.PI*2,l=Math.PI/2,j=Math.abs,e=Math.pow,a=Math.sin,c=Math.asin,f=Math.cos,b=1.70158,k={linear:function(d,i,g,m){return g*d/m+i},backin:function(d,i,g,m){return g*(d/=m)*d*((b+1)*d-b)+i},backout:function(d,i,g,m){return g*((d=d/m-1)*d*((b+1)*d+b)+1)+i},backinout:function(d,i,g,m){return(d/=m/2)<1?g/2*d*d*(((b*=1.525)+1)*d-b)+i:g/2*((d-=2)*d*(((b*=1.525)+1)*d+b)+2)+i},bouncein:function(d,i,g,m){return g-k.bounceout(m-d,0,g,m)+i},bounceout:function(d,i,g,m){return(d/=m)<1/2.75?
g*7.5625*d*d+i:d<2/2.75?g*(7.5625*(d-=1.5/2.75)*d+0.75)+i:d<2.5/2.75?g*(7.5625*(d-=2.25/2.75)*d+0.9375)+i:g*(7.5625*(d-=2.625/2.75)*d+0.984375)+i},bounceinout:function(d,i,g,m){return d<m/2?k.bouncein(d*2,0,g,m)/2+i:k.bounceout(d*2-m,0,g,m)/2+g/2+i},cubicin:function(d,i,g,m){return g*(d/=m)*d*d+i},cubicout:function(d,i,g,m){return g*((d=d/m-1)*d*d+1)+i},cubicinout:function(d,i,g,m){if((d/=m/2)<1)return g/2*d*d*d+i;return g/2*((d-=2)*d*d+2)+i},elasticin:function(d,i,g,m,p,w){if(d==0)return i;if((d/=
m)==1)return i+g;w||(w=m*0.3);if(!p||p<j(g)){p=g;g=w/4}else g=w/h*c(g/p);return-(p*e(2,10*(d-=1))*a((d*m-g)*h/w))+i},elasticout:function(d,i,g,m,p,w){var z;if(d==0)return i;if((d/=m)==1)return i+g;w||(w=m*0.3);if(!p||p<j(g)){p=g;z=w/4}else z=w/h*c(g/p);return p*e(2,-10*d)*a((d*m-z)*h/w)+g+i},elasticinout:function(d,i,g,m,p,w){var z;if(d==0)return i;if((d/=m/2)==2)return i+g;w||(w=m*0.3*1.5);if(!p||p<j(g)){p=g;z=w/4}else z=w/h*c(g/p);if(d<1)return-0.5*p*e(2,10*(d-=1))*a((d*m-z)*h/w)+i;return p*e(2,
-10*(d-=1))*a((d*m-z)*h/w)*0.5+g+i},quadin:function(d,i,g,m){return g*(d/=m)*d+i},quadout:function(d,i,g,m){return-g*(d/=m)*(d-2)+i},quadinout:function(d,i,g,m){if((d/=m/2)<1)return g/2*d*d+i;return-g/2*(--d*(d-2)-1)+i},sinein:function(d,i,g,m){return-g*f(d/m*l)+g+i},sineout:function(d,i,g,m){return g*a(d/m*l)+i},sineinout:function(d,i,g,m){return-g/2*(f(Math.PI*d/m)-1)+i}};T5.easing=function(d){return k[d.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(d,i){k[d.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=i}})();
T5.Tween=function(h){h=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},h);var l=T5.ticks(),j=[],e=false,a=0,c=0,f={cancelOnInteract:h.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(b){h.complete&&h.complete(b)},update:function(b){try{var k=h.tweenFn(b-l,a,c,h.duration);if(h.target)h.target[h.property]=k;for(var d=j.length;d--;)j[d](k,void 0);if(e=l+h.duration<=b){if(h.target)h.target[h.property]=
h.tweenFn(h.duration,a,c,h.duration);for(var i=j.length;i--;)j[i](k,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(b){j.push(b)}};a=h.target&&h.property&&h.target[h.property]?h.target[h.property]:h.startValue;if(typeof h.endValue!=="undefined")c=h.endValue-a;if(c==0)e=true;T5.wakeTweens();return f};
(function(){function h(a){if(e)return l.length;e=true;try{for(var c=0;c<l.length;)if(l[c].isComplete()){l[c].triggerComplete(false);l.splice(c,1)}else{l[c].update(a);c++}}finally{e=false}l.length===0&&j.trigger("complete");return l.length}var l=[],j=null,e=false;T5.tweenValue=function(a,c,f,b,k){a=new T5.Tween({startValue:a,endValue:c,tweenFn:f,complete:b,duration:k});l.push(a);return a};T5.tween=function(a,c,f,b,k,d){a=new T5.Tween({target:a,property:c,endValue:f,tweenFn:b,duration:d,complete:k});
l.push(a);return a};T5.tweenVector=function(a,c,f,b,k,d){var i=[];if(a){var g=a.x==c,m=a.y==f;g||i.push(T5.tween(a,"x",c,b,function(){(g=true)&&m&&k()},d));m||i.push(T5.tween(a,"y",f,b,function(){m=true;g&&m&&k()},d))}return i};T5.cancelAnimation=function(a){if(!e){e=true;try{for(var c=0;c<l.length;)if(!a||a(l[c])){l[c].triggerComplete(true);l.splice(c,1)}else c++}finally{e=false}}};T5.isTweening=function(){return l.length>0};T5.wakeTweens=function(){if(!j){j=COG.Loopage.join({execute:h,frequency:20});
j.bind("complete",function(){j=null})}}})();(function(){var h={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,PINCH:16,FREEZE:128};T5.viewState=function(){for(var l=0,j=arguments.length;j--;){var e=h[arguments[j].toUpperCase()];if(e)l|=e}return l}})();
T5.ViewLayer=function(h){h=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","PINCH")},h);var l=null,j=false,e=false,a=h.supportFastDraw,c=h.id,f=T5.viewState("ACTIVE"),b=h.validStates,k=0,d=0,i=T5.ex({addToView:function(g){g.setLayer(c,i)},shouldDraw:function(g,m,p){g=(g&b)!==0&&(j?a:true);return g=e||p||k!==m.x||d!==m.y},cycle:function(){},draw:function(){},remove:function(){i.trigger("remove",i)},changed:function(){e=true;i.trigger("changed",
i);l&&l.trigger("invalidate")},getId:function(){return c},setId:function(g){c=g},getParent:function(){return l},setParent:function(g){j=(l=g)?l.fastDraw&&displayState!==f:false;i.trigger("parentChange",l)}},h);COG.observable(i);i.bind("drawComplete",function(g,m){e=false;k=m.x;d=m.y});return i};
T5.View=function(h){function l(q,r,y,G){V=Q;v();if(G&&h.inertia){T=true;d(M+r,u+y,h.panAnimationEasing,h.panAnimationDuration)}else G||d(M+r,u+y)}function j(){V=pa;T=false;COG.Loopage.join({execute:v,after:50,single:true})}function e(q,r){X=s(q);Z=s(r);var y=x(X),G=x(Z);ca=D(X);L=D(Z);F=X&&y!==0?G/y:1}function a(q,r,y){e(r,y);if(W=F!==1){V=ea;v()}}function c(q,r,y,G){e(r,y);if(h.adjustScaleFactor){F=h.adjustScaleFactor(F);COG.Log.info("scale factor adjusted to: "+F)}if(G<h.pinchZoomAnimateTrigger){m(ia,
F,ca,p(),T5.easing("sine.out"),function(){b();F=1},300);F=ia}else{b();F=1}}function f(q,r,y){C.zoom(r,Math.min(Math.pow(2,Math.round(Math.log(y))),8),500)}function b(){var q=X?p():L;F=Math.round(F*10)/10;W=false;for(var r=t.length;r--;)t[r].trigger("scale",F,q);C.trigger("scale",F,q);V=pa;v()}function k(){clearTimeout(U);U=setTimeout(i,50)}function d(q,r,y,G,H){function N(){S+=1;if(S>=2){j(0,0);H&&H()}}var S=0;if(y){q=T5.tweenValue(M,q,y,N,G);r=T5.tweenValue(u,r,y,N,G);q.cancelOnInteract=true;q.requestUpdates(function(fa){M=
fa;T=true;v()});r.cancelOnInteract=true;r.requestUpdates(function(fa){u=fa;T=true;v()})}else{M=q;u=r}}function i(){var q;if(B){COG.Touch.release(B);if(h.autoSize&&B.parentNode){q=B.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){B.height=q.height;B.width=q.width}}try{if(!B.id)B.id=h.id+"_canvas";la=B.getContext("2d");la.clearRect(0,0,B.width,B.height)}catch(r){COG.Log.exception(r);throw Error("Could not initialise canvas on specified view element");}oa=COG.Touch.capture(B,{observable:C});
if(K.height!==B.height||K.width!==B.width){K=T5.D.init(B.width,B.height);C.trigger("resize",B.width,B.height);for(q=J;q--;)t[q].trigger("resize",B.width,B.height)}h.inertia&&oa.inertiaEnable(h.panAnimationDuration,K);for(q=J;q--;)t[q].trigger("contextChanged",la);o()}}function g(q,r){r.setId(q);r.added=T5.ticks();r.bind("remove",function(){C.removeLayer(q)});r.trigger("contextChanged",la);r.setParent(C);t.push(r);t.sort(function(y,G){var H=G.zindex-y.zindex;if(H===0)H=G.added-y.added;return H});J=
t.length;return r}function m(q,r,y,G,H,N,S){function fa(){N&&N();b();F=1;P=null}W=true;ca=T5.XY.copy(y);L=T5.XY.copy(G);X=null;if(H)T5.tweenValue(0,r-q,H,fa,S?S:1E3).requestUpdates(function(ma){P=ma/(r-q);F=q+ma;V=ea;v();C.trigger("animate")});else{F=targetScaleFactor;fa()}}function p(){var q=T5.D.getCenter(K),r=T5.XY.distance([L,q]);q=T5.XY.theta(L,q,r);var y=T5.XY.diff(ca,L);q=T5.XY.extendBy(L,q,r/F);q.x+=y.x;q.y+=y.y;return q}function w(){C.trigger("idle",C);ha=true;ba=0}function z(q,r,y,G,H){if(O)r=
T5.viewState("FROZEN");var N=(r&ea)!==0,S=0;if(na||N){q.clearRect(0,0,B.width,B.height);na=false}if(N){T5.D.getCenter(K);var fa=(P?P:1)/2,ma=T5.XY.diff(ca,L);if(X){I.x=L.x+ma.x;I.y=L.y+ma.y}else{I.x=L.x-ma.x*fa;I.y=L.y-ma.y*fa}}q.save();try{ia=F;q.translate(-y.x1,-y.y1);if(ga!==1)q.scale(ga,ga);else if(N){q.translate(L.x,L.y);q.scale(F,F)}for(S=J;S--;)if(t[S].shouldDraw(r,y,G)){t[S].draw(q,y,r,C,G,H);t[S].trigger("drawComplete",y,H)}}finally{q.restore()}C.trigger("drawComplete",y,H);COG.Log.trace("draw complete",
H)}function n(q,r){var y=false,G=$?$:T?Q:V,H=!T&&(G===ea||G===Q),N=aa||G===Q||G===ea||T5.isTweening();A=T5.XY.init(M>>0,u>>0);E=T5.XYRect.fromCenter(A.x,A.y,K.width,K.height);if(H){T5.cancelAnimation(function(S){return S.cancelOnInteract});ha=false;if(ba!==0){clearTimeout(ba);ba=0}}for(H=J;H--;){if(t[H].animated)V|=ka;y=t[H].cycle(q,E,V,N)||y}N=N||(V&ka)!==0;if(y=y||N||F!==1&&F!==ja){z(la,G,E,N,q);ja=F;aa=false}if(!y&&qa===0&&!sa){if(!ha&&ba===0)ba=setTimeout(w,500);r.trigger("complete")}qa=0;COG.Log.trace("Completed draw cycle",
q)}function o(){aa=true;v()}function v(){qa+=1;if(!(O||da)){da=COG.Loopage.join({execute:n,frequency:ra});da.bind("complete",function(){da=null})}}h=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},h);var t=[],J=0,B=document.getElementById(h.container),la=null,M=0,u=0,A=null,E=null,na=false,da=null,O=
false,ga=1,K=T5.D.init(),qa=0,L=null,ha=false,T=false,ba=0,Y=0,I=T5.XY.init(),R=0,W=false,X=null,Z=null,$=null,aa=false,U=0,F=1,ja=0,ia=1,P=null,ca=null,sa=typeof FlashCanvas!=="undefined",ra=~~(1E3/h.fps),oa=null,pa=T5.viewState("ACTIVE"),Q=T5.viewState("PAN"),ea=T5.viewState("PINCH"),ka=T5.viewState("ANIMATING"),V=pa,s=T5.XY.getRect,x=T5.XYRect.diagonalSize,D=T5.XYRect.center,C={id:h.id,deviceScaling:ga,fastDraw:h.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,r,y,G,H){m(F,q,r,y,G,
H)},centerOn:function(q){M=q.x-B.width/2;u=q.y-B.height/2},getDimensions:function(){return K},getZoomCenter:function(){return I},getLayer:function(q){for(var r=0;r<J;r++)if(t[r].getId()==q)return t[r];return null},setLayer:function(q,r){for(var y=0;y<J;y++)if(t[y].getId()===q){t.splice(y,1);break}r&&g(q,r);o()},eachLayer:function(q){for(var r=J;r--;)q(t[r])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");na=true;o()},invalidate:o,freeze:function(){O=true},unfreeze:function(){O=
false;v()},resize:function(q,r){if(B){h.autoSize=false;B.width=q;B.height=r;i();C.trigger("resize",B.width,B.height)}},scale:function(q,r,y,G,H){G||(G=T5.D.getCenter(K));H||(H=T5.D.getCenter(K));C.animate(q,G,H,r,y);return C},removeLayer:function(q){a:{for(var r=J;r--;)if(t[r].getId()==q){q=r;break a}q=-1}if(q>=0&&q<J){COG.say("layer.removed",{layer:t[q]});t.splice(q,1);o()}J=t.length},stateOverride:function(q){$=q},getOffset:function(){return A?A:T5.XY.init(M,u)},getOffsetRect:function(){return E?
E:T5.XYRect.fromCenter(M,u,K.width,K.height)},updateOffset:d,zoom:function(q,r,y){T=false;F=r;W=F!==1;ca=T5.D.getCenter(K);L=F>1?T5.XY.copy(q):T5.D.getCenter(K);X=null;clearTimeout(Y);if(W){V=ea;v();if(y)Y=setTimeout(function(){b();F=1},parseInt(y,10))}}};ga=T5.getConfig().getScaling();C.markers=g("markers",new T5.MarkerLayer);COG.observable(C);C.bind("wake",v);C.bind("invalidate",o);if(h.pannable){C.bind("pan",l);C.bind("panEnd",j);C.bind("inertiaCancel",function(){T=false;v()})}if(h.scalable){C.bind("pinchZoom",
a);C.bind("pinchZoomEnd",c);C.bind("wheelZoom",f)}C.bind("tap",function(q,r,y){for(var G=T5.XY.offset(y,M,u),H=t.length;H--;)q.cancel=q.cancel||t[H].trigger("tap",r,y,G).cancel});COG.configurable(C,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(h,null,{container:function(q,r){B=document.getElementById(r);i()},rotation:function(q,r){R=r}}),true);i();h.autoSize&&window.addEventListener("resize",k,false);return C};
T5.PathLayer=function(h){function l(i){i.syncVectors(c);f&&i.syncVectors(f);d.trigger("tidy")}h=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},h);var j=false,e=[],a=null,c=[],f=null,b=0,k=[],d=T5.ex(new T5.ViewLayer(h),{getAnimation:function(i,g,m,p){var w="pathAnimation"+b++;k.push(w);return new T5.AnimatedPathLayer({id:w,path:e,zindex:h.zindex+1,easing:i?i:T5.easing("sine.inout"),duration:g?g:5E3,drawIndicator:m,autoCenter:p?p:false})},cycle:function(i,g,m,p){return p},draw:function(i,
g){var m,p=e.length;i.save();try{T5.applyStyle(i,h.style);if(p>0){i.beginPath();i.moveTo(e[p-1].x-g.x,e[p-1].y-g.y);for(m=p;m--;)i.lineTo(e[m].x-g.x,e[m].y-g.y);i.stroke();if(a){i.fillStyle=h.waypointFillStyle;for(m=a.length;m--;){i.beginPath();i.arc(a[m].x-g.x,a[m].y-g.y,2,0,Math.PI*2,false);i.stroke();i.fill()}}}}finally{i.restore()}j=false},updateCoordinates:function(i,g){var m=d.getParent();m=m?m.getTileLayer():null;c=i;f=g;COG.Log.info("updating coordinates, grid = "+m);m&&l(m)}});d.bind("gridUpdate",
function(i,g){l(g);for(var m=k.length;m--;)COG.say("layer.remove",{id:k[m]});k=[]});d.bind("tidy",function(){e=T5.XY.simplify(c,h.pixelGeneralization);a=T5.XY.simplify(f,h.pixelGeneralization);j=true;d.changed()});return d};
T5.ShapeLayer=function(h){function l(c){for(var f=j.length;f--;)j[f].resync(c);j.sort(function(b,k){var d=k.xy.y-b.xy.y;if(d===0)d=k.xy.x-b.xy.y;return d});e=true;a.changed()}h=T5.ex({zindex:80,style:null},h);var j=[],e=false,a=T5.ex(new T5.ViewLayer(h),{add:function(c){j[j.length]=c},each:function(c){for(var f=j.length;f--;)c(j[f])},cycle:function(){return e},draw:function(c,f,b){var k=f.x1,d=f.y1,i=f.width;f=f.height;c.save();try{T5.applyStyle(c,h.style);for(var g=j.length;g--;){var m=j[g].style,
p=m?T5.applyStyle(c,m):null;j[g].draw(c,k,d,i,f,b);p&&T5.applyStyle(c,p)}}finally{c.restore()}e=false}});a.bind("parentChange",function(c,f){f.syncVectors&&l(f)});COG.configurable(a,["style"],COG.paramTweaker(h,null,null),true);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(h){h=T5.ex({style:null,properties:{}},h);return T5.ex(h,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(h,l){l=T5.ex({size:4},l);var j=T5.XY.init(),e=T5.ex(l,{draw:function(a){a.beginPath();a.arc(j.x,j.y,e.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncVectors([h]);j=T5.XY.floor([h])[0]}});COG.Log.info("created arc = ",h);return e};
T5.Poly=function(h,l){l=T5.ex({fill:false,simplify:false},l);var j=false,e=l.fill,a=l.simplify,c=T5.viewState("PINCH"),f=[],b=T5.ex(new T5.Shape(l),{draw:function(k,d,i,g,m,p){if(j){d=true;i=(p&c)!==0;k.beginPath();for(p=f.length;p--;){i=f[p].x;g=f[p].y;if(d){k.moveTo(i,g);d=false}else k.lineTo(i,g);i=true}if(i){e&&k.fill();k.stroke()}}},resync:function(k){b.xy=k.syncVectors(h);f=T5.XY.floor(a?T5.XY.simplify(h):h)}});j=h&&h.length>=2;return b};
T5.AnimatedPathLayer=function(h){function l(b,k,d){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(d.x,d.y,4,0,Math.PI*2,false);b.stroke();b.fill()}h=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","PINCH"),drawIndicator:null,duration:2E3,autoCenter:false},h);var j=T5.XY.edges(h.path),e,a=null,c=0;T5.tweenValue(0,j.total,h.easing,function(){f.remove()},h.duration).requestUpdates(function(b,k){c=b;k&&f.remove()});var f=
T5.ex(new T5.ViewLayer(h),{cycle:function(){for(var b=0;b<j.accrued.length&&j.accrued[b]<c;)b++;a=null;if(b<h.path.length-1){var k=c-(b>0?j.accrued[b-1]:0),d=h.path[b];e=T5.XY.theta(d,h.path[b+1],j.edges[b]);a=T5.XY.extendBy(d,e,k);if(h.autoCenter)(b=f.getParent())&&b.centerOn(a)}return a},draw:function(b,k){if(a)(h.drawIndicator?h.drawIndicator:l)(b,k,T5.XY.init(a.x-k.x,a.y-k.y),e)}});return f};
T5.Marker=function(h){function l(k,d,i,g){e=k;a=d;c=i;f=g}h=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},h);var j=false,e=0,a=0,c=0,f=0,b=T5.ex(h,{isNew:true,isAnimating:function(){return j},draw:function(k,d,i,g,m){if(b.isNew&&h.tweenIn){var p=b.xy.y;b.xy.y=d.y-20;j=true;T5.tween(b.xy,"y",p,h.tweenIn,function(){b.xy.y=p;j=false},h.animationSpeed?h.animationSpeed:250+Math.random()*500)}b.drawMarker(k,d,b.xy.x,b.xy.y,i,g,m);b.isNew=false},drawMarker:function(k,d,i,g){k.beginPath();
k.arc(i,g,4,0,Math.PI*2,false);k.fill();l(i-4,g-4,8,8)},hitTest:function(k,d){return k>=e&&k<=e+c&&d>=a&&d<=a+f},updateBounds:l});COG.observable(b);return b};
T5.ImageMarker=function(h){h=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},h);var l=h.imageAnchor?T5.XY.invert(h.imageAnchor):null,j=T5.ex(new T5.Marker(h),{drawMarker:function(e,a,c,f){if((a=j.isAnimating()&&j.animatingImage?j.animatingImage:j.image)&&a.complete&&a.width>0){l||(l=T5.XY.init(-a.width>>1,-a.height>>1));var b=j.scale,k=c+~~(l.x*b),d=f+~~(l.y*b),i=~~(a.width*b),g=~~(a.height*b);j.updateBounds(k,d,i,i);if(j.rotation||
j.opacity!==1){e.save();try{e.globalAlpha=j.opacity;e.translate(c,f);e.rotate(j.rotation);e.drawImage(a,l.x*b,l.y*b,i,g)}finally{e.restore()}}else e.drawImage(a,k,d,i,g)}}});if(!j.image)j.image=T5.Images.get(h.imageUrl,function(e){COG.Log.info("updating marker image to: "+e.src);j.image=e});if(!j.animatingImage)j.animatingImage=T5.Images.get(h.animatingImageUrl,function(e){j.animatingImage=e});return j};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(h){function l(){c.changed();c.trigger("markerUpdate",e)}function j(){var f=c.getParent();if(f&&f.syncVectors)for(var b=e.length;b--;)f.syncVectors([e[b].xy])}h=T5.ex({zindex:100},h);var e=[],a=false,c=T5.ex(new T5.ViewLayer(h),{cycle:function(){return a},draw:function(f,b,k,d){a=false;for(var i=e.length;i--;){e[i].draw(f,b,k,c,d);a=a||e[i].isAnimating()}return a?1:0},add:function(f){if(f&&typeof f.length!=="undefined")for(var b=f.length;b--;){if(f[b])e[e.length]=f[b]}else if(f)e[e.length]=
f;l()},clear:function(f){if(f)for(var b=0;b<e.length;b++)f(e[b])&&e.splice(b,1);else e=[];l()},find:function(f){for(var b=[],k=e.length;k--;)if(!f||f(e[k]))b[b.length]=e[k];return b}});c.bind("tap",function(f,b,k){for(var d=[],i=k.x,g=k.y,m=e.length;m--;)if(e[m].hitTest(i,g))d[d.length]=e[m];if(d.length>0)f.cancel=c.trigger("markerTap",b,k,d).cancel});c.bind("gridUpdate",function(f,b){for(var k=e.length;k--;)b.syncVectors([e[k].xy])});c.bind("parentChange",j);c.bind("changed",j);return c};
T5.ImageLayer=function(h,l){function j(i){c.run(i,function(g){f=g;(g=d.getParent())&&g.trigger("invalidate")});k=T5.XYRect.copy(i)}function e(){var i=d.getParent();i&&i.trigger("invalidate")}function a(){j(b)}l=T5.ex({},l);var c=T5.Generator.init(h,l),f=null,b=T5.XYRect.init(),k=T5.XYRect.init(),d=T5.ex(new T5.ViewLayer(l),{cycle:function(i,g){(Math.abs(g.x1-k.x1)>g.width||Math.abs(g.y1-k.y1)>g.height)&&j(g)},draw:function(i,g){i.save();try{i.strokeStyle="#555";if(f)for(var m=f.length;m--;){var p=
i,w=f[m],z=T5.Images.get(w.url,e);if(z)p.drawImage(z,w.x,w.y,z.width,z.height);else{p.fillStyle="#777";p.fillRect(w.x,w.y,w.width,w.height)}}}finally{i.restore()}i.strokeStyle="#f00";i.beginPath();i.moveTo(g.x1+g.width/2,g.y1);i.lineTo(g.x1+g.width/2,g.y2);i.moveTo(g.x1,g.y1+g.height/2);i.lineTo(g.x2,g.y1+g.height/2);i.stroke();b=T5.XYRect.copy(g)}});d.bind("parentChange",function(i,g){c.bindToView(g);g.bind("idle",a)});return d};
T5.Style=function(h){function l(c){var f=h[c];typeof f!=="undefined"&&j.push(function(b){b[c]=f})}h=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},h);var j=[],e={applyToContext:function(c){for(var f=j.length;f--;)j[f](c)}};for(var a in h)l(a);return e};
(function(){var h={},l={basic:new T5.Style({lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),waypoints:new T5.Style({lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"})};T5.applyStyle=function(j,e){var a=T5.styles[e]?T5.styles[e]:T5.styles.basic,c;if(j&&j.canvas){c=h[j.canvas.id];h[j.canvas.id]=e}a.applyToContext(j);return c};T5.loadStyles=function(j){COG.jsonp(j,function(e){T5.resetStyles(e)})};T5.resetStyles=function(j){var e={};for(var a in j)e[a]=new T5.Style(j[a]);T5.styles=T5.ex({},
l,e)};T5.styles=l})();(function(){T5.tileSize=256;T5.Tile=function(h){return h=T5.ex({x:0,y:0,gridX:0,gridY:0,dirty:true},h)};T5.EmptyTile=function(h){h=new T5.Tile(h);h.empty=true;return h};T5.ImageTile=function(h){h=T5.ex({url:"",sessionParamRegex:null,loading:false,loaded:false},h);return new T5.Tile(h)}})();T5.TileGenerator=function(){};
