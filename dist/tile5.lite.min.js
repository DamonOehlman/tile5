COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var G=arguments[0]||{},Q,B=1,s=arguments.length;B<s;B++)if((Q=arguments[B])!==null)for(var f in Q){var g=Q[f];if(G!==g)if(g!==undefined)G[f]=g}return G};
(function(){var G=Object.prototype.hasOwnProperty,Q=0,B={};B.toID=function(s){return s.replace(/\s/g,"-")};B.objId=function(s){return(s?s:"obj")+Q++};B.isFunction=function(s){return toString.call(s)==="[object Function]"};B.isArray=function(s){return toString.call(s)==="[object Array]"};B.isPlainObject=function(s){if(!s||toString.call(s)!=="[object Object]"||s.nodeType||s.setInterval)return false;if(s.constructor&&!G.call(s,"constructor")&&!G.call(s.constructor.prototype,"isPrototypeOf"))return false;
var f;for(f in s);return f===undefined||G.call(s,f)};B.isEmptyObject=function(s){for(var f in s)return false;return true};B.isXmlDocument=function(s){return toString.call(s)==="[object Document]"};B.contains=function(s,f){var g=s,n=arguments,u=1;if(f&&module.isArray(f)){n=f;u=0}for(u=u;u<n;u++)g=g&&typeof foo[n[u]]!=="undefined";return g};B.formatStr=function(s){if(arguments.length<=1)return s;for(var f=arguments.length-2,g=0;g<=f;g++)s=s.replace(RegExp("\\{"+g+"\\}","gi"),arguments[g+1]);return s};
B.wordExists=function(s,f){var g="";if(f.toString)f=f.toString();for(var n=0;n<f.length;n++)g+=!/\w/.test(f[n])?"\\"+f[n]:f[n];return RegExp("(^|\\s|\\,)"+g+"(\\,|\\s|$)","i").test(s)};COG.extend(COG,B)})();
(function(){function G(g){return typeof console!=="undefined"?function(){console[g](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var Q=window.console&&window.console.markTimeline,B=G("error"),s=G("info"),f=function(){return Q?function(g,n){console.markTimeline(g+(n?": "+((new Date).getTime()-n)+"ms":""))}:function(){}}();COG.extend(COG,{trace:f,debug:G("debug"),info:s,warn:G("warn"),error:B,exception:function(g){if(B)for(var n in g)s("ERROR DETAIL: "+n+
": "+g[n])}})})();
(function(){function G(B,s){var f=B.hasOwnProperty("obsHandlers")?B.obsHandlers:null;f[s]||(f[s]=[]);return f[s]}var Q=0;COG.observable=function(B){if(!B)return null;if(!(B.hasOwnProperty("obsHandlers")?B.obsHandlers:null))B.obsHandlers={};if(!(B.bind||B.trigger||B.unbind)){B.bind=function(s,f){var g="callback"+Q++;G(B,s).unshift({fn:f,id:g});return g};B.triggerCustom=function(s,f){var g=G(B,s),n={cancel:false,name:s,source:this},u;f&&COG.extend(n,f);if(!g)return null;u=Array.prototype.slice.call(arguments,2);
B.eventInterceptor&&B.eventInterceptor(s,n,u);u.unshift(n);for(var H=g.length;H--&&!n.cancel;)g[H].fn.apply(this,u);return n};B.trigger=function(s){var f=Array.prototype.slice.call(arguments,1);f.splice(0,0,s,null);return B.triggerCustom.apply(this,f)};B.unbind=function(s,f){if(typeof s==="undefined")B.obsHandlers={};else for(var g=G(B,s),n=0;g&&n<g.length;n++)if(g[n].id===f){g.splice(n,1);break}return B}}return B}})();
(function(){function G(f,g){f[g]||(f[g]=function(n){return f.configure(g,n)})}function Q(f){f.gtConfId="configurable"+s++;f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var B={},s=0;COG.paramTweaker=function(f,g,n){return function(u,H){if(typeof H!=="undefined"){if(u in f)f[u]=H;n&&u in n&&n[u](u,H)}else return g&&u in g?g[u](u):f[u]}};COG.configurable=function(f,g,n,u){if(f){f.gtConfId||Q(f);var H=f.gtConfId,h=f.gtConfig,z=f.gtConfigFns;B[H]=f;z.push(n);for(n=g.length;n--;){h[g[n]]=true;u&&G(f,
g[n])}if(!f.configure)f.configure=function(t,A){if(h[t]){for(var p=z.length;p--;){var l=z[p](t,A);if(typeof l!=="undefined")return l}return B[H]}return null}}}})();
(function(){function G(f){var g=document.createElement("script"),n=false;g.src=f;g.async=true;g.onload=g.onreadystatechange=function(){if(!n&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){n=true;g.onload=g.onreadystatechange=null;g&&g.parentNode&&g.parentNode.removeChild(g)}};B||(B=document.getElementsByTagName("head")[0]);B.appendChild(g)}var Q=0,B,s=this;COG.jsonp=function(f,g,n){f+=f.indexOf("?")>=0?"&":"?";var u="json"+ ++Q;s[u]=function(H){g(H);s[u]=null;try{delete s[u]}catch(h){}};
G(f+(n?n:"callback")+"="+u);return u}})();
(function(){var G=1.70158,Q=Math.PI/2,B=1E3/60|0,s=Math.abs,f=Math.pow,g=Math.sin,n=Math.asin,u=Math.cos,H={linear:function(h,z,t,A){return t*h/A+z},backin:function(h,z,t,A){return t*(h/=A)*h*((G+1)*h-G)+z},backout:function(h,z,t,A){return t*((h=h/A-1)*h*((G+1)*h+G)+1)+z},backinout:function(h,z,t,A){return(h/=A/2)<1?t/2*h*h*(((G*=1.525)+1)*h-G)+z:t/2*((h-=2)*h*(((G*=1.525)+1)*h+G)+2)+z},bouncein:function(h,z,t,A){return t-H.bounceout(A-h,0,t,A)+z},bounceout:function(h,z,t,A){return(h/=A)<1/2.75?t*
7.5625*h*h+z:h<2/2.75?t*(7.5625*(h-=1.5/2.75)*h+0.75)+z:h<2.5/2.75?t*(7.5625*(h-=2.25/2.75)*h+0.9375)+z:t*(7.5625*(h-=2.625/2.75)*h+0.984375)+z},bounceinout:function(h,z,t,A){return h<A/2?H.bouncein(h*2,0,t,A)/2+z:H.bounceout(h*2-A,0,t,A)/2+t/2+z},cubicin:function(h,z,t,A){return t*(h/=A)*h*h+z},cubicout:function(h,z,t,A){return t*((h=h/A-1)*h*h+1)+z},cubicinout:function(h,z,t,A){if((h/=A/2)<1)return t/2*h*h*h+z;return t/2*((h-=2)*h*h+2)+z},elasticin:function(h,z,t,A,p,l){if(h==0)return z;if((h/=
A)==1)return z+t;l||(l=A*0.3);if(!p||p<s(t)){p=t;t=l/4}else t=l/TWO_PI*n(t/p);return-(p*f(2,10*(h-=1))*g((h*A-t)*TWO_PI/l))+z},elasticout:function(h,z,t,A,p,l){var x;if(h==0)return z;if((h/=A)==1)return z+t;l||(l=A*0.3);if(!p||p<s(t)){p=t;x=l/4}else x=l/TWO_PI*n(t/p);return p*f(2,-10*h)*g((h*A-x)*TWO_PI/l)+t+z},elasticinout:function(h,z,t,A,p,l){var x;if(h==0)return z;if((h/=A/2)==2)return z+t;l||(l=A*0.3*1.5);if(!p||p<s(t)){p=t;x=l/4}else x=l/TWO_PI*n(t/p);if(h<1)return-0.5*p*f(2,10*(h-=1))*g((h*
A-x)*TWO_PI/l)+z;return p*f(2,-10*(h-=1))*g((h*A-x)*TWO_PI/l)*0.5+t+z},quadin:function(h,z,t,A){return t*(h/=A)*h+z},quadout:function(h,z,t,A){return-t*(h/=A)*(h-2)+z},quadinout:function(h,z,t,A){if((h/=A/2)<1)return t/2*h*h+z;return-t/2*(--h*(h-2)-1)+z},sinein:function(h,z,t,A){return-t*u(h/A*Q)+t+z},sineout:function(h,z,t,A){return t*g(h/A*Q)+z},sineinout:function(h,z,t,A){return-t/2*(u(Math.PI*h/A)-1)+z}};COG.tweenValue=function(h,z,t,A,p){function l(U){U=U?U:(new Date).getTime();if(da+B<U){var fa=
U-x,R=t(fa,h,W,A),ea=x+A<=U;U=!ea;if(p){fa=p(R,ea,fa);U=typeof fa!="undefined"?fa&&U:U}U&&animFrame(l)}}var x=(new Date).getTime(),da=0,W=z-h;animFrame(l);return{}};COG.easing=function(h){return H[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(h,z){H[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]=z}})();
(function(){var G=/^P(\d+Y)?(\d+M)?(\d+D)?$/,Q=/^(\d+H)?(\d+M)?(\d+S)?$/,B={8601:function(f){f=f.split("T");var g=null;g=null;var n=0,u=0;G.lastIndex=-1;g=G.exec(f[0]);n+=g[3]?parseInt(g[3].slice(0,-1),10):0;Q.lastIndex=-1;g=Q.exec(f[1]);u+=g[1]?parseInt(g[1].slice(0,-1),10)*3600:0;u+=g[2]?parseInt(g[2].slice(0,-1),10)*60:0;u+=g[3]?parseInt(g[3].slice(0,-1),10):0;return new s(n,u)}},s=COG.Duration=function(f,g){return{days:f?f:0,seconds:g?g:0}};COG.addDuration=function(){for(var f=new s,g=arguments.length;g--;){f.days+=
arguments[g].days;f.seconds+=arguments[g].seconds}if(f.seconds>=86400){f.days+=~~(f.seconds/86400);f.seconds%=86400}return f};COG.formatDuration=function(f){var g,n,u="";if(f.days)u=f.days+" days ";if(f.seconds){f=f.seconds;if(f>=3600){g=~~(f/3600);f-=g*3600}if(f>=60){n=Math.round(f/60);f-=n*60}if(g)u=u+g+(g>1?" hrs ":" hr ")+(n?(n>10?n:"0"+n)+" min ":"");else if(n)u=u+n+" min";else if(f>0)u=u+(f>10?f:"0"+f)+" sec"}return u};COG.parseDuration=function(f,g){var n=g?B[g]:null;if(n)return n(f);COG.Log.warn("Could not find duration parser for specified format: "+
g);return new s}})();COG.ObjectStore=function(){var G={},Q={},B="obj_"+(new Date).getTime(),s=0,f=Object.prototype.hasOwnProperty;return{add:function(g,n){var u;n=n?n:"default";if(g&&g.constructor)if(!f.call(g,"id"))g.id=B+ ++s;u=Q[n]?Q[n]:Q[n]=[];G[g.id]=u.length;u[g.length]=g}}};var CANI={};
(function(G){var Q=[],B=0,s=false,f=G.register=function(g,n){Q.push({section:g,run:n})};G.init=function(g){function n(){if(B<Q.length){var H=Q[B++];u[H.section]||(u[H.section]={});H.run(u[H.section],n)}else{for(H in u)G[H]=u[H];s=true;g&&g(G)}}var u={};if(s&&g)g(G);else{B=0;n()}};f("canvas",function(g,n){function u(){var t,A=H.getContext("2d");A.save();try{A.translate(50,50);A.beginPath();A.rect(0,0,20,20);t=A.isPointInPath(10,10)}finally{A.restore()}return t}var H=document.createElement("canvas"),
h=typeof FlashCanvas!="undefined",z=typeof G_vmlCanvasManager!="undefnined";H.width=200;H.height=200;g.pipTransformed=h||z?false:u();n()})})(CANI);
INTERACT=function(){function G(p){return function(l,x,da){(da?da:p?document.body:document).addEventListener(l,x,false)}}function Q(p){return function(l,x,da){(da?da:p?document.body:document).removeEventListener(l,x,false)}}function B(p,l,x){(x?x:document).attachEvent("on"+p,l)}function s(p,l,x){(x?x:document).detachEvent("on"+p,l)}function f(p,l){return{x:p?p:0,y:l?l:0,count:1}}function g(p,l){t.push(COG.extend({handler:null,checks:{},type:p},l))}function n(p){var l=0,x=0;if(p.offsetParent){do{l+=
p.offsetLeft;x+=p.offsetTop;p=p.offsetParent}while(p)}return{left:l,top:x}}function u(p,l){return{source:p,target:l.target?l.target:l.srcElement}}function H(p,l){for(var x=p.target?p.target:p.srcElement;x&&x!==l&&x.nodeName&&x.nodeName.toUpperCase()!="CANVAS";)x=x.parentNode;return x&&x===l}function h(p,l){return{x:p.x-(l?l.left:0),y:p.y-(l?l.top:0)}}function z(p){if(p.preventDefault){p.preventDefault();p.stopPropagation()}else p.cancelBubble&&p.cancelBubble()}var t=[],A=function(p,l,x){function da(X,
$,aa,K){var S=0,J=0,y=0;COG.tweenValue(0,X,aa,K,function(C){y=S;S=C});COG.tweenValue(0,$,aa,K,function(C){W.trigger("pan",S-y,C-J);J=C})}x=COG.extend({binder:null,unbinder:null,observable:null},x);for(var W=x.observable,U=null,fa=[],R=[],ea,ia,la={bind:function(){return W.bind.apply(null,arguments)},pannable:function(X){U=COG.extend({inertia:true},X);return la},unbind:function(){W.unbind();for(var X=0;X<fa.length;X++)fa[X].unbind();return la}},Ca=0;Ca<l.length;Ca++)fa.push(l[Ca](p,W,x));W.bind("pointerDown",
function(){R=[];ia=ea=0});W.bind("pointerMove",function(X,$,aa,K){if(U){R[R.length]={ticks:(new Date).getTime(),x:K.x,y:K.y};W.trigger("pan",K.x,K.y)}ea+=K.x?K.x:0;ia+=K.y?K.y:0});W.bind("pointerUp",function(X,$,aa){if(Math.abs(ea)>20||Math.abs(ia)>20){if(U){aa=R.length;var K,S;$=0;for(S=R.length;--S>1&&$<50;)$+=R[S].ticks-R[S-1].ticks;if(aa-S>1){X=R[aa-1].x-R[S].x;K=R[aa-1].y-R[S].y;S=Math.sqrt(X*X+K*K)|0;if(S>15){X=R[aa-1].x-R[0].x;K=R[aa-1].y-R[0].y;S=Math.sqrt(X*X+K*K)|0;aa=Math.asin(K/S);$=S*
500/$|0;$=$>300?300:$;da(Math.cos(X>0?aa:Math.PI-aa)*$,Math.sin(aa)*$,COG.easing("sine.out"),500)}}}}else W.trigger("tap",$,aa)});return la};g("pointer",{handler:function(p,l,x){function da(y){if(y.pageX&&y.pageY)return f(y.pageX,y.pageY);else{var C=document.documentElement,Z=document.body;return f(y.clientX+(C&&C.scrollLeft||Z&&Z.scrollLeft||0)-(C&&C.clientLeft||Z&&Z.clientLeft||0),y.clientY+(C&&C.scrollTop||Z&&Z.scrollTop||0)-(C&&C.clientTop||Z&&Z.clientTop||0))}}function W(y){if(H(y,p))if(X=ea(y)){var C=
da(y);p.style.cursor="move";z(y);S=C.x;J=C.y;$=f(S,J);l.triggerCustom("pointerDown",u("mouse",y),$,h($,n(p)))}}function U(y){var C=da(y);aa=C.x;K=C.y;if(H(y,p))ia(y,X?"pointerMove":"pointerHover")}function fa(y){if(X&&ea(y)){X=false;if(H(y,p)){p.style.cursor="default";ia(y,"pointerUp")}}}function R(y){if(H(y,p)){var C;y=y||window.event;if(y.detail)C=y.axis===2?-y.detail*la:0;else{C=y.wheelDeltaY?y.wheelDeltaY:y.wheelDelta;if(window.opera)C=-C}if(C!==0){var Z=f(aa,K);l.triggerCustom("zoom",u("mouse",
y),Z,h(Z,n(p)),C/Ca,"wheel");z(y);y.returnValue=false}}}function ea(y){y=y||window.event;return(y.which||y.button)==1}function ia(y,C,Z,ja,Ea){Z=typeof Z!="undefined"?Z:aa;ja=typeof ja!="undefined"?ja:K;var E=Z-S,V=ja-J,L=f(Z,ja);l.triggerCustom(C,u("mouse",y),L,h(L,n(p)),f(E,V));if(typeof Ea=="undefined"||Ea){S=Z;J=ja}}x=COG.extend({},x);var la=120,Ca=la*8,X=false,$,aa,K,S,J;x.binder("mousedown",W,false);x.binder("mousemove",U,false);x.binder("mouseup",fa,false);x.binder("dblclick",function(y){COG.info("captured double click");
if(H(y,p)){var C=da(y);l.triggerCustom("doubleTap",u("mouse",y),C,h(C,n(p)))}},false);x.binder("mousewheel",R,document);x.binder("DOMMouseScroll",R,document);return{unbind:function(){x.unbinder("mousedown",W,false);x.unbinder("mousemove",U,false);x.unbinder("mouseup",fa,false);x.unbinder("mousewheel",R,document);x.unbinder("DOMMouseScroll",R,document)}}},checks:{touch:false}});g("pointer",{handler:function(p,l,x){function da(E){if(E.count<2)return 0;var V=E.x-E.next.x;E=E.y-E.next.y;return~~Math.sqrt(V*
V+E*E)}function W(E,V,L){V=V?V:0;L=L?L:0;for(var sa={x:E.x-V,y:E.y-L,id:E.id,count:E.count},ya=sa;E.next;){E=E.next;ya=ya.next={x:E.x-V,y:E.y-L,id:E.id}}return sa}function U(E,V){var L=E[V?V:"touches"],sa,ya;if(L.length===0)return null;ya=sa={x:L[0].pageX,y:L[0].pageY,id:L[0].identifier,count:L.length};for(var Da=1,Ra=L.length;Da<Ra;Da++)ya=ya.next={x:L[Da].pageX,y:L[Da].pageY,id:L[Da].identifier};return sa}function fa(E){if(H(E,p)){K=n(p);var V=U(E,"changedTouches"),L=W(V,K.left,K.top);if(!J){S=
X;l.triggerCustom("pointerDown",u("touch",E),V,L)}ja&&l.triggerCustom("pointerDownMulti",u("touch",E),V,L);J=U(E);if(J.count>1)C=da(J);Ea=1;Z=W(J)}}function R(E){if(H(E,p)){E.preventDefault();y=U(E);if(S==X)S=Math.abs(J.x-y.x)>la||Math.abs(J.y-y.y)>la?Ca:X;if(S!=X){S=y.count>1?aa:$;if(S==aa)if(J.count===1){J=W(y);C=da(J)}else{var V=da(y);if(Math.abs(C-V)<ia)S=$;else{var L;L=y.x;var sa=y.next.x,ya=y.y,Da=y.next.y,Ra=ya<Da?ya:Da;L={x:(L<sa?L:sa)+(Math.abs(L-sa)>>1),y:Ra+(Math.abs(ya-Da)>>1)};V=V/C;
sa=V-Ea;l.triggerCustom("zoom",u("touch",E),L,h(L,K),sa,"pinch");Ea=V}}S==$&&l.triggerCustom("pointerMove",u("touch",E),y,W(y,K.left,K.top),f(y.x-Z.x,y.y-Z.y));ja&&l.triggerCustom("pointerMoveMulti",u("touch",E),y,W(y,K.left,K.top))}Z=W(y)}}function ea(E){if(H(E,p)){var V=U(E,"changedTouches"),L=W(V,K.left,K.top);y=U(E);if(!y){l.triggerCustom("pointerUp",u("touch",E),V,L);J=null}ja&&l.triggerCustom("pointerUpMulti",u("touch",E),V,L)}}x=COG.extend({detailed:false,inertia:false},x);var ia=20,la=7,Ca=
0,X=1,$=2,aa=3,K,S,J,y,C,Z,ja=x.detailed,Ea=1;x.binder("touchstart",fa,false);x.binder("touchmove",R,false);x.binder("touchend",ea,false);COG.info("initialized touch handler");return{unbind:function(){x.unbinder("touchstart",fa,false);x.unbinder("touchmove",R,false);x.unbinder("touchend",ea,false)}}},checks:{touch:true}});return{register:g,watch:function(p,l,x){l=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},l);capabilities=COG.extend({touch:"ontouchstart"in
window},x);if(!l.observable){COG.info("creating observable");l.observable=COG.observable({});globalOpts=l}l.binder=l.isIE?B:G(l.bindToBody);l.unbinder=l.isIE?s:Q(l.bindToBody);x=l.types;for(var da=capabilities,W=[],U=t.length;U--;){var fa=t[U],R=!x||x.indexOf(fa.type)>=0,ea=true;for(var ia in fa.checks){var la=fa.checks[ia];COG.info("checking "+ia+" capability. require: "+la+", capability = "+da[ia]);ea=ea&&la===da[ia]}if(R&&ea)W[W.length]=fa.handler}return new A(p,W,l)}}}();var T5={};
(function(G){function Q(){return(new Date).getTime()}function B(){for(;L.length>0;){var a=L.shift();document.location=a}V=0}function s(a){for(var e=true,b=sa.length;b--;)e=e&&a!=sa[b];return e}function f(a,e){var b=[];for(var c in e)c&&b.push(c+"="+escape(e[c]));return"tile5://"+a+"/"+(b.length>0?"?"+b.join("&"):"")}function g(a,e){s(a)&&COG.info("would push url: "+f(a,e))}function n(a,e){if(s(a)){L.push(f(a,e));V||(V=setTimeout(B,100))}}function u(a){return function(e,b,c){(c?c:a?document.body:document).addEventListener(e,
b,false)}}function H(a){return function(e,b,c){(c?c:a?document.body:document).removeEventListener(e,b,false)}}function h(a,e,b){(b?b:document).attachEvent("on"+a,e)}function z(a,e,b){(b?b:document).detachEvent("on"+a,e)}function t(){ja={base:{name:"Unknown",bindEvent:u(),unbindEvent:H(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:g,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:h,unbindEvent:z,
requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:n,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:n},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:n},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:u(true),unbindEvent:H(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:n},
froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:n}};Ea=[ja.froyo,ja.android,ja.ipod,ja.iphone,ja.ipad,ja.ie]}function A(){ja||t();if(!E){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<Ea.length;a++){var e=Ea[a];if(e.regex&&e.regex.test(navigator.userAgent)){E=COG.extend({},ja.base,e);COG.info("PLATFORM DETECTED AS: "+E.name);break}}if(!E){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
E=ja.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return E}function p(){var a=(new Date).getTime(),e=0;clearTimeout(Va);for(Va=0;e<Sa.length;){var b=Sa[e],c=Oa[b],d=Oa[b].image&&(Bb||Oa[b].image.complete&&Oa[b].image.width>0),m=a-c.start;m=d||m>=Da;if(d){d=c.image;c=c.callbacks;Ra[b]=d;for(var i=0;i<c.length;i++)c[i](d,true)}if(m){Sa.splice(e,1);delete Oa[b]}else e++}if(Sa.length>0)Va=setTimeout(p,ya)}function l(){for(var a=0,e=arguments.length;e--;){var b=Mb[arguments[e].toUpperCase()];
if(b)a|=b}return a}function x(a,e){var b,c;if(e&&e.width>0){if(!a.imageOffset)a.imageOffset=J.init(-e.width>>1,-e.height>>1);if(!a.bounds){b=a.xy.x+a.imageOffset.x;c=a.xy.y+a.imageOffset.y;a.bounds=C.init(b,c,b+e.width,c+e.height)}}}function da(a){var e=Wa.length==0;Wa[Wa.length]=a;e&&animFrame(W)}function W(a){a=a?a:(new Date).getTime();if(a-Cb>Nb){for(var e=Wa.splice(0),b=e.length;b--;)e[b](a);Cb=a}Wa.length&&animFrame(W)}function U(a){function e(){a.transformed=c!==1||b%fa!==0||d!==0||m!==0}var b=
0,c=1,d=0,m=0;COG.extend(a,{animate:function(i,o,w,q){q=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},q);var D=(new Date).getTime(),r=a[i],F=q.autoInvalidate,N=o.length&&w.length&&o.length==w.length?o.length:0,M=Array(N),O=Array(N),P=COG.easing(q.easing),I=q.duration,ka=q.progress,ba=function(qa){var Ka=qa-D;qa=D+I<=qa;for(var La=N;La--;)O[La]=P(Ka,o[La],M[La],I);r.apply(a,O);F&&a.invalidate.call(a);if(ka){Ka=[].concat(qa?w:O);Ka.unshift(qa);ka.apply(a,
Ka)}if(qa){r.apply(a,w);q.complete&&q.complete.apply(a,w)}else da(ba)};if(r&&r.apply&&N>0){I=I?I:1E3;for(i=N;i--;)M[i]=w[i]-o[i];da(ba)}},rotate:function(i){b=i;e()},scale:function(i){c=i;e()},translate:function(i,o){d=i;m=o;e()},transform:function(i,o,w){i.save();i.translate(a.xy.x-o+d,a.xy.y-w+m);b!==0&&i.rotate(b);c!==1&&i.scale(c,c)}})}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},1E3/60)}}();var fa=Math.PI*2,R=Math.abs,ea=Math.min,ia=Math.max,la=Math.pow,Ca=Math.sqrt,X=Math.log,$=Math.round,aa=Math.sin,K=Math.asin,S=Math.cos,J=function(){function a(c,d){return b(c.x-d.x,c.y-d.y)}function e(c,d){if(!d)d=c.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var m={edges:Array(d-1),accrued:Array(d-1),total:0},i=0;i<d-1;i++){var o=a(c[i],
c[i+1]);m.edges[i]=Ca(o.x*o.x+o.y*o.y);m.accrued[i]=m.total+m.edges[i];m.total+=m.edges[i]}return m}function b(c,d){return{x:c?c:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var c=0,d=0,m=arguments.length;m--;){c+=arguments[m].x;d+=arguments[m].y}return b(c,d)},absSize:function(c){return ia(R(c.x),R(c.y))},copy:function(c){return c?b(c.x,c.y):null},diff:a,distance:function(c,d){return e(c,d).total},edges:e,equals:function(c,d){return c.x===d.x&&c.y===
d.y},extendBy:function(c,d,m){var i=S(d)*m|0;d=aa(d)*m|0;return b(c.x-i,c.y-d)},floor:function(c){for(var d=Array(c.length),m=c.length;m--;)d[m]=b(~~c[m].x,~~c[m].y);return d},getRect:function(c){for(var d,m,i,o,w=c.length;w--;){var q=c[w];d=typeof d==="undefined"||q.x<d?q.x:d;m=typeof m==="undefined"||q.y<m?q.y:m;i=typeof i==="undefined"||q.x>i?q.x:i;o=typeof o==="undefined"||q.y>o?q.y:o}return C.init(d,m,i,o)},init:b,invert:function(c){return b(-c.x,-c.y)},min:function(c,d){return b(c.x<d.x?c.x:
d.x,c.y<d.y?c.y:d.y)},max:function(c,d){return b(c.x>d.x?c.x:d.x,c.y>d.y?c.y:d.y)},offset:function(c,d,m){return b(c.x+d,c.y+(m?m:d))},scale:function(c,d){return b(c.x/d|0,c.y/d|0)},simplify:function(c,d){if(!c)return null;d=d?d:J.VECTOR_SIMPLIFICATION;for(var m=[],i=null,o=c.length;o--;){var w=c[o];if(include=!i||o===0||R(w.x-i.x)+R(w.y-i.y)>d){m.unshift(w);i=w}}return m},theta:function(c,d,m){m=K((c.y-d.y)/m);return c.x>d.x?m:Math.PI-m},toString:function(c){return c?c.x+", "+c.y:""}}}(),y=function(){return{dotProduct:function(a,
e){return a.x*e.x+a.y*e.y}}}(),C=function(){function a(b){return e(b.x1,b.y1,b.x2,b.y2)}function e(b,c,d,m){b=b?b:0;c=c?c:0;d=typeof d!=="undefined"?d:b;m=typeof m!=="undefined "?m:m;return{x1:b,y1:c,x2:d,y2:m,width:d-b,height:m-c}}return{center:function(b){return J.init(b.x1+(b.width>>1),b.y1+(b.height>>1))},copy:a,diagonalSize:function(b){return Ca(b.width*b.width+b.height*b.height)},fromCenter:function(b,c,d,m){d=d>>1;m=m>>1;return e(b-d,c-m,b+d,c+m)},init:e,intersect:function(b,c){var d=ia(b.x1,
c.x1),m=ia(b.y1,c.y1),i=ea(b.x2,c.x2),o=ea(b.y2,c.y2);d=e(d,m,i,o);return d.width>0&&d.height>0?d:null},toString:function(b){return b?"["+b.x1+", "+b.y1+", "+b.x2+", "+b.y2+"]":""},union:function(b,c){if(b.width===0||b.height===0)return a(c);else if(c.width===0||c.height===0)return a(b);else{var d=ea(b.x1,c.x1),m=ea(b.y1,c.y1),i=ia(b.x2,c.x2),o=ia(b.y2,c.y2);d=e(d,m,i,o);return d.width>0&&d.height>0?d:null}}}}(),Z=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},
getCenter:function(a){return J.init(a.width>>1,a.height>>1)},getSize:function(a){return Ca(la(a.width,2)+la(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,height:e?e:a}}}}();Hits=function(){return{diffHits:function(a,e){var b=[],c={},d;for(d=e.length;d--;)c[e[d].target.id]=true;for(d=a.length;d--;)c[a[d].target.id]||(b[b.length]=a[d]);return b},init:function(a,e,b,c){return{type:a,x:c.x|0,y:c.y|0,elements:[],absXY:e,relXY:b}},initHit:function(a,e,b){return b=COG.extend({type:a,target:e,drag:false},
b)},triggerEvent:function(a,e,b,c){e.triggerCustom(a.type+(b?b:"Hit"),{hitType:a.type},c?c:a.elements,a.absXY,a.relXY,J.init(a.x,a.y))}}}();var ja=null,Ea=[],E=null,V=0,L=[],sa=["view.wake","tile.loaded"],ya=100,Da=3E4,Ra={},Ob=0;(new Date).getTime();var Oa={},Sa=[],Bb=typeof FlashCanvas!="undefined",Va=0,lb=T5.getImage=function(a,e){var b=a&&e?Ra[a]:null;if(b&&b&&(Bb||b.complete&&b.width>0))e(b);else{if(b=Oa[a])b.callbacks.push(e);else{b=new Image;b.id="_ldimg"+ ++Ob;Oa[a]={start:(new Date).getTime(),
image:b,callbacks:[e]};b.src=a;Sa[Sa.length]=a}Va||(Va=setTimeout(p,ya))}};T5.newCanvas=function(a,e){var b=document.createElement("canvas");b.width=a?a:0;b.height=e?e:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(b);FlashCanvas.initElement(b)}typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(b);return b};var mb=function(){var a={};return{init:function(e,b){var c=a[e];if(!c)throw Error("Unable to locate requested generator: "+e);return new c(b)},register:function(e,
b){a[e]=b},Template:function(){}}}(),Xa=function(){function a(i,o){d[i]=b(o);return i}function e(i){for(var o in i)a(o,i[o])}function b(i){function o(r){var F=i[r];typeof F!=="undefined"&&q.push(function(N){N[r]=F})}function w(){q=[];for(var r in i)o(r)}i=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},i);var q=[],D={applyToContext:function(r){for(var F=q.length;F--;)q[F](r)},
update:function(r,F){i[r]=F;w()}};w();return D}var c={},d={},m={apply:function(i,o){var w=d[o]?d[o]:d.basic,q;if(i&&i.canvas){q=c[i.canvas.id];c[i.canvas.id]=o}w.applyToContext(i);return q},define:a,defineMany:e,get:function(i){return d[i]},init:b,load:function(i){COG.jsonp(i,function(o){e(o)})}};e({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});
return m}(),Mb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},nb=function(a){a=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:l("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);var e=null,b=false,c=false,d=a.id,m=l("ACTIVE"),i=a.validStates,o=0,w=0,q=COG.extend({addToView:function(D){D.setLayer(d,q)},shouldDraw:function(D){return(D&i)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){q.trigger("remove",q)},
changed:function(){c=true;e&&e.invalidate()},hitTest:null,getId:function(){return d},setId:function(D){d=D},getParent:function(){return e},setParent:function(D){b=(e=D)?e.fastDraw&&displayState!==m:false;q.trigger("parentChange",e)}},a);COG.observable(q);q.bind("drawComplete",function(D,r){c=false;o=r.x1;w=r.y1});q.bind("resync",function(D,r){q.minXY&&r.syncXY(q.minXY);q.maxXY&&r.syncXY(q.maxXY)});return q},Fa=function(a){a=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,
observable:true,properties:{},type:"shape",transformable:false},a);COG.extend(this,a);this.id=COG.objId(this.type);this.view=this.bounds=null;this.observable&&COG.observable(this);this.transformable&&U(this);this.transformed=false};Fa.prototype={constructor:Fa,drag:null,draw:function(a){this.fill&&a.fill();this.stroke&&a.stroke()},invalidate:function(){var a=this.layer?this.layer.getParent():null;a&&a.invalidate()},prepPath:function(){},resync:function(a){if(this.xy){a.syncXY([this.xy]);this.size&&
this.updateBounds(C.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},setTransformable:function(a){a&&!this.transformable&&U(this);this.transformable=a},updateBounds:function(a,e){this.bounds=a;if(e)this.xy=C.center(this.bounds)}};var Nb=1E3/60|0,Wa=[],Cb=0,ob=function(a){Fa.call(this,a)};ob.prototype=COG.extend(Fa.prototype,{constructor:ob,prepPath:function(a,e,b){a.beginPath();a.arc(this.xy.x-e,this.xy.y-b,this.size>>1,0,Math.PI*2,false);return true}});var Ya=function(a,e){e=COG.extend({simplify:false},
e);var b=false,c=e.simplify;l("ZOOM");var d=[];e.type=e.fill?"polygon":"line";Fa.call(this,e);COG.extend(this,{animatePath:function(){},prepPath:function(m,i,o){if(b){var w=true;m.beginPath();for(var q=d.length;q--;){var D=d[q].x-i,r=d[q].y-o;if(w){m.moveTo(D,r);w=false}else m.lineTo(D,r)}}return b},resync:function(m){var i,o,w,q,D;m.syncXY(a);d=J.floor(c?J.simplify(a):a);for(var r=d.length;r--;){m=d[r].x;i=d[r].y;q=typeof q=="undefined"||m<q?m:q;D=typeof D=="undefined"||i<D?i:D;o=typeof o=="undefined"||
m>o?m:o;w=typeof w=="undefined"||i>w?i:w}this.updateBounds(C.init(q,D,o,w),true)}});b=a&&a.length>=2};Ya.prototype=COG.extend(Fa.prototype,{constructor:Ya});var Db=function(a,e){e.fill=false;Ya.call(this,a,e)};Db.prototype=new Ya;var Ta=function(a){function e(w){(this.imageUrl=w)&&lb(this.imageUrl,function(q,D){i=q;if(D){var r=o.layer?o.layer.getParent():null;r&&r.invalidate()}})}a=COG.extend({image:null,imageUrl:null,imageOffset:null},a);var b=null,c=Fa.prototype.updateBounds,d,m,i=a.image;Fa.call(this,
a);var o=COG.extend(this,{changeImage:e,drag:function(w,q,D,r){b||(b=J.init(w.startX-this.xy.x,w.startY-this.xy.y));this.xy.x=q-b.x;this.xy.y=D-b.y;if(r){b=null;if(this.layer)(w=this.layer.getParent())&&w.syncXY([this.xy],true);this.trigger("dragDrop")}return true},draw:function(w){w.drawImage(i,d,m)},prepPath:function(w,q,D){var r=i&&i.width>0;if(r){x(this,i);d=this.xy.x+this.imageOffset.x-q;m=this.xy.y+this.imageOffset.y-D;w.beginPath();w.rect(d,m,i.width,i.height)}return r},updateBounds:function(w,
q){c.call(this,w,q);x(this,i)}});i||e(this.imageUrl)};Ta.prototype=new Fa;Ta.prototype.constructor=Ta;var bb=function(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.imageOffset=J.invert(a.imageAnchor);Ta.call(this,a)};bb.prototype=new Ta;bb.prototype.constructor=bb;var Eb=function(a){function e(o){for(var w=c.length;w--;)c[w].resync(o);c.sort(function(q,D){var r=D.xy.y-q.xy.y;return r!=0?r:D.xy.x-q.xy.y});i.changed()}function b(o,w){e(w)}a=COG.extend({zindex:10},a);var c=[],d=CANI.canvas.pipTransformed,
m=typeof FlashCanvas!="undefined",i=COG.extend(new nb(a),{add:function(o,w){if(o){o.layer=i;var q=i.getParent();if(q){o.resync(i.getParent());q.invalidate()}if(w)c.unshift(o);else c[c.length]=o}},clear:function(){c=[]},draw:function(o,w,q,D,r,F){D=w.x1;r=w.y1;var N=F?d?F.x-D:F.relXY.x:0,M=F?d?F.y-r:F.relXY.y:0,O=w.width;w=w.height;for(var P=c.length;P--;){var I=c[P],ka=I.style||i.style,ba,qa=I.transformed&&!m;if(qa){I.transform(o,D,r);if(d){N-=I.xy.x;M-=I.xy.y}}if(I.prepPath(o,qa?I.xy.x:D,qa?I.xy.y:
r,O,w,q)){if(F&&o.isPointInPath(N,M)){F.elements.push(Hits.initHit(I.type,I,{drag:I.draggable?I.drag:null}));ba=F.type+"Style";ka=I[ba]||i[ba]||ka}ka=ka?Xa.apply(o,ka):null;I.draw(o,D,r,O,w,q);ka&&Xa.apply(o,ka)}qa&&o.restore()}},find:function(){return[].concat(c)},hitGuess:function(o,w){for(var q=false,D=c.length;!q&&D--;){var r=c[D];if(!(q=q))q=(r=r.bounds)&&o>=r.x1&&o<=r.x2&&w>=r.y1&&w<=r.y2;q=q}return q}});i.bind("parentChange",b);i.bind("resync",b);return i},Pb=function(){return{tileSize:256,
init:function(a,e,b,c,d){return COG.extend({x:a,y:e,width:b,height:c},d)}}}();COG.extend(G,{ex:COG.extend,ticks:Q,getConfig:A,userMessage:function(a,e,b){G.trigger("userMessage",a,e,b)},XY:J,XYRect:C,Dimensions:Z,Vector:y,Hits:Hits,Generator:mb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Xa,viewState:l,View:function(a){function e(j,k,v){Ga||cb(ga-k,ha-v)}function b(j,k,v,T){La(ea(ia(na+la(2,T)-1,0.5),2))}function c(){var j=X(na)/Math.LN2|0;if(j!==0){na=la(2,j);
Fb(Za+j,db,eb)}ba()}function d(j){j||(j=J.init(Pa,Qa));pb=J.init(ga,ha);$a=J.offset(j,ga,ha);db=$a.x;eb=$a.y}function m(j,k){var v=1/na;return J.init(Ma?Ma.x1+j*v:j,Ma?Ma.y1+k*v:k)}function i(j,k,v){Ua("doubleTap",k,v,m(v.x,v.y));a.scalable&&La(2,v,a.zoomEasing,null,a.zoomDuration)}function o(j,k,v){Ga=null;ka("down",k,v)}function w(j,k,v){ka("hover",k,v)}function q(j,k,v){P(k,v,false)}function D(j,k,v){P(k,v,true)}function r(){clearTimeout(Gb);Gb=setTimeout(N,250)}function F(j,k,v){ka("tap",k,v);
Ua("tap",k,v,m(v.x,v.y,true))}function N(j,k){var v;fb=typeof FlashCanvas!=="undefined";COG.info("is flash = "+fb);if(oa){if(a.autoSize&&oa.parentNode){j=oa.parentNode.offsetWidth;k=oa.parentNode.offsetHeight}try{if(!oa.id)oa.id=a.id+"_canvas";ra=oa.getContext("2d")}catch(T){COG.exception(T);throw Error("Could not initialise canvas on specified view element");}if(j&&k&&(ta!==k||ua!==j)){qb=true;ua=j;ta=k;Pa=ua>>1;Qa=ta>>1;ma.trigger("resize",ua,ta);for(v=za;v--;)ca[v].trigger("resize",ua,ta)}for(v=
za;v--;)ca[v].trigger("contextChanged",ra);ba();O()}}function M(j,k){k.setId(j);k.added=Q();k.bind("remove",function(){ma.removeLayer(j)});k.trigger("contextChanged",ra);k.setParent(ma);ca.push(k);ca.sort(function(v,T){var Y=T.zindex-v.zindex;if(Y===0)Y=T.added-v.added;return Y});za=ca.length;return k}function O(){Aa&&Aa.unbind();Aa=INTERACT.watch(oa);a.pannable&&Aa.pannable().bind("pan",e);if(a.scalable){Aa.bind("zoom",b);Aa.bind("doubleTap",i)}Aa.bind("pointerDown",o);Aa.bind("pointerMove",q);Aa.bind("pointerUp",
D);a.captureHover&&Aa.bind("pointerHover",w);Aa.bind("tap",F)}function P(j,k,v){if(Ga){j=m(k.x,k.y);Ga.drag.call(Ga.target,Ga,j.x,j.y,v)&&ba();if(v)Ga=null}}function I(j){var k,v,T=false;if(rb|fb){j=j?j:(new Date).getTime();if(j-Hb>Qb){v=ga!==sb||ha!==tb;Ha=Ib|(na!==1?Jb:0)|(v?ub:0)|(vb?wb:0);xb=(k=(Ha&(Jb|ub))!==0)&&(Ha&wb)===0;if(qb&&oa){oa.width=ua;oa.height=ta;oa.style.width=ua+"px";oa.style.height=ta+"px";fb&&FlashCanvas.initElement(oa);typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(oa);
qb=false}gb=qa();for(v=za;v--;){Ha|=ca[v].animated?wb:0;ca[v].cycle(j,gb,Ha);T=ca[v].clip||T}v=Ha;var Y=gb;T=Rb&&T&&!k;k=j;var pa;C.center(Y);var va=0,wa;if(na!==1){wa=1/na;db=$a.x+(ga-pb.x);eb=$a.y+(ha-pb.y);wa=Y?C.fromCenter(db>>0,eb>>0,Y.width*wa>>0,Y.height*wa>>0):void 0}else wa=C.copy(Y);Ma=wa;T||ra.clearRect(0,0,ua,ta);Ma.scaleFactor=na;ra.save();try{na!==1&&ra.scale(na,na);hb=ib=null;if(T){ra.beginPath();for(va=za;va--;)ca[va].clip&&ca[va].clip(ra,Ma,v,ma,k);ra.closePath();ra.clip()}ra.globalCompositeOperation=
"source-over";for(va=za;va--;){pa=ca[va];if(pa.shouldDraw(Ha,gb)){var xa=pa.style,Na=xa?Xa.apply(ra,xa):null;pa.draw(ra,Ma,v,ma,k,Ba);Na&&Xa.apply(ra,Na)}}}finally{ra.restore()}rb=0;Ua("drawComplete",Y,k);if(Ba){pa=Ba?Ba.elements:[];if(ab&&ab.type==="hover"){xa=Hits.diffHits(ab.elements,pa);xa.length>0&&Hits.triggerEvent(ab,ma,"Out",xa)}if(pa.length>0){Na=Ba.x;v=Ba.y;for(xa=pa.length;xa--;){Y=pa[xa];T=Na;k=v;if(va=Y&&Y.drag&&(!Y.canDrag||Y.canDrag(Y,T,k))){Ga=Y;Ga.startX=T;Ga.startY=k}if(va)break}Hits.triggerEvent(Ba,
ma)}ab=pa.length>0?COG.extend({},Ba):null;Ba=null}j-Kb>Sb&&Ka();Hb=j;sb=ga;tb=ha}animFrame(I)}else yb=false}function ka(j,k,v){Ba=Hits.init(j,k,v,m(v.x,v.y,true));for(j=za;j--;)zb=zb||(ca[j].hitGuess?ca[j].hitGuess(Ba.x,Ba.y,Ha,ma):false);zb&&ba()}function ba(){rb+=1;if(!yb){yb=true;animFrame(I)}}function qa(){return C.init(ga,ha,ga+ua,ha+ta)}function Ka(){if(Ia||Ja){var j=jb?ga+Pa:ga,k=kb?ha+Qa:ha;if(Ia&&Ia>ua)if(j+ua>Ia)ga=jb?j-Ia>0?ga-Ia:ga:Ia-ua;else if(j<0)ga=jb?ga+Ia:0;if(Ja&&Ja>ta)if(k+ta>
Ja)ha=kb?k-Ja>0?ha-Ja:ha:Ja-ta;else if(k<0)ha=kb?ha+Ja:0}Kb=(new Date).getTime();Ua("refresh",ma,qa());ba()}function La(j,k,v,T,Y){if(v)COG.tweenValue(na,j,v,Y,function(pa,va){na=pa;if(va){var wa=$(X(na)/Math.LN2);na=la(2,wa);T&&T()}d(k);c()});else{na=j;d(k);c()}return ma}function Fb(j,k,v){j=ia(a.minZoom,ea(a.maxZoom,j));if(j!==Za){var T=la(2,j-Za),Y=Pa/T|0,pa=Qa/T|0;Za=j;cb(((k?k:ga+Pa)-Y)*T,((v?v:ha+Qa)-pa)*T);sb=ga;tb=ha;Ua("zoomLevelChange",j);na=1;Ka()}}function Ua(){for(var j=ma.trigger.apply(null,
arguments).cancel,k=ca.length;k--;)j=ca[k].trigger.apply(null,arguments).cancel||j;return!j}function cb(j,k,v,T,Y){function pa(){va+=1;if(va>=2){vb=false;Y&&Y()}}var va=0,wa=ib?J.offset(ib,-Pa,-Qa):null,xa=hb?J.offset(hb,-Pa,-Qa):null;if(wa){j=j<wa.x?wa.x:j;k=k<wa.y?wa.y:k}if(xa){j=j>xa.x?xa.x:j;k=k>xa.y?xa.y:k}if(v){if((Ha&ub)===0){COG.tweenValue(ga,j,v,T,function(Na,Ab){ga=Na|0;(Ab?pa:ba)();return!xb});COG.tweenValue(ha,k,v,T,function(Na,Ab){ha=Na|0;(Ab?pa:ba)();return!xb});vb=true}}else{ga=j|0;
ha=k|0;ba();Y&&Y()}}a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},a);var ca=[],za=0,oa=document.getElementById(a.container),Ga=null,ra=null,
Tb=typeof window.attachEvent!="undefined",fb,zb=false,Sb=a.minRefresh,ga=0,ha=0,sb=0,tb=0,Ia=null,Ja=null,jb=false,kb=false,Rb=a.clipping,gb=null,yb=false,Ma,Lb=1,Pa=0,Qa=0,Ba=null,pb=null,$a=null,xb=false,ib=null,hb=null,Kb=0,ab=null,Gb=0,na=1,Hb=0,qb=false,Aa=null,vb=false,ta,ua,Qb=1E3/a.fps|0,rb=0,db,eb,Za=a.zoomLevel,Ib=l("ACTIVE"),ub=l("PAN"),Jb=l("ZOOM"),wb=l("ANIMATING"),Ha=Ib,ma={id:a.id,deviceScaling:Lb,fastDraw:a.fastDraw||A().requireFastDraw,detach:function(){Aa&&Aa.unbind()},eachLayer:function(j){for(var k=
za;k--;)j(ca[k])},getDimensions:function(){return Z.init(ua,ta)},getLayer:function(j){for(var k=0;k<za;k++)if(ca[k].getId()==j)return ca[k];return null},getZoomLevel:function(){return Za},setLayer:function(j,k){for(var v=0;v<za;v++)if(ca[v].getId()===j){ca.splice(v,1);break}if(k){M(j,k);k.trigger("refresh",ma,qa())}ba();return k},invalidate:ba,refresh:Ka,resetScale:function(){na=1},resize:function(j,k){if(oa){a.autoSize=false;if(ua!==j||ta!==k)N(j,k)}},scale:La,setZoomLevel:Fb,syncXY:function(){},
triggerAll:Ua,removeLayer:function(j){a:{for(var k=za;k--;)if(ca[k].getId()==j){j=k;break a}j=-1}if(j>=0&&j<za){ma.trigger("layerRemoved",ca[j]);ca.splice(j,1);ba()}za=ca.length},getOffset:function(){return J.init(ga,ha)},setMaxOffset:function(j,k,v,T){Ia=j;Ja=k;jb=typeof v!="undefined"?v:false;kb=typeof T!="undefined"?T:false},getViewRect:qa,updateOffset:cb,pan:function(j,k,v,T,Y){cb(ga+j,ha+k,v,T,Y)}};Lb=A().getScaling();COG.observable(ma);ma.bind("invalidate",function(){ba()});ma.bind("resync",
function(){hb=ib=null});COG.configurable(ma,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(a,null,{container:function(j,k){oa=document.getElementById(k);N()},inertia:O,captureHover:O,scalable:O,pannable:O}),true);CANI.init(function(j){ma.markers=M("markers",new Eb({zindex:20}));canvasCaps=j.canvas;N();if(a.autoSize)Tb?window.attachEvent("onresize",r):window.addEventListener("resize",r,false)});return ma},ViewLayer:nb,ImageLayer:function(a,
e){function b(r,F,N,M){F.image?r.drawImage(F.image,N,M):lb(F.url,function(O){F.image=O;D.changed()})}function c(r,F,N){for(F=o.length;F--;){var M=o[F],O=M.x,P=M.y,I=C.init(M.x,M.y,M.x+M.width,M.y+M.height);N&&C.intersect(r,I)&&lb(M.url,function(ka,ba){N(ka,O,P,M.width,M.height);ba&&D.changed()},q)}}function d(r){var F=w?Math.abs(w.x1-r.x1)+Math.abs(w.y1-r.y1):0;if(m&&(!w||F>256)){var N=++i;F=D.getParent();m.run(F,r,function(M){w=C.copy(r);if(N==i)for(var O=M.length;O--;){var P=M[O];o[o.length]={image:null,
sequence:N,url:P.url,rect:C.init(P.x,P.y,P.x+P.width,P.y+P.height)}}})}}e=COG.extend({imageLoadArgs:{}},e);var m=a?mb.init(a,e):null,i=0,o=[],w=null,q=e.imageLoadArgs,D=COG.extend(new nb(e),{changeGenerator:function(r,F){m=mb.init(r,COG.extend({},e,F));d(D.getParent().getViewRect())},clip:function(r,F){for(var N=F.x1,M=F.y1,O=o.length;O--;){var P=o[O].rect;C.intersect(F,P)&&r.rect(P.x1-N,P.y1-M,P.width,P.height)}},draw:function(r,F){for(var N=F.x1,M=F.y1,O=0;O<o.length;){var P=o[O],I=P.rect;C.intersect(F,
I)&&b(r,P,I.x1-N,I.y1-M);if(P.sequence!==i)o.splice(O,1);else O++}},mask:function(r,F,N){c(F,N,function(M,O,P,I,ka){COG.info("clearing rect @ x = "+O+", y = "+P+", width = "+I+", height = "+ka);r.clearRect(O,P,I,ka)})}});D.bind("refresh",function(r,F,N){d(N)});D.bind("tap",function(r,F,N,M){r=[];var O=M.x,P=M.y,I,ka;if(o)for(var ba=o.length;ba--;){I=o[ba];if(ka=O>=I.x&&O<=I.x+I.width&&P>=I.y&&P<=I.y+I.height)r[r.length]=I}r.length>0&&D.trigger("tapImage",r,F,N,M)});return D},ImageGenerator:function(a){a=
COG.extend({relative:false,padding:2},a);a={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(a);return a},Drawable:Fa,Marker:ob,Poly:Ya,Line:Db,ImageDrawable:Ta,ImageMarker:bb,ShapeLayer:Eb,transformable:U,Tiling:Pb});COG.observable(G)})(T5);
