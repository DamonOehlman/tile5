COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var E=arguments[0]||{},R,A=1,q=arguments.length;A<q;A++)if((R=arguments[A])!==null)for(var f in R){var g=R[f];if(E!==g)if(g!==undefined)E[f]=g}return E};
(function(){var E=Object.prototype.hasOwnProperty,R=0,A={};A.toID=function(q){return q.replace(/\s/g,"-")};A.objId=function(q){return(q?q:"obj")+R++};A.isFunction=function(q){return toString.call(q)==="[object Function]"};A.isArray=function(q){return toString.call(q)==="[object Array]"};A.isPlainObject=function(q){if(!q||toString.call(q)!=="[object Object]"||q.nodeType||q.setInterval)return false;if(q.constructor&&!E.call(q,"constructor")&&!E.call(q.constructor.prototype,"isPrototypeOf"))return false;
var f;for(f in q);return f===undefined||E.call(q,f)};A.isEmptyObject=function(q){for(var f in q)return false;return true};A.isXmlDocument=function(q){return toString.call(q)==="[object Document]"};A.contains=function(q,f){var g=q,n=arguments,s=1;if(f&&module.isArray(f)){n=f;s=0}for(s=s;s<n;s++)g=g&&typeof foo[n[s]]!=="undefined";return g};A.formatStr=function(q){if(arguments.length<=1)return q;for(var f=arguments.length-2,g=0;g<=f;g++)q=q.replace(RegExp("\\{"+g+"\\}","gi"),arguments[g+1]);return q};
A.wordExists=function(q,f){var g="";if(f.toString)f=f.toString();for(var n=0;n<f.length;n++)g+=!/\w/.test(f[n])?"\\"+f[n]:f[n];return RegExp("(^|\\s|\\,)"+g+"(\\,|\\s|$)","i").test(q)};COG.extend(COG,A)})();
(function(){function E(g){return typeof console!=="undefined"?function(){console[g](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var R=window.console&&window.console.markTimeline,A=E("error"),q=E("info"),f=function(){return R?function(g,n){console.markTimeline(g+(n?": "+((new Date).getTime()-n)+"ms":""))}:function(){}}();COG.extend(COG,{trace:f,debug:E("debug"),info:q,warn:E("warn"),error:A,exception:function(g){if(A)for(var n in g)q("ERROR DETAIL: "+n+
": "+g[n])}})})();
(function(){function E(A,q){var f=A.hasOwnProperty("obsHandlers")?A.obsHandlers:null;f[q]||(f[q]=[]);return f[q]}var R=0;COG.observable=function(A){if(!A)return null;if(!(A.hasOwnProperty("obsHandlers")?A.obsHandlers:null))A.obsHandlers={};if(!A.hasOwnProperty("bind")){A.bind=function(q,f){var g="callback"+R++;E(A,q).unshift({fn:f,id:g});return g};A.triggerCustom=function(q,f){var g=E(A,q),n={cancel:false,name:q,source:this},s;f&&COG.extend(n,f);if(!g)return null;s=Array.prototype.slice.call(arguments,2);
A.eventInterceptor&&A.eventInterceptor(q,n,s);s.unshift(n);for(var I=g.length;I--&&!n.cancel;)g[I].fn.apply(this,s);return n};A.trigger=function(q){var f=Array.prototype.slice.call(arguments,1);f.splice(0,0,q,null);return A.triggerCustom.apply(this,f)};A.unbind=function(q,f){if(typeof q==="undefined")A.obsHandlers={};else for(var g=E(A,q),n=0;g&&n<g.length;n++)if(g[n].id===f){g.splice(n,1);break}return A}}return A}})();
(function(){function E(f,g){f[g]||(f[g]=function(n){return f.configure(g,n)})}function R(f){f.gtConfId="configurable"+q++;f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var A={},q=0;COG.paramTweaker=function(f,g,n){return function(s,I){if(typeof I!=="undefined"){if(s in f)f[s]=I;n&&s in n&&n[s](s,I)}else return g&&s in g?g[s](s):f[s]}};COG.configurable=function(f,g,n,s){if(f){f.gtConfId||R(f);var I=f.gtConfId,h=f.gtConfig,y=f.gtConfigFns;A[I]=f;y.push(n);for(n=g.length;n--;){h[g[n]]=true;s&&E(f,
g[n])}if(!f.configure)f.configure=function(r,z){if(h[r]){for(var o=y.length;o--;){var m=y[o](r,z);if(typeof m!=="undefined")return m}return A[I]}return null}}}})();
(function(){function E(f){var g=document.createElement("script"),n=false;g.src=f;g.async=true;g.onload=g.onreadystatechange=function(){if(!n&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){n=true;g.onload=g.onreadystatechange=null;g&&g.parentNode&&g.parentNode.removeChild(g)}};A||(A=document.getElementsByTagName("head")[0]);A.appendChild(g)}var R=0,A,q=this;COG.jsonp=function(f,g,n){f+=f.indexOf("?")>=0?"&":"?";var s="json"+ ++R;q[s]=function(I){g(I);q[s]=null;try{delete q[s]}catch(h){}};
E(f+(n?n:"callback")+"="+s);return s}})();
(function(){var E=1.70158,R=Math.PI/2,A=1E3/60|0,q=Math.abs,f=Math.pow,g=Math.sin,n=Math.asin,s=Math.cos,I={linear:function(h,y,r,z){return r*h/z+y},backin:function(h,y,r,z){return r*(h/=z)*h*((E+1)*h-E)+y},backout:function(h,y,r,z){return r*((h=h/z-1)*h*((E+1)*h+E)+1)+y},backinout:function(h,y,r,z){return(h/=z/2)<1?r/2*h*h*(((E*=1.525)+1)*h-E)+y:r/2*((h-=2)*h*(((E*=1.525)+1)*h+E)+2)+y},bouncein:function(h,y,r,z){return r-I.bounceout(z-h,0,r,z)+y},bounceout:function(h,y,r,z){return(h/=z)<1/2.75?r*
7.5625*h*h+y:h<2/2.75?r*(7.5625*(h-=1.5/2.75)*h+0.75)+y:h<2.5/2.75?r*(7.5625*(h-=2.25/2.75)*h+0.9375)+y:r*(7.5625*(h-=2.625/2.75)*h+0.984375)+y},bounceinout:function(h,y,r,z){return h<z/2?I.bouncein(h*2,0,r,z)/2+y:I.bounceout(h*2-z,0,r,z)/2+r/2+y},cubicin:function(h,y,r,z){return r*(h/=z)*h*h+y},cubicout:function(h,y,r,z){return r*((h=h/z-1)*h*h+1)+y},cubicinout:function(h,y,r,z){if((h/=z/2)<1)return r/2*h*h*h+y;return r/2*((h-=2)*h*h+2)+y},elasticin:function(h,y,r,z,o,m){if(h==0)return y;if((h/=
z)==1)return y+r;m||(m=z*0.3);if(!o||o<q(r)){o=r;r=m/4}else r=m/TWO_PI*n(r/o);return-(o*f(2,10*(h-=1))*g((h*z-r)*TWO_PI/m))+y},elasticout:function(h,y,r,z,o,m){var u;if(h==0)return y;if((h/=z)==1)return y+r;m||(m=z*0.3);if(!o||o<q(r)){o=r;u=m/4}else u=m/TWO_PI*n(r/o);return o*f(2,-10*h)*g((h*z-u)*TWO_PI/m)+r+y},elasticinout:function(h,y,r,z,o,m){var u;if(h==0)return y;if((h/=z/2)==2)return y+r;m||(m=z*0.3*1.5);if(!o||o<q(r)){o=r;u=m/4}else u=m/TWO_PI*n(r/o);if(h<1)return-0.5*o*f(2,10*(h-=1))*g((h*
z-u)*TWO_PI/m)+y;return o*f(2,-10*(h-=1))*g((h*z-u)*TWO_PI/m)*0.5+r+y},quadin:function(h,y,r,z){return r*(h/=z)*h+y},quadout:function(h,y,r,z){return-r*(h/=z)*(h-2)+y},quadinout:function(h,y,r,z){if((h/=z/2)<1)return r/2*h*h+y;return-r/2*(--h*(h-2)-1)+y},sinein:function(h,y,r,z){return-r*s(h/z*R)+r+y},sineout:function(h,y,r,z){return r*g(h/z*R)+y},sineinout:function(h,y,r,z){return-r/2*(s(Math.PI*h/z)-1)+y}};COG.tweenValue=function(h,y,r,z,o){function m(T){T=T?T:(new Date).getTime();if(da+A<T){var ba=
T-u,N=r(ba,h,X,z),ha=u+z<=T;T=!ha;if(o){ba=o(N,ha,ba);T=typeof ba!="undefined"?ba&&T:T}T&&animFrame(m)}}var u=(new Date).getTime(),da=0,X=y-h;animFrame(m);return{}};COG.easing=function(h){return I[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(h,y){I[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]=y}})();
(function(){var E=/^P(\d+Y)?(\d+M)?(\d+D)?$/,R=/^(\d+H)?(\d+M)?(\d+S)?$/,A={8601:function(f){f=f.split("T");var g=null;g=null;var n=0,s=0;E.lastIndex=-1;g=E.exec(f[0]);n+=g[3]?parseInt(g[3].slice(0,-1),10):0;R.lastIndex=-1;g=R.exec(f[1]);s+=g[1]?parseInt(g[1].slice(0,-1),10)*3600:0;s+=g[2]?parseInt(g[2].slice(0,-1),10)*60:0;s+=g[3]?parseInt(g[3].slice(0,-1),10):0;return new q(n,s)}},q=COG.Duration=function(f,g){return{days:f?f:0,seconds:g?g:0}};COG.addDuration=function(){for(var f=new q,g=arguments.length;g--;){f.days+=
arguments[g].days;f.seconds+=arguments[g].seconds}if(f.seconds>=86400){f.days+=~~(f.seconds/86400);f.seconds%=86400}return f};COG.formatDuration=function(f){var g,n,s="";if(f.days)s=f.days+" days ";if(f.seconds){f=f.seconds;if(f>=3600){g=~~(f/3600);f-=g*3600}if(f>=60){n=Math.round(f/60);f-=n*60}if(g)s=s+g+(g>1?" hrs ":" hr ")+(n?(n>10?n:"0"+n)+" min ":"");else if(n)s=s+n+" min";else if(f>0)s=s+(f>10?f:"0"+f)+" sec"}return s};COG.parseDuration=function(f,g){var n=g?A[g]:null;if(n)return n(f);COG.Log.warn("Could not find duration parser for specified format: "+
g);return new q}})();COG.ObjectStore=function(){var E={},R={},A="obj_"+(new Date).getTime(),q=0,f=Object.prototype.hasOwnProperty;return{add:function(g,n){var s;n=n?n:"default";if(g&&g.constructor)if(!f.call(g,"id"))g.id=A+ ++q;s=R[n]?R[n]:R[n]=[];E[g.id]=s.length;s[g.length]=g}}};var CANI={};
(function(E){var R=[],A=0,q=false,f=E.register=function(g,n){R.push({section:g,run:n})};E.init=function(g){function n(){if(A<R.length){var I=R[A++];s[I.section]||(s[I.section]={});I.run(s[I.section],n)}else{for(I in s)E[I]=s[I];q=true;g&&g(E)}}var s={};if(q&&g)g(E);else{A=0;n()}};f("canvas",function(g,n){function s(){var r,z=I.getContext("2d");z.save();try{z.translate(50,50);z.beginPath();z.rect(0,0,20,20);r=z.isPointInPath(10,10)}finally{z.restore()}return r}var I=document.createElement("canvas"),
h=typeof FlashCanvas!="undefined",y=typeof G_vmlCanvasManager!="undefnined";I.width=200;I.height=200;g.pipTransformed=h||y?false:s();n()})})(CANI);
INTERACT=function(){function E(o){return function(m,u,da){(da?da:o?document.body:document).addEventListener(m,u,false)}}function R(o){return function(m,u,da){(da?da:o?document.body:document).removeEventListener(m,u,false)}}function A(o,m,u){(u?u:document).attachEvent("on"+o,m)}function q(o,m,u){(u?u:document).detachEvent("on"+o,m)}function f(o,m){return{x:o?o:0,y:m?m:0,count:1}}function g(o,m){r.push(COG.extend({handler:null,checks:{},type:o},m))}function n(o){var m=0,u=0;if(o.offsetParent){do{m+=
o.offsetLeft;u+=o.offsetTop;o=o.offsetParent}while(o)}return{left:m,top:u}}function s(o,m){return{source:o,target:m.target?m.target:m.srcElement}}function I(o,m){for(var u=o.target?o.target:o.srcElement;u&&u!==m&&u.nodeName&&u.nodeName.toUpperCase()!="CANVAS";)u=u.parentNode;return u&&u===m}function h(o,m){return{x:o.x-(m?m.left:0),y:o.y-(m?m.top:0)}}function y(o){if(o.preventDefault){o.preventDefault();o.stopPropagation()}else o.cancelBubble&&o.cancelBubble()}var r=[],z=function(o,m,u){function da(O,
U,Y,K){var P=0,ga=0,v=0;COG.tweenValue(0,O,Y,K,function(L){v=P;P=L});COG.tweenValue(0,U,Y,K,function(L){X.trigger("pan",P-v,L-ga);ga=L})}u=COG.extend({binder:null,unbinder:null,observable:null},u);for(var X=u.observable,T=null,ba=[],N=[],ha,ia,pa={bind:function(){return X.bind.apply(null,arguments)},pannable:function(O){T=COG.extend({inertia:true},O);return pa},unbind:function(){X.unbind();for(var O=0;O<ba.length;O++)ba[O].unbind();return pa}},Ba=0;Ba<m.length;Ba++)ba.push(m[Ba](o,X,u));X.bind("pointerDown",
function(){N=[];ia=ha=0});X.bind("pointerMove",function(O,U,Y,K){if(T){N[N.length]={ticks:(new Date).getTime(),x:K.x,y:K.y};X.trigger("pan",K.x,K.y)}ha+=K.x?K.x:0;ia+=K.y?K.y:0});X.bind("pointerUp",function(O,U,Y){if(Math.abs(ha)>20||Math.abs(ia)>20){if(T){Y=N.length;var K,P;U=0;for(P=N.length;--P>1&&U<50;)U+=N[P].ticks-N[P-1].ticks;if(Y-P>1){O=N[Y-1].x-N[P].x;K=N[Y-1].y-N[P].y;P=Math.sqrt(O*O+K*K)|0;if(P>15){O=N[Y-1].x-N[0].x;K=N[Y-1].y-N[0].y;P=Math.sqrt(O*O+K*K)|0;Y=Math.asin(K/P);U=P*500/U|0;
U=U>300?300:U;da(Math.cos(O>0?Y:Math.PI-Y)*U,Math.sin(Y)*U,COG.easing("sine.out"),500)}}}}else X.trigger("tap",U,Y)});return pa};g("pointer",{handler:function(o,m,u){function da(v){if(v.pageX&&v.pageY)return f(v.pageX,v.pageY);else{var L=document.documentElement,aa=document.body;return f(v.clientX+(L&&L.scrollLeft||aa&&aa.scrollLeft||0)-(L&&L.clientLeft||aa&&aa.clientLeft||0),v.clientY+(L&&L.scrollTop||aa&&aa.scrollTop||0)-(L&&L.clientTop||aa&&aa.clientTop||0))}}function X(v){if(I(v,o))if(O=ha(v)){var L=
da(v);o.style.cursor="move";y(v);P=L.x;ga=L.y;U=f(P,ga);m.triggerCustom("pointerDown",s("mouse",v),U,h(U,n(o)))}}function T(v){var L=da(v);Y=L.x;K=L.y;if(I(v,o))ia(v,O?"pointerMove":"pointerHover")}function ba(v){if(O&&ha(v)){O=false;if(I(v,o)){o.style.cursor="default";ia(v,"pointerUp")}}}function N(v){if(I(v,o)){var L;v=v||window.event;if(v.detail)L=v.axis===2?-v.detail*pa:0;else{L=v.wheelDeltaY?v.wheelDeltaY:v.wheelDelta;if(window.opera)L=-L}if(L!==0){var aa=f(Y,K);m.triggerCustom("zoom",s("mouse",
v),aa,h(aa,n(o)),L/Ba,"wheel");y(v);v.returnValue=false}}}function ha(v){v=v||window.event;return(v.which||v.button)==1}function ia(v,L,aa,Z,Ia){aa=typeof aa!="undefined"?aa:Y;Z=typeof Z!="undefined"?Z:K;var C=aa-P,V=Z-ga,H=f(aa,Z);m.triggerCustom(L,s("mouse",v),H,h(H,n(o)),f(C,V));if(typeof Ia=="undefined"||Ia){P=aa;ga=Z}}u=COG.extend({},u);var pa=120,Ba=pa*8,O=false,U,Y,K,P,ga;u.binder("mousedown",X,false);u.binder("mousemove",T,false);u.binder("mouseup",ba,false);u.binder("dblclick",function(v){COG.info("captured double click");
if(I(v,o)){var L=da(v);m.triggerCustom("doubleTap",s("mouse",v),L,h(L,n(o)))}},false);u.binder("mousewheel",N,document);u.binder("DOMMouseScroll",N,document);return{unbind:function(){u.unbinder("mousedown",X,false);u.unbinder("mousemove",T,false);u.unbinder("mouseup",ba,false);u.unbinder("mousewheel",N,document);u.unbinder("DOMMouseScroll",N,document)}}},checks:{touch:false}});g("pointer",{handler:function(o,m,u){function da(C){if(C.count<2)return 0;var V=C.x-C.next.x;C=C.y-C.next.y;return~~Math.sqrt(V*
V+C*C)}function X(C,V,H){V=V?V:0;H=H?H:0;for(var qa={x:C.x-V,y:C.y-H,id:C.id,count:C.count},la=qa;C.next;){C=C.next;la=la.next={x:C.x-V,y:C.y-H,id:C.id}}return qa}function T(C,V){var H=C[V?V:"touches"],qa,la;if(H.length===0)return null;la=qa={x:H[0].pageX,y:H[0].pageY,id:H[0].identifier,count:H.length};for(var ya=1,La=H.length;ya<La;ya++)la=la.next={x:H[ya].pageX,y:H[ya].pageY,id:H[ya].identifier};return qa}function ba(C){if(I(C,o)){K=n(o);var V=T(C,"changedTouches"),H=X(V,K.left,K.top);if(!ga){P=
O;m.triggerCustom("pointerDown",s("touch",C),V,H)}Z&&m.triggerCustom("pointerDownMulti",s("touch",C),V,H);ga=T(C);if(ga.count>1)L=da(ga);Ia=1;aa=X(ga)}}function N(C){if(I(C,o)){C.preventDefault();v=T(C);if(P==O)P=Math.abs(ga.x-v.x)>pa||Math.abs(ga.y-v.y)>pa?Ba:O;if(P!=O){P=v.count>1?Y:U;if(P==Y)if(ga.count===1){ga=X(v);L=da(ga)}else{var V=da(v);if(Math.abs(L-V)<ia)P=U;else{var H;H=v.x;var qa=v.next.x,la=v.y,ya=v.next.y,La=la<ya?la:ya;H={x:(H<qa?H:qa)+(Math.abs(H-qa)>>1),y:La+(Math.abs(la-ya)>>1)};
V=V/L;qa=V-Ia;m.triggerCustom("zoom",s("touch",C),H,h(H,K),qa,"pinch");Ia=V}}P==U&&m.triggerCustom("pointerMove",s("touch",C),v,X(v,K.left,K.top),f(v.x-aa.x,v.y-aa.y));Z&&m.triggerCustom("pointerMoveMulti",s("touch",C),v,X(v,K.left,K.top))}aa=X(v)}}function ha(C){if(I(C,o)){var V=T(C,"changedTouches"),H=X(V,K.left,K.top);v=T(C);if(!v){m.triggerCustom("pointerUp",s("touch",C),V,H);ga=null}Z&&m.triggerCustom("pointerUpMulti",s("touch",C),V,H)}}u=COG.extend({detailed:false,inertia:false},u);var ia=20,
pa=7,Ba=0,O=1,U=2,Y=3,K,P,ga,v,L,aa,Z=u.detailed,Ia=1;u.binder("touchstart",ba,false);u.binder("touchmove",N,false);u.binder("touchend",ha,false);COG.info("initialized touch handler");return{unbind:function(){u.unbinder("touchstart",ba,false);u.unbinder("touchmove",N,false);u.unbinder("touchend",ha,false)}}},checks:{touch:true}});return{register:g,watch:function(o,m,u){m=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},m);capabilities=COG.extend({touch:"ontouchstart"in
window},u);if(!m.observable){COG.info("creating observable");m.observable=COG.observable({});globalOpts=m}m.binder=m.isIE?A:E(m.bindToBody);m.unbinder=m.isIE?q:R(m.bindToBody);u=m.types;for(var da=capabilities,X=[],T=r.length;T--;){var ba=r[T],N=!u||u.indexOf(ba.type)>=0,ha=true;for(var ia in ba.checks){var pa=ba.checks[ia];COG.info("checking "+ia+" capability. require: "+pa+", capability = "+da[ia]);ha=ha&&pa===da[ia]}if(N&&ha)X[X.length]=ba.handler}return new z(o,X,m)}}}();var T5={};
(function(E){function R(){return(new Date).getTime()}function A(){for(;La.length>0;){var a=La.shift();document.location=a}ya=0}function q(a){for(var e=true,b=xb.length;b--;)e=e&&a!=xb[b];return e}function f(a,e){var b=[];for(var c in e)c&&b.push(c+"="+escape(e[c]));return"tile5://"+a+"/"+(b.length>0?"?"+b.join("&"):"")}function g(a,e){q(a)&&COG.info("would push url: "+f(a,e))}function n(a,e){if(q(a)){La.push(f(a,e));ya||(ya=setTimeout(A,100))}}function s(a){return function(e,b,c){(c?c:a?document.body:
document).addEventListener(e,b,false)}}function I(a){return function(e,b,c){(c?c:a?document.body:document).removeEventListener(e,b,false)}}function h(a,e,b){(b?b:document).attachEvent("on"+a,e)}function y(a,e,b){(b?b:document).detachEvent("on"+a,e)}function r(){H={base:{name:"Unknown",bindEvent:s(),unbindEvent:I(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:g,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:h,unbindEvent:y,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:n,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:n},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:n},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:s(true),unbindEvent:I(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:n},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:n}};qa=[H.froyo,H.android,H.ipod,H.iphone,H.ipad,H.ie]}function z(){H||r();if(!la){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<qa.length;a++){var e=qa[a];if(e.regex&&e.regex.test(navigator.userAgent)){la=COG.extend({},H.base,e);COG.info("PLATFORM DETECTED AS: "+la.name);break}}if(!la){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
la=H.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return la}function o(){var a=(new Date).getTime(),e=0;clearTimeout(Ra);for(Ra=0;e<Pa.length;){var b=Pa[e],c=Ma[b],d=Ma[b].image&&(yb||Ma[b].image.complete&&Ma[b].image.width>0),i=a-c.start;i=d||i>=Lb;if(d){d=c.image;c=c.callbacks;zb[b]=d;for(var j=0;j<c.length;j++)c[j](d,true)}if(i){Pa.splice(e,1);delete Ma[b]}else e++}if(Pa.length>0)Ra=setTimeout(o,Ab)}function m(){for(var a=0,e=arguments.length;e--;){var b=Mb[arguments[e].toUpperCase()];
if(b)a|=b}return a}function u(a,e,b,c,d){d=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},d);var i=(new Date).getTime(),j=a[e],p=d.autoInvalidate,w=b.length&&c.length&&b.length==c.length?b.length:0,x=Array(w),G=Array(w),B=COG.easing(d.easing),F=d.duration,W=d.progress,D=function(J){var M=J-i;J=i+F<=J;for(var Q=w;Q--;)G[Q]=B(M,b[Q],x[Q],F);j.apply(a,G);p&&a.invalidate.call(a);if(W){M=[].concat(J?c:G);M.unshift(J);W.apply(a,M)}if(J){j.apply(a,c);d.complete&&
d.complete.apply(a,c)}else X(D)};if(j&&j.apply&&w>0){F=F?F:DEFAULT_DURATION;for(e=w;e--;)x[e]=c[e]-b[e];X(D)}}function da(a,e){var b,c;if(e&&e.width>0){if(!a.imageOffset)a.imageOffset=Z.init(-e.width>>1,-e.height>>1);if(!a.bounds){b=a.xy.x+a.imageOffset.x;c=a.xy.y+a.imageOffset.y;a.bounds=C.init(b,c,b+e.width,c+e.height)}}}function X(a){var e=Sa.length==0;Sa[Sa.length]=a;e&&animFrame(T)}function T(a){a=a?a:(new Date).getTime();if(a-Bb>Nb){for(var e=Sa.splice(0),b=e.length;b--;)e[b](a);Bb=a}Sa.length&&
animFrame(T)}function ba(a){Da.call(this,a)}function N(a,e){e=COG.extend({simplify:false},e);var b=false,c=e.simplify;m("ZOOM");var d=[];e.type=e.fill?"polygon":"line";Da.call(this,e);COG.extend(this,{animatePath:function(){},prepPath:function(i,j,p){if(b){var w=true;i.beginPath();for(var x=d.length;x--;){var G=d[x].x-j,B=d[x].y-p;if(w){i.moveTo(G,B);w=false}else i.lineTo(G,B)}}return b},resync:function(i){var j,p,w,x,G;i.syncXY(a);d=Z.floor(c?Z.simplify(a):a);for(var B=d.length;B--;){i=d[B].x;j=
d[B].y;x=typeof x=="undefined"||i<x?i:x;G=typeof G=="undefined"||j<G?j:G;p=typeof p=="undefined"||i>p?i:p;w=typeof w=="undefined"||j>w?j:w}this.updateBounds(C.init(x,G,p,w),true)}});b=a&&a.length>=2}function ha(a,e){e.fill=false;N.call(this,a,e)}function ia(a){function e(w){(this.imageUrl=w)&&gb(this.imageUrl,function(x,G){j=x;if(G){var B=p.layer?p.layer.getParent():null;B&&B.invalidate()}})}a=COG.extend({image:null,imageUrl:null,imageOffset:null},a);var b=null,c=Da.prototype.updateBounds,d,i,j=a.image;
Da.call(this,a);var p=COG.extend(this,{changeImage:e,drag:function(w,x,G,B){b||(b=Z.init(w.startX-this.xy.x,w.startY-this.xy.y));this.xy.x=x-b.x;this.xy.y=G-b.y;if(B){b=null;if(this.layer)(w=this.layer.getParent())&&w.syncXY([this.xy],true);this.trigger("dragDrop")}return true},draw:function(w){w.drawImage(j,d,i)},prepPath:function(w,x,G){var B=j&&j.width>0;if(B){da(this,j);d=this.xy.x+this.imageOffset.x-x;i=this.xy.y+this.imageOffset.y-G;w.beginPath();w.rect(d,i,j.width,j.height)}return B},updateBounds:function(w,
x){c.call(this,w,x);da(this,j)}});j||e(this.imageUrl)}function pa(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.imageOffset=Z.invert(a.imageAnchor);ia.call(this,a)}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},1E3/60)}}();var Ba=Math.abs,O=Math.min,U=Math.max,Y=Math.pow,K=Math.sqrt,
P=Math.log,ga=Math.round,v=Math.sin,L=Math.asin,aa=Math.cos,Z=function(){function a(c,d){return b(c.x-d.x,c.y-d.y)}function e(c,d){if(!d)d=c.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var i={edges:Array(d-1),accrued:Array(d-1),total:0},j=0;j<d-1;j++){var p=a(c[j],c[j+1]);i.edges[j]=K(p.x*p.x+p.y*p.y);i.accrued[j]=i.total+i.edges[j];i.total+=i.edges[j]}return i}function b(c,d){return{x:c?c:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,
add:function(){for(var c=0,d=0,i=arguments.length;i--;){c+=arguments[i].x;d+=arguments[i].y}return b(c,d)},absSize:function(c){return U(Ba(c.x),Ba(c.y))},copy:function(c){return c?b(c.x,c.y):null},diff:a,distance:function(c,d){return e(c,d).total},edges:e,equals:function(c,d){return c.x===d.x&&c.y===d.y},extendBy:function(c,d,i){var j=aa(d)*i|0;d=v(d)*i|0;return b(c.x-j,c.y-d)},floor:function(c){for(var d=Array(c.length),i=c.length;i--;)d[i]=b(~~c[i].x,~~c[i].y);return d},getRect:function(c){for(var d,
i,j,p,w=c.length;w--;){var x=c[w];d=typeof d==="undefined"||x.x<d?x.x:d;i=typeof i==="undefined"||x.y<i?x.y:i;j=typeof j==="undefined"||x.x>j?x.x:j;p=typeof p==="undefined"||x.y>p?x.y:p}return C.init(d,i,j,p)},init:b,invert:function(c){return b(-c.x,-c.y)},min:function(c,d){return b(c.x<d.x?c.x:d.x,c.y<d.y?c.y:d.y)},max:function(c,d){return b(c.x>d.x?c.x:d.x,c.y>d.y?c.y:d.y)},offset:function(c,d,i){return b(c.x+d,c.y+(i?i:d))},scale:function(c,d){return b(c.x/d|0,c.y/d|0)},simplify:function(c,d){if(!c)return null;
d=d?d:Z.VECTOR_SIMPLIFICATION;for(var i=[],j=null,p=c.length;p--;){var w=c[p];if(include=!j||p===0||Ba(w.x-j.x)+Ba(w.y-j.y)>d){i.unshift(w);j=w}}return i},theta:function(c,d,i){i=L((c.y-d.y)/i);return c.x>d.x?i:Math.PI-i},toString:function(c){return c?c.x+", "+c.y:""}}}(),Ia=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),C=function(){function a(b){return e(b.x1,b.y1,b.x2,b.y2)}function e(b,c,d,i){b=b?b:0;c=c?c:0;d=typeof d!=="undefined"?d:b;i=typeof i!=="undefined "?i:i;return{x1:b,
y1:c,x2:d,y2:i,width:d-b,height:i-c}}return{center:function(b){return Z.init(b.x1+(b.width>>1),b.y1+(b.height>>1))},copy:a,diagonalSize:function(b){return K(b.width*b.width+b.height*b.height)},fromCenter:function(b,c,d,i){d=d>>1;i=i>>1;return e(b-d,c-i,b+d,c+i)},init:e,intersect:function(b,c){var d=U(b.x1,c.x1),i=U(b.y1,c.y1),j=O(b.x2,c.x2),p=O(b.y2,c.y2);d=e(d,i,j,p);return d.width>0&&d.height>0?d:null},toString:function(b){return b?"["+b.x1+", "+b.y1+", "+b.x2+", "+b.y2+"]":""},union:function(b,
c){if(b.width===0||b.height===0)return a(c);else if(c.width===0||c.height===0)return a(b);else{var d=O(b.x1,c.x1),i=O(b.y1,c.y1),j=U(b.x2,c.x2),p=U(b.y2,c.y2);d=e(d,i,j,p);return d.width>0&&d.height>0?d:null}}}}(),V=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return Z.init(a.width>>1,a.height>>1)},getSize:function(a){return K(Y(a.width,2)+Y(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,height:e?e:a}}}}();Hits=function(){return{diffHits:function(a,
e){var b=[],c={},d;for(d=e.length;d--;)c[e[d].target.id]=true;for(d=a.length;d--;)c[a[d].target.id]||(b[b.length]=a[d]);return b},init:function(a,e,b,c){return{type:a,x:c.x|0,y:c.y|0,elements:[],absXY:e,relXY:b}},initHit:function(a,e,b){return{type:a,target:e,drag:b}},triggerEvent:function(a,e,b,c){e.triggerCustom(a.type+(b?b:"Hit"),{hitType:a.type},c?c:a.elements,a.absXY,a.relXY,Z.init(a.x,a.y))}}}();var H=null,qa=[],la=null,ya=0,La=[],xb=["view.wake","tile.loaded"],Ab=100,Lb=3E4,zb={},Ob=0;(new Date).getTime();
var Ma={},Pa=[],yb=typeof FlashCanvas!="undefined",Ra=0,gb=T5.getImage=function(a,e){var b=a&&e?zb[a]:null;if(b&&b&&(yb||b.complete&&b.width>0))e(b);else{if(b=Ma[a])b.callbacks.push(e);else{b=new Image;b.id="_ldimg"+ ++Ob;Ma[a]={start:(new Date).getTime(),image:b,callbacks:[e]};b.src=a;Pa[Pa.length]=a}Ra||(Ra=setTimeout(o,Ab))}};T5.newCanvas=function(a,e){var b=document.createElement("canvas");b.width=a?a:0;b.height=e?e:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(b);FlashCanvas.initElement(b)}typeof G_vmlCanvasManager!=
"undefined"&&G_vmlCanvasManager.initElement(b);return b};var hb=function(){var a={};return{init:function(e,b){var c=a[e];if(!c)throw Error("Unable to locate requested generator: "+e);return new c(b)},register:function(e,b){a[e]=b},Template:function(){}}}(),Ta=function(){function a(j,p){d[j]=b(p);return j}function e(j){for(var p in j)a(p,j[p])}function b(j){function p(B){var F=j[B];typeof F!=="undefined"&&x.push(function(W){W[B]=F})}function w(){x=[];for(var B in j)p(B)}j=COG.extend({lineWidth:undefined,
lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},j);var x=[],G={applyToContext:function(B){for(var F=x.length;F--;)x[F](B)},update:function(B,F){j[B]=F;w()}};w();return G}var c={},d={},i={apply:function(j,p){var w=d[p]?d[p]:d.basic,x;if(j&&j.canvas){x=c[j.canvas.id];c[j.canvas.id]=p}w.applyToContext(j);return x},define:a,defineMany:e,get:function(j){return d[j]},init:b,load:function(j){COG.jsonp(j,
function(p){e(p)})}};e({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});return i}(),Mb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},ib=function(a){a=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:m("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);var e=null,b=false,c=false,d=a.id,i=m("ACTIVE"),
j=a.validStates,p=0,w=0,x=COG.extend({addToView:function(G){G.setLayer(d,x)},shouldDraw:function(G){return(G&j)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){x.trigger("remove",x)},changed:function(){c=true;e&&e.invalidate()},hitTest:null,getId:function(){return d},setId:function(G){d=G},getParent:function(){return e},setParent:function(G){b=(e=G)?e.fastDraw&&displayState!==i:false;x.trigger("parentChange",e)}},a);COG.observable(x);x.bind("drawComplete",function(G,
B){c=false;p=B.x1;w=B.y1});x.bind("resync",function(G,B){x.minXY&&B.syncXY(x.minXY);x.maxXY&&B.syncXY(x.maxXY)});return x},Da=function(a){a=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape"},a);COG.extend(this,a);this.id=COG.objId(this.type);this.view=this.bounds=null;this.rotation=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};Da.prototype={constructor:Da,animate:function(a,e,b,c){u(this,
a,e,b,c)},drag:null,draw:function(a){this.fill&&a.fill();this.stroke&&a.stroke()},invalidate:function(){var a=this.layer?this.layer.getParent():null;a&&a.invalidate()},prepPath:function(){},resync:function(a){if(this.xy){a.syncXY([this.xy]);this.size&&this.updateBounds(C.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},rotate:function(a){this.rotation=a},scale:function(a){this.scaling=a},translate:function(a,e){this.translateX=a;this.translateY=e},updateBounds:function(a,e){this.bounds=a;if(e)this.xy=
C.center(this.bounds)}};var Nb=1E3/60|0,Sa=[],Bb=0;ba.prototype=COG.extend(Da.prototype,{constructor:ba,prepPath:function(a,e,b){a.beginPath();a.arc(this.xy.x-e,this.xy.y-b,this.size>>1,0,Math.PI*2,false);return true}});N.prototype=COG.extend({},Da.prototype,{constructor:N});ha.prototype=COG.extend({},N.prototype);ia.prototype=COG.extend({},Da.prototype,{constructor:ia});pa.prototype=COG.extend({},ia.prototype,{constructor:pa});var Cb=function(a){a=COG.extend({zindex:10},a);var e=[],b=CANI.canvas.pipTransformed,
c=COG.extend(new ib(a),{draw:function(d,i,j,p,w,x){p=i.x1;w=i.y1;var G=x?b?x.x-p:x.relXY.x:0,B=x?b?x.y-w:x.relXY.y:0,F=i.width;i=i.height;for(var W=e.length;W--;){var D=e[W],J=D.xy.x,M=D.xy.y,Q=D.style||c.style,ra=D.scaling!==1||D.rotatation||D.translateX||D.translateY;if(ra){d.save();d.translate(J-p+D.translateX,M-w+D.translateY);D.rotation!==0&&d.rotate(D.rotation);D.scaling!==1&&d.scale(D.scaling,D.scaling);if(b){G-=J;B-=M}}if(D.prepPath(d,ra?J:p,ra?M:w,F,i,j)){if(x&&d.isPointInPath(G,B)){x.elements.push(Hits.initHit(D.type,
D,D.draggable?D.drag:null));J=x.type+"Style";Q=D[J]||c[J]||Q}Q=Q?Ta.apply(d,Q):null;D.draw(d,p,w,F,i,j);Q&&Ta.apply(d,Q)}ra&&d.restore()}},getDrawables:function(){return[]},hitGuess:function(d,i){for(var j=false,p=e.length;!j&&p--;){var w=e[p];if(!(j=j))j=(w=w.bounds)&&d>=w.x1&&d<=w.x2&&i>=w.y1&&i<=w.y2;j=j}return j}});c.bind("refresh",function(d,i,j){e=c.getDrawables(i,j)});return c},Db=function(a){function e(i){for(var j=c.length;j--;)c[j].resync(i);c.sort(function(p,w){var x=w.xy.y-p.xy.y;return x!=
0?x:w.xy.x-p.xy.y});d.changed()}function b(i,j){e(j)}a=COG.extend({zindex:10},a);var c=[],d=COG.extend(new Cb(a),{add:function(i,j){if(i){i.layer=d;var p=d.getParent();if(p){i.resync(d.getParent());p.invalidate()}if(j)c.unshift(i);else c[c.length]=i}},clear:function(){c=[]},find:function(){return[].concat(c)},getDrawables:function(){return c}});d.bind("parentChange",b);d.bind("resync",b);return d},Pb=function(){return{tileSize:256,init:function(a,e,b,c,d){return COG.extend({x:a,y:e,width:b,height:c},
d)}}}();COG.extend(E,{ex:COG.extend,ticks:R,getConfig:z,userMessage:function(a,e,b){E.trigger("userMessage",a,e,b)},XY:Z,XYRect:C,Dimensions:V,Vector:Ia,Hits:Hits,Generator:hb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ta,viewState:m,View:function(a){function e(k,l,t){Ea||Xa(ea-l,fa-t)}function b(k,l,t,S){jb(O(U(ka+Y(2,S)-1,0.5),2))}function c(){var k=P(ka)/Math.LN2|0;if(k!==0){ka=Y(2,k);Eb(Ua+k,Ya,Za)}ma()}function d(k){k||(k=Z.init(Na,Oa));kb=Z.init(ea,fa);
Va=Z.offset(k,ea,fa);Ya=Va.x;Za=Va.y}function i(k,l){var t=1/ka;return Z.init(Ja?Ja.x1+k*t:k,Ja?Ja.y1+l*t:l)}function j(k,l,t){Qa("doubleTap",l,t,i(t.x,t.y));a.scalable&&jb(2,t,a.zoomEasing,null,a.zoomDuration)}function p(k,l,t){Ea=null;ra("down",l,t)}function w(k,l,t){ra("hover",l,t)}function x(k,l,t){M(l,t,false)}function G(k,l,t){M(l,t,true)}function B(){clearTimeout(Fb);Fb=setTimeout(W,250)}function F(k,l,t){ra("tap",l,t);Qa("tap",l,t,i(t.x,t.y,true))}function W(k,l){var t;$a=typeof FlashCanvas!==
"undefined";COG.info("is flash = "+$a);if(na){if(a.autoSize&&na.parentNode){k=na.parentNode.offsetWidth;l=na.parentNode.offsetHeight}try{if(!na.id)na.id=a.id+"_canvas";sa=na.getContext("2d")}catch(S){COG.exception(S);throw Error("Could not initialise canvas on specified view element");}if(k&&l&&(ta!==l||ua!==k)){lb=true;ua=k;ta=l;Na=ua>>1;Oa=ta>>1;ja.trigger("resize",ua,ta);for(t=za;t--;)ca[t].trigger("resize",ua,ta)}for(t=za;t--;)ca[t].trigger("contextChanged",sa);ma();J()}}function D(k,l){l.setId(k);
l.added=R();l.bind("remove",function(){ja.removeLayer(k)});l.trigger("contextChanged",sa);l.setParent(ja);ca.push(l);ca.sort(function(t,S){var $=S.zindex-t.zindex;if($===0)$=S.added-t.added;return $});za=ca.length;return l}function J(){Aa&&Aa.unbind();Aa=INTERACT.watch(na);a.pannable&&Aa.pannable().bind("pan",e);if(a.scalable){Aa.bind("zoom",b);Aa.bind("doubleTap",j)}Aa.bind("pointerDown",p);Aa.bind("pointerMove",x);Aa.bind("pointerUp",G);a.captureHover&&Aa.bind("pointerHover",w);Aa.bind("tap",F)}
function M(k,l,t){if(Ea){k=i(l.x,l.y);Ea.drag.call(Ea.target,Ea,k.x,k.y,t)&&ma();if(t)Ea=null}}function Q(k){var l,t,S=false;if(mb|$a){k=k?k:(new Date).getTime();if(k-Gb>Qb){t=ea!==nb||fa!==ob;Fa=Hb|(ka!==1?Ib:0)|(t?pb:0)|(qb?rb:0);sb=(l=(Fa&(Ib|pb))!==0)&&(Fa&rb)===0;if(lb&&na){na.width=ua;na.height=ta;na.style.width=ua+"px";na.style.height=ta+"px";$a&&FlashCanvas.initElement(na);typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(na);lb=false}ab=bb();for(t=za;t--;){Fa|=ca[t].animated?
rb:0;ca[t].cycle(k,ab,Fa);S=ca[t].clip||S}t=Fa;var $=ab;S=Rb&&S&&!l;l=k;var oa;C.center($);var va=0,wa;if(ka!==1){wa=1/ka;Ya=Va.x+(ea-kb.x);Za=Va.y+(fa-kb.y);wa=$?C.fromCenter(Ya>>0,Za>>0,$.width*wa>>0,$.height*wa>>0):void 0}else wa=C.copy($);Ja=wa;S||sa.clearRect(0,0,ua,ta);Ja.scaleFactor=ka;sa.save();try{ka!==1&&sa.scale(ka,ka);cb=db=null;if(S){sa.beginPath();for(va=za;va--;)ca[va].clip&&ca[va].clip(sa,Ja,t,ja,l);sa.closePath();sa.clip()}sa.globalCompositeOperation="source-over";for(va=za;va--;){oa=
ca[va];if(oa.shouldDraw(Fa,ab)){var xa=oa.style,Ka=xa?Ta.apply(sa,xa):null;oa.draw(sa,Ja,t,ja,l,Ca);Ka&&Ta.apply(sa,Ka)}}}finally{sa.restore()}mb=0;Qa("drawComplete",$,l);if(Ca){oa=Ca?Ca.elements:[];if(Wa&&Wa.type==="hover"){xa=Hits.diffHits(Wa.elements,oa);xa.length>0&&Hits.triggerEvent(Wa,ja,"Out",xa)}if(oa.length>0){Ka=Ca.x;t=Ca.y;for(xa=oa.length;xa--;){$=oa[xa];S=Ka;l=t;if(va=$&&$.drag&&(!$.canDrag||$.canDrag($,S,l))){Ea=$;Ea.startX=S;Ea.startY=l}if(va)break}Hits.triggerEvent(Ca,ja)}Wa=oa.length>
0?COG.extend({},Ca):null;Ca=null}k-Jb>Sb&&tb();Gb=k;nb=ea;ob=fa}animFrame(Q)}else ub=false}function ra(k,l,t){Ca=Hits.init(k,l,t,i(t.x,t.y,true));for(k=za;k--;)vb=vb||(ca[k].hitGuess?ca[k].hitGuess(Ca.x,Ca.y,Fa,ja):false);vb&&ma()}function ma(){mb+=1;if(!ub){ub=true;animFrame(Q)}}function bb(){return C.init(ea,fa,ea+ua,fa+ta)}function tb(){if(Ga||Ha){var k=eb?ea+Na:ea,l=fb?fa+Oa:fa;if(Ga&&Ga>ua)if(k+ua>Ga)ea=eb?k-Ga>0?ea-Ga:ea:Ga-ua;else if(k<0)ea=eb?ea+Ga:0;if(Ha&&Ha>ta)if(l+ta>Ha)fa=fb?l-Ha>0?fa-
Ha:fa:Ha-ta;else if(l<0)fa=fb?fa+Ha:0}Jb=(new Date).getTime();Qa("refresh",ja,bb());ma()}function jb(k,l,t,S,$){if(t)COG.tweenValue(ka,k,t,$,function(oa,va){ka=oa;if(va){var wa=ga(P(ka)/Math.LN2);ka=Y(2,wa);S&&S()}d(l);c()});else{ka=k;d(l);c()}return ja}function Eb(k,l,t){k=U(a.minZoom,O(a.maxZoom,k));if(k!==Ua){var S=Y(2,k-Ua),$=Na/S|0,oa=Oa/S|0;Ua=k;Xa(((l?l:ea+Na)-$)*S,((t?t:fa+Oa)-oa)*S);nb=ea;ob=fa;Qa("zoomLevelChange",k);ka=1;tb()}}function Qa(){for(var k=ja.trigger.apply(null,arguments).cancel,
l=ca.length;l--;)k=ca[l].trigger.apply(null,arguments).cancel||k;return!k}function Xa(k,l,t,S,$){function oa(){va+=1;if(va>=2){qb=false;$&&$()}}var va=0,wa=db?Z.offset(db,-Na,-Oa):null,xa=cb?Z.offset(cb,-Na,-Oa):null;if(wa){k=k<wa.x?wa.x:k;l=l<wa.y?wa.y:l}if(xa){k=k>xa.x?xa.x:k;l=l>xa.y?xa.y:l}if(t){if((Fa&pb)===0){COG.tweenValue(ea,k,t,S,function(Ka,wb){ea=Ka|0;(wb?oa:ma)();return!sb});COG.tweenValue(fa,l,t,S,function(Ka,wb){fa=Ka|0;(wb?oa:ma)();return!sb});qb=true}}else{ea=k|0;fa=l|0;ma();$&&$()}}
a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},a);var ca=[],za=0,na=document.getElementById(a.container),Ea=null,sa=null,Tb=typeof window.attachEvent!=
"undefined",$a,vb=false,Sb=a.minRefresh,ea=0,fa=0,nb=0,ob=0,Ga=null,Ha=null,eb=false,fb=false,Rb=a.clipping,ab=null,ub=false,Ja,Kb=1,Na=0,Oa=0,Ca=null,kb=null,Va=null,sb=false,db=null,cb=null,Jb=0,Wa=null,Fb=0,ka=1,Gb=0,lb=false,Aa=null,qb=false,ta,ua,Qb=1E3/a.fps|0,mb=0,Ya,Za,Ua=a.zoomLevel,Hb=m("ACTIVE"),pb=m("PAN"),Ib=m("ZOOM"),rb=m("ANIMATING"),Fa=Hb,ja={id:a.id,deviceScaling:Kb,fastDraw:a.fastDraw||z().requireFastDraw,detach:function(){Aa&&Aa.unbind()},eachLayer:function(k){for(var l=za;l--;)k(ca[l])},
getDimensions:function(){return V.init(ua,ta)},getLayer:function(k){for(var l=0;l<za;l++)if(ca[l].getId()==k)return ca[l];return null},getZoomLevel:function(){return Ua},setLayer:function(k,l){for(var t=0;t<za;t++)if(ca[t].getId()===k){ca.splice(t,1);break}if(l){D(k,l);l.trigger("refresh",ja,bb())}ma();return l},invalidate:ma,refresh:tb,resetScale:function(){ka=1},resize:function(k,l){if(na){a.autoSize=false;if(ua!==k||ta!==l)W(k,l)}},scale:jb,setZoomLevel:Eb,syncXY:function(){},triggerAll:Qa,removeLayer:function(k){a:{for(var l=
za;l--;)if(ca[l].getId()==k){k=l;break a}k=-1}if(k>=0&&k<za){ja.trigger("layerRemoved",ca[k]);ca.splice(k,1);ma()}za=ca.length},getOffset:function(){return Z.init(ea,fa)},setMaxOffset:function(k,l,t,S){Ga=k;Ha=l;eb=typeof t!="undefined"?t:false;fb=typeof S!="undefined"?S:false},getViewRect:bb,updateOffset:Xa,pan:function(k,l,t,S,$){Xa(ea+k,fa+l,t,S,$)}};Kb=z().getScaling();COG.observable(ja);ja.bind("invalidate",function(){ma()});ja.bind("resync",function(){cb=db=null});COG.configurable(ja,["container",
"captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(a,null,{container:function(k,l){na=document.getElementById(l);W()},inertia:J,captureHover:J,scalable:J,pannable:J}),true);CANI.init(function(k){ja.markers=D("markers",new Db({zindex:20}));canvasCaps=k.canvas;W();if(a.autoSize)Tb?window.attachEvent("onresize",B):window.addEventListener("resize",B,false)});return ja},ViewLayer:ib,ImageLayer:function(a,e){function b(B,F,W,D){F.image?B.drawImage(F.image,
W,D):gb(F.url,function(J){F.image=J;G.changed()})}function c(B,F,W){for(F=p.length;F--;){var D=p[F],J=D.x,M=D.y,Q=C.init(D.x,D.y,D.x+D.width,D.y+D.height);W&&C.intersect(B,Q)&&gb(D.url,function(ra,ma){W(ra,J,M,D.width,D.height);ma&&G.changed()},x)}}function d(B){var F=w?Math.abs(w.x1-B.x1)+Math.abs(w.y1-B.y1):0;if(i&&(!w||F>256)){var W=++j;F=G.getParent();i.run(F,B,function(D){w=C.copy(B);if(W==j)for(var J=D.length;J--;){var M=D[J];p[p.length]={image:null,sequence:W,url:M.url,rect:C.init(M.x,M.y,
M.x+M.width,M.y+M.height)}}})}}e=COG.extend({imageLoadArgs:{}},e);var i=a?hb.init(a,e):null,j=0,p=[],w=null,x=e.imageLoadArgs,G=COG.extend(new ib(e),{changeGenerator:function(B,F){i=hb.init(B,COG.extend({},e,F));d(G.getParent().getViewRect())},clip:function(B,F){for(var W=F.x1,D=F.y1,J=p.length;J--;){var M=p[J].rect;C.intersect(F,M)&&B.rect(M.x1-W,M.y1-D,M.width,M.height)}},draw:function(B,F){for(var W=F.x1,D=F.y1,J=0;J<p.length;){var M=p[J],Q=M.rect;C.intersect(F,Q)&&b(B,M,Q.x1-W,Q.y1-D);if(M.sequence!==
j)p.splice(J,1);else J++}},mask:function(B,F,W){c(F,W,function(D,J,M,Q,ra){COG.info("clearing rect @ x = "+J+", y = "+M+", width = "+Q+", height = "+ra);B.clearRect(J,M,Q,ra)})}});G.bind("refresh",function(B,F,W){d(W)});G.bind("tap",function(B,F,W,D){B=[];var J=D.x,M=D.y,Q,ra;if(p)for(var ma=p.length;ma--;){Q=p[ma];if(ra=J>=Q.x&&J<=Q.x+Q.width&&M>=Q.y&&M<=Q.y+Q.height)B[B.length]=Q}B.length>0&&G.trigger("tapImage",B,F,W,D)});return G},ImageGenerator:function(a){a=COG.extend({relative:false,padding:2},
a);a={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(a);return a},Drawable:Da,Marker:ba,Poly:N,Line:ha,ImageDrawable:ia,ImageMarker:pa,DrawLayer:Cb,ShapeLayer:Db,Tiling:Pb});COG.observable(E)})(T5);
