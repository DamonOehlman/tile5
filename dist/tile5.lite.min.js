COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var O=arguments[0]||{},da,B=1,t=arguments.length;B<t;B++)if((da=arguments[B])!==null)for(var g in da){var j=da[g];if(O!==j)if(j!==undefined)O[g]=j}return O};
(function(){var O=Object.prototype.hasOwnProperty,da=0,B={};B.toID=function(t){return t.replace(/\s/g,"-")};B.objId=function(t){return(t?t:"obj")+da++};B.isFunction=function(t){return toString.call(t)==="[object Function]"};B.isArray=function(t){return toString.call(t)==="[object Array]"};B.isPlainObject=function(t){if(!t||toString.call(t)!=="[object Object]"||t.nodeType||t.setInterval)return false;if(t.constructor&&!O.call(t,"constructor")&&!O.call(t.constructor.prototype,"isPrototypeOf"))return false;
var g;for(g in t);return g===undefined||O.call(t,g)};B.isEmptyObject=function(t){for(var g in t)return false;return true};B.isXmlDocument=function(t){return toString.call(t)==="[object Document]"};B.contains=function(t,g){var j=t,u=arguments,w=1;if(g&&module.isArray(g)){u=g;w=0}for(w=w;w<u;w++)j=j&&typeof foo[u[w]]!=="undefined";return j};B.formatStr=function(t){if(arguments.length<=1)return t;for(var g=arguments.length-2,j=0;j<=g;j++)t=t.replace(RegExp("\\{"+j+"\\}","gi"),arguments[j+1]);return t};
B.wordExists=function(t,g){var j="";if(g.toString)g=g.toString();for(var u=0;u<g.length;u++)j+=!/\w/.test(g[u])?"\\"+g[u]:g[u];return RegExp("(^|\\s|\\,)"+j+"(\\,|\\s|$)","i").test(t)};COG.extend(COG,B)})();
(function(){function O(j){return typeof console!=="undefined"?function(){console[j](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var da=window.console&&window.console.markTimeline,B=O("error"),t=O("info"),g=function(){return da?function(j,u){console.markTimeline(j+(u?": "+((new Date).getTime()-u)+"ms":""))}:function(){}}();COG.extend(COG,{trace:g,debug:O("debug"),info:t,warn:O("warn"),error:B,exception:function(j){if(B)for(var u in j)t("ERROR DETAIL: "+
u+": "+j[u])}})})();
(function(){function O(B,t){var g=B.obsHandlers;g[t]||(g[t]=[]);return g[t]}var da=0;COG.observable=function(B){if(!B)return null;if(!B.obsHandlers)B.obsHandlers={};if(!(B.bind||B.trigger||B.unbind)){B.bind=function(t,g){var j="callback"+da++;O(B,t).unshift({fn:g,id:j});return j};B.triggerCustom=function(t,g){var j=O(B,t),u={cancel:false,name:t,source:B},w;g&&COG.extend(u,g);if(!j)return null;w=Array.prototype.slice.call(arguments,2);B.eventInterceptor&&B.eventInterceptor(t,u,w);w.unshift(u);for(var f=
j.length;f--&&!u.cancel;)j[f].fn.apply(this,w);return u};B.trigger=function(t){var g=Array.prototype.slice.call(arguments,1);g.splice(0,0,t,null);return B.triggerCustom.apply(this,g)};B.unbind=function(t,g){if(typeof t==="undefined")B.obsHandlers={};else for(var j=O(B,t),u=0;j&&u<j.length;u++)if(j[u].id===g){j.splice(u,1);break}return B}}return B}})();
(function(){function O(g,j){g[j]||(g[j]=function(u){return g.configure(j,u)})}function da(g){g.gtConfId="configurable"+t++;g.gtConfig={};g.gtConfigFns=[];return g.gtConfig}var B={},t=0;COG.paramTweaker=function(g,j,u){return function(w,f){if(typeof f!=="undefined"){if(w in g)g[w]=f;u&&w in u&&u[w](w,f)}else return j&&w in j?j[w](w):g[w]}};COG.configurable=function(g,j,u,w){if(g){g.gtConfId||da(g);var f=g.gtConfId,v=g.gtConfig,s=g.gtConfigFns;B[f]=g;s.push(u);for(u=j.length;u--;){v[j[u]]=true;w&&O(g,
j[u])}if(!g.configure)g.configure=function(z,P){if(v[z]){for(var n=s.length;n--;){var p=s[n](z,P);if(typeof p!=="undefined")return p}return B[f]}return null}}}})();
(function(){function O(g){var j=document.createElement("script"),u=false;j.src=g;j.async=true;j.onload=j.onreadystatechange=function(){if(!u&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){u=true;j.onload=j.onreadystatechange=null;j&&j.parentNode&&j.parentNode.removeChild(j)}};B||(B=document.getElementsByTagName("head")[0]);B.appendChild(j)}var da=0,B,t=this;COG.jsonp=function(g,j,u){g+=g.indexOf("?")>=0?"&":"?";var w="json"+ ++da;t[w]=function(f){j(f);t[w]=null;try{delete t[w]}catch(v){}};
O(g+(u?u:"callback")+"="+w);return w}})();
(function(){var O=1.70158,da=Math.PI/2,B=Math.abs,t=Math.pow,g=Math.sin,j=Math.asin,u=Math.cos,w={linear:function(f,v,s,z){return s*f/z+v},backin:function(f,v,s,z){return s*(f/=z)*f*((O+1)*f-O)+v},backout:function(f,v,s,z){return s*((f=f/z-1)*f*((O+1)*f+O)+1)+v},backinout:function(f,v,s,z){return(f/=z/2)<1?s/2*f*f*(((O*=1.525)+1)*f-O)+v:s/2*((f-=2)*f*(((O*=1.525)+1)*f+O)+2)+v},bouncein:function(f,v,s,z){return s-w.bounceout(z-f,0,s,z)+v},bounceout:function(f,v,s,z){return(f/=z)<1/2.75?s*7.5625*f*
f+v:f<2/2.75?s*(7.5625*(f-=1.5/2.75)*f+0.75)+v:f<2.5/2.75?s*(7.5625*(f-=2.25/2.75)*f+0.9375)+v:s*(7.5625*(f-=2.625/2.75)*f+0.984375)+v},bounceinout:function(f,v,s,z){return f<z/2?w.bouncein(f*2,0,s,z)/2+v:w.bounceout(f*2-z,0,s,z)/2+s/2+v},cubicin:function(f,v,s,z){return s*(f/=z)*f*f+v},cubicout:function(f,v,s,z){return s*((f=f/z-1)*f*f+1)+v},cubicinout:function(f,v,s,z){if((f/=z/2)<1)return s/2*f*f*f+v;return s/2*((f-=2)*f*f+2)+v},elasticin:function(f,v,s,z,P,n){if(f==0)return v;if((f/=z)==1)return v+
s;n||(n=z*0.3);if(!P||P<B(s)){P=s;s=n/4}else s=n/TWO_PI*j(s/P);return-(P*t(2,10*(f-=1))*g((f*z-s)*TWO_PI/n))+v},elasticout:function(f,v,s,z,P,n){var p;if(f==0)return v;if((f/=z)==1)return v+s;n||(n=z*0.3);if(!P||P<B(s)){P=s;p=n/4}else p=n/TWO_PI*j(s/P);return P*t(2,-10*f)*g((f*z-p)*TWO_PI/n)+s+v},elasticinout:function(f,v,s,z,P,n){var p;if(f==0)return v;if((f/=z/2)==2)return v+s;n||(n=z*0.3*1.5);if(!P||P<B(s)){P=s;p=n/4}else p=n/TWO_PI*j(s/P);if(f<1)return-0.5*P*t(2,10*(f-=1))*g((f*z-p)*TWO_PI/n)+
v;return P*t(2,-10*(f-=1))*g((f*z-p)*TWO_PI/n)*0.5+s+v},quadin:function(f,v,s,z){return s*(f/=z)*f+v},quadout:function(f,v,s,z){return-s*(f/=z)*(f-2)+v},quadinout:function(f,v,s,z){if((f/=z/2)<1)return s/2*f*f+v;return-s/2*(--f*(f-2)-1)+v},sinein:function(f,v,s,z){return-s*u(f/z*da)+s+v},sineout:function(f,v,s,z){return s*g(f/z*da)+v},sineinout:function(f,v,s,z){return-s/2*(u(Math.PI*f/z)-1)+v}};COG.tweenValue=function(f,v,s,z,P){function n(T){var Q=T-p,ia=s(Q,f,x,z),ha=p+z<=T;T=!ha;if(P){Q=P(ia,
ha,Q);T=typeof Q!="undefined"?Q&&T:T}T&&animFrame(n)}var p=(new Date).getTime(),x=v-f;animFrame(n);return{}};COG.easing=function(f){return w[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(f,v){w[f.replace(/[\-\_\s\.]/g,"").toLowerCase()]=v}})();
(function(){var O=/^P(\d+Y)?(\d+M)?(\d+D)?$/,da=/^(\d+H)?(\d+M)?(\d+S)?$/,B={8601:function(g){g=g.split("T");var j=null;j=null;var u=0,w=0;O.lastIndex=-1;j=O.exec(g[0]);u+=j[3]?parseInt(j[3].slice(0,-1),10):0;da.lastIndex=-1;j=da.exec(g[1]);w+=j[1]?parseInt(j[1].slice(0,-1),10)*3600:0;w+=j[2]?parseInt(j[2].slice(0,-1),10)*60:0;w+=j[3]?parseInt(j[3].slice(0,-1),10):0;return new t(u,w)}},t=COG.Duration=function(g,j){return{days:g?g:0,seconds:j?j:0}};COG.addDuration=function(){for(var g=new t,j=arguments.length;j--;){g.days+=
arguments[j].days;g.seconds+=arguments[j].seconds}if(g.seconds>=86400){g.days+=~~(g.seconds/86400);g.seconds%=86400}return g};COG.formatDuration=function(g){var j,u,w="";if(g.days)w=g.days+" days ";if(g.seconds){g=g.seconds;if(g>=3600){j=~~(g/3600);g-=j*3600}if(g>=60){u=Math.round(g/60);g-=u*60}if(j)w=w+j+(j>1?" hrs ":" hr ")+(u?(u>10?u:"0"+u)+" min ":"");else if(u)w=w+u+" min";else if(g>0)w=w+(g>10?g:"0"+g)+" sec"}return w};COG.parseDuration=function(g,j){var u=j?B[j]:null;if(u)return u(g);COG.Log.warn("Could not find duration parser for specified format: "+
j);return new t}})();
INTERACT=function(){function O(n){return function(p,x,T){(T?T:n?document.body:document).addEventListener(p,x,false)}}function da(n){return function(p,x,T){(T?T:n?document.body:document).removeEventListener(p,x,false)}}function B(n,p,x){(x?x:document).attachEvent("on"+n,p)}function t(n,p,x){(x?x:document).detachEvent("on"+n,p)}function g(n,p){return{x:n?n:0,y:p?p:0,count:1}}function j(n,p){z.push(COG.extend({handler:null,checks:{},type:n},p))}function u(n){var p=0,x=0;if(n.offsetParent){do{p+=n.offsetLeft;
x+=n.offsetTop;n=n.offsetParent}while(n)}return{x:p,y:x}}function w(n,p){return{source:n,target:p.target?p.target:p.srcElement}}function f(n,p){for(var x=n.target?n.target:n.srcElement;x&&x!==p&&x.nodeName&&x.nodeName.toUpperCase()!="CANVAS";)x=x.parentNode;return x&&x===p}function v(n,p){return{x:n.x-(p?p.x:0),y:n.y-(p?p.y:0)}}function s(n){if(n.preventDefault){n.preventDefault();n.stopPropagation()}else n.cancelBubble&&n.cancelBubble()}var z=[],P=function(n,p,x){function T(K,W,S,L){var M=0,ea=0,
q=0;COG.tweenValue(0,K,S,L,function(aa){q=M;M=aa});COG.tweenValue(0,W,S,L,function(aa){Q.trigger("pan",M-q,aa-ea);ea=aa})}x=COG.extend({binder:null,unbinder:null,observable:null},x);for(var Q=x.observable,ia=null,ha=[],$=[],pa,qa,R={bind:function(){return Q.bind.apply(null,arguments)},pannable:function(K){ia=COG.extend({inertia:true},K);return R},unbind:function(){Q.unbind();for(var K=0;K<ha.length;K++)ha[K].unbind();return R}},Aa=0;Aa<p.length;Aa++)ha.push(p[Aa](n,Q,x));Q.bind("pointerDown",function(){$=
[];qa=pa=0});Q.bind("pointerMove",function(K,W,S,L){if(ia){$[$.length]={ticks:(new Date).getTime(),x:L.x,y:L.y};Q.trigger("pan",L.x,L.y)}pa+=L.x?L.x:0;qa+=L.y?L.y:0});Q.bind("pointerUp",function(K,W,S){if(Math.abs(pa)>20||Math.abs(qa)>20){if(ia){S=$.length;var L,M;W=0;for(M=$.length;--M>1&&W<50;)W+=$[M].ticks-$[M-1].ticks;if(S-M>1){K=$[S-1].x-$[M].x;L=$[S-1].y-$[M].y;M=Math.sqrt(K*K+L*L)|0;if(M>15){K=$[S-1].x-$[0].x;L=$[S-1].y-$[0].y;M=Math.sqrt(K*K+L*L)|0;S=Math.asin(L/M);W=M*500/W|0;W=W>300?300:
W;T(Math.cos(K>0?S:Math.PI-S)*W,Math.sin(S)*W,COG.easing("sine.out"),500)}}}}else Q.trigger("tap",W,S)});return R};j("pointer",{handler:function(n,p,x){function T(q){if(f(q,n))if(Aa=$(q)){n.style.cursor="move";s(q);M=q.pageX?q.pageX:q.screenX;ea=q.pageY?q.pageY:q.screenY;K=g(M,ea);W=u(n);p.triggerCustom("pointerDown",w("mouse",q),K,v(K,W))}}function Q(q){S=q.pageX?q.pageX:q.screenX;L=q.pageY?q.pageY:q.screenY;if(f(q,n))pa(q,Aa?"pointerMove":"pointerHover")}function ia(q){if(Aa&&$(q)){Aa=false;if(f(q,
n)){n.style.cursor="default";pa(q,"pointerUp")}}}function ha(q){if(f(q,n)){var aa;q=q||window.event;if(q.detail)aa=q.axis===2?-q.detail*qa:0;else{aa=q.wheelDeltaY?q.wheelDeltaY:q.wheelDelta;if(window.opera)aa=-aa}if(aa!==0){var ja=g(S,L);p.triggerCustom("zoom",w("mouse",q),ja,v(ja,u(n)),aa/R,"wheel");s(q);q.returnValue=false}}}function $(q){q=q||window.event;return(q.which||q.button)==1}function pa(q,aa,ja,sa,Ba){ja=typeof ja!="undefined"?ja:S;sa=typeof sa!="undefined"?sa:L;var F=ja-M,U=sa-ea,N=g(ja,
sa);W||(W=u(n));p.triggerCustom(aa,w("mouse",q),N,v(N,W),g(F,U));if(typeof Ba=="undefined"||Ba){M=ja;ea=sa}}x=COG.extend({},x);var qa=120,R=qa*8,Aa=false,K,W,S,L,M,ea;x.binder("mousedown",T,false);x.binder("mousemove",Q,false);x.binder("mouseup",ia,false);x.binder("dblclick",function(q){COG.info("captured double click");if(f(q,n)){var aa=g(q.pageX?q.pageX:q.screenX,q.pageY?q.pageY:q.screenY);COG.info("captured double click + target matched");p.triggerCustom("doubleTap",w("mouse",q),aa,v(aa,u(n)))}},
false);x.binder("mousewheel",ha,document);x.binder("DOMMouseScroll",ha,document);return{unbind:function(){x.unbinder("mousedown",T,false);x.unbinder("mousemove",Q,false);x.unbinder("mouseup",ia,false);x.unbinder("mousewheel",ha,document);x.unbinder("DOMMouseScroll",ha,document)}}},checks:{touch:false}});j("pointer",{handler:function(n,p,x){function T(F){if(F.count<2)return 0;var U=F.x-F.next.x;F=F.y-F.next.y;return~~Math.sqrt(U*U+F*F)}function Q(F,U,N){U=U?U:0;N=N?N:0;for(var ta={x:F.x-U,y:F.y-N,
id:F.id,count:F.count},wa=ta;F.next;){F=F.next;wa=wa.next={x:F.x-U,y:F.y-N,id:F.id}}return ta}function ia(F,U){var N=F[U?U:"touches"],ta,wa;if(N.length===0)return null;wa=ta={x:N[0].pageX,y:N[0].pageY,id:N[0].identifier,count:N.length};for(var Da=1,Ka=N.length;Da<Ka;Da++)wa=wa.next={x:N[Da].pageX,y:N[Da].pageY,id:N[Da].identifier};return ta}function ha(F){if(f(F,n)){L=u(n);var U=ia(F,"changedTouches"),N=Q(U,L.x,L.y);if(!ea){M=K;p.triggerCustom("pointerDown",w("touch",F),U,N)}sa&&p.triggerCustom("pointerDownMulti",
w("touch",F),U,N);ea=ia(F);if(ea.count>1)aa=T(ea);Ba=1;ja=Q(ea)}}function $(F){if(f(F,n)){F.preventDefault();q=ia(F);if(M==K)M=Math.abs(ea.x-q.x)>R||Math.abs(ea.y-q.y)>R?Aa:K;if(M!=K){M=q.count>1?S:W;if(M==S)if(ea.count===1){ea=Q(q);aa=T(ea)}else{var U=T(q);if(Math.abs(aa-U)<qa)M=W;else{var N;N=q.x;var ta=q.next.x,wa=q.y,Da=q.next.y,Ka=wa<Da?wa:Da;N={x:(N<ta?N:ta)+(Math.abs(N-ta)>>1),y:Ka+(Math.abs(wa-Da)>>1)};U=U/aa;ta=U-Ba;p.triggerCustom("zoom",w("touch",F),N,v(N,L),ta,"pinch");Ba=U}}M==W&&p.triggerCustom("pointerMove",
w("touch",F),q,Q(q,L.x,L.y),g(q.x-ja.x,q.y-ja.y));sa&&p.triggerCustom("pointerMoveMulti",w("touch",F),q,Q(q,L.x,L.y))}ja=Q(q)}}function pa(F){if(f(F,n)){var U=ia(F,"changedTouches"),N=Q(U,L.x,L.y);q=ia(F);if(!q){M===K&&p.triggerCustom("tap",w("touch",F),U,N);p.triggerCustom("pointerUp",w("touch",F),U,N);ea=null}sa&&p.triggerCustom("pointerUpMulti",w("touch",F),U,N)}}x=COG.extend({detailed:false,inertia:false},x);var qa=20,R=7,Aa=0,K=1,W=2,S=3,L,M,ea,q,aa,ja,sa=x.detailed,Ba=1;x.binder("touchstart",
ha,false);x.binder("touchmove",$,false);x.binder("touchend",pa,false);COG.info("initialized touch handler");return{unbind:function(){x.unbinder("touchstart",ha,false);x.unbinder("touchmove",$,false);x.unbinder("touchend",pa,false)}}},checks:{touch:true}});return{register:j,watch:function(n,p,x){p=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},p);capabilities=COG.extend({touch:"ontouchstart"in window},x);if(!p.observable){COG.info("creating observable");
p.observable=COG.observable({});globalOpts=p}p.binder=p.isIE?B:O(p.bindToBody);p.unbinder=p.isIE?t:da(p.bindToBody);x=p.types;for(var T=capabilities,Q=[],ia=z.length;ia--;){var ha=z[ia],$=!x||x.indexOf(ha.type)>=0,pa=true;for(var qa in ha.checks){var R=ha.checks[qa];COG.info("checking "+qa+" capability. require: "+R+", capability = "+T[qa]);pa=pa&&R===T[qa]}if($&&pa)Q[Q.length]=ha.handler}return new P(n,Q,p)}}}();
T5=function(){function O(){return(new Date).getTime()}function da(){for(;q.length>0;){var b=q.shift();document.location=b}ea=0}function B(b){for(var h=true,d=aa.length;d--;)h=h&&b!=aa[d];return h}function t(b,h){var d=[];for(var a in h)a&&d.push(a+"="+escape(h[a]));return"tile5://"+b+"/"+(d.length>0?"?"+d.join("&"):"")}function g(b,h){B(b)&&COG.info("would push url: "+t(b,h))}function j(b,h){if(B(b)){q.push(t(b,h));ea||(ea=setTimeout(da,100))}}function u(b){return function(h,d,a){(a?a:b?document.body:
document).addEventListener(h,d,false)}}function w(b){return function(h,d,a){(a?a:b?document.body:document).removeEventListener(h,d,false)}}function f(b,h,d){(d?d:document).attachEvent("on"+b,h)}function v(b,h,d){(d?d:document).detachEvent("on"+b,h)}function s(){S={base:{name:"Unknown",bindEvent:u(),unbindEvent:w(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:g,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:f,unbindEvent:v,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:j,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:j},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:j},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:u(true),unbindEvent:w(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:j},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:j}};L=[S.froyo,S.android,S.ipod,S.iphone,S.ipad,S.ie]}function z(){S||s();if(!M){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<L.length;b++){var h=L[b];if(h.regex&&h.regex.test(navigator.userAgent)){M=COG.extend({},S.base,h);COG.info("PLATFORM DETECTED AS: "+M.name);break}}if(!M){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
M=S.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return M}function P(){for(var b=0,h=arguments.length;h--;){var d=F[arguments[h].toUpperCase()];if(d)b|=d}return b}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var n=Math.abs,p=Math.min,x=Math.max,T=Math.pow,
Q=Math.sqrt,ia=Math.log,ha=Math.round,$=Math.sin,pa=Math.asin,qa=Math.cos,R=function(){function b(a,c){return d(a.x-c.x,a.y-c.y)}function h(a,c){if(!c)c=a.length;if(c<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var e={edges:Array(c-1),accrued:Array(c-1),total:0},i=0;i<c-1;i++){var A=b(a[i],a[i+1]);e.edges[i]=Q(A.x*A.x+A.y*A.y);e.accrued[i]=e.total+e.edges[i];e.total+=e.edges[i]}return e}function d(a,c){return{x:a?a:0,y:c?c:0}}return{VECTOR_SIMPLIFICATION:3,
SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var a=0,c=0,e=arguments.length;e--;){a+=arguments[e].x;c+=arguments[e].y}return d(a,c)},absSize:function(a){return x(n(a.x),n(a.y))},copy:function(a){return a?d(a.x,a.y):null},diff:b,distance:function(a,c){return h(a,c).total},edges:h,equals:function(a,c){return a.x===c.x&&a.y===c.y},extendBy:function(a,c,e){var i=qa(c)*e;c=$(c)*e;return d(a.x-i,a.y-c)},floor:function(a){for(var c=Array(a.length),e=a.length;e--;)c[e]=d(~~a[e].x,~~a[e].y);return c},
getRect:function(a){for(var c,e,i,A,D=a.length;D--;){var o=a[D];c=typeof c==="undefined"||o.x<c?o.x:c;e=typeof e==="undefined"||o.y<e?o.y:e;i=typeof i==="undefined"||o.x>i?o.x:i;A=typeof A==="undefined"||o.y>A?o.y:A}return K.init(c,e,i,A)},init:d,invert:function(a){return d(-a.x,-a.y)},min:function(a,c){return d(a.x<c.x?a.x:c.x,a.y<c.y?a.y:c.y)},max:function(a,c){return d(a.x>c.x?a.x:c.x,a.y>c.y?a.y:c.y)},offset:function(a,c,e){return d(a.x+c,a.y+(e?e:c))},scale:function(a,c){return d(a.x/c|0,a.y/
c|0)},simplify:function(a,c){if(!a)return null;c=c?c:R.VECTOR_SIMPLIFICATION;for(var e=[],i=null,A=a.length;A--;){var D=a[A];if(include=!i||A===0||n(D.x-i.x)+n(D.y-i.y)>c){e.unshift(D);i=D}}return e},theta:function(a,c,e){e=pa((a.y-c.y)/e);return a.x>c.x?e:Math.PI-e},toString:function(a){return a?a.x+", "+a.y:""}}}(),Aa=function(){return{dotProduct:function(b,h){return b.x*h.x+b.y*h.y}}}(),K=function(){function b(d){return h(d.x1,d.y1,d.x2,d.y2)}function h(d,a,c,e){d=d?d:0;a=a?a:0;c=typeof c!=="undefined"?
c:d;e=typeof e!=="undefined "?e:e;return{x1:d,y1:a,x2:c,y2:e,width:c-d,height:e-a}}return{center:function(d){return R.init(d.x1+d.width/2,d.y1+d.height/2)},copy:b,diagonalSize:function(d){return Q(d.width*d.width+d.height*d.height)},fromCenter:function(d,a,c,e){c=c>>1;e=e>>1;return h(d-c,a-e,d+c,a+e)},init:h,intersect:function(d,a){var c=x(d.x1,a.x1),e=x(d.y1,a.y1),i=p(d.x2,a.x2),A=p(d.y2,a.y2);c=h(c,e,i,A);return c.width>0&&c.height>0?c:null},toString:function(d){return d?"["+d.x1+", "+d.y1+", "+
d.x2+", "+d.y2+"]":""},union:function(d,a){if(d.width===0||d.height===0)return b(a);else if(a.width===0||a.height===0)return b(d);else{var c=p(d.x1,a.x1),e=p(d.y1,a.y1),i=x(d.x2,a.x2),A=x(d.y2,a.y2);c=h(c,e,i,A);return c.width>0&&c.height>0?c:null}}}}(),W=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return R.init(b.width>>1,b.height>>1)},getSize:function(b){return Q(T(b.width,2)+T(b.height,2))},init:function(b,h){b=b?b:0;return{width:b,
height:h?h:b}}}}();Hits=function(){function b(h,d,a,c){c=c!==1?R.scale(a,c):a;return{type:h,x:c.x,y:c.y,elements:[],absXY:d,relXY:a}}return{copy:function(h){var d=b(null,null,h);d.elements=[].concat(h.elements);return d},diffHits:function(h,d){var a=[],c={},e;for(e=d.length;e--;)c[d[e].target.id]=true;for(e=h.length;e--;)c[h[e].target.id]||(a[a.length]=h[e]);return a},init:b,initHit:function(h,d,a){return a=COG.extend({type:h,target:d,drag:false},a)}}}();var S=null,L=[],M=null,ea=0,q=[],aa=["view.wake",
"tile.loaded"],ja=function(){function b(){var l=z().maxImageLoads;if(!l||y.length<l){var E=o.shift();l=T5.ticks();if(E){y[y.length]=E;E.image.onload=d;E.image.src=E.url;E.requested=l}if(l-V>e){E=false;for(var X=0,I=z();X<y.length;)if(l-y[X].requested>G.loadTimeout*1E3){y.splice(X,1);E=true}else X++;E&&b();if(I&&I.imageCacheMaxSize){H=C.length*G.avgImageSize/I.imageCacheMaxSize;H>=1&&h()}V=l}}}function h(){Z=true;try{var l=C.length>>1;if(l>0){C.sort(function(X,I){return X.created-I.created});for(var E=
l;E--;)delete i[C[E].url];C.splice(0,l)}}finally{Z=false}G.trigger("cacheCleared")}function d(){var l=A[this.id],E;if(l&&l.image.complete&&l.image.width>0){l.loaded=true;l.hitCount=1;for(E=y.length;E--;)if(y[E].image.src==this.src){y.splice(E,1);break}if(l.background||l.postProcess||l.drawBackground||l.customDraw)if(l.image){globalImageData=l;E=c(l.realSize?l.realSize.width:l.image.width,l.realSize?l.realSize.height:l.image.height);var X=E.getContext("2d"),I=l.offset?l.offset:T5.XY.init();l.background&&
X.drawImage(l.background,0,0);l.drawBackground&&l.drawBackground(X);l.customDraw?l.customDraw(X,l):X.drawImage(l.image,I.x,I.y);l.postProcess&&l.postProcess(X,l);l.image=E}for(E=l.callbacks.length;E--;)l.callbacks[E]&&l.callbacks[E](this,false);l.callbacks=[];C[C.length]={url:this.src,created:l.requested};delete A[this.id];b()}}function a(l,E,X){var I=i[l];if(I){I.hitCount++;I.image.complete&&I.image.width>0&&E?E(I.image,true):I.callbacks.push(E)}else{I=COG.extend({url:l,image:new Image,loaded:false,
created:T5.ticks(),requested:null,hitCount:0,callbacks:[E]},X);I.image.id="resourceLoaderImage"+D++;i[l]=I;A[I.image.id]=I;o[o.length]=I;b()}return I}function c(l,E){var X=document.createElement("canvas");COG.info("creating new canvas");X.width=l?l:0;X.height=E?E:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(X);FlashCanvas.initElement(X)}return X}var e=1E4,i={},A={},D=0,o=[],y=[],C=[],H=0,V=0,Z=false,G={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var l;for(l=y.length;l--;)delete i[y[l].url];
y=[];for(l=o.length;l--;)delete i[o[l].url];o=[]},get:function(l,E,X){var I=null,Ea=null;Z||(I=i[l]);if((Ea=I?I.image:null)&&(Ea.getContext||Ea.complete&&Ea.width>0))return Ea;else E&&a(l,E,X);return null},load:a,newCanvas:c,reset:function(){i={}},stats:function(){return{imageLoadingCount:y.length,queuedImageCount:o.length,imageCacheFullness:H}}};COG.observable(G);return G}(),sa=function(){var b={};return{init:function(h,d){var a=b[h];if(!a)throw Error("Unable to locate requested generator: "+h);
return new a(d)},register:function(h,d){b[h]=d},Template:function(){}}}(),Ba=function(){function b(i,A){c[i]=d(A);return i}function h(i){for(var A in i)b(A,i[A])}function d(i){function A(C){var H=i[C];typeof H!=="undefined"&&o.push(function(V){V[C]=H})}function D(){o=[];for(var C in i)A(C)}i=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},i);var o=[],y={applyToContext:function(C){for(var H=
o.length;H--;)o[H](C)},update:function(C,H){i[C]=H;D()}};D();return y}var a={},c={},e={apply:function(i,A){var D=c[A]?c[A]:c.basic,o;if(i&&i.canvas){o=a[i.canvas.id];a[i.canvas.id]=A}D.applyToContext(i);return o},define:b,defineMany:h,get:function(i){return c[i]},init:d,load:function(i){COG.jsonp(i,function(A){h(A)})}};h({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",
fillStyle:"#FFF"}});return e}(),F={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},U=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:P("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var h=null,d=false,a=false,c=b.id,e=P("ACTIVE"),i=b.validStates,A=0,D=0,o=COG.extend({addToView:function(y){y.setLayer(c,o)},shouldDraw:function(y){return(y&i)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){o.trigger("remove",
o)},changed:function(){a=true;h&&h.invalidate()},hitTest:null,getId:function(){return c},setId:function(y){c=y},getParent:function(){return h},setParent:function(y){d=(h=y)?h.fastDraw&&displayState!==e:false;o.trigger("parentChange",h)}},b);COG.observable(o);o.bind("drawComplete",function(y,C){a=false;A=C.x1;D=C.y1});o.bind("resync",function(y,C){o.minXY&&C.syncXY(o.minXY);o.maxXY&&C.syncXY(o.maxXY)});return o},N=function(b){b=COG.extend({style:null,fill:false,observable:true,properties:{},type:"shape",
rotation:0,scale:1},b);var h=b.fill,d=COG.extend(b,{id:COG.objId(b.type),bounds:null,hit:false,drag:null,draw:function(a){h&&a.fill();a.stroke()},prepPath:function(){},resync:function(){}});b.observable&&COG.observable(d);return d},ta=function(b){b=COG.extend({xy:R.init(),draggable:false,size:10,type:"marker"},b);var h=b.size,d=COG.extend(new N(b),{drag:function(a,c,e){d.xy.x=c;d.xy.y=e;return true},prepPath:function(a,c,e){a.beginPath();a.arc(c,e,h,0,Math.PI*2,false);d.bounds=K.fromCenter(c,e,h,
h);return true},resync:function(a){a.syncXY([d.xy])}});return d},wa=function(b){function h(e){for(var i=a.length;i--;)a[i].resync(e);a.sort(function(A,D){var o=D.xy.y-A.xy.y;return o!=0?o:D.xy.x-A.xy.y});c.changed()}function d(e,i){h(i)}b=COG.extend({zindex:10},b);var a=[],c=COG.extend(new U(b),{add:function(e){if(e){c.getParent()&&e.resync(c.getParent());a[a.length]=e}},clear:function(){a=[]},draw:function(e,i,A,D,o,y){D=i.x1;o=i.y1;var C=y?y.x:0,H=y?y.y:0,V=i.width;i=i.height;for(var Z=a.length;Z--;){var G=
a[Z],l=G.style,E;if(G.prepPath(e,D,o,V,i,A)){if(y&&e.isPointInPath(C,H)){y.elements.push(Hits.initHit(G.type,G));E=y.type+"Style";l=G[E]||l}l=l?Ba.apply(e,l):null;G.draw(e,D,o,V,i,A);l&&Ba.apply(e,l)}}},hitGuess:function(e,i){for(var A=false,D=a.length;!A&&D--;){var o=a[D].bounds;A=A||o&&e>=o.x1&&e<=o.x2&&i>=o.y1&&i<=o.y2}return A}});c.bind("parentChange",d);c.bind("resync",d);return c},Da=function(){return{tileSize:256,init:function(b,h,d,a,c){return COG.extend({x:b,y:h,width:d,height:a},c)}}}(),
Ka={ex:COG.extend,ticks:O,getConfig:z,userMessage:function(b,h,d){Ka.trigger("userMessage",b,h,d)},XY:R,XYRect:K,Dimensions:W,Vector:Aa,Hits:Hits,D:W,Images:ja,Generator:sa,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Ba,viewState:P,View:function(b){function h(k,m,r){Ca||Qa(fa-m,ga-r)}function d(k,m,r,J){Za(p(x(ka+T(2,J)-1,0.5),2))}function a(){var k=ia(ka)/Math.LN2|0;if(k!==0){ka=T(2,k);nb(Oa+k,Ra,Sa)}I()}function c(k){k||(k=R.init(La,Ma));$a=R.init(fa,ga);Pa=
R.offset(k,fa,ga);Ra=Pa.x;Sa=Pa.y}function e(k,m,r){var J=1/ka;return R.init((r&&Ja?Ja.x1:0)+k*J,(r&&Ja?Ja.y1:0)+m*J)}function i(k,m,r){Na("doubleTap",m,r,e(r.x,r.y));b.scalable&&Za(2,r,b.zoomEasing,null,b.zoomDuration)}function A(k,m,r){Ca=null;X("down",m,r)}function D(k,m,r){X("hover",m,r,ka)}function o(k,m,r){if(Ca){k=e(r.x,r.y);Ca.drag(Ca,k.x,k.y,false)&&I()}}function y(k,m,r){if(Ca){k=e(r.x,r.y);Ca.drag(Ca,k.x,k.y,true)&&I()}ba=Ca=null}function C(){clearTimeout(ob);ob=setTimeout(V,250)}function H(k,
m,r){X("tap",m,r);Na("tap",m,r,e(r.x,r.y,true))}function V(k,m){var r;Ta=typeof FlashCanvas!=="undefined";COG.info("is flash = "+Ta);if(na){if(b.autoSize&&na.parentNode){k=na.parentNode.offsetWidth;m=na.parentNode.offsetHeight}try{if(!na.id)na.id=b.id+"_canvas";ra=na.getContext("2d")}catch(J){COG.exception(J);throw Error("Could not initialise canvas on specified view element");}if(k&&m&&(ua!==m||va!==k)){ab=true;va=k;ua=m;La=va>>1;Ma=ua>>1;la.trigger("resize",va,ua);for(r=xa;r--;)ca[r].trigger("resize",
va,ua)}for(r=xa;r--;)ca[r].trigger("contextChanged",ra);I();G()}}function Z(k,m){m.setId(k);m.added=O();m.bind("remove",function(){la.removeLayer(k)});m.trigger("contextChanged",ra);m.setParent(la);ca.push(m);ca.sort(function(r,J){var Y=J.zindex-r.zindex;if(Y===0)Y=J.added-r.added;return Y});xa=ca.length;return m}function G(){ya&&ya.unbind();ya=INTERACT.watch(na);b.pannable&&ya.pannable().bind("pan",h);if(b.scalable){ya.bind("zoom",d);ya.bind("doubleTap",i)}ya.bind("pointerDown",A);ya.bind("pointerMove",
o);ya.bind("pointerUp",y);b.captureHover&&ya.bind("pointerHover",D);ya.bind("tap",H)}function l(k){var m=Ua?fa+La:fa,r=Va?ga+Ma:ga;if(Fa&&Fa>va)if(m+va>Fa)fa=Ua?k&&m-Fa>0?fa-Fa:fa:Fa-va;else if(m<0)fa=Ua?k?fa+Fa:fa:0;if(Ga&&Ga>ua)if(r+ua>Ga)ga=Va?k&&r-Ga>0?ga-Ga:ga:Ga-ua;else if(r<0)ga=Va?k?ga+Ga:ga:0}function E(k){var m,r=false;if(bb|Ta){Ia=pb|(ka!==1?qb:0)|(fa!==cb||ga!==db?eb:0)|(fb?gb:0);hb=(m=(Ia&(qb|eb))!==0)&&(Ia&gb)===0;if(ab&&na){Ta&&FlashCanvas.initElement(na);na.width=va;na.height=ua;na.style.width=
va+"px";na.style.height=ua+"px";ab=false}if(Fa||Ga)l();Wa=Ea();for(var J=xa;J--;){Ia|=ca[J].animated?gb:0;ca[J].cycle(k,Wa,Ia);r=ca[J].clip||r}J=Ia;var Y=Wa;m=tb&&r&&!m;var ma;K.center(Y);r=0;var za;if(ka!==1){za=1/ka;Ra=Pa.x+(fa-$a.x);Sa=Pa.y+(ga-$a.y);za=Y?K.fromCenter(Ra>>0,Sa>>0,Y.width*za>>0,Y.height*za>>0):void 0}else za=K.copy(Y);Ja=za;m||ra.clearRect(0,0,va,ua);Ja.scaleFactor=ka;ra.save();try{ka!==1&&ra.scale(ka,ka);Xa=Ya=null;if(m){ra.beginPath();for(r=xa;r--;)ca[r].clip&&ca[r].clip(ra,Ja,
J,la,k);ra.closePath();ra.clip()}ra.globalCompositeOperation="source-over";for(r=xa;r--;){ma=ca[r];if(ma.shouldDraw(Ia,Wa)){var oa=ma.style,Ha=oa?Ba.apply(ra,oa):null;ma.draw(ra,Ja,J,la,k,ba);Ha&&Ba.apply(ra,Ha)}}}finally{ra.restore()}bb=0;Na("drawComplete",Y,k);ma=ba?ba.elements:[];if(ib&&ba&&ba.type==="hover"){oa=Hits.diffHits(ib.elements,ma);oa.length>0&&la.triggerCustom(ba.type+"Out",{hitType:ba.type},oa,ba.absXY,ba.relXY,R.init(ba.x,ba.y))}if(ma.length>0){Ha=ba.x;J=ba.y;for(oa=ma.length;oa--;){Y=
ma[oa];m=Ha;r=J;if(za=Y&&Y.drag&&(!Y.canDrag||Y.canDrag(Y,m,r))){Ca=Y;Ca.startX=m;Ca.startY=r}if(za)break}la.triggerCustom(ba.type+"Hit",{hitType:ba.type},ma,ba.absXY,ba.relXY,R.init(ba.x,ba.y))}ib=ma.length>0?Hits.copy(ba):null;k-rb>ub&&jb();vb=k;cb=fa;db=ga;animFrame(E)}else kb=false}function X(k,m,r){var J=false;ba=Hits.init(k,m,r,ka);for(k=xa;k--;)J=(ca[k].hitGuess?ca[k].hitGuess(ba.x,ba.y,Ia,la):false)|J;J&&I()}function I(){bb+=1;if(!kb){kb=true;animFrame(E)}}function Ea(){return K.init(fa,ga,
fa+va,ga+ua)}function jb(){if(Fa||Ga)l(true);rb=(new Date).getTime();Na("refresh",la,Ea());I()}function Za(k,m,r,J,Y){if(r)COG.tweenValue(ka,k,r,Y,function(ma,za){ka=ma;if(za){var oa=ha(ia(ka)/Math.LN2);ka=T(2,oa);J&&J()}c(m);a()});else{ka=k;c(m);a()}return la}function nb(k,m,r){k=x(b.minZoom,p(b.maxZoom,k));if(k!==Oa){var J=T(2,k-Oa),Y=La/J|0,ma=Ma/J|0;Oa=k;Qa(((m?m:fa+La)-Y)*J,((r?r:ga+Ma)-ma)*J);cb=fa;db=ga;Na("zoomLevelChange",k);ka=1;jb()}}function Na(){for(var k=la.trigger.apply(null,arguments).cancel,
m=ca.length;m--;)k=ca[m].trigger.apply(null,arguments).cancel||k;return!k}function Qa(k,m,r,J,Y){function ma(){za+=1;if(za>=2){fb=false;Y&&Y()}}var za=0,oa=Ya?R.offset(Ya,-La,-Ma):null,Ha=Xa?R.offset(Xa,-La,-Ma):null;if(oa){k=k<oa.x?oa.x:k;m=m<oa.y?oa.y:m}if(Ha){k=k>Ha.x?Ha.x:k;m=m>Ha.y?Ha.y:m}if(r){if((Ia&eb)===0){COG.tweenValue(fa,k,r,J,function(lb,mb){fa=lb|0;(mb?ma:I)();return!hb});COG.tweenValue(ga,m,r,J,function(lb,mb){ga=lb|0;(mb?ma:I)();return!hb});fb=true}}else{fa=k|0;ga=m|0;I();Y&&Y()}}
b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:true,clipping:true,scalable:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var ca=[],xa=0,na=document.getElementById(b.container),Ca=null,ra=null,wb=typeof window.attachEvent!=
"undefined",Ta,ub=b.minRefresh,fa=0,ga=0,cb=0,db=0,Fa=null,Ga=null,Ua=false,Va=false,tb=b.clipping,Wa=null,kb=false,Ja,sb=1,La=0,Ma=0,ba=null,$a=null,Pa=null,hb=false,Ya=null,Xa=null,rb=0,ib=null,ob=0,ka=1,vb=0,ab=false,ya=null,fb=false,ua,va,bb=0,Ra,Sa,Oa=b.zoomLevel,pb=P("ACTIVE"),eb=P("PAN"),qb=P("ZOOM"),gb=P("ANIMATING"),Ia=pb,la={id:b.id,deviceScaling:sb,fastDraw:b.fastDraw||z().requireFastDraw,detach:function(){ya&&ya.unbind()},eachLayer:function(k){for(var m=xa;m--;)k(ca[m])},getDimensions:function(){return W.init(va,
ua)},getLayer:function(k){for(var m=0;m<xa;m++)if(ca[m].getId()==k)return ca[m];return null},getZoomLevel:function(){return Oa},setLayer:function(k,m){for(var r=0;r<xa;r++)if(ca[r].getId()===k){ca.splice(r,1);break}if(m){Z(k,m);m.trigger("refresh",la,Ea())}I();return m},invalidate:I,refresh:jb,resetScale:function(){ka=1},resize:function(k,m){if(na){b.autoSize=false;if(va!==k||ua!==m)V(k,m)}},scale:Za,setZoomLevel:nb,syncXY:function(){},triggerAll:Na,removeLayer:function(k){a:{for(var m=xa;m--;)if(ca[m].getId()==
k){k=m;break a}k=-1}if(k>=0&&k<xa){la.trigger("layerRemoved",ca[k]);ca.splice(k,1);I()}xa=ca.length},getOffset:function(){return R.init(fa,ga)},setMaxOffset:function(k,m,r,J){Fa=k;Ga=m;Ua=typeof r!="undefined"?r:false;Va=typeof J!="undefined"?J:false},getViewRect:Ea,updateOffset:Qa,pan:function(k,m,r,J,Y){Qa(fa+k,ga+m,r,J,Y)}};sb=z().getScaling();la.markers=Z("markers",new wa({zindex:20}));COG.observable(la);la.bind("invalidate",function(){I()});la.bind("resync",function(){Xa=Ya=null});COG.configurable(la,
["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,null,{container:function(k,m){na=document.getElementById(m);V()},inertia:G,captureHover:G,scalable:G,pannable:G}),true);V();if(b.autoSize)wb?window.attachEvent("onresize",C):window.addEventListener("resize",C,false);return la},ViewLayer:U,ImageLayer:function(b,h){function d(o,y,C){for(y=i.length;y--;){var H=i[y],V=H.x,Z=H.y,G=K.init(H.x,H.y,H.x+H.width,H.y+H.height);if(C&&K.intersect(o,
G))(G=ja.get(H.url,function(){D.changed()},A))&&C(G,V,Z,H.width,H.height)}}function a(o){var y=++e,C=D.getParent();c&&c.run(C,o,function(H){if(y==e){i=[].concat(H);C.invalidate()}})}h=COG.extend({imageLoadArgs:{}},h);var c=b?sa.init(b,h):null,e=0,i=[],A=h.imageLoadArgs,D=COG.extend(new U(h),{changeGenerator:function(o,y){c=sa.init(o,COG.extend({},h,y));i=null;a(D.getParent().getViewRect())},clip:function(o,y,C){var H=y.x1,V=y.y1;d(y,C,function(Z,G,l,E,X){o.rect(G-H,l-V,E,X)})},draw:function(o,y,C){var H=
y.x1,V=y.y1;d(y,C,function(Z,G,l){o.drawImage(Z,G-H,l-V,Z.width,Z.height)})},mask:function(o,y,C){d(y,C,function(H,V,Z,G,l){COG.info("clearing rect @ x = "+V+", y = "+Z+", width = "+G+", height = "+l);o.clearRect(V,Z,G,l)})}});D.bind("refresh",function(o,y,C){a(C)});D.bind("tap",function(o,y,C,H){o=[];var V=H.x,Z=H.y,G,l;if(i)for(var E=i.length;E--;){G=i[E];if(l=V>=G.x&&V<=G.x+G.width&&Z>=G.y&&Z<=G.y+G.height)o[o.length]=G}o.length>0&&D.trigger("tapImage",o,y,C,H)});return D},ImageGenerator:function(b){b=
COG.extend({relative:false,padding:2},b);b={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(b);return b},Shape:N,Arc:function(b,h){h=COG.extend({size:4},h);var d=R.init(),a=COG.extend(h,{draw:function(c){c.beginPath();c.arc(d.x,d.y,a.size,0,Math.PI*2,false);c.fill();c.stroke()},resync:function(c){c.syncXY([b]);d=R.floor([b])[0]}});COG.info("created arc = ",b);return a},Poly:function(b,h){h=COG.extend({simplify:false},h);var d=false,a=h.simplify;P("ZOOM");
var c=[];h.type=h.fill?"polygon":"line";var e=COG.extend(new N(h),{prepPath:function(i,A,D){if(d){var o=true,y,C,H,V;i.beginPath();for(var Z=c.length;Z--;){var G=c[Z].x-A,l=c[Z].y-D;H=typeof H!="undefined"||G<H?G:H;V=typeof V!="undefined"||l<V?l:V;y=typeof y!="undefined"||G>y?G:y;C=typeof C!="undefined"||l>C?l:C;if(o){i.moveTo(G,l);o=false}else i.lineTo(G,l)}e.bounds=K.init(H,V,y,C)}return d},resync:function(i){e.xy=i.syncXY(b);c=R.floor(a?R.simplify(b):b)}});d=b&&b.length>=2;return e},Points:function(b,
h){h=COG.extend({fill:true,radius:10},h);var d=h.fill,a=[],c=h.radius;return COG.extend(new N(h),{draw:function(e,i,A){e.beginPath();for(var D=a.length;D--;)e.arc(a[D].x-i,a[D].y-A,c,0,Math.PI*2,false);d&&e.fill();e.stroke()},resync:function(){a=R.floor(b)}})},Marker:ta,ImageMarker:function(b){b=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null},b);var h=null,d,a,c=b.imageAnchor?T5.XY.invert(b.imageAnchor):null,e=COG.extend(new ta(b),{changeImage:function(i){e.image=
ja.get(i,function(A){e.image=A})},drag:function(i,A,D,o){h||(h=R.init(i.startX-e.xy.x,i.startY-e.xy.y));e.xy.x=A-h.x;e.xy.y=D-h.y;if(o){i=e.parent?e.parent.getParent():null;h=null;i&&i.syncXY([e.xy],true);e.trigger("dragDrop")}return true},draw:function(i){i.drawImage(e.image,d,a)},prepPath:function(i,A,D){var o=e.image,y=o&&o.width>0;if(y){c||(c=R.init(-o.width>>1,-o.height>>1));d=e.xy.x+c.x-A;a=e.xy.y+c.y-D;e.bounds=K.init(d,a,d+o.width,a+o.height);i.beginPath();i.rect(d,a,o.width,o.height)}return y}});
if(!e.image)e.image=ja.get(b.imageUrl,function(i){e.image=i});if(!e.animatingImage)e.animatingImage=ja.get(b.animatingImageUrl,function(i){e.animatingImage=i});return e},ShapeLayer:wa,Tiling:Da};COG.observable(Ka);return Ka}();
