COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var L=arguments[0]||{},X,A=1,x=arguments.length;A<x;A++)if((X=arguments[A])!==null)for(var j in X){var i=X[j];if(L!==i)if(i!==undefined)L[j]=i}return L};
(function(){var L=Object.prototype.hasOwnProperty,X=0,A={};A.toID=function(x){return x.replace(/\s/g,"-")};A.objId=function(x){return(x?x:"obj")+X++};A.isFunction=function(x){return toString.call(x)==="[object Function]"};A.isArray=function(x){return toString.call(x)==="[object Array]"};A.isPlainObject=function(x){if(!x||toString.call(x)!=="[object Object]"||x.nodeType||x.setInterval)return false;if(x.constructor&&!L.call(x,"constructor")&&!L.call(x.constructor.prototype,"isPrototypeOf"))return false;
var j;for(j in x);return j===undefined||L.call(x,j)};A.isEmptyObject=function(x){for(var j in x)return false;return true};A.isXmlDocument=function(x){return toString.call(x)==="[object Document]"};A.contains=function(x,j){var i=x,v=arguments,q=1;if(j&&module.isArray(j)){v=j;q=0}for(q=q;q<v;q++)i=i&&typeof foo[v[q]]!=="undefined";return i};A.formatStr=function(x){if(arguments.length<=1)return x;for(var j=arguments.length-2,i=0;i<=j;i++)x=x.replace(RegExp("\\{"+i+"\\}","gi"),arguments[i+1]);return x};
A.wordExists=function(x,j){var i="";if(j.toString)j=j.toString();for(var v=0;v<j.length;v++)i+=!/\w/.test(j[v])?"\\"+j[v]:j[v];return RegExp("(^|\\s|\\,)"+i+"(\\,|\\s|$)","i").test(x)};COG.extend(COG,A)})();
(function(){function L(i){return typeof console!=="undefined"?function(){console[i](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var X=window.console&&window.console.markTimeline,A=L("error"),x=L("info"),j=function(){return X?function(i,v){console.markTimeline(i+(v?": "+((new Date).getTime()-v)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:L("debug"),info:x,warn:L("warn"),error:A,exception:function(i){if(A)for(var v in i)x("ERROR DETAIL: "+v+
": "+i[v])}})})();var FNS_TIME=["webkitAnimationTime","mozAnimationTime","animationTime","webkitAnimationStartTime","mozAnimationStartTime","animationStartTime"],FNS_FRAME=["webkitRequestAnimationFrame","mozRequestAnimationFrame","requestAnimationFrame"],animTime=function(){return(new Date).getTime()},animFrame=function(L){setTimeout(function(){L(animTime())},1E3/60)};FNS_TIME.forEach(function(L){if(L in window)animTime=function(){return window[L]}});
FNS_FRAME.forEach(function(L){if(L in window)animFrame=function(X){window[L](X)}});COG.animTime=animTime;COG.animFrame=animFrame;
COG.Loopage=function(){function L(q){return COG.extend({id:j++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},q)}function X(q){v.push(q);x||(x=animFrame(A));recalcSleepFrequency=true}function A(){for(var q,M=animTime(),R=i.length;v.length>0;){var ja=v.shift();for(q=R;q--;)if(i[q].id===ja){i.splice(q,1);break}R=i.length}for(q=R;q--;){ja=M-i[q].lastTick;if(i[q].lastTick===0||ja>=i[q].frequency){i[q].execute(M,i[q]);i[q].lastTick=M;i[q].single&&i[q].trigger("complete")}}x=R?animFrame(A):
0}var x=0,j=0,i=[],v=[];return{join:function(q){var M=new L(q);if(M.after>0)M.lastTick=(new Date).getTime()+M.after;COG.observable(M);M.bind("complete",function(){X(M.id)});i.unshift(M);x||(x=animFrame(A));recalcSleepFrequency=true;return M},leave:X}}();
(function(){function L(A,x){var j=A.obsHandlers;j[x]||(j[x]=[]);return j[x]}var X=0;COG.observable=function(A){if(!A)return null;if(!A.obsHandlers)A.obsHandlers={};if(!(A.bind||A.trigger||A.unbind)){A.bind=function(x,j){var i="callback"+X++;L(A,x).unshift({fn:j,id:i});return i};A.triggerCustom=function(x,j){var i=L(A,x),v={cancel:false,name:x},q;j&&COG.extend(v,j);if(!i)return null;q=Array.prototype.slice.call(arguments,2);A.eventInterceptor&&A.eventInterceptor(x,v,q);q.unshift(v);for(var M=i.length;M--&&
!v.cancel;)i[M].fn.apply(this,q);return v};A.trigger=function(x){var j=Array.prototype.slice.call(arguments,1);j.splice(0,0,x,null);return A.triggerCustom.apply(this,j)};A.unbind=function(x,j){if(typeof x==="undefined")A.obsHandlers={};else for(var i=L(A,x),v=0;i&&v<i.length;v++)if(i[v].id===j){i.splice(v,1);break}return A}}return A}})();
(function(){function L(j,i){j[i]||(j[i]=function(v){return j.configure(i,v)})}function X(j){j.gtConfId="configurable"+x++;j.gtConfig={};j.gtConfigFns=[];return j.gtConfig}var A={},x=0;COG.paramTweaker=function(j,i,v){return function(q,M){if(typeof M!=="undefined"){if(q in j)j[q]=M;v&&q in v&&v[q](q,M)}else return i&&q in i?i[q](q):j[q]}};COG.configurable=function(j,i,v,q){if(j){j.gtConfId||X(j);var M=j.gtConfId,R=j.gtConfig,ja=j.gtConfigFns;A[M]=j;ja.push(v);for(v=i.length;v--;){R[i[v]]=true;q&&L(j,
i[v])}if(!j.configure)j.configure=function(ka,ea){if(R[ka]){for(var B=ja.length;B--;){var y=ja[B](ka,ea);if(typeof y!=="undefined")return y}return A[M]}return null}}}})();
(function(){function L(j){var i=document.createElement("script"),v=false;i.src=j;i.async=true;i.onload=i.onreadystatechange=function(){if(!v&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){v=true;i.onload=i.onreadystatechange=null;i&&i.parentNode&&i.parentNode.removeChild(i)}};A||(A=document.getElementsByTagName("head")[0]);A.appendChild(i)}var X=0,A,x=this;COG.jsonp=function(j,i,v){j+=j.indexOf("?")>=0?"&":"?";var q="json"+ ++X;x[q]=function(M){i(M);x[q]=null;try{delete x[q]}catch(R){}};
L(j+(v?v:"callback")+"="+q);return q}})();
(function(){function L(a){if(ka)return R.length;ka=true;try{for(var o=0;o<R.length;)if(R[o].isComplete()){R[o].triggerComplete(false);R.splice(o,1)}else{R[o].update(a);o++}}finally{ka=false}R.length===0&&ja.trigger("complete");return R.length}function X(){if(!ja){ja=COG.Loopage.join({execute:L,frequency:20});ja.bind("complete",function(){ja=null})}}var A=1.70158,x=Math.PI/2,j=Math.abs,i=Math.pow,v=Math.sin,q=Math.asin,M=Math.cos,R=[],ja=null,ka=false,ea={linear:function(a,o,n,w){return n*a/w+o},backin:function(a,
o,n,w){return n*(a/=w)*a*((A+1)*a-A)+o},backout:function(a,o,n,w){return n*((a=a/w-1)*a*((A+1)*a+A)+1)+o},backinout:function(a,o,n,w){return(a/=w/2)<1?n/2*a*a*(((A*=1.525)+1)*a-A)+o:n/2*((a-=2)*a*(((A*=1.525)+1)*a+A)+2)+o},bouncein:function(a,o,n,w){return n-ea.bounceout(w-a,0,n,w)+o},bounceout:function(a,o,n,w){return(a/=w)<1/2.75?n*7.5625*a*a+o:a<2/2.75?n*(7.5625*(a-=1.5/2.75)*a+0.75)+o:a<2.5/2.75?n*(7.5625*(a-=2.25/2.75)*a+0.9375)+o:n*(7.5625*(a-=2.625/2.75)*a+0.984375)+o},bounceinout:function(a,
o,n,w){return a<w/2?ea.bouncein(a*2,0,n,w)/2+o:ea.bounceout(a*2-w,0,n,w)/2+n/2+o},cubicin:function(a,o,n,w){return n*(a/=w)*a*a+o},cubicout:function(a,o,n,w){return n*((a=a/w-1)*a*a+1)+o},cubicinout:function(a,o,n,w){if((a/=w/2)<1)return n/2*a*a*a+o;return n/2*((a-=2)*a*a+2)+o},elasticin:function(a,o,n,w,E,G){if(a==0)return o;if((a/=w)==1)return o+n;G||(G=w*0.3);if(!E||E<j(n)){E=n;n=G/4}else n=G/TWO_PI*q(n/E);return-(E*i(2,10*(a-=1))*v((a*w-n)*TWO_PI/G))+o},elasticout:function(a,o,n,w,E,G){var T;
if(a==0)return o;if((a/=w)==1)return o+n;G||(G=w*0.3);if(!E||E<j(n)){E=n;T=G/4}else T=G/TWO_PI*q(n/E);return E*i(2,-10*a)*v((a*w-T)*TWO_PI/G)+n+o},elasticinout:function(a,o,n,w,E,G){var T;if(a==0)return o;if((a/=w/2)==2)return o+n;G||(G=w*0.3*1.5);if(!E||E<j(n)){E=n;T=G/4}else T=G/TWO_PI*q(n/E);if(a<1)return-0.5*E*i(2,10*(a-=1))*v((a*w-T)*TWO_PI/G)+o;return E*i(2,-10*(a-=1))*v((a*w-T)*TWO_PI/G)*0.5+n+o},quadin:function(a,o,n,w){return n*(a/=w)*a+o},quadout:function(a,o,n,w){return-n*(a/=w)*(a-2)+
o},quadinout:function(a,o,n,w){if((a/=w/2)<1)return n/2*a*a+o;return-n/2*(--a*(a-2)-1)+o},sinein:function(a,o,n,w){return-n*M(a/w*x)+n+o},sineout:function(a,o,n,w){return n*v(a/w*x)+o},sineinout:function(a,o,n,w){return-n/2*(M(Math.PI*a/w)-1)+o}},B=COG.Tween=function(a){a=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:y("sine.out"),complete:null},a);var o=(new Date).getTime(),n=[],w=false,E=0,G=0,T={isComplete:function(){return w},triggerComplete:function(Y){a.complete&&
a.complete(Y)},update:function(Y){var D=a.tweenFn(Y-o,E,G,a.duration);if(a.target)a.target[a.property]=D;for(var da=n.length;da--;)n[da](D,void 0);if(w=o+a.duration<=Y){if(a.target)a.target[a.property]=a.tweenFn(a.duration,E,G,a.duration);for(Y=n.length;Y--;)n[Y](D,true)}},requestUpdates:function(Y){n.push(Y)}};E=a.target&&a.property&&a.target[a.property]?a.target[a.property]:a.startValue;if(typeof a.endValue!=="undefined")G=a.endValue-E;if(G==0)w=true;X();return T};COG.tweenValue=function(a,o,n,
w,E){function G(D){var da=D-T,H=n(da,a,Y,w),aa=T+w<=D;D=!aa;if(E){da=E(H,aa,da);D=typeof da!="undefined"?da&&D:D}D&&animFrame(G)}var T=animTime(),Y=o-a;animFrame(G);return{}};COG.tween=function(a,o,n,w,E,G){a=new B({target:a,property:o,endValue:n,tweenFn:w,duration:G,complete:E});R.push(a);return a};COG.endTweens=function(a){if(!ka){ka=true;try{for(var o=0;o<R.length;)if(!a||a(R[o])){R[o].triggerComplete(true);R.splice(o,1)}else o++}finally{ka=false}}};COG.getTweens=function(){return[].concat(R)};
var y=COG.easing=function(a){return ea[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(a,o){ea[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]=o}})();
(function(){var L=/^P(\d+Y)?(\d+M)?(\d+D)?$/,X=/^(\d+H)?(\d+M)?(\d+S)?$/,A={8601:function(j){j=j.split("T");var i=null;i=null;var v=0,q=0;L.lastIndex=-1;i=L.exec(j[0]);v+=i[3]?parseInt(i[3].slice(0,-1),10):0;X.lastIndex=-1;i=X.exec(j[1]);q+=i[1]?parseInt(i[1].slice(0,-1),10)*3600:0;q+=i[2]?parseInt(i[2].slice(0,-1),10)*60:0;q+=i[3]?parseInt(i[3].slice(0,-1),10):0;return new x(v,q)}},x=COG.Duration=function(j,i){return{days:j?j:0,seconds:i?i:0}};COG.addDuration=function(){for(var j=new x,i=arguments.length;i--;){j.days+=
arguments[i].days;j.seconds+=arguments[i].seconds}if(j.seconds>=86400){j.days+=~~(j.seconds/86400);j.seconds%=86400}return j};COG.formatDuration=function(j){var i,v,q="";if(j.days)q=j.days+" days ";if(j.seconds){j=j.seconds;if(j>=3600){i=~~(j/3600);j-=i*3600}if(j>=60){v=Math.round(j/60);j-=v*60}if(i)q=q+i+(i>1?" hrs ":" hr ")+(v?(v>10?v:"0"+v)+" min ":"");else if(v)q=q+v+" min";else if(j>0)q=q+(j>10?j:"0"+j)+" sec"}return q};COG.parseDuration=function(j,i){var v=i?A[i]:null;if(v)return v(j);COG.Log.warn("Could not find duration parser for specified format: "+
i);return new x}})();
INTERACT=function(){function L(B){return function(y,a,o){(o?o:B?document.body:document).addEventListener(y,a,false)}}function X(B){return function(y,a,o){(o?o:B?document.body:document).removeEventListener(y,a,false)}}function A(B,y,a){(a?a:document).attachEvent("on"+B,y)}function x(B,y,a){(a?a:document).detachEvent("on"+B,y)}function j(B,y){return{x:B?B:0,y:y?y:0,count:1}}function i(B,y){ka.push(COG.extend({handler:null,checks:{},type:B},y))}function v(B){var y=0,a=0;if(B.offsetParent){do{y+=B.offsetLeft;
a+=B.offsetTop;B=B.offsetParent}while(B)}return{x:y,y:a}}function q(B,y){return{source:B,target:y.target?y.target:y.srcElement}}function M(B,y){for(var a=B.target?B.target:B.srcElement;a&&a!==y&&a.nodeName&&a.nodeName.toUpperCase()!="CANVAS";)a=a.parentNode;return a&&a===y}function R(B,y){return{x:B.x-(y?y.x:0),y:B.y-(y?y.y:0)}}function ja(B){if(B.preventDefault){B.preventDefault();B.stopPropagation()}else B.cancelBubble&&B.cancelBubble()}var ka=[],ea=function(B,y,a){function o(H,aa,V,N){var S=0,
$=0,s=0;COG.tweenValue(0,H,V,N,function(W){s=S;S=W});COG.tweenValue(0,aa,V,N,function(W){n.trigger("pan",S-s,W-$);$=W})}a=COG.extend({binder:null,unbinder:null,observable:null},a);for(var n=a.observable,w=null,E=[],G=[],T,Y,D={bind:function(){return n.bind.apply(null,arguments)},pannable:function(H){w=COG.extend({inertia:true},H);return D},unbind:function(){n.unbind();for(var H=0;H<E.length;H++)E[H].unbind();return D}},da=0;da<y.length;da++)E.push(y[da](B,n,a));n.bind("pointerDown",function(){G=[];
Y=T=0});n.bind("pointerMove",function(H,aa,V,N){if(w){G[G.length]={ticks:(new Date).getTime(),x:N.x,y:N.y};n.trigger("pan",N.x,N.y)}T+=N.x?N.x:0;Y+=N.y?N.y:0});n.bind("pointerUp",function(H,aa,V){if(Math.abs(T)>20||Math.abs(Y)>20){if(w){H=G;aa=H.length;var N;var S=V=0,$,s,W;N=aa>0?(new Date).getTime()-H[aa-1].ticks:0;var Q;for(Q=H.length;--Q>1&&N<50;)N+=H[Q].ticks-H[Q-1].ticks;N=aa-Q;if(N>1){for(;Q<aa;Q++){$=H[Q].x-H[Q-1].x;s=H[Q].y-H[Q-1].y;W=H[Q].ticks-H[Q-1].ticks;V+=$/W;S+=s/W}V=Math.min(V/N*
500|0,300);S=Math.min(S/N*500|0,300);o(V,S,COG.easing("quad.out"),500)}}}else n.trigger("tap",aa,V)});return D};i("pointer",{handler:function(B,y,a){function o(s){if(M(s,B))if(da=G(s)){B.style.cursor="move";ja(s);S=s.pageX?s.pageX:s.screenX;$=s.pageY?s.pageY:s.screenY;H=j(S,$);aa=v(B);y.triggerCustom("pointerDown",q("mouse",s),H,R(H,aa))}}function n(s){V=s.pageX?s.pageX:s.screenX;N=s.pageY?s.pageY:s.screenY;if(M(s,B))T(s,da?"pointerMove":"pointerHover")}function w(s){if(da&&G(s)){da=false;if(M(s,
B)){B.style.cursor="default";T(s,"pointerUp")}}}function E(s){if(M(s,B)){var W;s=s||window.event;if(s.detail)W=s.axis===2?-s.detail*Y:0;else{W=s.wheelDeltaY?s.wheelDeltaY:s.wheelDelta;if(window.opera)W=-W}if(W!==0){var Q=j(V,N);y.triggerCustom("zoom",q("mouse",s),Q,R(Q,v(B)),W/D,"wheel");ja(s);s.returnValue=false}}}function G(s){s=s||window.event;return(s.which||s.button)==1}function T(s,W,Q,pa,ra){Q=typeof Q!="undefined"?Q:V;pa=typeof pa!="undefined"?pa:N;var F=Q-S,P=pa-$,O=j(Q,pa);y.triggerCustom(W,
q("mouse",s),O,R(O,aa),j(F,P));if(typeof ra=="undefined"||ra){S=Q;$=pa}}a=COG.extend({},a);var Y=120,D=Y*8,da=false,H,aa,V,N,S,$;a.binder("mousedown",o,false);a.binder("mousemove",n,false);a.binder("mouseup",w,false);a.binder("dblclick",function(s){COG.info("captured double click");if(M(s,B)){var W=j(s.pageX?s.pageX:s.screenX,s.pageY?s.pageY:s.screenY);COG.info("captured double click + target matched");y.triggerCustom("doubleTap",q("mouse",s),W,R(W,v(B)))}},false);a.binder("mousewheel",E,document);
a.binder("DOMMouseScroll",E,document);return{unbind:function(){a.unbinder("mousedown",o,false);a.unbinder("mousemove",n,false);a.unbinder("mouseup",w,false);a.unbinder("mousewheel",E,document);a.unbinder("DOMMouseScroll",E,document)}}},checks:{touch:false}});i("pointer",{handler:function(B,y,a){function o(F){if(F.count<2)return 0;var P=F.x-F.next.x;F=F.y-F.next.y;return~~Math.sqrt(P*P+F*F)}function n(F,P,O){P=P?P:0;O=O?O:0;for(var qa={x:F.x-P,y:F.y-O,id:F.id,count:F.count},sa=qa;F.next;){F=F.next;
sa=sa.next={x:F.x-P,y:F.y-O,id:F.id}}return qa}function w(F,P){var O=F[P?P:"touches"],qa,sa;if(O.length===0)return null;sa=qa={x:O[0].pageX,y:O[0].pageY,id:O[0].identifier,count:O.length};for(var va=1,Ka=O.length;va<Ka;va++)sa=sa.next={x:O[va].pageX,y:O[va].pageY,id:O[va].identifier};return qa}function E(F){if(M(F,B)){N=v(B);var P=w(F,"changedTouches"),O=n(P,N.x,N.y);if(!$){S=H;y.triggerCustom("pointerDown",q("touch",F),P,O)}pa&&y.triggerCustom("pointerDownMulti",q("touch",F),P,O);$=w(F);if($.count>
1)W=o($);ra=1;Q=n($)}}function G(F){if(M(F,B)){F.preventDefault();s=w(F);if(S==H)S=Math.abs($.x-s.x)>D||Math.abs($.y-s.y)>D?da:H;if(S!=H){S=s.count>1?V:aa;if(S==V)if($.count===1){$=n(s);W=o($)}else{var P=o(s);if(Math.abs(W-P)<Y)S=aa;else{var O;O=s.x;var qa=s.next.x,sa=s.y,va=s.next.y,Ka=sa<va?sa:va;O={x:(O<qa?O:qa)+(Math.abs(O-qa)>>1),y:Ka+(Math.abs(sa-va)>>1)};P=P/W;qa=P-ra;y.triggerCustom("zoom",q("touch",F),O,R(O,N),qa,"pinch");ra=P}}S==aa&&y.triggerCustom("pointerMove",q("touch",F),s,n(s,N.x,
N.y),j(s.x-Q.x,s.y-Q.y));pa&&y.triggerCustom("pointerMoveMulti",q("touch",F),s,n(s,N.x,N.y))}Q=n(s)}}function T(F){if(M(F,B)){var P=w(F,"changedTouches"),O=n(P,N.x,N.y);s=w(F);if(!s){S===H&&y.triggerCustom("tap",q("touch",F),P,O);y.triggerCustom("pointerUp",q("touch",F),P,O);$=null}pa&&y.triggerCustom("pointerUpMulti",q("touch",F),P,O)}}a=COG.extend({detailed:false,inertia:false},a);var Y=20,D=7,da=0,H=1,aa=2,V=3,N,S,$,s,W,Q,pa=a.detailed,ra=1;a.binder("touchstart",E,false);a.binder("touchmove",G,
false);a.binder("touchend",T,false);COG.info("initialized touch handler");return{unbind:function(){a.unbinder("touchstart",E,false);a.unbinder("touchmove",G,false);a.unbinder("touchend",T,false)}}},checks:{touch:true}});return{register:i,watch:function(B,y,a){y=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},y);capabilities=COG.extend({touch:"ontouchstart"in window},a);if(!y.observable){COG.info("creating observable");y.observable=COG.observable({});
globalOpts=y}y.binder=y.isIE?A:L(y.bindToBody);y.unbinder=y.isIE?x:X(y.bindToBody);a=y.types;for(var o=capabilities,n=[],w=ka.length;w--;){var E=ka[w],G=!a||a.indexOf(E.type)>=0,T=true;for(var Y in E.checks){var D=E.checks[Y];COG.info("checking "+Y+" capability. require: "+D+", capability = "+o[Y]);T=T&&D===o[Y]}if(G&&T)n[n.length]=E.handler}return new ea(B,n,y)}}}();
T5=function(){function L(){return(new Date).getTime()}function X(){for(;s.length>0;){var c=s.shift();document.location=c}$=0}function A(c){for(var l=true,e=W.length;e--;)l=l&&c!=W[e];return l}function x(c,l){var e=[];for(var b in l)b&&e.push(b+"="+escape(l[b]));return"tile5://"+c+"/"+(e.length>0?"?"+e.join("&"):"")}function j(c,l){A(c)&&COG.info("would push url: "+x(c,l))}function i(c,l){if(A(c)){s.push(x(c,l));$||($=setTimeout(X,100))}}function v(c){return function(l,e,b){(b?b:c?document.body:document).addEventListener(l,
e,false)}}function q(c){return function(l,e,b){(b?b:c?document.body:document).removeEventListener(l,e,false)}}function M(c,l,e){(e?e:document).attachEvent("on"+c,l)}function R(c,l,e){(e?e:document).detachEvent("on"+c,l)}function ja(){V={base:{name:"Unknown",bindEvent:v(),unbindEvent:q(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:j,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:M,unbindEvent:R,
requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:i,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:i},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:i},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:v(true),unbindEvent:q(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:i},
froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:i}};N=[V.froyo,V.android,V.ipod,V.iphone,V.ipad,V.ie]}function ka(){V||ja();if(!S){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var c=0;c<N.length;c++){var l=N[c];if(l.regex&&l.regex.test(navigator.userAgent)){S=COG.extend({},V.base,l);COG.info("PLATFORM DETECTED AS: "+S.name);break}}if(!S){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
S=V.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return S}function ea(){for(var c=0,l=arguments.length;l--;){var e=F[arguments[l].toUpperCase()];if(e)c|=e}return c}var B=Math.abs,y=Math.min,a=Math.max,o=Math.pow,n=Math.sqrt,w=Math.log,E=Math.round,G=Math.sin,T=Math.asin,Y=Math.cos,D=function(){function c(b,d){return e(b.x-d.x,b.y-d.y)}function l(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var h={edges:Array(d-
1),accrued:Array(d-1),total:0},f=0;f<d-1;f++){var p=c(b[f],b[f+1]);h.edges[f]=n(p.x*p.x+p.y*p.y);h.accrued[f]=h.total+h.edges[f];h.total+=h.edges[f]}return h}function e(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,h=arguments.length;h--;){b+=arguments[h].x;d+=arguments[h].y}return e(b,d)},absSize:function(b){return a(B(b.x),B(b.y))},copy:function(b){return b?e(b.x,b.y):null},diff:c,distance:function(b,d){return l(b,d).total},
edges:l,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,h){var f=Y(d)*h;d=G(d)*h;return e(b.x-f,b.y-d)},floor:function(b){for(var d=Array(b.length),h=b.length;h--;)d[h]=e(~~b[h].x,~~b[h].y);return d},getRect:function(b){for(var d,h,f,p,m=b.length;m--;){var k=b[m];d=typeof d==="undefined"||k.x<d?k.x:d;h=typeof h==="undefined"||k.y<h?k.y:h;f=typeof f==="undefined"||k.x>f?k.x:f;p=typeof p==="undefined"||k.y>p?k.y:p}return H.init(d,h,f,p)},init:e,invert:function(b){return e(-b.x,
-b.y)},min:function(b,d){return e(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return e(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,h){return e(b.x+d,b.y+(h?h:d))},simplify:function(b,d){if(!b)return null;d=d?d:D.VECTOR_SIMPLIFICATION;for(var h=[],f=null,p=b.length;p--;){var m=b[p];if(include=!f||p===0||B(m.x-f.x)+B(m.y-f.y)>d){h.unshift(m);f=m}}return h},theta:function(b,d,h){h=T((b.y-d.y)/h);return b.x>d.x?h:Math.PI-h},toString:function(b){return b.x+", "+b.y}}}(),da=function(){return{dotProduct:function(c,
l){return c.x*l.x+c.y*l.y}}}(),H=function(){function c(e){return l(e.x1,e.y1,e.x2,e.y2)}function l(e,b,d,h){e=e?e:0;b=b?b:0;d=typeof d!=="undefined"?d:e;h=typeof h!=="undefined "?h:h;return{x1:e,y1:b,x2:d,y2:h,width:d-e,height:h-b}}return{center:function(e){return D.init(e.x1+e.width/2,e.y1+e.height/2)},copy:c,diagonalSize:function(e){return n(e.width*e.width+e.height*e.height)},fromCenter:function(e,b,d,h){d=d>>1;h=h>>1;return l(e-d,b-h,e+d,b+h)},init:l,intersect:function(e,b){var d=a(e.x1,b.x1),
h=a(e.y1,b.y1),f=y(e.x2,b.x2),p=y(e.y2,b.y2);d=l(d,h,f,p);return d.width>0&&d.height>0?d:null},toString:function(e){return"["+e.x1+", "+e.y1+", "+e.x2+", "+e.y2+"]"},union:function(e,b){if(e.width===0||e.height===0)return c(b);else if(b.width===0||b.height===0)return c(e);else{var d=y(e.x1,b.x1),h=y(e.y1,b.y1),f=a(e.x2,b.x2),p=a(e.y2,b.y2);d=l(d,h,f,p);return d.width>0&&d.height>0?d:null}}}}(),aa=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return D.init(c.width>>
1,c.height>>1)},getSize:function(c){return n(o(c.width,2)+o(c.height,2))},init:function(c,l){c=c?c:0;return{width:c,height:l?l:c}}}}(),V=null,N=[],S=null,$=0,s=[],W=["view.wake","tile.loaded"],Q=function(){function c(){var g=ka().maxImageLoads;if(!g||m.length<g)if(g=p.shift()){m[m.length]=g;g.image.onload=l;g.image.src=g.url;g.requested=T5.ticks()}}function l(){var g=h[this.id],z;if(g&&g.image.complete&&g.image.width>0){g.loaded=true;g.hitCount=1;for(z=m.length;z--;)if(m[z].image.src==this.src){m.splice(z,
1);break}if(g.background||g.postProcess||g.drawBackground||g.customDraw)if(g.image){globalImageData=g;z=b(g.realSize?g.realSize.width:g.image.width,g.realSize?g.realSize.height:g.image.height);var I=z.getContext("2d"),J=g.offset?g.offset:T5.XY.init();g.background&&I.drawImage(g.background,0,0);g.drawBackground&&g.drawBackground(I);g.customDraw?g.customDraw(I,g):I.drawImage(g.image,J.x,J.y);g.postProcess&&g.postProcess(I,g);g.image=z}for(z=g.callbacks.length;z--;)g.callbacks[z]&&g.callbacks[z](this,
false);g.callbacks=[];k[k.length]={url:this.src,created:g.requested};delete h[this.id];c()}}function e(g,z,I){var J=d[g];if(J){J.hitCount++;J.image.complete&&J.image.width>0&&z?z(J.image,true):J.callbacks.push(z)}else{J=COG.extend({url:g,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[z]},I);J.image.id="resourceLoaderImage"+f++;d[g]=J;h[J.image.id]=J;p[p.length]=J;c()}return J}function b(g,z){var I=document.createElement("canvas");COG.info("creating new canvas");
I.width=g?g:0;I.height=z?z:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(I);FlashCanvas.initElement(I)}return I}var d={},h={},f=0,p=[],m=[],k=[],t={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var g;for(g=m.length;g--;)delete d[m[g].url];m=[];for(g=p.length;g--;)delete d[p[g].url];p=[]},get:function(g,z,I){var J=null;J=null;if((J=(J=d[g])?J.image:null)&&(J.getContext||J.complete&&J.width>0))return J;else z&&e(g,z,I);return null},load:e,newCanvas:b,reset:function(){d={}},
stats:function(){return{imageLoadingCount:m.length,queuedImageCount:p.length,imageCacheFullness:0}}};COG.observable(t);return t}(),pa=function(){var c={};return{init:function(l,e){var b=c[l];if(!b)throw Error("Unable to locate requested generator: "+l);return new b(e)},register:function(l,e){c[l]=e},Template:function(){}}}(),ra=function(){function c(f,p){d[f]=e(p);return f}function l(f){for(var p in f)c(p,f[p])}function e(f){function p(g){var z=f[g];typeof z!=="undefined"&&k.push(function(I){I[g]=
z})}function m(){k=[];for(var g in f)p(g)}f=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var k=[],t={applyToContext:function(g){for(var z=k.length;z--;)k[z](g)},update:function(g,z){f[g]=z;m()}};m();return t}var b={},d={},h={apply:function(f,p){var m=d[p]?d[p]:d.basic,k;if(f&&f.canvas){k=b[f.canvas.id];b[f.canvas.id]=p}m.applyToContext(f);return k},define:c,
defineMany:l,get:function(f){return d[f]},init:e,load:function(f){COG.jsonp(f,function(p){l(p)})}};l({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return h}(),F={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},P=function(c){c=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:ea("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},c);var l=null,e=false,b=false,d=
c.id,h=ea("ACTIVE"),f=c.validStates,p=0,m=0,k=COG.extend({addToView:function(t){t.setLayer(d,k)},shouldDraw:function(t){return(t&f)!==0},clip:null,cycle:function(){},draw:function(){},remove:function(){k.trigger("remove",k)},changed:function(){b=true;l&&l.invalidate()},hitTest:null,getId:function(){return d},setId:function(t){d=t},getParent:function(){return l},setParent:function(t){e=(l=t)?l.fastDraw&&displayState!==h:false;k.trigger("parentChange",l)}},c);COG.observable(k);k.bind("drawComplete",
function(t,g){b=false;p=g.x1;m=g.y1});k.bind("resync",function(t,g){if(g.syncXY){k.minXY&&g.syncXY(k.minXY);k.maxXY&&g.syncXY(k.maxXY)}});return k},O=function(c){function l(m,k,t,g){b=m;d=k;h=t;f=g}c=COG.extend({xy:D.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},c);var e=false,b=0,d=0,h=0,f=0,p=COG.extend(c,{isAnimating:function(){return e},draw:function(m,k,t,g,z){if(p.isNew&&c.tweenIn)COG.tweenValue(k.y1-20,p.xy.y,c.tweenIn,c.animationSpeed?c.animationSpeed:250+Math.random()*500,
function(I,J){p.xy.y=I|0;e=!J;z.invalidate()});p.drawMarker(m,k,p.xy.x,p.xy.y,t,g,z);p.isNew=false},drawMarker:function(m,k,t,g){m.beginPath();m.arc(t,g,4,0,Math.PI*2,false);m.fill();l(t-4,g-4,8,8)},hitTest:function(m,k){return m>=b&&m<=b+h&&k>=d&&k<=d+f},updateBounds:l});COG.observable(p);return p},qa=function(c){function l(){e();d.changed();d.trigger("markerUpdate",b)}function e(){var h=d.getParent();if(h&&h.syncXY)for(var f=b.length;f--;)h.syncXY([b[f].xy])}c=COG.extend({zindex:100,style:"basic"},
c);var b=[],d=COG.extend(new P(c),{draw:function(h,f,p,m){for(var k=b.length;k--;)b[k].draw(h,f,p,d,m)},add:function(h){if(h&&typeof h.length!=="undefined")for(var f=h.length;f--;){if(h[f])b[b.length]=h[f]}else if(h)b[b.length]=h;l()},clear:function(h){if(h)for(var f=0;f<b.length;)if(h(b[f]))b.splice(f,1);else f+=1;else b=[];l()},each:function(h){if(h)for(var f=b.length;f--;)h(b[f])},find:function(h){for(var f=[],p=b.length;p--;)if(!h||h(b[p]))f[f.length]=b[p];return f},hitTest:function(h,f){for(var p=
[],m=b.length;m--;)if(b[m].hitTest(h,f))p[p.length]={type:"marker",data:b[m]};return p}});d.bind("tap",function(h,f,p,m){var k=[],t=m.x;m=m.y;for(var g=b.length;g--;)if(b[g].hitTest(t,m))k[k.length]=b[g];if(k.length>0)h.cancel=d.trigger("markerTap",f,p,k).cancel});d.bind("parentChange",e);d.bind("resync",e);return d},sa=function(c){function l(m,k,t){m.fillStyle="#FFFFFF";m.strokeStyle="#222222";m.beginPath();m.arc(t.x,t.y,4,0,Math.PI*2,false);m.stroke();m.fill()}c=COG.extend({path:[],id:COG.objId("pathAni"),
easing:COG.easing("sine.inout"),validStates:ea("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},c);var e=D.edges(c.path),b,d=null,h=c.drawIndicator?c.drawIndicator:l,f=0,p=COG.extend(new P(c),{cycle:function(){for(var m=0;m<e.accrued.length&&e.accrued[m]<f;)m++;d=null;if(m<c.path.length-1){var k=f-(m>0?e.accrued[m-1]:0),t=c.path[m];b=D.theta(t,c.path[m+1],e.edges[m]);d=D.extendBy(t,b,k)}return d},draw:function(m,k){d&&h&&h(m,k,D.init(d.x,d.y),b)}});COG.tweenValue(0,e.total,c.easing,c.duration,
function(m,k){f=m;k&&p.remove();p.changed()});return p},va=function(c){c=COG.extend({style:null,properties:{}},c);return COG.extend(c,{rect:null,draw:function(){},resync:function(){}})},Ka=function(){return{tileSize:256,init:function(c,l,e,b,d){return COG.extend({x:c,y:l,width:e,height:b},d)}}}(),Wa={ex:COG.extend,ticks:L,getConfig:ka,userMessage:function(c,l,e){Wa.trigger("userMessage",c,l,e)},zoomable:function(c,l){function e(f,p){f=f?a(y(f,h),d):d;if(f!=b){b=f;c.triggerAll("zoomLevelChange",f,
p)}}l=COG.extend({initial:1,minZoom:1,maxZoom:16},l);var b=null,d=l.minZoom,h=l.maxZoom;COG.extend(c,{getZoomLevel:function(){return b},setZoomLevel:e});c.bind("scale",function(f,p,m){f=Math.log(p)/Math.LN2;COG.endTweens(function(k){return k.cancelOnInteract});e(b+f,m);c.updateOffset(m.x*p,m.y*p)})},XY:D,XYRect:H,Dimensions:aa,Vector:da,D:aa,Images:Q,Generator:pa,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:ra,viewState:ea,View:function(c){function l(u,r,C,K){ta=
Na;I(fa-r,ga-C,K?c.panAnimationEasing:null,K?c.panAnimationDuration:null);clearTimeout(hb);hb=setTimeout(e,100)}function e(){ta=Xa;wa()}function b(u,r,C,K){Ya(y(a(ca+o(2,K)-1,0.5),2))}function d(){var u=w(ca)/Math.LN2>>0;if(u!==0){ca=o(2,u);u=D.init(Oa-(Ca/ca>>0),Pa-(Da/ca>>0));if(!ha.trigger("scale",ca,u).cancel){for(var r=Z.length;r--;)Z[r].trigger("scale",ca,u);ca=1;ta=Xa}Za()}wa()}function h(u){u||(u=D.init(Ca,Da));$a=D.init(fa,ga);La=D.offset(u,fa,ga);Oa=La.x;Pa=La.y}function f(u,r){var C,K;
K=1/ca;if(ca!==1&&xa){C=xa.x1+u*K;K=xa.y1+r*K}else{C=u+fa;K=r+ga}return D.init(C,K)}function p(u,r,C){Ma("doubleTap",r,C,f(C.x,C.y));if(c.scalable){COG.endTweens(function(K){return K.cancelOnInteract});Ya(2,C,c.zoomAnimation,null,c.zoomDuration)}}function m(){ab=null}function k(u,r,C){ab=f(C.x,C.y);z(r,C,ab,"hover")}function t(){clearTimeout(ib);ib=setTimeout(J,250)}function g(u,r,C){z(r,C,f(C.x,C.y),"tap");Ma("tap",r,C,f(C.x,C.y))}function z(u,r,C,K){for(var U=[],la=ua;la--;)if(Z[la].hitTest)U=U.concat(Z[la].hitTest(C.x,
C.y,ta,ha));U.length>0&&ha.trigger(K+"Hit",U,u,r,C)}function I(u,r,C,K,U){function la(){Ea+=1;if(Ea>=2){e();U&&U()}}var Ea=0,za=Ga?D.offset(Ga,-Ca,-Da):null,Fa=Ha?D.offset(Ha,-Ca,-Da):null;if(za){u=u<za.x?za.x:u;r=r<za.y?za.y:r}if(Fa){u=u>Fa.x?Fa.x:u;r=r>Fa.y?Fa.y:r}if(C){if((ta&Na)===0){COG.tweenValue(fa,u,C,K,function(Ja,bb){fa=Ja|0;(bb?la:wa)();return!Qa});COG.tweenValue(ga,r,C,K,function(Ja,bb){ga=Ja|0;(bb?la:wa)();return!Qa});ta=Na|cb}}else{fa=u|0;ga=r|0;wa();U&&U()}}function J(u,r){var C;if(ma){ya&&
ya.unbind();if(c.autoSize&&ma.parentNode){u=ma.parentNode.offsetWidth;r=ma.parentNode.offsetHeight}try{if(!ma.id)ma.id=c.id+"_canvas";ba=ma.getContext("2d")}catch(K){COG.exception(K);throw Error("Could not initialise canvas on specified view element");}if(u&&r&&(na!==r||oa!==u)){db=true;oa=u;na=r;Ca=oa>>1;Da=na>>1;ha.trigger("resize",oa,na);for(C=ua;C--;)Z[C].trigger("resize",oa,na)}if(c.interactive){ya=INTERACT.watch(ma).pannable();Ia()}for(C=ua;C--;)Z[C].trigger("contextChanged",ba);wa()}}function ia(u,
r){r.setId(u);r.added=L();r.bind("remove",function(){ha.removeLayer(u)});r.trigger("contextChanged",ba);r.setParent(ha);Z.push(r);Z.sort(function(C,K){var U=K.zindex-C.zindex;if(U===0)U=K.added-C.added;return U});ua=Z.length;return r}function Ia(){if(ya){if(c.pannable){ya.bind("pan",l);ya.bind("inertiaCancel",function(){wa()})}if(c.scalable){ya.bind("zoom",b);ya.bind("doubleTap",p)}if(c.captureHover){ya.bind("pointerDown",m);ya.bind("pointerHover",k)}ya.bind("tap",g)}}function Ra(){var u=Sa?fa+Ca:
fa,r=Ta?ga+Da:ga;if(Aa&&Aa>oa)if(u+oa>Aa)fa=Sa?u-Aa>0?fa-Aa:fa:Aa-oa;else if(u<0)fa=Sa?fa+Aa:0;if(Ba&&Ba>na)if(r+na>Ba)ga=Ta?r-Ba>0?ga-Ba:ga:Ba-na;else if(r<0)ga=Ta?ga+Ba:0}function ob(u,r,C,K){var U;H.center(r);var la=0;xa=H.copy(r);xa.scaleFactor=ca;C||ba.clearRect(0,0,oa,na);ba.save();try{ba.globalCompositeOperation="source-over";if(ca!==1){var Ea=xa,za=1/ca;Oa=La.x+(fa-$a.x);Pa=La.y+(ga-$a.y);xa=Ea?H.fromCenter(Oa>>0,Pa>>0,Ea.width*za>>0,Ea.height*za>>0):void 0;ba.scale(ca,ca)}ba.translate(-xa.x1,
-xa.y1);Ha=Ga=null;if(C){ba.beginPath();for(la=ua;la--;)Z[la].clip&&Z[la].clip(ba,xa,u,ha,K);ba.closePath();ba.clip()}for(la=ua;la--;){U=Z[la];var Fa=U.style,Ja=Fa?ra.apply(ba,Fa):null;if(U.minXY)Ga=Ga?D.min(Ga,U.minXY):D.copy(U.minXY);if(U.maxXY)Ha=Ha?D.max(Ha,U.maxXY):D.copy(U.maxXY);U.draw(ba,xa,u,ha,K);Ja&&ra.apply(ba,Ja)}}finally{ba.restore()}if(pb){ba.globalCompositeOperation="source-over";ba.strokeStyle="#f00";ba.beginPath();ba.moveTo(Ca,0);ba.lineTo(Ca,na);ba.moveTo(0,Da);ba.lineTo(oa,Da);
ba.stroke()}eb=0;Ma("drawComplete",r,K)}function jb(u){var r,C=false;if(eb){if(u-kb>qb){if(ca!==1)ta|=lb;Qa=(r=(ta&(lb|Na))!==0)&&(ta&cb)===0;if(db&&ma){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(ma);ma.width=oa;ma.height=na;ma.style.width=oa+"px";ma.style.height=na+"px";db=false}if(Aa||Ba)Ra();Ua=Va();if(Qa){COG.endTweens(function(U){return U.cancelOnInteract});rb=false;if(fb!==0){clearTimeout(fb);fb=0}}for(var K=ua;K--;){if(Z[K].animated)ta|=cb;Z[K].cycle(u,Ua,ta);Z[K].shouldDraw(ta,
Ua);C=Z[K].clip||C}ob(ta,Ua,sb&&C&&!r,u);u-mb>tb&&Za();kb=u}COG.animFrame(jb)}else gb=false}function wa(){eb+=1;if(!gb){gb=true;COG.animFrame(jb)}}function Va(){return H.init(fa,ga,fa+oa,ga+na)}function Za(){mb=(new Date).getTime();Ma("refresh",ha,Va());wa()}function Ya(u,r,C,K,U){if(C)COG.tweenValue(ca,u,C,U,function(la,Ea){ca=la;if(Ea){var za=E(w(ca)/Math.LN2);ca=o(2,za);K&&K()}h(r);d()});else{ca=u;h(r);d()}return ha}function Ma(){for(var u=ha.trigger.apply(null,arguments).cancel,r=Z.length;r--;)u=
Z[r].trigger.apply(null,arguments).cancel||u;return!u}c=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastDraw:false,inertia:true,idleDelay:100,minRefresh:1E3,pannable:true,clipping:true,scalable:true,interactive:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25,zoomAnimation:COG.easing("quad.out"),zoomDuration:300},c);var Z=[],ua=0,ma=document.getElementById(c.container),
ba=null,ub=typeof window.attachEvent!="undefined",tb=c.minRefresh,ab=null,fa=0,ga=0,Aa=null,Ba=null,Sa=false,Ta=false,sb=c.clipping,Ua=null,gb=false,xa,pb=c.guides,nb=1,Ca=0,Da=0,$a=null,La=null,Qa=false,rb=false,fb=0,hb=0,Ga=null,Ha=null,mb=0,vb=0,ib=0,ca=1,kb=0,db=false,ya=null,na,oa,qb=1E3/c.fps|0,eb=0,Oa,Pa,Xa=ea("ACTIVE"),Na=ea("PAN"),lb=ea("ZOOM"),cb=ea("ANIMATING"),ta=Xa,ha={id:c.id,deviceScaling:nb,fastDraw:c.fastDraw||ka().requireFastDraw,getDimensions:function(){return aa.init(oa,na)},getLayer:function(u){for(var r=
0;r<ua;r++)if(Z[r].getId()==u)return Z[r];return null},setLayer:function(u,r){for(var C=0;C<ua;C++)if(Z[C].getId()===u){Z.splice(C,1);break}if(r){ia(u,r);r.trigger("refresh",ha,Va())}wa();return r},eachLayer:function(u){for(var r=ua;r--;)u(Z[r])},invalidate:wa,refresh:Za,resetScale:function(){ca=1},resize:function(u,r){if(ma){c.autoSize=false;if(oa!==u||na!==r)J(u,r)}},scale:Ya,triggerAll:Ma,removeLayer:function(u){a:{for(var r=ua;r--;)if(Z[r].getId()==u){u=r;break a}u=-1}if(u>=0&&u<ua){ha.trigger("layerRemoved",
Z[u]);Z.splice(u,1);wa()}ua=Z.length},getOffset:function(){return D.init(fa,ga)},setMaxOffset:function(u,r,C,K){Aa=u;Ba=r;Sa=typeof C!="undefined"?C:false;Ta=typeof K!="undefined"?K:false},getViewRect:Va,updateOffset:I,pan:function(u,r,C,K,U){I(fa+u,ga+r,C,K,U)}};nb=ka().getScaling();ha.markers=ia("markers",new qa);COG.observable(ha);ha.bind("invalidate",function(){wa()});ha.bind("resync",function(){Ha=Ga=null});COG.configurable(ha,["inertia","container","rotation","tapExtent","scalable","pannable"],
COG.paramTweaker(c,null,{container:function(u,r){ma=document.getElementById(r);J()},rotation:function(u,r){vb=r}}),true);J();if(c.autoSize)ub?window.attachEvent("onresize",t):window.addEventListener("resize",t,false);return ha},ViewLayer:P,ImageLayer:function(c,l){function e(k,t,g){for(t=f.length;t--;){var z=f[t],I=z.x,J=z.y,ia=H.init(z.x,z.y,z.x+z.width,z.y+z.height);if(g&&H.intersect(k,ia))(ia=Q.get(z.url,function(){m.changed()},p))&&g(ia,I,J,z.width,z.height)}}function b(k){var t=++h,g=m.getParent();
d&&d.run(g,k,function(z){if(t==h){f=[].concat(z);g.invalidate()}})}l=COG.extend({imageLoadArgs:{}},l);var d=c?pa.init(c,l):null,h=0,f=[],p=l.imageLoadArgs,m=COG.extend(new P(l),{changeGenerator:function(k,t){d=pa.init(k,COG.extend({},l,t));f=null;b(m.getParent().getViewRect())},clip:function(k,t,g){e(t,g,function(z,I,J,ia,Ia){k.rect(I,J,ia,Ia)})},draw:function(k,t,g){e(t,g,function(z,I,J,ia,Ia){m.drawImage(k,z,I,J,ia,Ia,t,g)})},drawImage:function(k,t,g,z){t&&k.drawImage(t,g,z,t.width,t.height)}});
m.bind("refresh",function(k,t,g){b(g)});m.bind("tap",function(k,t,g,z){k=[];var I=z.x,J=z.y,ia,Ia;if(f)for(var Ra=f.length;Ra--;){ia=f[Ra];if(Ia=I>=ia.x&&I<=ia.x+ia.width&&J>=ia.y&&J<=ia.y+ia.height)k[k.length]=ia}k.length>0&&m.trigger("tapImage",k,t,g,z)});return m},ImageGenerator:function(c){c=COG.extend({relative:false,padding:2},c);c={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(c);return c},Marker:O,ImageMarker:function(c){c=COG.extend({image:null,
imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},c);var l=c.imageAnchor?T5.XY.invert(c.imageAnchor):null,e=COG.extend(new O(c),{drawMarker:function(b,d,h,f){if((d=e.isAnimating()&&e.animatingImage?e.animatingImage:e.image)&&d.width>0){l||(l=D.init(-d.width>>1,-d.height>>1));var p=e.scale,m=h+~~(l.x*p),k=f+~~(l.y*p),t=~~(d.width*p),g=~~(d.height*p);e.updateBounds(m,k,t,t);if(e.rotation||e.opacity!==1){b.save();try{b.globalAlpha=e.opacity;b.translate(h,
f);b.rotate(e.rotation);b.drawImage(d,l.x*p,l.y*p,t,g)}finally{b.restore()}}else b.drawImage(d,m,k,t,g)}}});if(!e.image)e.image=Q.get(c.imageUrl,function(b){e.image=b});if(!e.animatingImage)e.animatingImage=Q.get(c.animatingImageUrl,function(b){e.animatingImage=b});return e},MarkerLayer:qa,PathLayer:function(c){function l(){var k=m.getParent();if(k&&k.syncXY){k.syncXY(d);h&&k.syncXY(h);m.trigger("tidy")}}c=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},c);var e=[],b=null,d=[],h=null,
f=0,p=[],m=COG.extend(new P(c),{getAnimation:function(k,t,g,z){var I="pathAnimation"+f++;p.push(I);return new sa({id:I,path:e,zindex:c.zindex+1,easing:k?k:COG.easing("sine.inout"),duration:t?t:5E3,drawIndicator:g,autoCenter:z?z:false})},draw:function(k){var t,g=e.length;k.save();try{ra.apply(k,c.style);if(g>0){k.beginPath();k.moveTo(e[g-1].x,e[g-1].y);for(t=g;t--;)k.lineTo(e[t].x,e[t].y);k.stroke();if(b){k.fillStyle=c.waypointFillStyle;for(t=b.length;t--;){k.beginPath();k.arc(b[t].x,b[t].y,2,0,Math.PI*
2,false);k.stroke();k.fill()}}}}finally{k.restore()}},updateCoordinates:function(k,t){d=k;h=t;l()}});m.bind("tidy",function(){e=D.simplify(d,c.pixelGeneralization);b=D.simplify(h,c.pixelGeneralization);m.changed(true)});m.bind("resync",l);return m},AnimatedPathLayer:sa,Shape:va,Arc:function(c,l){l=COG.extend({size:4},l);var e=D.init(),b=COG.extend(l,{draw:function(d){d.beginPath();d.arc(e.x,e.y,b.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([c]);e=D.floor([c])[0]}});COG.info("created arc = ",
c);return b},Poly:function(c,l){l=COG.extend({fill:false,simplify:false},l);var e=false,b=l.fill,d=l.simplify,h=ea("ZOOM"),f=[],p=COG.extend(new va(l),{draw:function(m,k,t,g,z,I){if(e){k=true;t=(I&h)!==0;m.beginPath();for(I=f.length;I--;){t=f[I].x;g=f[I].y;if(k){m.moveTo(t,g);k=false}else m.lineTo(t,g);t=true}if(t){b&&m.fill();m.stroke()}}},resync:function(m){p.xy=m.syncXY(c);f=D.floor(d?D.simplify(c):c)}});e=c&&c.length>=2;return p},ShapeLayer:function(c){function l(h){for(var f=b.length;f--;)b[f].resync(h);
b.sort(function(p,m){var k=m.xy.y-p.xy.y;if(k===0)k=m.xy.x-p.xy.y;return k});d.changed()}function e(h,f){f.syncXY&&l(f)}c=COG.extend({zindex:80},c);var b=[],d=COG.extend(new P(c),{add:function(h){b[b.length]=h},each:function(h){for(var f=b.length;f--;)h(b[f])},draw:function(h,f,p){var m=f.x1,k=f.y1,t=f.width;f=f.height;for(var g=b.length;g--;){var z=b[g].style;z=z?ra.apply(h,z):null;b[g].draw(h,m,k,t,f,p);z&&ra.apply(h,z)}}});d.bind("parentChange",e);d.bind("resync",e);return d},Tiling:Ka};COG.observable(Wa);
return Wa}();
