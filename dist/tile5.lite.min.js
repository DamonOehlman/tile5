COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var H=arguments[0]||{},V,A=1,u=arguments.length;A<u;A++)if((V=arguments[A])!==null)for(var f in V){var h=V[f];if(H!==h)if(h!==undefined)H[f]=h}return H};
(function(){var H=Object.prototype.hasOwnProperty,V=0,A={};A.toID=function(u){return u.replace(/\s/g,"-")};A.objId=function(u){return(u?u:"obj")+V++};A.isFunction=function(u){return toString.call(u)==="[object Function]"};A.isArray=function(u){return toString.call(u)==="[object Array]"};A.isPlainObject=function(u){if(!u||toString.call(u)!=="[object Object]"||u.nodeType||u.setInterval)return false;if(u.constructor&&!H.call(u,"constructor")&&!H.call(u.constructor.prototype,"isPrototypeOf"))return false;
var f;for(f in u);return f===undefined||H.call(u,f)};A.isEmptyObject=function(u){for(var f in u)return false;return true};A.isXmlDocument=function(u){return toString.call(u)==="[object Document]"};A.contains=function(u,f){var h=u,p=arguments,v=1;if(f&&module.isArray(f)){p=f;v=0}for(v=v;v<p;v++)h=h&&typeof foo[p[v]]!=="undefined";return h};A.formatStr=function(u){if(arguments.length<=1)return u;for(var f=arguments.length-2,h=0;h<=f;h++)u=u.replace(RegExp("\\{"+h+"\\}","gi"),arguments[h+1]);return u};
A.wordExists=function(u,f){var h="";if(f.toString)f=f.toString();for(var p=0;p<f.length;p++)h+=!/\w/.test(f[p])?"\\"+f[p]:f[p];return RegExp("(^|\\s|\\,)"+h+"(\\,|\\s|$)","i").test(u)};COG.extend(COG,A)})();
(function(){function H(h){return typeof console!=="undefined"?function(){console[h](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var V=window.console&&window.console.markTimeline,A=H("error"),u=H("info"),f=function(){return V?function(h,p){console.markTimeline(h+(p?": "+((new Date).getTime()-p)+"ms":""))}:function(){}}();COG.extend(COG,{trace:f,debug:H("debug"),info:u,warn:H("warn"),error:A,exception:function(h){if(A)for(var p in h)u("ERROR DETAIL: "+p+
": "+h[p])}})})();
(function(){function H(A,u){var f=A.obsHandlers;f[u]||(f[u]=[]);return f[u]}var V=0;COG.observable=function(A){if(!A)return null;if(!A.obsHandlers)A.obsHandlers={};if(!(A.bind||A.trigger||A.unbind)){A.bind=function(u,f){var h="callback"+V++;H(A,u).unshift({fn:f,id:h});return h};A.triggerCustom=function(u,f){var h=H(A,u),p={cancel:false,name:u,source:this},v;f&&COG.extend(p,f);if(!h)return null;v=Array.prototype.slice.call(arguments,2);A.eventInterceptor&&A.eventInterceptor(u,p,v);v.unshift(p);for(var c=
h.length;c--&&!p.cancel;)h[c].fn.apply(this,v);return p};A.trigger=function(u){var f=Array.prototype.slice.call(arguments,1);f.splice(0,0,u,null);return A.triggerCustom.apply(this,f)};A.unbind=function(u,f){if(typeof u==="undefined")A.obsHandlers={};else for(var h=H(A,u),p=0;h&&p<h.length;p++)if(h[p].id===f){h.splice(p,1);break}return A}}return A}})();
(function(){function H(f,h){f[h]||(f[h]=function(p){return f.configure(h,p)})}function V(f){f.gtConfId="configurable"+u++;f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var A={},u=0;COG.paramTweaker=function(f,h,p){return function(v,c){if(typeof c!=="undefined"){if(v in f)f[v]=c;p&&v in p&&p[v](v,c)}else return h&&v in h?h[v](v):f[v]}};COG.configurable=function(f,h,p,v){if(f){f.gtConfId||V(f);var c=f.gtConfId,y=f.gtConfig,x=f.gtConfigFns;A[c]=f;x.push(p);for(p=h.length;p--;){y[h[p]]=true;v&&H(f,
h[p])}if(!f.configure)f.configure=function(B,R){if(y[B]){for(var n=x.length;n--;){var s=x[n](B,R);if(typeof s!=="undefined")return s}return A[c]}return null}}}})();
(function(){function H(f){var h=document.createElement("script"),p=false;h.src=f;h.async=true;h.onload=h.onreadystatechange=function(){if(!p&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){p=true;h.onload=h.onreadystatechange=null;h&&h.parentNode&&h.parentNode.removeChild(h)}};A||(A=document.getElementsByTagName("head")[0]);A.appendChild(h)}var V=0,A,u=this;COG.jsonp=function(f,h,p){f+=f.indexOf("?")>=0?"&":"?";var v="json"+ ++V;u[v]=function(c){h(c);u[v]=null;try{delete u[v]}catch(y){}};
H(f+(p?p:"callback")+"="+v);return v}})();
(function(){var H=1.70158,V=Math.PI/2,A=Math.abs,u=Math.pow,f=Math.sin,h=Math.asin,p=Math.cos,v={linear:function(c,y,x,B){return x*c/B+y},backin:function(c,y,x,B){return x*(c/=B)*c*((H+1)*c-H)+y},backout:function(c,y,x,B){return x*((c=c/B-1)*c*((H+1)*c+H)+1)+y},backinout:function(c,y,x,B){return(c/=B/2)<1?x/2*c*c*(((H*=1.525)+1)*c-H)+y:x/2*((c-=2)*c*(((H*=1.525)+1)*c+H)+2)+y},bouncein:function(c,y,x,B){return x-v.bounceout(B-c,0,x,B)+y},bounceout:function(c,y,x,B){return(c/=B)<1/2.75?x*7.5625*c*c+
y:c<2/2.75?x*(7.5625*(c-=1.5/2.75)*c+0.75)+y:c<2.5/2.75?x*(7.5625*(c-=2.25/2.75)*c+0.9375)+y:x*(7.5625*(c-=2.625/2.75)*c+0.984375)+y},bounceinout:function(c,y,x,B){return c<B/2?v.bouncein(c*2,0,x,B)/2+y:v.bounceout(c*2-B,0,x,B)/2+x/2+y},cubicin:function(c,y,x,B){return x*(c/=B)*c*c+y},cubicout:function(c,y,x,B){return x*((c=c/B-1)*c*c+1)+y},cubicinout:function(c,y,x,B){if((c/=B/2)<1)return x/2*c*c*c+y;return x/2*((c-=2)*c*c+2)+y},elasticin:function(c,y,x,B,R,n){if(c==0)return y;if((c/=B)==1)return y+
x;n||(n=B*0.3);if(!R||R<A(x)){R=x;x=n/4}else x=n/TWO_PI*h(x/R);return-(R*u(2,10*(c-=1))*f((c*B-x)*TWO_PI/n))+y},elasticout:function(c,y,x,B,R,n){var s;if(c==0)return y;if((c/=B)==1)return y+x;n||(n=B*0.3);if(!R||R<A(x)){R=x;s=n/4}else s=n/TWO_PI*h(x/R);return R*u(2,-10*c)*f((c*B-s)*TWO_PI/n)+x+y},elasticinout:function(c,y,x,B,R,n){var s;if(c==0)return y;if((c/=B/2)==2)return y+x;n||(n=B*0.3*1.5);if(!R||R<A(x)){R=x;s=n/4}else s=n/TWO_PI*h(x/R);if(c<1)return-0.5*R*u(2,10*(c-=1))*f((c*B-s)*TWO_PI/n)+
y;return R*u(2,-10*(c-=1))*f((c*B-s)*TWO_PI/n)*0.5+x+y},quadin:function(c,y,x,B){return x*(c/=B)*c+y},quadout:function(c,y,x,B){return-x*(c/=B)*(c-2)+y},quadinout:function(c,y,x,B){if((c/=B/2)<1)return x/2*c*c+y;return-x/2*(--c*(c-2)-1)+y},sinein:function(c,y,x,B){return-x*p(c/B*V)+x+y},sineout:function(c,y,x,B){return x*f(c/B*V)+y},sineinout:function(c,y,x,B){return-x/2*(p(Math.PI*c/B)-1)+y}};COG.tweenValue=function(c,y,x,B,R){function n(T){var M=T-s,aa=x(M,c,C,B),$=s+B<=T;T=!$;if(R){M=R(aa,$,M);
T=typeof M!="undefined"?M&&T:T}T&&animFrame(n)}var s=(new Date).getTime(),C=y-c;animFrame(n);return{}};COG.easing=function(c){return v[c.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(c,y){v[c.replace(/[\-\_\s\.]/g,"").toLowerCase()]=y}})();
(function(){var H=/^P(\d+Y)?(\d+M)?(\d+D)?$/,V=/^(\d+H)?(\d+M)?(\d+S)?$/,A={8601:function(f){f=f.split("T");var h=null;h=null;var p=0,v=0;H.lastIndex=-1;h=H.exec(f[0]);p+=h[3]?parseInt(h[3].slice(0,-1),10):0;V.lastIndex=-1;h=V.exec(f[1]);v+=h[1]?parseInt(h[1].slice(0,-1),10)*3600:0;v+=h[2]?parseInt(h[2].slice(0,-1),10)*60:0;v+=h[3]?parseInt(h[3].slice(0,-1),10):0;return new u(p,v)}},u=COG.Duration=function(f,h){return{days:f?f:0,seconds:h?h:0}};COG.addDuration=function(){for(var f=new u,h=arguments.length;h--;){f.days+=
arguments[h].days;f.seconds+=arguments[h].seconds}if(f.seconds>=86400){f.days+=~~(f.seconds/86400);f.seconds%=86400}return f};COG.formatDuration=function(f){var h,p,v="";if(f.days)v=f.days+" days ";if(f.seconds){f=f.seconds;if(f>=3600){h=~~(f/3600);f-=h*3600}if(f>=60){p=Math.round(f/60);f-=p*60}if(h)v=v+h+(h>1?" hrs ":" hr ")+(p?(p>10?p:"0"+p)+" min ":"");else if(p)v=v+p+" min";else if(f>0)v=v+(f>10?f:"0"+f)+" sec"}return v};COG.parseDuration=function(f,h){var p=h?A[h]:null;if(p)return p(f);COG.Log.warn("Could not find duration parser for specified format: "+
h);return new u}})();var CANI={};
(function(H){var V=[],A=0,u=false,f=H.register=function(h,p){V.push({section:h,run:p})};H.init=function(h){function p(){if(A<V.length){var c=V[A++];v[c.section]||(v[c.section]={});c.run(v[c.section],p)}else{for(c in v)H[c]=v[c];u=true;h&&h(H)}}var v={};if(u&&h)h(H);else{A=0;p()}};f("canvas",function(h,p){var v=document.createElement("canvas"),c=v.getContext("2d");v.width=200;v.height=200;h.pipTransformed=function(){var y;c.save();try{c.translate(50,50);c.beginPath();c.rect(0,0,20,20);y=c.isPointInPath(10,
10)}finally{c.restore()}return y}();p()})})(CANI);
INTERACT=function(){function H(n){return function(s,C,T){(T?T:n?document.body:document).addEventListener(s,C,false)}}function V(n){return function(s,C,T){(T?T:n?document.body:document).removeEventListener(s,C,false)}}function A(n,s,C){(C?C:document).attachEvent("on"+n,s)}function u(n,s,C){(C?C:document).detachEvent("on"+n,s)}function f(n,s){return{x:n?n:0,y:s?s:0,count:1}}function h(n,s){B.push(COG.extend({handler:null,checks:{},type:n},s))}function p(n){var s=0,C=0;if(n.offsetParent){do{s+=n.offsetLeft;
C+=n.offsetTop;n=n.offsetParent}while(n)}return{x:s,y:C}}function v(n,s){return{source:n,target:s.target?s.target:s.srcElement}}function c(n,s){for(var C=n.target?n.target:n.srcElement;C&&C!==s&&C.nodeName&&C.nodeName.toUpperCase()!="CANVAS";)C=C.parentNode;return C&&C===s}function y(n,s){return{x:n.x-(s?s.x:0),y:n.y-(s?s.y:0)}}function x(n){if(n.preventDefault){n.preventDefault();n.stopPropagation()}else n.cancelBubble&&n.cancelBubble()}var B=[],R=function(n,s,C){function T(Y,I,ba,F){var O=0,U=0,
q=0;COG.tweenValue(0,Y,ba,F,function(W){q=O;O=W});COG.tweenValue(0,I,ba,F,function(W){M.trigger("pan",O-q,W-U);U=W})}C=COG.extend({binder:null,unbinder:null,observable:null},C);for(var M=C.observable,aa=null,$=[],Z=[],ma,pa,va={bind:function(){return M.bind.apply(null,arguments)},pannable:function(Y){aa=COG.extend({inertia:true},Y);return va},unbind:function(){M.unbind();for(var Y=0;Y<$.length;Y++)$[Y].unbind();return va}},Aa=0;Aa<s.length;Aa++)$.push(s[Aa](n,M,C));M.bind("pointerDown",function(){Z=
[];pa=ma=0});M.bind("pointerMove",function(Y,I,ba,F){if(aa){Z[Z.length]={ticks:(new Date).getTime(),x:F.x,y:F.y};M.trigger("pan",F.x,F.y)}ma+=F.x?F.x:0;pa+=F.y?F.y:0});M.bind("pointerUp",function(Y,I,ba){if(Math.abs(ma)>20||Math.abs(pa)>20){if(aa){ba=Z.length;var F,O;I=0;for(O=Z.length;--O>1&&I<50;)I+=Z[O].ticks-Z[O-1].ticks;if(ba-O>1){Y=Z[ba-1].x-Z[O].x;F=Z[ba-1].y-Z[O].y;O=Math.sqrt(Y*Y+F*F)|0;if(O>15){Y=Z[ba-1].x-Z[0].x;F=Z[ba-1].y-Z[0].y;O=Math.sqrt(Y*Y+F*F)|0;ba=Math.asin(F/O);I=O*500/I|0;I=
I>300?300:I;T(Math.cos(Y>0?ba:Math.PI-ba)*I,Math.sin(ba)*I,COG.easing("sine.out"),500)}}}}else M.trigger("tap",I,ba)});return va};h("pointer",{handler:function(n,s,C){function T(q){if(c(q,n))if(Aa=Z(q)){n.style.cursor="move";x(q);O=q.pageX?q.pageX:q.screenX;U=q.pageY?q.pageY:q.screenY;Y=f(O,U);I=p(n);s.triggerCustom("pointerDown",v("mouse",q),Y,y(Y,I))}}function M(q){ba=q.pageX?q.pageX:q.screenX;F=q.pageY?q.pageY:q.screenY;if(c(q,n))ma(q,Aa?"pointerMove":"pointerHover")}function aa(q){if(Aa&&Z(q)){Aa=
false;if(c(q,n)){n.style.cursor="default";ma(q,"pointerUp")}}}function $(q){if(c(q,n)){var W;q=q||window.event;if(q.detail)W=q.axis===2?-q.detail*pa:0;else{W=q.wheelDeltaY?q.wheelDeltaY:q.wheelDelta;if(window.opera)W=-W}if(W!==0){var ia=f(ba,F);s.triggerCustom("zoom",v("mouse",q),ia,y(ia,p(n)),W/va,"wheel");x(q);q.returnValue=false}}}function Z(q){q=q||window.event;return(q.which||q.button)==1}function ma(q,W,ia,ra,Ga){ia=typeof ia!="undefined"?ia:ba;ra=typeof ra!="undefined"?ra:F;var G=ia-O,S=ra-
U,L=f(ia,ra);I||(I=p(n));s.triggerCustom(W,v("mouse",q),L,y(L,I),f(G,S));if(typeof Ga=="undefined"||Ga){O=ia;U=ra}}C=COG.extend({},C);var pa=120,va=pa*8,Aa=false,Y,I,ba,F,O,U;C.binder("mousedown",T,false);C.binder("mousemove",M,false);C.binder("mouseup",aa,false);C.binder("dblclick",function(q){COG.info("captured double click");if(c(q,n)){var W=f(q.pageX?q.pageX:q.screenX,q.pageY?q.pageY:q.screenY);COG.info("captured double click + target matched");s.triggerCustom("doubleTap",v("mouse",q),W,y(W,p(n)))}},
false);C.binder("mousewheel",$,document);C.binder("DOMMouseScroll",$,document);return{unbind:function(){C.unbinder("mousedown",T,false);C.unbinder("mousemove",M,false);C.unbinder("mouseup",aa,false);C.unbinder("mousewheel",$,document);C.unbinder("DOMMouseScroll",$,document)}}},checks:{touch:false}});h("pointer",{handler:function(n,s,C){function T(G){if(G.count<2)return 0;var S=G.x-G.next.x;G=G.y-G.next.y;return~~Math.sqrt(S*S+G*G)}function M(G,S,L){S=S?S:0;L=L?L:0;for(var wa={x:G.x-S,y:G.y-L,id:G.id,
count:G.count},sa=wa;G.next;){G=G.next;sa=sa.next={x:G.x-S,y:G.y-L,id:G.id}}return wa}function aa(G,S){var L=G[S?S:"touches"],wa,sa;if(L.length===0)return null;sa=wa={x:L[0].pageX,y:L[0].pageY,id:L[0].identifier,count:L.length};for(var ja=1,Ca=L.length;ja<Ca;ja++)sa=sa.next={x:L[ja].pageX,y:L[ja].pageY,id:L[ja].identifier};return wa}function $(G){if(c(G,n)){F=p(n);var S=aa(G,"changedTouches"),L=M(S,F.x,F.y);if(!U){O=Y;s.triggerCustom("pointerDown",v("touch",G),S,L)}ra&&s.triggerCustom("pointerDownMulti",
v("touch",G),S,L);U=aa(G);if(U.count>1)W=T(U);Ga=1;ia=M(U)}}function Z(G){if(c(G,n)){G.preventDefault();q=aa(G);if(O==Y)O=Math.abs(U.x-q.x)>va||Math.abs(U.y-q.y)>va?Aa:Y;if(O!=Y){O=q.count>1?ba:I;if(O==ba)if(U.count===1){U=M(q);W=T(U)}else{var S=T(q);if(Math.abs(W-S)<pa)O=I;else{var L;L=q.x;var wa=q.next.x,sa=q.y,ja=q.next.y,Ca=sa<ja?sa:ja;L={x:(L<wa?L:wa)+(Math.abs(L-wa)>>1),y:Ca+(Math.abs(sa-ja)>>1)};S=S/W;wa=S-Ga;s.triggerCustom("zoom",v("touch",G),L,y(L,F),wa,"pinch");Ga=S}}O==I&&s.triggerCustom("pointerMove",
v("touch",G),q,M(q,F.x,F.y),f(q.x-ia.x,q.y-ia.y));ra&&s.triggerCustom("pointerMoveMulti",v("touch",G),q,M(q,F.x,F.y))}ia=M(q)}}function ma(G){if(c(G,n)){var S=aa(G,"changedTouches"),L=M(S,F.x,F.y);q=aa(G);if(!q){s.triggerCustom("pointerUp",v("touch",G),S,L);U=null}ra&&s.triggerCustom("pointerUpMulti",v("touch",G),S,L)}}C=COG.extend({detailed:false,inertia:false},C);var pa=20,va=7,Aa=0,Y=1,I=2,ba=3,F,O,U,q,W,ia,ra=C.detailed,Ga=1;C.binder("touchstart",$,false);C.binder("touchmove",Z,false);C.binder("touchend",
ma,false);COG.info("initialized touch handler");return{unbind:function(){C.unbinder("touchstart",$,false);C.unbinder("touchmove",Z,false);C.unbinder("touchend",ma,false)}}},checks:{touch:true}});return{register:h,watch:function(n,s,C){s=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},s);capabilities=COG.extend({touch:"ontouchstart"in window},C);if(!s.observable){COG.info("creating observable");s.observable=COG.observable({});globalOpts=s}s.binder=
s.isIE?A:H(s.bindToBody);s.unbinder=s.isIE?u:V(s.bindToBody);C=s.types;for(var T=capabilities,M=[],aa=B.length;aa--;){var $=B[aa],Z=!C||C.indexOf($.type)>=0,ma=true;for(var pa in $.checks){var va=$.checks[pa];COG.info("checking "+pa+" capability. require: "+va+", capability = "+T[pa]);ma=ma&&va===T[pa]}if(Z&&ma)M[M.length]=$.handler}return new R(n,M,s)}}}();var T5={};
(function(H){function V(){return(new Date).getTime()}function A(){for(;ra.length>0;){var a=ra.shift();document.location=a}ia=0}function u(a){for(var i=true,e=Ga.length;e--;)i=i&&a!=Ga[e];return i}function f(a,i){var e=[];for(var b in i)b&&e.push(b+"="+escape(i[b]));return"tile5://"+a+"/"+(e.length>0?"?"+e.join("&"):"")}function h(a,i){u(a)&&COG.info("would push url: "+f(a,i))}function p(a,i){if(u(a)){ra.push(f(a,i));ia||(ia=setTimeout(A,100))}}function v(a){return function(i,e,b){(b?b:a?document.body:
document).addEventListener(i,e,false)}}function c(a){return function(i,e,b){(b?b:a?document.body:document).removeEventListener(i,e,false)}}function y(a,i,e){(e?e:document).attachEvent("on"+a,i)}function x(a,i,e){(e?e:document).detachEvent("on"+a,i)}function B(){U={base:{name:"Unknown",bindEvent:v(),unbindEvent:c(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:h,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:y,unbindEvent:x,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:p,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:p},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:p},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:v(true),unbindEvent:c(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:p},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:p}};q=[U.froyo,U.android,U.ipod,U.iphone,U.ipad,U.ie]}function R(){U||B();if(!W){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<q.length;a++){var i=q[a];if(i.regex&&i.regex.test(navigator.userAgent)){W=COG.extend({},U.base,i);COG.info("PLATFORM DETECTED AS: "+W.name);break}}if(!W){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
W=U.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return W}function n(){for(var a=0,i=arguments.length;i--;){var e=wa[arguments[i].toUpperCase()];if(e)a|=e}return a}function s(a,i){var e,b;if(i&&i.width>0){if(!a.imageOffset)a.imageOffset=I.init(-i.width>>1,-i.height>>1);if(!a.bounds){e=a.xy.x+a.imageOffset.x;b=a.xy.y+a.imageOffset.y;a.bounds=F.init(e,b,e+i.width,b+i.height)}}}function C(a){var i=0,e=1,b=0,d=0;COG.extend(a,{rotate:function(j){i=j},scale:function(j){e=j},translate:function(j,
g){b=j;d=g},transform:function(j,g,w){j.save();j.translate(a.xy.x-g+b,a.xy.y-w+d);i!==0&&j.rotate(i);e!==1&&j.scale(e,e)}})}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},1E3/60)}}();var T=Math.abs,M=Math.min,aa=Math.max,$=Math.pow,Z=Math.sqrt,ma=Math.log,pa=Math.round,va=Math.sin,Aa=Math.asin,
Y=Math.cos,I=function(){function a(b,d){return e(b.x-d.x,b.y-d.y)}function i(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var j={edges:Array(d-1),accrued:Array(d-1),total:0},g=0;g<d-1;g++){var w=a(b[g],b[g+1]);j.edges[g]=Z(w.x*w.x+w.y*w.y);j.accrued[g]=j.total+j.edges[g];j.total+=j.edges[g]}return j}function e(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,d=0,j=arguments.length;j--;){b+=arguments[j].x;d+=arguments[j].y}return e(b,d)},absSize:function(b){return aa(T(b.x),T(b.y))},copy:function(b){return b?e(b.x,b.y):null},diff:a,distance:function(b,d){return i(b,d).total},edges:i,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,j){var g=Y(d)*j;d=va(d)*j;return e(b.x-g,b.y-d)},floor:function(b){for(var d=Array(b.length),j=b.length;j--;)d[j]=e(~~b[j].x,~~b[j].y);return d},getRect:function(b){for(var d,j,g,w,D=b.length;D--;){var o=
b[D];d=typeof d==="undefined"||o.x<d?o.x:d;j=typeof j==="undefined"||o.y<j?o.y:j;g=typeof g==="undefined"||o.x>g?o.x:g;w=typeof w==="undefined"||o.y>w?o.y:w}return F.init(d,j,g,w)},init:e,invert:function(b){return e(-b.x,-b.y)},min:function(b,d){return e(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return e(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,j){return e(b.x+d,b.y+(j?j:d))},scale:function(b,d){return e(b.x/d|0,b.y/d|0)},simplify:function(b,d){if(!b)return null;d=d?d:I.VECTOR_SIMPLIFICATION;
for(var j=[],g=null,w=b.length;w--;){var D=b[w];if(include=!g||w===0||T(D.x-g.x)+T(D.y-g.y)>d){j.unshift(D);g=D}}return j},theta:function(b,d,j){j=Aa((b.y-d.y)/j);return b.x>d.x?j:Math.PI-j},toString:function(b){return b?b.x+", "+b.y:""}}}(),ba=function(){return{dotProduct:function(a,i){return a.x*i.x+a.y*i.y}}}(),F=function(){function a(e){return i(e.x1,e.y1,e.x2,e.y2)}function i(e,b,d,j){e=e?e:0;b=b?b:0;d=typeof d!=="undefined"?d:e;j=typeof j!=="undefined "?j:j;return{x1:e,y1:b,x2:d,y2:j,width:d-
e,height:j-b}}return{center:function(e){return I.init(e.x1+(e.width>>1),e.y1+(e.height>>1))},copy:a,diagonalSize:function(e){return Z(e.width*e.width+e.height*e.height)},fromCenter:function(e,b,d,j){d=d>>1;j=j>>1;return i(e-d,b-j,e+d,b+j)},init:i,intersect:function(e,b){var d=aa(e.x1,b.x1),j=aa(e.y1,b.y1),g=M(e.x2,b.x2),w=M(e.y2,b.y2);d=i(d,j,g,w);return d.width>0&&d.height>0?d:null},toString:function(e){return e?"["+e.x1+", "+e.y1+", "+e.x2+", "+e.y2+"]":""},union:function(e,b){if(e.width===0||e.height===
0)return a(b);else if(b.width===0||b.height===0)return a(e);else{var d=M(e.x1,b.x1),j=M(e.y1,b.y1),g=aa(e.x2,b.x2),w=aa(e.y2,b.y2);d=i(d,j,g,w);return d.width>0&&d.height>0?d:null}}}}(),O=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return I.init(a.width>>1,a.height>>1)},getSize:function(a){return Z($(a.width,2)+$(a.height,2))},init:function(a,i){a=a?a:0;return{width:a,height:i?i:a}}}}();Hits=function(){return{diffHits:function(a,i){var e=
[],b={},d;for(d=i.length;d--;)b[i[d].target.id]=true;for(d=a.length;d--;)b[a[d].target.id]||(e[e.length]=a[d]);return e},init:function(a,i,e,b){return{type:a,x:b.x|0,y:b.y|0,elements:[],absXY:i,relXY:e}},initHit:function(a,i,e){return e=COG.extend({type:a,target:i,drag:false},e)},triggerEvent:function(a,i,e,b){i.triggerCustom(a.type+(e?e:"Hit"),{hitType:a.type},b?b:a.elements,a.absXY,a.relXY,I.init(a.x,a.y))}}}();var U=null,q=[],W=null,ia=0,ra=[],Ga=["view.wake","tile.loaded"],G=function(){function a(){var k=
R().maxImageLoads;if(!k||r.length<k){var E=o.shift();k=T5.ticks();if(E){r[r.length]=E;E.image.onload=e;E.image.src=E.url;E.requested=k}if(k-ca>j){E=false;for(var P=0,J=R();P<r.length;)if(k-r[P].requested>N.loadTimeout*1E3){r.splice(P,1);E=true}else P++;E&&a();if(J&&J.imageCacheMaxSize){K=z.length*N.avgImageSize/J.imageCacheMaxSize;K>=1&&i()}ca=k}}}function i(){ea=true;try{var k=z.length>>1;if(k>0){z.sort(function(P,J){return P.created-J.created});for(var E=k;E--;)delete g[z[E].url];z.splice(0,k)}}finally{ea=
false}N.trigger("cacheCleared")}function e(){var k=w[this.id],E;if(k&&k.image.complete&&k.image.width>0){k.loaded=true;k.hitCount=1;for(E=r.length;E--;)if(r[E].image.src==this.src){r.splice(E,1);break}if(k.background||k.postProcess||k.drawBackground||k.customDraw)if(k.image){globalImageData=k;E=d(k.realSize?k.realSize.width:k.image.width,k.realSize?k.realSize.height:k.image.height);var P=E.getContext("2d"),J=k.offset?k.offset:T5.XY.init();k.background&&P.drawImage(k.background,0,0);k.drawBackground&&
k.drawBackground(P);k.customDraw?k.customDraw(P,k):P.drawImage(k.image,J.x,J.y);k.postProcess&&k.postProcess(P,k);k.image=E}for(E=k.callbacks.length;E--;)k.callbacks[E]&&k.callbacks[E](this,false);k.callbacks=[];z[z.length]={url:this.src,created:k.requested};delete w[this.id];a()}}function b(k,E,P){var J=g[k];if(J){J.hitCount++;J.image.complete&&J.image.width>0&&E?E(J.image,true):J.callbacks.push(E)}else{J=COG.extend({url:k,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,
callbacks:[E]},P);J.image.id="resourceLoaderImage"+D++;g[k]=J;w[J.image.id]=J;o[o.length]=J;a()}return J}function d(k,E){var P=document.createElement("canvas");COG.info("creating new canvas");P.width=k?k:0;P.height=E?E:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(P);FlashCanvas.initElement(P)}return P}var j=1E4,g={},w={},D=0,o=[],r=[],z=[],K=0,ca=0,ea=false,N={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var k;for(k=r.length;k--;)delete g[r[k].url];r=[];for(k=o.length;k--;)delete g[o[k].url];
o=[]},get:function(k,E,P){var J=null,Da=null;ea||(J=g[k]);if((Da=J?J.image:null)&&(Da.getContext||Da.complete&&Da.width>0))return Da;else E&&b(k,E,P);return null},load:b,newCanvas:d,reset:function(){g={}},stats:function(){return{imageLoadingCount:r.length,queuedImageCount:o.length,imageCacheFullness:K}}};COG.observable(N);return N}(),S=function(){var a={};return{init:function(i,e){var b=a[i];if(!b)throw Error("Unable to locate requested generator: "+i);return new b(e)},register:function(i,e){a[i]=
e},Template:function(){}}}(),L=function(){function a(g,w){d[g]=e(w);return g}function i(g){for(var w in g)a(w,g[w])}function e(g){function w(z){var K=g[z];typeof K!=="undefined"&&o.push(function(ca){ca[z]=K})}function D(){o=[];for(var z in g)w(z)}g=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var o=[],r={applyToContext:function(z){for(var K=o.length;K--;)o[K](z)},
update:function(z,K){g[z]=K;D()}};D();return r}var b={},d={},j={apply:function(g,w){var D=d[w]?d[w]:d.basic,o;if(g&&g.canvas){o=b[g.canvas.id];b[g.canvas.id]=w}D.applyToContext(g);return o},define:a,defineMany:i,get:function(g){return d[g]},init:e,load:function(g){COG.jsonp(g,function(w){i(w)})}};i({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});
return j}(),wa={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},sa=function(a){a=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:n("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);var i=null,e=false,b=false,d=a.id,j=n("ACTIVE"),g=a.validStates,w=0,D=0,o=COG.extend({addToView:function(r){r.setLayer(d,o)},shouldDraw:function(r){return(r&g)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){o.trigger("remove",o)},
changed:function(){b=true;i&&i.invalidate()},hitTest:null,getId:function(){return d},setId:function(r){d=r},getParent:function(){return i},setParent:function(r){e=(i=r)?i.fastDraw&&displayState!==j:false;o.trigger("parentChange",i)}},a);COG.observable(o);o.bind("drawComplete",function(r,z){b=false;w=z.x1;D=z.y1});o.bind("resync",function(r,z){o.minXY&&z.syncXY(o.minXY);o.maxXY&&z.syncXY(o.maxXY)});return o},ja=function(a){a=COG.extend({style:null,xy:null,fill:false,draggable:false,observable:true,
properties:{},type:"shape",transformable:false},a);COG.extend(this,a);this.id=COG.objId(this.type);this.bounds=null;this.observable&&COG.observable(this);this.transformable&&C(this)};ja.prototype={constructor:ja,drag:null,draw:function(a){this.fill&&a.fill();a.stroke()},prepPath:function(){},resync:function(a){this.xy&&a.syncXY([this.xy])},updateBounds:function(a,i){this.bounds=a;if(i)this.xy=F.center(this.bounds)}};var Ca=function(a,i){i=COG.extend({simplify:false},i);var e=false,b=i.simplify;n("ZOOM");
var d=[];i.type=i.fill?"polygon":"line";ja.call(this,i);COG.extend(this,{prepPath:function(j,g,w){if(e){var D=true;j.beginPath();for(var o=d.length;o--;){var r=d[o].x-g,z=d[o].y-w;if(D){j.moveTo(r,z);D=false}else j.lineTo(r,z)}}return e},resync:function(j){var g,w,D,o,r;j.syncXY(a);d=I.floor(b?I.simplify(a):a);for(var z=d.length;z--;){j=d[z].x;g=d[z].y;o=typeof o=="undefined"||j<o?j:o;r=typeof r=="undefined"||g<r?g:r;w=typeof w=="undefined"||j>w?j:w;D=typeof D=="undefined"||g>D?g:D}this.updateBounds(F.init(o,
r,w,D),true)}});e=a&&a.length>=2};Ca.prototype=new ja;Ca.prototype.constructor=Ca;var qb=function(a,i){i.fill=false;Ca.call(this,a,i)};qb.prototype=new Ca;var Ma=function(a){function i(D){if(this.imageUrl=D)g=G.get(this.imageUrl,function(o){var r=w.layer?w.layer.getParent():null;g=o;r&&r.invalidate()})}a=COG.extend({image:null,imageUrl:null,imageOffset:null},a);var e=null,b=ja.prototype.updateBounds,d,j,g=a.image;ja.call(this,a);var w=COG.extend(this,{changeImage:i,drag:function(D,o,r,z){e||(e=I.init(D.startX-
this.xy.x,D.startY-this.xy.y));this.xy.x=o-e.x;this.xy.y=r-e.y;if(z){e=null;if(this.layer)(D=this.layer.getParent())&&D.syncXY([this.xy],true);this.trigger("dragDrop")}return true},draw:function(D){D.drawImage(g,d,j)},prepPath:function(D,o,r){var z=g&&g.width>0;if(z){s(this,g);d=this.xy.x+this.imageOffset.x-o;j=this.xy.y+this.imageOffset.y-r;COG.info("draw x = "+d+", image offset x = "+this.imageOffset.x+", view offset x = "+o);D.beginPath();D.rect(d,j,g.width,g.height)}return z},updateBounds:function(D,
o){b.call(this,D,o);s(this,g)}});g||i(this.imageUrl)};Ma.prototype=new ja;Ma.prototype.constructor=Ma;var Sa=function(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.imageOffset=I.invert(a.imageAnchor);Ma.call(this,a)};Sa.prototype=new Ma;Sa.prototype.constructor=Sa;var rb=function(a){function i(g){for(var w=b.length;w--;)b[w].resync(g);b.sort(function(D,o){var r=o.xy.y-D.xy.y;return r!=0?r:o.xy.x-D.xy.y});j.changed()}function e(g,w){i(w)}a=COG.extend({zindex:10},a);var b=[],d=CANI.canvas.pipTransformed,
j=COG.extend(new sa(a),{add:function(g){if(g){g.layer=j;var w=j.getParent();if(w){g.resync(j.getParent());w.invalidate()}b[b.length]=g}},clear:function(){b=[]},draw:function(g,w,D,o,r,z){o=w.x1;r=w.y1;var K=z?d?z.x-o:z.relXY.x:0,ca=z?d?z.y-r:z.relXY.y:0,ea=w.width;w=w.height;for(var N=b.length;N--;){var k=b[N],E=k.style,P;if(k.transform){k.transform(g,o,r);if(d){K-=k.xy.x;ca-=k.xy.y}}if(k.prepPath(g,k.transform?k.xy.x:o,k.transform?k.xy.y:r,ea,w,D)){if(z&&g.isPointInPath(K,ca)){z.elements.push(Hits.initHit(k.type,
k,{drag:k.draggable?k.drag:null}));P=z.type+"Style";E=k[P]||j[P]||E}E=E?L.apply(g,E):null;k.draw(g,o,r,ea,w,D);E&&L.apply(g,E)}k.transform&&g.restore()}},hitGuess:function(g,w){for(var D=false,o=b.length;!D&&o--;){var r=b[o].bounds;D=D||r&&g>=r.x1&&g<=r.x2&&w>=r.y1&&w<=r.y2}return D}});j.bind("parentChange",e);j.bind("resync",e);return j},yb=function(){return{tileSize:256,init:function(a,i,e,b,d){return COG.extend({x:a,y:i,width:e,height:b},d)}}}();COG.extend(H,{ex:COG.extend,ticks:V,getConfig:R,
userMessage:function(a,i,e){H.trigger("userMessage",a,i,e)},XY:I,XYRect:F,Dimensions:O,Vector:ba,Hits:Hits,Images:G,Generator:S,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:L,viewState:n,View:function(a){function i(l,m,t){Ea||Ta(fa-m,ga-t)}function e(l,m,t,Q){bb(M(aa(ka+$(2,Q)-1,0.5),2))}function b(){var l=ma(ka)/Math.LN2|0;if(l!==0){ka=$(2,l);sb(Pa+l,Ua,Va)}J()}function d(l){l||(l=I.init(Ka,La));cb=I.init(fa,ga);Qa=I.offset(l,fa,ga);Ua=Qa.x;Va=Qa.y}function j(l,
m){var t=1/ka;return I.init(Na.x1+l*t,Na.y1+m*t)}function g(l,m,t){Oa("doubleTap",m,t,j(t.x,t.y));a.scalable&&bb(2,t,a.zoomEasing,null,a.zoomDuration)}function w(l,m,t){Ea=null;P("down",m,t)}function D(l,m,t){P("hover",m,t)}function o(l,m,t){k(m,t,false)}function r(l,m,t){k(m,t,true)}function z(){clearTimeout(tb);tb=setTimeout(ca,250)}function K(l,m,t){P("tap",m,t);Oa("tap",m,t,j(t.x,t.y,true))}function ca(l,m){var t;Wa=typeof FlashCanvas!=="undefined";COG.info("is flash = "+Wa);if(na){if(a.autoSize&&
na.parentNode){l=na.parentNode.offsetWidth;m=na.parentNode.offsetHeight}try{if(!na.id)na.id=a.id+"_canvas";qa=na.getContext("2d")}catch(Q){COG.exception(Q);throw Error("Could not initialise canvas on specified view element");}if(l&&m&&(ta!==m||ua!==l)){db=true;ua=l;ta=m;Ka=ua>>1;La=ta>>1;ha.trigger("resize",ua,ta);for(t=xa;t--;)da[t].trigger("resize",ua,ta)}for(t=xa;t--;)da[t].trigger("contextChanged",qa);J();N()}}function ea(l,m){m.setId(l);m.added=V();m.bind("remove",function(){ha.removeLayer(l)});
m.trigger("contextChanged",qa);m.setParent(ha);da.push(m);da.sort(function(t,Q){var X=Q.zindex-t.zindex;if(X===0)X=Q.added-t.added;return X});xa=da.length;return m}function N(){ya&&ya.unbind();ya=INTERACT.watch(na);a.pannable&&ya.pannable().bind("pan",i);if(a.scalable){ya.bind("zoom",e);ya.bind("doubleTap",g)}ya.bind("pointerDown",w);ya.bind("pointerMove",o);ya.bind("pointerUp",r);a.captureHover&&ya.bind("pointerHover",D);ya.bind("tap",K)}function k(l,m,t){if(Ea){l=j(m.x,m.y);Ea.drag.call(Ea.target,
Ea,l.x,l.y,t)&&J();if(t)Ea=null}}function E(l){var m,t=false;if(eb|Wa){Ha=ub|(ka!==1?vb:0)|(fa!==fb||ga!==gb?hb:0)|(ib?jb:0);kb=(m=(Ha&(vb|hb))!==0)&&(Ha&jb)===0;if(db&&na){Wa&&FlashCanvas.initElement(na);na.width=ua;na.height=ta;na.style.width=ua+"px";na.style.height=ta+"px";db=false}Xa=Da();for(var Q=xa;Q--;){Ha|=da[Q].animated?jb:0;da[Q].cycle(l,Xa,Ha);t=da[Q].clip||t}Q=Ha;var X=Xa;m=zb&&t&&!m;var la;F.center(X);t=0;var za;if(ka!==1){za=1/ka;Ua=Qa.x+(fa-cb.x);Va=Qa.y+(ga-cb.y);za=X?F.fromCenter(Ua>>
0,Va>>0,X.width*za>>0,X.height*za>>0):void 0}else za=F.copy(X);Na=za;m||qa.clearRect(0,0,ua,ta);Na.scaleFactor=ka;qa.save();try{ka!==1&&qa.scale(ka,ka);Ya=Za=null;if(m){qa.beginPath();for(t=xa;t--;)da[t].clip&&da[t].clip(qa,Na,Q,ha,l);qa.closePath();qa.clip()}qa.globalCompositeOperation="source-over";for(t=xa;t--;){la=da[t];if(la.shouldDraw(Ha,Xa)){var oa=la.style,Fa=oa?L.apply(qa,oa):null;la.draw(qa,Na,Q,ha,l,Ba);Fa&&L.apply(qa,Fa)}}}finally{qa.restore()}eb=0;Oa("drawComplete",X,l);if(Ba){la=Ba?
Ba.elements:[];if(Ra&&Ra.type==="hover"){oa=Hits.diffHits(Ra.elements,la);oa.length>0&&Hits.triggerEvent(Ra,ha,"Out",oa)}if(la.length>0){Fa=Ba.x;Q=Ba.y;for(oa=la.length;oa--;){X=la[oa];m=Fa;t=Q;if(za=X&&X.drag&&(!X.canDrag||X.canDrag(X,m,t))){Ea=X;Ea.startX=m;Ea.startY=t}if(za)break}Hits.triggerEvent(Ba,ha)}Ra=la.length>0?COG.extend({},Ba):null;Ba=null}l-wb>Ab&&lb();Bb=l;fb=fa;gb=ga;animFrame(E)}else mb=false}function P(l,m,t){Ba=Hits.init(l,m,t,j(t.x,t.y,true));for(l=xa;l--;)nb=nb||(da[l].hitGuess?
da[l].hitGuess(Ba.x,Ba.y,Ha,ha):false);nb&&J()}function J(){eb+=1;if(!mb){mb=true;animFrame(E)}}function Da(){return F.init(fa,ga,fa+ua,ga+ta)}function lb(){if(Ia||Ja){var l=$a?fa+Ka:fa,m=ab?ga+La:ga;if(Ia&&Ia>ua)if(l+ua>Ia)fa=$a?l-Ia>0?fa-Ia:fa:Ia-ua;else if(l<0)fa=$a?fa+Ia:0;if(Ja&&Ja>ta)if(m+ta>Ja)ga=ab?m-Ja>0?ga-Ja:ga:Ja-ta;else if(m<0)ga=ab?ga+Ja:0}wb=(new Date).getTime();Oa("refresh",ha,Da());J()}function bb(l,m,t,Q,X){if(t)COG.tweenValue(ka,l,t,X,function(la,za){ka=la;if(za){var oa=pa(ma(ka)/
Math.LN2);ka=$(2,oa);Q&&Q()}d(m);b()});else{ka=l;d(m);b()}return ha}function sb(l,m,t){l=aa(a.minZoom,M(a.maxZoom,l));if(l!==Pa){var Q=$(2,l-Pa),X=Ka/Q|0,la=La/Q|0;Pa=l;Ta(((m?m:fa+Ka)-X)*Q,((t?t:ga+La)-la)*Q);fb=fa;gb=ga;Oa("zoomLevelChange",l);ka=1;lb()}}function Oa(){for(var l=ha.trigger.apply(null,arguments).cancel,m=da.length;m--;)l=da[m].trigger.apply(null,arguments).cancel||l;return!l}function Ta(l,m,t,Q,X){function la(){za+=1;if(za>=2){ib=false;X&&X()}}var za=0,oa=Za?I.offset(Za,-Ka,-La):
null,Fa=Ya?I.offset(Ya,-Ka,-La):null;if(oa){l=l<oa.x?oa.x:l;m=m<oa.y?oa.y:m}if(Fa){l=l>Fa.x?Fa.x:l;m=m>Fa.y?Fa.y:m}if(t){if((Ha&hb)===0){COG.tweenValue(fa,l,t,Q,function(ob,pb){fa=ob|0;(pb?la:J)();return!kb});COG.tweenValue(ga,m,t,Q,function(ob,pb){ga=ob|0;(pb?la:J)();return!kb});ib=true}}else{fa=l|0;ga=m|0;J();X&&X()}}a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),
panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},a);var da=[],xa=0,na=document.getElementById(a.container),Ea=null,qa=null,Cb=typeof window.attachEvent!="undefined",Wa,nb=false,Ab=a.minRefresh,fa=0,ga=0,fb=0,gb=0,Ia=null,Ja=null,$a=false,ab=false,zb=a.clipping,Xa=null,mb=false,Na,xb=1,Ka=0,La=0,Ba=null,cb=null,Qa=null,kb=false,Za=null,Ya=null,wb=0,Ra=null,
tb=0,ka=1,Bb=0,db=false,ya=null,ib=false,ta,ua,eb=0,Ua,Va,Pa=a.zoomLevel,ub=n("ACTIVE"),hb=n("PAN"),vb=n("ZOOM"),jb=n("ANIMATING"),Ha=ub,ha={id:a.id,deviceScaling:xb,fastDraw:a.fastDraw||R().requireFastDraw,detach:function(){ya&&ya.unbind()},eachLayer:function(l){for(var m=xa;m--;)l(da[m])},getDimensions:function(){return O.init(ua,ta)},getLayer:function(l){for(var m=0;m<xa;m++)if(da[m].getId()==l)return da[m];return null},getZoomLevel:function(){return Pa},setLayer:function(l,m){for(var t=0;t<xa;t++)if(da[t].getId()===
l){da.splice(t,1);break}if(m){ea(l,m);m.trigger("refresh",ha,Da())}J();return m},invalidate:J,refresh:lb,resetScale:function(){ka=1},resize:function(l,m){if(na){a.autoSize=false;if(ua!==l||ta!==m)ca(l,m)}},scale:bb,setZoomLevel:sb,syncXY:function(){},triggerAll:Oa,removeLayer:function(l){a:{for(var m=xa;m--;)if(da[m].getId()==l){l=m;break a}l=-1}if(l>=0&&l<xa){ha.trigger("layerRemoved",da[l]);da.splice(l,1);J()}xa=da.length},getOffset:function(){return I.init(fa,ga)},setMaxOffset:function(l,m,t,Q){Ia=
l;Ja=m;$a=typeof t!="undefined"?t:false;ab=typeof Q!="undefined"?Q:false},getViewRect:Da,updateOffset:Ta,pan:function(l,m,t,Q,X){Ta(fa+l,ga+m,t,Q,X)}};xb=R().getScaling();COG.observable(ha);ha.bind("invalidate",function(){J()});ha.bind("resync",function(){Ya=Za=null});COG.configurable(ha,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(a,null,{container:function(l,m){na=document.getElementById(m);ca()},inertia:N,captureHover:N,
scalable:N,pannable:N}),true);CANI.init(function(l){ha.markers=ea("markers",new rb({zindex:20}));canvasCaps=l.canvas;ca();if(a.autoSize)Cb?window.attachEvent("onresize",z):window.addEventListener("resize",z,false)});return ha},ViewLayer:sa,ImageLayer:function(a,i){function e(o,r,z){for(r=g.length;r--;){var K=g[r],ca=K.x,ea=K.y,N=F.init(K.x,K.y,K.x+K.width,K.y+K.height);if(z&&F.intersect(o,N))(N=G.get(K.url,function(){D.changed()},w))&&z(N,ca,ea,K.width,K.height)}}function b(o){var r=++j,z=D.getParent();
d&&d.run(z,o,function(K){if(r==j){g=[].concat(K);z.invalidate()}})}i=COG.extend({imageLoadArgs:{}},i);var d=a?S.init(a,i):null,j=0,g=[],w=i.imageLoadArgs,D=COG.extend(new sa(i),{changeGenerator:function(o,r){d=S.init(o,COG.extend({},i,r));g=null;b(D.getParent().getViewRect())},clip:function(o,r,z){var K=r.x1,ca=r.y1;e(r,z,function(ea,N,k,E,P){o.rect(N-K,k-ca,E,P)})},draw:function(o,r,z){var K=r.x1,ca=r.y1;e(r,z,function(ea,N,k){o.drawImage(ea,N-K,k-ca,ea.width,ea.height)})},mask:function(o,r,z){e(r,
z,function(K,ca,ea,N,k){COG.info("clearing rect @ x = "+ca+", y = "+ea+", width = "+N+", height = "+k);o.clearRect(ca,ea,N,k)})}});D.bind("refresh",function(o,r,z){b(z)});D.bind("tap",function(o,r,z,K){o=[];var ca=K.x,ea=K.y,N,k;if(g)for(var E=g.length;E--;){N=g[E];if(k=ca>=N.x&&ca<=N.x+N.width&&ea>=N.y&&ea<=N.y+N.height)o[o.length]=N}o.length>0&&D.trigger("tapImage",o,r,z,K)});return D},ImageGenerator:function(a){a=COG.extend({relative:false,padding:2},a);a={run:function(){COG.warn("running base generator - this should be overriden")}};
COG.observable(a);return a},Drawable:ja,Poly:Ca,Line:qb,ImageDrawable:Ma,ImageMarker:Sa,ShapeLayer:rb,transformable:C,Tiling:yb});COG.observable(H)})(T5);
