COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var Q=arguments[0]||{},W,C=1,A=arguments.length;C<A;C++)if((W=arguments[C])!==null)for(var h in W){var k=W[h];if(Q!==k)if(k!==undefined)Q[h]=k}return Q};
(function(){var Q=Object.prototype.hasOwnProperty,W=0,C={};C.toID=function(A){return A.replace(/\s/g,"-")};C.objId=function(A){return(A?A:"obj")+W++};C.isFunction=function(A){return toString.call(A)==="[object Function]"};C.isArray=function(A){return toString.call(A)==="[object Array]"};C.isPlainObject=function(A){if(!A||toString.call(A)!=="[object Object]"||A.nodeType||A.setInterval)return false;if(A.constructor&&!Q.call(A,"constructor")&&!Q.call(A.constructor.prototype,"isPrototypeOf"))return false;
var h;for(h in A);return h===undefined||Q.call(A,h)};C.isEmptyObject=function(A){for(var h in A)return false;return true};C.isXmlDocument=function(A){return toString.call(A)==="[object Document]"};C.contains=function(A,h){var k=A,q=arguments,D=1;if(h&&module.isArray(h)){q=h;D=0}for(D=D;D<q;D++)k=k&&typeof foo[q[D]]!=="undefined";return k};C.formatStr=function(A){if(arguments.length<=1)return A;for(var h=arguments.length-2,k=0;k<=h;k++)A=A.replace(RegExp("\\{"+k+"\\}","gi"),arguments[k+1]);return A};
C.wordExists=function(A,h){var k="";if(h.toString)h=h.toString();for(var q=0;q<h.length;q++)k+=!/\w/.test(h[q])?"\\"+h[q]:h[q];return RegExp("(^|\\s|\\,)"+k+"(\\,|\\s|$)","i").test(A)};COG.extend(COG,C)})();
(function(){function Q(k){return typeof console!=="undefined"?function(){console[k](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var W=window.console&&window.console.markTimeline,C=Q("error"),A=Q("info"),h=function(){return W?function(k,q){console.markTimeline(k+(q?": "+((new Date).getTime()-q)+"ms":""))}:function(){}}();COG.extend(COG,{trace:h,debug:Q("debug"),info:A,warn:Q("warn"),error:C,exception:function(k){if(C)for(var q in k)A("ERROR DETAIL: "+q+
": "+k[q])}})})();
COG.Loopage=function(){function Q(L){return COG.extend({id:k++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},L)}function W(L){D.push(L);C()}function C(){X&&clearTimeout(X);X=setTimeout(A,0);fa=true}function A(){for(var L,t=(new Date).getTime(),z=q.length;D.length>0;){var B=D.shift();for(L=z;L--;)if(q[L].id===B){q.splice(L,1);break}fa=true;z=q.length}if(fa){R=h;for(L=z;L--;)R=q[L].frequency<R?q[L].frequency:R}for(L=z;L--;){B=t-q[L].lastTick;if(q[L].lastTick===0||B>=q[L].frequency){q[L].execute(t,
q[L]);q[L].lastTick=t;q[L].single&&q[L].trigger("complete")}}X=z?setTimeout(A,R):0}var h=6E4,k=0,q=[],D=[],X=0,R=h,fa=true;return{join:function(L){var t=new Q(L);if(t.after>0)t.lastTick=(new Date).getTime()+t.after;COG.observable(t);t.bind("complete",function(){W(t.id)});q.unshift(t);C();return t},leave:W}}();
(function(){function Q(C,A){var h=C.obsHandlers;h[A]||(h[A]=[]);return h[A]}var W=0;COG.observable=function(C){if(!C)return null;if(!C.obsHandlers)C.obsHandlers={};if(!(C.bind||C.trigger||C.unbind)){C.bind=function(A,h){var k="callback"+W++;Q(C,A).unshift({fn:h,id:k});return k};C.trigger=function(A){var h=Q(C,A),k={cancel:false,name:A,tickCount:(new Date).getTime()},q;if(!h)return null;q=Array.prototype.slice.call(arguments,1);C.eventInterceptor&&C.eventInterceptor(A,k,q);q.unshift(k);for(var D=h.length;D--&&
!k.cancel;)h[D].fn.apply(self,q);return k};C.unbind=function(A,h){if(typeof A==="undefined")C.obsHandlers={};else for(var k=Q(C,A),q=0;k&&q<k.length;q++)if(k[q].id===h){k.splice(q,1);break}return C}}return C}})();
(function(){function Q(h,k){h[k]||(h[k]=function(q){return h.configure(k,q)})}function W(h){h.gtConfId="configurable"+A++;h.gtConfig={};h.gtConfigFns=[];return h.gtConfig}var C={},A=0;COG.paramTweaker=function(h,k,q){return function(D,X){if(typeof X!=="undefined"){if(D in h)h[D]=X;q&&D in q&&q[D](D,X)}else return k&&D in k?k[D](D):h[D]}};COG.configurable=function(h,k,q,D){if(h){h.gtConfId||W(h);var X=h.gtConfId,R=h.gtConfig,fa=h.gtConfigFns;C[X]=h;fa.push(q);for(q=k.length;q--;){R[k[q]]=true;D&&Q(h,
k[q])}if(!h.configure)h.configure=function(L,t){if(R[L]){for(var z=fa.length;z--;){var B=fa[z](L,t);if(typeof B!=="undefined")return B}return C[X]}return null}}}})();
(function(){function Q(h){var k=document.createElement("script"),q=false;k.src=h;k.async=true;k.onload=k.onreadystatechange=function(){if(!q&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){q=true;k.onload=k.onreadystatechange=null;k&&k.parentNode&&k.parentNode.removeChild(k)}};C||(C=document.getElementsByTagName("head")[0]);C.appendChild(k)}var W=0,C,A=this;COG.jsonp=function(h,k,q){h+=h.indexOf("?")>=0?"&":"?";var D="json"+ ++W;A[D]=function(X){k(X);A[D]=null;try{delete A[D]}catch(R){}};
Q(h+(q?q:"callback")+"="+D);return D}})();
(function(){function Q(c){if(L)return R.length;L=true;try{for(var n=0;n<R.length;)if(R[n].isComplete()){R[n].triggerComplete(false);R.splice(n,1)}else{R[n].update(c);n++}}finally{L=false}R.length===0&&fa.trigger("complete");return R.length}function W(){if(!fa){fa=COG.Loopage.join({execute:Q,frequency:20});fa.bind("complete",function(){fa=null})}}var C=1.70158,A=Math.PI/2,h=Math.abs,k=Math.pow,q=Math.sin,D=Math.asin,X=Math.cos,R=[],fa=null,L=false,t={linear:function(c,n,o,y){return o*c/y+n},backin:function(c,
n,o,y){return o*(c/=y)*c*((C+1)*c-C)+n},backout:function(c,n,o,y){return o*((c=c/y-1)*c*((C+1)*c+C)+1)+n},backinout:function(c,n,o,y){return(c/=y/2)<1?o/2*c*c*(((C*=1.525)+1)*c-C)+n:o/2*((c-=2)*c*(((C*=1.525)+1)*c+C)+2)+n},bouncein:function(c,n,o,y){return o-t.bounceout(y-c,0,o,y)+n},bounceout:function(c,n,o,y){return(c/=y)<1/2.75?o*7.5625*c*c+n:c<2/2.75?o*(7.5625*(c-=1.5/2.75)*c+0.75)+n:c<2.5/2.75?o*(7.5625*(c-=2.25/2.75)*c+0.9375)+n:o*(7.5625*(c-=2.625/2.75)*c+0.984375)+n},bounceinout:function(c,
n,o,y){return c<y/2?t.bouncein(c*2,0,o,y)/2+n:t.bounceout(c*2-y,0,o,y)/2+o/2+n},cubicin:function(c,n,o,y){return o*(c/=y)*c*c+n},cubicout:function(c,n,o,y){return o*((c=c/y-1)*c*c+1)+n},cubicinout:function(c,n,o,y){if((c/=y/2)<1)return o/2*c*c*c+n;return o/2*((c-=2)*c*c+2)+n},elasticin:function(c,n,o,y,M,J){if(c==0)return n;if((c/=y)==1)return n+o;J||(J=y*0.3);if(!M||M<h(o)){M=o;o=J/4}else o=J/TWO_PI*D(o/M);return-(M*k(2,10*(c-=1))*q((c*y-o)*TWO_PI/J))+n},elasticout:function(c,n,o,y,M,J){var aa;if(c==
0)return n;if((c/=y)==1)return n+o;J||(J=y*0.3);if(!M||M<h(o)){M=o;aa=J/4}else aa=J/TWO_PI*D(o/M);return M*k(2,-10*c)*q((c*y-aa)*TWO_PI/J)+o+n},elasticinout:function(c,n,o,y,M,J){var aa;if(c==0)return n;if((c/=y/2)==2)return n+o;J||(J=y*0.3*1.5);if(!M||M<h(o)){M=o;aa=J/4}else aa=J/TWO_PI*D(o/M);if(c<1)return-0.5*M*k(2,10*(c-=1))*q((c*y-aa)*TWO_PI/J)+n;return M*k(2,-10*(c-=1))*q((c*y-aa)*TWO_PI/J)*0.5+o+n},quadin:function(c,n,o,y){return o*(c/=y)*c+n},quadout:function(c,n,o,y){return-o*(c/=y)*(c-2)+
n},quadinout:function(c,n,o,y){if((c/=y/2)<1)return o/2*c*c+n;return-o/2*(--c*(c-2)-1)+n},sinein:function(c,n,o,y){return-o*X(c/y*A)+o+n},sineout:function(c,n,o,y){return o*q(c/y*A)+n},sineinout:function(c,n,o,y){return-o/2*(X(Math.PI*c/y)-1)+n}},z=COG.Tween=function(c){c=COG.extend({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:B("sine.out"),complete:null},c);var n=(new Date).getTime(),o=[],y=false,M=0,J=0,aa={isComplete:function(){return y},triggerComplete:function(ca){c.complete&&
c.complete(ca)},update:function(ca){var I=c.tweenFn(ca-n,M,J,c.duration);if(c.target)c.target[c.property]=I;for(var oa=o.length;oa--;)o[oa](I,void 0);if(y=n+c.duration<=ca){if(c.target)c.target[c.property]=c.tweenFn(c.duration,M,J,c.duration);for(ca=o.length;ca--;)o[ca](I,true)}},requestUpdates:function(ca){o.push(ca)}};M=c.target&&c.property&&c.target[c.property]?c.target[c.property]:c.startValue;if(typeof c.endValue!=="undefined")J=c.endValue-M;if(J==0)y=true;W();return aa};COG.tweenValue=function(c,
n,o,y,M){c=new z({startValue:c,endValue:n,tweenFn:o,complete:y,duration:M});R.push(c);return c};COG.tween=function(c,n,o,y,M,J){c=new z({target:c,property:n,endValue:o,tweenFn:y,duration:J,complete:M});R.push(c);return c};COG.endTweens=function(c){if(!L){L=true;try{for(var n=0;n<R.length;)if(!c||c(R[n])){R[n].triggerComplete(true);R.splice(n,1)}else n++}finally{L=false}}};COG.getTweens=function(){return[].concat(R)};var B=COG.easing=function(c){return t[c.replace(/[\-\_\s\.]/g,"").toLowerCase()]};
COG.registerEasingType=function(c,n){t[c.replace(/[\-\_\s\.]/g,"").toLowerCase()]=n}})();
(function(){var Q=/^P(\d+Y)?(\d+M)?(\d+D)?$/,W=/^(\d+H)?(\d+M)?(\d+S)?$/,C={8601:function(h){h=h.split("T");var k=null;k=null;var q=0,D=0;Q.lastIndex=-1;k=Q.exec(h[0]);q+=k[3]?parseInt(k[3].slice(0,-1),10):0;W.lastIndex=-1;k=W.exec(h[1]);D+=k[1]?parseInt(k[1].slice(0,-1),10)*3600:0;D+=k[2]?parseInt(k[2].slice(0,-1),10)*60:0;D+=k[3]?parseInt(k[3].slice(0,-1),10):0;return new A(q,D)}},A=COG.Duration=function(h,k){return{days:h?h:0,seconds:k?k:0}};COG.addDuration=function(){for(var h=new A,k=arguments.length;k--;){h.days+=
arguments[k].days;h.seconds+=arguments[k].seconds}if(h.seconds>=86400){h.days+=~~(h.seconds/86400);h.seconds%=86400}return h};COG.formatDuration=function(h){var k,q,D="";if(h.days)D=h.days+" days ";if(h.seconds){h=h.seconds;if(h>=3600){k=~~(h/3600);h-=k*3600}if(h>=60){q=Math.round(h/60);h-=q*60}if(k)D=D+k+(k>1?" hrs ":" hr ")+(q?(q>10?q:"0"+q)+" min ":"");else if(q)D=D+q+" min";else if(h>0)D=D+(h>10?h:"0"+h)+" sec"}return D};COG.parseDuration=function(h,k){var q=k?C[k]:null;if(q)return q(h);COG.Log.warn("Could not find duration parser for specified format: "+
k);return new A}})();
INTERACT=function(){function Q(t){return function(z,B,c){(c?c:t?document.body:document).addEventListener(z,B,false)}}function W(t){return function(z,B,c){(c?c:t?document.body:document).removeEventListener(z,B,false)}}function C(t,z,B){(B?B:document).attachEvent("on"+t,z)}function A(t,z,B){(B?B:document).detachEvent("on"+t,z)}function h(t,z){return{x:t?t:0,y:z?z:0,count:1}}function k(t,z){fa.push(COG.extend({handler:null,checks:{},type:t},z))}function q(t){var z=0,B=0;if(t.offsetParent){do{z+=t.offsetLeft;
B+=t.offsetTop;t=t.offsetParent}while(t)}return{x:z,y:B}}function D(t,z){for(var B=t.target?t.target:t.srcElement;B&&B.nodeName&&B.nodeName.toUpperCase()!="CANVAS";)B=B.parentNode;return B&&B===z}function X(t,z){return{x:t.x-(z?z.x:0),y:t.y-(z?z.y:0)}}function R(t){if(t.preventDefault){t.preventDefault();t.stopPropagation()}else t.cancelBubble&&t.cancelBubble()}var fa=[],L=function(t,z,B){function c(J,aa,ca,I){n.trigger("pan",I.x,I.y)}B=COG.extend({binder:null,unbinder:null,observable:null},B);for(var n=
B.observable,o=[],y={bind:function(){return n.bind.apply(null,arguments)},pannable:function(J){COG.extend({inertia:true},J);n.bind("pointerMove",c);return y},unbind:function(){n.unbind();for(var J=0;J<o.length;J++)o[J].unbind();return y}},M=0;M<z.length;M++)o.push(z[M](t,n,B));return y};k("pointer",{handler:function(t,z,B){function c(u){if(D(u,t))if(I=M(u)){t.style.cursor="move";R(u);ia=u.pageX?u.pageX:u.screenX;ba=u.pageY?u.pageY:u.screenY;oa=h(ia,ba);ga=q(t);z.trigger("pointerDown",oa,X(oa,ga))}}
function n(u){qa=u.pageX?u.pageX:u.screenX;U=u.pageY?u.pageY:u.screenY;I&&D(u,t)&&J("pointerMove")}function o(u){if(I&&M(u)){I=false;if(D(u,t)){t.style.cursor="default";J("pointerUp")}}}function y(u){if(D(u,t)){var ja;u=u||window.event;if(u.detail)ja=u.axis===2?-u.detail*aa:0;else{ja=u.wheelDeltaY?u.wheelDeltaY:u.wheelDelta;if(window.opera)ja=-ja}if(ja!==0){var wa=h(qa,U);z.trigger("zoom",wa,X(wa,q(t)),ja/ca,"wheel");R(u);u.returnValue=false}}}function M(u){u=u||window.event;return(u.which||u.button)==
1}function J(u){var ja=h(qa,U);z.trigger(u,ja,X(ja,ga),h(qa-ia,U-ba));ia=qa;ba=U}B=COG.extend({inertia:false},B);var aa=120,ca=aa*8,I=false,oa,ga,qa,U,ia,ba;B.binder("mousedown",c,false);B.binder("mousemove",n,false);B.binder("mouseup",o,false);B.binder("click",function(u){if(D(u,t)){u=h(u.pageX?u.pageX:u.screenX,u.pageY?u.pageY:u.screenY);z.trigger("tap",u,X(u,q(t)))}},false);B.binder("dblclick",function(u){COG.info("captured double click");if(D(u,t)){u=h(u.pageX?u.pageX:u.screenX,u.pageY?u.pageY:
u.screenY);COG.info("captured double click + target matched");z.trigger("doubleTap",u,X(u,q(t)))}},false);B.binder("mousewheel",y,document);B.binder("DOMMouseScroll",y,document);return{unbind:function(){B.unbinder("mousedown",c,false);B.unbinder("mousemove",n,false);B.unbinder("mouseup",o,false);B.unbinder("mousewheel",y,document);B.unbinder("DOMMouseScroll",y,document)}}},checks:{touch:false}});k("pointer",{handler:function(t,z,B){function c(H){if(H.count<2)return 0;var S=H.x-H.next.x;H=H.y-H.next.y;
return~~Math.sqrt(S*S+H*H)}function n(H,S,P){S=S?S:0;P=P?P:0;for(var ra={x:H.x-S,y:H.y-P,id:H.id,count:H.count},pa=ra;H.next;){H=H.next;pa=pa.next={x:H.x-S,y:H.y-P,id:H.id}}return ra}function o(H,S){var P=H[S?S:"touches"],ra,pa;if(P.length===0)return null;pa=ra={x:P[0].pageX,y:P[0].pageY,id:P[0].identifier,count:P.length};for(var xa=1,Qa=P.length;xa<Qa;xa++)pa=pa.next={x:P[xa].pageX,y:P[xa].pageY,id:P[xa].identifier};return ra}function y(H){if(D(H,t)){U=q(t);var S=o(H,"changedTouches"),P=n(S,U.x,
U.y);if(!ba){ia=oa;z.trigger("pointerDown",S,P)}Da&&z.trigger("pointerDownMulti",S,P);ba=o(H);if(ba.count>1)ja=c(ba);Ha=1;wa=n(ba)}}function M(H){if(D(H,t)){H.preventDefault();u=o(H);if(ia==oa)ia=Math.abs(ba.x-u.x)>ca||Math.abs(ba.y-u.y)>ca?I:oa;if(ia!=oa){ia=u.count>1?qa:ga;if(ia==qa)if(ba.count===1){ba=n(u);ja=c(ba)}else{H=c(u);if(Math.abs(ja-H)<aa)ia=ga;else{var S;S=u.x;var P=u.next.x,ra=u.y,pa=u.next.y,xa=ra<pa?ra:pa;S={x:(S<P?S:P)+(Math.abs(S-P)>>1),y:xa+(Math.abs(ra-pa)>>1)};H=H/ja;P=H-Ha;z.trigger("zoom",
S,X(S,U),P,"pinch");Ha=H}}ia==ga&&z.trigger("pointerMove",u,n(u,U.x,U.y),h(u.x-wa.x,u.y-wa.y));Da&&z.trigger("pointerMoveMulti",u,n(u,U.x,U.y))}wa=n(u)}}function J(H){if(D(H,t)){var S=o(H,"changedTouches"),P=n(S,U.x,U.y);u=o(H);if(!u){ia===oa&&z.trigger("pointerTap",S,P);z.trigger("pointerUp",S,P);ba=null}Da&&z.trigger("pointerUpMulti",S,P)}}B=COG.extend({detailed:false,inertia:false},B);var aa=20,ca=7,I=0,oa=1,ga=2,qa=3,U,ia,ba,u,ja,wa,Da=B.detailed,Ha=1;B.binder("touchstart",y,false);B.binder("touchmove",
M,false);B.binder("touchend",J,false);COG.info("initialized touch handler");return{unbind:function(){B.unbinder("touchstart",y,false);B.unbinder("touchmove",M,false);B.unbinder("touchend",J,false)}}},checks:{touch:true}});return{register:k,watch:function(t,z,B){z=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},z);capabilities=COG.extend({touch:"ontouchstart"in window},B);if(!z.observable){COG.info("creating observable");z.observable=COG.observable({});
globalOpts=z}z.binder=z.isIE?C:Q(z.bindToBody);z.unbinder=z.isIE?A:W(z.bindToBody);B=z.types;for(var c=capabilities,n=[],o=fa.length;o--;){var y=fa[o],M=!B||B.indexOf(y.type)>=0,J=true;for(var aa in y.checks){var ca=y.checks[aa];COG.info("checking "+aa+" capability. require: "+ca+", capability = "+c[aa]);J=J&&ca===c[aa]}if(M&&J)n[n.length]=y.handler}return new L(t,n,z)}}}();
T5=function(){function Q(){return(new Date).getTime()}function W(){for(;ja.length>0;){var b=ja.shift();document.location=b}u=0}function C(b){for(var i=true,e=wa.length;e--;)i=i&&b!=wa[e];return i}function A(b,i){var e=[];for(var a in i)a&&e.push(a+"="+escape(i[a]));return"tile5://"+b+"/"+(e.length>0?"?"+e.join("&"):"")}function h(b,i){C(b)&&COG.info("would push url: "+A(b,i))}function k(b,i){if(C(b)){ja.push(A(b,i));u||(u=setTimeout(W,100))}}function q(b){return function(i,e,a){(a?a:b?document.body:
document).addEventListener(i,e,false)}}function D(b){return function(i,e,a){(a?a:b?document.body:document).removeEventListener(i,e,false)}}function X(b,i,e){(e?e:document).attachEvent("on"+b,i)}function R(b,i,e){(e?e:document).detachEvent("on"+b,i)}function fa(){U={base:{name:"Unknown",bindEvent:q(),unbindEvent:D(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:h,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:X,unbindEvent:R,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:k,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:k},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:k},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:q(true),unbindEvent:D(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:k},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:k}};ia=[U.froyo,U.android,U.ipod,U.iphone,U.ipad,U.ie]}function L(){U||fa();if(!ba){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<ia.length;b++){var i=ia[b];if(i.regex&&i.regex.test(navigator.userAgent)){ba=COG.extend({},U.base,i);COG.info("PLATFORM DETECTED AS: "+ba.name);break}}if(!ba){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
ba=U.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return ba}function t(){for(var b=0,i=arguments.length;i--;){var e=S[arguments[i].toUpperCase()];if(e)b|=e}return b}var z=Math.abs,B=Math.min,c=Math.max,n=Math.pow,o=Math.sqrt,y=Math.log,M=Math.round,J=Math.sin,aa=Math.asin,ca=Math.cos,I=function(){function b(a,d){return e(a.x-d.x,a.y-d.y)}function i(a,d){if(!d)d=a.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var f=
{edges:Array(d-1),accrued:Array(d-1),total:0},g=0;g<d-1;g++){var j=b(a[g],a[g+1]);f.edges[g]=o(j.x*j.x+j.y*j.y);f.accrued[g]=f.total+f.edges[g];f.total+=f.edges[g]}return f}function e(a,d){return{x:a?a:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var a=0,d=0,f=arguments.length;f--;){a+=arguments[f].x;d+=arguments[f].y}return e(a,d)},absSize:function(a){return c(z(a.x),z(a.y))},copy:function(a){return a?e(a.x,a.y):null},diff:b,distance:function(a,d){return i(a,
d).total},edges:i,equals:function(a,d){return a.x===d.x&&a.y===d.y},extendBy:function(a,d,f){var g=ca(d)*f;d=J(d)*f;return e(a.x-g,a.y-d)},floor:function(a){for(var d=Array(a.length),f=a.length;f--;)d[f]=e(~~a[f].x,~~a[f].y);return d},getRect:function(a){for(var d,f,g,j,p=a.length;p--;){var l=a[p];d=typeof d==="undefined"||l.x<d?l.x:d;f=typeof f==="undefined"||l.y<f?l.y:f;g=typeof g==="undefined"||l.x>g?l.x:g;j=typeof j==="undefined"||l.y>j?l.y:j}return ga.init(d,f,g,j)},init:e,invert:function(a){return e(-a.x,
-a.y)},min:function(a,d){return e(a.x<d.x?a.x:d.x,a.y<d.y?a.y:d.y)},max:function(a,d){return e(a.x>d.x?a.x:d.x,a.y>d.y?a.y:d.y)},offset:function(a,d,f){return e(a.x+d,a.y+(f?f:d))},simplify:function(a,d){if(!a)return null;d=d?d:I.VECTOR_SIMPLIFICATION;for(var f=[],g=null,j=a.length;j--;){var p=a[j];if(include=!g||j===0||z(p.x-g.x)+z(p.y-g.y)>d){f.unshift(p);g=p}}return f},theta:function(a,d,f){f=aa((a.y-d.y)/f);return a.x>d.x?f:Math.PI-f},toString:function(a){return a.x+", "+a.y}}}(),oa=function(){return{dotProduct:function(b,
i){return b.x*i.x+b.y*i.y}}}(),ga=function(){function b(e){return i(e.x1,e.y1,e.x2,e.y2)}function i(e,a,d,f){e=e?e:0;a=a?a:0;d=typeof d!=="undefined"?d:e;f=typeof f!=="undefined "?f:f;return{x1:e,y1:a,x2:d,y2:f,width:d-e,height:f-a}}return{center:function(e){return I.init(e.x1+e.width/2,e.y1+e.height/2)},copy:b,diagonalSize:function(e){return o(e.width*e.width+e.height*e.height)},fromCenter:function(e,a,d,f){d=d>>1;f=f>>1;return i(e-d,a-f,e+d,a+f)},init:i,intersect:function(e,a){var d=c(e.x1,a.x1),
f=c(e.y1,a.y1),g=B(e.x2,a.x2),j=B(e.y2,a.y2);d=i(d,f,g,j);return d.width>0&&d.height>0?d:null},toString:function(e){return"["+e.x1+", "+e.y1+", "+e.x2+", "+e.y2+"]"},union:function(e,a){if(e.width===0||e.height===0)return b(a);else if(a.width===0||a.height===0)return b(e);else{var d=B(e.x1,a.x1),f=B(e.y1,a.y1),g=c(e.x2,a.x2),j=c(e.y2,a.y2);d=i(d,f,g,j);return d.width>0&&d.height>0?d:null}}}}(),qa=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return I.init(b.width>>
1,b.height>>1)},getSize:function(b){return o(n(b.width,2)+n(b.height,2))},init:function(b,i){b=b?b:0;return{width:b,height:i?i:b}}}}(),U=null,ia=[],ba=null,u=0,ja=[],wa=["view.wake","tile.loaded"],Da=function(){function b(){if(!x){var r=L().maxImageLoads;x=COG.Loopage.join({execute:function(K,O){if(!r||l.length<r){var F=p.shift();if(F){l[l.length]=F;F.image.onload=e;F.image.src=F.url;F.requested=T5.ticks()}else O.trigger("complete")}},frequency:10});x.bind("complete",function(){x=null})}}function i(){G=
true;try{var r=m.length>>1;if(r>0){m.sort(function(O,F){return O.created-F.created});for(var K=r;K--;)delete f[m[K].url];m.splice(0,r)}}finally{G=false}T.trigger("cacheCleared")}function e(){var r=g[this.id],K;if(r&&r.image.complete&&r.image.width>0){r.loaded=true;r.hitCount=1;for(K=l.length;K--;)if(l[K].image.src==this.src){l.splice(K,1);break}if(r.background||r.postProcess||r.drawBackground||r.customDraw)if(r.image){globalImageData=r;K=d(r.realSize?r.realSize.width:r.image.width,r.realSize?r.realSize.height:
r.image.height);var O=K.getContext("2d"),F=r.offset?r.offset:T5.XY.init();r.background&&O.drawImage(r.background,0,0);r.drawBackground&&r.drawBackground(O);r.customDraw?r.customDraw(O,r):O.drawImage(r.image,F.x,F.y);r.postProcess&&r.postProcess(O,r);r.image=K}for(K=r.callbacks.length;K--;)r.callbacks[K]&&r.callbacks[K](this,false);r.callbacks=[];m[m.length]={url:this.src,created:r.requested};delete g[this.id];b()}}function a(r,K,O){var F=f[r];if(F){F.hitCount++;F.image.complete&&F.image.width>0&&
K?K(F.image,true):F.callbacks.push(K)}else{F=COG.extend({url:r,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[K]},O);F.image.id="resourceLoaderImage"+j++;f[r]=F;g[F.image.id]=F;p[p.length]=F;b()}return F}function d(r,K){var O=document.createElement("canvas");COG.info("creating new canvas");O.width=r?r:0;O.height=K?K:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(O);FlashCanvas.initElement(O)}return O}var f={},g={},j=0,p=[],l=[],m=[],w=0,x=null,
G=false,T={avgImageSize:25,loadTimeout:10,cancelLoad:function(){var r;if(x){COG.Loopage.leave(x.id);x=null}for(r=l.length;r--;)delete f[l[r].url];l=[];for(r=p.length;r--;)delete f[p[r].url];p=[]},get:function(r,K,O){var F=null,sa=null;G||(F=f[r]);if((sa=F?F.image:null)&&(sa.getContext||sa.complete&&sa.width>0))return sa;else K&&a(r,K,O);return null},load:a,newCanvas:d,reset:function(){f={}},stats:function(){return{imageLoadingCount:l.length,queuedImageCount:p.length,imageCacheFullness:w}}};COG.observable(T);
COG.Loopage.join({execute:function(r){for(var K=false,O=0,F=L();O<l.length;)if(r-l[O].requested>T.loadTimeout*1E3){l.splice(O,1);K=true}else O++;K&&b();if(F&&F.imageCacheMaxSize){w=m.length*T.avgImageSize/F.imageCacheMaxSize;w>=1&&i()}},frequency:2E4});return T}(),Ha=function(){var b={};return{init:function(i,e){var a=b[i];if(!a)throw Error("Unable to locate requested generator: "+i);return new a(e)},register:function(i,e){b[i]=e},Template:function(){}}}(),H=function(){function b(g,j){d[g]=e(j);return g}
function i(g){for(var j in g)b(j,g[j])}function e(g){function j(w){var x=g[w];typeof x!=="undefined"&&l.push(function(G){G[w]=x})}function p(){l=[];for(var w in g)j(w)}g=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var l=[],m={applyToContext:function(w){for(var x=l.length;x--;)l[x](w)},update:function(w,x){g[w]=x;p()}};p();return m}var a={},d={},f={apply:function(g,
j){var p=d[j]?d[j]:d.basic,l;if(g&&g.canvas){l=a[g.canvas.id];a[g.canvas.id]=j}p.applyToContext(g);return l},define:b,defineMany:i,get:function(g){return d[g]},init:e,load:function(g){COG.jsonp(g,function(j){i(j)})}};i({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return f}(),S={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},P=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,
validStates:t("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var i=null,e=false,a=false,d=b.supportFastDraw,f=b.id,g=t("ACTIVE"),j=b.validStates,p=0,l=0,m=COG.extend({addToView:function(w){w.setLayer(f,m)},shouldDraw:function(w,x,G){return(a||G||p!==x.x1||l!==x.y1)&&(w&j)!==0&&(e?d:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){m.trigger("remove",m)},changed:function(w){a=true;m.trigger("changed",m);i&&i.trigger("invalidate",w)},getId:function(){return f},
setId:function(w){f=w},getParent:function(){return i},setParent:function(w){e=(i=w)?i.fastDraw&&displayState!==g:false;m.trigger("parentChange",i)}},b);COG.observable(m);m.bind("drawComplete",function(w,x){a=false;p=x.x1;l=x.y1});m.bind("resync",function(w,x){if(x.syncXY){m.minXY&&x.syncXY(m.minXY);m.maxXY&&x.syncXY(m.maxXY)}});return m},ra=function(b){function i(p,l,m,w){a=p;d=l;f=m;g=w}b=COG.extend({xy:I.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},b);var e=false,a=0,d=0,f=0,
g=0,j=COG.extend(b,{isAnimating:function(){return e},draw:function(p,l,m,w,x){if(j.isNew&&b.tweenIn){var G=j.xy.y;j.xy.y=l.y1-20;e=true;COG.tween(j.xy,"y",G,b.tweenIn,function(){j.xy.y=G>>0;e=false},b.animationSpeed?b.animationSpeed:250+Math.random()*500)}j.drawMarker(p,l,j.xy.x,j.xy.y,m,w,x);j.isNew=false},drawMarker:function(p,l,m,w){p.beginPath();p.arc(m,w,4,0,Math.PI*2,false);p.fill();i(m-4,w-4,8,8)},hitTest:function(p,l){return p>=a&&p<=a+f&&l>=d&&l<=d+g},updateBounds:i});COG.observable(j);return j},
pa=function(b){function i(){d.changed(true);d.trigger("markerUpdate",a)}function e(){var f=d.getParent();if(f&&f.syncXY)for(var g=a.length;g--;)f.syncXY([a[g].xy])}b=COG.extend({zindex:100,style:"basic"},b);var a=[],d=COG.extend(new P(b),{draw:function(f,g,j,p){for(var l=a.length;l--;)a[l].draw(f,g,j,d,p)},add:function(f){if(f&&typeof f.length!=="undefined")for(var g=f.length;g--;){if(f[g])a[a.length]=f[g]}else if(f)a[a.length]=f;i()},clear:function(f){if(f)for(var g=0;g<a.length;)if(f(a[g]))a.splice(g,
1);else g+=1;else a=[];i()},each:function(f){if(f)for(var g=a.length;g--;)f(a[g])},find:function(f){for(var g=[],j=a.length;j--;)if(!f||f(a[j]))g[g.length]=a[j];return g}});d.bind("tap",function(f,g,j,p){var l=[],m=p.x;p=p.y;for(var w=a.length;w--;)if(a[w].hitTest(m,p))l[l.length]=a[w];if(l.length>0)f.cancel=d.trigger("markerTap",g,j,l).cancel});d.bind("parentChange",e);d.bind("resync",e);d.bind("changed",e);return d},xa=function(b){function i(j,p,l){j.fillStyle="#FFFFFF";j.strokeStyle="#222222";
j.beginPath();j.arc(l.x,l.y,4,0,Math.PI*2,false);j.stroke();j.fill()}b=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:t("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},b);var e=I.edges(b.path),a,d=null,f=0;COG.tweenValue(0,e.total,b.easing,function(){g.remove()},b.duration).requestUpdates(function(j,p){f=j;p&&g.remove()});var g=COG.extend(new P(b),{cycle:function(){for(var j=0;j<e.accrued.length&&e.accrued[j]<f;)j++;d=null;if(j<b.path.length-1){var p=
f-(j>0?e.accrued[j-1]:0),l=b.path[j];a=I.theta(l,b.path[j+1],e.edges[j]);d=I.extendBy(l,a,p)}return d},draw:function(j,p){if(d)(b.drawIndicator?b.drawIndicator:i)(j,p,I.init(d.x,d.y),a)}});return g},Qa=function(b){b=COG.extend({style:null,properties:{}},b);return COG.extend(b,{rect:null,draw:function(){},resync:function(){}})},ob=function(){return{tileSize:256,init:function(b,i,e,a,d){return COG.extend({x:b,y:i,width:e,height:a},d)}}}(),Za={ex:COG.extend,ticks:Q,getConfig:L,userMessage:function(b,
i,e){Za.trigger("userMessage",b,i,e)},zoomable:function(b,i){function e(g,j){if(g&&a!==g){var p=g>=d&&g<=f&&b.triggerAll("zoomLevelChange",g,j);if(p)a=g;return p}}i=COG.extend({initial:1,minZoom:1,maxZoom:16},i);var a=i.initial,d=i.minZoom,f=i.maxZoom;COG.extend(b,{getZoomLevel:function(){return a},setZoomLevel:e});b.bind("scale",function(g,j,p){var l=Math.log(j)/Math.LN2;COG.endTweens(function(m){return m.cancelOnInteract});g.cancel=!e(a+l,p);g.cancel||b.updateOffset(p.x*j,p.y*j)})},XY:I,XYRect:ga,
Dimensions:qa,Vector:oa,D:qa,Images:Da,Generator:Ha,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:H,viewState:t,View:function(b){function i(v,s,E,N){za=Ra;F();if(N&&b.inertia)m(da-s,ea-E,b.panAnimationEasing,b.panAnimationDuration);else N||m(da-s,ea-E);clearTimeout(hb);hb=setTimeout(e,100)}function e(){za=$a;Ia=false;F()}function a(v,s,E,N){ab(B(c(Y+n(2,N)-1,0.5),2))}function d(v){var s=y(Y)/Math.LN2>>0;if(Y!==1)za=ib;if(s!==0){Y=n(2,s);s=I.init(Sa-(Ea/Y>>0),Ta-
(Fa/Y>>0));if(!ka.trigger("scale",Y,s).cancel){for(v=Z.length;v--;)Z[v].trigger("scale",Y,s);Y=1;pb=null;za=$a;v=true}}F(v)}function f(v){v||(v=I.init(Ea,Fa));bb=I.init(da,ea);Oa=I.offset(v,da,ea);Sa=Oa.x;Ta=Oa.y}function g(v,s){var E,N;N=1/Y;if(Y!==1&&ua){E=ua.x1+v*N;N=ua.y1+s*N}else{E=v+da;N=s+ea}return I.init(E,N)}function j(v,s,E){Pa("doubleTap",s,E,g(E.x,E.y));if(b.scalable){COG.endTweens(function(N){return N.cancelOnInteract});ab(2,E,b.zoomAnimation,null,b.zoomDuration)}}function p(){clearTimeout(jb);
jb=setTimeout(w,250)}function l(v,s,E){Pa("tap",s,E,g(E.x,E.y))}function m(v,s,E,N,V){function ha(){va+=1;if(va>=2){e();V&&V()}}var va=0,ya=Ja?I.offset(Ja,-Ea,-Fa):null,Ga=Ka?I.offset(Ka,-Ea,-Fa):null;if(ya){v=v<ya.x?ya.x:v;s=s<ya.y?ya.y:s}if(Ga){v=v>Ga.x?Ga.x:v;s=s>Ga.y?Ga.y:s}if(E){if(!Ia){v=COG.tweenValue(da,v,E,ha,N);s=COG.tweenValue(ea,s,E,ha,N);v.cancelOnInteract=true;v.requestUpdates(function(La){da=La|0;Ia=true;F()});s.cancelOnInteract=true;s.requestUpdates(function(La){ea=La|0;Ia=true;F()})}}else{da=
v|0;ea=s|0}}function w(v,s){var E;if(la){Aa&&Aa.unbind();if(b.autoSize&&la.parentNode){v=la.parentNode.offsetWidth;s=la.parentNode.offsetHeight}try{if(!la.id)la.id=b.id+"_canvas";$=la.getContext("2d")}catch(N){COG.exception(N);throw Error("Could not initialise canvas on specified view element");}if(v&&s&&(ma!==s||na!==v)){cb=true;na=v;ma=s;Ea=na>>1;Fa=ma>>1;ka.trigger("resize",na,ma);for(E=ta;E--;)Z[E].trigger("resize",na,ma)}if(b.interactive){Aa=INTERACT.watch(la).pannable();G()}for(E=ta;E--;)Z[E].trigger("contextChanged",
$);F(true)}}function x(v,s){s.setId(v);s.added=Q();s.bind("remove",function(){ka.removeLayer(v)});s.trigger("contextChanged",$);s.setParent(ka);Z.push(s);Z.sort(function(E,N){var V=N.zindex-E.zindex;if(V===0)V=N.added-E.added;return V});ta=Z.length;return s}function G(){if(Aa){if(b.pannable){Aa.bind("pan",i);Aa.bind("inertiaCancel",function(){Ia=false;F()})}if(b.scalable){Aa.bind("zoom",a);Aa.bind("doubleTap",j)}Aa.bind("tap",l)}}function T(){var v=Ua?da+Ea:da,s=Va?ea+Fa:ea;if(Ba&&Ba>na)if(v+na>Ba)da=
Ua?v-Ba>0?da-Ba:da:Ba-na;else if(v<0)da=Ua?da+Ba:0;if(Ca&&Ca>ma)if(s+ma>Ca)ea=Va?s-Ca>0?ea-Ca:ea:Ca-ma;else if(s<0)ea=Va?ea+Ca:0}function r(){Ma();db=true;Na=0}function K(v,s,E,N){var V;ga.center(s);var ha=0;ua=ga.copy(s);ua.scaleFactor=Y;E&&$.clearRect(0,0,na,ma);$.save();try{$.globalCompositeOperation="source-over";if(Y!==1){var va=ua,ya=1/Y;Sa=Oa.x+(da-bb.x);Ta=Oa.y+(ea-bb.y);ua=va?ga.fromCenter(Sa>>0,Ta>>0,va.width*ya>>0,va.height*ya>>0):void 0;$.scale(Y,Y)}$.translate(-ua.x1,-ua.y1);Ka=Ja=null;
if(qb){$.beginPath();clipped=false;for(ha=ta;ha--;)if(Z[ha].clip){Z[ha].clip($,ua,v,ka,E,N);clipped=true}$.closePath();clipped&&$.clip()}for(ha=ta;ha--;){V=Z[ha];var Ga=V.style,La=Ga?H.apply($,Ga):null;if(V.minXY)Ja=Ja?I.min(Ja,V.minXY):I.copy(V.minXY);if(V.maxXY)Ka=Ka?I.max(Ka,V.maxXY):I.copy(V.maxXY);V.draw($,ua,v,ka,E,N);La&&H.apply($,La)}}finally{$.restore()}if(rb){$.globalCompositeOperation="source-over";$.strokeStyle="#f00";$.beginPath();$.moveTo(Ea,0);$.lineTo(Ea,ma);$.moveTo(0,Fa);$.lineTo(na,
Fa);$.stroke()}Pa("drawComplete",s,N);COG.trace("draw complete",N)}function O(v,s){var E=false,N=eb?eb:Ia?Ra:za,V=!Ia&&(N===ib||N===Ra),ha=fb||N===Ra||COG.getTweens().length>0;if(cb&&la){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(la);la.width=na;la.height=ma;la.style.width=na+"px";la.style.height=ma+"px";cb=false}if(Ba||Ca)T();Wa=sa();if(V){COG.endTweens(function(va){return va.cancelOnInteract});db=false;if(Na!==0){clearTimeout(Na);Na=0}}for(V=ta;V--;){if(Z[V].animated)za|=kb;Z[V].cycle(v,
Wa,za,ha);E=Z[V].shouldDraw(za,Wa,ha)||E}ha=ha||(za&kb)!==0;if(E=E||ha||Y!==1&&Y!==lb){K(N,Wa,ha,v);lb=Y;fb=false}if(!E&&gb===0&&!sb){if(!db&&Na===0)Na=setTimeout(r,tb);s.trigger("complete")}v-mb>ub&&Ma();gb=0;COG.trace("Completed draw cycle",v)}function F(v){fb=v?true:false;gb+=1;if(!Xa){Xa=COG.Loopage.join({execute:O,frequency:vb});Xa.bind("complete",function(){Xa=null})}}function sa(){return ga.init(da,ea,da+na,ea+ma)}function Ma(){mb=(new Date).getTime();Pa("refresh",ka);F()}function ab(v,s,E,
N,V){if(E&&!Ya){Ya=COG.tweenValue(Y,v,E,null,V);Ya.requestUpdates(function(ha,va){Y=ha;if(va){var ya=M(y(Y)/Math.LN2);Y=n(2,ya);N&&N();Ya=null}f(s);d(va)})}else{Y=v;f(s);d(true)}return ka}function Pa(){for(var v=ka.trigger.apply(null,arguments).cancel,s=Z.length;s--;)v=Z[s].trigger.apply(null,arguments).cancel||v;return!v}b=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,idleDelay:100,minRefresh:1E3,pannable:true,clipping:false,scalable:true,interactive:true,panAnimationEasing:COG.easing("sine.out"),
panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25,zoomAnimation:COG.easing("quad.out"),zoomDuration:300},b);var Z=[],ta=0,la=document.getElementById(b.container),$=null,wb=typeof window.attachEvent!="undefined",tb=b.idleDelay,ub=b.minRefresh,da=0,ea=0,Ba=null,Ca=null,Ua=false,Va=false,qb=b.clipping,Wa=null,Xa=null,ua,rb=b.guides,nb=1,gb=0,Ea=0,Fa=0,bb=null,Oa=null,db=false,Ia=false,Na=0,hb=0,Ja=null,Ka=null,mb=0,xb=
0,eb=null,fb=false,jb=0,pb=null,Y=1,Ya=null,lb=0,cb=false,Aa=null,ma,na,sb=typeof FlashCanvas!=="undefined",vb=~~(1E3/b.fps),Sa,Ta,$a=t("ACTIVE"),Ra=t("PAN"),ib=t("ZOOM"),kb=t("ANIMATING"),za=$a,ka={id:b.id,deviceScaling:nb,fastDraw:b.fastDraw||L().requireFastDraw,getDimensions:function(){return qa.init(na,ma)},getLayer:function(v){for(var s=0;s<ta;s++)if(Z[s].getId()==v)return Z[s];return null},setLayer:function(v,s){for(var E=0;E<ta;E++)if(Z[E].getId()===v){Z.splice(E,1);break}s&&x(v,s);F();return s},
eachLayer:function(v){for(var s=ta;s--;)v(Z[s])},invalidate:F,refresh:Ma,resetScale:function(){Y=1},resize:function(v,s){if(la){b.autoSize=false;if(na!==v||ma!==s)w(v,s)}},scale:ab,triggerAll:Pa,removeLayer:function(v){a:{for(var s=ta;s--;)if(Z[s].getId()==v){v=s;break a}v=-1}if(v>=0&&v<ta){ka.trigger("layerRemoved",Z[v]);Z.splice(v,1);F(true)}ta=Z.length},stateOverride:function(v){eb=v},getOffset:function(){return I.init(da,ea)},setMaxOffset:function(v,s,E,N){Ba=v;Ca=s;Ua=typeof E!="undefined"?E:
false;Va=typeof N!="undefined"?N:false},getViewRect:sa,updateOffset:m,pan:function(v,s,E,N,V){m(da+v,ea+s,E,N,V)}};nb=L().getScaling();ka.markers=x("markers",new pa);COG.observable(ka);ka.bind("invalidate",function(v,s){F(s)});ka.bind("resync",function(){Ka=Ja=null});COG.configurable(ka,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(b,null,{container:function(v,s){la=document.getElementById(s);w()},rotation:function(v,s){xb=s}}),true);w();if(b.autoSize)wb?window.attachEvent("onresize",
p):window.addEventListener("resize",p,false);return ka},ViewLayer:P,ImageLayer:function(b,i){function e(l,m,w){for(m=f.length;m--;){var x=f[m],G=x.x,T=x.y,r=ga.init(x.x,x.y,x.x+x.width,x.y+x.height);if(w&&ga.intersect(l,r)){r=Da.get(x.url,function(){p.changed()},j);w(r,G,T,x.width,x.height)}}}function a(l){d&&d.run(l,p.getParent(),function(m){f=[].concat(m);p.changed()})}i=COG.extend({imageLoadArgs:{}},i);var d=b?Ha.init(b,i):null,f=[],g=ga.init(),j=i.imageLoadArgs,p=COG.extend(new P(i),{changeGenerator:function(l,
m){d=Ha.init(l,COG.extend({},i,m));f=null;a(g)},clip:function(l,m,w){e(m,w,function(x,G,T,r,K){x&&l.rect(G,T,r,K)})},cycle:function(l,m){a(m)},draw:function(l,m,w){e(m,w,function(x,G,T,r,K){p.drawImage(l,x,G,T,r,K,m,w)});g=ga.copy(m)},drawImage:function(l,m,w,x){m&&l.drawImage(m,w,x,m.width,m.height)}});p.bind("refresh",function(){a(g)});p.bind("tap",function(l,m,w,x){l=[];var G=x.x,T=x.y,r,K;if(f)for(var O=f.length;O--;){r=f[O];if(K=G>=r.x&&G<=r.x+r.width&&T>=r.y&&T<=r.y+r.height)l[l.length]=r}l.length>
0&&p.trigger("tapImage",l,m,w,x)});return p},Marker:ra,ImageMarker:function(b){b=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},b);var i=b.imageAnchor?T5.XY.invert(b.imageAnchor):null,e=COG.extend(new ra(b),{drawMarker:function(a,d,f,g){if((d=e.isAnimating()&&e.animatingImage?e.animatingImage:e.image)&&d.width>0){i||(i=I.init(-d.width>>1,-d.height>>1));var j=e.scale,p=f+~~(i.x*j),l=g+~~(i.y*j),m=~~(d.width*j),w=~~(d.height*
j);e.updateBounds(p,l,m,m);if(e.rotation||e.opacity!==1){a.save();try{a.globalAlpha=e.opacity;a.translate(f,g);a.rotate(e.rotation);a.drawImage(d,i.x*j,i.y*j,m,w)}finally{a.restore()}}else a.drawImage(d,p,l,m,w)}}});if(!e.image)e.image=Da.get(b.imageUrl,function(a){e.image=a});if(!e.animatingImage)e.animatingImage=Da.get(b.animatingImageUrl,function(a){e.animatingImage=a});return e},MarkerLayer:pa,PathLayer:function(b){function i(){var m=l.getParent();if(m&&m.syncXY){m.syncXY(f);g&&m.syncXY(g);l.trigger("tidy")}}
b=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},b);var e=false,a=[],d=null,f=[],g=null,j=0,p=[],l=COG.extend(new P(b),{getAnimation:function(m,w,x,G){var T="pathAnimation"+j++;p.push(T);return new xa({id:T,path:a,zindex:b.zindex+1,easing:m?m:COG.easing("sine.inout"),duration:w?w:5E3,drawIndicator:x,autoCenter:G?G:false})},cycle:function(m,w,x,G){return G},draw:function(m){var w,x=a.length;m.save();try{H.apply(m,b.style);if(x>0){m.beginPath();m.moveTo(a[x-1].x,a[x-1].y);for(w=x;w--;)m.lineTo(a[w].x,
a[w].y);m.stroke();if(d){m.fillStyle=b.waypointFillStyle;for(w=d.length;w--;){m.beginPath();m.arc(d[w].x,d[w].y,2,0,Math.PI*2,false);m.stroke();m.fill()}}}}finally{m.restore()}e=false},updateCoordinates:function(m,w){f=m;g=w;i()}});l.bind("tidy",function(){a=I.simplify(f,b.pixelGeneralization);d=I.simplify(g,b.pixelGeneralization);e=true;l.changed()});l.bind("resync",i);return l},AnimatedPathLayer:xa,Shape:Qa,Arc:function(b,i){i=COG.extend({size:4},i);var e=I.init(),a=COG.extend(i,{draw:function(d){d.beginPath();
d.arc(e.x,e.y,a.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([b]);e=I.floor([b])[0]}});COG.info("created arc = ",b);return a},Poly:function(b,i){i=COG.extend({fill:false,simplify:false},i);var e=false,a=i.fill,d=i.simplify,f=t("ZOOM"),g=[],j=COG.extend(new Qa(i),{draw:function(p,l,m,w,x,G){if(e){l=true;m=(G&f)!==0;p.beginPath();for(G=g.length;G--;){m=g[G].x;w=g[G].y;if(l){p.moveTo(m,w);l=false}else p.lineTo(m,w);m=true}if(m){a&&p.fill();p.stroke()}}},resync:function(p){j.xy=
p.syncXY(b);g=I.floor(d?I.simplify(b):b)}});e=b&&b.length>=2;return j},ShapeLayer:function(b){function i(f){for(var g=a.length;g--;)a[g].resync(f);a.sort(function(j,p){var l=p.xy.y-j.xy.y;if(l===0)l=p.xy.x-j.xy.y;return l});d.changed()}function e(f,g){g.syncXY&&i(g)}b=COG.extend({zindex:80},b);var a=[],d=COG.extend(new P(b),{add:function(f){a[a.length]=f},each:function(f){for(var g=a.length;g--;)f(a[g])},draw:function(f,g,j){var p=g.x1,l=g.y1,m=g.width;g=g.height;for(var w=a.length;w--;){var x=a[w].style;
x=x?H.apply(f,x):null;a[w].draw(f,p,l,m,g,j);x&&H.apply(f,x)}}});d.bind("parentChange",e);d.bind("resync",e);return d},Tiling:ob,TileGenerator:function(b){function i(G,T,r,K){function O(){if(x.initTileCreator){g=true;x.initTileCreator(G,T,r,K)}}x.prepTileCreator?x.prepTileCreator(G,T,r,O):O()}function e(G,T){for(var r=~~((G.x1-d.x)/j),K=~~((G.y1-d.y)/p),O=[],F=-f;F<m;F++)for(var sa=-f;sa<w;sa++){var Ma=l(r+F,K+sa);if(Ma)O[O.length]=Ma}T&&T(O);a=ga.copy(G)}b=COG.extend({tileWidth:256,tileHeight:256,
relative:false,padding:2},b);var a=null,d=I.init(),f=b.padding,g=false,j=b.tileWidth,p=b.tileHeight,l=null,m=0,w=0,x={getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){l=null;g=false;a=null},run:function(G,T,r){var K=!a||Math.abs(G.x1-a.x1)>j||Math.abs(G.y1-a.y1)>p,O=K?x.requireRefresh(G,T):false;if(K){if(!l&&!g||O){d=b.relative?I.init(G.x1,G.y1):I.init();m=Math.ceil(G.width/j)+f;w=Math.ceil(G.height/p)+f;i(j,p,x.getTileCreatorArgs?
x.getTileCreatorArgs(T):{},function(F){l=F;g=false;e(G,r)})}l&&e(G,r)}}};COG.observable(x);x.bind("update",function(){COG.info("captured generator update");a=null});return x}};COG.observable(Za);return Za}();
