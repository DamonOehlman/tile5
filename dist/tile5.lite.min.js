COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var G=arguments[0]||{},Q,B=1,r=arguments.length;B<r;B++)if((Q=arguments[B])!==null)for(var e in Q){var g=Q[e];if(G!==g)if(g!==undefined)G[e]=g}return G};
(function(){var G=Object.prototype.hasOwnProperty,Q=0,B={};B.toID=function(r){return r.replace(/\s/g,"-")};B.objId=function(r){return(r?r:"obj")+Q++};B.isFunction=function(r){return toString.call(r)==="[object Function]"};B.isArray=function(r){return toString.call(r)==="[object Array]"};B.isPlainObject=function(r){if(!r||toString.call(r)!=="[object Object]"||r.nodeType||r.setInterval)return false;if(r.constructor&&!G.call(r,"constructor")&&!G.call(r.constructor.prototype,"isPrototypeOf"))return false;
var e;for(e in r);return e===undefined||G.call(r,e)};B.isEmptyObject=function(r){for(var e in r)return false;return true};B.isXmlDocument=function(r){return toString.call(r)==="[object Document]"};B.contains=function(r,e){var g=r,o=arguments,u=1;if(e&&module.isArray(e)){o=e;u=0}for(u=u;u<o;u++)g=g&&typeof foo[o[u]]!=="undefined";return g};B.formatStr=function(r){if(arguments.length<=1)return r;for(var e=arguments.length-2,g=0;g<=e;g++)r=r.replace(RegExp("\\{"+g+"\\}","gi"),arguments[g+1]);return r};
B.wordExists=function(r,e){var g="";if(e.toString)e=e.toString();for(var o=0;o<e.length;o++)g+=!/\w/.test(e[o])?"\\"+e[o]:e[o];return RegExp("(^|\\s|\\,)"+g+"(\\,|\\s|$)","i").test(r)};COG.extend(COG,B)})();
(function(){function G(g){return typeof console!=="undefined"?function(){console[g](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var Q=window.console&&window.console.markTimeline,B=G("error"),r=G("info"),e=function(){return Q?function(g,o){console.markTimeline(g+(o?": "+((new Date).getTime()-o)+"ms":""))}:function(){}}();COG.extend(COG,{trace:e,debug:G("debug"),info:r,warn:G("warn"),error:B,exception:function(g){if(B)for(var o in g)r("ERROR DETAIL: "+o+
": "+g[o])}})})();
(function(){function G(B,r){var e=B.obsHandlers;e[r]||(e[r]=[]);return e[r]}var Q=0;COG.observable=function(B){if(!B)return null;if(!B.obsHandlers)B.obsHandlers={};if(!(B.bind||B.trigger||B.unbind)){B.bind=function(r,e){var g="callback"+Q++;G(B,r).unshift({fn:e,id:g});return g};B.triggerCustom=function(r,e){var g=G(B,r),o={cancel:false,name:r,source:this},u;e&&COG.extend(o,e);if(!g)return null;u=Array.prototype.slice.call(arguments,2);B.eventInterceptor&&B.eventInterceptor(r,o,u);u.unshift(o);for(var I=
g.length;I--&&!o.cancel;)g[I].fn.apply(this,u);return o};B.trigger=function(r){var e=Array.prototype.slice.call(arguments,1);e.splice(0,0,r,null);return B.triggerCustom.apply(this,e)};B.unbind=function(r,e){if(typeof r==="undefined")B.obsHandlers={};else for(var g=G(B,r),o=0;g&&o<g.length;o++)if(g[o].id===e){g.splice(o,1);break}return B}}return B}})();
(function(){function G(e,g){e[g]||(e[g]=function(o){return e.configure(g,o)})}function Q(e){e.gtConfId="configurable"+r++;e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var B={},r=0;COG.paramTweaker=function(e,g,o){return function(u,I){if(typeof I!=="undefined"){if(u in e)e[u]=I;o&&u in o&&o[u](u,I)}else return g&&u in g?g[u](u):e[u]}};COG.configurable=function(e,g,o,u){if(e){e.gtConfId||Q(e);var I=e.gtConfId,h=e.gtConfig,z=e.gtConfigFns;B[I]=e;z.push(o);for(o=g.length;o--;){h[g[o]]=true;u&&G(e,
g[o])}if(!e.configure)e.configure=function(s,A){if(h[s]){for(var p=z.length;p--;){var l=z[p](s,A);if(typeof l!=="undefined")return l}return B[I]}return null}}}})();
(function(){function G(e){var g=document.createElement("script"),o=false;g.src=e;g.async=true;g.onload=g.onreadystatechange=function(){if(!o&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){o=true;g.onload=g.onreadystatechange=null;g&&g.parentNode&&g.parentNode.removeChild(g)}};B||(B=document.getElementsByTagName("head")[0]);B.appendChild(g)}var Q=0,B,r=this;COG.jsonp=function(e,g,o){e+=e.indexOf("?")>=0?"&":"?";var u="json"+ ++Q;r[u]=function(I){g(I);r[u]=null;try{delete r[u]}catch(h){}};
G(e+(o?o:"callback")+"="+u);return u}})();
(function(){var G=1.70158,Q=Math.PI/2,B=1E3/60|0,r=Math.abs,e=Math.pow,g=Math.sin,o=Math.asin,u=Math.cos,I={linear:function(h,z,s,A){return s*h/A+z},backin:function(h,z,s,A){return s*(h/=A)*h*((G+1)*h-G)+z},backout:function(h,z,s,A){return s*((h=h/A-1)*h*((G+1)*h+G)+1)+z},backinout:function(h,z,s,A){return(h/=A/2)<1?s/2*h*h*(((G*=1.525)+1)*h-G)+z:s/2*((h-=2)*h*(((G*=1.525)+1)*h+G)+2)+z},bouncein:function(h,z,s,A){return s-I.bounceout(A-h,0,s,A)+z},bounceout:function(h,z,s,A){return(h/=A)<1/2.75?s*
7.5625*h*h+z:h<2/2.75?s*(7.5625*(h-=1.5/2.75)*h+0.75)+z:h<2.5/2.75?s*(7.5625*(h-=2.25/2.75)*h+0.9375)+z:s*(7.5625*(h-=2.625/2.75)*h+0.984375)+z},bounceinout:function(h,z,s,A){return h<A/2?I.bouncein(h*2,0,s,A)/2+z:I.bounceout(h*2-A,0,s,A)/2+s/2+z},cubicin:function(h,z,s,A){return s*(h/=A)*h*h+z},cubicout:function(h,z,s,A){return s*((h=h/A-1)*h*h+1)+z},cubicinout:function(h,z,s,A){if((h/=A/2)<1)return s/2*h*h*h+z;return s/2*((h-=2)*h*h+2)+z},elasticin:function(h,z,s,A,p,l){if(h==0)return z;if((h/=
A)==1)return z+s;l||(l=A*0.3);if(!p||p<r(s)){p=s;s=l/4}else s=l/TWO_PI*o(s/p);return-(p*e(2,10*(h-=1))*g((h*A-s)*TWO_PI/l))+z},elasticout:function(h,z,s,A,p,l){var x;if(h==0)return z;if((h/=A)==1)return z+s;l||(l=A*0.3);if(!p||p<r(s)){p=s;x=l/4}else x=l/TWO_PI*o(s/p);return p*e(2,-10*h)*g((h*A-x)*TWO_PI/l)+s+z},elasticinout:function(h,z,s,A,p,l){var x;if(h==0)return z;if((h/=A/2)==2)return z+s;l||(l=A*0.3*1.5);if(!p||p<r(s)){p=s;x=l/4}else x=l/TWO_PI*o(s/p);if(h<1)return-0.5*p*e(2,10*(h-=1))*g((h*
A-x)*TWO_PI/l)+z;return p*e(2,-10*(h-=1))*g((h*A-x)*TWO_PI/l)*0.5+s+z},quadin:function(h,z,s,A){return s*(h/=A)*h+z},quadout:function(h,z,s,A){return-s*(h/=A)*(h-2)+z},quadinout:function(h,z,s,A){if((h/=A/2)<1)return s/2*h*h+z;return-s/2*(--h*(h-2)-1)+z},sinein:function(h,z,s,A){return-s*u(h/A*Q)+s+z},sineout:function(h,z,s,A){return s*g(h/A*Q)+z},sineinout:function(h,z,s,A){return-s/2*(u(Math.PI*h/A)-1)+z}};COG.tweenValue=function(h,z,s,A,p){function l(R){R=R?R:(new Date).getTime();if(aa+B<R){var Z=
R-x,M=s(Z,h,W,A),fa=x+A<=R;R=!fa;if(p){Z=p(M,fa,Z);R=typeof Z!="undefined"?Z&&R:R}R&&animFrame(l)}}var x=(new Date).getTime(),aa=0,W=z-h;animFrame(l);return{}};COG.easing=function(h){return I[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(h,z){I[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]=z}})();
(function(){var G=/^P(\d+Y)?(\d+M)?(\d+D)?$/,Q=/^(\d+H)?(\d+M)?(\d+S)?$/,B={8601:function(e){e=e.split("T");var g=null;g=null;var o=0,u=0;G.lastIndex=-1;g=G.exec(e[0]);o+=g[3]?parseInt(g[3].slice(0,-1),10):0;Q.lastIndex=-1;g=Q.exec(e[1]);u+=g[1]?parseInt(g[1].slice(0,-1),10)*3600:0;u+=g[2]?parseInt(g[2].slice(0,-1),10)*60:0;u+=g[3]?parseInt(g[3].slice(0,-1),10):0;return new r(o,u)}},r=COG.Duration=function(e,g){return{days:e?e:0,seconds:g?g:0}};COG.addDuration=function(){for(var e=new r,g=arguments.length;g--;){e.days+=
arguments[g].days;e.seconds+=arguments[g].seconds}if(e.seconds>=86400){e.days+=~~(e.seconds/86400);e.seconds%=86400}return e};COG.formatDuration=function(e){var g,o,u="";if(e.days)u=e.days+" days ";if(e.seconds){e=e.seconds;if(e>=3600){g=~~(e/3600);e-=g*3600}if(e>=60){o=Math.round(e/60);e-=o*60}if(g)u=u+g+(g>1?" hrs ":" hr ")+(o?(o>10?o:"0"+o)+" min ":"");else if(o)u=u+o+" min";else if(e>0)u=u+(e>10?e:"0"+e)+" sec"}return u};COG.parseDuration=function(e,g){var o=g?B[g]:null;if(o)return o(e);COG.Log.warn("Could not find duration parser for specified format: "+
g);return new r}})();COG.ObjectStore=function(){var G={},Q={},B="obj_"+(new Date).getTime(),r=0,e=Object.prototype.hasOwnProperty;return{add:function(g,o){var u;o=o?o:"default";if(g&&g.constructor)if(!e.call(g,"id"))g.id=B+ ++r;u=Q[o]?Q[o]:Q[o]=[];G[g.id]=u.length;u[g.length]=g}}};var CANI={};
(function(G){var Q=[],B=0,r=false,e=G.register=function(g,o){Q.push({section:g,run:o})};G.init=function(g){function o(){if(B<Q.length){var I=Q[B++];u[I.section]||(u[I.section]={});I.run(u[I.section],o)}else{for(I in u)G[I]=u[I];r=true;g&&g(G)}}var u={};if(r&&g)g(G);else{B=0;o()}};e("canvas",function(g,o){function u(){var s,A=I.getContext("2d");A.save();try{A.translate(50,50);A.beginPath();A.rect(0,0,20,20);s=A.isPointInPath(10,10)}finally{A.restore()}return s}var I=document.createElement("canvas"),
h=typeof FlashCanvas!="undefined",z=typeof G_vmlCanvasManager!="undefnined";I.width=200;I.height=200;g.pipTransformed=h||z?false:u();o()})})(CANI);
INTERACT=function(){function G(p){return function(l,x,aa){(aa?aa:p?document.body:document).addEventListener(l,x,false)}}function Q(p){return function(l,x,aa){(aa?aa:p?document.body:document).removeEventListener(l,x,false)}}function B(p,l,x){(x?x:document).attachEvent("on"+p,l)}function r(p,l,x){(x?x:document).detachEvent("on"+p,l)}function e(p,l){return{x:p?p:0,y:l?l:0,count:1}}function g(p,l){s.push(COG.extend({handler:null,checks:{},type:p},l))}function o(p){var l=0,x=0;if(p.offsetParent){do{l+=
p.offsetLeft;x+=p.offsetTop;p=p.offsetParent}while(p)}return{left:l,top:x}}function u(p,l){return{source:p,target:l.target?l.target:l.srcElement}}function I(p,l){for(var x=p.target?p.target:p.srcElement;x&&x!==l&&x.nodeName&&x.nodeName.toUpperCase()!="CANVAS";)x=x.parentNode;return x&&x===l}function h(p,l){return{x:p.x-(l?l.left:0),y:p.y-(l?l.top:0)}}function z(p){if(p.preventDefault){p.preventDefault();p.stopPropagation()}else p.cancelBubble&&p.cancelBubble()}var s=[],A=function(p,l,x){function aa(X,
ba,ca,C){var S=0,K=0,y=0;COG.tweenValue(0,X,ca,C,function(F){y=S;S=F});COG.tweenValue(0,ba,ca,C,function(F){W.trigger("pan",S-y,F-K);K=F})}x=COG.extend({binder:null,unbinder:null,observable:null},x);for(var W=x.observable,R=null,Z=[],M=[],fa,ma,qa={bind:function(){return W.bind.apply(null,arguments)},pannable:function(X){R=COG.extend({inertia:true},X);return qa},unbind:function(){W.unbind();for(var X=0;X<Z.length;X++)Z[X].unbind();return qa}},Ha=0;Ha<l.length;Ha++)Z.push(l[Ha](p,W,x));W.bind("pointerDown",
function(){M=[];ma=fa=0});W.bind("pointerMove",function(X,ba,ca,C){if(R){M[M.length]={ticks:(new Date).getTime(),x:C.x,y:C.y};W.trigger("pan",C.x,C.y)}fa+=C.x?C.x:0;ma+=C.y?C.y:0});W.bind("pointerUp",function(X,ba,ca){if(Math.abs(fa)>20||Math.abs(ma)>20){if(R){ca=M.length;var C,S;ba=0;for(S=M.length;--S>1&&ba<50;)ba+=M[S].ticks-M[S-1].ticks;if(ca-S>1){X=M[ca-1].x-M[S].x;C=M[ca-1].y-M[S].y;S=Math.sqrt(X*X+C*C)|0;if(S>15){X=M[ca-1].x-M[0].x;C=M[ca-1].y-M[0].y;S=Math.sqrt(X*X+C*C)|0;ca=Math.asin(C/S);
ba=S*500/ba|0;ba=ba>300?300:ba;aa(Math.cos(X>0?ca:Math.PI-ca)*ba,Math.sin(ca)*ba,COG.easing("sine.out"),500)}}}}else W.trigger("tap",ba,ca)});return qa};g("pointer",{handler:function(p,l,x){function aa(y){if(y.pageX&&y.pageY)return e(y.pageX,y.pageY);else{var F=document.documentElement,$=document.body;return e(y.clientX+(F&&F.scrollLeft||$&&$.scrollLeft||0)-(F&&F.clientLeft||$&&$.clientLeft||0),y.clientY+(F&&F.scrollTop||$&&$.scrollTop||0)-(F&&F.clientTop||$&&$.clientTop||0))}}function W(y){if(I(y,
p))if(X=fa(y)){var F=aa(y);p.style.cursor="move";z(y);S=F.x;K=F.y;ba=e(S,K);l.triggerCustom("pointerDown",u("mouse",y),ba,h(ba,o(p)))}}function R(y){var F=aa(y);ca=F.x;C=F.y;if(I(y,p))ma(y,X?"pointerMove":"pointerHover")}function Z(y){if(X&&fa(y)){X=false;if(I(y,p)){p.style.cursor="default";ma(y,"pointerUp")}}}function M(y){if(I(y,p)){var F;y=y||window.event;if(y.detail)F=y.axis===2?-y.detail*qa:0;else{F=y.wheelDeltaY?y.wheelDeltaY:y.wheelDelta;if(window.opera)F=-F}if(F!==0){var $=e(ca,C);l.triggerCustom("zoom",
u("mouse",y),$,h($,o(p)),F/Ha,"wheel");z(y);y.returnValue=false}}}function fa(y){y=y||window.event;return(y.which||y.button)==1}function ma(y,F,$,na,Ea){$=typeof $!="undefined"?$:ca;na=typeof na!="undefined"?na:C;var H=$-S,U=na-K,N=e($,na);l.triggerCustom(F,u("mouse",y),N,h(N,o(p)),e(H,U));if(typeof Ea=="undefined"||Ea){S=$;K=na}}x=COG.extend({},x);var qa=120,Ha=qa*8,X=false,ba,ca,C,S,K;x.binder("mousedown",W,false);x.binder("mousemove",R,false);x.binder("mouseup",Z,false);x.binder("dblclick",function(y){COG.info("captured double click");
if(I(y,p)){var F=aa(y);l.triggerCustom("doubleTap",u("mouse",y),F,h(F,o(p)))}},false);x.binder("mousewheel",M,document);x.binder("DOMMouseScroll",M,document);return{unbind:function(){x.unbinder("mousedown",W,false);x.unbinder("mousemove",R,false);x.unbinder("mouseup",Z,false);x.unbinder("mousewheel",M,document);x.unbinder("DOMMouseScroll",M,document)}}},checks:{touch:false}});g("pointer",{handler:function(p,l,x){function aa(H){if(H.count<2)return 0;var U=H.x-H.next.x;H=H.y-H.next.y;return~~Math.sqrt(U*
U+H*H)}function W(H,U,N){U=U?U:0;N=N?N:0;for(var xa={x:H.x-U,y:H.y-N,id:H.id,count:H.count},ya=xa;H.next;){H=H.next;ya=ya.next={x:H.x-U,y:H.y-N,id:H.id}}return xa}function R(H,U){var N=H[U?U:"touches"],xa,ya;if(N.length===0)return null;ya=xa={x:N[0].pageX,y:N[0].pageY,id:N[0].identifier,count:N.length};for(var Ca=1,Da=N.length;Ca<Da;Ca++)ya=ya.next={x:N[Ca].pageX,y:N[Ca].pageY,id:N[Ca].identifier};return xa}function Z(H){if(I(H,p)){C=o(p);var U=R(H,"changedTouches"),N=W(U,C.left,C.top);if(!K){S=X;
l.triggerCustom("pointerDown",u("touch",H),U,N)}na&&l.triggerCustom("pointerDownMulti",u("touch",H),U,N);K=R(H);if(K.count>1)F=aa(K);Ea=1;$=W(K)}}function M(H){if(I(H,p)){H.preventDefault();y=R(H);if(S==X)S=Math.abs(K.x-y.x)>qa||Math.abs(K.y-y.y)>qa?Ha:X;if(S!=X){S=y.count>1?ca:ba;if(S==ca)if(K.count===1){K=W(y);F=aa(K)}else{var U=aa(y);if(Math.abs(F-U)<ma)S=ba;else{var N;N=y.x;var xa=y.next.x,ya=y.y,Ca=y.next.y,Da=ya<Ca?ya:Ca;N={x:(N<xa?N:xa)+(Math.abs(N-xa)>>1),y:Da+(Math.abs(ya-Ca)>>1)};U=U/F;
xa=U-Ea;l.triggerCustom("zoom",u("touch",H),N,h(N,C),xa,"pinch");Ea=U}}S==ba&&l.triggerCustom("pointerMove",u("touch",H),y,W(y,C.left,C.top),e(y.x-$.x,y.y-$.y));na&&l.triggerCustom("pointerMoveMulti",u("touch",H),y,W(y,C.left,C.top))}$=W(y)}}function fa(H){if(I(H,p)){var U=R(H,"changedTouches"),N=W(U,C.left,C.top);y=R(H);if(!y){l.triggerCustom("pointerUp",u("touch",H),U,N);K=null}na&&l.triggerCustom("pointerUpMulti",u("touch",H),U,N)}}x=COG.extend({detailed:false,inertia:false},x);var ma=20,qa=7,
Ha=0,X=1,ba=2,ca=3,C,S,K,y,F,$,na=x.detailed,Ea=1;x.binder("touchstart",Z,false);x.binder("touchmove",M,false);x.binder("touchend",fa,false);COG.info("initialized touch handler");return{unbind:function(){x.unbinder("touchstart",Z,false);x.unbinder("touchmove",M,false);x.unbinder("touchend",fa,false)}}},checks:{touch:true}});return{register:g,watch:function(p,l,x){l=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},l);capabilities=COG.extend({touch:"ontouchstart"in
window},x);if(!l.observable){COG.info("creating observable");l.observable=COG.observable({});globalOpts=l}l.binder=l.isIE?B:G(l.bindToBody);l.unbinder=l.isIE?r:Q(l.bindToBody);x=l.types;for(var aa=capabilities,W=[],R=s.length;R--;){var Z=s[R],M=!x||x.indexOf(Z.type)>=0,fa=true;for(var ma in Z.checks){var qa=Z.checks[ma];COG.info("checking "+ma+" capability. require: "+qa+", capability = "+aa[ma]);fa=fa&&qa===aa[ma]}if(M&&fa)W[W.length]=Z.handler}return new A(p,W,l)}}}();var T5={};
(function(G){function Q(){return(new Date).getTime()}function B(){for(;H.length>0;){var a=H.shift();document.location=a}Ea=0}function r(a){for(var f=true,c=U.length;c--;)f=f&&a!=U[c];return f}function e(a,f){var c=[];for(var b in f)b&&c.push(b+"="+escape(f[b]));return"tile5://"+a+"/"+(c.length>0?"?"+c.join("&"):"")}function g(a,f){r(a)&&COG.info("would push url: "+e(a,f))}function o(a,f){if(r(a)){H.push(e(a,f));Ea||(Ea=setTimeout(B,100))}}function u(a){return function(f,c,b){(b?b:a?document.body:
document).addEventListener(f,c,false)}}function I(a){return function(f,c,b){(b?b:a?document.body:document).removeEventListener(f,c,false)}}function h(a,f,c){(c?c:document).attachEvent("on"+a,f)}function z(a,f,c){(c?c:document).detachEvent("on"+a,f)}function s(){F={base:{name:"Unknown",bindEvent:u(),unbindEvent:I(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:g,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:h,unbindEvent:z,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:o,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:o},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:o},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:u(true),unbindEvent:I(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:o},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:o}};$=[F.froyo,F.android,F.ipod,F.iphone,F.ipad,F.ie]}function A(){F||s();if(!na){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<$.length;a++){var f=$[a];if(f.regex&&f.regex.test(navigator.userAgent)){na=COG.extend({},F.base,f);COG.info("PLATFORM DETECTED AS: "+na.name);break}}if(!na){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
na=F.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return na}function p(){var a=(new Date).getTime(),f=0;clearTimeout(Ta);for(Ta=0;f<Qa.length;){var c=Qa[f],b=Da[c],d=Da[c].image&&(zb||Da[c].image.complete&&Da[c].image.width>0),n=a-b.start;n=d||n>=xa;if(d){d=b.image;b=b.callbacks;ya[c]=d;for(var m=0;m<b.length;m++)b[m](d,true)}if(n){Qa.splice(f,1);delete Da[c]}else f++}if(Qa.length>0)Ta=setTimeout(p,N)}function l(){for(var a=0,f=arguments.length;f--;){var c=Jb[arguments[f].toUpperCase()];
if(c)a|=c}return a}function x(a,f){var c,b;if(f&&f.width>0){if(!a.imageOffset)a.imageOffset=C.init(-f.width>>1,-f.height>>1);if(!a.bounds){c=a.xy.x+a.imageOffset.x;b=a.xy.y+a.imageOffset.y;a.bounds=K.init(c,b,c+f.width,b+f.height)}}}function aa(a){function f(){a.transformed=d!==1||b%W!==0||n!==0||m!==0}var c=1E3/60|0,b=0,d=1,n=0,m=0;COG.extend(a,{animate:function(i,v,t,D,q,E){var V=(new Date).getTime(),L=a[i],O=v.length&&t.length&&v.length==t.length?v.length:0,P=Array(O),J=Array(O),ia=COG.easing(D?
D:"sine.out"),da=function(ka){ka=ka?ka:(new Date).getTime();if(ka-0>c){var Ua=ka-V;ka=V+q<=ka;for(var La=O;La--;)J[La]=ia(Ua,v[La],P[La],q);L.apply(a,J);a.invalidate.call(a);if(ka){L.apply(a,t);a.invalidate.call(a);E&&E()}else animFrame(da)}};if(L&&L.apply&&O>0){q=q?q:1E3;for(i=O;i--;)P[i]=t[i]-v[i];animFrame(da)}},rotate:function(i){b=i;f()},scale:function(i){d=i;f()},translate:function(i,v){n=i;m=v;f()},transform:function(i,v,t){i.save();i.translate(a.xy.x-v+n,a.xy.y-t+m);b!==0&&i.rotate(b);d!==
1&&i.scale(d,d)}})}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},1E3/60)}}();var W=Math.PI*2,R=Math.abs,Z=Math.min,M=Math.max,fa=Math.pow,ma=Math.sqrt,qa=Math.log,Ha=Math.round,X=Math.sin,ba=Math.asin,ca=Math.cos,C=function(){function a(b,d){return c(b.x-d.x,b.y-d.y)}function f(b,d){if(!d)d=
b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var n={edges:Array(d-1),accrued:Array(d-1),total:0},m=0;m<d-1;m++){var i=a(b[m],b[m+1]);n.edges[m]=ma(i.x*i.x+i.y*i.y);n.accrued[m]=n.total+n.edges[m];n.total+=n.edges[m]}return n}function c(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,n=arguments.length;n--;){b+=arguments[n].x;d+=arguments[n].y}return c(b,d)},absSize:function(b){return M(R(b.x),
R(b.y))},copy:function(b){return b?c(b.x,b.y):null},diff:a,distance:function(b,d){return f(b,d).total},edges:f,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,n){var m=ca(d)*n;d=X(d)*n;return c(b.x-m,b.y-d)},floor:function(b){for(var d=Array(b.length),n=b.length;n--;)d[n]=c(~~b[n].x,~~b[n].y);return d},getRect:function(b){for(var d,n,m,i,v=b.length;v--;){var t=b[v];d=typeof d==="undefined"||t.x<d?t.x:d;n=typeof n==="undefined"||t.y<n?t.y:n;m=typeof m==="undefined"||t.x>m?t.x:
m;i=typeof i==="undefined"||t.y>i?t.y:i}return K.init(d,n,m,i)},init:c,invert:function(b){return c(-b.x,-b.y)},min:function(b,d){return c(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return c(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,n){return c(b.x+d,b.y+(n?n:d))},scale:function(b,d){return c(b.x/d|0,b.y/d|0)},simplify:function(b,d){if(!b)return null;d=d?d:C.VECTOR_SIMPLIFICATION;for(var n=[],m=null,i=b.length;i--;){var v=b[i];if(include=!m||i===0||R(v.x-m.x)+R(v.y-m.y)>d){n.unshift(v);
m=v}}return n},theta:function(b,d,n){n=ba((b.y-d.y)/n);return b.x>d.x?n:Math.PI-n},toString:function(b){return b?b.x+", "+b.y:""}}}(),S=function(){return{dotProduct:function(a,f){return a.x*f.x+a.y*f.y}}}(),K=function(){function a(c){return f(c.x1,c.y1,c.x2,c.y2)}function f(c,b,d,n){c=c?c:0;b=b?b:0;d=typeof d!=="undefined"?d:c;n=typeof n!=="undefined "?n:n;return{x1:c,y1:b,x2:d,y2:n,width:d-c,height:n-b}}return{center:function(c){return C.init(c.x1+(c.width>>1),c.y1+(c.height>>1))},copy:a,diagonalSize:function(c){return ma(c.width*
c.width+c.height*c.height)},fromCenter:function(c,b,d,n){d=d>>1;n=n>>1;return f(c-d,b-n,c+d,b+n)},init:f,intersect:function(c,b){var d=M(c.x1,b.x1),n=M(c.y1,b.y1),m=Z(c.x2,b.x2),i=Z(c.y2,b.y2);d=f(d,n,m,i);return d.width>0&&d.height>0?d:null},toString:function(c){return c?"["+c.x1+", "+c.y1+", "+c.x2+", "+c.y2+"]":""},union:function(c,b){if(c.width===0||c.height===0)return a(b);else if(b.width===0||b.height===0)return a(c);else{var d=Z(c.x1,b.x1),n=Z(c.y1,b.y1),m=M(c.x2,b.x2),i=M(c.y2,b.y2);d=f(d,
n,m,i);return d.width>0&&d.height>0?d:null}}}}(),y=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return C.init(a.width>>1,a.height>>1)},getSize:function(a){return ma(fa(a.width,2)+fa(a.height,2))},init:function(a,f){a=a?a:0;return{width:a,height:f?f:a}}}}();Hits=function(){return{diffHits:function(a,f){var c=[],b={},d;for(d=f.length;d--;)b[f[d].target.id]=true;for(d=a.length;d--;)b[a[d].target.id]||(c[c.length]=a[d]);return c},init:function(a,
f,c,b){return{type:a,x:b.x|0,y:b.y|0,elements:[],absXY:f,relXY:c}},initHit:function(a,f,c){return c=COG.extend({type:a,target:f,drag:false},c)},triggerEvent:function(a,f,c,b){f.triggerCustom(a.type+(c?c:"Hit"),{hitType:a.type},b?b:a.elements,a.absXY,a.relXY,C.init(a.x,a.y))}}}();var F=null,$=[],na=null,Ea=0,H=[],U=["view.wake","tile.loaded"],N=100,xa=3E4,ya={},Ca=0;(new Date).getTime();var Da={},Qa=[],zb=typeof FlashCanvas!="undefined",Ta=0,jb=T5.getImage=function(a,f){var c=a&&f?ya[a]:null;if(c&&
c&&(zb||c.complete&&c.width>0))f(c);else{if(c=Da[a])c.callbacks.push(f);else{c=new Image;c.id="_ldimg"+ ++Ca;Da[a]={start:(new Date).getTime(),image:c,callbacks:[f]};c.src=a;Qa[Qa.length]=a}Ta||(Ta=setTimeout(p,N))}};T5.newCanvas=function(a,f){var c=document.createElement("canvas");c.width=a?a:0;c.height=f?f:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(c);FlashCanvas.initElement(c)}typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(c);return c};var kb=function(){var a=
{};return{init:function(f,c){var b=a[f];if(!b)throw Error("Unable to locate requested generator: "+f);return new b(c)},register:function(f,c){a[f]=c},Template:function(){}}}(),Va=function(){function a(m,i){d[m]=c(i);return m}function f(m){for(var i in m)a(i,m[i])}function c(m){function i(q){var E=m[q];typeof E!=="undefined"&&t.push(function(V){V[q]=E})}function v(){t=[];for(var q in m)i(q)}m=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,
fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},m);var t=[],D={applyToContext:function(q){for(var E=t.length;E--;)t[E](q)},update:function(q,E){m[q]=E;v()}};v();return D}var b={},d={},n={apply:function(m,i){var v=d[i]?d[i]:d.basic,t;if(m&&m.canvas){t=b[m.canvas.id];b[m.canvas.id]=i}v.applyToContext(m);return t},define:a,defineMany:f,get:function(m){return d[m]},init:c,load:function(m){COG.jsonp(m,function(i){f(i)})}};f({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},
waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,strokeStyle:"#f00",fillStyle:"#FFF"}});return n}(),Jb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},lb=function(a){a=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:l("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);var f=null,c=false,b=false,d=a.id,n=l("ACTIVE"),m=a.validStates,i=0,v=0,t=COG.extend({addToView:function(D){D.setLayer(d,
t)},shouldDraw:function(D){return(D&m)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null,remove:function(){t.trigger("remove",t)},changed:function(){b=true;f&&f.invalidate()},hitTest:null,getId:function(){return d},setId:function(D){d=D},getParent:function(){return f},setParent:function(D){c=(f=D)?f.fastDraw&&displayState!==n:false;t.trigger("parentChange",f)}},a);COG.observable(t);t.bind("drawComplete",function(D,q){b=false;i=q.x1;v=q.y1});t.bind("resync",function(D,q){t.minXY&&q.syncXY(t.minXY);
t.maxXY&&q.syncXY(t.maxXY)});return t},Fa=function(a){a=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape",transformable:false},a);COG.extend(this,a);this.id=COG.objId(this.type);this.bounds=null;this.observable&&COG.observable(this);this.transformable&&aa(this);this.transformed=false};Fa.prototype={constructor:Fa,drag:null,draw:function(a){this.fill&&a.fill();this.stroke&&a.stroke()},invalidate:function(){var a=this.layer?this.layer.getParent():
null;a&&a.invalidate()},prepPath:function(){},resync:function(a){if(this.xy){a.syncXY([this.xy]);this.size&&this.updateBounds(K.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},setTransformable:function(a){a&&!this.transformable&&aa(this);this.transformable=a},updateBounds:function(a,f){this.bounds=a;if(f)this.xy=K.center(this.bounds)}};var mb=function(a){Fa.call(this,a)};mb.prototype=COG.extend(Fa.prototype,{constructor:mb,prepPath:function(a,f,c){a.beginPath();a.arc(this.xy.x-f,this.xy.y-
c,this.size>>1,0,Math.PI*2,false);return true}});var Wa=function(a,f){f=COG.extend({simplify:false},f);var c=false,b=f.simplify;l("ZOOM");var d=[];f.type=f.fill?"polygon":"line";Fa.call(this,f);COG.extend(this,{animatePath:function(){},prepPath:function(n,m,i){if(c){var v=true;n.beginPath();for(var t=d.length;t--;){var D=d[t].x-m,q=d[t].y-i;if(v){n.moveTo(D,q);v=false}else n.lineTo(D,q)}}return c},resync:function(n){var m,i,v,t,D;n.syncXY(a);d=C.floor(b?C.simplify(a):a);for(var q=d.length;q--;){n=
d[q].x;m=d[q].y;t=typeof t=="undefined"||n<t?n:t;D=typeof D=="undefined"||m<D?m:D;i=typeof i=="undefined"||n>i?n:i;v=typeof v=="undefined"||m>v?m:v}this.updateBounds(K.init(t,D,i,v),true)}});c=a&&a.length>=2};Wa.prototype=COG.extend(Fa.prototype,{constructor:Wa});var Ab=function(a,f){f.fill=false;Wa.call(this,a,f)};Ab.prototype=new Wa;var Ra=function(a){function f(v){(this.imageUrl=v)&&jb(this.imageUrl,function(t,D){m=t;if(D){var q=i.layer?i.layer.getParent():null;q&&q.invalidate()}})}a=COG.extend({image:null,
imageUrl:null,imageOffset:null},a);var c=null,b=Fa.prototype.updateBounds,d,n,m=a.image;Fa.call(this,a);var i=COG.extend(this,{changeImage:f,drag:function(v,t,D,q){c||(c=C.init(v.startX-this.xy.x,v.startY-this.xy.y));this.xy.x=t-c.x;this.xy.y=D-c.y;if(q){c=null;if(this.layer)(v=this.layer.getParent())&&v.syncXY([this.xy],true);this.trigger("dragDrop")}return true},draw:function(v){v.drawImage(m,d,n)},prepPath:function(v,t,D){var q=m&&m.width>0;if(q){x(this,m);d=this.xy.x+this.imageOffset.x-t;n=this.xy.y+
this.imageOffset.y-D;v.beginPath();v.rect(d,n,m.width,m.height)}return q},updateBounds:function(v,t){b.call(this,v,t);x(this,m)}});m||f(this.imageUrl)};Ra.prototype=new Fa;Ra.prototype.constructor=Ra;var $a=function(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.imageOffset=C.invert(a.imageAnchor);Ra.call(this,a)};$a.prototype=new Ra;$a.prototype.constructor=$a;var Bb=function(a){function f(i){for(var v=b.length;v--;)b[v].resync(i);b.sort(function(t,D){var q=D.xy.y-t.xy.y;return q!=0?q:
D.xy.x-t.xy.y});m.changed()}function c(i,v){f(v)}a=COG.extend({zindex:10},a);var b=[],d=CANI.canvas.pipTransformed,n=typeof FlashCanvas!="undefined",m=COG.extend(new lb(a),{add:function(i,v){if(i){i.layer=m;var t=m.getParent();if(t){i.resync(m.getParent());t.invalidate()}if(v)b.unshift(i);else b[b.length]=i}},clear:function(){b=[]},draw:function(i,v,t,D,q,E){D=v.x1;q=v.y1;var V=E?d?E.x-D:E.relXY.x:0,L=E?d?E.y-q:E.relXY.y:0,O=v.width;v=v.height;for(var P=b.length;P--;){var J=b[P],ia=J.style||m.style,
da,ka=J.transformed&&!n;if(ka){J.transform(i,D,q);if(d){V-=J.xy.x;L-=J.xy.y}}if(J.prepPath(i,ka?J.xy.x:D,ka?J.xy.y:q,O,v,t)){if(E&&i.isPointInPath(V,L)){E.elements.push(Hits.initHit(J.type,J,{drag:J.draggable?J.drag:null}));da=E.type+"Style";ia=J[da]||m[da]||ia}ia=ia?Va.apply(i,ia):null;J.draw(i,D,q,O,v,t);ia&&Va.apply(i,ia)}ka&&i.restore()}},find:function(){return[].concat(b)},hitGuess:function(i,v){for(var t=false,D=b.length;!t&&D--;){var q=b[D];if(!(t=t))t=(q=q.bounds)&&i>=q.x1&&i<=q.x2&&v>=q.y1&&
v<=q.y2;t=t}return t}});m.bind("parentChange",c);m.bind("resync",c);return m},Kb=function(){return{tileSize:256,init:function(a,f,c,b,d){return COG.extend({x:a,y:f,width:c,height:b},d)}}}();COG.extend(G,{ex:COG.extend,ticks:Q,getConfig:A,userMessage:function(a,f,c){G.trigger("userMessage",a,f,c)},XY:C,XYRect:K,Dimensions:y,Vector:S,Hits:Hits,Generator:kb,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:Va,viewState:l,View:function(a){function f(j,k,w){Ga||ab(ga-k,
ha-w)}function c(j,k,w,T){La(Z(M(la+fa(2,T)-1,0.5),2))}function b(){var j=qa(la)/Math.LN2|0;if(j!==0){la=fa(2,j);Cb(Xa+j,bb,cb)}da()}function d(j){j||(j=C.init(Oa,Pa));nb=C.init(ga,ha);Ya=C.offset(j,ga,ha);bb=Ya.x;cb=Ya.y}function n(j,k){var w=1/la;return C.init(Ma?Ma.x1+j*w:j,Ma?Ma.y1+k*w:k)}function m(j,k,w){Sa("doubleTap",k,w,n(w.x,w.y));a.scalable&&La(2,w,a.zoomEasing,null,a.zoomDuration)}function i(j,k,w){Ga=null;ia("down",k,w)}function v(j,k,w){ia("hover",k,w)}function t(j,k,w){P(k,w,false)}
function D(j,k,w){P(k,w,true)}function q(){clearTimeout(Db);Db=setTimeout(V,250)}function E(j,k,w){ia("tap",k,w);Sa("tap",k,w,n(w.x,w.y,true))}function V(j,k){var w;db=typeof FlashCanvas!=="undefined";COG.info("is flash = "+db);if(oa){if(a.autoSize&&oa.parentNode){j=oa.parentNode.offsetWidth;k=oa.parentNode.offsetHeight}try{if(!oa.id)oa.id=a.id+"_canvas";ra=oa.getContext("2d")}catch(T){COG.exception(T);throw Error("Could not initialise canvas on specified view element");}if(j&&k&&(sa!==k||ta!==j)){ob=
true;ta=j;sa=k;Oa=ta>>1;Pa=sa>>1;ja.trigger("resize",ta,sa);for(w=za;w--;)ea[w].trigger("resize",ta,sa)}for(w=za;w--;)ea[w].trigger("contextChanged",ra);da();O()}}function L(j,k){k.setId(j);k.added=Q();k.bind("remove",function(){ja.removeLayer(j)});k.trigger("contextChanged",ra);k.setParent(ja);ea.push(k);ea.sort(function(w,T){var Y=T.zindex-w.zindex;if(Y===0)Y=T.added-w.added;return Y});za=ea.length;return k}function O(){Aa&&Aa.unbind();Aa=INTERACT.watch(oa);a.pannable&&Aa.pannable().bind("pan",
f);if(a.scalable){Aa.bind("zoom",c);Aa.bind("doubleTap",m)}Aa.bind("pointerDown",i);Aa.bind("pointerMove",t);Aa.bind("pointerUp",D);a.captureHover&&Aa.bind("pointerHover",v);Aa.bind("tap",E)}function P(j,k,w){if(Ga){j=n(k.x,k.y);Ga.drag.call(Ga.target,Ga,j.x,j.y,w)&&da();if(w)Ga=null}}function J(j){var k,w,T=false;if(pb|db){j=j?j:(new Date).getTime();if(j-Eb>Lb){w=ga!==qb||ha!==rb;Ia=Fb|(la!==1?Gb:0)|(w?sb:0)|(tb?ub:0);vb=(k=(Ia&(Gb|sb))!==0)&&(Ia&ub)===0;if(ob&&oa){oa.width=ta;oa.height=sa;oa.style.width=
ta+"px";oa.style.height=sa+"px";db&&FlashCanvas.initElement(oa);typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(oa);ob=false}eb=ka();for(w=za;w--;){Ia|=ea[w].animated?ub:0;ea[w].cycle(j,eb,Ia);T=ea[w].clip||T}w=Ia;var Y=eb;T=Mb&&T&&!k;k=j;var pa;K.center(Y);var ua=0,va;if(la!==1){va=1/la;bb=Ya.x+(ga-nb.x);cb=Ya.y+(ha-nb.y);va=Y?K.fromCenter(bb>>0,cb>>0,Y.width*va>>0,Y.height*va>>0):void 0}else va=K.copy(Y);Ma=va;T||ra.clearRect(0,0,ta,sa);Ma.scaleFactor=la;ra.save();try{la!==
1&&ra.scale(la,la);fb=gb=null;if(T){ra.beginPath();for(ua=za;ua--;)ea[ua].clip&&ea[ua].clip(ra,Ma,w,ja,k);ra.closePath();ra.clip()}ra.globalCompositeOperation="source-over";for(ua=za;ua--;){pa=ea[ua];if(pa.shouldDraw(Ia,eb)){var wa=pa.style,Na=wa?Va.apply(ra,wa):null;pa.draw(ra,Ma,w,ja,k,Ba);Na&&Va.apply(ra,Na)}}}finally{ra.restore()}pb=0;Sa("drawComplete",Y,k);if(Ba){pa=Ba?Ba.elements:[];if(Za&&Za.type==="hover"){wa=Hits.diffHits(Za.elements,pa);wa.length>0&&Hits.triggerEvent(Za,ja,"Out",wa)}if(pa.length>
0){Na=Ba.x;w=Ba.y;for(wa=pa.length;wa--;){Y=pa[wa];T=Na;k=w;if(ua=Y&&Y.drag&&(!Y.canDrag||Y.canDrag(Y,T,k))){Ga=Y;Ga.startX=T;Ga.startY=k}if(ua)break}Hits.triggerEvent(Ba,ja)}Za=pa.length>0?COG.extend({},Ba):null;Ba=null}j-Hb>Nb&&Ua();Eb=j;qb=ga;rb=ha}animFrame(J)}else wb=false}function ia(j,k,w){Ba=Hits.init(j,k,w,n(w.x,w.y,true));for(j=za;j--;)xb=xb||(ea[j].hitGuess?ea[j].hitGuess(Ba.x,Ba.y,Ia,ja):false);xb&&da()}function da(){pb+=1;if(!wb){wb=true;animFrame(J)}}function ka(){return K.init(ga,ha,
ga+ta,ha+sa)}function Ua(){if(Ja||Ka){var j=hb?ga+Oa:ga,k=ib?ha+Pa:ha;if(Ja&&Ja>ta)if(j+ta>Ja)ga=hb?j-Ja>0?ga-Ja:ga:Ja-ta;else if(j<0)ga=hb?ga+Ja:0;if(Ka&&Ka>sa)if(k+sa>Ka)ha=ib?k-Ka>0?ha-Ka:ha:Ka-sa;else if(k<0)ha=ib?ha+Ka:0}Hb=(new Date).getTime();Sa("refresh",ja,ka());da()}function La(j,k,w,T,Y){if(w)COG.tweenValue(la,j,w,Y,function(pa,ua){la=pa;if(ua){var va=Ha(qa(la)/Math.LN2);la=fa(2,va);T&&T()}d(k);b()});else{la=j;d(k);b()}return ja}function Cb(j,k,w){j=M(a.minZoom,Z(a.maxZoom,j));if(j!==Xa){var T=
fa(2,j-Xa),Y=Oa/T|0,pa=Pa/T|0;Xa=j;ab(((k?k:ga+Oa)-Y)*T,((w?w:ha+Pa)-pa)*T);qb=ga;rb=ha;Sa("zoomLevelChange",j);la=1;Ua()}}function Sa(){for(var j=ja.trigger.apply(null,arguments).cancel,k=ea.length;k--;)j=ea[k].trigger.apply(null,arguments).cancel||j;return!j}function ab(j,k,w,T,Y){function pa(){ua+=1;if(ua>=2){tb=false;Y&&Y()}}var ua=0,va=gb?C.offset(gb,-Oa,-Pa):null,wa=fb?C.offset(fb,-Oa,-Pa):null;if(va){j=j<va.x?va.x:j;k=k<va.y?va.y:k}if(wa){j=j>wa.x?wa.x:j;k=k>wa.y?wa.y:k}if(w){if((Ia&sb)===
0){COG.tweenValue(ga,j,w,T,function(Na,yb){ga=Na|0;(yb?pa:da)();return!vb});COG.tweenValue(ha,k,w,T,function(Na,yb){ha=Na|0;(yb?pa:da)();return!vb});tb=true}}else{ga=j|0;ha=k|0;da();Y&&Y()}}a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,
fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},a);var ea=[],za=0,oa=document.getElementById(a.container),Ga=null,ra=null,Ob=typeof window.attachEvent!="undefined",db,xb=false,Nb=a.minRefresh,ga=0,ha=0,qb=0,rb=0,Ja=null,Ka=null,hb=false,ib=false,Mb=a.clipping,eb=null,wb=false,Ma,Ib=1,Oa=0,Pa=0,Ba=null,nb=null,Ya=null,vb=false,gb=null,fb=null,Hb=0,Za=null,Db=0,la=1,Eb=0,ob=false,Aa=null,tb=false,sa,ta,Lb=1E3/a.fps|0,pb=0,bb,cb,Xa=a.zoomLevel,Fb=l("ACTIVE"),
sb=l("PAN"),Gb=l("ZOOM"),ub=l("ANIMATING"),Ia=Fb,ja={id:a.id,deviceScaling:Ib,fastDraw:a.fastDraw||A().requireFastDraw,detach:function(){Aa&&Aa.unbind()},eachLayer:function(j){for(var k=za;k--;)j(ea[k])},getDimensions:function(){return y.init(ta,sa)},getLayer:function(j){for(var k=0;k<za;k++)if(ea[k].getId()==j)return ea[k];return null},getZoomLevel:function(){return Xa},setLayer:function(j,k){for(var w=0;w<za;w++)if(ea[w].getId()===j){ea.splice(w,1);break}if(k){L(j,k);k.trigger("refresh",ja,ka())}da();
return k},invalidate:da,refresh:Ua,resetScale:function(){la=1},resize:function(j,k){if(oa){a.autoSize=false;if(ta!==j||sa!==k)V(j,k)}},scale:La,setZoomLevel:Cb,syncXY:function(){},triggerAll:Sa,removeLayer:function(j){a:{for(var k=za;k--;)if(ea[k].getId()==j){j=k;break a}j=-1}if(j>=0&&j<za){ja.trigger("layerRemoved",ea[j]);ea.splice(j,1);da()}za=ea.length},getOffset:function(){return C.init(ga,ha)},setMaxOffset:function(j,k,w,T){Ja=j;Ka=k;hb=typeof w!="undefined"?w:false;ib=typeof T!="undefined"?
T:false},getViewRect:ka,updateOffset:ab,pan:function(j,k,w,T,Y){ab(ga+j,ha+k,w,T,Y)}};Ib=A().getScaling();COG.observable(ja);ja.bind("invalidate",function(){da()});ja.bind("resync",function(){fb=gb=null});COG.configurable(ja,["container","captureHover","captureDrag","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(a,null,{container:function(j,k){oa=document.getElementById(k);V()},inertia:O,captureHover:O,scalable:O,pannable:O}),true);CANI.init(function(j){ja.markers=L("markers",
new Bb({zindex:20}));canvasCaps=j.canvas;V();if(a.autoSize)Ob?window.attachEvent("onresize",q):window.addEventListener("resize",q,false)});return ja},ViewLayer:lb,ImageLayer:function(a,f){function c(q,E,V,L){E.image?q.drawImage(E.image,V,L):jb(E.url,function(O){E.image=O;D.changed()})}function b(q,E,V){for(E=i.length;E--;){var L=i[E],O=L.x,P=L.y,J=K.init(L.x,L.y,L.x+L.width,L.y+L.height);V&&K.intersect(q,J)&&jb(L.url,function(ia,da){V(ia,O,P,L.width,L.height);da&&D.changed()},t)}}function d(q){var E=
v?Math.abs(v.x1-q.x1)+Math.abs(v.y1-q.y1):0;if(n&&(!v||E>256)){var V=++m;E=D.getParent();n.run(E,q,function(L){v=K.copy(q);if(V==m)for(var O=L.length;O--;){var P=L[O];i[i.length]={image:null,sequence:V,url:P.url,rect:K.init(P.x,P.y,P.x+P.width,P.y+P.height)}}})}}f=COG.extend({imageLoadArgs:{}},f);var n=a?kb.init(a,f):null,m=0,i=[],v=null,t=f.imageLoadArgs,D=COG.extend(new lb(f),{changeGenerator:function(q,E){n=kb.init(q,COG.extend({},f,E));d(D.getParent().getViewRect())},clip:function(q,E){for(var V=
E.x1,L=E.y1,O=i.length;O--;){var P=i[O].rect;K.intersect(E,P)&&q.rect(P.x1-V,P.y1-L,P.width,P.height)}},draw:function(q,E){for(var V=E.x1,L=E.y1,O=0;O<i.length;){var P=i[O],J=P.rect;K.intersect(E,J)&&c(q,P,J.x1-V,J.y1-L);if(P.sequence!==m)i.splice(O,1);else O++}},mask:function(q,E,V){b(E,V,function(L,O,P,J,ia){COG.info("clearing rect @ x = "+O+", y = "+P+", width = "+J+", height = "+ia);q.clearRect(O,P,J,ia)})}});D.bind("refresh",function(q,E,V){d(V)});D.bind("tap",function(q,E,V,L){q=[];var O=L.x,
P=L.y,J,ia;if(i)for(var da=i.length;da--;){J=i[da];if(ia=O>=J.x&&O<=J.x+J.width&&P>=J.y&&P<=J.y+J.height)q[q.length]=J}q.length>0&&D.trigger("tapImage",q,E,V,L)});return D},ImageGenerator:function(a){a=COG.extend({relative:false,padding:2},a);a={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(a);return a},Drawable:Fa,Marker:mb,Poly:Wa,Line:Ab,ImageDrawable:Ra,ImageMarker:$a,ShapeLayer:Bb,transformable:aa,Tiling:Kb});COG.observable(G)})(T5);
