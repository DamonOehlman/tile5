COG=function(){var h=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,i=0,f={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,e=arguments.length,b=false,k,d,j,g;if(typeof a==="boolean"){b=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!f.isFunction(a))a={};if(e===c){a=this;--c}for(;c<e;c++)if((k=arguments[c])!=null)for(d in k){j=a[d];g=k[d];if(a!==g)if(b&&g&&(f.isPlainObject(g)||f.isArray(g))){j=j&&(f.isPlainObject(j)||f.isArray(j))?j:f.isArray(g)?[]:{};a[d]=f.extend(b,j,g)}else if(g!==
undefined)a[d]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||m.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var e=a,b=arguments,k=1;if(c&&f.isArray(c)){b=c;k=0}for(k=k;k<b;k++)e=e&&typeof foo[b[k]]!=="undefined";return e},newModule:function(a){a=f.extend({id:null,requires:[],parent:null},a);if(a.parent)a=f.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+i++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,e=0;e<=c;e++)a=a.replace(RegExp("\\{"+e+"\\}","gi"),arguments[e+
1]);return a},wordExists:function(a,c){var e="";if(c.toString)c=c.toString();for(var b=0;b<c.length;b++)e+=!/\w/.test(c[b])?"\\"+c[b]:c[b];return RegExp("(^|\\s|\\,)"+e+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var e=h.exec(a);e;){a=a.replace(e[0],COG.XPath.first(e[1],c));h.lastIndex=0;e=h.exec(a)}return a}};return f}();
COG.Log=function(){function h(c,e){var b,k=e&&e.length>0?e[0]:"";for(b=1;e&&b<e.length;b++)k+=" "+(i&&COG.isPlainObject(e[b])?JSON.stringify(e[b]):e[b]);typeof console!=="undefined"&&console[c](k);for(b=0;b<m.length;b++)m[b].call(a,k,c)}var m=[],i=typeof JSON!=="undefined",f=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return f?(new Date).getTime():null},trace:function(c,e){if(f)console.markTimeline(c+(e?": "+(a.getTraceTicks()-e)+"ms":""))},debug:function(){h("debug",
arguments)},info:function(){h("info",arguments)},warn:function(){h("warn",arguments)},error:function(){h("error",arguments)},exception:function(c){a.error(arguments);for(var e in c)a.info("ERROR DETAIL: "+e+": "+c[e])},watch:function(c,e){try{e()}catch(b){a.exception(b,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return a}();
(function(){function h(f,a){f[a]||(f[a]=function(c){return f.configure(a,c)})}function m(f){f.gtConfId=COG.objId("configurable");f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var i={};COG.paramTweaker=function(f,a,c){return function(e,b){if(typeof b!=="undefined"){if(e in f)f[e]=b;c&&e in c&&c[e](e,b)}else return a&&e in a?a[e](e):f[e]}};COG.configurable=function(f,a,c,e){if(f){f.gtConfId||m(f);var b=f.gtConfId,k=f.gtConfig,d=f.gtConfigFns;i[b]=f;d.push(c);for(c=a.length;c--;){k[a[c]]=true;e&&
h(f,a[c])}if(!f.configure)f.configure=function(j,g){if(k[j]){for(var l=d.length;l--;){var q=d[l](j,g);if(typeof q!=="undefined")return q}return i[b]}return null}}}})();
(function(){function h(m,i){var f=m.gtObsHandlers;f[i]||(f[i]=[]);return f[i]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(i,f){var a=COG.objId("callback");h(m,i).unshift({fn:f,id:a});return a};m.trigger=function(i){var f=h(m,i),a={cancel:false,tickCount:(new Date).getTime()},c;if(!f)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var e=f.length;e--&&!a.cancel;)f[e].fn.apply(self,c);return a};m.unbind=
function(i,f){for(var a=h(m,i),c=0;a&&c<a.length;c++)if(a[c].id===f){a.splice(c,1);break}return m}}}}})();(function(){var h={},m=[];COG.addPipe=function(i){i("pipe.test",{});m.push(i)};COG.listen=function(i,f){h[i]||(h[i]=[]);f&&h[i].push(f)};COG.say=function(i,f){var a;for(a=m.length;a--;)m[a](i,f);if(h[i])for(a=h[i].length;a--;)h[i][a](f)}})();
COG.Loopage=function(){function h(g){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function m(g){b.push(g);i()}function i(){k&&clearTimeout(k);k=setTimeout(f,0);j=true}function f(){for(var g,l=(new Date).getTime(),q=e.length;b.length>0;){var w=b.shift();for(g=q;g--;)if(e[g].id===w){e.splice(g,1);break}j=true;q=e.length}if(j){d=a;for(g=q;g--;)d=e[g].frequency<d?e[g].frequency:d}for(g=q;g--;){w=l-e[g].lastTick;if(e[g].lastTick===0||w>=e[g].frequency){e[g].execute(l,
e[g]);e[g].lastTick=l;e[g].single&&e[g].trigger("complete")}}k=q?setTimeout(f,d):0}var a=6E4,c=0,e=[],b=[],k=0,d=a,j=true;return{join:function(g){var l=new h(g);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});e.unshift(l);i();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function h(d){return d<10?"0"+d:d}function m(d){a.lastIndex=0;return a.test(d)?'"'+d.replace(a,function(j){var g=b[j];return typeof g==="string"?g:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function i(d,j){var g,l,q,w,v=c,n,p=j[d];if(p&&typeof p==="object"&&typeof p.toJSON==="function")p=p.toJSON(d);if(typeof k==="function")p=k.call(j,d,p);switch(typeof p){case "string":return m(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";c+=e;n=[];if(Object.prototype.toString.apply(p)==="[object Array]"){w=p.length;for(g=0;g<w;g+=1)n[g]=i(g,p)||"null";q=n.length===0?"[]":c?"[\n"+c+n.join(",\n"+c)+"\n"+v+"]":"["+n.join(",")+"]";c=v;return q}if(k&&typeof k==="object"){w=k.length;for(g=0;g<w;g+=1){l=k[g];if(typeof l==="string")if(q=i(l,p))n.push(m(l)+(c?": ":":")+q)}}else for(l in p)if(Object.hasOwnProperty.call(p,l))if(q=i(l,p))n.push(m(l)+(c?": ":":")+q);q=n.length===0?"{}":c?"{\n"+c+n.join(",\n"+c)+
"\n"+v+"}":"{"+n.join(",")+"}";c=v;return q}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,e,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(d,j,g){var l;e=c="";if(typeof g==="number")for(l=0;l<g;l+=1)e+=" ";else if(typeof g==="string")e=g;if((k=j)&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number"))throw Error("JSON.stringify");return i("",
{"":d})};if(typeof JSON.parse!=="function")JSON.parse=function(d,j){function g(q,w){var v,n,p=q[w];if(p&&typeof p==="object")for(v in p)if(Object.hasOwnProperty.call(p,v)){n=g(p,v);if(n!==undefined)p[v]=n;else delete p[v]}return j.call(q,w,p)}var l;d=String(d);f.lastIndex=0;if(f.test(d))d=d.replace(f,function(q){return"\\u"+("0000"+q.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+d+")");return typeof j==="function"?g({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function h(i,f){var a=i.split("|"),c={};for(var e in f){var b=f[e];c[e]=a.length>b?a[b]:null}return c}var m={JSON:{parse:function(i){return JSON.parse(i)}},PDON:{parse:function(i){var f=null,a=[];i=i.split("\n");for(var c=0;c<i.length;c++){var e=i[c];if(f)a.push(h(e,f));else if(e){f=e.split("|");e={};for(var b=0;b<f.length;b++)e[f[b]]=b;f=e}else f=null}return a}}};COG.parseData=function(i,f){f=f?f.toUpperCase():"JSON";if(!m[f])throw Error("Unsupported data format: "+f);try{return m[f].parse(i)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function h(a){for(var c=null,e=0;e<m.length;e++)if(c=m[e](a))break;return c}var m=[],i=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var f={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var e=null;if(a.resultType>=0&&a.resultType<i.length)e=i[a.resultType];if(e)c=e(a)}return c?c:""}}},first:function(a,c){var e=f.SearchResult,b;var k=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!k)k=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))b=c.evaluate(a,c,h,k,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(d){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);b=null}return new e(b)},registerResolver:function(a){m.push(a)}};return f}();
COG.Storage=function(){function h(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,i){var f=h(i).getItem(m);return/^(\{|\[).*(\}|\])$/.test(f)?JSON.parse(f):f},set:function(m,i,f){i=jQuery.isArray(i)||jQuery.isPlainObject(i)?JSON.stringify(i):i;h(f).setItem(m,i)},remove:function(m,i){h(i).removeItem(m)}}}();
COG.ParseRules=function(){var h=[];return{add:function(m,i){h.push({regex:m,handler:i})},each:function(m,i,f){function a(){c++;f&&c>=h.length&&f(i)}for(var c=0,e=0;e<h.length;e++){var b=h[e].regex,k=h[e].handler,d=false;if(b){b.lastIndex=-1;if((b=b.exec(m))&&k){d=true;k(b,i,a)&&a()}}d||a()}}}};
(function(){function h(b){var k=[],d=function(g,l){l=COG.isFunction(l)?l():l;k[k.length]=encodeURIComponent(g)+"="+encodeURIComponent(l)};if(COG.isArray(b))for(var j=0;j<b.length;j++)d(b[j].name,b[j].value);else for(j in b)d(j,b[j]);return k.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},i={JSON:["json"],PDON:["pdon.txt"]},f=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},e={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function k(){if(this.readyState===4){var l=null,q=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(q)if(b.handleResponse)b.handleResponse(this);else{var w=b,v=this.getResponseHeader(e.CONTENT_TYPE),n,p=false;for(n in m)if(v&&v.indexOf(m[n])>=0){p=true;
break}v=!p;for(p=0;p<f.length;p++)v=v||f[p]==n;if(v)b:{v=n;for(var r in i)for(p=0;p<i[r].length;p++)if(RegExp(i[r][p]+"$","i").test(w.url)){n=r;break b}n=v?v:"DEFAULT"}try{l=c[n](this,w)}catch(x){l=c.DEFAULT(this,w)}}else b.error&&b.error(this)}catch(B){COG.Log.exception(B,"PROCESSING AJAX RESPONSE")}q&&l&&b.success&&b.success.call(this,l)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var d=
a.exec(b.url),j=d&&(d[1]&&d[1]!==location.protocol||d[2]!==location.host);if(b.data)b.method="POST";if(b.url){d=null;if(b.xhr)d=b.xhr(b);d||(d=new XMLHttpRequest);d.open(b.method,b.url,b.async);b.data&&d.setRequestHeader("Content-Type",b.contentType);j||d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.onreadystatechange=k;d.send(b.method=="POST"?h(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function h(a){var c=document.createElement("script"),e=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!e&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){e=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};i||(i=document.getElementsByTagName("head")[0]);i.appendChild(c)}var m=0,i,f=this;COG.jsonp=function(a,c,e){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++m;f[b]=function(k){c(k);f[b]=null;try{delete f[b]}catch(d){}};
h(a+(e?e:"callback")+"="+b);return b}})();
COG.Touch=function(){function h(y,A){return{x:y.x-A.x,y:y.y-A.y}}function m(y,A){var D=h(y,A);return Math.sqrt(D.x*D.x+D.y*D.y)}function i(y){if(y.count>1)return m(y.touches[0],y.touches[1]);return 0}function f(y,A){var D=y&&y.count>0?y.touches[0]:null;if(D&&A&&A.count>0)return h(D,A.touches[0]);return null}function a(y,A){y.count=A.count;for(var D=d;D--;){y.touches[D].x=A.touches[D].x;y.touches[D].y=A.touches[D].y}}function c(){for(var y={count:0,touches:Array(d)},A=d;A--;)y.touches[A]=k();return y}
function e(y){if(y.preventDefault){y.preventDefault();y.stopPropagation()}else y.cancelBubble&&y.cancelBubble()}function b(y,A,D){if(C){A=A[D?D:"touches"];D=A.length;for(D=y.count=D;D--;){y.touches[D].x=A[D].pageX;y.touches[D].y=A[D].pageY}}else if(A.button===0){y.count=1;y.touches[0].x=A.pageX?A.pageX:A.screenX;y.touches[0].y=A.pageY?A.pageY:A.screenY}else y.count=0}function k(y,A){return{x:y?y:0,y:A?A:0}}var d=10,j=120,g=100,l=250,q=300,w=5,v=0,n=1,p=2,r=7,x=0,B=0,C=undefined,R=function(y){function A(u,
t,o,s){var z=Math.asin((u.y-t.y)/o);o=o*(ia/s)>>0;o=o>da?da:o;z=t.x>u.x?z:Math.PI-z;H("pan",Math.cos(z)*-o,Math.sin(z)*o,true)}function D(u,t){var o,s;if(C){o=t-ja;if(o<l){s=m(K.touches[0],u);s>y.inertiaTrigger&&A(K.touches[0],u,s,o)}}else{S.x=u.x;S.y=u.y;COG.Loopage.join({execute:function(z,E){o=z-t;s=m(u,S);if(o<g&&s>y.inertiaTrigger){E.trigger("complete");A(u,S,s,o)}else o>g&&E.trigger("complete")},frequency:10})}}function pa(u){var t=0,o=0;if(u.offsetParent){do{t+=u.offsetLeft;o+=u.offsetTop;
u=u.offsetParent}while(u)}return k(t,o)}function ea(u){var t=u.count,o=Array(t),s=pa(T);for(t=t;t--;)o[t]=k(u.touches[t].x-s.x,u.touches[t].y-s.y);return o}function H(){P&&P.trigger.apply(null,arguments)}function ka(u,t){var o=pa(T);o=k(t.x-o.x,t.y-o.y);H(u,t,o)}function X(u){var t=u.target?u.target:u.srcElement;if(fa||t&&t===T){b(K,u);if(K.count!==0){Z=null;G.x=0;G.y=0;ga=true;la=false;ja=(new Date).getTime();e(u);t.style.cursor="move";H("inertiaCancel");ca=ja;if(u=K.count>0?K.touches[0]:null){H("touchStart",
u.x,u.y);if(ca-$<q)if((u=h(K.touches[0],aa.touches[0]))&&Math.abs(u.x)<y.maxDistDoubleTap&&Math.abs(u.y)<y.maxDistDoubleTap)la=true;U=v;a(aa,K)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function ma(u){var t=u.target?u.target:u.srcElement,o=0;if(fa||t&&t===T){b(M,u);if(M.count>0){S.x=M.touches[0].x;S.y=M.touches[0].y}if(ga){C&&e(u);if(M.count>1){K.count===1&&a(K,M);o=i(K)-i(M)}if(U===v)if((u=f(M,K))&&(Math.abs(u.x)>=r||Math.abs(u.y)>=r))U=n;if(U!==v)if(!o||Math.abs(o)<w){if(Z=
f(M,aa)){G.x-=Z.x;G.y-=Z.y;ba.x-=Z.x;ba.y-=Z.y}H("pan",ba.x,ba.y);ba.x=0;ba.y=0;U=n}else{H("pinchZoom",ea(K),ea(M));U=p}a(aa,M)}}}function V(u){var t=u.target?u.target:u.srcElement;if(ga&&(fa||t&&t===T)){b(na,u,"changedTouches");var o=na.touches[0];C&&e(u);u=(new Date).getTime();$=ca;if(U===v){ka("tap",K.touches[0]);Q||(Q=setTimeout(function(){Q=0;la&&ka("doubleTap",K.touches[0])},q+50))}else if(U==n){H("panEnd",G.x,G.y);ha&&D(o,u)}else U==p&&H("pinchZoomEnd",ea(K),ea(aa),u-ja);t.style.cursor="default";
ga=false}}function W(u){var t=u.target?u.target:u.srcElement;if(fa||t&&t===T){if(u.detail){t=-u.detail*j;t=k(u.axis===1?t:0,u.axis===2?t:0)}else t=k(u.wheelDeltaX,u.wheelDeltaY);var o=t.y!==0?Math.abs(t.y/j):0;if(S&&o!==0){var s=k(S.x-T.offsetLeft,S.y-T.offsetTop);H("wheelZoom",s,Math.pow(2,t.y>0?o:-o))}e(u)}}y=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,
doubleTapHandler:null,wheelZoomHandler:null},y);var la=false,Q=0,J=T5.getConfig(),K=c(),M=c(),aa=c(),na=c(),Z=null,G=k(),ba=k(),U=null,ga=false,ja=0,oa=[],S=k(),ha=false,ia,da,ca=0,$=0,T=y.element,P=y.observable,fa=typeof FlashCanvas!=="undefined",qa={supportsTouch:C,addListeners:function(u){oa.push(u)},decoupleListeners:function(u){for(var t=0;u&&t<oa.length;t++)if(oa[t].listenerId===u){oa.splice(t,1);break}},release:function(){J.unbindEvent(C?"touchstart":"mousedown",X,false);J.unbindEvent(C?"touchmove":
"mousemove",ma,false);J.unbindEvent(C?"touchend":"mouseup",V,false);if(!C){window.removeEventListener("mousewheel",W,false);window.removeEventListener("DOMMouseScroll",W,false)}},inertiaEnable:function(u,t){ha=true;ia=u;da=t?Math.min(t.width,t.height):500},inertiaDisable:function(){ha=false}};if(typeof C==="undefined")C=T5.getConfig().supportsTouch;J.bindEvent(C?"touchstart":"mousedown",X,false);J.bindEvent(C?"touchmove":"mousemove",ma,false);J.bindEvent(C?"touchend":"mouseup",V,false);if(!C){J.bindEvent("mousewheel",
W,window);J.bindEvent("DOMMouseScroll",W,window)}return qa},L=[];return{capture:function(y,A){if(!y)throw Error("Unable to capture touch of null element");if(!y.id)y.id="touchable_"+x++;var D=L[y.id];if(!D){D=new R(COG.extend({element:y},A));L[y.id]=D}if(A){A.listenerId&&D.decoupleListeners(A.listenerId);A.listenerId=++B;D.addListeners(A)}return D},release:function(y){if(y&&y.id&&L[y.id]){L[y.id].release();delete L[y.id]}}}}();
T5=function(){var h=function(){function a(b,k){return e(b.x-k.x,b.y-k.y)}function c(b,k){if(!k)k=b.length;if(k<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var d={edges:Array(k-1),accrued:Array(k-1),total:0},j=0;j<k-1;j++){var g=a(b[j],b[j+1]);d.edges[j]=Math.sqrt(g.x*g.x+g.y*g.y);d.accrued[j]=d.total+d.edges[j];d.total+=d.edges[j]}return d}function e(b,k){return{x:b?b:0,y:k?k:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,k=0,d=arguments.length;d--;){b+=arguments[d].x;k+=arguments[d].y}return e(b,k)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?e(b.x,b.y):null},diff:a,distance:function(b,k){return c(b,k).total},edges:c,equals:function(b,k){return b.x===k.x&&b.y===k.y},extendBy:function(b,k,d){return e(b.x-Math.cos(k)*d,b.y-Math.sin(k)*d)},floor:function(b){for(var k=Array(b.length),d=b.length;d--;)k[d]=e(~~b[d].x,~~b[d].y);return k},getRect:function(b){for(var k,d,j,
g,l=b.length;l--;){var q=b[l];k=typeof k==="undefined"||q.x<k?q.x:k;d=typeof d==="undefined"||q.y<d?q.y:d;j=typeof j==="undefined"||q.x>j?q.x:j;g=typeof g==="undefined"||q.y>g?q.y:g}return i.init(k,d,j,g)},init:e,invert:function(b){return e(-b.x,-b.y)},min:function(b,k){return e(b.x<k.x?b.x:k.x,b.y<k.y?b.y:k.y)},max:function(b,k){return e(b.x>k.x?b.x:k.x,b.y>k.y?b.y:k.y)},offset:function(b,k,d){return e(b.x+k,b.y+(d?d:k))},simplify:function(b,k){if(!b)return null;k=k?k:h.VECTOR_SIMPLIFICATION;for(var d=
[],j=null,g=b.length;g--;){var l=b[g];if(include=!j||g===0||Math.abs(l.x-j.x)+Math.abs(l.y-j.y)>k){d.unshift(l);j=l}}return d},theta:function(b,k,d){d=Math.asin((b.y-k.y)/d);return b.x>k.x?d:Math.PI-d}}}(),m=function(){return{dotProduct:function(a,c){return a.x*c.x+a.y*c.y}}}(),i=function(){function a(e){return c(e.x1,e.y1,e.x2,e.y2)}function c(e,b,k,d){e=e?e:0;b=b?b:0;k=typeof k!=="undefined"?k:e;d=typeof d!=="undefined "?d:d;return{x1:e,y1:b,x2:k,y2:d,width:k-e,height:d-b}}return{center:function(e){return h.init(e.x1+
e.width/2,e.y1+e.height/2)},copy:a,diagonalSize:function(e){return Math.sqrt(e.width*e.width+e.height*e.height)},fromCenter:function(e,b,k,d){k=~~(k/2);d=~~(d/2);return c(e-k,b-d,e+k,b+d)},init:c,intersect:function(e,b){var k=c(Math.max(e.x1,b.x1),Math.max(e.y1,b.y1),Math.min(e.x2,b.x2),Math.min(e.y2,b.y2));return k.width>0&&k.height>0?k:null},union:function(e,b){if(e.width===0||e.height===0)return a(b);else if(b.width===0||b.height===0)return a(e);else{var k=c(Math.min(e.x1,b.x1),Math.min(e.y1,b.y1),
Math.max(e.x2,b.x2),Math.max(e.y2,b.y2));return k.width>0&&k.height>0?k:null}}}}(),f=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return h.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,c){a=a?a:0;return{width:a,height:c?c:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:h,XYRect:i,Vector:function(a,c){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");
return h.init(a,c)},V:COG.extend(h,m),D:f}}();
(function(){function h(){for(;w.length>0;){var n=w.shift();document.location=n}q=0}function m(n){for(var p=true,r=v.length;r--;)p=p&&n!=v[r];return p}function i(n,p){var r=[];for(var x in p)x&&r.push(x+"="+escape(p[x]));return"tile5://"+n+"/"+(r.length>0?"?"+r.join("&"):"")}function f(n,p){m(n)&&COG.Log.info("would push url: "+i(n,p))}function a(n,p){if(m(n)){w.push(i(n,p));q||(q=setTimeout(h,100))}}function c(n){return function(p,r,x){(x?x:n?document.body:document).addEventListener(p,r,false)}}function e(n){return function(p,
r,x){(x?x:n?document.body:document).removeEventListener(p,r,false)}}function b(n,p,r){(r?r:document).attachEvent("on"+n,p)}function k(n,p,r){(r?r:document).detachEvent("on"+n,p)}function d(){j={base:{name:"Unknown",bindEvent:c(),unbindEvent:e(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:f,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:k,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:e(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[j.froyo,j.android,j.ipod,j.iphone,j.ipad,j.ie]}var j=null,g=[],l=null,q=0,w=[],v=["view.wake","tile.loaded"];T5.getConfig=function(){j||d();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var n=0;n<g.length;n++){var p=g[n];if(p.regex&&p.regex.test(navigator.userAgent)){l=T5.ex({},j.base,p);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=j.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var h=[],m={execute:function(i){var f=m.findAction(i);f&&f.execute.apply(f,Array.prototype.slice.call(arguments,1))},findAction:function(i){for(var f=h.length;f--;)if(h[f].id==i)return h[f];return null},getRegisteredActions:function(){return[].concat(h)},getRegisteredActionIds:function(){for(var i=[],f=h.length;f--;)h[f].id&&i.push(h[f].id);return i},registerAction:function(i){i&&i.id&&h.push(i)},Action:function(i){i=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},i);var f={id:i.id,execute:function(){i.execute&&i.execute.apply(this,arguments)},getParam:function(a){return i[a]?i[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",f.id,i.title,i.icon)}};i.autoRegister&&m.registerAction(f);return f},Agent:function(i){i=COG.extend({name:"Untitled",translator:null,execute:null},i);var f={getName:function(){return i.name},getParam:function(a){return i[a]},getId:function(){return COG.toID(f.getName())},run:function(a,c){if(i.execute){var e=
i.translator?i.translator(a):a;i.execute.call(f,e,function(b,k){c&&c(b,k,e)})}}};return f},runAgents:function(i,f,a){for(var c=0;c<i.length;c++)i[c].run(f,a)}};return m}();
T5.Resources=function(){var h="",m={},i={getPath:function(f){return/^(file|https?|\/)/.test(f)?f:h+f},setBasePath:function(f){h=f},loadResource:function(f){f=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},f);var a=function(c){f.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){f.callback(c)})};f.cacheable&&m[f.filename]?a(m[f.filename]):COG.xhr({url:i.getPath(f.filename),dataType:f.dataType,success:function(c){if(f.cacheable)m[f.filename]=c;a(c)},error:function(c,e,b){COG.Log.error("error loading resource ["+
f.filename+"], error = "+b)}})},loadSnippet:function(f,a){/\.\w+$/.test(f)||(f+=".html");i.loadResource({filename:"snippets/"+f,callback:a,dataType:"html"})}};return i}();
T5.Images=function(){function h(){if(!q){var n=T5.getConfig().maxImageLoads;q=COG.Loopage.join({execute:function(p,r){if(!n||j.length<n){var x=d.shift();if(x){j[j.length]=x;x.image.onload=i;x.image.src=T5.Resources.getPath(x.url);x.requested=T5.ticks()}else r.trigger("complete")}},frequency:10});q.bind("complete",function(){q=null})}}function m(){w=true;try{var n=g.length/2>>0;if(n>0){g.sort(function(r,x){return r.created-x.created});for(var p=n;p--;)delete c[g[p].url];g.splice(0,n)}}finally{w=false}COG.say("imagecache.cleared")}
function i(){var n=b[this.id],p;if(n&&n.image.complete&&n.image.width>0){n.loaded=true;n.hitCount=1;for(p=j.length;p--;)if(j[p].image.src==this.src){j.splice(p,1);break}if(n.background||n.postProcess||n.drawBackground||n.customDraw)if(n.image){globalImageData=n;p=a(n.realSize?n.realSize.width:n.image.width,n.realSize?n.realSize.height:n.image.height);var r=p.getContext("2d"),x=n.offset?n.offset:T5.XY.init();n.background&&r.drawImage(n.background,0,0);n.drawBackground&&n.drawBackground(r);n.customDraw?
n.customDraw(r,n):r.drawImage(n.image,x.x,x.y);n.postProcess&&n.postProcess(r,n);n.image=p}for(p=n.callbacks.length;p--;)n.callbacks[p]&&n.callbacks[p](this,false);n.callbacks=[];g[g.length]={url:this.src,created:n.requested};delete b[this.id];h()}}function f(n,p,r){var x=c[n];if(x){x.hitCount++;x.image.complete&&x.image.width>0&&p?p(x.image,true):x.callbacks.push(p)}else{x=T5.ex({url:n,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[p]},r);x.image.id="resourceLoaderImage"+
k++;c[n]=x;b[x.image.id]=x;d[d.length]=x;h()}return x}function a(n,p){var r=document.createElement("canvas");r.width=n?n:0;r.height=p?p:0;if(typeof FlashCanvas!=="undefined"){r.id="tmpCanvas"+e++;r.style.cssText="position: absolute; top: -"+(p-1)+"px; left: -"+(n-1)+"px;";document.body.appendChild(r);FlashCanvas.initElement(r)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(r);return r}var c={},e=0,b={},k=0,d=[],j=[],g=[],l=0,q=null,w=false,v={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){j=[]},get:function(n,p,r){var x=null,B=null;w||(x=c[n]);if((B=x?x.image:null)&&(B.getContext||B.complete&&B.width>0))return B;else p&&f(n,p,r);return null},load:f,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:j.length,queuedImageCount:d.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(n){for(var p=false,r=0,x=T5.getConfig();r<j.length;)if(n-j[r].requested>v.loadTimeout*1E3){j.splice(r,1);p=true}else r++;p&&h();if(x&&x.imageCacheMaxSize){l=
g.length*v.avgImageSize/x.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return v}();T5.Generator=function(){var h={};return{init:function(m,i){var f=h[m];if(!f)throw Error("Unable to locate requested generator: "+m);return new f(i)},register:function(m,i){h[m]=i},Template:function(){}}}();
T5.TimeLord=function(){var h=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,i=function(a,c){return{days:a?a:0,seconds:c?c:0}},f={8601:function(a){a=a.split("T");var c=null;c=null;var e=0,b=0;h.lastIndex=-1;c=h.exec(a[0]);e+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(a[1]);b+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;b+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;b+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new i(e,b)}};return{Duration:i,addDuration:function(){for(var a=new i,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var e=c?f[c]:null;if(e)return e(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new i},formatDuration:function(a){var c,e,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){e=Math.round(a/60);a-=e*60}if(c)b=b+c+(c>1?" hrs ":" hr ")+
(e?(e>10?e:"0"+e)+" min ":"");else if(e)b=b+e+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
T5.zoomable=function(h,m){function i(a,c){if(a&&f!==a){f=a;h.triggerAll("zoomLevelChange",f,c)}}m=T5.ex({initial:0,min:0,max:null,zoomAnimation:T5.easing("quad.out")},m);var f=m.initial;T5.ex(h,{getZoomLevel:function(){return f},setZoomLevel:i,zoomIn:function(){h.scale(2,T5.easing("sine.out"))||h.setZoomLevel(f+1)},zoomOut:function(){h.scale(0.5,T5.easing("sine.out"))||h.setZoomLevel(f-1)}});h.bind("scale",function(a,c,e){a=0;c=Math.sqrt(c);if(c<1)a=-(0.5/c);else if(c>1)a=c;T5.cancelAnimation(function(b){return b.cancelOnInteract});
i(f+a>>0,e)});h.bind("doubleTap",function(a,c,e){if(h.scalable()){T5.cancelAnimation(function(b){return b.cancelOnInteract});h.animate(2,T5.D.getCenter(h.getDimensions()),T5.XY.init(e.x,e.y),m.zoomAnimation)}})};
(function(){var h=Math.PI*2,m=Math.PI/2,i=Math.abs,f=Math.pow,a=Math.sin,c=Math.asin,e=Math.cos,b=1.70158,k={linear:function(d,j,g,l){return g*d/l+j},backin:function(d,j,g,l){return g*(d/=l)*d*((b+1)*d-b)+j},backout:function(d,j,g,l){return g*((d=d/l-1)*d*((b+1)*d+b)+1)+j},backinout:function(d,j,g,l){return(d/=l/2)<1?g/2*d*d*(((b*=1.525)+1)*d-b)+j:g/2*((d-=2)*d*(((b*=1.525)+1)*d+b)+2)+j},bouncein:function(d,j,g,l){return g-k.bounceout(l-d,0,g,l)+j},bounceout:function(d,j,g,l){return(d/=l)<1/2.75?
g*7.5625*d*d+j:d<2/2.75?g*(7.5625*(d-=1.5/2.75)*d+0.75)+j:d<2.5/2.75?g*(7.5625*(d-=2.25/2.75)*d+0.9375)+j:g*(7.5625*(d-=2.625/2.75)*d+0.984375)+j},bounceinout:function(d,j,g,l){return d<l/2?k.bouncein(d*2,0,g,l)/2+j:k.bounceout(d*2-l,0,g,l)/2+g/2+j},cubicin:function(d,j,g,l){return g*(d/=l)*d*d+j},cubicout:function(d,j,g,l){return g*((d=d/l-1)*d*d+1)+j},cubicinout:function(d,j,g,l){if((d/=l/2)<1)return g/2*d*d*d+j;return g/2*((d-=2)*d*d+2)+j},elasticin:function(d,j,g,l,q,w){if(d==0)return j;if((d/=
l)==1)return j+g;w||(w=l*0.3);if(!q||q<i(g)){q=g;g=w/4}else g=w/h*c(g/q);return-(q*f(2,10*(d-=1))*a((d*l-g)*h/w))+j},elasticout:function(d,j,g,l,q,w){var v;if(d==0)return j;if((d/=l)==1)return j+g;w||(w=l*0.3);if(!q||q<i(g)){q=g;v=w/4}else v=w/h*c(g/q);return q*f(2,-10*d)*a((d*l-v)*h/w)+g+j},elasticinout:function(d,j,g,l,q,w){var v;if(d==0)return j;if((d/=l/2)==2)return j+g;w||(w=l*0.3*1.5);if(!q||q<i(g)){q=g;v=w/4}else v=w/h*c(g/q);if(d<1)return-0.5*q*f(2,10*(d-=1))*a((d*l-v)*h/w)+j;return q*f(2,
-10*(d-=1))*a((d*l-v)*h/w)*0.5+g+j},quadin:function(d,j,g,l){return g*(d/=l)*d+j},quadout:function(d,j,g,l){return-g*(d/=l)*(d-2)+j},quadinout:function(d,j,g,l){if((d/=l/2)<1)return g/2*d*d+j;return-g/2*(--d*(d-2)-1)+j},sinein:function(d,j,g,l){return-g*e(d/l*m)+g+j},sineout:function(d,j,g,l){return g*a(d/l*m)+j},sineinout:function(d,j,g,l){return-g/2*(e(Math.PI*d/l)-1)+j}};T5.easing=function(d){return k[d.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(d,j){k[d.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=j}})();
T5.Tween=function(h){h=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},h);var m=T5.ticks(),i=[],f=false,a=0,c=0,e={cancelOnInteract:h.cancelOnInteract,isComplete:function(){return f},triggerComplete:function(b){h.complete&&h.complete(b)},update:function(b){try{var k=h.tweenFn(b-m,a,c,h.duration);if(h.target)h.target[h.property]=k;for(var d=i.length;d--;)i[d](k,void 0);if(f=m+h.duration<=b){if(h.target)h.target[h.property]=
h.tweenFn(h.duration,a,c,h.duration);for(var j=i.length;j--;)i[j](k,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(b){i.push(b)}};a=h.target&&h.property&&h.target[h.property]?h.target[h.property]:h.startValue;if(typeof h.endValue!=="undefined")c=h.endValue-a;if(c==0)f=true;T5.wakeTweens();return e};
(function(){function h(a){if(f)return m.length;f=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(a);c++}}finally{f=false}m.length===0&&i.trigger("complete");return m.length}var m=[],i=null,f=false;T5.tweenValue=function(a,c,e,b,k){a=new T5.Tween({startValue:a,endValue:c,tweenFn:e,complete:b,duration:k});m.push(a);return a};T5.tween=function(a,c,e,b,k,d){a=new T5.Tween({target:a,property:c,endValue:e,tweenFn:b,duration:d,complete:k});
m.push(a);return a};T5.tweenVector=function(a,c,e,b,k,d){var j=[];if(a){var g=a.x==c,l=a.y==e;g||j.push(T5.tween(a,"x",c,b,function(){(g=true)&&l&&k()},d));l||j.push(T5.tween(a,"y",e,b,function(){l=true;g&&l&&k()},d))}return j};T5.cancelAnimation=function(a){if(!f){f=true;try{for(var c=0;c<m.length;)if(!a||a(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{f=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!i){i=COG.Loopage.join({execute:h,frequency:20});
i.bind("complete",function(){i=null})}}})();(function(){var h={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,i=arguments.length;i--;){var f=h[arguments[i].toUpperCase()];if(f)m|=f}return m}})();
T5.ViewLayer=function(h){h=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},h);var m=null,i=false,f=false,a=h.supportFastDraw,c=h.id,e=T5.viewState("ACTIVE"),b=h.validStates,k=0,d=0,j=T5.ex({addToView:function(g){g.setLayer(c,j)},shouldDraw:function(g,l,q){return(f||q||k!==l.x1||d!==l.y1)&&(g&b)!==0&&(i?a:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){j.trigger("remove",
j)},changed:function(g){f=true;j.trigger("changed",j);m&&m.trigger("invalidate",g)},getId:function(){return c},setId:function(g){c=g},getParent:function(){return m},setParent:function(g){i=(m=g)?m.fastDraw&&displayState!==e:false;j.trigger("parentChange",m)}},h);COG.observable(j);j.bind("drawComplete",function(g,l){f=false;k=l.x1;d=l.y1});j.bind("resync",function(g,l){if(l.syncXY){j.minXY&&l.syncXY(j.minXY);j.maxXY&&l.syncXY(j.maxXY)}});return j};
T5.View=function(h){function m(o,s,z,E){P=ca;n();if(E&&h.inertia){V=true;d(R+s,L+z,h.panAnimationEasing,h.panAnimationDuration)}else E||d(R+s,L+z)}function i(){P=da;V=false;COG.Loopage.join({execute:n,after:50,single:true})}function f(o,s){var z=fa(o);u(z);var E=qa(z),F=fa(s),I=u(F);F=qa(F);X=T5.XY.offset(I,A.x1,A.y1);G=z&&E!==0?F/E:1}function a(o,s,z){f(s,z);if(M=G!==1){P=$;n()}}function c(o,s,z){f(s,z);if(h.adjustScaleFactor){G=h.adjustScaleFactor(G);COG.Log.info("scale factor adjusted to: "+G)}b();
G=1}function e(o,s,z){t.zoom(s,Math.min(Math.pow(2,Math.round(Math.log(z))),8),500)}function b(){var o=T5.XY.init(ha,ia);G=Math.round(G*10)/10;M=false;for(var s=r.length;s--;)r[s].trigger("scale",G,o);t.trigger("scale",G,o);P=da;n()}function k(){clearTimeout(Z);Z=setTimeout(j,50)}function d(o,s,z,E,F){function I(){O+=1;if(O>=2){i(0,0);F&&F()}}var O=0;if(Q){o=o<Q.x?Q.x:o;s=s<Q.y?Q.y:s}if(J){o=o>J.x?J.x:o;s=s>J.y?J.y:s}if(z){o=T5.tweenValue(R,o,z,I,E);s=T5.tweenValue(L,s,z,I,E);o.cancelOnInteract=true;
o.requestUpdates(function(N){R=N;V=true;n()});s.cancelOnInteract=true;s.requestUpdates(function(N){L=N;V=true;n()})}else{R=o;L=s}}function j(){var o;if(B){COG.Touch.release(B);if(h.autoSize&&B.parentNode){o=B.parentNode.getBoundingClientRect();if(o.height!==0&&o.width!==0){B.height=o.height;B.width=o.width}}try{if(!B.id)B.id=h.id+"_canvas";C=B.getContext("2d")}catch(s){COG.Log.exception(s);throw Error("Could not initialise canvas on specified view element");}S=COG.Touch.capture(B,{observable:t});
if(H.height!==B.height||H.width!==B.width){H=T5.D.init(B.width,B.height);t.trigger("resize",B.width,B.height);for(o=x;o--;)r[o].trigger("resize",B.width,B.height)}h.inertia&&S.inertiaEnable(h.panAnimationDuration,H);for(o=x;o--;)r[o].trigger("contextChanged",C);n()}}function g(o,s){s.setId(o);s.added=T5.ticks();s.bind("remove",function(){t.removeLayer(o)});s.trigger("contextChanged",C);s.setParent(t);r.push(s);r.sort(function(z,E){var F=E.zindex-z.zindex;if(F===0)F=E.added-z.added;return F});x=r.length;
return s}function l(o,s,z,E,F,I,O){function N(){I&&I();b();G=1;ga=null}M=true;X=T5.XY.offset(E,A.x1,A.y1);if(F)T5.tweenValue(0,s-o,F,N,O?O:1E3).requestUpdates(function(Y){ga=Y/(s-o);G=o+Y;P=$;n();t.trigger("animate")});else{G=s;N()}}function q(){p("idle",t);ma=true;W=0}function w(o,s,z,E){var F=false,I=(o&$)!==0,O=T5.XYRect.copy(s),N,Y=0;z&&C.clearRect(0,0,B.width,B.height);C.save();try{U=G;C.globalCompositeOperation="source-over";if(I){I=1/G;var ra=(I-0.5)*2,ua=O.width*I>>0,va=O.height*I>>0,wa=X.y-
L;ha=X.x-(X.x-R)*ra>>0;ia=X.y-wa*ra>>0;O=T5.XYRect.fromCenter(ha,ia,ua,va);C.scale(G,G)}C.translate(-O.x1,-O.y1);J=Q=null;C.beginPath();for(Y=x;Y--;)if(r[Y].clip){r[Y].clip(C,O,o,t,z,E);F=true}C.closePath();F&&C.clip();for(Y=x;Y--;){N=r[Y];var sa=N.style,ta=sa?T5.Style.apply(C,sa):null;if(N.minXY)Q=Q?T5.XY.min(Q,N.minXY):T5.XY.copy(N.minXY);if(N.maxXY)J=J?T5.XY.max(J,N.maxXY):T5.XY.copy(N.maxXY);N.draw(C,O,o,t,z,E);ta&&T5.Style.apply(C,ta);N.trigger("drawComplete",O,E)}}finally{C.restore()}if(pa){C.globalCompositeOperation=
"source-over";C.strokeStyle="#f00";C.beginPath();C.moveTo(B.width/2,0);C.lineTo(B.width/2,B.height);C.moveTo(0,B.height/2);C.lineTo(B.width,B.height/2);C.stroke()}t.trigger("drawComplete",s,E);COG.Log.trace("draw complete",E)}function v(o,s){var z=false,E=aa?aa:V?ca:P,F=!V&&(E===$||E===ca),I=na||E===ca||E===$||T5.isTweening();y=T5.XY.init(R>>0,L>>0);A=T5.XYRect.fromCenter(y.x,y.y,H.width,H.height);if(F){T5.cancelAnimation(function(O){return O.cancelOnInteract});ma=false;if(W!==0){clearTimeout(W);
W=0}}for(F=x;F--;){if(r[F].animated)P|=T;r[F].cycle(o,A,P,I);z=r[F].shouldDraw(P,A,I)||z}I=I||(P&T)!==0;if(z=z||I||G!==1&&G!==ba){w(E,A,I,o);ba=G;na=false}if(!z&&ka===0&&!ja){if(!ma&&W===0)W=setTimeout(q,500);s.trigger("complete")}ka=0;COG.Log.trace("Completed draw cycle",o)}function n(o){na=o?true:false;ka+=1;if(!D){D=COG.Loopage.join({execute:v,frequency:oa});D.bind("complete",function(){D=null})}}function p(){t.trigger.apply(null,arguments);for(var o=r.length;o--;)r[o].trigger.apply(null,arguments)}
h=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},h);var r=[],x=0,B=document.getElementById(h.container),C=null,R=0,L=0,y=null,A=null,D=null,pa=h.guides,ea=1,H=T5.D.init(),ka=0,X=null,ma=false,V=false,W=0,la=0,Q=null,J=null,K=0,M=false,aa=null,na=false,Z=0,G=1,ba=0,U=1,ga=null,
ja=typeof FlashCanvas!=="undefined",oa=~~(1E3/h.fps),S=null,ha,ia,da=T5.viewState("ACTIVE"),ca=T5.viewState("PAN"),$=T5.viewState("ZOOM"),T=T5.viewState("ANIMATING"),P=da,fa=T5.XY.getRect,qa=T5.XYRect.diagonalSize,u=T5.XYRect.center,t={id:h.id,deviceScaling:ea,fastDraw:h.fastDraw||T5.getConfig().requireFastDraw,animate:function(o,s,z,E,F){l(G,o,s,z,E,F)},centerOn:function(o){R=o.x-B.width/2;L=o.y-B.height/2},getDimensions:function(){return H},getLayer:function(o){for(var s=0;s<x;s++)if(r[s].getId()==
o)return r[s];return null},setLayer:function(o,s){for(var z=0;z<x;z++)if(r[z].getId()===o){r.splice(z,1);break}s&&g(o,s);n();return s},eachLayer:function(o){for(var s=x;s--;)o(r[s])},invalidate:n,resize:function(o,s){if(B){h.autoSize=false;B.width=o;B.height=s;j();t.trigger("resize",B.width,B.height)}},scale:function(o,s,z,E,F){E||(E=T5.D.getCenter(H));F||(F=T5.D.getCenter(H));t.animate(o,E,F,s,z);return t},triggerAll:p,removeLayer:function(o){a:{for(var s=x;s--;)if(r[s].getId()==o){o=s;break a}o=
-1}if(o>=0&&o<x){COG.say("layer.removed",{layer:r[o]});r.splice(o,1);n()}x=r.length},stateOverride:function(o){aa=o},getOffset:function(){return y?y:T5.XY.init(R,L)},getViewRect:function(){return A?A:T5.XYRect.fromCenter(R,L,H.width,H.height)},updateOffset:d,pan:function(o,s,z,E,F){d(R+o,L+s,z,E,F)},zoom:function(o,s,z){V=false;G=s;M=G!==1;X=T5.XY.offset(G>1?T5.XY.copy(o):T5.D.getCenter(H),A.x1,A.y1);clearTimeout(la);if(M){P=$;n();if(z)la=setTimeout(function(){b();G=1},parseInt(z,10))}}};ea=T5.getConfig().getScaling();
t.markers=g("markers",new T5.MarkerLayer);COG.observable(t);t.bind("invalidate",function(o,s){n(s)});if(h.pannable){t.bind("pan",m);t.bind("panEnd",i);t.bind("inertiaCancel",function(){V=false;n()})}if(h.scalable){t.bind("pinchZoom",a);t.bind("pinchZoomEnd",c);t.bind("wheelZoom",e)}t.bind("tap",function(o,s,z){for(var E=T5.XY.offset(z,R,L),F=r.length;F--;)o.cancel=o.cancel||r[F].trigger("tap",s,z,E).cancel});t.bind("resync",function(){J=Q=null});COG.configurable(t,["inertia","container","rotation",
"tapExtent","scalable","pannable"],COG.paramTweaker(h,null,{container:function(o,s){B=document.getElementById(s);j()},rotation:function(o,s){K=s}}),true);j();h.autoSize&&window.addEventListener("resize",k,false);return t};
T5.PathLayer=function(h){h=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},h);var m=false,i=[],f=null,a=[],c=null,e=0,b=[],k=T5.ex(new T5.ViewLayer(h),{getAnimation:function(d,j,g,l){var q="pathAnimation"+e++;b.push(q);return new T5.AnimatedPathLayer({id:q,path:i,zindex:h.zindex+1,easing:d?d:T5.easing("sine.inout"),duration:j?j:5E3,drawIndicator:g,autoCenter:l?l:false})},cycle:function(d,j,g,l){return l},draw:function(d){var j,g=i.length;d.save();try{T5.Style.apply(d,h.style);if(g>0){d.beginPath();
d.moveTo(i[g-1].x,i[g-1].y);for(j=g;j--;)d.lineTo(i[j].x,i[j].y);d.stroke();if(f){d.fillStyle=h.waypointFillStyle;for(j=f.length;j--;){d.beginPath();d.arc(f[j].x,f[j].y,2,0,Math.PI*2,false);d.stroke();d.fill()}}}}finally{d.restore()}m=false},updateCoordinates:function(d,j){a=d;c=j;var g=k.getParent();if(g&&g.syncXY){g.syncXY(a);c&&g.syncXY(c);k.trigger("tidy")}}});k.bind("tidy",function(){i=T5.XY.simplify(a,h.pixelGeneralization);f=T5.XY.simplify(c,h.pixelGeneralization);m=true;k.changed()});return k};
T5.ShapeLayer=function(h){function m(c){for(var e=f.length;e--;)f[e].resync(c);f.sort(function(b,k){var d=k.xy.y-b.xy.y;if(d===0)d=k.xy.x-b.xy.y;return d});a.changed()}function i(c,e){e.syncXY&&m(e)}h=T5.ex({zindex:80},h);var f=[],a=T5.ex(new T5.ViewLayer(h),{add:function(c){f[f.length]=c},each:function(c){for(var e=f.length;e--;)c(f[e])},draw:function(c,e,b){var k=e.x1,d=e.y1,j=e.width;e=e.height;for(var g=f.length;g--;){var l=f[g].style;l=l?T5.Style.apply(c,l):null;f[g].draw(c,k,d,j,e,b);l&&T5.Style.apply(c,
l)}}});a.bind("parentChange",i);a.bind("resync",i);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(h){h=T5.ex({style:null,properties:{}},h);return T5.ex(h,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(h,m){m=T5.ex({size:4},m);var i=T5.XY.init(),f=T5.ex(m,{draw:function(a){a.beginPath();a.arc(i.x,i.y,f.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([h]);i=T5.XY.floor([h])[0]}});COG.Log.info("created arc = ",h);return f};
T5.Poly=function(h,m){m=T5.ex({fill:false,simplify:false},m);var i=false,f=m.fill,a=m.simplify,c=T5.viewState("ZOOM"),e=[],b=T5.ex(new T5.Shape(m),{draw:function(k,d,j,g,l,q){if(i){d=true;j=(q&c)!==0;k.beginPath();for(q=e.length;q--;){j=e[q].x;g=e[q].y;if(d){k.moveTo(j,g);d=false}else k.lineTo(j,g);j=true}if(j){f&&k.fill();k.stroke()}}},resync:function(k){b.xy=k.syncXY(h);e=T5.XY.floor(a?T5.XY.simplify(h):h)}});i=h&&h.length>=2;return b};
T5.AnimatedPathLayer=function(h){function m(b,k,d){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(d.x,d.y,4,0,Math.PI*2,false);b.stroke();b.fill()}h=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},h);var i=T5.XY.edges(h.path),f,a=null,c=0;T5.tweenValue(0,i.total,h.easing,function(){e.remove()},h.duration).requestUpdates(function(b,k){c=b;k&&e.remove()});var e=
T5.ex(new T5.ViewLayer(h),{cycle:function(){for(var b=0;b<i.accrued.length&&i.accrued[b]<c;)b++;a=null;if(b<h.path.length-1){var k=c-(b>0?i.accrued[b-1]:0),d=h.path[b];f=T5.XY.theta(d,h.path[b+1],i.edges[b]);a=T5.XY.extendBy(d,f,k);if(h.autoCenter)(b=e.getParent())&&b.centerOn(a)}return a},draw:function(b,k){if(a)(h.drawIndicator?h.drawIndicator:m)(b,k,T5.XY.init(a.x,a.y),f)}});return e};
T5.Marker=function(h){function m(k,d,j,g){f=k;a=d;c=j;e=g}h=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},h);var i=false,f=0,a=0,c=0,e=0,b=T5.ex(h,{isNew:true,isAnimating:function(){return i},draw:function(k,d,j,g,l){if(b.isNew&&h.tweenIn){var q=b.xy.y;b.xy.y=d.y1-20;i=true;T5.tween(b.xy,"y",q,h.tweenIn,function(){b.xy.y=q;i=false},h.animationSpeed?h.animationSpeed:250+Math.random()*500)}b.drawMarker(k,d,b.xy.x,b.xy.y,j,g,l);b.isNew=false},drawMarker:function(k,d,j,g){k.beginPath();
k.arc(j,g,4,0,Math.PI*2,false);k.fill();m(j-4,g-4,8,8)},hitTest:function(k,d){return k>=f&&k<=f+c&&d>=a&&d<=a+e},updateBounds:m});COG.observable(b);return b};
T5.ImageMarker=function(h){h=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},h);var m=h.imageAnchor?T5.XY.invert(h.imageAnchor):null,i=T5.ex(new T5.Marker(h),{drawMarker:function(f,a,c,e){if((a=i.isAnimating()&&i.animatingImage?i.animatingImage:i.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var b=i.scale,k=c+~~(m.x*b),d=e+~~(m.y*b),j=~~(a.width*b),g=~~(a.height*b);i.updateBounds(k,d,j,j);if(i.rotation||
i.opacity!==1){f.save();try{f.globalAlpha=i.opacity;f.translate(c,e);f.rotate(i.rotation);f.drawImage(a,m.x*b,m.y*b,j,g)}finally{f.restore()}}else f.drawImage(a,k,d,j,g)}}});if(!i.image)i.image=T5.Images.get(h.imageUrl,function(f){COG.Log.info("updating marker image to: "+f.src);i.image=f});if(!i.animatingImage)i.animatingImage=T5.Images.get(h.animatingImageUrl,function(f){i.animatingImage=f});return i};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(h){function m(){a.changed();a.trigger("markerUpdate",f)}function i(){var c=a.getParent();if(c&&c.syncXY)for(var e=f.length;e--;)c.syncXY([f[e].xy])}h=T5.ex({zindex:100,style:"basic"},h);var f=[],a=T5.ex(new T5.ViewLayer(h),{draw:function(c,e,b,k){for(var d=f.length;d--;)f[d].draw(c,e,b,a,k)},add:function(c){if(c&&typeof c.length!=="undefined")for(var e=c.length;e--;){if(c[e])f[f.length]=c[e]}else if(c)f[f.length]=c;m()},clear:function(c){if(c)for(var e=0;e<f.length;e++)c(f[e])&&
f.splice(e,1);else f=[];m()},find:function(c){for(var e=[],b=f.length;b--;)if(!c||c(f[b]))e[e.length]=f[b];return e}});a.bind("tap",function(c,e,b){for(var k=[],d=b.x,j=b.y,g=f.length;g--;)if(f[g].hitTest(d,j))k[k.length]=f[g];if(k.length>0)c.cancel=a.trigger("markerTap",e,b,k).cancel});a.bind("parentChange",i);a.bind("resync",i);a.bind("changed",i);return a};
T5.ImageLayer=function(h,m){function i(g,l,q){if(e)for(var w=e.length;w--;){var v=e[w],n=v.x,p=v.y,r=T5.XYRect.init(v.x,v.y,v.x+v.width,v.y+v.height);if(q&&T5.XYRect.intersect(g,r)){r=T5.Images.get(v.url,(l&d)===0?a:null,k);q(r,n,p,v.width,v.height)}}}function f(g){c&&c.run(g,function(l){e=l;j.changed()})}function a(){j.changed()}m=T5.ex({imageLoadArgs:{}},m);var c=h?T5.Generator.init(h,m):null,e=null,b=T5.XYRect.init(),k=m.imageLoadArgs,d=T5.viewState("ZOOM"),j=T5.ex(new T5.ViewLayer(m),{changeGenerator:function(g,
l){c=T5.Generator.init(g,T5.ex({},m,l));c.bindToView(j.getParent());e=null;f(b)},clip:function(g,l,q){i(l,q,function(w,v,n,p,r){w&&g.rect(v,n,p,r)})},cycle:function(g,l){f(l)},draw:function(g,l,q){i(l,q,function(w,v,n,p,r){j.drawImage(g,w,v,n,p,r,l,q)});b=T5.XYRect.copy(l)},drawImage:function(g,l,q,w){l&&g.drawImage(l,q,w,l.width,l.height)}});j.bind("idle",function(){f(b)});j.bind("parentChange",function(g,l){c&&c.bindToView(l)});j.bind("tap",function(g,l,q,w){g=[];var v=w.x,n=w.y,p,r;if(e)for(var x=
e.length;x--;){p=e[x];if(r=v>=p.x&&v<=p.x+p.width&&n>=p.y&&n<=p.y+p.height)g[g.length]=p}g.length>0&&j.trigger("tapImage",g,l,q,w)});return j};
T5.Style=function(){function h(e,b){a[e]=i(b);return e}function m(e){for(var b in e)h(b,e[b])}function i(e){function b(g){var l=e[g];typeof l!=="undefined"&&d.push(function(q){q[g]=l})}function k(){d=[];for(var g in e)b(g)}e=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},e);var d=[],j={applyToContext:function(g){for(var l=d.length;l--;)d[l](g)},update:function(g,
l){e[g]=l;k()}};k();return j}var f={},a={},c={apply:function(e,b){var k=a[b]?a[b]:a.basic,d;if(e&&e.canvas){d=f[e.canvas.id];f[e.canvas.id]=b}k.applyToContext(e);return d},define:h,defineMany:m,get:function(e){return a[e]},init:i,load:function(e){COG.jsonp(e,function(b){T5.resetStyles(b)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return c}();
T5.Tiling=function(){return{tileSize:256,init:function(h,m,i,f,a){return T5.ex({x:h,y:m,width:i,height:f},a)}}}();
T5.TileGenerator=function(h){function m(q,w,v,n){function p(){if(l.initTileCreator){e=true;l.initTileCreator(q,w,v,n)}}l.prepTileCreator?l.prepTileCreator(q,w,v,p):p()}function i(q,w){for(var v=~~((q.x1-c.x)/b),n=~~((q.y1-c.y)/k),p=[],r=-j;r<j;r++)for(var x=-g;x<g;x++){var B=d(v+r,n+x);if(B)p[p.length]=B}w&&w(p);a=T5.XYRect.copy(q)}h=T5.ex({tileWidth:256,tileHeight:256},h);var f=null,a=null,c=T5.XY.init(),e=false,b=h.tileWidth,k=h.tileHeight,d=null,j=0,g=0,l={bindToView:function(q){COG.Log.info("initializing generator");
f=q;l.trigger("bindView",q)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){d=null;e=false;a=null},run:function(q,w){if(!a||Math.abs(q.x1-a.x1)>b||Math.abs(q.y1-a.y1)>k){if(!d&&!e||l.requireRefresh()){c=T5.XY.init(q.x1,q.y1);j=Math.ceil(q.width/b)+1;g=Math.ceil(q.height/k)+1;m(b,k,l.getTileCreatorArgs?l.getTileCreatorArgs(f):{},function(v){d=v;e=false;i(q,w)})}d&&i(q,w)}}};COG.observable(l);l.bind("update",function(){COG.Log.info("captured generator update");
a=null});return l};
