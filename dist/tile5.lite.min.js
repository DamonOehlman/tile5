COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var K=arguments[0]||{},Z,D=1,w=arguments.length;D<w;D++)if((Z=arguments[D])!==null)for(var j in Z){var l=Z[j];if(K!==l)if(l!==undefined)K[j]=l}return K};
(function(){var K=Object.prototype.hasOwnProperty,Z=0,D={};D.toID=function(w){return w.replace(/\s/g,"-")};D.objId=function(w){return(w?w:"obj")+Z++};D.isFunction=function(w){return toString.call(w)==="[object Function]"};D.isArray=function(w){return toString.call(w)==="[object Array]"};D.isPlainObject=function(w){if(!w||toString.call(w)!=="[object Object]"||w.nodeType||w.setInterval)return false;if(w.constructor&&!K.call(w,"constructor")&&!K.call(w.constructor.prototype,"isPrototypeOf"))return false;
var j;for(j in w);return j===undefined||K.call(w,j)};D.isEmptyObject=function(w){for(var j in w)return false;return true};D.isXmlDocument=function(w){return toString.call(w)==="[object Document]"};D.contains=function(w,j){var l=w,x=arguments,A=1;if(j&&module.isArray(j)){x=j;A=0}for(A=A;A<x;A++)l=l&&typeof foo[x[A]]!=="undefined";return l};D.formatStr=function(w){if(arguments.length<=1)return w;for(var j=arguments.length-2,l=0;l<=j;l++)w=w.replace(RegExp("\\{"+l+"\\}","gi"),arguments[l+1]);return w};
D.wordExists=function(w,j){var l="";if(j.toString)j=j.toString();for(var x=0;x<j.length;x++)l+=!/\w/.test(j[x])?"\\"+j[x]:j[x];return RegExp("(^|\\s|\\,)"+l+"(\\,|\\s|$)","i").test(w)};COG.extend(COG,D)})();
(function(){function K(l){return typeof console!=="undefined"?function(){console[l](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var Z=window.console&&window.console.markTimeline,D=K("error"),w=K("info"),j=function(){return Z?function(l,x){console.markTimeline(l+(x?": "+((new Date).getTime()-x)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:K("debug"),info:w,warn:K("warn"),error:D,exception:function(l){if(D)for(var x in l)w("ERROR DETAIL: "+x+
": "+l[x])}})})();
(function(){function K(D,w){var j=D.obsHandlers;j[w]||(j[w]=[]);return j[w]}var Z=0;COG.observable=function(D){if(!D)return null;if(!D.obsHandlers)D.obsHandlers={};if(!(D.bind||D.trigger||D.unbind)){D.bind=function(w,j){var l="callback"+Z++;K(D,w).unshift({fn:j,id:l});return l};D.triggerCustom=function(w,j){var l=K(D,w),x={cancel:false,name:w},A;j&&COG.extend(x,j);if(!l)return null;A=Array.prototype.slice.call(arguments,2);D.eventInterceptor&&D.eventInterceptor(w,x,A);A.unshift(x);for(var g=l.length;g--&&
!x.cancel;)l[g].fn.apply(this,A);return x};D.trigger=function(w){var j=Array.prototype.slice.call(arguments,1);j.splice(0,0,w,null);return D.triggerCustom.apply(this,j)};D.unbind=function(w,j){if(typeof w==="undefined")D.obsHandlers={};else for(var l=K(D,w),x=0;l&&x<l.length;x++)if(l[x].id===j){l.splice(x,1);break}return D}}return D}})();
(function(){function K(j,l){j[l]||(j[l]=function(x){return j.configure(l,x)})}function Z(j){j.gtConfId="configurable"+w++;j.gtConfig={};j.gtConfigFns=[];return j.gtConfig}var D={},w=0;COG.paramTweaker=function(j,l,x){return function(A,g){if(typeof g!=="undefined"){if(A in j)j[A]=g;x&&A in x&&x[A](A,g)}else return l&&A in l?l[A](A):j[A]}};COG.configurable=function(j,l,x,A){if(j){j.gtConfId||Z(j);var g=j.gtConfId,z=j.gtConfig,v=j.gtConfigFns;D[g]=j;v.push(x);for(x=l.length;x--;){z[l[x]]=true;A&&K(j,
l[x])}if(!j.configure)j.configure=function(C,M){if(z[C]){for(var q=v.length;q--;){var r=v[q](C,M);if(typeof r!=="undefined")return r}return D[g]}return null}}}})();
(function(){function K(j){var l=document.createElement("script"),x=false;l.src=j;l.async=true;l.onload=l.onreadystatechange=function(){if(!x&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){x=true;l.onload=l.onreadystatechange=null;l&&l.parentNode&&l.parentNode.removeChild(l)}};D||(D=document.getElementsByTagName("head")[0]);D.appendChild(l)}var Z=0,D,w=this;COG.jsonp=function(j,l,x){j+=j.indexOf("?")>=0?"&":"?";var A="json"+ ++Z;w[A]=function(g){l(g);w[A]=null;try{delete w[A]}catch(z){}};
K(j+(x?x:"callback")+"="+A);return A}})();
(function(){var K=1.70158,Z=Math.PI/2,D=Math.abs,w=Math.pow,j=Math.sin,l=Math.asin,x=Math.cos,A={linear:function(g,z,v,C){return v*g/C+z},backin:function(g,z,v,C){return v*(g/=C)*g*((K+1)*g-K)+z},backout:function(g,z,v,C){return v*((g=g/C-1)*g*((K+1)*g+K)+1)+z},backinout:function(g,z,v,C){return(g/=C/2)<1?v/2*g*g*(((K*=1.525)+1)*g-K)+z:v/2*((g-=2)*g*(((K*=1.525)+1)*g+K)+2)+z},bouncein:function(g,z,v,C){return v-A.bounceout(C-g,0,v,C)+z},bounceout:function(g,z,v,C){return(g/=C)<1/2.75?v*7.5625*g*g+
z:g<2/2.75?v*(7.5625*(g-=1.5/2.75)*g+0.75)+z:g<2.5/2.75?v*(7.5625*(g-=2.25/2.75)*g+0.9375)+z:v*(7.5625*(g-=2.625/2.75)*g+0.984375)+z},bounceinout:function(g,z,v,C){return g<C/2?A.bouncein(g*2,0,v,C)/2+z:A.bounceout(g*2-C,0,v,C)/2+v/2+z},cubicin:function(g,z,v,C){return v*(g/=C)*g*g+z},cubicout:function(g,z,v,C){return v*((g=g/C-1)*g*g+1)+z},cubicinout:function(g,z,v,C){if((g/=C/2)<1)return v/2*g*g*g+z;return v/2*((g-=2)*g*g+2)+z},elasticin:function(g,z,v,C,M,q){if(g==0)return z;if((g/=C)==1)return z+
v;q||(q=C*0.3);if(!M||M<D(v)){M=v;v=q/4}else v=q/TWO_PI*l(v/M);return-(M*w(2,10*(g-=1))*j((g*C-v)*TWO_PI/q))+z},elasticout:function(g,z,v,C,M,q){var r;if(g==0)return z;if((g/=C)==1)return z+v;q||(q=C*0.3);if(!M||M<D(v)){M=v;r=q/4}else r=q/TWO_PI*l(v/M);return M*w(2,-10*g)*j((g*C-r)*TWO_PI/q)+v+z},elasticinout:function(g,z,v,C,M,q){var r;if(g==0)return z;if((g/=C/2)==2)return z+v;q||(q=C*0.3*1.5);if(!M||M<D(v)){M=v;r=q/4}else r=q/TWO_PI*l(v/M);if(g<1)return-0.5*M*w(2,10*(g-=1))*j((g*C-r)*TWO_PI/q)+
z;return M*w(2,-10*(g-=1))*j((g*C-r)*TWO_PI/q)*0.5+v+z},quadin:function(g,z,v,C){return v*(g/=C)*g+z},quadout:function(g,z,v,C){return-v*(g/=C)*(g-2)+z},quadinout:function(g,z,v,C){if((g/=C/2)<1)return v/2*g*g+z;return-v/2*(--g*(g-2)-1)+z},sinein:function(g,z,v,C){return-v*x(g/C*Z)+v+z},sineout:function(g,z,v,C){return v*j(g/C*Z)+z},sineinout:function(g,z,v,C){return-v/2*(x(Math.PI*g/C)-1)+z}};COG.tweenValue=function(g,z,v,C,M){function q(S){var Q=S-r,ca=v(Q,g,B,C),ba=r+C<=S;S=!ba;if(M){Q=M(ca,ba,
Q);S=typeof Q!="undefined"?Q&&S:S}S&&animFrame(q)}var r=(new Date).getTime(),B=z-g;animFrame(q);return{}};COG.easing=function(g){return A[g.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(g,z){A[g.replace(/[\-\_\s\.]/g,"").toLowerCase()]=z}})();
(function(){var K=/^P(\d+Y)?(\d+M)?(\d+D)?$/,Z=/^(\d+H)?(\d+M)?(\d+S)?$/,D={8601:function(j){j=j.split("T");var l=null;l=null;var x=0,A=0;K.lastIndex=-1;l=K.exec(j[0]);x+=l[3]?parseInt(l[3].slice(0,-1),10):0;Z.lastIndex=-1;l=Z.exec(j[1]);A+=l[1]?parseInt(l[1].slice(0,-1),10)*3600:0;A+=l[2]?parseInt(l[2].slice(0,-1),10)*60:0;A+=l[3]?parseInt(l[3].slice(0,-1),10):0;return new w(x,A)}},w=COG.Duration=function(j,l){return{days:j?j:0,seconds:l?l:0}};COG.addDuration=function(){for(var j=new w,l=arguments.length;l--;){j.days+=
arguments[l].days;j.seconds+=arguments[l].seconds}if(j.seconds>=86400){j.days+=~~(j.seconds/86400);j.seconds%=86400}return j};COG.formatDuration=function(j){var l,x,A="";if(j.days)A=j.days+" days ";if(j.seconds){j=j.seconds;if(j>=3600){l=~~(j/3600);j-=l*3600}if(j>=60){x=Math.round(j/60);j-=x*60}if(l)A=A+l+(l>1?" hrs ":" hr ")+(x?(x>10?x:"0"+x)+" min ":"");else if(x)A=A+x+" min";else if(j>0)A=A+(j>10?j:"0"+j)+" sec"}return A};COG.parseDuration=function(j,l){var x=l?D[l]:null;if(x)return x(j);COG.Log.warn("Could not find duration parser for specified format: "+
l);return new w}})();
INTERACT=function(){function K(q){return function(r,B,S){(S?S:q?document.body:document).addEventListener(r,B,false)}}function Z(q){return function(r,B,S){(S?S:q?document.body:document).removeEventListener(r,B,false)}}function D(q,r,B){(B?B:document).attachEvent("on"+q,r)}function w(q,r,B){(B?B:document).detachEvent("on"+q,r)}function j(q,r){return{x:q?q:0,y:r?r:0,count:1}}function l(q,r){C.push(COG.extend({handler:null,checks:{},type:q},r))}function x(q){var r=0,B=0;if(q.offsetParent){do{r+=q.offsetLeft;
B+=q.offsetTop;q=q.offsetParent}while(q)}return{x:r,y:B}}function A(q,r){return{source:q,target:r.target?r.target:r.srcElement}}function g(q,r){for(var B=q.target?q.target:q.srcElement;B&&B!==r&&B.nodeName&&B.nodeName.toUpperCase()!="CANVAS";)B=B.parentNode;return B&&B===r}function z(q,r){return{x:q.x-(r?r.x:0),y:q.y-(r?r.y:0)}}function v(q){if(q.preventDefault){q.preventDefault();q.stopPropagation()}else q.cancelBubble&&q.cancelBubble()}var C=[],M=function(q,r,B){function S(N,T,R,I){var J=0,$=0,
t=0;COG.tweenValue(0,N,R,I,function(W){t=J;J=W});COG.tweenValue(0,T,R,I,function(W){Q.trigger("pan",J-t,W-$);$=W})}B=COG.extend({binder:null,unbinder:null,observable:null},B);for(var Q=B.observable,ca=null,ba=[],U=[],ja,ka,O={bind:function(){return Q.bind.apply(null,arguments)},pannable:function(N){ca=COG.extend({inertia:true},N);return O},unbind:function(){Q.unbind();for(var N=0;N<ba.length;N++)ba[N].unbind();return O}},ua=0;ua<r.length;ua++)ba.push(r[ua](q,Q,B));Q.bind("pointerDown",function(){U=
[];ka=ja=0});Q.bind("pointerMove",function(N,T,R,I){if(ca){U[U.length]={ticks:(new Date).getTime(),x:I.x,y:I.y};Q.trigger("pan",I.x,I.y)}ja+=I.x?I.x:0;ka+=I.y?I.y:0});Q.bind("pointerUp",function(N,T,R){if(Math.abs(ja)>20||Math.abs(ka)>20){if(ca){R=U.length;var I,J;T=0;for(J=U.length;--J>1&&T<50;)T+=U[J].ticks-U[J-1].ticks;if(R-J>1){N=U[R-1].x-U[J].x;I=U[R-1].y-U[J].y;J=Math.sqrt(N*N+I*I)|0;if(J>15){N=U[R-1].x-U[0].x;I=U[R-1].y-U[0].y;J=Math.sqrt(N*N+I*I)|0;R=Math.asin(I/J);T=J*500/T|0;T=T>300?300:
T;S(Math.cos(N>0?R:Math.PI-R)*T,Math.sin(R)*T,COG.easing("sine.out"),500)}}}}else Q.trigger("tap",T,R)});return O};l("pointer",{handler:function(q,r,B){function S(t){if(g(t,q))if(ua=U(t)){q.style.cursor="move";v(t);J=t.pageX?t.pageX:t.screenX;$=t.pageY?t.pageY:t.screenY;N=j(J,$);T=x(q);r.triggerCustom("pointerDown",A("mouse",t),N,z(N,T))}}function Q(t){R=t.pageX?t.pageX:t.screenX;I=t.pageY?t.pageY:t.screenY;if(g(t,q))ja(t,ua?"pointerMove":"pointerHover")}function ca(t){if(ua&&U(t)){ua=false;if(g(t,
q)){q.style.cursor="default";ja(t,"pointerUp")}}}function ba(t){if(g(t,q)){var W;t=t||window.event;if(t.detail)W=t.axis===2?-t.detail*ka:0;else{W=t.wheelDeltaY?t.wheelDeltaY:t.wheelDelta;if(window.opera)W=-W}if(W!==0){var da=j(R,I);r.triggerCustom("zoom",A("mouse",t),da,z(da,x(q)),W/O,"wheel");v(t);t.returnValue=false}}}function U(t){t=t||window.event;return(t.which||t.button)==1}function ja(t,W,da,ma,qa){da=typeof da!="undefined"?da:R;ma=typeof ma!="undefined"?ma:I;var E=da-J,P=ma-$,L=j(da,ma);T||
(T=x(q));r.triggerCustom(W,A("mouse",t),L,z(L,T),j(E,P));if(typeof qa=="undefined"||qa){J=da;$=ma}}B=COG.extend({},B);var ka=120,O=ka*8,ua=false,N,T,R,I,J,$;B.binder("mousedown",S,false);B.binder("mousemove",Q,false);B.binder("mouseup",ca,false);B.binder("dblclick",function(t){COG.info("captured double click");if(g(t,q)){var W=j(t.pageX?t.pageX:t.screenX,t.pageY?t.pageY:t.screenY);COG.info("captured double click + target matched");r.triggerCustom("doubleTap",A("mouse",t),W,z(W,x(q)))}},false);B.binder("mousewheel",
ba,document);B.binder("DOMMouseScroll",ba,document);return{unbind:function(){B.unbinder("mousedown",S,false);B.unbinder("mousemove",Q,false);B.unbinder("mouseup",ca,false);B.unbinder("mousewheel",ba,document);B.unbinder("DOMMouseScroll",ba,document)}}},checks:{touch:false}});l("pointer",{handler:function(q,r,B){function S(E){if(E.count<2)return 0;var P=E.x-E.next.x;E=E.y-E.next.y;return~~Math.sqrt(P*P+E*E)}function Q(E,P,L){P=P?P:0;L=L?L:0;for(var na={x:E.x-P,y:E.y-L,id:E.id,count:E.count},ra=na;E.next;){E=
E.next;ra=ra.next={x:E.x-P,y:E.y-L,id:E.id}}return na}function ca(E,P){var L=E[P?P:"touches"],na,ra;if(L.length===0)return null;ra=na={x:L[0].pageX,y:L[0].pageY,id:L[0].identifier,count:L.length};for(var va=1,Ja=L.length;va<Ja;va++)ra=ra.next={x:L[va].pageX,y:L[va].pageY,id:L[va].identifier};return na}function ba(E){if(g(E,q)){I=x(q);var P=ca(E,"changedTouches"),L=Q(P,I.x,I.y);if(!$){J=N;r.triggerCustom("pointerDown",A("touch",E),P,L)}ma&&r.triggerCustom("pointerDownMulti",A("touch",E),P,L);$=ca(E);
if($.count>1)W=S($);qa=1;da=Q($)}}function U(E){if(g(E,q)){E.preventDefault();t=ca(E);if(J==N)J=Math.abs($.x-t.x)>O||Math.abs($.y-t.y)>O?ua:N;if(J!=N){J=t.count>1?R:T;if(J==R)if($.count===1){$=Q(t);W=S($)}else{var P=S(t);if(Math.abs(W-P)<ka)J=T;else{var L;L=t.x;var na=t.next.x,ra=t.y,va=t.next.y,Ja=ra<va?ra:va;L={x:(L<na?L:na)+(Math.abs(L-na)>>1),y:Ja+(Math.abs(ra-va)>>1)};P=P/W;na=P-qa;r.triggerCustom("zoom",A("touch",E),L,z(L,I),na,"pinch");qa=P}}J==T&&r.triggerCustom("pointerMove",A("touch",E),
t,Q(t,I.x,I.y),j(t.x-da.x,t.y-da.y));ma&&r.triggerCustom("pointerMoveMulti",A("touch",E),t,Q(t,I.x,I.y))}da=Q(t)}}function ja(E){if(g(E,q)){var P=ca(E,"changedTouches"),L=Q(P,I.x,I.y);t=ca(E);if(!t){J===N&&r.triggerCustom("tap",A("touch",E),P,L);r.triggerCustom("pointerUp",A("touch",E),P,L);$=null}ma&&r.triggerCustom("pointerUpMulti",A("touch",E),P,L)}}B=COG.extend({detailed:false,inertia:false},B);var ka=20,O=7,ua=0,N=1,T=2,R=3,I,J,$,t,W,da,ma=B.detailed,qa=1;B.binder("touchstart",ba,false);B.binder("touchmove",
U,false);B.binder("touchend",ja,false);COG.info("initialized touch handler");return{unbind:function(){B.unbinder("touchstart",ba,false);B.unbinder("touchmove",U,false);B.unbinder("touchend",ja,false)}}},checks:{touch:true}});return{register:l,watch:function(q,r,B){r=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},r);capabilities=COG.extend({touch:"ontouchstart"in window},B);if(!r.observable){COG.info("creating observable");r.observable=COG.observable({});
globalOpts=r}r.binder=r.isIE?D:K(r.bindToBody);r.unbinder=r.isIE?w:Z(r.bindToBody);B=r.types;for(var S=capabilities,Q=[],ca=C.length;ca--;){var ba=C[ca],U=!B||B.indexOf(ba.type)>=0,ja=true;for(var ka in ba.checks){var O=ba.checks[ka];COG.info("checking "+ka+" capability. require: "+O+", capability = "+S[ka]);ja=ja&&O===S[ka]}if(U&&ja)Q[Q.length]=ba.handler}return new M(q,Q,r)}}}();
T5=function(){function K(){return(new Date).getTime()}function Z(){for(;t.length>0;){var b=t.shift();document.location=b}$=0}function D(b){for(var m=true,d=W.length;d--;)m=m&&b!=W[d];return m}function w(b,m){var d=[];for(var a in m)a&&d.push(a+"="+escape(m[a]));return"tile5://"+b+"/"+(d.length>0?"?"+d.join("&"):"")}function j(b,m){D(b)&&COG.info("would push url: "+w(b,m))}function l(b,m){if(D(b)){t.push(w(b,m));$||($=setTimeout(Z,100))}}function x(b){return function(m,d,a){(a?a:b?document.body:document).addEventListener(m,
d,false)}}function A(b){return function(m,d,a){(a?a:b?document.body:document).removeEventListener(m,d,false)}}function g(b,m,d){(d?d:document).attachEvent("on"+b,m)}function z(b,m,d){(d?d:document).detachEvent("on"+b,m)}function v(){R={base:{name:"Unknown",bindEvent:x(),unbindEvent:A(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:j,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:g,unbindEvent:z,
requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:l,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:l},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:l},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:x(true),unbindEvent:A(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:l},
froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:l}};I=[R.froyo,R.android,R.ipod,R.iphone,R.ipad,R.ie]}function C(){R||v();if(!J){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<I.length;b++){var m=I[b];if(m.regex&&m.regex.test(navigator.userAgent)){J=COG.extend({},R.base,m);COG.info("PLATFORM DETECTED AS: "+J.name);break}}if(!J){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
J=R.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return J}function M(){for(var b=0,m=arguments.length;m--;){var d=E[arguments[m].toUpperCase()];if(d)b|=d}return b}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(function(){b((new Date).getTime())},1E3/60)}}();var q=Math.abs,r=Math.min,B=Math.max,S=Math.pow,
Q=Math.sqrt,ca=Math.log,ba=Math.round,U=Math.sin,ja=Math.asin,ka=Math.cos,O=function(){function b(a,c){return d(a.x-c.x,a.y-c.y)}function m(a,c){if(!c)c=a.length;if(c<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var f={edges:Array(c-1),accrued:Array(c-1),total:0},h=0;h<c-1;h++){var n=b(a[h],a[h+1]);f.edges[h]=Q(n.x*n.x+n.y*n.y);f.accrued[h]=f.total+f.edges[h];f.total+=f.edges[h]}return f}function d(a,c){return{x:a?a:0,y:c?c:0}}return{VECTOR_SIMPLIFICATION:3,
SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var a=0,c=0,f=arguments.length;f--;){a+=arguments[f].x;c+=arguments[f].y}return d(a,c)},absSize:function(a){return B(q(a.x),q(a.y))},copy:function(a){return a?d(a.x,a.y):null},diff:b,distance:function(a,c){return m(a,c).total},edges:m,equals:function(a,c){return a.x===c.x&&a.y===c.y},extendBy:function(a,c,f){var h=ka(c)*f;c=U(c)*f;return d(a.x-h,a.y-c)},floor:function(a){for(var c=Array(a.length),f=a.length;f--;)c[f]=d(~~a[f].x,~~a[f].y);return c},
getRect:function(a){for(var c,f,h,n,k=a.length;k--;){var i=a[k];c=typeof c==="undefined"||i.x<c?i.x:c;f=typeof f==="undefined"||i.y<f?i.y:f;h=typeof h==="undefined"||i.x>h?i.x:h;n=typeof n==="undefined"||i.y>n?i.y:n}return N.init(c,f,h,n)},init:d,invert:function(a){return d(-a.x,-a.y)},min:function(a,c){return d(a.x<c.x?a.x:c.x,a.y<c.y?a.y:c.y)},max:function(a,c){return d(a.x>c.x?a.x:c.x,a.y>c.y?a.y:c.y)},offset:function(a,c,f){return d(a.x+c,a.y+(f?f:c))},simplify:function(a,c){if(!a)return null;
c=c?c:O.VECTOR_SIMPLIFICATION;for(var f=[],h=null,n=a.length;n--;){var k=a[n];if(include=!h||n===0||q(k.x-h.x)+q(k.y-h.y)>c){f.unshift(k);h=k}}return f},theta:function(a,c,f){f=ja((a.y-c.y)/f);return a.x>c.x?f:Math.PI-f},toString:function(a){return a?a.x+", "+a.y:""}}}(),ua=function(){return{dotProduct:function(b,m){return b.x*m.x+b.y*m.y}}}(),N=function(){function b(d){return m(d.x1,d.y1,d.x2,d.y2)}function m(d,a,c,f){d=d?d:0;a=a?a:0;c=typeof c!=="undefined"?c:d;f=typeof f!=="undefined "?f:f;return{x1:d,
y1:a,x2:c,y2:f,width:c-d,height:f-a}}return{center:function(d){return O.init(d.x1+d.width/2,d.y1+d.height/2)},copy:b,diagonalSize:function(d){return Q(d.width*d.width+d.height*d.height)},fromCenter:function(d,a,c,f){c=c>>1;f=f>>1;return m(d-c,a-f,d+c,a+f)},init:m,intersect:function(d,a){var c=B(d.x1,a.x1),f=B(d.y1,a.y1),h=r(d.x2,a.x2),n=r(d.y2,a.y2);c=m(c,f,h,n);return c.width>0&&c.height>0?c:null},toString:function(d){return d?"["+d.x1+", "+d.y1+", "+d.x2+", "+d.y2+"]":""},union:function(d,a){if(d.width===
0||d.height===0)return b(a);else if(a.width===0||a.height===0)return b(d);else{var c=r(d.x1,a.x1),f=r(d.y1,a.y1),h=B(d.x2,a.x2),n=B(d.y2,a.y2);c=m(c,f,h,n);return c.width>0&&c.height>0?c:null}}}}(),T=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return O.init(b.width>>1,b.height>>1)},getSize:function(b){return Q(S(b.width,2)+S(b.height,2))},init:function(b,m){b=b?b:0;return{width:b,height:m?m:b}}}}(),R=null,I=[],J=null,$=0,t=[],W=["view.wake",
"tile.loaded"],da=function(){function b(){var e=C().maxImageLoads;if(!e||k.length<e)if(e=n.shift()){k[k.length]=e;e.image.onload=m;e.image.src=e.url;e.requested=T5.ticks()}}function m(){var e=f[this.id],y;if(e&&e.image.complete&&e.image.width>0){e.loaded=true;e.hitCount=1;for(y=k.length;y--;)if(k[y].image.src==this.src){k.splice(y,1);break}if(e.background||e.postProcess||e.drawBackground||e.customDraw)if(e.image){globalImageData=e;y=a(e.realSize?e.realSize.width:e.image.width,e.realSize?e.realSize.height:
e.image.height);var H=y.getContext("2d"),G=e.offset?e.offset:T5.XY.init();e.background&&H.drawImage(e.background,0,0);e.drawBackground&&e.drawBackground(H);e.customDraw?e.customDraw(H,e):H.drawImage(e.image,G.x,G.y);e.postProcess&&e.postProcess(H,e);e.image=y}for(y=e.callbacks.length;y--;)e.callbacks[y]&&e.callbacks[y](this,false);e.callbacks=[];i[i.length]={url:this.src,created:e.requested};delete f[this.id];b()}}function d(e,y,H){var G=c[e];if(G){G.hitCount++;G.image.complete&&G.image.width>0&&
y?y(G.image,true):G.callbacks.push(y)}else{G=COG.extend({url:e,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[y]},H);G.image.id="resourceLoaderImage"+h++;c[e]=G;f[G.image.id]=G;n[n.length]=G;b()}return G}function a(e,y){var H=document.createElement("canvas");COG.info("creating new canvas");H.width=e?e:0;H.height=y?y:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(H);FlashCanvas.initElement(H)}return H}var c={},f={},h=0,n=[],k=[],i=[],s={avgImageSize:25,
loadTimeout:10,cancelLoad:function(){var e;for(e=k.length;e--;)delete c[k[e].url];k=[];for(e=n.length;e--;)delete c[n[e].url];n=[]},get:function(e,y,H){var G=null;G=null;if((G=(G=c[e])?G.image:null)&&(G.getContext||G.complete&&G.width>0))return G;else y&&d(e,y,H);return null},load:d,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:k.length,queuedImageCount:n.length,imageCacheFullness:0}}};COG.observable(s);return s}(),ma=function(){var b={};return{init:function(m,d){var a=
b[m];if(!a)throw Error("Unable to locate requested generator: "+m);return new a(d)},register:function(m,d){b[m]=d},Template:function(){}}}(),qa=function(){function b(h,n){c[h]=d(n);return h}function m(h){for(var n in h)b(n,h[n])}function d(h){function n(e){var y=h[e];typeof y!=="undefined"&&i.push(function(H){H[e]=y})}function k(){i=[];for(var e in h)n(e)}h=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,
globalCompositeOperation:undefined},h);var i=[],s={applyToContext:function(e){for(var y=i.length;y--;)i[y](e)},update:function(e,y){h[e]=y;k()}};k();return s}var a={},c={},f={apply:function(h,n){var k=c[n]?c[n]:c.basic,i;if(h&&h.canvas){i=a[h.canvas.id];a[h.canvas.id]=n}k.applyToContext(h);return i},define:b,defineMany:m,get:function(h){return c[h]},init:d,load:function(h){COG.jsonp(h,function(n){m(n)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",
fillStyle:"#FFF"}});return f}(),E={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},P=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:M("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var m=null,d=false,a=false,c=b.id,f=M("ACTIVE"),h=b.validStates,n=0,k=0,i=COG.extend({addToView:function(s){s.setLayer(c,i)},shouldDraw:function(s){return(s&h)!==0},clip:null,cycle:function(){},draw:function(){},remove:function(){i.trigger("remove",
i)},changed:function(){a=true;m&&m.invalidate()},hitTest:null,getId:function(){return c},setId:function(s){c=s},getParent:function(){return m},setParent:function(s){d=(m=s)?m.fastDraw&&displayState!==f:false;i.trigger("parentChange",m)}},b);COG.observable(i);i.bind("drawComplete",function(s,e){a=false;n=e.x1;k=e.y1});i.bind("resync",function(s,e){if(e.syncXY){i.minXY&&e.syncXY(i.minXY);i.maxXY&&e.syncXY(i.maxXY)}});return i},L=function(b){function m(k,i,s,e){a=k;c=i;f=s;h=e}b=COG.extend({xy:O.init(),
offset:true,tweenIn:null,animationSpeed:null,isNew:true},b);var d=false,a=0,c=0,f=0,h=0,n=COG.extend(b,{isAnimating:function(){return d},draw:function(k,i,s,e,y){if(n.isNew&&b.tweenIn)COG.tweenValue(i.y1-20,n.xy.y,b.tweenIn,b.animationSpeed?b.animationSpeed:250+Math.random()*500,function(H,G){n.xy.y=H|0;d=!G;y.invalidate()});n.drawMarker(k,i,n.xy.x,n.xy.y,s,e,y);n.isNew=false},drawMarker:function(k,i,s,e){k.beginPath();k.arc(s,e,4,0,Math.PI*2,false);k.fill();m(s-4,e-4,8,8)},hitTest:function(k,i){return k>=
a&&k<=a+f&&i>=c&&i<=c+h},updateBounds:m});COG.observable(n);return n},na=function(b){function m(){d();c.changed();c.trigger("markerUpdate",a)}function d(){var f=c.getParent();if(f&&f.syncXY)for(var h=a.length;h--;)f.syncXY([a[h].xy]);a.sort(function(n,k){var i=k.xy.y-n.xy.y;if(i==0)i=k.xy.x-n.xy.x;return i})}b=COG.extend({zindex:100,style:"basic"},b);var a=[],c=COG.extend(new P(b),{draw:function(f,h,n,k){for(var i=a.length;i--;)a[i].draw(f,h,n,c,k)},add:function(f){if(f&&typeof f.length!=="undefined")for(var h=
f.length;h--;){if(f[h])a[a.length]=f[h]}else if(f)a[a.length]=f;m()},clear:function(f){if(f)for(var h=0;h<a.length;)if(f(a[h]))a.splice(h,1);else h+=1;else a=[];m()},each:function(f){if(f)for(var h=a.length;h--;)f(a[h])},find:function(f){for(var h=[],n=a.length;n--;)if(!f||f(a[n]))h[h.length]=a[n];return h},hitTest:function(f,h){for(var n=[],k=a.length;k--;)if(a[k].hitTest(f,h))n[n.length]={type:"marker",data:a[k]};return n}});c.bind("tap",function(f,h,n,k){var i=[],s=k.x;k=k.y;for(var e=a.length;e--;)if(a[e].hitTest(s,
k))i[i.length]=a[e];if(i.length>0)f.cancel=c.trigger("markerTap",h,n,i).cancel});c.bind("parentChange",d);c.bind("resync",d);return c},ra=function(b){function m(k,i,s){k.fillStyle="#FFFFFF";k.strokeStyle="#222222";k.beginPath();k.arc(s.x,s.y,4,0,Math.PI*2,false);k.stroke();k.fill()}b=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:M("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},b);var d=O.edges(b.path),a,c=null,f=b.drawIndicator?b.drawIndicator:m,
h=0,n=COG.extend(new P(b),{cycle:function(){for(var k=0;k<d.accrued.length&&d.accrued[k]<h;)k++;c=null;if(k<b.path.length-1){var i=h-(k>0?d.accrued[k-1]:0),s=b.path[k];a=O.theta(s,b.path[k+1],d.edges[k]);c=O.extendBy(s,a,i)}return c},draw:function(k,i){c&&f&&f(k,i,O.init(c.x,c.y),a)}});COG.tweenValue(0,d.total,b.easing,b.duration,function(k,i){h=k;i&&n.remove();n.changed()});return n},va=function(b){b=COG.extend({style:null,properties:{}},b);return COG.extend(b,{rect:null,draw:function(){},resync:function(){}})},
Ja=function(){return{tileSize:256,init:function(b,m,d,a,c){return COG.extend({x:b,y:m,width:d,height:a},c)}}}(),Va={ex:COG.extend,ticks:K,getConfig:C,userMessage:function(b,m,d){Va.trigger("userMessage",b,m,d)},XY:O,XYRect:N,Dimensions:T,Vector:ua,D:T,Images:da,Generator:ma,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:qa,viewState:M,View:function(b){function m(p,o,u,F){Ma(X-o,Y-u,F?b.panAnimationEasing:null,F?b.panAnimationDuration:null)}function d(p,o,u,F){Wa(r(B(ea+
S(2,F)-1,0.5),2))}function a(){var p=ca(ea)/Math.LN2>>0;if(p!==0){ea=S(2,p);kb(Ka+Math.log(ea)/Math.LN2,Na,Oa)}sa()}function c(p){p||(p=O.init(Fa,Ga));Xa=O.init(X,Y);La=O.offset(p,X,Y);Na=La.x;Oa=La.y}function f(p,o){var u,F;F=1/ea;if(ea!==1&&wa){u=wa.x1+p*F;F=wa.y1+o*F}else{u=p+X;F=o+Y}return O.init(u,F)}function h(p,o,u){Ha("doubleTap",o,u,f(u.x,u.y));b.scalable&&Wa(2,u,b.zoomEasing,null,b.zoomDuration)}function n(p,o,u){Ya=null;e(o,u,f(u.x,u.y),"down")}function k(p,o,u){Ya=f(u.x,u.y);e(o,u,Ya,
"hover")}function i(){clearTimeout(lb);lb=setTimeout(y,250)}function s(p,o,u){e(o,u,f(u.x,u.y),"tap");Ha("tap",o,u,f(u.x,u.y))}function e(p,o,u,F){for(var aa=[],la=ta;la--;)if(V[la].hitTest)aa=aa.concat(V[la].hitTest(u.x,u.y,Aa,ga));aa.length>0&&ga.triggerCustom(F+"Hit",{hitType:F},aa,p,o,u)}function y(p,o){var u;if(ha){if(b.autoSize&&ha.parentNode){p=ha.parentNode.offsetWidth;o=ha.parentNode.offsetHeight}try{if(!ha.id)ha.id=b.id+"_canvas";ia=ha.getContext("2d")}catch(F){COG.exception(F);throw Error("Could not initialise canvas on specified view element");
}if(p&&o&&(oa!==o||pa!==p)){Za=true;pa=p;oa=o;Fa=pa>>1;Ga=oa>>1;ga.trigger("resize",pa,oa);for(u=ta;u--;)V[u].trigger("resize",pa,oa)}for(u=ta;u--;)V[u].trigger("contextChanged",ia);sa();G()}}function H(p,o){o.setId(p);o.added=K();o.bind("remove",function(){ga.removeLayer(p)});o.trigger("contextChanged",ia);o.setParent(ga);V.push(o);V.sort(function(u,F){var aa=F.zindex-u.zindex;if(aa===0)aa=F.added-u.added;return aa});ta=V.length;return o}function G(){Ba&&Ba.unbind();Ba=INTERACT.watch(ha);b.pannable&&
Ba.pannable().bind("pan",m);if(b.scalable){Ba.bind("zoom",d);Ba.bind("doubleTap",h)}if(b.captureHover){Ba.bind("pointerDown",n);Ba.bind("pointerHover",k)}Ba.bind("tap",s)}function fa(p){var o=Pa?X+Fa:X,u=Qa?Y+Ga:Y;if(xa&&xa>pa)if(o+pa>xa)X=Pa?p&&o-xa>0?X-xa:X:xa-pa;else if(o<0)X=Pa?p?X+xa:X:0;if(ya&&ya>oa)if(u+oa>ya)Y=Qa?p&&u-ya>0?Y-ya:Y:ya-oa;else if(u<0)Y=Qa?p?Y+ya:Y:0}function Ca(p){var o,u,F=false;if($a){if(p-mb>sb){u=X!==ab||Y!==bb;Aa=nb|(ea!==1?ob:0)|(u?cb:0)|(db?eb:0);fb=(o=(Aa&(ob|cb))!==
0)&&(Aa&eb)===0;if(Za&&ha){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(ha);ha.width=pa;ha.height=oa;ha.style.width=pa+"px";ha.style.height=oa+"px";Za=false}if(xa||ya)fa();Ra=Sa();for(u=ta;u--;){Aa|=V[u].animated?eb:0;V[u].cycle(p,Ra,Aa);V[u].shouldDraw(Aa,Ra);F=V[u].clip||F}u=Aa;var aa=Ra;F=tb&&F&&!o;var la;N.center(aa);o=0;wa=N.copy(aa);wa.scaleFactor=ea;if(!F)if(!gb||p-pb>ub){ia.clearRect(0,0,pa,oa);pb=p}ia.save();try{if(ea!==1){var Da=wa,za=1/ea;Na=La.x+(X-Xa.x);Oa=La.y+(Y-Xa.y);wa=
Da?N.fromCenter(Na>>0,Oa>>0,Da.width*za>>0,Da.height*za>>0):void 0;ia.scale(ea,ea)}ia.translate(-wa.x1,-wa.y1);Ta=Ua=null;if(F&&!gb){ia.beginPath();for(o=ta;o--;)V[o].clip&&V[o].clip(ia,wa,u,ga,p);ia.closePath();ia.clip()}for(o=ta;o--;){la=V[o];ia.globalCompositeOperation=gb&&la.zIndex<=0?"copy":"source-over";var Ea=la.style,Ia=Ea?qa.apply(ia,Ea):null;la.draw(ia,wa,u,ga,p);Ia&&qa.apply(ia,Ia)}}finally{ia.restore()}$a=0;Ha("drawComplete",aa,p);p-qb>vb&&hb();mb=p;ab=X;bb=Y}animFrame(Ca)}else ib=false}
function sa(){$a+=1;if(!ib){ib=true;animFrame(Ca)}}function Sa(){return N.init(X,Y,X+pa,Y+oa)}function hb(){if(xa||ya)fa(true);qb=(new Date).getTime();Ha("refresh",ga,Sa());sa()}function Wa(p,o,u,F,aa){if(u)COG.tweenValue(ea,p,u,aa,function(la,Da){ea=la;if(Da){var za=ba(ca(ea)/Math.LN2);ea=S(2,za);F&&F()}c(o);a()});else{ea=p;c(o);a()}return ga}function kb(p,o,u){p=B(b.minZoom,r(b.maxZoom,p));if(p!==Ka){var F=S(2,p-Ka),aa=Fa/F|0,la=Ga/F|0;Ka=p;Ma(((o?o:X+Fa)-aa)*F,((u?u:Y+Ga)-la)*F);ab=X;bb=Y;Ha("zoomLevelChange",
p);ea=1;hb()}}function Ha(){for(var p=ga.trigger.apply(null,arguments).cancel,o=V.length;o--;)p=V[o].trigger.apply(null,arguments).cancel||p;return!p}function Ma(p,o,u,F,aa){function la(){Da+=1;if(Da>=2){db=false;aa&&aa()}}var Da=0,za=Ua?O.offset(Ua,-Fa,-Ga):null,Ea=Ta?O.offset(Ta,-Fa,-Ga):null;if(za){p=p<za.x?za.x:p;o=o<za.y?za.y:o}if(Ea){p=p>Ea.x?Ea.x:p;o=o>Ea.y?Ea.y:o}if(u){if((Aa&cb)===0){COG.tweenValue(X,p,u,F,function(Ia,jb){X=Ia|0;(jb?la:sa)();return!fb});COG.tweenValue(Y,o,u,F,function(Ia,
jb){Y=Ia|0;(jb?la:sa)();return!fb});db=true}}else{X=p|0;Y=o|0;sa();aa&&aa()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastDraw:false,inertia:true,minRefresh:1E3,pannable:true,clipping:true,scalable:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,zoomEasing:COG.easing("quad.out"),zoomDuration:300,zoomLevel:1},b);var ub=500,V=[],ta=0,ha=document.getElementById(b.container),
ia=null,wb=typeof window.attachEvent!="undefined",vb=b.minRefresh,Ya=null,X=0,Y=0,ab=0,bb=0,xa=null,ya=null,Pa=false,Qa=false,tb=b.clipping,Ra=null,ib=false,wa,rb=1,Fa=0,Ga=0,Xa=null,La=null,fb=false,Ua=null,Ta=null,qb=0,pb=0,lb=0,ea=1,mb=0,Za=false,Ba=null,gb=b.turbo,db=false,oa,pa,sb=1E3/b.fps|0,$a=0,Na,Oa,Ka=b.zoomLevel,nb=M("ACTIVE"),cb=M("PAN"),ob=M("ZOOM"),eb=M("ANIMATING"),Aa=nb,ga={id:b.id,deviceScaling:rb,fastDraw:b.fastDraw||C().requireFastDraw,getDimensions:function(){return T.init(pa,
oa)},getLayer:function(p){for(var o=0;o<ta;o++)if(V[o].getId()==p)return V[o];return null},getZoomLevel:function(){return Ka},setLayer:function(p,o){for(var u=0;u<ta;u++)if(V[u].getId()===p){V.splice(u,1);break}if(o){H(p,o);o.trigger("refresh",ga,Sa())}sa();return o},eachLayer:function(p){for(var o=ta;o--;)p(V[o])},invalidate:sa,refresh:hb,resetScale:function(){ea=1},resize:function(p,o){if(ha){b.autoSize=false;if(pa!==p||oa!==o)y(p,o)}},scale:Wa,setZoomLevel:kb,triggerAll:Ha,removeLayer:function(p){a:{for(var o=
ta;o--;)if(V[o].getId()==p){p=o;break a}p=-1}if(p>=0&&p<ta){ga.trigger("layerRemoved",V[p]);V.splice(p,1);sa()}ta=V.length},getOffset:function(){return O.init(X,Y)},setMaxOffset:function(p,o,u,F){xa=p;ya=o;Pa=typeof u!="undefined"?u:false;Qa=typeof F!="undefined"?F:false},getViewRect:Sa,updateOffset:Ma,pan:function(p,o,u,F,aa){Ma(X+p,Y+o,u,F,aa)}};rb=C().getScaling();ga.markers=H("markers",new na);COG.observable(ga);ga.bind("invalidate",function(){sa()});ga.bind("resync",function(){Ta=Ua=null});COG.configurable(ga,
["container","scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(b,null,{container:function(p,o){ha=document.getElementById(o);y()},inertia:G,scalable:G,pannable:G}),true);y();if(b.autoSize)wb?window.attachEvent("onresize",i):window.addEventListener("resize",i,false);return ga},ViewLayer:P,ImageLayer:function(b,m){function d(i,s,e){for(s=h.length;s--;){var y=h[s],H=y.x,G=y.y,fa=N.init(y.x,y.y,y.x+y.width,y.y+y.height);if(e&&N.intersect(i,fa))(fa=da.get(y.url,function(){k.changed()},
n))&&e(fa,H,G,y.width,y.height)}}function a(i){var s=++f,e=k.getParent();c&&c.run(e,i,function(y){if(s==f){h=[].concat(y);e.invalidate()}})}m=COG.extend({imageLoadArgs:{}},m);var c=b?ma.init(b,m):null,f=0,h=[],n=m.imageLoadArgs,k=COG.extend(new P(m),{changeGenerator:function(i,s){c=ma.init(i,COG.extend({},m,s));h=null;a(k.getParent().getViewRect())},clip:function(i,s,e){d(s,e,function(y,H,G,fa,Ca){i.rect(H,G,fa,Ca)})},draw:function(i,s,e){d(s,e,function(y,H,G,fa,Ca){k.drawImage(i,y,H,G,fa,Ca,s,e)})},
drawImage:function(i,s,e,y){s&&i.drawImage(s,e,y,s.width,s.height)}});k.bind("refresh",function(i,s,e){a(e)});k.bind("tap",function(i,s,e,y){i=[];var H=y.x,G=y.y,fa,Ca;if(h)for(var sa=h.length;sa--;){fa=h[sa];if(Ca=H>=fa.x&&H<=fa.x+fa.width&&G>=fa.y&&G<=fa.y+fa.height)i[i.length]=fa}i.length>0&&k.trigger("tapImage",i,s,e,y)});return k},ImageGenerator:function(b){b=COG.extend({relative:false,padding:2},b);b={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(b);
return b},Marker:L,ImageMarker:function(b){b=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},b);var m=b.imageAnchor?T5.XY.invert(b.imageAnchor):null,d=COG.extend(new L(b),{changeImage:function(a){d.image=da.get(a,function(c){d.image=c})},drawMarker:function(a,c,f,h){if((c=d.isAnimating()&&d.animatingImage?d.animatingImage:d.image)&&c.width>0){m||(m=O.init(-c.width>>1,-c.height>>1));var n=d.scale,k=f+~~(m.x*n),i=h+~~(m.y*
n),s=~~(c.width*n),e=~~(c.height*n);d.updateBounds(k,i,s,s);if(d.rotation||d.opacity!==1){a.save();try{a.globalAlpha=d.opacity;a.translate(f,h);a.rotate(d.rotation);a.drawImage(c,m.x*n,m.y*n,s,e)}finally{a.restore()}}else a.drawImage(c,k,i,s,e)}}});if(!d.image)d.image=da.get(b.imageUrl,function(a){d.image=a});if(!d.animatingImage)d.animatingImage=da.get(b.animatingImageUrl,function(a){d.animatingImage=a});return d},MarkerLayer:na,PathLayer:function(b){function m(){var i=k.getParent();if(i&&i.syncXY){i.syncXY(c);
f&&i.syncXY(f);k.trigger("tidy")}}b=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},b);var d=[],a=null,c=[],f=null,h=0,n=[],k=COG.extend(new P(b),{getAnimation:function(i,s,e,y){var H="pathAnimation"+h++;n.push(H);return new ra({id:H,path:d,zindex:b.zindex+1,easing:i?i:COG.easing("sine.inout"),duration:s?s:5E3,drawIndicator:e,autoCenter:y?y:false})},draw:function(i){var s,e=d.length;i.save();try{qa.apply(i,b.style);if(e>0){i.beginPath();i.moveTo(d[e-1].x,d[e-1].y);for(s=e;s--;)i.lineTo(d[s].x,
d[s].y);i.stroke();if(a){i.fillStyle=b.waypointFillStyle;for(s=a.length;s--;){i.beginPath();i.arc(a[s].x,a[s].y,2,0,Math.PI*2,false);i.stroke();i.fill()}}}}finally{i.restore()}},updateCoordinates:function(i,s){c=i;f=s;m()}});k.bind("tidy",function(){d=O.simplify(c,b.pixelGeneralization);a=O.simplify(f,b.pixelGeneralization);k.changed(true)});k.bind("resync",m);return k},AnimatedPathLayer:ra,Shape:va,Arc:function(b,m){m=COG.extend({size:4},m);var d=O.init(),a=COG.extend(m,{draw:function(c){c.beginPath();
c.arc(d.x,d.y,a.size,0,Math.PI*2,false);c.fill();c.stroke()},resync:function(c){c.syncXY([b]);d=O.floor([b])[0]}});COG.info("created arc = ",b);return a},Poly:function(b,m){m=COG.extend({fill:false,simplify:false},m);var d=false,a=m.fill,c=m.simplify,f=M("ZOOM"),h=[],n=COG.extend(new va(m),{draw:function(k,i,s,e,y,H){if(d){i=true;s=(H&f)!==0;k.beginPath();for(H=h.length;H--;){s=h[H].x;e=h[H].y;if(i){k.moveTo(s,e);i=false}else k.lineTo(s,e);s=true}if(s){a&&k.fill();k.stroke()}}},resync:function(k){n.xy=
k.syncXY(b);h=O.floor(c?O.simplify(b):b)}});d=b&&b.length>=2;return n},ShapeLayer:function(b){function m(f){for(var h=a.length;h--;)a[h].resync(f);a.sort(function(n,k){var i=k.xy.y-n.xy.y;if(i===0)i=k.xy.x-n.xy.y;return i});c.changed()}function d(f,h){h.syncXY&&m(h)}b=COG.extend({zindex:80},b);var a=[],c=COG.extend(new P(b),{add:function(f){a[a.length]=f},each:function(f){for(var h=a.length;h--;)f(a[h])},draw:function(f,h,n){var k=h.x1,i=h.y1,s=h.width;h=h.height;for(var e=a.length;e--;){var y=a[e].style;
y=y?qa.apply(f,y):null;a[e].draw(f,k,i,s,h,n);y&&qa.apply(f,y)}}});c.bind("parentChange",d);c.bind("resync",d);return c},Tiling:Ja};COG.observable(Va);return Va}();
