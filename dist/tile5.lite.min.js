COG=function(){var i=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,j=0,e={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,f=arguments.length,b=false,k,d,h,g;if(typeof a==="boolean"){b=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!e.isFunction(a))a={};if(f===c){a=this;--c}for(;c<f;c++)if((k=arguments[c])!=null)for(d in k){h=a[d];g=k[d];if(a!==g)if(b&&g&&(e.isPlainObject(g)||e.isArray(g))){h=h&&(e.isPlainObject(h)||e.isArray(h))?h:e.isArray(g)?[]:{};a[d]=e.extend(b,h,g)}else if(g!==
undefined)a[d]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||m.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var f=a,b=arguments,k=1;if(c&&e.isArray(c)){b=c;k=0}for(k=k;k<b;k++)f=f&&typeof foo[b[k]]!=="undefined";return f},newModule:function(a){a=e.extend({id:null,requires:[],parent:null},a);if(a.parent)a=e.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+j++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,f=0;f<=c;f++)a=a.replace(RegExp("\\{"+f+"\\}","gi"),arguments[f+
1]);return a},wordExists:function(a,c){var f="";if(c.toString)c=c.toString();for(var b=0;b<c.length;b++)f+=!/\w/.test(c[b])?"\\"+c[b]:c[b];return RegExp("(^|\\s|\\,)"+f+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var f=i.exec(a);f;){a=a.replace(f[0],COG.XPath.first(f[1],c));i.lastIndex=0;f=i.exec(a)}return a}};return e}();
COG.Log=function(){function i(c,f){var b,k=f&&f.length>0?f[0]:"";for(b=1;f&&b<f.length;b++)k+=" "+(j&&COG.isPlainObject(f[b])?JSON.stringify(f[b]):f[b]);typeof console!=="undefined"&&console[c](k);for(b=0;b<m.length;b++)m[b].call(a,k,c)}var m=[],j=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(c,f){if(e)console.markTimeline(c+(f?": "+(a.getTraceTicks()-f)+"ms":""))},debug:function(){i("debug",
arguments)},info:function(){i("info",arguments)},warn:function(){i("warn",arguments)},error:function(){i("error",arguments)},exception:function(c){a.error(arguments);for(var f in c)a.info("ERROR DETAIL: "+f+": "+c[f])},watch:function(c,f){try{f()}catch(b){a.exception(b,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return a}();
(function(){function i(e,a){e[a]||(e[a]=function(c){return e.configure(a,c)})}function m(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var j={};COG.paramTweaker=function(e,a,c){return function(f,b){if(typeof b!=="undefined"){if(f in e)e[f]=b;c&&f in c&&c[f](f,b)}else return a&&f in a?a[f](f):e[f]}};COG.configurable=function(e,a,c,f){if(e){e.gtConfId||m(e);var b=e.gtConfId,k=e.gtConfig,d=e.gtConfigFns;j[b]=e;d.push(c);for(c=a.length;c--;){k[a[c]]=true;f&&
i(e,a[c])}if(!e.configure)e.configure=function(h,g){if(k[h]){for(var l=d.length;l--;){var o=d[l](h,g);if(typeof o!=="undefined")return o}return j[b]}return null}}}})();
(function(){function i(m,j){var e=m.gtObsHandlers;e[j]||(e[j]=[]);return e[j]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(j,e){var a=COG.objId("callback");i(m,j).unshift({fn:e,id:a});return a};m.trigger=function(j){var e=i(m,j),a={cancel:false,tickCount:(new Date).getTime()},c;if(!e)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var f=e.length;f--&&!a.cancel;)e[f].fn.apply(self,c);return a};m.unbind=
function(j,e){for(var a=i(m,j),c=0;a&&c<a.length;c++)if(a[c].id===e){a.splice(c,1);break}return m}}}}})();(function(){var i={},m=[];COG.addPipe=function(j){j("pipe.test",{});m.push(j)};COG.listen=function(j,e){i[j]||(i[j]=[]);e&&i[j].push(e)};COG.say=function(j,e){var a;for(a=m.length;a--;)m[a](j,e);if(i[j])for(a=i[j].length;a--;)i[j][a](e)}})();
COG.Loopage=function(){function i(g){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function m(g){b.push(g);j()}function j(){k&&clearTimeout(k);k=setTimeout(e,0);h=true}function e(){for(var g,l=(new Date).getTime(),o=f.length;b.length>0;){var v=b.shift();for(g=o;g--;)if(f[g].id===v){f.splice(g,1);break}h=true;o=f.length}if(h){d=a;for(g=o;g--;)d=f[g].frequency<d?f[g].frequency:d}for(g=o;g--;){v=l-f[g].lastTick;if(f[g].lastTick===0||v>=f[g].frequency){f[g].execute(l,
f[g]);f[g].lastTick=l;f[g].single&&f[g].trigger("complete")}}k=o?setTimeout(e,d):0}var a=6E4,c=0,f=[],b=[],k=0,d=a,h=true;return{join:function(g){var l=new i(g);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});f.unshift(l);j();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function i(d){return d<10?"0"+d:d}function m(d){a.lastIndex=0;return a.test(d)?'"'+d.replace(a,function(h){var g=b[h];return typeof g==="string"?g:"\\u"+("0000"+h.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function j(d,h){var g,l,o,v,y=c,n,p=h[d];if(p&&typeof p==="object"&&typeof p.toJSON==="function")p=p.toJSON(d);if(typeof k==="function")p=k.call(h,d,p);switch(typeof p){case "string":return m(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";c+=f;n=[];if(Object.prototype.toString.apply(p)==="[object Array]"){v=p.length;for(g=0;g<v;g+=1)n[g]=j(g,p)||"null";o=n.length===0?"[]":c?"[\n"+c+n.join(",\n"+c)+"\n"+y+"]":"["+n.join(",")+"]";c=y;return o}if(k&&typeof k==="object"){v=k.length;for(g=0;g<v;g+=1){l=k[g];if(typeof l==="string")if(o=j(l,p))n.push(m(l)+(c?": ":":")+o)}}else for(l in p)if(Object.hasOwnProperty.call(p,l))if(o=j(l,p))n.push(m(l)+(c?": ":":")+o);o=n.length===0?"{}":c?"{\n"+c+n.join(",\n"+c)+
"\n"+y+"}":"{"+n.join(",")+"}";c=y;return o}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,f,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(d,h,g){var l;f=c="";if(typeof g==="number")for(l=0;l<g;l+=1)f+=" ";else if(typeof g==="string")f=g;if((k=h)&&typeof h!=="function"&&(typeof h!=="object"||typeof h.length!=="number"))throw Error("JSON.stringify");return j("",
{"":d})};if(typeof JSON.parse!=="function")JSON.parse=function(d,h){function g(o,v){var y,n,p=o[v];if(p&&typeof p==="object")for(y in p)if(Object.hasOwnProperty.call(p,y)){n=g(p,y);if(n!==undefined)p[y]=n;else delete p[y]}return h.call(o,v,p)}var l;d=String(d);e.lastIndex=0;if(e.test(d))d=d.replace(e,function(o){return"\\u"+("0000"+o.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+d+")");return typeof h==="function"?g({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function i(j,e){var a=j.split("|"),c={};for(var f in e){var b=e[f];c[f]=a.length>b?a[b]:null}return c}var m={JSON:{parse:function(j){return JSON.parse(j)}},PDON:{parse:function(j){var e=null,a=[];j=j.split("\n");for(var c=0;c<j.length;c++){var f=j[c];if(e)a.push(i(f,e));else if(f){e=f.split("|");f={};for(var b=0;b<e.length;b++)f[e[b]]=b;e=f}else e=null}return a}}};COG.parseData=function(j,e){e=e?e.toUpperCase():"JSON";if(!m[e])throw Error("Unsupported data format: "+e);try{return m[e].parse(j)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function i(a){for(var c=null,f=0;f<m.length;f++)if(c=m[f](a))break;return c}var m=[],j=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var f=null;if(a.resultType>=0&&a.resultType<j.length)f=j[a.resultType];if(f)c=f(a)}return c?c:""}}},first:function(a,c){var f=e.SearchResult,b;var k=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!k)k=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))b=c.evaluate(a,c,i,k,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(d){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);b=null}return new f(b)},registerResolver:function(a){m.push(a)}};return e}();
COG.Storage=function(){function i(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,j){var e=i(j).getItem(m);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(m,j,e){j=jQuery.isArray(j)||jQuery.isPlainObject(j)?JSON.stringify(j):j;i(e).setItem(m,j)},remove:function(m,j){i(j).removeItem(m)}}}();
COG.ParseRules=function(){var i=[];return{add:function(m,j){i.push({regex:m,handler:j})},each:function(m,j,e){function a(){c++;e&&c>=i.length&&e(j)}for(var c=0,f=0;f<i.length;f++){var b=i[f].regex,k=i[f].handler,d=false;if(b){b.lastIndex=-1;if((b=b.exec(m))&&k){d=true;k(b,j,a)&&a()}}d||a()}}}};
(function(){function i(b){var k=[],d=function(g,l){l=COG.isFunction(l)?l():l;k[k.length]=encodeURIComponent(g)+"="+encodeURIComponent(l)};if(COG.isArray(b))for(var h=0;h<b.length;h++)d(b[h].name,b[h].value);else for(h in b)d(h,b[h]);return k.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},j={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},f={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function k(){if(this.readyState===4){var l=null,o=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(o)if(b.handleResponse)b.handleResponse(this);else{var v=b,y=this.getResponseHeader(f.CONTENT_TYPE),n,p=false;for(n in m)if(y&&y.indexOf(m[n])>=0){p=true;
break}y=!p;for(p=0;p<e.length;p++)y=y||e[p]==n;if(y)b:{y=n;for(var u in j)for(p=0;p<j[u].length;p++)if(RegExp(j[u][p]+"$","i").test(v.url)){n=u;break b}n=y?y:"DEFAULT"}try{l=c[n](this,v)}catch(A){l=c.DEFAULT(this,v)}}else b.error&&b.error(this)}catch(E){COG.Log.exception(E,"PROCESSING AJAX RESPONSE")}o&&l&&b.success&&b.success.call(this,l)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var d=
a.exec(b.url),h=d&&(d[1]&&d[1]!==location.protocol||d[2]!==location.host);if(b.data)b.method="POST";if(b.url){d=null;if(b.xhr)d=b.xhr(b);d||(d=new XMLHttpRequest);d.open(b.method,b.url,b.async);b.data&&d.setRequestHeader("Content-Type",b.contentType);h||d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.onreadystatechange=k;d.send(b.method=="POST"?i(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function i(a){var c=document.createElement("script"),f=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!f&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};j||(j=document.getElementsByTagName("head")[0]);j.appendChild(c)}var m=0,j,e=this;COG.jsonp=function(a,c,f){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++m;e[b]=function(k){c(k);e[b]=null;try{delete e[b]}catch(d){}};
i(a+(f?f:"callback")+"="+b);return b}})();
COG.Touch=function(){function i(t,w){return{x:t.x-w.x,y:t.y-w.y}}function m(t,w){var D=i(t,w);return Math.sqrt(D.x*D.x+D.y*D.y)}function j(t){if(t.count>1)return m(t.touches[0],t.touches[1]);return 0}function e(t,w){var D=t&&t.count>0?t.touches[0]:null;if(D&&w&&w.count>0)return i(D,w.touches[0]);return null}function a(t,w){t.count=w.count;for(var D=d;D--;){t.touches[D].x=w.touches[D].x;t.touches[D].y=w.touches[D].y}}function c(){for(var t={count:0,touches:Array(d)},w=d;w--;)t.touches[w]=k();return t}
function f(t){if(t.preventDefault){t.preventDefault();t.stopPropagation()}else t.cancelBubble&&t.cancelBubble()}function b(t,w,D){if(J){w=w[D?D:"touches"];D=w.length;for(D=t.count=D;D--;){t.touches[D].x=w[D].pageX;t.touches[D].y=w[D].pageY}}else if(w.button===0){t.count=1;t.touches[0].x=w.pageX?w.pageX:w.screenX;t.touches[0].y=w.pageY?w.pageY:w.screenY}else t.count=0}function k(t,w){return{x:t?t:0,y:w?w:0}}var d=10,h=120,g=100,l=250,o=300,v=5,y=0,n=1,p=2,u=7,A=0,E=0,J=undefined,H=function(t){function w(s,
x,C,B){var q=Math.asin((s.y-x.y)/C);C=C*(sa/B)>>0;C=C>qa?qa:C;q=x.x>s.x?q:Math.PI-q;P("pan",Math.cos(q)*-C,Math.sin(q)*C,true)}function D(s,x){var C,B;if(J){C=x-la;if(C<l){B=m(K.touches[0],s);B>t.inertiaTrigger&&w(K.touches[0],s,B,C)}}else{Q.x=s.x;Q.y=s.y;COG.Loopage.join({execute:function(q,r){C=q-x;B=m(s,Q);if(C<g&&B>t.inertiaTrigger){r.trigger("complete");w(s,Q,B,C)}else C>g&&r.trigger("complete")},frequency:10})}}function R(s){var x=0,C=0;if(s.offsetParent){do{x+=s.offsetLeft;C+=s.offsetTop;s=
s.offsetParent}while(s)}return k(x,C)}function ia(s){var x=s.count,C=Array(x),B=R(S);for(x=x;x--;)C[x]=k(s.touches[x].x-B.x,s.touches[x].y-B.y);return C}function P(){ga&&ga.trigger.apply(null,arguments)}function ra(s,x){var C=R(S);C=k(x.x-C.x,x.y-C.y);P(s,x,C)}function N(s){var x=s.target?s.target:s.srcElement;if(ma||x&&x===S){b(K,s);if(K.count!==0){ca=null;da.x=0;da.y=0;F=true;V=false;la=(new Date).getTime();f(s);x.style.cursor="move";P("inertiaCancel");na=la;if(s=K.count>0?K.touches[0]:null){P("touchStart",
s.x,s.y);if(na-oa<o)if((s=i(K.touches[0],Y.touches[0]))&&Math.abs(s.x)<t.maxDistDoubleTap&&Math.abs(s.y)<t.maxDistDoubleTap)V=true;W=y;a(Y,K)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function pa(s){var x=s.target?s.target:s.srcElement,C=0;if(ma||x&&x===S){b(T,s);if(T.count>0){Q.x=T.touches[0].x;Q.y=T.touches[0].y}if(F){J&&f(s);if(T.count>1){K.count===1&&a(K,T);C=j(K)-j(T)}if(W===y)if((s=e(T,K))&&(Math.abs(s.x)>=u||Math.abs(s.y)>=u))W=n;if(W!==y)if(!C||Math.abs(C)<v){if(ca=
e(T,Y)){da.x-=ca.x;da.y-=ca.y;ea.x-=ca.x;ea.y-=ca.y}P("pan",ea.x,ea.y);ea.x=0;ea.y=0;W=n}else{P("pinchZoom",ia(K),ia(T));W=p}a(Y,T)}}}function L(s){var x=s.target?s.target:s.srcElement;if(F&&(ma||x&&x===S)){b(Z,s,"changedTouches");var C=Z.touches[0];J&&f(s);s=(new Date).getTime();oa=na;if(W===y){ra("tap",K.touches[0]);fa||(fa=setTimeout(function(){fa=0;V&&ra("doubleTap",K.touches[0])},o+50))}else if(W==n){P("panEnd",da.x,da.y);$&&D(C,s)}else W==p&&P("pinchZoomEnd",ia(K),ia(Y),s-la);x.style.cursor=
"default";F=false}}function ha(s){var x=s.target?s.target:s.srcElement;if(ma||x&&x===S){if(s.detail){x=-s.detail*h;x=k(s.axis===1?x:0,s.axis===2?x:0)}else x=k(s.wheelDeltaX,s.wheelDeltaY);var C=x.y!==0?Math.abs(x.y/h):0;if(Q&&C!==0){var B=k(Q.x-S.offsetLeft,Q.y-S.offsetTop);P("wheelZoom",B,Math.pow(2,x.y>0?C:-C))}f(s)}}t=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,
tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},t);var V=false,fa=0,aa=T5.getConfig(),K=c(),T=c(),Y=c(),Z=c(),ca=null,da=k(),ea=k(),W=null,F=false,la=0,ja=[],Q=k(),$=false,sa,qa,na=0,oa=0,S=t.element,ga=t.observable,ma=typeof FlashCanvas!=="undefined",X={supportsTouch:J,addListeners:function(s){ja.push(s)},decoupleListeners:function(s){for(var x=0;s&&x<ja.length;x++)if(ja[x].listenerId===s){ja.splice(x,1);break}},release:function(){aa.unbindEvent(J?"touchstart":"mousedown",N,false);aa.unbindEvent(J?
"touchmove":"mousemove",pa,false);aa.unbindEvent(J?"touchend":"mouseup",L,false);if(!J){window.removeEventListener("mousewheel",ha,false);window.removeEventListener("DOMMouseScroll",ha,false)}},inertiaEnable:function(s,x){$=true;sa=s;qa=x?Math.min(x.width,x.height):500},inertiaDisable:function(){$=false}};if(typeof J==="undefined")J=T5.getConfig().supportsTouch;aa.bindEvent(J?"touchstart":"mousedown",N,false);aa.bindEvent(J?"touchmove":"mousemove",pa,false);aa.bindEvent(J?"touchend":"mouseup",L,false);
if(!J){aa.bindEvent("mousewheel",ha,window);aa.bindEvent("DOMMouseScroll",ha,window)}return X},ba=[];return{capture:function(t,w){if(!t)throw Error("Unable to capture touch of null element");if(!t.id)t.id="touchable_"+A++;var D=ba[t.id];if(!D){D=new H(COG.extend({element:t},w));ba[t.id]=D}if(w){w.listenerId&&D.decoupleListeners(w.listenerId);w.listenerId=++E;D.addListeners(w)}return D},release:function(t){if(t&&t.id&&ba[t.id]){ba[t.id].release();delete ba[t.id]}}}}();
T5=function(){var i=function(){function a(b,k){return f(b.x-k.x,b.y-k.y)}function c(b,k){if(!k)k=b.length;if(k<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var d={edges:Array(k-1),accrued:Array(k-1),total:0},h=0;h<k-1;h++){var g=a(b[h],b[h+1]);d.edges[h]=Math.sqrt(g.x*g.x+g.y*g.y);d.accrued[h]=d.total+d.edges[h];d.total+=d.edges[h]}return d}function f(b,k){return{x:b?b:0,y:k?k:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,k=0,d=arguments.length;d--;){b+=arguments[d].x;k+=arguments[d].y}return f(b,k)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?f(b.x,b.y):null},diff:a,distance:function(b,k){return c(b,k).total},edges:c,equals:function(b,k){return b.x===k.x&&b.y===k.y},extendBy:function(b,k,d){return f(b.x-Math.cos(k)*d,b.y-Math.sin(k)*d)},floor:function(b){for(var k=Array(b.length),d=b.length;d--;)k[d]=f(~~b[d].x,~~b[d].y);return k},getRect:function(b){for(var k,d,h,
g,l=b.length;l--;){var o=b[l];k=typeof k==="undefined"||o.x<k?o.x:k;d=typeof d==="undefined"||o.y<d?o.y:d;h=typeof h==="undefined"||o.x>h?o.x:h;g=typeof g==="undefined"||o.y>g?o.y:g}return j.init(k,d,g,g)},init:f,invert:function(b){return f(-b.x,-b.y)},offset:function(b,k,d){return f(b.x+k,b.y+(d?d:k))},simplify:function(b,k){if(!b)return null;k=k?k:i.VECTOR_SIMPLIFICATION;for(var d=[],h=null,g=b.length;g--;){var l=b[g];if(include=!h||g===0||Math.abs(l.x-h.x)+Math.abs(l.y-h.y)>k){d.unshift(l);h=l}}return d},
theta:function(b,k,d){d=Math.asin((b.y-k.y)/d);return b.x>k.x?d:Math.PI-d}}}(),m=function(){return{dotProduct:function(a,c){return a.x*c.x+a.y*c.y}}}(),j=function(){function a(c,f,b,k){c=c?c:0;f=f?f:0;b=typeof b!=="undefined"?b:c;k=typeof k!=="undefined "?k:k;return{x1:c,y1:f,x2:b,y2:k,width:b-c,height:k-f}}return{center:function(c){return i.init(c.x1+c.width/2,c.y1+c.height/2)},copy:function(c){return a(c.x1,c.y1,c.x2,c.y2)},diagonalSize:function(c){return Math.sqrt(c.width*c.width+c.height*c.height)},
fromCenter:function(c,f,b,k){b=~~(b/2);k=~~(k/2);return a(c-b,f-k,c+b,f+k)},init:a,intersect:function(c,f){var b=a(Math.max(c.x1,f.x1),Math.max(c.y1,f.y1),Math.min(c.x2,f.x2),Math.min(c.y2,f.y2));return b.width>0&&b.height>0?b:null}}}(),e=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return i.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,c){a=a?a:0;return{width:a,
height:c?c:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:i,XYRect:j,Vector:function(a,c){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return i.init(a,c)},V:COG.extend(i,m),D:e}}();
(function(){function i(){for(;v.length>0;){var n=v.shift();document.location=n}o=0}function m(n){for(var p=true,u=y.length;u--;)p=p&&n!=y[u];return p}function j(n,p){var u=[];for(var A in p)A&&u.push(A+"="+escape(p[A]));return"tile5://"+n+"/"+(u.length>0?"?"+u.join("&"):"")}function e(n,p){m(n)&&COG.Log.info("would push url: "+j(n,p))}function a(n,p){if(m(n)){v.push(j(n,p));o||(o=setTimeout(i,100))}}function c(n){return function(p,u,A){(A?A:n?document.body:document).addEventListener(p,u,false)}}function f(n){return function(p,
u,A){(A?A:n?document.body:document).removeEventListener(p,u,false)}}function b(n,p,u){(u?u:document).attachEvent("on"+n,p)}function k(n,p,u){(u?u:document).detachEvent("on"+n,p)}function d(){h={base:{name:"Unknown",bindEvent:c(),unbindEvent:f(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:k,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:f(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[h.froyo,h.android,h.ipod,h.iphone,h.ipad,h.ie]}var h=null,g=[],l=null,o=0,v=[],y=["view.wake","tile.loaded"];T5.getConfig=function(){h||d();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var n=0;n<g.length;n++){var p=g[n];if(p.regex&&p.regex.test(navigator.userAgent)){l=T5.ex({},h.base,p);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=h.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var i=[],m={execute:function(j){var e=m.findAction(j);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(j){for(var e=i.length;e--;)if(i[e].id==j)return i[e];return null},getRegisteredActions:function(){return[].concat(i)},getRegisteredActionIds:function(){for(var j=[],e=i.length;e--;)i[e].id&&j.push(i[e].id);return j},registerAction:function(j){j&&j.id&&i.push(j)},Action:function(j){j=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},j);var e={id:j.id,execute:function(){j.execute&&j.execute.apply(this,arguments)},getParam:function(a){return j[a]?j[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,j.title,j.icon)}};j.autoRegister&&m.registerAction(e);return e},Agent:function(j){j=COG.extend({name:"Untitled",translator:null,execute:null},j);var e={getName:function(){return j.name},getParam:function(a){return j[a]},getId:function(){return COG.toID(e.getName())},run:function(a,c){if(j.execute){var f=
j.translator?j.translator(a):a;j.execute.call(e,f,function(b,k){c&&c(b,k,f)})}}};return e},runAgents:function(j,e,a){for(var c=0;c<j.length;c++)j[c].run(e,a)}};return m}();
T5.Resources=function(){var i="",m={},j={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:i+e},setBasePath:function(e){i=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var a=function(c){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(c)})};e.cacheable&&m[e.filename]?a(m[e.filename]):COG.xhr({url:j.getPath(e.filename),dataType:e.dataType,success:function(c){if(e.cacheable)m[e.filename]=c;a(c)},error:function(c,f,b){COG.Log.error("error loading resource ["+
e.filename+"], error = "+b)}})},loadSnippet:function(e,a){/\.\w+$/.test(e)||(e+=".html");j.loadResource({filename:"snippets/"+e,callback:a,dataType:"html"})}};return j}();
T5.Images=function(){function i(){if(!o){var n=T5.getConfig().maxImageLoads;o=COG.Loopage.join({execute:function(p,u){if(!n||h.length<n){var A=d.shift();if(A){h[h.length]=A;A.image.onload=j;A.image.src=T5.Resources.getPath(A.url);A.requested=T5.ticks()}else u.trigger("complete")}},frequency:10});o.bind("complete",function(){o=null})}}function m(){v=true;try{var n=g.length/2>>0;if(n>0){g.sort(function(u,A){return u.created-A.created});for(var p=n;p--;)delete c[g[p].url];g.splice(0,n)}}finally{v=false}COG.say("imagecache.cleared")}
function j(){var n=b[this.id],p;if(n&&n.image.complete&&n.image.width>0){n.loaded=true;n.hitCount=1;for(p=h.length;p--;)if(h[p].image.src==this.src){h.splice(p,1);break}if(n.background||n.postProcess||n.drawBackground||n.customDraw)if(n.image){globalImageData=n;p=a(n.realSize?n.realSize.width:n.image.width,n.realSize?n.realSize.height:n.image.height);var u=p.getContext("2d"),A=n.offset?n.offset:T5.XY.init();n.background&&u.drawImage(n.background,0,0);n.drawBackground&&n.drawBackground(u);n.customDraw?
n.customDraw(u,n):u.drawImage(n.image,A.x,A.y);n.postProcess&&n.postProcess(u,n);n.image=p}for(p=n.callbacks.length;p--;)n.callbacks[p]&&n.callbacks[p](this,false);n.callbacks=[];g[g.length]={url:this.src,created:n.requested};delete b[this.id];i()}}function e(n,p,u){var A=c[n];if(A){A.hitCount++;A.image.complete&&A.image.width>0&&p?p(A.image,true):A.callbacks.push(p)}else{A=T5.ex({url:n,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[p]},u);A.image.id="resourceLoaderImage"+
k++;c[n]=A;b[A.image.id]=A;d[d.length]=A;i()}return A}function a(n,p){var u=document.createElement("canvas");u.width=n?n:0;u.height=p?p:0;if(typeof FlashCanvas!=="undefined"){u.id="tmpCanvas"+f++;u.style.cssText="position: absolute; top: -"+(p-1)+"px; left: -"+(n-1)+"px;";document.body.appendChild(u);FlashCanvas.initElement(u)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(u);return u}var c={},f=0,b={},k=0,d=[],h=[],g=[],l=0,o=null,v=false,y={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){h=[]},get:function(n,p,u){var A=null,E=null;v||(A=c[n]);if((E=A?A.image:null)&&(E.getContext||E.complete&&E.width>0))return E;else p&&e(n,p,u);return null},load:e,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:h.length,queuedImageCount:d.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(n){for(var p=false,u=0,A=T5.getConfig();u<h.length;)if(n-h[u].requested>y.loadTimeout*1E3){h.splice(u,1);p=true}else u++;p&&i();if(A&&A.imageCacheMaxSize){l=
g.length*y.avgImageSize/A.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return y}();T5.Generator=function(){var i={};return{init:function(m,j){var e=i[m];if(!e)throw Error("Unable to locate requested generator: "+m);return new e(j)},register:function(m,j){i[m]=j},Template:function(){}}}();
T5.TimeLord=function(){var i=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,j=function(a,c){return{days:a?a:0,seconds:c?c:0}},e={8601:function(a){a=a.split("T");var c=null;c=null;var f=0,b=0;i.lastIndex=-1;c=i.exec(a[0]);f+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(a[1]);b+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;b+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;b+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new j(f,b)}};return{Duration:j,addDuration:function(){for(var a=new j,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var f=c?e[c]:null;if(f)return f(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new j},formatDuration:function(a){var c,f,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){f=Math.round(a/60);a-=f*60}if(c)b=b+c+(c>1?" hrs ":" hr ")+
(f?(f>10?f:"0"+f)+" min ":"");else if(f)b=b+f+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
(function(){var i=Math.PI*2,m=Math.PI/2,j=Math.abs,e=Math.pow,a=Math.sin,c=Math.asin,f=Math.cos,b=1.70158,k={linear:function(d,h,g,l){return g*d/l+h},backin:function(d,h,g,l){return g*(d/=l)*d*((b+1)*d-b)+h},backout:function(d,h,g,l){return g*((d=d/l-1)*d*((b+1)*d+b)+1)+h},backinout:function(d,h,g,l){return(d/=l/2)<1?g/2*d*d*(((b*=1.525)+1)*d-b)+h:g/2*((d-=2)*d*(((b*=1.525)+1)*d+b)+2)+h},bouncein:function(d,h,g,l){return g-k.bounceout(l-d,0,g,l)+h},bounceout:function(d,h,g,l){return(d/=l)<1/2.75?
g*7.5625*d*d+h:d<2/2.75?g*(7.5625*(d-=1.5/2.75)*d+0.75)+h:d<2.5/2.75?g*(7.5625*(d-=2.25/2.75)*d+0.9375)+h:g*(7.5625*(d-=2.625/2.75)*d+0.984375)+h},bounceinout:function(d,h,g,l){return d<l/2?k.bouncein(d*2,0,g,l)/2+h:k.bounceout(d*2-l,0,g,l)/2+g/2+h},cubicin:function(d,h,g,l){return g*(d/=l)*d*d+h},cubicout:function(d,h,g,l){return g*((d=d/l-1)*d*d+1)+h},cubicinout:function(d,h,g,l){if((d/=l/2)<1)return g/2*d*d*d+h;return g/2*((d-=2)*d*d+2)+h},elasticin:function(d,h,g,l,o,v){if(d==0)return h;if((d/=
l)==1)return h+g;v||(v=l*0.3);if(!o||o<j(g)){o=g;g=v/4}else g=v/i*c(g/o);return-(o*e(2,10*(d-=1))*a((d*l-g)*i/v))+h},elasticout:function(d,h,g,l,o,v){var y;if(d==0)return h;if((d/=l)==1)return h+g;v||(v=l*0.3);if(!o||o<j(g)){o=g;y=v/4}else y=v/i*c(g/o);return o*e(2,-10*d)*a((d*l-y)*i/v)+g+h},elasticinout:function(d,h,g,l,o,v){var y;if(d==0)return h;if((d/=l/2)==2)return h+g;v||(v=l*0.3*1.5);if(!o||o<j(g)){o=g;y=v/4}else y=v/i*c(g/o);if(d<1)return-0.5*o*e(2,10*(d-=1))*a((d*l-y)*i/v)+h;return o*e(2,
-10*(d-=1))*a((d*l-y)*i/v)*0.5+g+h},quadin:function(d,h,g,l){return g*(d/=l)*d+h},quadout:function(d,h,g,l){return-g*(d/=l)*(d-2)+h},quadinout:function(d,h,g,l){if((d/=l/2)<1)return g/2*d*d+h;return-g/2*(--d*(d-2)-1)+h},sinein:function(d,h,g,l){return-g*f(d/l*m)+g+h},sineout:function(d,h,g,l){return g*a(d/l*m)+h},sineinout:function(d,h,g,l){return-g/2*(f(Math.PI*d/l)-1)+h}};T5.easing=function(d){return k[d.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(d,h){k[d.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=h}})();
T5.Tween=function(i){i=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},i);var m=T5.ticks(),j=[],e=false,a=0,c=0,f={cancelOnInteract:i.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(b){i.complete&&i.complete(b)},update:function(b){try{var k=i.tweenFn(b-m,a,c,i.duration);if(i.target)i.target[i.property]=k;for(var d=j.length;d--;)j[d](k,void 0);if(e=m+i.duration<=b){if(i.target)i.target[i.property]=
i.tweenFn(i.duration,a,c,i.duration);for(var h=j.length;h--;)j[h](k,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(b){j.push(b)}};a=i.target&&i.property&&i.target[i.property]?i.target[i.property]:i.startValue;if(typeof i.endValue!=="undefined")c=i.endValue-a;if(c==0)e=true;T5.wakeTweens();return f};
(function(){function i(a){if(e)return m.length;e=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(a);c++}}finally{e=false}m.length===0&&j.trigger("complete");return m.length}var m=[],j=null,e=false;T5.tweenValue=function(a,c,f,b,k){a=new T5.Tween({startValue:a,endValue:c,tweenFn:f,complete:b,duration:k});m.push(a);return a};T5.tween=function(a,c,f,b,k,d){a=new T5.Tween({target:a,property:c,endValue:f,tweenFn:b,duration:d,complete:k});
m.push(a);return a};T5.tweenVector=function(a,c,f,b,k,d){var h=[];if(a){var g=a.x==c,l=a.y==f;g||h.push(T5.tween(a,"x",c,b,function(){(g=true)&&l&&k()},d));l||h.push(T5.tween(a,"y",f,b,function(){l=true;g&&l&&k()},d))}return h};T5.cancelAnimation=function(a){if(!e){e=true;try{for(var c=0;c<m.length;)if(!a||a(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{e=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!j){j=COG.Loopage.join({execute:i,frequency:20});
j.bind("complete",function(){j=null})}}})();(function(){var i={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,j=arguments.length;j--;){var e=i[arguments[j].toUpperCase()];if(e)m|=e}return m}})();
T5.ViewLayer=function(i){i=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null},i);var m=null,j=false,e=false,a=i.supportFastDraw,c=i.id,f=T5.viewState("ACTIVE"),b=i.validStates,k=0,d=0,h=T5.ex({addToView:function(g){g.setLayer(c,h)},shouldDraw:function(g,l,o){g=(g&b)!==0&&(j?a:true);return g=e||o||k!==l.x||d!==l.y},cycle:function(){},draw:function(){},remove:function(){h.trigger("remove",h)},changed:function(){e=true;h.trigger("changed",
h);m&&m.trigger("invalidate")},getId:function(){return c},setId:function(g){c=g},getParent:function(){return m},setParent:function(g){j=(m=g)?m.fastDraw&&displayState!==f:false;h.trigger("parentChange",m)}},i);COG.observable(h);h.bind("drawComplete",function(g,l){e=false;k=l.x;d=l.y});return h};
T5.View=function(i){function m(q,r,z,G){X=S;u();if(G&&i.inertia){V=true;d(t+r,w+z,i.panAnimationEasing,i.panAnimationDuration)}else G||d(t+r,w+z)}function j(){X=oa;V=false;COG.Loopage.join({execute:u,after:50,single:true})}function e(q,r){Z=s(q);ca=s(r);var z=x(Z),G=x(ca);$=C(Z);L=C(ca);F=Z&&z!==0?G/z:1}function a(q,r,z){e(r,z);if(Y=F!==1){X=ga;u()}}function c(q,r,z,G){e(r,z);if(i.adjustScaleFactor){F=i.adjustScaleFactor(F);COG.Log.info("scale factor adjusted to: "+F)}if(G<i.pinchZoomAnimateTrigger){l(ja,
F,$,o(),T5.easing("sine.out"),function(){b();F=1},300);F=ja}else{b();F=1}}function f(q,r,z){B.zoom(r,Math.min(Math.pow(2,Math.round(Math.log(z))),8),500)}function b(){var q=Z?o():L;F=Math.round(F*10)/10;Y=false;for(var r=E.length;r--;)E[r].trigger("scale",F,q);B.trigger("scale",F,q);X=oa;u()}function k(){clearTimeout(W);W=setTimeout(h,50)}function d(q,r,z,G,I){function M(){O+=1;if(O>=2){j(0,0);I&&I()}}var O=0;if(z){q=T5.tweenValue(t,q,z,M,G);r=T5.tweenValue(w,r,z,M,G);q.cancelOnInteract=true;q.requestUpdates(function(U){t=
U;V=true;u()});r.cancelOnInteract=true;r.requestUpdates(function(U){w=U;V=true;u()})}else{t=q;w=r}}function h(){var q;if(H){COG.Touch.release(H);if(i.autoSize&&H.parentNode){q=H.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){H.height=q.height;H.width=q.width}}try{if(!H.id)H.id=i.id+"_canvas";ba=H.getContext("2d");ba.clearRect(0,0,H.width,H.height)}catch(r){COG.Log.exception(r);throw Error("Could not initialise canvas on specified view element");}na=COG.Touch.capture(H,{observable:B});
if(N.height!==H.height||N.width!==H.width){N=T5.D.init(H.width,H.height);B.trigger("resize",H.width,H.height);for(q=J;q--;)E[q].trigger("resize",H.width,H.height)}i.inertia&&na.inertiaEnable(i.panAnimationDuration,N);for(q=J;q--;)E[q].trigger("contextChanged",ba);p()}}function g(q,r){r.setId(q);r.added=T5.ticks();r.bind("remove",function(){B.removeLayer(q)});r.trigger("contextChanged",ba);r.setParent(B);E.push(r);E.sort(function(z,G){var I=G.zindex-z.zindex;if(I===0)I=G.added-z.added;return I});J=
E.length;return r}function l(q,r,z,G,I,M,O){function U(){M&&M();b();F=1;Q=null}Y=true;$=T5.XY.offset(z,R.x1,R.y1);L=T5.XY.offset(G,R.x1,R.y1);Z=null;COG.Log.info("zoom from: ",$);COG.Log.info("zoom to:   ",L);if(I)T5.tweenValue(0,r-q,I,U,O?O:1E3).requestUpdates(function(ka){Q=ka/(r-q);F=q+ka;X=ga;u();B.trigger("animate")});else{F=r;U()}}function o(){var q=T5.D.getCenter(N),r=T5.XY.distance([L,q]);q=T5.XY.theta(L,q,r);var z=T5.XY.diff($,L);q=T5.XY.extendBy(L,q,r/F);q.x+=z.x;q.y+=z.y;return q}function v(){A(ha,
B);ha=true;fa=0}function y(q,r,z,G,I){var M=(r&ga)!==0,O=T5.XYRect.copy(z),U=0;q.clearRect(0,0,H.width,H.height);if(ia||M)ia=false;if(M){T5.D.getCenter(N);var ka=(Q?Q:1)/2,ta=T5.XY.diff($,L);if(Z){K.x=L.x+ta.x;K.y=L.y+ta.y}else{K.x=L.x-ta.x*ka;K.y=L.y-ta.y*ka}}q.save();try{ja=F;if(M){M=1/F;ka=(M-0.5)/0.5;O=T5.XYRect.fromCenter(L.x-(L.x-t)*ka,L.y-(L.y-w)*ka,~~(O.width*M),~~(O.height*M));q.scale(F,F)}q.translate(-O.x1,-O.y1);for(U=J;U--;)if(E[U].shouldDraw(r,z,G)){var ua=E[U].style,va=ua?T5.Style.apply(q,
ua):null;E[U].draw(q,O,r,B,G,I);va&&T5.Style.apply(q,va);E[U].trigger("drawComplete",O,I)}}finally{q.restore()}B.trigger("drawComplete",z,I);COG.Log.trace("draw complete",I)}function n(q,r){var z=false,G=da?da:V?S:X,I=!V&&(G===ga||G===S),M=ea||G===S||G===ga||T5.isTweening();D=T5.XY.init(t>>0,w>>0);R=T5.XYRect.fromCenter(D.x,D.y,N.width,N.height);if(I){T5.cancelAnimation(function(O){return O.cancelOnInteract});ha=false;if(fa!==0){clearTimeout(fa);fa=0}}for(I=J;I--;){if(E[I].animated)X|=ma;z=E[I].cycle(q,
R,X,M)||z}M=M||(X&ma)!==0;if(z=z||M||F!==1&&F!==la){y(ba,G,R,M,q);la=F;ea=false}if(!z&&pa===0&&!sa){if(!ha&&fa===0)fa=setTimeout(v,500);r.trigger("complete")}pa=0;COG.Log.trace("Completed draw cycle",q)}function p(){ea=true;u()}function u(){pa+=1;if(!P){P=COG.Loopage.join({execute:n,frequency:qa});P.bind("complete",function(){P=null})}}function A(){B.trigger.apply(null,arguments);for(var q=E.length;q--;)E[q].trigger.apply(null,arguments)}i=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,
pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},i);var E=[],J=0,H=document.getElementById(i.container),ba=null,t=0,w=0,D=null,R=null,ia=false,P=null,ra=1,N=T5.D.init(),pa=0,L=null,ha=false,V=false,fa=0,aa=0,K=T5.XY.init(),T=0,Y=false,Z=null,ca=null,da=null,ea=false,W=0,F=1,la=0,ja=1,Q=null,$=null,sa=typeof FlashCanvas!=="undefined",qa=~~(1E3/i.fps),na=null,oa=T5.viewState("ACTIVE"),
S=T5.viewState("PAN"),ga=T5.viewState("ZOOM"),ma=T5.viewState("ANIMATING"),X=oa,s=T5.XY.getRect,x=T5.XYRect.diagonalSize,C=T5.XYRect.center,B={id:i.id,deviceScaling:ra,fastDraw:i.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,r,z,G,I){l(F,q,r,z,G,I)},centerOn:function(q){t=q.x-H.width/2;w=q.y-H.height/2},getDimensions:function(){return N},getZoomCenter:function(){return K},getLayer:function(q){for(var r=0;r<J;r++)if(E[r].getId()==q)return E[r];return null},setLayer:function(q,r){for(var z=
0;z<J;z++)if(E[z].getId()===q){E.splice(z,1);break}r&&g(q,r);p();return r},eachLayer:function(q){for(var r=J;r--;)q(E[r])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");ia=true;p()},invalidate:p,resize:function(q,r){if(H){i.autoSize=false;H.width=q;H.height=r;h();B.trigger("resize",H.width,H.height)}},scale:function(q,r,z,G,I){G||(G=T5.D.getCenter(N));I||(I=T5.D.getCenter(N));B.animate(q,G,I,r,z);return B},triggerAll:A,removeLayer:function(q){a:{for(var r=J;r--;)if(E[r].getId()==
q){q=r;break a}q=-1}if(q>=0&&q<J){COG.say("layer.removed",{layer:E[q]});E.splice(q,1);p()}J=E.length},stateOverride:function(q){da=q},getOffset:function(){return D?D:T5.XY.init(t,w)},getViewRect:function(){return R?R:T5.XYRect.fromCenter(t,w,N.width,N.height)},updateOffset:d,pan:function(q,r,z,G,I){d(t+q,w+r,z,G,I)},zoom:function(q,r,z){V=false;F=r;Y=F!==1;$=T5.D.getCenter(N);L=T5.XY.offset(F>1?T5.XY.copy(q):T5.D.getCenter(N),R.x1,R.y1);Z=null;clearTimeout(aa);if(Y){X=ga;u();if(z)aa=setTimeout(function(){b();
F=1},parseInt(z,10))}}};ra=T5.getConfig().getScaling();B.markers=g("markers",new T5.MarkerLayer);COG.observable(B);B.bind("wake",u);B.bind("invalidate",p);if(i.pannable){B.bind("pan",m);B.bind("panEnd",j);B.bind("inertiaCancel",function(){V=false;u()})}if(i.scalable){B.bind("pinchZoom",a);B.bind("pinchZoomEnd",c);B.bind("wheelZoom",f)}B.bind("tap",function(q,r,z){for(var G=T5.XY.offset(z,t,w),I=E.length;I--;)q.cancel=q.cancel||E[I].trigger("tap",r,z,G).cancel});COG.configurable(B,["inertia","container",
"rotation","tapExtent","scalable","pannable"],COG.paramTweaker(i,null,{container:function(q,r){H=document.getElementById(r);h()},rotation:function(q,r){T=r}}),true);h();i.autoSize&&window.addEventListener("resize",k,false);return B};
T5.PathLayer=function(i){i=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},i);var m=false,j=[],e=null,a=[],c=null,f=0,b=[],k=T5.ex(new T5.ViewLayer(i),{getAnimation:function(d,h,g,l){var o="pathAnimation"+f++;b.push(o);return new T5.AnimatedPathLayer({id:o,path:j,zindex:i.zindex+1,easing:d?d:T5.easing("sine.inout"),duration:h?h:5E3,drawIndicator:g,autoCenter:l?l:false})},cycle:function(d,h,g,l){return l},draw:function(d){var h,g=j.length;d.save();try{T5.Style.apply(d,i.style);if(g>0){d.beginPath();
d.moveTo(j[g-1].x,j[g-1].y);for(h=g;h--;)d.lineTo(j[h].x,j[h].y);d.stroke();if(e){d.fillStyle=i.waypointFillStyle;for(h=e.length;h--;){d.beginPath();d.arc(e[h].x,e[h].y,2,0,Math.PI*2,false);d.stroke();d.fill()}}}}finally{d.restore()}m=false},updateCoordinates:function(d,h){a=d;c=h;var g=k.getParent();if(g&&g.syncXY){g.syncXY(a);c&&g.syncXY(c);k.trigger("tidy")}}});k.bind("tidy",function(){j=T5.XY.simplify(a,i.pixelGeneralization);e=T5.XY.simplify(c,i.pixelGeneralization);m=true;k.changed()});return k};
T5.ShapeLayer=function(i){function m(f){for(var b=e.length;b--;)e[b].resync(f);e.sort(function(k,d){var h=d.xy.y-k.xy.y;if(h===0)h=d.xy.x-k.xy.y;return h});a=true;c.changed()}function j(f,b){b.syncXY&&m(b)}i=T5.ex({zindex:80},i);var e=[],a=false,c=T5.ex(new T5.ViewLayer(i),{add:function(f){e[e.length]=f},each:function(f){for(var b=e.length;b--;)f(e[b])},cycle:function(){return a},draw:function(f,b,k){var d=b.x1,h=b.y1,g=b.width;b=b.height;for(var l=e.length;l--;){var o=e[l].style;o=o?T5.Style.apply(f,
o):null;e[l].draw(f,d,h,g,b,k);o&&T5.Style.apply(f,o)}a=false}});c.bind("parentChange",j);c.bind("resync",j);return c};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(i){i=T5.ex({style:null,properties:{}},i);return T5.ex(i,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(i,m){m=T5.ex({size:4},m);var j=T5.XY.init(),e=T5.ex(m,{draw:function(a){a.beginPath();a.arc(j.x,j.y,e.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([i]);j=T5.XY.floor([i])[0]}});COG.Log.info("created arc = ",i);return e};
T5.Poly=function(i,m){m=T5.ex({fill:false,simplify:false},m);var j=false,e=m.fill,a=m.simplify,c=T5.viewState("ZOOM"),f=[],b=T5.ex(new T5.Shape(m),{draw:function(k,d,h,g,l,o){if(j){d=true;h=(o&c)!==0;k.beginPath();for(o=f.length;o--;){h=f[o].x;g=f[o].y;if(d){k.moveTo(h,g);d=false}else k.lineTo(h,g);h=true}if(h){e&&k.fill();k.stroke()}}},resync:function(k){b.xy=k.syncXY(i);f=T5.XY.floor(a?T5.XY.simplify(i):i)}});j=i&&i.length>=2;return b};
T5.AnimatedPathLayer=function(i){function m(b,k,d){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(d.x,d.y,4,0,Math.PI*2,false);b.stroke();b.fill()}i=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},i);var j=T5.XY.edges(i.path),e,a=null,c=0;T5.tweenValue(0,j.total,i.easing,function(){f.remove()},i.duration).requestUpdates(function(b,k){c=b;k&&f.remove()});var f=
T5.ex(new T5.ViewLayer(i),{cycle:function(){for(var b=0;b<j.accrued.length&&j.accrued[b]<c;)b++;a=null;if(b<i.path.length-1){var k=c-(b>0?j.accrued[b-1]:0),d=i.path[b];e=T5.XY.theta(d,i.path[b+1],j.edges[b]);a=T5.XY.extendBy(d,e,k);if(i.autoCenter)(b=f.getParent())&&b.centerOn(a)}return a},draw:function(b,k){if(a)(i.drawIndicator?i.drawIndicator:m)(b,k,T5.XY.init(a.x,a.y),e)}});return f};
T5.Marker=function(i){function m(k,d,h,g){e=k;a=d;c=h;f=g}i=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},i);var j=false,e=0,a=0,c=0,f=0,b=T5.ex(i,{isNew:true,isAnimating:function(){return j},draw:function(k,d,h,g,l){if(b.isNew&&i.tweenIn){var o=b.xy.y;b.xy.y=d.y1-20;j=true;T5.tween(b.xy,"y",o,i.tweenIn,function(){b.xy.y=o;j=false},i.animationSpeed?i.animationSpeed:250+Math.random()*500)}b.drawMarker(k,d,b.xy.x,b.xy.y,h,g,l);b.isNew=false},drawMarker:function(k,d,h,g){k.beginPath();
k.arc(h,g,4,0,Math.PI*2,false);k.fill();m(h-4,g-4,8,8)},hitTest:function(k,d){return k>=e&&k<=e+c&&d>=a&&d<=a+f},updateBounds:m});COG.observable(b);return b};
T5.ImageMarker=function(i){i=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},i);var m=i.imageAnchor?T5.XY.invert(i.imageAnchor):null,j=T5.ex(new T5.Marker(i),{drawMarker:function(e,a,c,f){if((a=j.isAnimating()&&j.animatingImage?j.animatingImage:j.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var b=j.scale,k=c+~~(m.x*b),d=f+~~(m.y*b),h=~~(a.width*b),g=~~(a.height*b);j.updateBounds(k,d,h,h);if(j.rotation||
j.opacity!==1){e.save();try{e.globalAlpha=j.opacity;e.translate(c,f);e.rotate(j.rotation);e.drawImage(a,m.x*b,m.y*b,h,g)}finally{e.restore()}}else e.drawImage(a,k,d,h,g)}}});if(!j.image)j.image=T5.Images.get(i.imageUrl,function(e){COG.Log.info("updating marker image to: "+e.src);j.image=e});if(!j.animatingImage)j.animatingImage=T5.Images.get(i.animatingImageUrl,function(e){j.animatingImage=e});return j};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(i){function m(){c.changed();c.trigger("markerUpdate",e)}function j(){var f=c.getParent();if(f&&f.syncXY)for(var b=e.length;b--;)f.syncXY([e[b].xy])}i=T5.ex({zindex:100,style:"basic"},i);var e=[],a=false,c=T5.ex(new T5.ViewLayer(i),{cycle:function(){return a},draw:function(f,b,k,d){a=false;for(var h=e.length;h--;){e[h].draw(f,b,k,c,d);a=a||e[h].isAnimating()}return a?1:0},add:function(f){if(f&&typeof f.length!=="undefined")for(var b=f.length;b--;){if(f[b])e[e.length]=f[b]}else if(f)e[e.length]=
f;m()},clear:function(f){if(f)for(var b=0;b<e.length;b++)f(e[b])&&e.splice(b,1);else e=[];m()},find:function(f){for(var b=[],k=e.length;k--;)if(!f||f(e[k]))b[b.length]=e[k];return b}});c.bind("tap",function(f,b,k){for(var d=[],h=k.x,g=k.y,l=e.length;l--;)if(e[l].hitTest(h,g))d[d.length]=e[l];if(d.length>0)f.cancel=c.trigger("markerTap",b,k,d).cancel});c.bind("parentChange",j);c.bind("changed",j);return c};
T5.ImageLayer=function(i,m){function j(h){var g=[];a.run(h,function(l){c=l;for(l=c.length;l--;)c[l]||(g[g.length]=l);for(l=0;l<g.length;l++)c.splice(g[l],1);(l=d.getParent())&&l.trigger("invalidate")})}function e(){var h=d.getParent();h&&h.trigger("invalidate")}m=T5.ex({imageLoadArgs:{}},m);var a=T5.Generator.init(i,m),c=null,f=T5.XYRect.init(),b=m.imageLoadArgs,k=T5.viewState("ZOOM"),d=T5.ex(new T5.ViewLayer(m),{cycle:function(h,g){j(g)},draw:function(h,g,l){h.save();try{h.strokeStyle="#555";h.beginPath();
if(c)for(var o=c.length;o--;){var v=c[o].x,y=c[o].y,n=T5.XYRect.init(c[o].x,c[o].y,c[o].x+c[o].width,c[o].y+c[o].height);T5.XYRect.intersect(g,n)&&d.drawImage(h,g,v,y,c[o],l)}h.clip()}finally{h.restore()}f=T5.XYRect.copy(g)},drawImage:function(h,g,l,o,v,y){if(g=T5.Images.get(v.url,(y&k)===0?e:null,b)){h.rect(l,o,v.width,v.height);h.drawImage(g,l,o,g.width,g.height)}}});d.bind("idle",function(){j(f)});d.bind("parentChange",function(h,g){a.bindToView(g)});d.bind("tap",function(h,g,l,o){h=[];var v=o.x,
y=o.y,n,p;if(c)for(var u=c.length;u--;){n=c[u];if(p=v>=n.x&&v<=n.x+n.width&&y>=n.y&&y<=n.y+n.height)h[h.length]=n}h.length>0&&d.trigger("tapImage",h,g,l,o)});return d};
T5.Style=function(){function i(f,b){a[f]=j(b);return f}function m(f){for(var b in f)i(b,f[b])}function j(f){function b(g){var l=f[g];typeof l!=="undefined"&&k.push(function(o){o[g]=l})}f=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var k=[],d={applyToContext:function(g){for(var l=k.length;l--;)k[l](g)}};for(var h in f)b(h);return d}var e={},a={},c={apply:function(f,
b){var k=a[b]?a[b]:a.basic,d;if(f&&f.canvas){d=e[f.canvas.id];e[f.canvas.id]=b}k.applyToContext(f);return d},define:i,defineMany:m,init:j,load:function(f){COG.jsonp(f,function(b){T5.resetStyles(b)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return c}();T5.Tiling=function(){return{tileSize:256,init:function(i,m,j,e,a){return T5.ex({x:i,y:m,width:j,height:e},a)}}}();
T5.TileGenerator=function(i){function m(l,o){for(var v=~~((l.x1-a.x)/f),y=~~((l.y1-a.y)/b),n=[],p=-d;p<d;p++)for(var u=-h;u<h;u++)n[n.length]=k(v+p,y+u);o&&o(n);e=T5.XYRect.copy(l)}i=T5.ex({tileWidth:256,tileHeight:256},i);var j=null,e=null,a=T5.XY.init(),c=false,f=i.tileWidth,b=i.tileHeight,k=null,d=0,h=0,g={bindToView:function(l){COG.Log.info("initializing generator");j=l;g.trigger("bindView",l)},getTileCreatorArgs:null,initTileCreator:null,requireRefresh:function(){return false},reset:function(){k=
null;c=false},run:function(l,o){if(!e||Math.abs(l.x1-e.x1)>f||Math.abs(l.y1-e.y1)>b){if(!k&&!c||g.requireRefresh()){COG.Log.info("generating tiles, view rect = ",l);a=T5.XY.init(l.x1,l.y1);d=Math.ceil(l.width/f)+1;h=Math.ceil(l.height/b)+1;if(g.initTileCreator){c=true;g.initTileCreator(b,f,g.getTileCreatorArgs?g.getTileCreatorArgs(j):{},function(v){k=v;c=false;m(l,o)})}}k&&m(l,o)}}};COG.observable(g);g.bind("update",function(){COG.Log.info("captured generator update");e=null});return g};
