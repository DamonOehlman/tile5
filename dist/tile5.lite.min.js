if(!this.JSON)this.JSON={};
(function(){function V(M){return M<10?"0"+M:M}function ma(M){na.lastIndex=0;return na.test(M)?'"'+M.replace(na,function(R){var h=qa[R];return typeof h==="string"?h:"\\u"+("0000"+R.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+M+'"'}function fa(M,R){var h,q,s,x,v=F,w,n=R[M];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(M);if(typeof $==="function")n=$.call(R,M,n);switch(typeof n){case "string":return ma(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";F+=aa;w=[];if(Object.prototype.toString.apply(n)==="[object Array]"){x=n.length;for(h=0;h<x;h+=1)w[h]=fa(h,n)||"null";s=w.length===0?"[]":F?"[\n"+F+w.join(",\n"+F)+"\n"+v+"]":"["+w.join(",")+"]";F=v;return s}if($&&typeof $==="object"){x=$.length;for(h=0;h<x;h+=1){q=$[h];if(typeof q==="string")if(s=fa(q,n))w.push(ma(q)+(F?": ":":")+s)}}else for(q in n)if(Object.hasOwnProperty.call(n,q))if(s=fa(q,n))w.push(ma(q)+(F?": ":":")+s);s=w.length===0?"{}":F?"{\n"+F+w.join(",\n"+
F)+"\n"+v+"}":"{"+w.join(",")+"}";F=v;return s}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+V(this.getUTCMonth()+1)+"-"+V(this.getUTCDate())+"T"+V(this.getUTCHours())+":"+V(this.getUTCMinutes())+":"+V(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var ba=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
na=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,F,aa,qa={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},$;if(typeof JSON.stringify!=="function")JSON.stringify=function(M,R,h){var q;aa=F="";if(typeof h==="number")for(q=0;q<h;q+=1)aa+=" ";else if(typeof h==="string")aa=h;if(($=R)&&typeof R!=="function"&&(typeof R!=="object"||typeof R.length!=="number"))throw Error("JSON.stringify");return fa("",
{"":M})};if(typeof JSON.parse!=="function")JSON.parse=function(M,R){function h(s,x){var v,w,n=s[x];if(n&&typeof n==="object")for(v in n)if(Object.hasOwnProperty.call(n,v)){w=h(n,v);if(w!==undefined)n[v]=w;else delete n[v]}return R.call(s,x,n)}var q;M=String(M);ba.lastIndex=0;if(ba.test(M))M=M.replace(ba,function(s){return"\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(M.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){q=eval("("+M+")");return typeof R==="function"?h({"":q},""):q}throw new SyntaxError("JSON.parse");}})();
COG=function(){function V(h,q){var s=h.gtObsHandlers;s[q]||(s[q]=[]);return s[q]}function ma(h,q){h[q]||(h[q]=function(s){return h.configure(q,s)})}function fa(h){h.gtConfId=aa("configurable");h.gtConfig={};h.gtConfigFns=[];return h.gtConfig}var ba=Object.prototype.hasOwnProperty,na=0,F={};F.toID=function(h){return h.replace(/\s/g,"-")};var aa=F.objId=function(h){return(h?h:"obj")+na++};F.Log=function(){function h(w,n){var z,Q=n&&n.length>0?n[0]:"";for(z=1;n&&z<n.length;z++)Q+=" "+(s&&$(n[z])?JSON.stringify(n[z]):
n[z]);typeof console!=="undefined"&&console[w](Q);for(z=0;z<q.length;z++)q[z].call(v,Q,w)}var q=[],s=typeof JSON!=="undefined",x=window.console&&window.console.markTimeline,v={getTraceTicks:function(){return x?(new Date).getTime():null},trace:function(w,n){if(x)console.markTimeline(w+(n?": "+(v.getTraceTicks()-n)+"ms":""))},debug:function(){h("debug",arguments)},info:function(){h("info",arguments)},warn:function(){h("warn",arguments)},error:function(){h("error",arguments)},exception:function(w){v.error(arguments);
for(var n in w)v.info("ERROR DETAIL: "+n+": "+w[n])},watch:function(w,n){try{n()}catch(z){v.exception(z,w)}},throwError:function(w){v.error(w);throw Error(w);},requestUpdates:function(w){q.push(w)}};return v}();F.contains=function(h,q){var s=h,x=arguments,v=1;if(q&&module.isArray(q)){x=q;v=0}for(v=v;v<x;v++)s=s&&typeof foo[x[v]]!=="undefined";return s};var qa=F.extend=function(){var h=arguments[0]||{},q=1,s=arguments.length,x=false,v,w,n,z;if(typeof h==="boolean"){x=h;h=arguments[1]||{};q=2}if(typeof h!==
"object"&&!module.isFunction(h))h={};if(s===q){h=this;--q}for(;q<s;q++)if((v=arguments[q])!=null)for(w in v){n=h[w];z=v[w];if(h!==z)if(x&&z&&(module.isPlainObject(z)||module.isArray(z))){n=n&&(module.isPlainObject(n)||module.isArray(n))?n:module.isArray(z)?[]:{};h[w]=module.extend(x,n,z)}else if(z!==undefined)h[w]=z}return h};F.formatStr=function(h){if(arguments.length<=1)return h;for(var q=arguments.length-2,s=0;s<=q;s++)h=h.replace(RegExp("\\{"+s+"\\}","gi"),arguments[s+1]);return h};F.wordExists=
function(h,q){var s="";if(q.toString)q=q.toString();for(var x=0;x<q.length;x++)s+=!/\w/.test(q[x])?"\\"+q[x]:q[x];return RegExp("(^|\\s|\\,)"+s+"(\\,|\\s|$)","i").test(h)};F.isFunction=function(h){return toString.call(h)==="[object Function]"};F.isArray=function(h){return toString.call(h)==="[object Array]"};var $=F.isPlainObject=function(h){if(!h||toString.call(h)!=="[object Object]"||h.nodeType||h.setInterval)return false;if(h.constructor&&!ba.call(h,"constructor")&&!ba.call(h.constructor.prototype,
"isPrototypeOf"))return false;var q;for(q in h);return q===undefined||ba.call(h,q)};F.isEmptyObject=function(h){for(var q in h)return false;return true};F.isXmlDocument=function(h){return toString.call(h)==="[object Document]"};F.Loopage=function(){function h(J){return qa({id:w++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},J)}function q(J){z.push(J);s()}function s(){Q&&clearTimeout(Q);Q=setTimeout(x,0);ca=true}function x(){for(var J,S=(new Date).getTime(),ga=n.length;z.length>
0;){var ra=z.shift();for(J=ga;J--;)if(n[J].id===ra){n.splice(J,1);break}ca=true;ga=n.length}if(ca){Y=v;for(J=ga;J--;)Y=n[J].frequency<Y?n[J].frequency:Y}for(J=ga;J--;){ra=S-n[J].lastTick;if(n[J].lastTick===0||ra>=n[J].frequency){n[J].execute(S,n[J]);n[J].lastTick=S;n[J].single&&n[J].trigger("complete")}}Q=ga?setTimeout(x,Y):0}var v=6E4,w=0,n=[],z=[],Q=0,Y=v,ca=true;return{join:function(J){var S=new h(J);if(S.after>0)S.lastTick=(new Date).getTime()+S.after;M(S);S.bind("complete",function(){q(S.id)});
n.unshift(S);s();return S},leave:q}}();var M=F.observable=function(h){if(h){if(!h.gtObsHandlers)h.gtObsHandlers={};if(!(h.bind||h.trigger||h.unbind)){h.bind=function(q,s){var x=aa("callback");V(h,q).unshift({fn:s,id:x});return x};h.trigger=function(q){var s=V(h,q),x={cancel:false,tickCount:(new Date).getTime()},v;if(!s)return null;v=Array.prototype.slice.call(arguments,1);v.unshift(x);for(var w=s.length;w--&&!x.cancel;)s[w].fn.apply(self,v);return x};h.unbind=function(q,s){for(var x=V(h,q),v=0;x&&
v<x.length;v++)if(x[v].id===s){x.splice(v,1);break}return h}}}},R={};F.paramTweaker=function(h,q,s){return function(x,v){if(typeof v!=="undefined"){if(x in h)h[x]=v;s&&x in s&&s[x](x,v)}else return q&&x in q?q[x](x):h[x]}};F.configurable=function(h,q,s,x){if(h){h.gtConfId||fa(h);var v=h.gtConfId,w=h.gtConfig,n=h.gtConfigFns;R[v]=h;n.push(s);for(s=q.length;s--;){w[q[s]]=true;x&&ma(h,q[s])}if(!h.configure)h.configure=function(z,Q){if(w[z]){for(var Y=n.length;Y--;){var ca=n[Y](z,Q);if(typeof ca!=="undefined")return ca}return R[v]}return null}}};
(function(){function h(v){var w=document.createElement("script"),n=false;w.src=v;w.async=true;w.onload=w.onreadystatechange=function(){if(!n&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){n=true;w.onload=w.onreadystatechange=null;w&&w.parentNode&&w.parentNode.removeChild(w)}};s||(s=document.getElementsByTagName("head")[0]);s.appendChild(w)}var q=0,s,x=this;F.jsonp=function(v,w,n){v+=v.indexOf("?")>=0?"&":"?";var z="json"+ ++q;x[z]=function(Q){w(Q);x[z]=null;try{delete x[z]}catch(Y){}};
h(v+(n?n:"callback")+"="+z);return z}})();return F}();
T5=function(){function V(){return(new Date).getTime()}function ma(){for(;Fa.length>0;){var a=Fa.shift();document.location=a}Ga=0}function fa(a){for(var e=true,c=Za.length;c--;)e=e&&a!=Za[c];return e}function ba(a,e){var c=[];for(var b in e)b&&c.push(b+"="+escape(e[b]));return"tile5://"+a+"/"+(c.length>0?"?"+c.join("&"):"")}function na(a,e){fa(a)&&COG.Log.info("would push url: "+ba(a,e))}function F(a,e){if(fa(a)){Fa.push(ba(a,e));Ga||(Ga=setTimeout(ma,100))}}function aa(a){return function(e,c,b){(b?
b:a?document.body:document).addEventListener(e,c,false)}}function qa(a){return function(e,c,b){(b?b:a?document.body:document).removeEventListener(e,c,false)}}function $(a,e,c){(c?c:document).attachEvent("on"+a,e)}function M(a,e,c){(c?c:document).detachEvent("on"+a,e)}function R(){da={base:{name:"Unknown",bindEvent:aa(),unbindEvent:qa(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:na,targetFps:null},
ie:{name:"MSIE",regex:/msie/i,bindEvent:$,unbindEvent:M,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:F,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:F},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:F},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:aa(true),unbindEvent:qa(true),supportsTouch:true,getScaling:function(){return 1/
window.devicePixelRatio},bridgeNotify:F},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:F}};Ha=[da.froyo,da.android,da.ipod,da.iphone,da.ipad,da.ie]}function h(){da||R();if(!sa){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<Ha.length;a++){var e=Ha[a];if(e.regex&&e.regex.test(navigator.userAgent)){sa=COG.extend({},da.base,e);COG.Log.info("PLATFORM DETECTED AS: "+sa.name);break}}if(!sa){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
sa=da.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return sa}function q(a){if(ta)return T.length;ta=true;try{for(var e=0;e<T.length;)if(T[e].isComplete()){T[e].triggerComplete(false);T.splice(e,1)}else{T[e].update(a);e++}}finally{ta=false}T.length===0&&za.trigger("complete");return T.length}function s(a){if(!ta){ta=true;try{for(var e=0;e<T.length;)if(!a||a(T[e])){T[e].triggerComplete(true);T.splice(e,1)}else e++}finally{ta=false}}}function x(){if(!za){za=COG.Loopage.join({execute:q,
frequency:20});za.bind("complete",function(){za=null})}}function v(a,e,c,b,d){a=new Ia({startValue:a,endValue:e,tweenFn:c,complete:b,duration:d});T.push(a);return a}function w(a,e,c,b,d,f){a=new Ia({target:a,property:e,endValue:c,tweenFn:b,duration:f,complete:d});T.push(a);return a}function n(a){return Aa[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]}function z(){for(var a=0,e=arguments.length;e--;){var c=kb[arguments[e].toUpperCase()];if(c)a|=c}return a}var Q=Math.PI*2,Y=Math.PI/2,ca=Math.abs,J=Math.pow,
S=Math.sin,ga=Math.asin,ra=Math.cos,H=function(){function a(b,d){return c(b.x-d.x,b.y-d.y)}function e(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var f={edges:Array(d-1),accrued:Array(d-1),total:0},g=0;g<d-1;g++){var i=a(b[g],b[g+1]);f.edges[g]=Math.sqrt(i.x*i.x+i.y*i.y);f.accrued[g]=f.total+f.edges[g];f.total+=f.edges[g]}return f}function c(b,d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,
add:function(){for(var b=0,d=0,f=arguments.length;f--;){b+=arguments[f].x;d+=arguments[f].y}return c(b,d)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?c(b.x,b.y):null},diff:a,distance:function(b,d){return e(b,d).total},edges:e,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,f){return c(b.x-Math.cos(d)*f,b.y-Math.sin(d)*f)},floor:function(b){for(var d=Array(b.length),f=b.length;f--;)d[f]=c(~~b[f].x,~~b[f].y);return d},getRect:function(b){for(var d,
f,g,i,m=b.length;m--;){var j=b[m];d=typeof d==="undefined"||j.x<d?j.x:d;f=typeof f==="undefined"||j.y<f?j.y:f;g=typeof g==="undefined"||j.x>g?j.x:g;i=typeof i==="undefined"||j.y>i?j.y:i}return Z.init(d,f,g,i)},init:c,invert:function(b){return c(-b.x,-b.y)},min:function(b,d){return c(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return c(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,f){return c(b.x+d,b.y+(f?f:d))},simplify:function(b,d){if(!b)return null;d=d?d:H.VECTOR_SIMPLIFICATION;
for(var f=[],g=null,i=b.length;i--;){var m=b[i];if(include=!g||i===0||Math.abs(m.x-g.x)+Math.abs(m.y-g.y)>d){f.unshift(m);g=m}}return f},theta:function(b,d,f){f=Math.asin((b.y-d.y)/f);return b.x>d.x?f:Math.PI-f}}}(),lb=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),Z=function(){function a(c){return e(c.x1,c.y1,c.x2,c.y2)}function e(c,b,d,f){c=c?c:0;b=b?b:0;d=typeof d!=="undefined"?d:c;f=typeof f!=="undefined "?f:f;return{x1:c,y1:b,x2:d,y2:f,width:d-c,height:f-b}}return{center:function(c){return H.init(c.x1+
c.width/2,c.y1+c.height/2)},copy:a,diagonalSize:function(c){return Math.sqrt(c.width*c.width+c.height*c.height)},fromCenter:function(c,b,d,f){d=~~(d/2);f=~~(f/2);return e(c-d,b-f,c+d,b+f)},init:e,intersect:function(c,b){var d=e(Math.max(c.x1,b.x1),Math.max(c.y1,b.y1),Math.min(c.x2,b.x2),Math.min(c.y2,b.y2));return d.width>0&&d.height>0?d:null},union:function(c,b){if(c.width===0||c.height===0)return a(b);else if(b.width===0||b.height===0)return a(c);else{var d=e(Math.min(c.x1,b.x1),Math.min(c.y1,b.y1),
Math.max(c.x2,b.x2),Math.max(c.y2,b.y2));return d.width>0&&d.height>0?d:null}}}}(),ua=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return H.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,height:e?e:a}}}}(),da=null,Ha=[],sa=null,Ga=0,Fa=[],Za=["view.wake","tile.loaded"],Ba=function(){function a(){if(!A){var r=h().maxImageLoads;A=COG.Loopage.join({execute:function(D,
u){if(!r||k.length<r){var y=j.shift();if(y){k[k.length]=y;y.image.onload=c;y.image.src=y.url;y.requested=T5.ticks()}else u.trigger("complete")}},frequency:10});A.bind("complete",function(){A=null})}}function e(){G=true;try{var r=o.length/2>>0;if(r>0){o.sort(function(u,y){return u.created-y.created});for(var D=r;D--;)delete f[o[D].url];o.splice(0,r)}}finally{G=false}B.trigger("cacheCleared")}function c(){var r=i[this.id],D;if(r&&r.image.complete&&r.image.width>0){r.loaded=true;r.hitCount=1;for(D=k.length;D--;)if(k[D].image.src==
this.src){k.splice(D,1);break}if(r.background||r.postProcess||r.drawBackground||r.customDraw)if(r.image){globalImageData=r;D=d(r.realSize?r.realSize.width:r.image.width,r.realSize?r.realSize.height:r.image.height);var u=D.getContext("2d"),y=r.offset?r.offset:T5.XY.init();r.background&&u.drawImage(r.background,0,0);r.drawBackground&&r.drawBackground(u);r.customDraw?r.customDraw(u,r):u.drawImage(r.image,y.x,y.y);r.postProcess&&r.postProcess(u,r);r.image=D}for(D=r.callbacks.length;D--;)r.callbacks[D]&&
r.callbacks[D](this,false);r.callbacks=[];o[o.length]={url:this.src,created:r.requested};delete i[this.id];a()}}function b(r,D,u){var y=f[r];if(y){y.hitCount++;y.image.complete&&y.image.width>0&&D?D(y.image,true):y.callbacks.push(D)}else{y=COG.extend({url:r,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[D]},u);y.image.id="resourceLoaderImage"+m++;f[r]=y;i[y.image.id]=y;j[j.length]=y;a()}return y}function d(r,D){var u=document.createElement("canvas");u.width=r?
r:0;u.height=D?D:0;if(typeof FlashCanvas!=="undefined"){u.id="tmpCanvas"+g++;u.style.cssText="position: absolute; top: -"+(D-1)+"px; left: -"+(r-1)+"px;";document.body.appendChild(u);FlashCanvas.initElement(u)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(u);return u}var f={},g=0,i={},m=0,j=[],k=[],o=[],t=0,A=null,G=false,B={avgImageSize:25,loadTimeout:10,cancelLoad:function(){k=[]},get:function(r,D,u){var y=null,E=null;G||(y=f[r]);if((E=y?y.image:null)&&(E.getContext||E.complete&&
E.width>0))return E;else D&&b(r,D,u);return null},load:b,newCanvas:d,reset:function(){f={}},stats:function(){return{imageLoadingCount:k.length,queuedImageCount:j.length,imageCacheFullness:t}}};COG.observable(B);COG.Loopage.join({execute:function(r){for(var D=false,u=0,y=h();u<k.length;)if(r-k[u].requested>B.loadTimeout*1E3){k.splice(u,1);D=true}else u++;D&&a();if(y&&y.imageCacheMaxSize){t=o.length*B.avgImageSize/y.imageCacheMaxSize;t>=1&&e()}},frequency:2E4});return B}(),Ja=function(){var a={};return{init:function(e,
c){var b=a[e];if(!b)throw Error("Unable to locate requested generator: "+e);return new b(c)},register:function(e,c){a[e]=c},Template:function(){}}}(),T=[],za=null,ta=false,ia=1.70158,Aa={linear:function(a,e,c,b){return c*a/b+e},backin:function(a,e,c,b){return c*(a/=b)*a*((ia+1)*a-ia)+e},backout:function(a,e,c,b){return c*((a=a/b-1)*a*((ia+1)*a+ia)+1)+e},backinout:function(a,e,c,b){return(a/=b/2)<1?c/2*a*a*(((ia*=1.525)+1)*a-ia)+e:c/2*((a-=2)*a*(((ia*=1.525)+1)*a+ia)+2)+e},bouncein:function(a,e,c,
b){return c-Aa.bounceout(b-a,0,c,b)+e},bounceout:function(a,e,c,b){return(a/=b)<1/2.75?c*7.5625*a*a+e:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+0.75)+e:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+0.9375)+e:c*(7.5625*(a-=2.625/2.75)*a+0.984375)+e},bounceinout:function(a,e,c,b){return a<b/2?Aa.bouncein(a*2,0,c,b)/2+e:Aa.bounceout(a*2-b,0,c,b)/2+c/2+e},cubicin:function(a,e,c,b){return c*(a/=b)*a*a+e},cubicout:function(a,e,c,b){return c*((a=a/b-1)*a*a+1)+e},cubicinout:function(a,e,c,b){if((a/=b/2)<1)return c/2*a*
a*a+e;return c/2*((a-=2)*a*a+2)+e},elasticin:function(a,e,c,b,d,f){if(a==0)return e;if((a/=b)==1)return e+c;f||(f=b*0.3);if(!d||d<ca(c)){d=c;c=f/4}else c=f/Q*ga(c/d);return-(d*J(2,10*(a-=1))*S((a*b-c)*Q/f))+e},elasticout:function(a,e,c,b,d,f){var g;if(a==0)return e;if((a/=b)==1)return e+c;f||(f=b*0.3);if(!d||d<ca(c)){d=c;g=f/4}else g=f/Q*ga(c/d);return d*J(2,-10*a)*S((a*b-g)*Q/f)+c+e},elasticinout:function(a,e,c,b,d,f){var g;if(a==0)return e;if((a/=b/2)==2)return e+c;f||(f=b*0.3*1.5);if(!d||d<ca(c)){d=
c;g=f/4}else g=f/Q*ga(c/d);if(a<1)return-0.5*d*J(2,10*(a-=1))*S((a*b-g)*Q/f)+e;return d*J(2,-10*(a-=1))*S((a*b-g)*Q/f)*0.5+c+e},quadin:function(a,e,c,b){return c*(a/=b)*a+e},quadout:function(a,e,c,b){return-c*(a/=b)*(a-2)+e},quadinout:function(a,e,c,b){if((a/=b/2)<1)return c/2*a*a+e;return-c/2*(--a*(a-2)-1)+e},sinein:function(a,e,c,b){return-c*ra(a/b*Y)+c+e},sineout:function(a,e,c,b){return c*S(a/b*Y)+e},sineinout:function(a,e,c,b){return-c/2*(ra(Math.PI*a/b)-1)+e}},Ia=function(a){a=COG.extend({target:null,
property:null,startValue:0,endValue:null,duration:2E3,tweenFn:n("sine.out"),complete:null,cancelOnInteract:false},a);var e=V(),c=[],b=false,d=0,f=0,g={cancelOnInteract:a.cancelOnInteract,isComplete:function(){return b},triggerComplete:function(i){a.complete&&a.complete(i)},update:function(i){try{var m=a.tweenFn(i-e,d,f,a.duration);if(a.target)a.target[a.property]=m;for(var j=c.length;j--;)c[j](m,void 0);if(b=e+a.duration<=i){if(a.target)a.target[a.property]=a.tweenFn(a.duration,d,f,a.duration);for(var k=
c.length;k--;)c[k](m,true)}}catch(o){COG.Log.exception(o)}},requestUpdates:function(i){c.push(i)}};d=a.target&&a.property&&a.target[a.property]?a.target[a.property]:a.startValue;if(typeof a.endValue!=="undefined")f=a.endValue-d;if(f==0)b=true;x();return g},va=function(){function a(g,i){d[g]=c(i);return g}function e(g){for(var i in g)a(i,g[i])}function c(g){function i(o){var t=g[o];typeof t!=="undefined"&&j.push(function(A){A[o]=t})}function m(){j=[];for(var o in g)i(o)}g=COG.extend({lineWidth:undefined,
lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},g);var j=[],k={applyToContext:function(o){for(var t=j.length;t--;)j[t](o)},update:function(o,t){g[o]=t;m()}};m();return k}var b={},d={},f={apply:function(g,i){var m=d[i]?d[i]:d.basic,j;if(g&&g.canvas){j=b[g.canvas.id];b[g.canvas.id]=i}m.applyToContext(g);return j},define:a,defineMany:e,get:function(g){return d[g]},init:c,load:function(g){COG.jsonp(g,
function(i){e(i)})}};e({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return f}(),kb={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},wa=function(a){a=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:z("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);var e=null,c=false,b=false,d=a.supportFastDraw,f=a.id,g=z("ACTIVE"),i=a.validStates,m=0,j=0,k=COG.extend({addToView:function(o){o.setLayer(f,
k)},shouldDraw:function(o,t,A){return(b||A||m!==t.x1||j!==t.y1)&&(o&i)!==0&&(c?d:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){k.trigger("remove",k)},changed:function(o){b=true;k.trigger("changed",k);e&&e.trigger("invalidate",o)},getId:function(){return f},setId:function(o){f=o},getParent:function(){return e},setParent:function(o){c=(e=o)?e.fastDraw&&displayState!==g:false;k.trigger("parentChange",e)}},a);COG.observable(k);k.bind("drawComplete",function(o,t){b=false;m=t.x1;
j=t.y1});k.bind("resync",function(o,t){if(t.syncXY){k.minXY&&t.syncXY(k.minXY);k.maxXY&&t.syncXY(k.maxXY)}});return k},$a=function(a){function e(m,j,k,o){b=m;d=j;f=k;g=o}a=COG.extend({xy:H.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},a);var c=false,b=0,d=0,f=0,g=0,i=COG.extend(a,{isAnimating:function(){return c},draw:function(m,j,k,o,t){if(i.isNew&&a.tweenIn){var A=i.xy.y;i.xy.y=j.y1-20;c=true;w(i.xy,"y",A,a.tweenIn,function(){i.xy.y=A>>0;c=false},a.animationSpeed?a.animationSpeed:
250+Math.random()*500)}i.drawMarker(m,j,i.xy.x,i.xy.y,k,o,t);i.isNew=false},drawMarker:function(m,j,k,o){m.beginPath();m.arc(k,o,4,0,Math.PI*2,false);m.fill();e(k-4,o-4,8,8)},hitTest:function(m,j){return m>=b&&m<=b+f&&j>=d&&j<=d+g},updateBounds:e});COG.observable(i);return i},ab=function(a){function e(){d.changed();d.trigger("markerUpdate",b)}function c(){var f=d.getParent();if(f&&f.syncXY)for(var g=b.length;g--;)f.syncXY([b[g].xy])}a=COG.extend({zindex:100,style:"basic"},a);var b=[],d=COG.extend(new wa(a),
{draw:function(f,g,i,m){for(var j=b.length;j--;)b[j].draw(f,g,i,d,m)},add:function(f){if(f&&typeof f.length!=="undefined")for(var g=f.length;g--;){if(f[g])b[b.length]=f[g]}else if(f)b[b.length]=f;e()},clear:function(f){if(f)for(var g=0;g<b.length;g++)f(b[g])&&b.splice(g,1);else b=[];e()},each:function(f){if(f)for(var g=b.length;g--;)f(b[g])},find:function(f){for(var g=[],i=b.length;i--;)if(!f||f(b[i]))g[g.length]=b[i];return g}});d.bind("tap",function(f,g,i){for(var m=[],j=i.x,k=i.y,o=b.length;o--;)if(b[o].hitTest(j,
k))m[m.length]=b[o];if(m.length>0)f.cancel=d.trigger("markerTap",g,i,m).cancel});d.bind("parentChange",c);d.bind("resync",c);d.bind("changed",c);return d},bb=function(a){function e(i,m,j){i.fillStyle="#FFFFFF";i.strokeStyle="#222222";i.beginPath();i.arc(j.x,j.y,4,0,Math.PI*2,false);i.stroke();i.fill()}a=COG.extend({path:[],id:COG.objId("pathAni"),easing:n("sine.inout"),validStates:z("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},a);var c=H.edges(a.path),b,d=null,f=0;v(0,c.total,a.easing,
function(){g.remove()},a.duration).requestUpdates(function(i,m){f=i;m&&g.remove()});var g=COG.extend(new wa(a),{cycle:function(){for(var i=0;i<c.accrued.length&&c.accrued[i]<f;)i++;d=null;if(i<a.path.length-1){var m=f-(i>0?c.accrued[i-1]:0),j=a.path[i];b=H.theta(j,a.path[i+1],c.edges[i]);d=H.extendBy(j,b,m)}return d},draw:function(i,m){if(d)(a.drawIndicator?a.drawIndicator:e)(i,m,H.init(d.x,d.y),b)}});return g},cb=function(a){a=COG.extend({style:null,properties:{}},a);return COG.extend(a,{rect:null,
draw:function(){},resync:function(){}})},mb=function(){return{tileSize:256,init:function(a,e,c,b,d){return COG.extend({x:a,y:e,width:c,height:b},d)}}}(),Ka={ex:COG.extend,ticks:V,getConfig:h,userMessage:function(a,e,c){Ka.trigger("userMessage",a,e,c)},XY:H,XYRect:Z,Dimensions:ua,Vector:lb,D:ua,Images:Ba,Generator:Ja,tween:w,tweenValue:v,easing:n,registerEasingType:function(a,e){Aa[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]=e},Tween:Ia,Style:va,viewState:z,View:function(a){function e(l,p,C,I){ha=Ca;
B();if(I&&a.inertia)m(W+p,X+C,a.panAnimationEasing,a.panAnimationDuration);else I||m(W+p,X+C)}function c(){ha=La;ja=false;B()}function b(l,p,C){Da||(Da=[].concat(C));l=db(Da);eb(l);p=fb(l);var I=db(C);C=eb(I);I=fb(I);g(C);N=l&&p!==0?I/p:1;f()}function d(l,p,C){O.zoom(ua.getCenter(ea),C)}function f(l){t();var p=H.init(Ma-(xa.width/(N*2)>>0),Na-(xa.height/(N*2)>>0)),C=Math.log(N)/Math.LN2>>0;if(N!==1)ha=Oa;COG.Log.info("scale factor = "+N+", exp = "+C);if(C!==0){N=Math.pow(2,C);if(!O.trigger("scale",
N,p).cancel){COG.Log.info("ok to scale");for(l=u.length;l--;)u[l].trigger("scale",N,p);N=1;Da=null;ha=La;l=true}}B(l)}function g(l){Pa=H.init(W,X);Qa=H.offset(l,W,X)}function i(){clearTimeout(gb);gb=setTimeout(j,50)}function m(l,p,C,I,K){function P(){U+=1;if(U>=2){c(0,0);K&&K()}}var U=0,ka=oa?H.offset(oa,-Ra,-Sa):null,la=pa?H.offset(pa,-Ra,-Sa):null;if(ka){l=l<ka.x?ka.x:l;p=p<ka.y?ka.y:p}if(la){l=l>la.x?la.x:l;p=p>la.y?la.y:p}if(C){if(!ja){l=v(W,l,C,P,I);p=v(X,p,C,P,I);l.cancelOnInteract=true;l.requestUpdates(function(Ta){W=
Ta>>0;ja=true;B()});p.cancelOnInteract=true;p.requestUpdates(function(Ta){X=Ta>>0;ja=true;B()})}}else{W=l>>0;X=p>>0}}function j(){var l;if(E){if(a.autoSize&&E.parentNode){l=E.parentNode.getBoundingClientRect();if(l.height!==0&&l.width!==0){E.height=l.height;E.width=l.width}}try{if(!E.id)E.id=a.id+"_canvas";L=E.getContext("2d")}catch(p){COG.Log.exception(p);throw Error("Could not initialise canvas on specified view element");}if(ea.height!==E.height||ea.width!==E.width){ea=ua.init(E.width,E.height);
Ra=ea.width/2>>0;Sa=ea.height/2>>0;O.trigger("resize",E.width,E.height);for(l=y;l--;)u[l].trigger("resize",E.width,E.height)}for(l=y;l--;)u[l].trigger("contextChanged",L);B()}}function k(l,p){p.setId(l);p.added=V();p.bind("remove",function(){O.removeLayer(l)});p.trigger("contextChanged",L);p.setParent(O);u.push(p);u.sort(function(C,I){var K=I.zindex-C.zindex;if(K===0)K=I.added-C.added;return K});y=u.length;return p}function o(){D("idle",O);Ua=true;ya=0}function t(l){var p=1/N;Ma=Qa.x+(W-Pa.x);Na=
Qa.y+(X-Pa.y);if(l)return Z.fromCenter(Ma>>0,Na>>0,l.width*p>>0,l.height*p>>0)}function A(l,p,C,I){var K=Z.copy(p),P,U=0;C&&L.clearRect(0,0,E.width,E.height);L.save();try{L.globalCompositeOperation="source-over";if(N!==1){K=t(K);L.scale(N,N)}L.translate(-K.x1,-K.y1);pa=oa=null;L.beginPath();Va=false;for(U=y;U--;)if(u[U].clip){u[U].clip(L,K,l,O,C,I);Va=true}L.closePath();Va&&L.clip();for(U=y;U--;){P=u[U];var ka=P.style,la=ka?va.apply(L,ka):null;if(P.minXY)oa=oa?H.min(oa,P.minXY):H.copy(P.minXY);if(P.maxXY)pa=
pa?H.max(pa,P.maxXY):H.copy(P.maxXY);P.draw(L,K,l,O,C,I);la&&va.apply(L,la)}}finally{L.restore()}if(nb){L.globalCompositeOperation="source-over";L.strokeStyle="#f00";L.beginPath();L.moveTo(E.width/2,0);L.lineTo(E.width/2,E.height);L.moveTo(0,E.height/2);L.lineTo(E.width,E.height/2);L.stroke()}D("drawComplete",p,I);COG.Log.trace("draw complete",I)}function G(l,p){var C=false,I=Wa?Wa:ja?Ca:ha,K=!ja&&(I===Oa||I===Ca),P=Xa||I===Ca||I===Oa||T.length>0;xa=r();if(K){s(function(U){return U.cancelOnInteract});
Ua=false;if(ya!==0){clearTimeout(ya);ya=0}}for(K=y;K--;){if(u[K].animated)ha|=hb;u[K].cycle(l,xa,ha,P);C=u[K].shouldDraw(ha,xa,P)||C}P=P||(ha&hb)!==0;if(C=C||P||N!==1&&N!==ib){A(I,xa,P,l);ib=N;Xa=false}if(!C&&Ya===0&&!ob){if(!Ua&&ya===0)ya=setTimeout(o,500);p.trigger("complete")}Ya=0;COG.Log.trace("Completed draw cycle",l)}function B(l){Xa=l?true:false;Ya+=1;if(!Ea){Ea=COG.Loopage.join({execute:G,frequency:pb});Ea.bind("complete",function(){Ea=null})}}function r(){return Z.init(W,X,W+ea.width,X+ea.height)}
function D(){for(var l=O.trigger.apply(null,arguments).cancel,p=u.length;p--;)l=u[p].trigger.apply(null,arguments).cancel||l;return!l}a=COG.extend({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:n("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},a);var u=[],y=0,E=document.getElementById(a.container),L=null,W=0,X=0,Va=false,xa=null,Ea=null,nb=
a.guides,jb=1,ea=ua.init(),Ya=0,Ra=0,Sa=0,Pa=null,Qa=null,Ua=false,ja=false,ya=0,oa=null,pa=null,qb=0,Wa=null,Xa=false,gb=0,Da=null,N=1,ib=0,ob=typeof FlashCanvas!=="undefined",pb=~~(1E3/a.fps),Ma,Na,La=z("ACTIVE"),Ca=z("PAN"),Oa=z("ZOOM"),hb=z("ANIMATING"),ha=La,db=H.getRect,fb=Z.diagonalSize,eb=Z.center,O={id:a.id,deviceScaling:jb,fastDraw:a.fastDraw||h().requireFastDraw,getDimensions:function(){return ea},getLayer:function(l){for(var p=0;p<y;p++)if(u[p].getId()==l)return u[p];return null},setLayer:function(l,
p){for(var C=0;C<y;C++)if(u[C].getId()===l){u.splice(C,1);break}p&&k(l,p);B();return p},eachLayer:function(l){for(var p=y;p--;)l(u[p])},invalidate:B,resize:function(l,p){if(E){a.autoSize=false;E.width=l;E.height=p;j();O.trigger("resize",E.width,E.height)}},scale:function(l,p,C,I){function K(){N=Math.pow(2,Math.round(Math.log(N)/Math.LN2));I&&I();f(true)}var P=N;p||(p=ua.getCenter(ea));g(p);if(C)v(0,l-P,C,K,1E3).requestUpdates(function(U){N=P+U;f()});else{N=l;K()}return O},triggerAll:D,removeLayer:function(l){a:{for(var p=
y;p--;)if(u[p].getId()==l){l=p;break a}l=-1}if(l>=0&&l<y){O.trigger("layerRemoved",u[l]);u.splice(l,1);B()}y=u.length},stateOverride:function(l){Wa=l},getOffset:function(){return H.init(W,X)},getViewRect:r,updateOffset:m,pan:function(l,p,C,I,K){m(W+l,X+p,C,I,K)},zoom:function(l,p){g(l);ja=false;N=Math.max(N+Math.pow(2,p)-1,0.25);COG.Log.info("zooming, scale change = "+p+", targetXY = ",l);f()}};jb=h().getScaling();O.markers=k("markers",new ab);COG.observable(O);O.bind("invalidate",function(l,p){B(p)});
if(a.pannable){O.bind("pan",e);O.bind("panEnd",c);O.bind("inertiaCancel",function(){ja=false;B()})}if(a.scalable){O.bind("pinchZoom",b);O.bind("wheelZoom",d)}O.bind("tap",function(l,p,C){for(var I=H.offset(C,W,X),K=u.length;K--;)l.cancel=l.cancel||u[K].trigger("tap",p,C,I).cancel});O.bind("resync",function(){pa=oa=null});COG.configurable(O,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(a,null,{container:function(l,p){E=document.getElementById(p);j()},rotation:function(l,
p){qb=p}}),true);j();a.autoSize&&window.addEventListener("resize",i,false);return O},ViewLayer:wa,ImageLayer:function(a,e){function c(j,k,o){for(k=f.length;k--;){var t=f[k],A=t.x,G=t.y,B=Z.init(t.x,t.y,t.x+t.width,t.y+t.height);if(o&&Z.intersect(j,B)){B=Ba.get(t.url,function(){m.changed()},i);o(B,A,G,t.width,t.height)}}}function b(j){d&&d.run(j,function(k){f=[].concat(k);m.changed()})}e=COG.extend({imageLoadArgs:{}},e);var d=a?Ja.init(a,e):null,f=[],g=Z.init(),i=e.imageLoadArgs,m=COG.extend(new wa(e),
{changeGenerator:function(j,k){d=Ja.init(j,COG.extend({},e,k));d.bindToView(m.getParent());f=null;b(g)},clip:function(j,k,o){c(k,o,function(t,A,G,B,r){t&&j.rect(A,G,B,r)})},cycle:function(j,k){b(k)},draw:function(j,k,o){c(k,o,function(t,A,G,B,r){m.drawImage(j,t,A,G,B,r,k,o)});g=Z.copy(k)},drawImage:function(j,k,o,t){k&&j.drawImage(k,o,t,k.width,k.height)}});m.bind("idle",function(){b(g)});m.bind("parentChange",function(j,k){d&&d.bindToView(k)});m.bind("tap",function(j,k,o,t){j=[];var A=t.x,G=t.y,
B,r;if(f)for(var D=f.length;D--;){B=f[D];if(r=A>=B.x&&A<=B.x+B.width&&G>=B.y&&G<=B.y+B.height)j[j.length]=B}j.length>0&&m.trigger("tapImage",j,k,o,t)});return m},Marker:$a,ImageMarker:function(a){a=COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},a);var e=a.imageAnchor?T5.XY.invert(a.imageAnchor):null,c=COG.extend(new $a(a),{drawMarker:function(b,d,f,g){if((d=c.isAnimating()&&c.animatingImage?c.animatingImage:c.image)&&
d.width>0){e||(e=H.init(-d.width>>1,-d.height>>1));var i=c.scale,m=f+~~(e.x*i),j=g+~~(e.y*i),k=~~(d.width*i),o=~~(d.height*i);c.updateBounds(m,j,k,k);if(c.rotation||c.opacity!==1){b.save();try{b.globalAlpha=c.opacity;b.translate(f,g);b.rotate(c.rotation);b.drawImage(d,e.x*i,e.y*i,k,o)}finally{b.restore()}}else b.drawImage(d,m,j,k,o)}}});if(!c.image)c.image=Ba.get(a.imageUrl,function(b){c.image=b});if(!c.animatingImage)c.animatingImage=Ba.get(a.animatingImageUrl,function(b){c.animatingImage=b});return c},
MarkerLayer:ab,PathLayer:function(a){a=COG.extend({style:"waypoints",pixelGeneralization:8,zindex:50},a);var e=false,c=[],b=null,d=[],f=null,g=0,i=[],m=COG.extend(new wa(a),{getAnimation:function(j,k,o,t){var A="pathAnimation"+g++;i.push(A);return new bb({id:A,path:c,zindex:a.zindex+1,easing:j?j:n("sine.inout"),duration:k?k:5E3,drawIndicator:o,autoCenter:t?t:false})},cycle:function(j,k,o,t){return t},draw:function(j){var k,o=c.length;j.save();try{va.apply(j,a.style);if(o>0){j.beginPath();j.moveTo(c[o-
1].x,c[o-1].y);for(k=o;k--;)j.lineTo(c[k].x,c[k].y);j.stroke();if(b){j.fillStyle=a.waypointFillStyle;for(k=b.length;k--;){j.beginPath();j.arc(b[k].x,b[k].y,2,0,Math.PI*2,false);j.stroke();j.fill()}}}}finally{j.restore()}e=false},updateCoordinates:function(j,k){d=j;f=k;var o=m.getParent();if(o&&o.syncXY){o.syncXY(d);f&&o.syncXY(f);m.trigger("tidy")}}});m.bind("tidy",function(){c=H.simplify(d,a.pixelGeneralization);b=H.simplify(f,a.pixelGeneralization);e=true;m.changed()});return m},AnimatedPathLayer:bb,
Shape:cb,Arc:function(a,e){e=COG.extend({size:4},e);var c=H.init(),b=COG.extend(e,{draw:function(d){d.beginPath();d.arc(c.x,c.y,b.size,0,Math.PI*2,false);d.fill();d.stroke()},resync:function(d){d.syncXY([a]);c=H.floor([a])[0]}});COG.Log.info("created arc = ",a);return b},Poly:function(a,e){e=COG.extend({fill:false,simplify:false},e);var c=false,b=e.fill,d=e.simplify,f=z("ZOOM"),g=[],i=COG.extend(new cb(e),{draw:function(m,j,k,o,t,A){if(c){j=true;k=(A&f)!==0;m.beginPath();for(A=g.length;A--;){k=g[A].x;
o=g[A].y;if(j){m.moveTo(k,o);j=false}else m.lineTo(k,o);k=true}if(k){b&&m.fill();m.stroke()}}},resync:function(m){i.xy=m.syncXY(a);g=H.floor(d?H.simplify(a):a)}});c=a&&a.length>=2;return i},ShapeLayer:function(a){function e(f){for(var g=b.length;g--;)b[g].resync(f);b.sort(function(i,m){var j=m.xy.y-i.xy.y;if(j===0)j=m.xy.x-i.xy.y;return j});d.changed()}function c(f,g){g.syncXY&&e(g)}a=COG.extend({zindex:80},a);var b=[],d=COG.extend(new wa(a),{add:function(f){b[b.length]=f},each:function(f){for(var g=
b.length;g--;)f(b[g])},draw:function(f,g,i){var m=g.x1,j=g.y1,k=g.width;g=g.height;for(var o=b.length;o--;){var t=b[o].style;t=t?va.apply(f,t):null;b[o].draw(f,m,j,k,g,i);t&&va.apply(f,t)}}});d.bind("parentChange",c);d.bind("resync",c);return d},Tiling:mb,TileGenerator:function(a){function e(G,B,r,D){function u(){if(A.initTileCreator){i=true;A.initTileCreator(G,B,r,D)}}A.prepTileCreator?A.prepTileCreator(G,B,r,u):u()}function c(G,B){for(var r=~~((G.x1-f.x)/m),D=~~((G.y1-f.y)/j),u=[],y=-g;y<o;y++)for(var E=
-g;E<t;E++){var L=k(r+y,D+E);if(L)u[u.length]=L}B&&B(u);d=Z.copy(G)}a=COG.extend({tileWidth:256,tileHeight:256,relative:false,padding:2},a);var b=null,d=null,f=H.init(),g=a.padding,i=false,m=a.tileWidth,j=a.tileHeight,k=null,o=0,t=0,A={bindToView:function(G){COG.Log.info("initializing generator");b=G;A.trigger("bindView",G)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){k=null;i=false;d=null},run:function(G,B){if(!d||Math.abs(G.x1-
d.x1)>m||Math.abs(G.y1-d.y1)>j){if(!k&&!i||A.requireRefresh()){f=a.relative?H.init(G.x1,G.y1):H.init();o=Math.ceil(G.width/m)+g;t=Math.ceil(G.height/j)+g;e(m,j,A.getTileCreatorArgs?A.getTileCreatorArgs(b):{},function(r){k=r;i=false;c(G,B)})}k&&c(G,B)}}};COG.observable(A);A.bind("update",function(){COG.Log.info("captured generator update");d=null});return A}};COG.observable(Ka);return Ka}();
