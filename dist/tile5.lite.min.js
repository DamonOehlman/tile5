COG=function(){var f=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,h=0,e={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,b=arguments.length,g=false,i,d,j,k;if(typeof a==="boolean"){g=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!e.isFunction(a))a={};if(b===c){a=this;--c}for(;c<b;c++)if((i=arguments[c])!=null)for(d in i){j=a[d];k=i[d];if(a!==k)if(g&&k&&(e.isPlainObject(k)||e.isArray(k))){j=j&&(e.isPlainObject(j)||e.isArray(j))?j:e.isArray(k)?[]:{};a[d]=e.extend(g,j,k)}else if(k!==
undefined)a[d]=k}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||m.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var b=a,g=arguments,i=1;if(c&&e.isArray(c)){g=c;i=0}for(i=i;i<g;i++)b=b&&typeof foo[g[i]]!=="undefined";return b},newModule:function(a){a=e.extend({id:null,requires:[],parent:null},a);if(a.parent)a=e.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+h++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,b=0;b<=c;b++)a=a.replace(RegExp("\\{"+b+"\\}","gi"),arguments[b+
1]);return a},wordExists:function(a,c){var b="";if(c.toString)c=c.toString();for(var g=0;g<c.length;g++)b+=!/\w/.test(c[g])?"\\"+c[g]:c[g];return RegExp("(^|\\s|\\,)"+b+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var b=f.exec(a);b;){a=a.replace(b[0],COG.XPath.first(b[1],c));f.lastIndex=0;b=f.exec(a)}return a}};return e}();
COG.Log=function(){function f(c,b){var g,i=b&&b.length>0?b[0]:"";for(g=1;b&&g<b.length;g++)i+=" "+(h&&COG.isPlainObject(b[g])?JSON.stringify(b[g]):b[g]);typeof console!=="undefined"&&console[c](i);for(g=0;g<m.length;g++)m[g].call(a,i,c)}var m=[],h=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(c,b){if(e)console.markTimeline(c+(b?": "+(a.getTraceTicks()-b)+"ms":""))},debug:function(){f("debug",
arguments)},info:function(){f("info",arguments)},warn:function(){f("warn",arguments)},error:function(){f("error",arguments)},exception:function(c){a.error(arguments);for(var b in c)a.info("ERROR DETAIL: "+b+": "+c[b])},watch:function(c,b){try{b()}catch(g){a.exception(g,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return a}();
(function(){function f(e,a){e[a]||(e[a]=function(c){return e.configure(a,c)})}function m(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var h={};COG.paramTweaker=function(e,a,c){return function(b,g){if(typeof g!=="undefined"){if(b in e)e[b]=g;c&&b in c&&c[b](b,g)}else return a&&b in a?a[b](b):e[b]}};COG.configurable=function(e,a,c,b){if(e){e.gtConfId||m(e);var g=e.gtConfId,i=e.gtConfig,d=e.gtConfigFns;h[g]=e;d.push(c);for(c=a.length;c--;){i[a[c]]=true;b&&
f(e,a[c])}if(!e.configure)e.configure=function(j,k){if(i[j]){for(var l=d.length;l--;){var p=d[l](j,k);if(typeof p!=="undefined")return p}return h[g]}return null}}}})();
(function(){function f(m,h){var e=m.gtObsHandlers;e[h]||(e[h]=[]);return e[h]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(h,e){var a=COG.objId("callback");f(m,h).unshift({fn:e,id:a});return a};m.trigger=function(h){var e=f(m,h),a={cancel:false,tickCount:(new Date).getTime()},c;if(!e)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var b=e.length;b--&&!a.cancel;)e[b].fn.apply(self,c);return a};m.unbind=
function(h,e){for(var a=f(m,h),c=0;a&&c<a.length;c++)if(a[c].id===e){a.splice(c,1);break}return m}}}}})();(function(){var f={},m=[];COG.addPipe=function(h){h("pipe.test",{});m.push(h)};COG.listen=function(h,e){f[h]||(f[h]=[]);e&&f[h].push(e)};COG.say=function(h,e){var a;for(a=m.length;a--;)m[a](h,e);if(f[h])for(a=f[h].length;a--;)f[h][a](e)}})();
COG.Loopage=function(){function f(k){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},k)}function m(k){g.push(k);h()}function h(){i&&clearTimeout(i);i=setTimeout(e,0);j=true}function e(){for(var k,l=(new Date).getTime(),p=b.length;g.length>0;){var x=g.shift();for(k=p;k--;)if(b[k].id===x){b.splice(k,1);break}j=true;p=b.length}if(j){d=a;for(k=p;k--;)d=b[k].frequency<d?b[k].frequency:d}for(k=p;k--;){x=l-b[k].lastTick;if(b[k].lastTick===0||x>=b[k].frequency){b[k].execute(l,
b[k]);b[k].lastTick=l;b[k].single&&b[k].trigger("complete")}}i=p?setTimeout(e,d):0}var a=6E4,c=0,b=[],g=[],i=0,d=a,j=true;return{join:function(k){var l=new f(k);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});b.unshift(l);h();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function f(d){return d<10?"0"+d:d}function m(d){a.lastIndex=0;return a.test(d)?'"'+d.replace(a,function(j){var k=g[j];return typeof k==="string"?k:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function h(d,j){var k,l,p,x,z=c,n,o=j[d];if(o&&typeof o==="object"&&typeof o.toJSON==="function")o=o.toJSON(d);if(typeof i==="function")o=i.call(j,d,o);switch(typeof o){case "string":return m(o);case "number":return isFinite(o)?String(o):"null";case "boolean":case "null":return String(o);
case "object":if(!o)return"null";c+=b;n=[];if(Object.prototype.toString.apply(o)==="[object Array]"){x=o.length;for(k=0;k<x;k+=1)n[k]=h(k,o)||"null";p=n.length===0?"[]":c?"[\n"+c+n.join(",\n"+c)+"\n"+z+"]":"["+n.join(",")+"]";c=z;return p}if(i&&typeof i==="object"){x=i.length;for(k=0;k<x;k+=1){l=i[k];if(typeof l==="string")if(p=h(l,o))n.push(m(l)+(c?": ":":")+p)}}else for(l in o)if(Object.hasOwnProperty.call(o,l))if(p=h(l,o))n.push(m(l)+(c?": ":":")+p);p=n.length===0?"{}":c?"{\n"+c+n.join(",\n"+c)+
"\n"+z+"}":"{"+n.join(",")+"}";c=z;return p}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,b,g={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;if(typeof JSON.stringify!=="function")JSON.stringify=function(d,j,k){var l;b=c="";if(typeof k==="number")for(l=0;l<k;l+=1)b+=" ";else if(typeof k==="string")b=k;if((i=j)&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number"))throw Error("JSON.stringify");return h("",
{"":d})};if(typeof JSON.parse!=="function")JSON.parse=function(d,j){function k(p,x){var z,n,o=p[x];if(o&&typeof o==="object")for(z in o)if(Object.hasOwnProperty.call(o,z)){n=k(o,z);if(n!==undefined)o[z]=n;else delete o[z]}return j.call(p,x,o)}var l;d=String(d);e.lastIndex=0;if(e.test(d))d=d.replace(e,function(p){return"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+d+")");return typeof j==="function"?k({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function f(h,e){var a=h.split("|"),c={};for(var b in e){var g=e[b];c[b]=a.length>g?a[g]:null}return c}var m={JSON:{parse:function(h){return JSON.parse(h)}},PDON:{parse:function(h){var e=null,a=[];h=h.split("\n");for(var c=0;c<h.length;c++){var b=h[c];if(e)a.push(f(b,e));else if(b){e=b.split("|");b={};for(var g=0;g<e.length;g++)b[e[g]]=g;e=b}else e=null}return a}}};COG.parseData=function(h,e){e=e?e.toUpperCase():"JSON";if(!m[e])throw Error("Unsupported data format: "+e);try{return m[e].parse(h)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function f(a){for(var c=null,b=0;b<m.length;b++)if(c=m[b](a))break;return c}var m=[],h=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var b=null;if(a.resultType>=0&&a.resultType<h.length)b=h[a.resultType];if(b)c=b(a)}return c?c:""}}},first:function(a,c){var b=e.SearchResult,g;var i=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!i)i=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))g=c.evaluate(a,c,f,i,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");g=null}}catch(d){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);g=null}return new b(g)},registerResolver:function(a){m.push(a)}};return e}();
COG.Storage=function(){function f(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,h){var e=f(h).getItem(m);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(m,h,e){h=jQuery.isArray(h)||jQuery.isPlainObject(h)?JSON.stringify(h):h;f(e).setItem(m,h)},remove:function(m,h){f(h).removeItem(m)}}}();
COG.ParseRules=function(){var f=[];return{add:function(m,h){f.push({regex:m,handler:h})},each:function(m,h,e){function a(){c++;e&&c>=f.length&&e(h)}for(var c=0,b=0;b<f.length;b++){var g=f[b].regex,i=f[b].handler,d=false;if(g){g.lastIndex=-1;if((g=g.exec(m))&&i){d=true;i(g,h,a)&&a()}}d||a()}}}};
(function(){function f(g){var i=[],d=function(k,l){l=COG.isFunction(l)?l():l;i[i.length]=encodeURIComponent(k)+"="+encodeURIComponent(l)};if(COG.isArray(g))for(var j=0;j<g.length;j++)d(g[j].name,g[j].value);else for(j in g)d(j,g[j]);return i.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},h={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(g){return g.responseXML},JSON:function(g){return COG.parseData(g.responseText)},
PDON:function(g){return COG.parseData(g.responseText,"PDON")},DEFAULT:function(g){return g.responseText}},b={CONTENT_TYPE:"Content-Type"};COG.xhr=function(g){function i(){if(this.readyState===4){var l=null,p=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(p)if(g.handleResponse)g.handleResponse(this);else{var x=g,z=this.getResponseHeader(b.CONTENT_TYPE),n,o=false;for(n in m)if(z&&z.indexOf(m[n])>=0){o=true;
break}z=!o;for(o=0;o<e.length;o++)z=z||e[o]==n;if(z)b:{z=n;for(var s in h)for(o=0;o<h[s].length;o++)if(RegExp(h[s][o]+"$","i").test(x.url)){n=s;break b}n=z?z:"DEFAULT"}try{l=c[n](this,x)}catch(r){l=c.DEFAULT(this,x)}}else g.error&&g.error(this)}catch(U){COG.Log.exception(U,"PROCESSING AJAX RESPONSE")}p&&l&&g.success&&g.success.call(this,l)}}try{g=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},g);var d=
a.exec(g.url),j=d&&(d[1]&&d[1]!==location.protocol||d[2]!==location.host);if(g.data)g.method="POST";if(g.url){d=null;if(g.xhr)d=g.xhr(g);d||(d=new XMLHttpRequest);d.open(g.method,g.url,g.async);g.data&&d.setRequestHeader("Content-Type",g.contentType);j||d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.onreadystatechange=i;d.send(g.method=="POST"?f(g.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(k){COG.Log.exception(k)}}})();
(function(){function f(a){var c=document.createElement("script"),b=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!b&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){b=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};h||(h=document.getElementsByTagName("head")[0]);h.appendChild(c)}var m=0,h,e=this;COG.jsonp=function(a,c,b){a+=a.indexOf("?")>=0?"&":"?";var g="json"+ ++m;e[g]=function(i){c(i);e[g]=null;try{delete e[g]}catch(d){}};
f(a+(b?b:"callback")+"="+g);return g}})();
COG.Touch=function(){function f(v,C){return{x:v.x-C.x,y:v.y-C.y}}function m(v,C){var H=f(v,C);return Math.sqrt(H.x*H.x+H.y*H.y)}function h(v){if(v.count>1)return m(v.touches[0],v.touches[1]);return 0}function e(v,C){var H=v&&v.count>0?v.touches[0]:null;if(H&&C&&C.count>0)return f(H,C.touches[0]);return null}function a(v,C){v.count=C.count;for(var H=d;H--;){v.touches[H].x=C.touches[H].x;v.touches[H].y=C.touches[H].y}}function c(){for(var v={count:0,touches:Array(d)},C=d;C--;)v.touches[C]=i();return v}
function b(v){if(v.preventDefault){v.preventDefault();v.stopPropagation()}else v.cancelBubble&&v.cancelBubble()}function g(v,C,H){if(D){C=C[H?H:"touches"];H=C.length;for(H=v.count=H;H--;){v.touches[H].x=C[H].pageX;v.touches[H].y=C[H].pageY}}else if(C.button===0){v.count=1;v.touches[0].x=C.pageX?C.pageX:C.screenX;v.touches[0].y=C.pageY?C.pageY:C.screenY}else v.count=0}function i(v,C){return{x:v?v:0,y:C?C:0}}var d=10,j=120,k=100,l=250,p=300,x=5,z=0,n=1,o=2,s=7,r=0,U=0,D=undefined,ga=function(v){function C(u,
A,y,q){var t=Math.asin((u.y-A.y)/y);y=y*(qa/q)>>0;y=y>na?na:y;t=A.x>u.x?t:Math.PI-t;W("pan",Math.cos(t)*-y,Math.sin(t)*y,true)}function H(u,A){var y,q;if(D){y=A-ia;if(y<l){q=m(M.touches[0],u);q>v.inertiaTrigger&&C(M.touches[0],u,q,y)}}else{Y.x=u.x;Y.y=u.y;COG.Loopage.join({execute:function(t,B){y=t-A;q=m(u,Y);if(y<k&&q>v.inertiaTrigger){B.trigger("complete");C(u,Y,q,y)}else y>k&&B.trigger("complete")},frequency:10})}}function ba(u){var A=0,y=0;if(u.offsetParent){do{A+=u.offsetLeft;y+=u.offsetTop;
u=u.offsetParent}while(u)}return i(A,y)}function ea(u){var A=u.count,y=Array(A),q=ba(Z);for(A=A;A--;)y[A]=i(u.touches[A].x-q.x,u.touches[A].y-q.y);return y}function W(){oa&&oa.trigger.apply(null,arguments)}function Q(u,A){var y=ba(Z);y=i(A.x-y.x,A.y-y.y);W(u,A,y)}function w(u){var A=u.target?u.target:u.srcElement;if($||A&&A===Z){g(M,u);if(M.count!==0){V=null;ca.x=0;ca.y=0;ja=true;I=false;ia=(new Date).getTime();b(u);A.style.cursor="move";W("inertiaCancel");ka=ia;if(u=M.count>0?M.touches[0]:null){W("touchStart",
u.x,u.y);if(ka-la<p)if((u=f(M.touches[0],R.touches[0]))&&Math.abs(u.x)<v.maxDistDoubleTap&&Math.abs(u.y)<v.maxDistDoubleTap)I=true;F=z;a(R,M)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function G(u){var A=u.target?u.target:u.srcElement,y=0;if($||A&&A===Z){g(K,u);if(K.count>0){Y.x=K.touches[0].x;Y.y=K.touches[0].y}if(ja){D&&b(u);if(K.count>1){M.count===1&&a(M,K);y=h(M)-h(K)}if(F===z)if((u=e(K,M))&&(Math.abs(u.x)>=s||Math.abs(u.y)>=s))F=n;if(F!==z)if(!y||Math.abs(y)<x){if(V=
e(K,R)){ca.x-=V.x;ca.y-=V.y;X.x-=V.x;X.y-=V.y}W("pan",X.x,X.y);X.x=0;X.y=0;F=n}else{W("pinchZoom",ea(M),ea(K));F=o}a(R,K)}}}function E(u){var A=u.target?u.target:u.srcElement;if(ja&&($||A&&A===Z)){g(T,u,"changedTouches");var y=T.touches[0];D&&b(u);u=(new Date).getTime();la=ka;if(F===z){Q("tap",M.touches[0]);P||(P=setTimeout(function(){P=0;I&&Q("doubleTap",M.touches[0])},p+50))}else if(F==n){W("panEnd",ca.x,ca.y);pa&&H(y,u)}else F==o&&W("pinchZoomEnd",ea(M),ea(R),u-ia);A.style.cursor="default";ja=
false}}function J(u){var A=u.target?u.target:u.srcElement;if($||A&&A===Z){if(u.detail){A=-u.detail*j;A=i(u.axis===1?A:0,u.axis===2?A:0)}else A=i(u.wheelDeltaX,u.wheelDeltaY);var y=A.y!==0?Math.abs(A.y/j):0;if(Y&&y!==0){var q=i(Y.x-Z.offsetLeft,Y.y-Z.offsetTop);W("wheelZoom",q,Math.pow(2,A.y>0?y:-y))}b(u)}}v=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,
doubleTapHandler:null,wheelZoomHandler:null},v);var I=false,P=0,N=T5.getConfig(),M=c(),K=c(),R=c(),T=c(),V=null,ca=i(),X=i(),F=null,ja=false,ia=0,fa=[],Y=i(),pa=false,qa,na,ka=0,la=0,Z=v.element,oa=v.observable,$=typeof FlashCanvas!=="undefined",ra={supportsTouch:D,addListeners:function(u){fa.push(u)},decoupleListeners:function(u){for(var A=0;u&&A<fa.length;A++)if(fa[A].listenerId===u){fa.splice(A,1);break}},release:function(){N.unbindEvent(D?"touchstart":"mousedown",w,false);N.unbindEvent(D?"touchmove":
"mousemove",G,false);N.unbindEvent(D?"touchend":"mouseup",E,false);if(!D){window.removeEventListener("mousewheel",J,false);window.removeEventListener("DOMMouseScroll",J,false)}},inertiaEnable:function(u,A){pa=true;qa=u;na=A?Math.min(A.width,A.height):500},inertiaDisable:function(){pa=false}};if(typeof D==="undefined")D=T5.getConfig().supportsTouch;N.bindEvent(D?"touchstart":"mousedown",w,false);N.bindEvent(D?"touchmove":"mousemove",G,false);N.bindEvent(D?"touchend":"mouseup",E,false);if(!D){N.bindEvent("mousewheel",
J,window);N.bindEvent("DOMMouseScroll",J,window)}return ra},S=[];return{capture:function(v,C){if(!v)throw Error("Unable to capture touch of null element");if(!v.id)v.id="touchable_"+r++;var H=S[v.id];if(!H){H=new ga(COG.extend({element:v},C));S[v.id]=H}if(C){C.listenerId&&H.decoupleListeners(C.listenerId);C.listenerId=++U;H.addListeners(C)}return H},release:function(v){if(v&&v.id&&S[v.id]){S[v.id].release();delete S[v.id]}}}}();
T5=function(){var f=function(b,g){return{x:b?b:0,y:g?g:0}},m=function(){function b(i,d){return new f(i.x-d.x,i.y-d.y)}function g(i,d){if(!d)d=i.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var j={edges:Array(d-1),accrued:Array(d-1),total:0},k=0;k<d-1;k++){var l=b(i[k],i[k+1]);j.edges[k]=Math.sqrt(l.x*l.x+l.y*l.y);j.accrued[k]=j.total+j.edges[k];j.total+=j.edges[k]}return j}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,create:function(i,
d){return new f(i,d)},add:function(){for(var i=new f,d=arguments.length;d--;){i.x+=arguments[d].x;i.y+=arguments[d].y}return i},absSize:function(i){return Math.max(Math.abs(i.x),Math.abs(i.y))},diff:b,dotProduct:function(i,d){return i.x*d.x+i.y*d.y},equals:function(i,d){return i.x===d.x&&i.y===d.y},copy:function(i){return i?new f(i.x,i.y):null},invert:function(i){return new f(-i.x,-i.y)},offset:function(i,d,j){return new f(i.x+d,i.y+(j?j:d))},edges:g,floor:function(i){for(var d=Array(i.length),j=
i.length;j--;)d[j]=new T5.Vector(~~i[j].x,~~i[j].y);return d},distance:function(i,d){return g(i,d).total},simplify:function(i,d){if(!i)return null;d=d?d:m.VECTOR_SIMPLIFICATION;for(var j=[],k=null,l=i.length;l--;){var p=i[l];if(include=!k||l===0||Math.abs(p.x-k.x)+Math.abs(p.y-k.y)>d){j.unshift(p);k=p}}return j},theta:function(i,d,j){j=Math.asin((i.y-d.y)/j);return i.x>d.x?j:Math.PI-j},pointOnEdge:function(i,d,j,k){d=new f(Math.cos(j)*k,Math.sin(j)*k);return new f(i.x-d.x,i.y-d.y)},getRect:function(i){var d=
i.length;if(d>1)return new h(Math.min(i[0].x,i[d-1].x),Math.min(i[0].y,i[d-1].y),Math.abs(i[0].x-i[d-1].x),Math.abs(i[0].y-i[d-1].y))},toString:function(i){return i.x+", "+i.y}}}(),h=function(b,g,i,d){return{origin:new f(b,g),dimensions:new a(i,d),invalid:false}},e=function(){return{bottomRight:function(b){return m.offset(b.origin,b.dimensions.width,b.dimensions.height)},empty:function(){return new h(0,0,0,0)},copy:function(b){return b?new h(b.origin.x,b.origin.y,b.dimensions.width,b.dimensions.height):
null},getCenter:function(b){return new f(b.origin.x+b.dimensions.width/2,b.origin.y+b.dimensions.height/2)},isEmpty:function(b){return b.dimensions.width===0||b.dimensions.height===0},union:function(){if(!(arguments.length<2)){for(var b=arguments[0].origin.y,g=arguments[0].origin.x,i=b+arguments[0].dimensions.height,d=g+arguments[0].dimensions.width,j=Array.prototype.slice.call(arguments,1),k=j.length;k--;){var l=j[k].origin.y,p=j[k].origin.x,x=l+j[k].dimensions.height,z=p+j[k].dimensions.width;b=
b<l?b:l;g=g<p?g:p;i=i>x?i:x;d=d>z?d:z}arguments[0].origin.x=g;arguments[0].origin.y=b;arguments[0].dimensions.width=d-g;arguments[0].dimensions.height=i-b}}}}(),a=function(b,g){return{width:b?b:0,height:g?g:0}},c=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return new f(b.width/2,b.height/2)},getSize:function(b){return Math.sqrt(Math.pow(b.width,2)+Math.pow(b.height,2))}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},
Vector:f,V:m,Dimensions:a,D:c,Rect:h,R:e}}();
(function(){function f(){for(;x.length>0;){var n=x.shift();document.location=n}p=0}function m(n){for(var o=true,s=z.length;s--;)o=o&&n!=z[s];return o}function h(n,o){var s=[];for(var r in o)r&&s.push(r+"="+escape(o[r]));return"tile5://"+n+"/"+(s.length>0?"?"+s.join("&"):"")}function e(n,o){m(n)&&COG.Log.info("would push url: "+h(n,o))}function a(n,o){if(m(n)){x.push(h(n,o));p||(p=setTimeout(f,100))}}function c(n){return function(o,s,r){(r?r:n?document.body:document).addEventListener(o,s,false)}}function b(n){return function(o,
s,r){(r?r:n?document.body:document).removeEventListener(o,s,false)}}function g(n,o,s){(s?s:document).attachEvent("on"+n,o)}function i(n,o,s){(s?s:document).detachEvent("on"+n,o)}function d(){j={base:{name:"Unknown",bindEvent:c(),unbindEvent:b(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:g,unbindEvent:i,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:b(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};k=[j.froyo,j.android,j.ipod,j.iphone,j.ipad,j.ie]}var j=null,k=[],l=null,p=0,x=[],z=["view.wake","tile.loaded"];T5.getConfig=function(){j||d();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var n=0;n<k.length;n++){var o=k[n];if(o.regex&&o.regex.test(navigator.userAgent)){l=T5.ex({},j.base,o);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=j.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var f=[],m={execute:function(h){var e=m.findAction(h);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(h){for(var e=f.length;e--;)if(f[e].id==h)return f[e];return null},getRegisteredActions:function(){return[].concat(f)},getRegisteredActionIds:function(){for(var h=[],e=f.length;e--;)f[e].id&&h.push(f[e].id);return h},registerAction:function(h){h&&h.id&&f.push(h)},Action:function(h){h=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},h);var e={id:h.id,execute:function(){h.execute&&h.execute.apply(this,arguments)},getParam:function(a){return h[a]?h[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,h.title,h.icon)}};h.autoRegister&&m.registerAction(e);return e},Agent:function(h){h=COG.extend({name:"Untitled",translator:null,execute:null},h);var e={getName:function(){return h.name},getParam:function(a){return h[a]},getId:function(){return COG.toID(e.getName())},run:function(a,c){if(h.execute){var b=
h.translator?h.translator(a):a;h.execute.call(e,b,function(g,i){c&&c(g,i,b)})}}};return e},runAgents:function(h,e,a){for(var c=0;c<h.length;c++)h[c].run(e,a)}};return m}();
T5.Resources=function(){var f="",m={},h={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:f+e},setBasePath:function(e){f=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var a=function(c){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(c)})};e.cacheable&&m[e.filename]?a(m[e.filename]):COG.xhr({url:h.getPath(e.filename),dataType:e.dataType,success:function(c){if(e.cacheable)m[e.filename]=c;a(c)},error:function(c,b,g){COG.Log.error("error loading resource ["+
e.filename+"], error = "+g)}})},loadSnippet:function(e,a){/\.\w+$/.test(e)||(e+=".html");h.loadResource({filename:"snippets/"+e,callback:a,dataType:"html"})}};return h}();
T5.Images=function(){function f(){if(!p){var n=T5.getConfig().maxImageLoads;p=COG.Loopage.join({execute:function(o,s){if(!n||j.length<n){var r=d.shift();if(r){j[j.length]=r;r.image.onload=h;r.image.src=T5.Resources.getPath(r.url);r.requested=T5.ticks()}else s.trigger("complete")}},frequency:10});p.bind("complete",function(){p=null})}}function m(){x=true;try{var n=k.length/2>>0;if(n>0){k.sort(function(s,r){return s.created-r.created});for(var o=n;o--;)delete c[k[o].url];k.splice(0,n)}}finally{x=false}COG.say("imagecache.cleared")}
function h(){var n=g[this.id],o;if(n&&n.image.complete&&n.image.width>0){n.loaded=true;n.hitCount=1;for(o=j.length;o--;)if(j[o].image.src==this.src){j.splice(o,1);break}if(n.background||n.postProcess||n.drawBackground||n.customDraw)if(n.image){o=a(n.realSize?n.realSize.width:image.width,n.realSize?n.realSize.height:image.height);var s=o.getContext("2d"),r=n.offset?n.offset:new T5.Vector;n.background&&s.drawImage(n.background,0,0);n.drawBackground&&n.drawBackground(s);n.customDraw?n.customDraw(s,n):
s.drawImage(n.image,r.x,r.y);n.postProcess&&n.postProcess(s,n);n.image=o}for(o=n.callbacks.length;o--;)n.callbacks[o]&&n.callbacks[o](this,false);n.callbacks=[];k[k.length]={url:this.src,created:n.requested};delete g[this.id];f()}}function e(n,o,s){var r=c[n];if(r){r.hitCount++;r.image.complete&&r.image.width>0&&o?o(r.image,true):r.callbacks.push(o)}else{r=T5.ex({url:n,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[o]},s);r.image.id="resourceLoaderImage"+i++;
c[n]=r;g[r.image.id]=r;d[d.length]=r;f()}return r}function a(n,o){var s=document.createElement("canvas");s.width=n?n:0;s.height=o?o:0;if(typeof FlashCanvas!=="undefined"){s.id="tmpCanvas"+b++;s.style.cssText="position: absolute; top: -"+(o-1)+"px; left: -"+(n-1)+"px;";document.body.appendChild(s);FlashCanvas.initElement(s)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(s);return s}var c={},b=0,g={},i=0,d=[],j=[],k=[],l=0,p=null,x=false,z={avgImageSize:25,loadTimeout:10,cancelLoad:function(){j=
[]},get:function(n,o){var s=null,r=null;x||(s=c[n]);if((r=s?s.image:null)&&(r.getContext||r.complete&&r.width>0))return r;else e(n,o);return null},load:e,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:j.length,queuedImageCount:d.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(n){for(var o=false,s=0,r=T5.getConfig();s<j.length;)if(n-j[s].requested>z.loadTimeout*1E3){j.splice(s,1);o=true}else s++;o&&f();if(r&&r.imageCacheMaxSize){l=k.length*z.avgImageSize/
r.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return z}();
T5.TimeLord=function(){var f=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,h=function(a,c){return{days:a?a:0,seconds:c?c:0}},e={8601:function(a){a=a.split("T");var c=null;c=null;var b=0,g=0;f.lastIndex=-1;c=f.exec(a[0]);b+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(a[1]);g+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;g+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;g+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new h(b,g)}};return{Duration:h,addDuration:function(){for(var a=new h,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var b=c?e[c]:null;if(b)return b(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new h},formatDuration:function(a){var c,b,g="";if(a.days)g=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){b=Math.round(a/60);a-=b*60}if(c)g=g+c+(c>1?" hrs ":" hr ")+
(b?(b>10?b:"0"+b)+" min ":"");else if(b)g=g+b+" min";else if(a>0)g=g+(a>10?a:"0"+a)+" sec"}return g}}}();
(function(){var f=Math.PI*2,m=Math.PI/2,h=Math.abs,e=Math.pow,a=Math.sin,c=Math.asin,b=Math.cos,g=1.70158,i={linear:function(d,j,k,l){return k*d/l+j},backin:function(d,j,k,l){return k*(d/=l)*d*((g+1)*d-g)+j},backout:function(d,j,k,l){return k*((d=d/l-1)*d*((g+1)*d+g)+1)+j},backinout:function(d,j,k,l){return(d/=l/2)<1?k/2*d*d*(((g*=1.525)+1)*d-g)+j:k/2*((d-=2)*d*(((g*=1.525)+1)*d+g)+2)+j},bouncein:function(d,j,k,l){return k-i.bounceout(l-d,0,k,l)+j},bounceout:function(d,j,k,l){return(d/=l)<1/2.75?
k*7.5625*d*d+j:d<2/2.75?k*(7.5625*(d-=1.5/2.75)*d+0.75)+j:d<2.5/2.75?k*(7.5625*(d-=2.25/2.75)*d+0.9375)+j:k*(7.5625*(d-=2.625/2.75)*d+0.984375)+j},bounceinout:function(d,j,k,l){return d<l/2?i.bouncein(d*2,0,k,l)/2+j:i.bounceout(d*2-l,0,k,l)/2+k/2+j},cubicin:function(d,j,k,l){return k*(d/=l)*d*d+j},cubicout:function(d,j,k,l){return k*((d=d/l-1)*d*d+1)+j},cubicinout:function(d,j,k,l){if((d/=l/2)<1)return k/2*d*d*d+j;return k/2*((d-=2)*d*d+2)+j},elasticin:function(d,j,k,l,p,x){if(d==0)return j;if((d/=
l)==1)return j+k;x||(x=l*0.3);if(!p||p<h(k)){p=k;k=x/4}else k=x/f*c(k/p);return-(p*e(2,10*(d-=1))*a((d*l-k)*f/x))+j},elasticout:function(d,j,k,l,p,x){var z;if(d==0)return j;if((d/=l)==1)return j+k;x||(x=l*0.3);if(!p||p<h(k)){p=k;z=x/4}else z=x/f*c(k/p);return p*e(2,-10*d)*a((d*l-z)*f/x)+k+j},elasticinout:function(d,j,k,l,p,x){var z;if(d==0)return j;if((d/=l/2)==2)return j+k;x||(x=l*0.3*1.5);if(!p||p<h(k)){p=k;z=x/4}else z=x/f*c(k/p);if(d<1)return-0.5*p*e(2,10*(d-=1))*a((d*l-z)*f/x)+j;return p*e(2,
-10*(d-=1))*a((d*l-z)*f/x)*0.5+k+j},quadin:function(d,j,k,l){return k*(d/=l)*d+j},quadout:function(d,j,k,l){return-k*(d/=l)*(d-2)+j},quadinout:function(d,j,k,l){if((d/=l/2)<1)return k/2*d*d+j;return-k/2*(--d*(d-2)-1)+j},sinein:function(d,j,k,l){return-k*b(d/l*m)+k+j},sineout:function(d,j,k,l){return k*a(d/l*m)+j},sineinout:function(d,j,k,l){return-k/2*(b(Math.PI*d/l)-1)+j}};T5.easing=function(d){return i[d.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(d,j){i[d.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=j}})();
T5.Tween=function(f){f=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},f);var m=T5.ticks(),h=[],e=false,a=0,c=0,b={cancelOnInteract:f.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(g){f.complete&&f.complete(g)},update:function(g){try{var i=f.tweenFn(g-m,a,c,f.duration);if(f.target)f.target[f.property]=i;for(var d=h.length;d--;)h[d](i,void 0);if(e=m+f.duration<=g){if(f.target)f.target[f.property]=
f.tweenFn(f.duration,a,c,f.duration);for(var j=h.length;j--;)h[j](i,true)}}catch(k){COG.Log.exception(k)}},requestUpdates:function(g){h.push(g)}};a=f.target&&f.property&&f.target[f.property]?f.target[f.property]:f.startValue;if(typeof f.endValue!=="undefined")c=f.endValue-a;if(c==0)e=true;T5.wakeTweens();return b};
(function(){function f(a){if(e)return m.length;e=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(a);c++}}finally{e=false}m.length===0&&h.trigger("complete");return m.length}var m=[],h=null,e=false;T5.tweenValue=function(a,c,b,g,i){a=new T5.Tween({startValue:a,endValue:c,tweenFn:b,complete:g,duration:i});m.push(a);return a};T5.tween=function(a,c,b,g,i,d){a=new T5.Tween({target:a,property:c,endValue:b,tweenFn:g,duration:d,complete:i});
m.push(a);return a};T5.tweenVector=function(a,c,b,g,i,d){var j=[];if(a){var k=a.x==c,l=a.y==b;k||j.push(T5.tween(a,"x",c,g,function(){(k=true)&&l&&i()},d));l||j.push(T5.tween(a,"y",b,g,function(){l=true;k&&l&&i()},d))}return j};T5.cancelAnimation=function(a){if(!e){e=true;try{for(var c=0;c<m.length;)if(!a||a(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{e=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!h){h=COG.Loopage.join({execute:f,frequency:20});
h.bind("complete",function(){h=null})}}})();(function(){var f={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,PINCH:16,FREEZE:128};T5.viewState=function(){for(var m=0,h=arguments.length;h--;){var e=f[arguments[h].toUpperCase()];if(e)m|=e}return m}})();
T5.ViewLayer=function(f){f=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","PINCH")},f);var m=null,h=false,e=false,a=f.supportFastDraw,c=f.id,b=T5.viewState("ACTIVE"),g=f.validStates,i=0,d=0,j=T5.ex({addToView:function(k){k.setLayer(c,j)},shouldDraw:function(k,l,p){k=(k&g)!==0&&(h?a:true);return k=e||p||i!==l.x||d!==l.y},cycle:function(){},draw:function(){},remove:function(){j.trigger("remove",j)},changed:function(){e=true;j.trigger("changed",
j);m&&m.trigger("invalidate")},getId:function(){return c},setId:function(k){c=k},getParent:function(){return m},setParent:function(k){h=(m=k)?m.fastDraw&&displayState!==b:false;j.trigger("parentChange",m)}},f);COG.observable(j);j.bind("drawComplete",function(k,l){e=false;i=l.x;d=l.y});return j};
T5.View=function(f){function m(q,t,B,L){$=la;s();if(L&&f.inertia){J=true;d(S+t,v+B,f.panAnimationEasing,f.panAnimationDuration)}else L||d(S+t,v+B)}function h(){$=ka;J=false;COG.Loopage.join({execute:s,after:50,single:true})}function e(q,t){R=ra(q);T=ra(t);var B=u(R.dimensions),L=u(T.dimensions);Y=A(R);G=A(T);F=R&&B!==0?L/B:1}function a(q,t,B){e(t,B);if(K=F!==1){$=Z;s()}}function c(q,t,B,L){e(t,B);if(f.adjustScaleFactor){F=f.adjustScaleFactor(F);COG.Log.info("scale factor adjusted to: "+F)}if(L<f.pinchZoomAnimateTrigger){l(ia,
F,Y,p(),T5.easing("sine.out"),function(){g();F=1},300);F=ia}else{g();F=1}}function b(q,t,B){y.zoom(t,Math.min(Math.pow(2,Math.round(Math.log(B))),8),500)}function g(){var q=R?p():G;F=Math.round(F*10)/10;K=false;for(var t=r.length;t--;)r[t].trigger("scale",F,q);y.trigger("scale",F,q);$=ka;s()}function i(){clearTimeout(X);X=setTimeout(j,50)}function d(q,t,B,L,O){function aa(){da+=1;if(da>=2){h(0,0);O&&O()}}var da=0;if(B){q=T5.tweenValue(S,q,B,aa,L);t=T5.tweenValue(v,t,B,aa,L);q.cancelOnInteract=true;
q.requestUpdates(function(ha){S=ha;J=true;s()});t.cancelOnInteract=true;t.requestUpdates(function(ha){v=ha;J=true;s()})}else{S=q;v=t}}function j(){var q;if(D){COG.Touch.release(D);if(f.autoSize&&D.parentNode){q=D.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){D.height=q.height;D.width=q.width}}try{if(!D.id)D.id=f.id+"_canvas";ga=D.getContext("2d");ga.clearRect(0,0,D.width,D.height)}catch(t){COG.Log.exception(t);throw Error("Could not initialise canvas on specified view element");
}na=COG.Touch.capture(D,{observable:y});if(Q.height!==D.height||Q.width!==D.width){Q=new T5.Dimensions(D.width,D.height);y.trigger("resize",D.width,D.height);for(q=U;q--;)r[q].trigger("resize",D.width,D.height)}f.inertia&&na.inertiaEnable(f.panAnimationDuration,Q);for(q=U;q--;)r[q].trigger("contextChanged",ga);o()}}function k(q,t){t.setId(q);t.added=T5.ticks();t.bind("remove",function(){y.removeLayer(q)});t.trigger("contextChanged",ga);t.setParent(y);r.push(t);r.sort(function(B,L){var O=L.zindex-
B.zindex;if(O===0)O=L.added-B.added;return O});U=r.length;return t}function l(q,t,B,L,O,aa,da){function ha(){aa&&aa();g();F=1;fa=null}K=true;Y=T5.V.copy(B);G=T5.V.copy(L);R=null;if(O)T5.tweenValue(0,t-q,O,ha,da?da:1E3).requestUpdates(function(ma){fa=ma/(t-q);F=q+ma;$=Z;s();y.trigger("animate")});else{F=targetScaleFactor;ha()}}function p(){var q=T5.D.getCenter(Q),t=T5.V.distance([G,q]),B=T5.V.theta(G,q,t),L=T5.V.diff(Y,G);q=T5.V.pointOnEdge(G,q,B,t/F);q.x+=L.x;q.y+=L.y;return q}function x(){y.trigger("idle");
E=true;I=0}function z(q,t,B,L,O){if(ea)t=T5.viewState("FROZEN");var aa=(t&Z)!==0,da=0;if(H||aa){q.clearRect(0,0,D.width,D.height);H=false}if(aa){T5.D.getCenter(Q);var ha=(fa?fa:1)/2,ma=T5.V.diff(Y,G);if(R){N.x=G.x+ma.x;N.y=G.y+ma.y}else{N.x=G.x-ma.x*ha;N.y=G.y-ma.y*ha}B=T5.V.offset(B,N.x,N.y)}q.save();try{ia=F;if(W!==1)q.scale(W,W);else if(aa){q.translate(G.x,G.y);q.scale(F,F)}for(da=U;da--;)if(r[da].shouldDraw(t,B,L)){r[da].draw(q,B,Q,t,y,L,O);r[da].trigger("drawComplete",B,O)}}finally{q.restore()}y.trigger("drawComplete",
B,O);COG.Log.trace("draw complete",O)}function n(q,t){var B=false,L=V?V:J?la:$,O=!J&&(L===Z||L===la),aa=ca||L===la||L===Z||T5.isTweening();C.x=S>>0;C.y=v>>0;if(O){T5.cancelAnimation(function(da){return da.cancelOnInteract});E=false;if(I!==0){clearTimeout(I);I=0}}for(O=U;O--;){if(r[O].animated)$|=oa;B=r[O].cycle(q,C,$,aa)||B}aa=aa||($&oa)!==0;if(B=B||aa||F!==1&&F!==ja){z(ga,L,C,aa,q);ja=F;ca=false}if(!B&&w===0&&!pa){if(!E&&I===0)I=setTimeout(x,500);t.trigger("complete")}w=0;COG.Log.trace("Completed draw cycle",
q)}function o(){ca=true;s()}function s(){w+=1;if(!(ea||ba)){ba=COG.Loopage.join({execute:n,frequency:qa});ba.bind("complete",function(){ba=null})}}f=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},f);var r=[],U=0,D=document.getElementById(f.container),ga=null,S=0,v=0,C=new T5.Vector,H=false,ba=null,
ea=false,W=1,Q=new T5.Dimensions,w=0,G=null,E=false,J=false,I=0,P=0,N=new T5.Vector,M=0,K=false,R=null,T=null,V=null,ca=false,X=0,F=1,ja=0,ia=1,fa=null,Y=null,pa=typeof FlashCanvas!=="undefined",qa=~~(1E3/f.fps),na=null,ka=T5.viewState("ACTIVE"),la=T5.viewState("PAN"),Z=T5.viewState("PINCH"),oa=T5.viewState("ANIMATING"),$=ka,ra=T5.V.getRect,u=T5.D.getSize,A=T5.R.getCenter,y={id:f.id,deviceScaling:W,fastDraw:f.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,t,B,L,O){l(F,q,t,B,L,O)},centerOn:function(q){S=
q.x-D.width/2;v=q.y-D.height/2},getDimensions:function(){return Q},getZoomCenter:function(){return N},getLayer:function(q){for(var t=0;t<U;t++)if(r[t].getId()==q)return r[t];return null},setLayer:function(q,t){for(var B=0;B<U;B++)if(r[B].getId()===q){r.splice(B,1);break}t&&k(q,t);o()},eachLayer:function(q){for(var t=U;t--;)q(r[t])},clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");H=true;o()},invalidate:o,freeze:function(){ea=true},unfreeze:function(){ea=false;
s()},resize:function(q,t){if(D){f.autoSize=false;D.width=q;D.height=t;j();y.trigger("resize",D.width,D.height)}},scale:function(q,t,B,L,O){L||(L=T5.D.getCenter(Q));O||(O=T5.D.getCenter(Q));y.animate(q,L,O,t,B);return y},removeLayer:function(q){a:{for(var t=U;t--;)if(r[t].getId()==q){q=t;break a}q=-1}if(q>=0&&q<U){COG.say("layer.removed",{layer:r[q]});r.splice(q,1);o()}U=r.length},stateOverride:function(q){V=q},getOffset:function(){return C},updateOffset:d,zoom:function(q,t,B){J=false;F=t;K=F!==1;
Y=T5.D.getCenter(Q);G=F>1?T5.V.copy(q):T5.D.getCenter(Q);R=null;clearTimeout(P);if(K){$=Z;s();if(B)P=setTimeout(function(){g();F=1},parseInt(B,10))}}};W=T5.getConfig().getScaling();y.markers=k("markers",new T5.MarkerLayer);COG.observable(y);y.bind("wake",s);y.bind("invalidate",o);if(f.pannable){y.bind("pan",m);y.bind("panEnd",h);y.bind("inertiaCancel",function(){J=false;s()})}if(f.scalable){y.bind("pinchZoom",a);y.bind("pinchZoomEnd",c);y.bind("wheelZoom",b)}y.bind("tap",function(q,t,B){for(var L=
T5.V.offset(B,S,v),O=r.length;O--;)q.cancel=q.cancel||r[O].trigger("tap",t,B,L).cancel});COG.configurable(y,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(f,null,{container:function(q,t){D=document.getElementById(t);j()},rotation:function(q,t){M=t}}),true);j();f.autoSize&&window.addEventListener("resize",i,false);return y};
T5.PathLayer=function(f){function m(j){j.syncVectors(c);b&&j.syncVectors(b);d.trigger("tidy")}f=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},f);var h=false,e=[],a=null,c=[],b=null,g=0,i=[],d=T5.ex(new T5.ViewLayer(f),{getAnimation:function(j,k,l,p){var x="pathAnimation"+g++;i.push(x);return new T5.AnimatedPathLayer({id:x,path:e,zindex:f.zindex+1,easing:j?j:T5.easing("sine.inout"),duration:k?k:5E3,drawIndicator:l,autoCenter:p?p:false})},cycle:function(j,k,l,p){return p},draw:function(j,
k){var l,p=e.length;j.save();try{T5.applyStyle(j,f.style);if(p>0){j.beginPath();j.moveTo(e[p-1].x-k.x,e[p-1].y-k.y);for(l=p;l--;)j.lineTo(e[l].x-k.x,e[l].y-k.y);j.stroke();if(a){j.fillStyle=f.waypointFillStyle;for(l=a.length;l--;){j.beginPath();j.arc(a[l].x-k.x,a[l].y-k.y,2,0,Math.PI*2,false);j.stroke();j.fill()}}}}finally{j.restore()}h=false},updateCoordinates:function(j,k){var l=d.getParent();l=l?l.getTileLayer():null;c=j;b=k;COG.Log.info("updating coordinates, grid = "+l);l&&m(l)}});d.bind("gridUpdate",
function(j,k){m(k);for(var l=i.length;l--;)COG.say("layer.remove",{id:i[l]});i=[]});d.bind("tidy",function(){e=T5.V.simplify(c,f.pixelGeneralization);a=T5.V.simplify(b,f.pixelGeneralization);h=true;d.changed()});return d};
T5.ShapeLayer=function(f){f=T5.ex({zindex:80,style:null},f);var m=[],h=false,e=T5.ex(new T5.ViewLayer(f),{add:function(a){m.unshift(a)},cycle:function(){return h},draw:function(a,c,b,g){var i=c.x;c=c.y;var d=b.width;b=b.height;a.save();try{T5.applyStyle(a,f.style);for(var j=m.length;j--;){var k=m[j].style,l=k?T5.applyStyle(a,k):null;m[j].draw(a,i,c,d,b,g);l&&T5.applyStyle(a,l)}}finally{a.restore()}h=false}});e.bind("gridUpdate",function(a,c){for(var b=m.length;b--;)m[b].resync(c);h=true;e.changed()});
e.bind("parentChange",function(a,c){var b=c?c.getTileLayer():null;if(b)for(var g=m.length;g--;)m[g].resync(b)});COG.configurable(e,["style"],COG.paramTweaker(f,null,null),true);return e};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(f){f=T5.ex({style:null},f);return T5.ex(f,{draw:function(){},resync:function(){}})};
T5.Poly=function(f,m){m=T5.ex({fill:false,simplify:false},m);var h=false,e=m.fill,a=m.simplify,c=T5.viewState("PINCH"),b=[],g=T5.ex(new T5.Shape(m),{draw:function(i,d,j,k,l,p){if(h){var x=true;p=(p&c)!==0;var z=false;i.beginPath();for(var n=b.length;n--;){var o=b[n].x-d,s=b[n].y-j;if(x){i.moveTo(o,s);x=false}else i.lineTo(o,s);z=z||!p&&o>=0&&o<=k&&s>=0&&s<=l}if(z){e&&i.fill();i.stroke()}}},resync:function(i){i.syncVectors(f);b=T5.V.floor(a?T5.V.simplify(f):f)}});h=f&&f.length>=2;return g};
T5.AnimatedPathLayer=function(f){function m(g,i,d){g.fillStyle="#FFFFFF";g.strokeStyle="#222222";g.beginPath();g.arc(d.x,d.y,4,0,Math.PI*2,false);g.stroke();g.fill()}f=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","PINCH"),drawIndicator:null,duration:2E3,autoCenter:false},f);var h=T5.V.edges(f.path),e,a=null,c=0;T5.tweenValue(0,h.total,f.easing,function(){b.remove()},f.duration).requestUpdates(function(g,i){c=g;i&&b.remove()});var b=
T5.ex(new T5.ViewLayer(f),{cycle:function(){for(var g=0;g<h.accrued.length&&h.accrued[g]<c;)g++;a=null;if(g<f.path.length-1){var i=c-(g>0?h.accrued[g-1]:0),d=f.path[g],j=f.path[g+1];e=T5.V.theta(d,j,h.edges[g]);a=T5.V.pointOnEdge(d,j,e,i);if(f.autoCenter)(g=b.getParent())&&g.centerOn(a)}return a},draw:function(g,i){if(a)(f.drawIndicator?f.drawIndicator:m)(g,i,new T5.Vector(a.x-i.x,a.y-i.y),e)}});return b};
T5.Marker=function(f){function m(d,j,k,l){e=d;a=j;c=k;b=l}f=T5.ex({xy:new T5.Vector,offset:true,tweenIn:null,animationSpeed:null},f);var h=false,e=0,a=0,c=0,b=0,g=f.offset,i=T5.ex(f,{isNew:true,isAnimating:function(){return h},draw:function(d,j,k,l,p){if(i.isNew&&f.tweenIn){var x=i.xy.y;i.xy.y=j.y-20;h=true;T5.tween(i.xy,"y",x,f.tweenIn,function(){i.xy.y=x;h=false},f.animationSpeed?f.animationSpeed:250+Math.random()*500)}i.drawMarker(d,j,i.xy.x-(g?j.x:0),i.xy.y-(g?j.y:0),k,l,p);i.isNew=false},drawMarker:function(d,
j,k,l){d.beginPath();d.arc(k,l,4,0,Math.PI*2,false);d.fill();m(k-4,l-4,8,8)},hitTest:function(d,j){return d>=e&&d<=e+c&&j>=a&&j<=a+b},updateBounds:m});COG.observable(i);return i};
T5.ImageMarker=function(f){f=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},f);var m=f.imageAnchor?T5.V.invert(f.imageAnchor):null,h=T5.ex(new T5.Marker(f),{drawMarker:function(e,a,c,b){if((a=h.isAnimating()&&h.animatingImage?h.animatingImage:h.image)&&a.complete&&a.width>0){m||(m=new T5.Vector(-a.width>>1,-a.height>>1));var g=h.scale,i=c+~~(m.x*g),d=b+~~(m.y*g),j=~~(a.width*g),k=~~(a.height*g);h.updateBounds(i,d,j,j);if(h.rotation||
h.opacity!==1){e.save();try{e.globalAlpha=h.opacity;e.translate(c,b);e.rotate(h.rotation);e.drawImage(a,m.x*g,m.y*g,j,k)}finally{e.restore()}}else e.drawImage(a,i,d,j,k)}}});if(!h.image)h.image=T5.Images.get(f.imageUrl,function(e){COG.Log.info("updating marker image to: "+e.src);h.image=e});if(!h.animatingImage)h.animatingImage=T5.Images.get(f.animatingImageUrl,function(e){h.animatingImage=e});return h};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(f){function m(b,g){for(var i=e.length;i--;)g.syncVectors([e[i].xy])}function h(){c.changed();c.trigger("markerUpdate",e)}f=T5.ex({zindex:100},f);var e=[],a=false,c=T5.ex(new T5.ViewLayer(f),{cycle:function(){return a},draw:function(b,g,i,d,j){a=false;for(i=e.length;i--;){e[i].draw(b,g,d,c,j);a=a||e[i].isAnimating()}return a?1:0},add:function(b){if(b&&typeof b.length!=="undefined")for(var g=b.length;g--;){if(b[g])e[e.length]=b[g]}else if(b)e[e.length]=b;h()},clear:function(b){if(b)for(var g=
0;g<e.length;g++)b(e[g])&&e.splice(g,1);else e=[];h()},find:function(b){var g=[];if(b)for(var i=e.length;i--;)if(b(e[i]))g[g.length]=e[i];return g}});c.bind("tap",function(b,g,i){for(var d=[],j=i.x,k=i.y,l=e.length;l--;)if(e[l].hitTest(j,k))d[d.length]=e[l];if(d.length>0)b.cancel=c.trigger("markerTap",g,i,d).cancel});c.bind("gridUpdate",m);c.bind("changed",function(){var b=c.getParent().getTileLayer();b&&m(null,b)});return c};
T5.Style=function(f){function m(c){var b=f[c];typeof b!=="undefined"&&h.push(function(g){g[c]=b})}f=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var h=[],e={applyToContext:function(c){for(var b=h.length;b--;)h[b](c)}};for(var a in f)m(a);return e};
(function(){var f={},m={basic:new T5.Style({lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),waypoints:new T5.Style({lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"})};T5.applyStyle=function(h,e){var a=T5.styles[e]?T5.styles[e]:T5.styles.basic,c;if(h&&h.canvas){c=f[h.canvas.id];f[h.canvas.id]=e}a.applyToContext(h);return c};T5.loadStyles=function(h){COG.jsonp(h,function(e){T5.resetStyles(e)})};T5.resetStyles=function(h){var e={};for(var a in h)e[a]=new T5.Style(h[a]);T5.styles=T5.ex({},
m,e)};T5.styles=m})();(function(){T5.tileSize=256;T5.Tile=function(f){return f=T5.ex({x:0,y:0,gridX:0,gridY:0,dirty:true},f)};T5.EmptyTile=function(f){f=new T5.Tile(f);f.empty=true;return f};T5.ImageTile=function(f){f=T5.ex({url:"",sessionParamRegex:null,loading:false,loaded:false},f);return new T5.Tile(f)}})();
T5.TileGrid=function(f){function m(w,G){var E=T5.Vector(w*i-p.x,G*i-p.y);return new T5.EmptyTile({gridX:E.x,gridY:E.y,empty:true})}function h(w,G,E,J){var I=Math.max(b,g)*0.2>>0,P=new T5.Vector;if(w<0||w+E>b)P.x=w<0?-I:I;if(G<0||G+J>g)P.y=G<0?-I:I;return P}function e(w,G,E){var J=COG.Log.getTraceTicks(),I=0;new T5.Vector(b/2,g/2);D=true;try{if(E)c=[];if(w)for(E=0;E<g;E++)for(var P=0;P<b;P++){if(!c[I]){var N=w(P,E,k,b,g);N.gridX=P*i-p.x;N.gridY=E*i-p.y;c[I]=N}I++}}finally{D=false}l=w;x=G;COG.Log.trace("tile grid populated",
J);Q.changed()}function a(w,G,E,J){var I,P=[],N=false;w=new T5.Vector((w.x+p.x)*o>>0,(w.y+p.y)*o>>0);tilesNeeded=false;if(!H){I=Q.getParent().getDimensions();v=Math.ceil(I.width*o)+1;C=Math.ceil(I.height*o)+1;H=new T5.Vector((v-1)/2>>0,(C-1)/2>>0)}for(var M=C;M--;)for(var K=v;K--;){I=K+w.x>=0&&K+w.x<b?c[(M+w.y)*b+(K+w.x)]:null;var R=new T5.Vector(K-H.x,M-H.y);if(!I){S=h(w.x,w.y,v,C);I=m(K+w.x,M+w.y)}N=I?(I.dirty=E||I.dirty)||N:N;P[P.length]={tile:I,centerness:T5.V.absSize(R)}}P.sort(function(T,V){return V.centerness-
T.centerness});r||(r=Array(P.length));for(E=P.length;E--;){r[E]=P[E].tile;Q.prepTile(r[E],G)}ga=J;return N}f=T5.ex({tileSize:T5.tileSize,center:new T5.Vector,clearBackground:false,gridSize:25,shiftOrigin:null,supportFastDraw:true,allowShift:true},f);var c=Array(Math.pow(f.gridSize,2)),b=f.gridSize,g=f.gridSize,i=f.tileSize,d=g*i,j=b*i,k=T5.V.offset(f.center,-Math.ceil(b>>1)),l=null,p=new T5.Vector,x=null,z=Math.round(i/2),n=false,o=i?1/i:0,s=true,r=null,U=false,D=false,ga=0;new T5.Vector;var S=new T5.Vector;
T5.getConfig();var v,C,H,ba=f.clearBackground;T5.viewState("ANIMATING");var ea=T5.viewState("PAN"),W=T5.viewState("PINCH"),Q=T5.ex(new T5.ViewLayer(f),{gridDimensions:new T5.Dimensions(j,d),cycle:function(w,G,E,J){if(S.x!==0||S.y!==0){J=S;var I=f.shiftOrigin;if(!(!f.allowShift||J.x===0&&J.y===0)){var P=COG.Log.getTraceTicks(),N=Array(c.length);N.length=c.length;for(var M=0;M<b;M++)for(var K=0;K<g;K++)N[K*b+M]=M+J.x>=0&&M+J.x<b?c[(K+J.y)*b+(M+J.x)]:null;c=N;k=I?I(k,J):T5.V.add(k,J);p.x+=-J.x*i;p.y+=
-J.y*i;COG.Log.trace("tile storage shifted",P);e(l,x)}S=new T5.Vector;J=true}if(!n&&(E&W)===0)n=a(G,E,J,w);return n},find:function(w){if(!w)return null;for(var G=c.length;G--;){var E=c[G];if(E&&w(E))return E}return null},prepTile:function(){},drawTile:function(){return false},getTileSize:function(){return i},draw:function(w,G,E,J,I,P,N){var M=G.x;G=G.y;var K=E.width,R=E.height,T,V=true;if(r){ba&&w.clearRect(0,0,E.width,E.height);w.beginPath();if(s)for(var ca=r.length;ca--;){T=r[ca];var X=T.gridX-
M,F=T.gridY-G;T.x=X;T.y=F;if(T.empty){if(!ba){w.clearRect(X,F,i,i);w.rect(X,F,i,i);V=false}}else if(P||T.dirty){(T=Q.drawTile(w,T,X,F,J,P,N,ba))&&w.rect(X,F,i,i);V=V&&T}K=X<K?X:K;R=F<R?F:R}if(!ba&&(J&ea)!==0){if(K>0){w.clearRect(0,0,K,E.height);w.rect(0,0,K,E.height)}if(R>0){w.clearRect(0,0,E.width,R);w.rect(0,0,E.width,R)}}ba||w.clip();V&&!U&&I.trigger("tileDrawComplete");n=false;U=V}},getTileAtXY:function(w,G){for(var E=null,J=r?r.length:0;J--;){var I=r[J];if(I&&w>=I.x&&G>=I.y)if(w<=I.x+i&&G<=I.y+
i){E=I;break}}COG.Log.info("looking for tile @ x: "+w+", y: "+G+", found: "+E);return E},getTileVirtualXY:function(w,G,E){w=T5.V.add(new T5.Vector(w,G),T5.V.invert(k),p);w=new T5.Vector(w.x*i,w.y*i);if(E){w.x+=z;w.y+=z}return w},populate:function(w){e(w,null,true)},syncVectors:function(){}});Q.bind("resize",function(){COG.Log.info("captured resize");H=null});Q.bind("scale",function(){s=false});COG.listen("imagecache.cleared",function(){for(var w=c.length;w--;)if(c[w])c[w].loaded=false});COG.listen("tiler.repaint",
function(){for(var w=c.length;w--;)if(c[w]){c[w].x=null;c[w].y=null}});return Q};
T5.ImageTileGrid=function(f){function m(l){function p(){var x=T5.Images.newCanvas(32,32),z=x.getContext("2d");z.fillStyle="#BBBBBB";z.fillRect(0,0,32,32);z.fillStyle="#C3C3C3";z.fillRect(0,0,16,16);z.fillRect(16,16,16,16);return x}if(!e||l!==e.width){e=T5.Images.newCanvas(l,l);l=e.getContext("2d");l.fillStyle=typeof FlashCanvas!=="undefined"?"#666666":l.createPattern(p(),"repeat");l.fillRect(0,0,e.width,e.height)}return e}f=T5.ex({emptyTile:function(l){if(!h||l!==h.width){h=T5.Images.newCanvas(l,
l);l=h.getContext("2d");l.fillStyle="rgba(150, 150, 150, 0.1)";l.fillRect(0,0,h.width,h.height)}return h}(T5.tileSize),panningTile:null,tileOffset:new T5.Vector,tileDrawArgs:{}},f);var h=f.emptyTile,e=f.panningTile?f.panningTile:m(T5.tileSize),a=T5.viewState("ACTIVE"),c=T5.viewState("PAN"),b=T5.getConfig().requireFastDraw,g=f.tileSize?f.tileSize:T5.tileSize,i=T5.Images.get,d=T5.Images.load,j=T5.ex({background:null,overlay:null,offset:new T5.Vector,realSize:new T5.Dimensions(g,g)},f.tileDrawArgs),
k=T5.ex(new T5.TileGrid(f),{drawTile:function(l,p,x,z,n,o,s,r){o=p.url?i(p.url):null;s=false;if(o){l.drawImage(o,x,z);p.dirty=false;s=true}else if((n&c)!==0){r||l.drawImage(e,x,z);s=true}return s},initTileUrl:function(){},prepTile:function(l,p){if(l&&!l.loading&&(!b||p===a)){l.url||k.initTileUrl(l);if(!i(l.url)){l.loading=true;d(l.url,function(){l.loadTime=(new Date).getTime();l.loaded=true;l.dirty=true;k.changed()},j)}}}});return k};
T5.Tiler=function(f){f=T5.ex({container:"",drawCenter:false,datasources:{},tileLoadThreshold:"first"},f);var m=T5.ex(new T5.View(f),{getTileLayer:function(){return m.getLayer("grid0")},setTileLayer:function(h){m.setLayer("grid0",h);m.trigger("gridUpdate",h);m.eachLayer(function(e){e.trigger("gridUpdate",h)})},viewPixToGridPix:function(h){var e=m.getOffset();return new T5.Vector(h.x+e.x,h.y+e.y)},centerOn:function(h,e,a,c){var b=m.getTileLayer(),g=m.getDimensions();(b=b?b.getTileSize():0)&&m.updateOffset(h.gridX-
(g.width-b)*0.5>>0,h.gridY-(g.height-b)*0.5>>0,e,a,c)},cleanup:function(){m.removeLayer("grid0")},repaint:function(){COG.say("tiler.repaint");m.trigger("wake")},select:function(h){m.trigger("selectTile",h)}});m.bind("tap",function(h,e,a){if(h=m.getTileLayer())(a=h.getTileAtXY(a.x,a.y))&&m.trigger("selectTile",a)});return m};
