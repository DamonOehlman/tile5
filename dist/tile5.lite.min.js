COG=function(){var i=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,k=0,e={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,f=arguments.length,d=false,j,b,g,h;if(typeof a==="boolean"){d=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!e.isFunction(a))a={};if(f===c){a=this;--c}for(;c<f;c++)if((j=arguments[c])!=null)for(b in j){g=a[b];h=j[b];if(a!==h)if(d&&h&&(e.isPlainObject(h)||e.isArray(h))){g=g&&(e.isPlainObject(g)||e.isArray(g))?g:e.isArray(h)?[]:{};a[b]=e.extend(d,g,h)}else if(h!==
undefined)a[b]=h}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||m.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var f=a,d=arguments,j=1;if(c&&e.isArray(c)){d=c;j=0}for(j=j;j<d;j++)f=f&&typeof foo[d[j]]!=="undefined";return f},newModule:function(a){a=e.extend({id:null,requires:[],parent:null},a);if(a.parent)a=e.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+k++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,f=0;f<=c;f++)a=a.replace(RegExp("\\{"+f+"\\}","gi"),arguments[f+
1]);return a},wordExists:function(a,c){var f="";if(c.toString)c=c.toString();for(var d=0;d<c.length;d++)f+=!/\w/.test(c[d])?"\\"+c[d]:c[d];return RegExp("(^|\\s|\\,)"+f+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var f=i.exec(a);f;){a=a.replace(f[0],COG.XPath.first(f[1],c));i.lastIndex=0;f=i.exec(a)}return a}};return e}();
COG.Log=function(){function i(c,f){var d,j=f&&f.length>0?f[0]:"";for(d=1;f&&d<f.length;d++)j+=" "+(k&&COG.isPlainObject(f[d])?JSON.stringify(f[d]):f[d]);typeof console!=="undefined"&&console[c](j);for(d=0;d<m.length;d++)m[d].call(a,j,c)}var m=[],k=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(c,f){if(e)console.markTimeline(c+(f?": "+(a.getTraceTicks()-f)+"ms":""))},debug:function(){i("debug",
arguments)},info:function(){i("info",arguments)},warn:function(){i("warn",arguments)},error:function(){i("error",arguments)},exception:function(c){a.error(arguments);for(var f in c)a.info("ERROR DETAIL: "+f+": "+c[f])},watch:function(c,f){try{f()}catch(d){a.exception(d,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return a}();
(function(){function i(e,a){e[a]||(e[a]=function(c){return e.configure(a,c)})}function m(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var k={};COG.paramTweaker=function(e,a,c){return function(f,d){if(typeof d!=="undefined"){if(f in e)e[f]=d;c&&f in c&&c[f](f,d)}else return a&&f in a?a[f](f):e[f]}};COG.configurable=function(e,a,c,f){if(e){e.gtConfId||m(e);var d=e.gtConfId,j=e.gtConfig,b=e.gtConfigFns;k[d]=e;b.push(c);for(c=a.length;c--;){j[a[c]]=true;f&&
i(e,a[c])}if(!e.configure)e.configure=function(g,h){if(j[g]){for(var l=b.length;l--;){var p=b[l](g,h);if(typeof p!=="undefined")return p}return k[d]}return null}}}})();
(function(){function i(m,k){var e=m.gtObsHandlers;e[k]||(e[k]=[]);return e[k]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(k,e){var a=COG.objId("callback");i(m,k).unshift({fn:e,id:a});return a};m.trigger=function(k){var e=i(m,k),a={cancel:false,tickCount:(new Date).getTime()},c;if(!e)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var f=e.length;f--&&!a.cancel;)e[f].fn.apply(self,c);return a};m.unbind=
function(k,e){for(var a=i(m,k),c=0;a&&c<a.length;c++)if(a[c].id===e){a.splice(c,1);break}return m}}}}})();(function(){var i={},m=[];COG.addPipe=function(k){k("pipe.test",{});m.push(k)};COG.listen=function(k,e){i[k]||(i[k]=[]);e&&i[k].push(e)};COG.say=function(k,e){var a;for(a=m.length;a--;)m[a](k,e);if(i[k])for(a=i[k].length;a--;)i[k][a](e)}})();
COG.Loopage=function(){function i(h){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},h)}function m(h){d.push(h);k()}function k(){j&&clearTimeout(j);j=setTimeout(e,0);g=true}function e(){for(var h,l=(new Date).getTime(),p=f.length;d.length>0;){var r=d.shift();for(h=p;h--;)if(f[h].id===r){f.splice(h,1);break}g=true;p=f.length}if(g){b=a;for(h=p;h--;)b=f[h].frequency<b?f[h].frequency:b}for(h=p;h--;){r=l-f[h].lastTick;if(f[h].lastTick===0||r>=f[h].frequency){f[h].execute(l,
f[h]);f[h].lastTick=l;f[h].single&&f[h].trigger("complete")}}j=p?setTimeout(e,b):0}var a=6E4,c=0,f=[],d=[],j=0,b=a,g=true;return{join:function(h){var l=new i(h);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});f.unshift(l);k();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function i(b){return b<10?"0"+b:b}function m(b){a.lastIndex=0;return a.test(b)?'"'+b.replace(a,function(g){var h=d[g];return typeof h==="string"?h:"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function k(b,g){var h,l,p,r,w=c,o,n=g[b];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(b);if(typeof j==="function")n=j.call(g,b,n);switch(typeof n){case "string":return m(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";c+=f;o=[];if(Object.prototype.toString.apply(n)==="[object Array]"){r=n.length;for(h=0;h<r;h+=1)o[h]=k(h,n)||"null";p=o.length===0?"[]":c?"[\n"+c+o.join(",\n"+c)+"\n"+w+"]":"["+o.join(",")+"]";c=w;return p}if(j&&typeof j==="object"){r=j.length;for(h=0;h<r;h+=1){l=j[h];if(typeof l==="string")if(p=k(l,n))o.push(m(l)+(c?": ":":")+p)}}else for(l in n)if(Object.hasOwnProperty.call(n,l))if(p=k(l,n))o.push(m(l)+(c?": ":":")+p);p=o.length===0?"{}":c?"{\n"+c+o.join(",\n"+c)+
"\n"+w+"}":"{"+o.join(",")+"}";c=w;return p}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,f,d={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof JSON.stringify!=="function")JSON.stringify=function(b,g,h){var l;f=c="";if(typeof h==="number")for(l=0;l<h;l+=1)f+=" ";else if(typeof h==="string")f=h;if((j=g)&&typeof g!=="function"&&(typeof g!=="object"||typeof g.length!=="number"))throw Error("JSON.stringify");return k("",
{"":b})};if(typeof JSON.parse!=="function")JSON.parse=function(b,g){function h(p,r){var w,o,n=p[r];if(n&&typeof n==="object")for(w in n)if(Object.hasOwnProperty.call(n,w)){o=h(n,w);if(o!==undefined)n[w]=o;else delete n[w]}return g.call(p,r,n)}var l;b=String(b);e.lastIndex=0;if(e.test(b))b=b.replace(e,function(p){return"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+b+")");return typeof g==="function"?h({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function i(k,e){var a=k.split("|"),c={};for(var f in e){var d=e[f];c[f]=a.length>d?a[d]:null}return c}var m={JSON:{parse:function(k){return JSON.parse(k)}},PDON:{parse:function(k){var e=null,a=[];k=k.split("\n");for(var c=0;c<k.length;c++){var f=k[c];if(e)a.push(i(f,e));else if(f){e=f.split("|");f={};for(var d=0;d<e.length;d++)f[e[d]]=d;e=f}else e=null}return a}}};COG.parseData=function(k,e){e=e?e.toUpperCase():"JSON";if(!m[e])throw Error("Unsupported data format: "+e);try{return m[e].parse(k)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function i(a){for(var c=null,f=0;f<m.length;f++)if(c=m[f](a))break;return c}var m=[],k=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var f=null;if(a.resultType>=0&&a.resultType<k.length)f=k[a.resultType];if(f)c=f(a)}return c?c:""}}},first:function(a,c){var f=e.SearchResult,d;var j=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!j)j=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))d=c.evaluate(a,c,i,j,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");d=null}}catch(b){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);d=null}return new f(d)},registerResolver:function(a){m.push(a)}};return e}();
COG.Storage=function(){function i(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,k){var e=i(k).getItem(m);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(m,k,e){k=jQuery.isArray(k)||jQuery.isPlainObject(k)?JSON.stringify(k):k;i(e).setItem(m,k)},remove:function(m,k){i(k).removeItem(m)}}}();
COG.ParseRules=function(){var i=[];return{add:function(m,k){i.push({regex:m,handler:k})},each:function(m,k,e){function a(){c++;e&&c>=i.length&&e(k)}for(var c=0,f=0;f<i.length;f++){var d=i[f].regex,j=i[f].handler,b=false;if(d){d.lastIndex=-1;if((d=d.exec(m))&&j){b=true;j(d,k,a)&&a()}}b||a()}}}};
(function(){function i(d){var j=[],b=function(h,l){l=COG.isFunction(l)?l():l;j[j.length]=encodeURIComponent(h)+"="+encodeURIComponent(l)};if(COG.isArray(d))for(var g=0;g<d.length;g++)b(d[g].name,d[g].value);else for(g in d)b(g,d[g]);return j.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},k={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(d){return d.responseXML},JSON:function(d){return COG.parseData(d.responseText)},
PDON:function(d){return COG.parseData(d.responseText,"PDON")},DEFAULT:function(d){return d.responseText}},f={CONTENT_TYPE:"Content-Type"};COG.xhr=function(d){function j(){if(this.readyState===4){var l=null,p=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(p)if(d.handleResponse)d.handleResponse(this);else{var r=d,w=this.getResponseHeader(f.CONTENT_TYPE),o,n=false;for(o in m)if(w&&w.indexOf(m[o])>=0){n=true;
break}w=!n;for(n=0;n<e.length;n++)w=w||e[n]==o;if(w)b:{w=o;for(var x in k)for(n=0;n<k[x].length;n++)if(RegExp(k[x][n]+"$","i").test(r.url)){o=x;break b}o=w?w:"DEFAULT"}try{l=c[o](this,r)}catch(t){l=c.DEFAULT(this,r)}}else d.error&&d.error(this)}catch(I){COG.Log.exception(I,"PROCESSING AJAX RESPONSE")}p&&l&&d.success&&d.success.call(this,l)}}try{d=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},d);var b=
a.exec(d.url),g=b&&(b[1]&&b[1]!==location.protocol||b[2]!==location.host);if(d.data)d.method="POST";if(d.url){b=null;if(d.xhr)b=d.xhr(d);b||(b=new XMLHttpRequest);b.open(d.method,d.url,d.async);d.data&&b.setRequestHeader("Content-Type",d.contentType);g||b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.onreadystatechange=j;b.send(d.method=="POST"?i(d.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(h){COG.Log.exception(h)}}})();
(function(){function i(a){var c=document.createElement("script"),f=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!f&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};k||(k=document.getElementsByTagName("head")[0]);k.appendChild(c)}var m=0,k,e=this;COG.jsonp=function(a,c,f){a+=a.indexOf("?")>=0?"&":"?";var d="json"+ ++m;e[d]=function(j){c(j);e[d]=null;try{delete e[d]}catch(b){}};
i(a+(f?f:"callback")+"="+d);return d}})();
COG.Touch=function(){function i(u,C){return{x:u.x-C.x,y:u.y-C.y}}function m(u,C){var D=i(u,C);return Math.sqrt(D.x*D.x+D.y*D.y)}function k(u){if(u.count>1)return m(u.touches[0],u.touches[1]);return 0}function e(u,C){var D=u&&u.count>0?u.touches[0]:null;if(D&&C&&C.count>0)return i(D,C.touches[0]);return null}function a(u,C){u.count=C.count;for(var D=b;D--;){u.touches[D].x=C.touches[D].x;u.touches[D].y=C.touches[D].y}}function c(){for(var u={count:0,touches:Array(b)},C=b;C--;)u.touches[C]=j();return u}
function f(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}function d(u,C,D){if(A){C=C[D?D:"touches"];D=C.length;for(D=u.count=D;D--;){u.touches[D].x=C[D].pageX;u.touches[D].y=C[D].pageY}}else if(C.button===0){u.count=1;u.touches[0].x=C.pageX?C.pageX:C.screenX;u.touches[0].y=C.pageY?C.pageY:C.screenY}else u.count=0}function j(u,C){return{x:u?u:0,y:C?C:0}}var b=10,g=120,h=100,l=250,p=300,r=5,w=0,o=1,n=2,x=7,t=0,I=0,A=undefined,J=function(u){function C(v,
z,y,q){var s=Math.asin((v.y-z.y)/y);y=y*(ha/q)>>0;y=y>ca?ca:y;s=z.x>v.x?s:Math.PI-s;T("pan",Math.cos(s)*-y,Math.sin(s)*y,true)}function D(v,z){var y,q;if(A){y=z-da;if(y<l){q=m(H.touches[0],v);q>u.inertiaTrigger&&C(H.touches[0],v,q,y)}}else{W.x=v.x;W.y=v.y;COG.Loopage.join({execute:function(s,B){y=s-z;q=m(v,W);if(y<h&&q>u.inertiaTrigger){B.trigger("complete");C(v,W,q,y)}else y>h&&B.trigger("complete")},frequency:10})}}function ea(v){var z=0,y=0;if(v.offsetParent){do{z+=v.offsetLeft;y+=v.offsetTop;
v=v.offsetParent}while(v)}return j(z,y)}function ia(v){var z=v.count,y=Array(z),q=ea(Q);for(z=z;z--;)y[z]=j(v.touches[z].x-q.x,v.touches[z].y-q.y);return y}function T(){qa&&qa.trigger.apply(null,arguments)}function U(v,z){var y=ea(Q);y=j(z.x-y.x,z.y-y.y);T(v,z,y)}function ja(v){var z=v.target?v.target:v.srcElement;if(P||z&&z===Q){d(H,v);if(H.count!==0){Y=null;ba.x=0;ba.y=0;ka=true;Z=false;da=(new Date).getTime();f(v);z.style.cursor="move";T("inertiaCancel");fa=da;if(v=H.count>0?H.touches[0]:null){T("touchStart",
v.x,v.y);if(fa-ga<p)if((v=i(H.touches[0],X.touches[0]))&&Math.abs(v.x)<u.maxDistDoubleTap&&Math.abs(v.y)<u.maxDistDoubleTap)Z=true;V=w;a(X,H)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function $(v){var z=v.target?v.target:v.srcElement,y=0;if(P||z&&z===Q){d(R,v);if(R.count>0){W.x=R.touches[0].x;W.y=R.touches[0].y}if(ka){A&&f(v);if(R.count>1){H.count===1&&a(H,R);y=k(H)-k(R)}if(V===w)if((v=e(R,H))&&(Math.abs(v.x)>=x||Math.abs(v.y)>=x))V=o;if(V!==w)if(!y||Math.abs(y)<r){if(Y=
e(R,X)){ba.x-=Y.x;ba.y-=Y.y;G.x-=Y.x;G.y-=Y.y}T("pan",G.x,G.y);G.x=0;G.y=0;V=o}else{T("pinchZoom",ia(H),ia(R));V=n}a(X,R)}}}function la(v){var z=v.target?v.target:v.srcElement;if(ka&&(P||z&&z===Q)){d(ma,v,"changedTouches");var y=ma.touches[0];A&&f(v);v=(new Date).getTime();ga=fa;if(V===w){U("tap",H.touches[0]);na||(na=setTimeout(function(){na=0;Z&&U("doubleTap",H.touches[0])},p+50))}else if(V==o){T("panEnd",ba.x,ba.y);oa&&D(y,v)}else V==n&&T("pinchZoomEnd",ia(H),ia(X),v-da);z.style.cursor="default";
ka=false}}function S(v){var z=v.target?v.target:v.srcElement;if(P||z&&z===Q){if(v.detail){z=-v.detail*g;z=j(v.axis===1?z:0,v.axis===2?z:0)}else z=j(v.wheelDeltaX,v.wheelDeltaY);var y=z.y!==0?Math.abs(z.y/g):0;if(W&&y!==0){var q=j(W.x-Q.offsetLeft,W.y-Q.offsetTop);T("wheelZoom",q,Math.pow(2,z.y>0?y:-y))}f(v)}}u=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,
doubleTapHandler:null,wheelZoomHandler:null},u);var Z=false,na=0,M=T5.getConfig(),H=c(),R=c(),X=c(),ma=c(),Y=null,ba=j(),G=j(),V=null,ka=false,da=0,pa=[],W=j(),oa=false,ha,ca,fa=0,ga=0,Q=u.element,qa=u.observable,P=typeof FlashCanvas!=="undefined",ra={supportsTouch:A,addListeners:function(v){pa.push(v)},decoupleListeners:function(v){for(var z=0;v&&z<pa.length;z++)if(pa[z].listenerId===v){pa.splice(z,1);break}},release:function(){M.unbindEvent(A?"touchstart":"mousedown",ja,false);M.unbindEvent(A?"touchmove":
"mousemove",$,false);M.unbindEvent(A?"touchend":"mouseup",la,false);if(!A){window.removeEventListener("mousewheel",S,false);window.removeEventListener("DOMMouseScroll",S,false)}},inertiaEnable:function(v,z){oa=true;ha=v;ca=z?Math.min(z.width,z.height):500},inertiaDisable:function(){oa=false}};if(typeof A==="undefined")A=T5.getConfig().supportsTouch;M.bindEvent(A?"touchstart":"mousedown",ja,false);M.bindEvent(A?"touchmove":"mousemove",$,false);M.bindEvent(A?"touchend":"mouseup",la,false);if(!A){M.bindEvent("mousewheel",
S,window);M.bindEvent("DOMMouseScroll",S,window)}return ra},K=[];return{capture:function(u,C){if(!u)throw Error("Unable to capture touch of null element");if(!u.id)u.id="touchable_"+t++;var D=K[u.id];if(!D){D=new J(COG.extend({element:u},C));K[u.id]=D}if(C){C.listenerId&&D.decoupleListeners(C.listenerId);C.listenerId=++I;D.addListeners(C)}return D},release:function(u){if(u&&u.id&&K[u.id]){K[u.id].release();delete K[u.id]}}}}();
T5=function(){var i=function(){function c(j,b){return d(j.x-b.x,j.y-b.y)}function f(j,b){if(!b)b=j.length;if(b<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var g={edges:Array(b-1),accrued:Array(b-1),total:0},h=0;h<b-1;h++){var l=c(j[h],j[h+1]);g.edges[h]=Math.sqrt(l.x*l.x+l.y*l.y);g.accrued[h]=g.total+g.edges[h];g.total+=g.edges[h]}return g}function d(j,b){return{x:j?j:0,y:b?b:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var j=
0,b=0,g=arguments.length;g--;){j+=arguments[g].x;b+=arguments[g].y}return d(j,b)},absSize:function(j){return Math.max(Math.abs(j.x),Math.abs(j.y))},copy:function(j){return j?d(j.x,j.y):null},diff:c,distance:function(j,b){return f(j,b).total},edges:f,equals:function(j,b){return j.x===b.x&&j.y===b.y},extendBy:function(j,b,g){return d(j.x-Math.cos(b)*g,j.y-Math.sin(b)*g)},floor:function(j){for(var b=Array(j.length),g=j.length;g--;)b[g]=d(~~j[g].x,~~j[g].y);return b},getRect:function(j){for(var b,g,h,
l,p=j.length;p--;){var r=j[p];b=typeof b==="undefined"||r.x<b?r.x:b;g=typeof g==="undefined"||r.y<g?r.y:g;h=typeof h==="undefined"||r.x>h?r.x:h;l=typeof l==="undefined"||r.y>l?r.y:l}return k.init(b,g,h,l)},init:d,invert:function(j){return d(-j.x,-j.y)},min:function(j,b){return d(j.x<b.x?j.x:b.x,j.y<b.y?j.y:b.y)},max:function(j,b){return d(j.x>b.x?j.x:b.x,j.y>b.y?j.y:b.y)},offset:function(j,b,g){return d(j.x+b,j.y+(g?g:b))},simplify:function(j,b){if(!j)return null;b=b?b:i.VECTOR_SIMPLIFICATION;for(var g=
[],h=null,l=j.length;l--;){var p=j[l];if(include=!h||l===0||Math.abs(p.x-h.x)+Math.abs(p.y-h.y)>b){g.unshift(p);h=p}}return g},theta:function(j,b,g){g=Math.asin((j.y-b.y)/g);return j.x>b.x?g:Math.PI-g}}}(),m=function(){return{dotProduct:function(c,f){return c.x*f.x+c.y*f.y}}}(),k=function(){function c(d){return f(d.x1,d.y1,d.x2,d.y2)}function f(d,j,b,g){d=d?d:0;j=j?j:0;b=typeof b!=="undefined"?b:d;g=typeof g!=="undefined "?g:g;return{x1:d,y1:j,x2:b,y2:g,width:b-d,height:g-j}}return{center:function(d){return i.init(d.x1+
d.width/2,d.y1+d.height/2)},copy:c,diagonalSize:function(d){return Math.sqrt(d.width*d.width+d.height*d.height)},fromCenter:function(d,j,b,g){b=~~(b/2);g=~~(g/2);return f(d-b,j-g,d+b,j+g)},init:f,intersect:function(d,j){var b=f(Math.max(d.x1,j.x1),Math.max(d.y1,j.y1),Math.min(d.x2,j.x2),Math.min(d.y2,j.y2));return b.width>0&&b.height>0?b:null},union:function(d,j){if(d.width===0||d.height===0)return c(j);else if(j.width===0||j.height===0)return c(d);else{var b=f(Math.min(d.x1,j.x1),Math.min(d.y1,j.y1),
Math.max(d.x2,j.x2),Math.max(d.y2,j.y2));return b.width>0&&b.height>0?b:null}}}}(),e=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return i.init(c.width/2,c.height/2)},getSize:function(c){return Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2))},init:function(c,f){c=c?c:0;return{width:c,height:f?f:c}}}}(),a={ex:COG.extend,ticks:function(){return(new Date).getTime()},userMessage:function(c,f,d){a.trigger("userMessage",c,f,d)},XY:i,XYRect:k,
Vector:function(c,f){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return i.init(c,f)},V:COG.extend(i,m),D:e};COG.observable(a);return a}();
(function(){function i(){for(;r.length>0;){var o=r.shift();document.location=o}p=0}function m(o){for(var n=true,x=w.length;x--;)n=n&&o!=w[x];return n}function k(o,n){var x=[];for(var t in n)t&&x.push(t+"="+escape(n[t]));return"tile5://"+o+"/"+(x.length>0?"?"+x.join("&"):"")}function e(o,n){m(o)&&COG.Log.info("would push url: "+k(o,n))}function a(o,n){if(m(o)){r.push(k(o,n));p||(p=setTimeout(i,100))}}function c(o){return function(n,x,t){(t?t:o?document.body:document).addEventListener(n,x,false)}}function f(o){return function(n,
x,t){(t?t:o?document.body:document).removeEventListener(n,x,false)}}function d(o,n,x){(x?x:document).attachEvent("on"+o,n)}function j(o,n,x){(x?x:document).detachEvent("on"+o,n)}function b(){g={base:{name:"Unknown",bindEvent:c(),unbindEvent:f(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:d,unbindEvent:j,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:f(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};h=[g.froyo,g.android,g.ipod,g.iphone,g.ipad,g.ie]}var g=null,h=[],l=null,p=0,r=[],w=["view.wake","tile.loaded"];T5.getConfig=function(){g||b();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var o=0;o<h.length;o++){var n=h[o];if(n.regex&&n.regex.test(navigator.userAgent)){l=T5.ex({},g.base,n);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=g.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var i=[],m={execute:function(k){var e=m.findAction(k);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(k){for(var e=i.length;e--;)if(i[e].id==k)return i[e];return null},getRegisteredActions:function(){return[].concat(i)},getRegisteredActionIds:function(){for(var k=[],e=i.length;e--;)i[e].id&&k.push(i[e].id);return k},registerAction:function(k){k&&k.id&&i.push(k)},Action:function(k){k=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},k);var e={id:k.id,execute:function(){k.execute&&k.execute.apply(this,arguments)},getParam:function(a){return k[a]?k[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,k.title,k.icon)}};k.autoRegister&&m.registerAction(e);return e},Agent:function(k){k=COG.extend({name:"Untitled",translator:null,execute:null},k);var e={getName:function(){return k.name},getParam:function(a){return k[a]},getId:function(){return COG.toID(e.getName())},run:function(a,c){if(k.execute){var f=
k.translator?k.translator(a):a;k.execute.call(e,f,function(d,j){c&&c(d,j,f)})}}};return e},runAgents:function(k,e,a){for(var c=0;c<k.length;c++)k[c].run(e,a)}};return m}();
T5.Resources=function(){var i="",m={},k={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:i+e},setBasePath:function(e){i=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var a=function(c){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(c)})};e.cacheable&&m[e.filename]?a(m[e.filename]):COG.xhr({url:k.getPath(e.filename),dataType:e.dataType,success:function(c){if(e.cacheable)m[e.filename]=c;a(c)},error:function(c,f,d){COG.Log.error("error loading resource ["+
e.filename+"], error = "+d)}})},loadSnippet:function(e,a){/\.\w+$/.test(e)||(e+=".html");k.loadResource({filename:"snippets/"+e,callback:a,dataType:"html"})}};return k}();
T5.Images=function(){function i(){if(!p){var o=T5.getConfig().maxImageLoads;p=COG.Loopage.join({execute:function(n,x){if(!o||g.length<o){var t=b.shift();if(t){g[g.length]=t;t.image.onload=k;t.image.src=T5.Resources.getPath(t.url);t.requested=T5.ticks()}else x.trigger("complete")}},frequency:10});p.bind("complete",function(){p=null})}}function m(){r=true;try{var o=h.length/2>>0;if(o>0){h.sort(function(x,t){return x.created-t.created});for(var n=o;n--;)delete c[h[n].url];h.splice(0,o)}}finally{r=false}COG.say("imagecache.cleared")}
function k(){var o=d[this.id],n;if(o&&o.image.complete&&o.image.width>0){o.loaded=true;o.hitCount=1;for(n=g.length;n--;)if(g[n].image.src==this.src){g.splice(n,1);break}if(o.background||o.postProcess||o.drawBackground||o.customDraw)if(o.image){globalImageData=o;n=a(o.realSize?o.realSize.width:o.image.width,o.realSize?o.realSize.height:o.image.height);var x=n.getContext("2d"),t=o.offset?o.offset:T5.XY.init();o.background&&x.drawImage(o.background,0,0);o.drawBackground&&o.drawBackground(x);o.customDraw?
o.customDraw(x,o):x.drawImage(o.image,t.x,t.y);o.postProcess&&o.postProcess(x,o);o.image=n}for(n=o.callbacks.length;n--;)o.callbacks[n]&&o.callbacks[n](this,false);o.callbacks=[];h[h.length]={url:this.src,created:o.requested};delete d[this.id];i()}}function e(o,n,x){var t=c[o];if(t){t.hitCount++;t.image.complete&&t.image.width>0&&n?n(t.image,true):t.callbacks.push(n)}else{t=T5.ex({url:o,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[n]},x);t.image.id="resourceLoaderImage"+
j++;c[o]=t;d[t.image.id]=t;b[b.length]=t;i()}return t}function a(o,n){var x=document.createElement("canvas");x.width=o?o:0;x.height=n?n:0;if(typeof FlashCanvas!=="undefined"){x.id="tmpCanvas"+f++;x.style.cssText="position: absolute; top: -"+(n-1)+"px; left: -"+(o-1)+"px;";document.body.appendChild(x);FlashCanvas.initElement(x)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(x);return x}var c={},f=0,d={},j=0,b=[],g=[],h=[],l=0,p=null,r=false,w={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){g=[]},get:function(o,n,x){var t=null,I=null;r||(t=c[o]);if((I=t?t.image:null)&&(I.getContext||I.complete&&I.width>0))return I;else n&&e(o,n,x);return null},load:e,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:g.length,queuedImageCount:b.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(o){for(var n=false,x=0,t=T5.getConfig();x<g.length;)if(o-g[x].requested>w.loadTimeout*1E3){g.splice(x,1);n=true}else x++;n&&i();if(t&&t.imageCacheMaxSize){l=
h.length*w.avgImageSize/t.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return w}();T5.Generator=function(){var i={};return{init:function(m,k){var e=i[m];if(!e)throw Error("Unable to locate requested generator: "+m);return new e(k)},register:function(m,k){i[m]=k},Template:function(){}}}();
T5.TimeLord=function(){var i=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,k=function(a,c){return{days:a?a:0,seconds:c?c:0}},e={8601:function(a){a=a.split("T");var c=null;c=null;var f=0,d=0;i.lastIndex=-1;c=i.exec(a[0]);f+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(a[1]);d+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;d+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;d+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new k(f,d)}};return{Duration:k,addDuration:function(){for(var a=new k,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var f=c?e[c]:null;if(f)return f(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new k},formatDuration:function(a){var c,f,d="";if(a.days)d=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){f=Math.round(a/60);a-=f*60}if(c)d=d+c+(c>1?" hrs ":" hr ")+
(f?(f>10?f:"0"+f)+" min ":"");else if(f)d=d+f+" min";else if(a>0)d=d+(a>10?a:"0"+a)+" sec"}return d}}}();
T5.zoomable=function(i,m){function k(a,c){if(a&&e!==a){e=a;i.triggerAll("zoomLevelChange",e,c)}}m=T5.ex({initial:1,min:0,max:null,zoomAnimation:T5.easing("quad.out")},m);var e=m.initial;T5.ex(i,{getZoomLevel:function(){return e},setZoomLevel:k,zoomIn:function(){i.scale(2,T5.easing("sine.out"))||i.setZoomLevel(e+1)},zoomOut:function(){i.scale(0.5,T5.easing("sine.out"))||i.setZoomLevel(e-1)}});i.bind("scale",function(a,c,f){i.updateOffset(f.x*c,f.y*c);a=0;c=Math.sqrt(c);if(c<1)a=-(0.5/c);else if(c>
1)a=c;T5.cancelAnimation(function(d){return d.cancelOnInteract});k(e+a>>0,f)});i.bind("doubleTap",function(a,c,f){if(i.scalable()){T5.cancelAnimation(function(d){return d.cancelOnInteract});i.animate(2,T5.D.getCenter(i.getDimensions()),T5.XY.init(f.x,f.y),m.zoomAnimation)}})};
(function(){var i=Math.PI*2,m=Math.PI/2,k=Math.abs,e=Math.pow,a=Math.sin,c=Math.asin,f=Math.cos,d=1.70158,j={linear:function(b,g,h,l){return h*b/l+g},backin:function(b,g,h,l){return h*(b/=l)*b*((d+1)*b-d)+g},backout:function(b,g,h,l){return h*((b=b/l-1)*b*((d+1)*b+d)+1)+g},backinout:function(b,g,h,l){return(b/=l/2)<1?h/2*b*b*(((d*=1.525)+1)*b-d)+g:h/2*((b-=2)*b*(((d*=1.525)+1)*b+d)+2)+g},bouncein:function(b,g,h,l){return h-j.bounceout(l-b,0,h,l)+g},bounceout:function(b,g,h,l){return(b/=l)<1/2.75?
h*7.5625*b*b+g:b<2/2.75?h*(7.5625*(b-=1.5/2.75)*b+0.75)+g:b<2.5/2.75?h*(7.5625*(b-=2.25/2.75)*b+0.9375)+g:h*(7.5625*(b-=2.625/2.75)*b+0.984375)+g},bounceinout:function(b,g,h,l){return b<l/2?j.bouncein(b*2,0,h,l)/2+g:j.bounceout(b*2-l,0,h,l)/2+h/2+g},cubicin:function(b,g,h,l){return h*(b/=l)*b*b+g},cubicout:function(b,g,h,l){return h*((b=b/l-1)*b*b+1)+g},cubicinout:function(b,g,h,l){if((b/=l/2)<1)return h/2*b*b*b+g;return h/2*((b-=2)*b*b+2)+g},elasticin:function(b,g,h,l,p,r){if(b==0)return g;if((b/=
l)==1)return g+h;r||(r=l*0.3);if(!p||p<k(h)){p=h;h=r/4}else h=r/i*c(h/p);return-(p*e(2,10*(b-=1))*a((b*l-h)*i/r))+g},elasticout:function(b,g,h,l,p,r){var w;if(b==0)return g;if((b/=l)==1)return g+h;r||(r=l*0.3);if(!p||p<k(h)){p=h;w=r/4}else w=r/i*c(h/p);return p*e(2,-10*b)*a((b*l-w)*i/r)+h+g},elasticinout:function(b,g,h,l,p,r){var w;if(b==0)return g;if((b/=l/2)==2)return g+h;r||(r=l*0.3*1.5);if(!p||p<k(h)){p=h;w=r/4}else w=r/i*c(h/p);if(b<1)return-0.5*p*e(2,10*(b-=1))*a((b*l-w)*i/r)+g;return p*e(2,
-10*(b-=1))*a((b*l-w)*i/r)*0.5+h+g},quadin:function(b,g,h,l){return h*(b/=l)*b+g},quadout:function(b,g,h,l){return-h*(b/=l)*(b-2)+g},quadinout:function(b,g,h,l){if((b/=l/2)<1)return h/2*b*b+g;return-h/2*(--b*(b-2)-1)+g},sinein:function(b,g,h,l){return-h*f(b/l*m)+h+g},sineout:function(b,g,h,l){return h*a(b/l*m)+g},sineinout:function(b,g,h,l){return-h/2*(f(Math.PI*b/l)-1)+g}};T5.easing=function(b){return j[b.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(b,g){j[b.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=g}})();
T5.Tween=function(i){i=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},i);var m=T5.ticks(),k=[],e=false,a=0,c=0,f={cancelOnInteract:i.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(d){i.complete&&i.complete(d)},update:function(d){try{var j=i.tweenFn(d-m,a,c,i.duration);if(i.target)i.target[i.property]=j;for(var b=k.length;b--;)k[b](j,void 0);if(e=m+i.duration<=d){if(i.target)i.target[i.property]=
i.tweenFn(i.duration,a,c,i.duration);for(var g=k.length;g--;)k[g](j,true)}}catch(h){COG.Log.exception(h)}},requestUpdates:function(d){k.push(d)}};a=i.target&&i.property&&i.target[i.property]?i.target[i.property]:i.startValue;if(typeof i.endValue!=="undefined")c=i.endValue-a;if(c==0)e=true;T5.wakeTweens();return f};
(function(){function i(a){if(e)return m.length;e=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(a);c++}}finally{e=false}m.length===0&&k.trigger("complete");return m.length}var m=[],k=null,e=false;T5.tweenValue=function(a,c,f,d,j){a=new T5.Tween({startValue:a,endValue:c,tweenFn:f,complete:d,duration:j});m.push(a);return a};T5.tween=function(a,c,f,d,j,b){a=new T5.Tween({target:a,property:c,endValue:f,tweenFn:d,duration:b,complete:j});
m.push(a);return a};T5.tweenVector=function(a,c,f,d,j,b){var g=[];if(a){var h=a.x==c,l=a.y==f;h||g.push(T5.tween(a,"x",c,d,function(){(h=true)&&l&&j()},b));l||g.push(T5.tween(a,"y",f,d,function(){l=true;h&&l&&j()},b))}return g};T5.cancelAnimation=function(a){if(!e){e=true;try{for(var c=0;c<m.length;)if(!a||a(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{e=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!k){k=COG.Loopage.join({execute:i,frequency:20});
k.bind("complete",function(){k=null})}}})();(function(){var i={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,k=arguments.length;k--;){var e=i[arguments[k].toUpperCase()];if(e)m|=e}return m}})();
T5.ViewLayer=function(i){i=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},i);var m=null,k=false,e=false,a=i.supportFastDraw,c=i.id,f=T5.viewState("ACTIVE"),d=i.validStates,j=0,b=0,g=T5.ex({addToView:function(h){h.setLayer(c,g)},shouldDraw:function(h,l,p){return(e||p||j!==l.x1||b!==l.y1)&&(h&d)!==0&&(k?a:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){g.trigger("remove",
g)},changed:function(h){e=true;g.trigger("changed",g);m&&m.trigger("invalidate",h)},getId:function(){return c},setId:function(h){c=h},getParent:function(){return m},setParent:function(h){k=(m=h)?m.fastDraw&&displayState!==f:false;g.trigger("parentChange",m)}},i);COG.observable(g);g.bind("drawComplete",function(h,l){e=false;j=l.x1;b=l.y1});g.bind("resync",function(h,l){if(l.syncXY){g.minXY&&l.syncXY(g.minXY);g.maxXY&&l.syncXY(g.maxXY)}});return g};
T5.View=function(i){function m(q,s,B,E){P=ga;n();if(E&&i.inertia){S=true;b(K+s,u+B,i.panAnimationEasing,i.panAnimationDuration)}else E||b(K+s,u+B)}function k(){P=fa;S=false;COG.Loopage.join({execute:n,after:50,single:true})}function e(q,s){var B=ra(q);z(B);var E=v(B),F=ra(s),L=z(F);F=v(F);$=T5.XY.offset(L,K,u);G=B&&E!==0?F/E:1}function a(q,s,B){e(s,B);if(X=G!==1){P=Q;n()}}function c(q,s,B){e(s,B);if(i.adjustScaleFactor){G=i.adjustScaleFactor(G);COG.Log.info("scale factor adjusted to: "+G)}d();G=1}
function f(q,s,B){y.zoom(s,Math.min(Math.pow(2,Math.round(Math.log(B))),8),500)}function d(){var q=T5.XY.init(ha-(D.width/(G*2)>>0),ca-(D.height/(G*2)>>0));G=Math.round(G*10)/10;X=false;for(var s=t.length;s--;)t[s].trigger("scale",G,q);y.trigger("scale",G,q);P=fa;n()}function j(){clearTimeout(ba);ba=setTimeout(g,50)}function b(q,s,B,E,F){function L(){N+=1;if(N>=2){k(0,0);F&&F()}}var N=0;if(M){q=q<M.x?M.x:q;s=s<M.y?M.y:s}if(H){q=q>H.x?H.x:q;s=s>H.y?H.y:s}if(B){q=T5.tweenValue(K,q,B,L,E);s=T5.tweenValue(u,
s,B,L,E);q.cancelOnInteract=true;q.requestUpdates(function(O){K=O;S=true;n()});s.cancelOnInteract=true;s.requestUpdates(function(O){u=O;S=true;n()})}else{K=q;u=s}}function g(){var q;if(A){COG.Touch.release(A);if(i.autoSize&&A.parentNode){q=A.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){A.height=q.height;A.width=q.width}}try{if(!A.id)A.id=i.id+"_canvas";J=A.getContext("2d")}catch(s){COG.Log.exception(s);throw Error("Could not initialise canvas on specified view element");}oa=COG.Touch.capture(A,
{observable:y});if(U.height!==A.height||U.width!==A.width){U=T5.D.init(A.width,A.height);y.trigger("resize",A.width,A.height);for(q=I;q--;)t[q].trigger("resize",A.width,A.height)}i.inertia&&oa.inertiaEnable(i.panAnimationDuration,U);for(q=I;q--;)t[q].trigger("contextChanged",J);n()}}function h(q,s){s.setId(q);s.added=T5.ticks();s.bind("remove",function(){y.removeLayer(q)});s.trigger("contextChanged",J);s.setParent(y);t.push(s);t.sort(function(B,E){var F=E.zindex-B.zindex;if(F===0)F=E.added-B.added;
return F});I=t.length;return s}function l(){return T5.XYRect.init(K,u,K+U.width,u+U.height)}function p(q,s,B,E,F,L,N){function O(){L&&L();d();G=1;da=null}X=true;$=T5.XY.offset(E,K,u);if(F)T5.tweenValue(0,s-q,F,O,N?N:1E3).requestUpdates(function(aa){da=aa/(s-q);G=q+aa;P=Q;n();y.trigger("animate")});else{G=s;O()}}function r(){x("idle",y);la=true;Z=0}function w(q,s,B,E){var F=false,L=(q&Q)!==0,N=T5.XYRect.copy(s),O,aa=0;B&&J.clearRect(0,0,A.width,A.height);J.save();try{ka=G;J.globalCompositeOperation=
"source-over";if(L){L=1/G;var sa=(L-0.5)*2,va=N.width*L>>0,wa=N.height*L>>0,xa=$.y-(u+N.height/2);ha=$.x-($.x-(K+N.width/2))*sa>>0;ca=$.y-xa*sa>>0;N=T5.XYRect.fromCenter(ha,ca,va,wa);J.scale(G,G)}J.translate(-N.x1,-N.y1);H=M=null;J.beginPath();for(aa=I;aa--;)if(t[aa].clip){t[aa].clip(J,N,q,y,B,E);F=true}J.closePath();F&&J.clip();for(aa=I;aa--;){O=t[aa];var ta=O.style,ua=ta?T5.Style.apply(J,ta):null;if(O.minXY)M=M?T5.XY.min(M,O.minXY):T5.XY.copy(O.minXY);if(O.maxXY)H=H?T5.XY.max(H,O.maxXY):T5.XY.copy(O.maxXY);
O.draw(J,N,q,y,B,E);ua&&T5.Style.apply(J,ua);O.trigger("drawComplete",N,E)}}finally{J.restore()}if(ia){J.globalCompositeOperation="source-over";J.strokeStyle="#f00";J.beginPath();J.moveTo(A.width/2,0);J.lineTo(A.width/2,A.height);J.moveTo(0,A.height/2);J.lineTo(A.width,A.height/2);J.stroke()}y.trigger("drawComplete",s,E);COG.Log.trace("draw complete",E)}function o(q,s){var B=false,E=ma?ma:S?ga:P,F=!S&&(E===Q||E===ga),L=Y||E===ga||E===Q||T5.isTweening();C=T5.XY.init(K>>0,u>>0);D=l();if(F){T5.cancelAnimation(function(N){return N.cancelOnInteract});
la=false;if(Z!==0){clearTimeout(Z);Z=0}}for(F=I;F--;){if(t[F].animated)P|=qa;t[F].cycle(q,D,P,L);B=t[F].shouldDraw(P,D,L)||B}L=L||(P&qa)!==0;if(B=B||L||G!==1&&G!==V){w(E,D,L,q);V=G;Y=false}if(!B&&ja===0&&!pa){if(!la&&Z===0)Z=setTimeout(r,500);s.trigger("complete")}ja=0;COG.Log.trace("Completed draw cycle",q)}function n(q){Y=q?true:false;ja+=1;if(!ea){ea=COG.Loopage.join({execute:o,frequency:W});ea.bind("complete",function(){ea=null})}}function x(){y.trigger.apply(null,arguments);for(var q=t.length;q--;)t[q].trigger.apply(null,
arguments)}i=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},i);var t=[],I=0,A=document.getElementById(i.container),J=null,K=0,u=0,C=null,D=null,ea=null,ia=i.guides,T=1,U=T5.D.init(),ja=0,$=null,la=false,S=false,Z=0,na=0,M=null,H=null,R=0,X=false,ma=null,Y=false,ba=0,G=1,V=0,ka=
1,da=null,pa=typeof FlashCanvas!=="undefined",W=~~(1E3/i.fps),oa=null,ha,ca,fa=T5.viewState("ACTIVE"),ga=T5.viewState("PAN"),Q=T5.viewState("ZOOM"),qa=T5.viewState("ANIMATING"),P=fa,ra=T5.XY.getRect,v=T5.XYRect.diagonalSize,z=T5.XYRect.center,y={id:i.id,deviceScaling:T,fastDraw:i.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,s,B,E,F){p(G,q,s,B,E,F)},centerOn:function(q){K=q.x;u=q.y},getDimensions:function(){return U},getLayer:function(q){for(var s=0;s<I;s++)if(t[s].getId()==q)return t[s];
return null},setLayer:function(q,s){for(var B=0;B<I;B++)if(t[B].getId()===q){t.splice(B,1);break}s&&h(q,s);n();return s},eachLayer:function(q){for(var s=I;s--;)q(t[s])},invalidate:n,resize:function(q,s){if(A){i.autoSize=false;A.width=q;A.height=s;g();y.trigger("resize",A.width,A.height)}},scale:function(q,s,B,E,F){E||(E=T5.D.getCenter(U));F||(F=T5.D.getCenter(U));y.animate(q,E,F,s,B);return y},triggerAll:x,removeLayer:function(q){a:{for(var s=I;s--;)if(t[s].getId()==q){q=s;break a}q=-1}if(q>=0&&q<
I){COG.say("layer.removed",{layer:t[q]});t.splice(q,1);n()}I=t.length},stateOverride:function(q){ma=q},getOffset:function(){return C?C:T5.XY.init(K,u)},getViewRect:function(){return D?D:l()},updateOffset:b,pan:function(q,s,B,E,F){b(K+q,u+s,B,E,F)},zoom:function(q,s,B){S=false;G=s;X=G!==1;$=T5.XY.offset(q,K,u);clearTimeout(na);if(X){P=Q;n();if(B)na=setTimeout(function(){d();G=1},parseInt(B,10))}}};T=T5.getConfig().getScaling();y.markers=h("markers",new T5.MarkerLayer);COG.observable(y);y.bind("invalidate",
function(q,s){n(s)});if(i.pannable){y.bind("pan",m);y.bind("panEnd",k);y.bind("inertiaCancel",function(){S=false;n()})}if(i.scalable){y.bind("pinchZoom",a);y.bind("pinchZoomEnd",c);y.bind("wheelZoom",f)}y.bind("tap",function(q,s,B){for(var E=T5.XY.offset(B,K,u),F=t.length;F--;)q.cancel=q.cancel||t[F].trigger("tap",s,B,E).cancel});y.bind("resync",function(){H=M=null});COG.configurable(y,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(i,null,{container:function(q,
s){A=document.getElementById(s);g()},rotation:function(q,s){R=s}}),true);g();i.autoSize&&window.addEventListener("resize",j,false);return y};
T5.PathLayer=function(i){i=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},i);var m=false,k=[],e=null,a=[],c=null,f=0,d=[],j=T5.ex(new T5.ViewLayer(i),{getAnimation:function(b,g,h,l){var p="pathAnimation"+f++;d.push(p);return new T5.AnimatedPathLayer({id:p,path:k,zindex:i.zindex+1,easing:b?b:T5.easing("sine.inout"),duration:g?g:5E3,drawIndicator:h,autoCenter:l?l:false})},cycle:function(b,g,h,l){return l},draw:function(b){var g,h=k.length;b.save();try{T5.Style.apply(b,i.style);if(h>0){b.beginPath();
b.moveTo(k[h-1].x,k[h-1].y);for(g=h;g--;)b.lineTo(k[g].x,k[g].y);b.stroke();if(e){b.fillStyle=i.waypointFillStyle;for(g=e.length;g--;){b.beginPath();b.arc(e[g].x,e[g].y,2,0,Math.PI*2,false);b.stroke();b.fill()}}}}finally{b.restore()}m=false},updateCoordinates:function(b,g){a=b;c=g;var h=j.getParent();if(h&&h.syncXY){h.syncXY(a);c&&h.syncXY(c);j.trigger("tidy")}}});j.bind("tidy",function(){k=T5.XY.simplify(a,i.pixelGeneralization);e=T5.XY.simplify(c,i.pixelGeneralization);m=true;j.changed()});return j};
T5.ShapeLayer=function(i){function m(c){for(var f=e.length;f--;)e[f].resync(c);e.sort(function(d,j){var b=j.xy.y-d.xy.y;if(b===0)b=j.xy.x-d.xy.y;return b});a.changed()}function k(c,f){f.syncXY&&m(f)}i=T5.ex({zindex:80},i);var e=[],a=T5.ex(new T5.ViewLayer(i),{add:function(c){e[e.length]=c},each:function(c){for(var f=e.length;f--;)c(e[f])},draw:function(c,f,d){var j=f.x1,b=f.y1,g=f.width;f=f.height;for(var h=e.length;h--;){var l=e[h].style;l=l?T5.Style.apply(c,l):null;e[h].draw(c,j,b,g,f,d);l&&T5.Style.apply(c,
l)}}});a.bind("parentChange",k);a.bind("resync",k);return a};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(i){i=T5.ex({style:null,properties:{}},i);return T5.ex(i,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(i,m){m=T5.ex({size:4},m);var k=T5.XY.init(),e=T5.ex(m,{draw:function(a){a.beginPath();a.arc(k.x,k.y,e.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([i]);k=T5.XY.floor([i])[0]}});COG.Log.info("created arc = ",i);return e};
T5.Poly=function(i,m){m=T5.ex({fill:false,simplify:false},m);var k=false,e=m.fill,a=m.simplify,c=T5.viewState("ZOOM"),f=[],d=T5.ex(new T5.Shape(m),{draw:function(j,b,g,h,l,p){if(k){b=true;g=(p&c)!==0;j.beginPath();for(p=f.length;p--;){g=f[p].x;h=f[p].y;if(b){j.moveTo(g,h);b=false}else j.lineTo(g,h);g=true}if(g){e&&j.fill();j.stroke()}}},resync:function(j){d.xy=j.syncXY(i);f=T5.XY.floor(a?T5.XY.simplify(i):i)}});k=i&&i.length>=2;return d};
T5.AnimatedPathLayer=function(i){function m(d,j,b){d.fillStyle="#FFFFFF";d.strokeStyle="#222222";d.beginPath();d.arc(b.x,b.y,4,0,Math.PI*2,false);d.stroke();d.fill()}i=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},i);var k=T5.XY.edges(i.path),e,a=null,c=0;T5.tweenValue(0,k.total,i.easing,function(){f.remove()},i.duration).requestUpdates(function(d,j){c=d;j&&f.remove()});var f=
T5.ex(new T5.ViewLayer(i),{cycle:function(){for(var d=0;d<k.accrued.length&&k.accrued[d]<c;)d++;a=null;if(d<i.path.length-1){var j=c-(d>0?k.accrued[d-1]:0),b=i.path[d];e=T5.XY.theta(b,i.path[d+1],k.edges[d]);a=T5.XY.extendBy(b,e,j);if(i.autoCenter)(d=f.getParent())&&d.centerOn(a)}return a},draw:function(d,j){if(a)(i.drawIndicator?i.drawIndicator:m)(d,j,T5.XY.init(a.x,a.y),e)}});return f};
T5.Marker=function(i){function m(j,b,g,h){e=j;a=b;c=g;f=h}i=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},i);var k=false,e=0,a=0,c=0,f=0,d=T5.ex(i,{isNew:true,isAnimating:function(){return k},draw:function(j,b,g,h,l){if(d.isNew&&i.tweenIn){var p=d.xy.y;d.xy.y=b.y1-20;k=true;T5.tween(d.xy,"y",p,i.tweenIn,function(){d.xy.y=p;k=false},i.animationSpeed?i.animationSpeed:250+Math.random()*500)}d.drawMarker(j,b,d.xy.x,d.xy.y,g,h,l);d.isNew=false},drawMarker:function(j,b,g,h){j.beginPath();
j.arc(g,h,4,0,Math.PI*2,false);j.fill();m(g-4,h-4,8,8)},hitTest:function(j,b){return j>=e&&j<=e+c&&b>=a&&b<=a+f},updateBounds:m});COG.observable(d);return d};
T5.ImageMarker=function(i){i=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},i);var m=i.imageAnchor?T5.XY.invert(i.imageAnchor):null,k=T5.ex(new T5.Marker(i),{drawMarker:function(e,a,c,f){if((globalImage=a=k.isAnimating()&&k.animatingImage?k.animatingImage:k.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var d=k.scale,j=c+~~(m.x*d),b=f+~~(m.y*d),g=~~(a.width*d),h=~~(a.height*d);k.updateBounds(j,b,
g,g);if(k.rotation||k.opacity!==1){e.save();try{e.globalAlpha=k.opacity;e.translate(c,f);e.rotate(k.rotation);e.drawImage(a,m.x*d,m.y*d,g,h)}finally{e.restore()}}else e.drawImage(a,j,b,g,h)}}});if(!k.image)k.image=T5.Images.get(i.imageUrl,function(e){k.image=e});if(!k.animatingImage)k.animatingImage=T5.Images.get(i.animatingImageUrl,function(e){k.animatingImage=e});return k};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(i){function m(){a.changed();a.trigger("markerUpdate",e)}function k(){var c=a.getParent();if(c&&c.syncXY)for(var f=e.length;f--;)c.syncXY([e[f].xy])}i=T5.ex({zindex:100,style:"basic"},i);var e=[],a=T5.ex(new T5.ViewLayer(i),{draw:function(c,f,d,j){for(var b=e.length;b--;)e[b].draw(c,f,d,a,j)},add:function(c){if(c&&typeof c.length!=="undefined")for(var f=c.length;f--;){if(c[f])e[e.length]=c[f]}else if(c)e[e.length]=c;m()},clear:function(c){if(c)for(var f=0;f<e.length;f++)c(e[f])&&
e.splice(f,1);else e=[];m()},find:function(c){for(var f=[],d=e.length;d--;)if(!c||c(e[d]))f[f.length]=e[d];return f}});a.bind("tap",function(c,f,d){for(var j=[],b=d.x,g=d.y,h=e.length;h--;)if(e[h].hitTest(b,g))j[j.length]=e[h];if(j.length>0)c.cancel=a.trigger("markerTap",f,d,j).cancel});a.bind("parentChange",k);a.bind("resync",k);a.bind("changed",k);return a};
T5.ImageLayer=function(i,m){function k(h,l,p){if(f)for(var r=f.length;r--;){var w=f[r],o=w.x,n=w.y,x=T5.XYRect.init(w.x,w.y,w.x+w.width,w.y+w.height);if(p&&T5.XYRect.intersect(h,x)){x=T5.Images.get(w.url,(l&b)===0?a:null,j);p(x,o,n,w.width,w.height)}}}function e(h){c&&c.run(h,function(l){f=l;g.changed()})}function a(){g.changed()}m=T5.ex({imageLoadArgs:{}},m);var c=i?T5.Generator.init(i,m):null,f=null,d=T5.XYRect.init(),j=m.imageLoadArgs,b=T5.viewState("ZOOM"),g=T5.ex(new T5.ViewLayer(m),{changeGenerator:function(h,
l){c=T5.Generator.init(h,T5.ex({},m,l));c.bindToView(g.getParent());f=null;e(d)},clip:function(h,l,p){k(l,p,function(r,w,o,n,x){r&&h.rect(w,o,n,x)})},cycle:function(h,l){e(l)},draw:function(h,l,p){k(l,p,function(r,w,o,n,x){g.drawImage(h,r,w,o,n,x,l,p)});d=T5.XYRect.copy(l)},drawImage:function(h,l,p,r){l&&h.drawImage(l,p,r,l.width,l.height)}});g.bind("idle",function(){e(d)});g.bind("parentChange",function(h,l){c&&c.bindToView(l)});g.bind("tap",function(h,l,p,r){h=[];var w=r.x,o=r.y,n,x;if(f)for(var t=
f.length;t--;){n=f[t];if(x=w>=n.x&&w<=n.x+n.width&&o>=n.y&&o<=n.y+n.height)h[h.length]=n}h.length>0&&g.trigger("tapImage",h,l,p,r)});return g};
T5.Style=function(){function i(f,d){a[f]=k(d);return f}function m(f){for(var d in f)i(d,f[d])}function k(f){function d(h){var l=f[h];typeof l!=="undefined"&&b.push(function(p){p[h]=l})}function j(){b=[];for(var h in f)d(h)}f=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var b=[],g={applyToContext:function(h){for(var l=b.length;l--;)b[l](h)},update:function(h,
l){f[h]=l;j()}};j();return g}var e={},a={},c={apply:function(f,d){var j=a[d]?a[d]:a.basic,b;if(f&&f.canvas){b=e[f.canvas.id];e[f.canvas.id]=d}j.applyToContext(f);return b},define:i,defineMany:m,get:function(f){return a[f]},init:k,load:function(f){COG.jsonp(f,function(d){T5.resetStyles(d)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return c}();
T5.Tiling=function(){return{tileSize:256,init:function(i,m,k,e,a){return T5.ex({x:i,y:m,width:k,height:e},a)}}}();
T5.TileGenerator=function(i){function m(r,w,o,n){function x(){if(p.initTileCreator){d=true;p.initTileCreator(r,w,o,n)}}p.prepTileCreator?p.prepTileCreator(r,w,o,x):x()}function k(r,w){for(var o=~~((r.x1-c.x)/j),n=~~((r.y1-c.y)/b),x=[],t=-f;t<h;t++)for(var I=-f;I<l;I++){var A=g(o+t,n+I);if(A)x[x.length]=A}w&&w(x);a=T5.XYRect.copy(r)}i=T5.ex({tileWidth:256,tileHeight:256,relative:false,padding:2},i);var e=null,a=null,c=T5.XY.init(),f=i.padding,d=false,j=i.tileWidth,b=i.tileHeight,g=null,h=0,l=0,p={bindToView:function(r){COG.Log.info("initializing generator");
e=r;p.trigger("bindView",r)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){g=null;d=false;a=null},run:function(r,w){if(!a||Math.abs(r.x1-a.x1)>j||Math.abs(r.y1-a.y1)>b){if(!g&&!d||p.requireRefresh()){c=i.relative?T5.XY.init(r.x1,r.y1):T5.XY.init();h=Math.ceil(r.width/j)+f;l=Math.ceil(r.height/b)+f;m(j,b,p.getTileCreatorArgs?p.getTileCreatorArgs(e):{},function(o){g=o;d=false;k(r,w)})}g&&k(r,w)}}};COG.observable(p);p.bind("update",
function(){COG.Log.info("captured generator update");a=null});return p};
