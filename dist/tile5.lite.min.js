COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var D=arguments[0]||{},M,z=1,q=arguments.length;z<q;z++)if((M=arguments[z])!==null)for(var f in M){var h=M[f];if(D!==h)if(h!==undefined)D[f]=h}return D};
(function(){var D=Object.prototype.hasOwnProperty,M=0,z={};z.toID=function(q){return q.replace(/\s/g,"-")};z.objId=function(q){return(q?q:"obj")+M++};z.isFunction=function(q){return toString.call(q)==="[object Function]"};z.isArray=function(q){return toString.call(q)==="[object Array]"};z.isPlainObject=function(q){if(!q||toString.call(q)!=="[object Object]"||q.nodeType||q.setInterval)return false;if(q.constructor&&!D.call(q,"constructor")&&!D.call(q.constructor.prototype,"isPrototypeOf"))return false;
var f;for(f in q);return f===undefined||D.call(q,f)};z.isEmptyObject=function(q){for(var f in q)return false;return true};z.isXmlDocument=function(q){return toString.call(q)==="[object Document]"};z.contains=function(q,f){var h=q,m=arguments,t=1;if(f&&module.isArray(f)){m=f;t=0}for(t=t;t<m;t++)h=h&&typeof foo[m[t]]!=="undefined";return h};z.formatStr=function(q){if(arguments.length<=1)return q;for(var f=arguments.length-2,h=0;h<=f;h++)q=q.replace(RegExp("\\{"+h+"\\}","gi"),arguments[h+1]);return q};
z.wordExists=function(q,f){var h="";if(f.toString)f=f.toString();for(var m=0;m<f.length;m++)h+=!/\w/.test(f[m])?"\\"+f[m]:f[m];return RegExp("(^|\\s|\\,)"+h+"(\\,|\\s|$)","i").test(q)};COG.extend(COG,z)})();
(function(){function D(h){return typeof console!=="undefined"?function(){console[h](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var M=window.console&&window.console.markTimeline,z=D("error"),q=D("info"),f=function(){return M?function(h,m){console.markTimeline(h+(m?": "+((new Date).getTime()-m)+"ms":""))}:function(){}}();COG.extend(COG,{trace:f,debug:D("debug"),info:q,warn:D("warn"),error:z,exception:function(h){if(z)for(var m in h)q("ERROR DETAIL: "+m+
": "+h[m])}})})();
(function(){function D(z,q){var f=z.hasOwnProperty("obsHandlers")?z.obsHandlers:null;f[q]||(f[q]=[]);return f[q]}var M=0;COG.observable=function(z){if(!z)return null;if(!(z.hasOwnProperty("obsHandlers")?z.obsHandlers:null))z.obsHandlers={};if(!z.hasOwnProperty("bind")){z.bind=function(q,f){var h="callback"+M++;D(z,q).unshift({fn:f,id:h});return h};z.triggerCustom=function(q,f){var h=D(z,q),m={cancel:false,name:q,source:this},t;f&&COG.extend(m,f);if(!h)return null;t=Array.prototype.slice.call(arguments,2);
z.eventInterceptor&&z.eventInterceptor(q,m,t);t.unshift(m);for(var H=h.length;H--&&!m.cancel;)h[H].fn.apply(this,t);return m};z.trigger=function(q){var f=Array.prototype.slice.call(arguments,1);f.splice(0,0,q,null);return z.triggerCustom.apply(this,f)};z.unbind=function(q,f){if(typeof q==="undefined")z.obsHandlers={};else for(var h=D(z,q),m=0;h&&m<h.length;m++)if(h[m].id===f){h.splice(m,1);break}return z}}return z}})();
(function(){function D(f,h){f[h]||(f[h]=function(m){return f.configure(h,m)})}function M(f){f.gtConfId="configurable"+q++;f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var z={},q=0;COG.paramTweaker=function(f,h,m){return function(t,H){if(typeof H!=="undefined"){if(t in f)f[t]=H;m&&t in m&&m[t](t,H)}else return h&&t in h?h[t](t):f[t]}};COG.configurable=function(f,h,m,t){if(f){f.gtConfId||M(f);var H=f.gtConfId,i=f.gtConfig,w=f.gtConfigFns;z[H]=f;w.push(m);for(m=h.length;m--;){i[h[m]]=true;t&&D(f,
h[m])}if(!f.configure)f.configure=function(r,x){if(i[r]){for(var p=w.length;p--;){var o=w[p](r,x);if(typeof o!=="undefined")return o}return z[H]}return null}}}})();
(function(){function D(f){var h=document.createElement("script"),m=false;h.src=f;h.async=true;h.onload=h.onreadystatechange=function(){if(!m&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){m=true;h.onload=h.onreadystatechange=null;h&&h.parentNode&&h.parentNode.removeChild(h)}};z||(z=document.getElementsByTagName("head")[0]);z.appendChild(h)}var M=0,z,q=this;COG.jsonp=function(f,h,m){f+=f.indexOf("?")>=0?"&":"?";var t="json"+ ++M;q[t]=function(H){h(H);q[t]=null;try{delete q[t]}catch(i){}};
D(f+(m?m:"callback")+"="+t);return t}})();
(function(){var D=1.70158,M=Math.PI/2,z=1E3/60|0,q=Math.abs,f=Math.pow,h=Math.sin,m=Math.asin,t=Math.cos,H={linear:function(i,w,r,x){return r*i/x+w},backin:function(i,w,r,x){return r*(i/=x)*i*((D+1)*i-D)+w},backout:function(i,w,r,x){return r*((i=i/x-1)*i*((D+1)*i+D)+1)+w},backinout:function(i,w,r,x){return(i/=x/2)<1?r/2*i*i*(((D*=1.525)+1)*i-D)+w:r/2*((i-=2)*i*(((D*=1.525)+1)*i+D)+2)+w},bouncein:function(i,w,r,x){return r-H.bounceout(x-i,0,r,x)+w},bounceout:function(i,w,r,x){return(i/=x)<1/2.75?r*
7.5625*i*i+w:i<2/2.75?r*(7.5625*(i-=1.5/2.75)*i+0.75)+w:i<2.5/2.75?r*(7.5625*(i-=2.25/2.75)*i+0.9375)+w:r*(7.5625*(i-=2.625/2.75)*i+0.984375)+w},bounceinout:function(i,w,r,x){return i<x/2?H.bouncein(i*2,0,r,x)/2+w:H.bounceout(i*2-x,0,r,x)/2+r/2+w},cubicin:function(i,w,r,x){return r*(i/=x)*i*i+w},cubicout:function(i,w,r,x){return r*((i=i/x-1)*i*i+1)+w},cubicinout:function(i,w,r,x){if((i/=x/2)<1)return r/2*i*i*i+w;return r/2*((i-=2)*i*i+2)+w},elasticin:function(i,w,r,x,p,o){if(i==0)return w;if((i/=
x)==1)return w+r;o||(o=x*0.3);if(!p||p<q(r)){p=r;r=o/4}else r=o/TWO_PI*m(r/p);return-(p*f(2,10*(i-=1))*h((i*x-r)*TWO_PI/o))+w},elasticout:function(i,w,r,x,p,o){var s;if(i==0)return w;if((i/=x)==1)return w+r;o||(o=x*0.3);if(!p||p<q(r)){p=r;s=o/4}else s=o/TWO_PI*m(r/p);return p*f(2,-10*i)*h((i*x-s)*TWO_PI/o)+r+w},elasticinout:function(i,w,r,x,p,o){var s;if(i==0)return w;if((i/=x/2)==2)return w+r;o||(o=x*0.3*1.5);if(!p||p<q(r)){p=r;s=o/4}else s=o/TWO_PI*m(r/p);if(i<1)return-0.5*p*f(2,10*(i-=1))*h((i*
x-s)*TWO_PI/o)+w;return p*f(2,-10*(i-=1))*h((i*x-s)*TWO_PI/o)*0.5+r+w},quadin:function(i,w,r,x){return r*(i/=x)*i+w},quadout:function(i,w,r,x){return-r*(i/=x)*(i-2)+w},quadinout:function(i,w,r,x){if((i/=x/2)<1)return r/2*i*i+w;return-r/2*(--i*(i-2)-1)+w},sinein:function(i,w,r,x){return-r*t(i/x*M)+r+w},sineout:function(i,w,r,x){return r*h(i/x*M)+w},sineinout:function(i,w,r,x){return-r/2*(t(Math.PI*i/x)-1)+w}};COG.tweenValue=function(i,w,r,x,p){function o(Q){Q=Q?Q:(new Date).getTime();if(ca+z<Q){var da=
Q-s,O=r(da,i,R,x),fa=s+x<=Q;Q=!fa;if(p){da=p(O,fa,da);Q=typeof da!="undefined"?da&&Q:Q}Q&&animFrame(o)}}var s=(new Date).getTime(),ca=0,R=w-i;animFrame(o);return{}};COG.easing=function(i){return H[i.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(i,w){H[i.replace(/[\-\_\s\.]/g,"").toLowerCase()]=w}})();
(function(){var D=/^P(\d+Y)?(\d+M)?(\d+D)?$/,M=/^(\d+H)?(\d+M)?(\d+S)?$/,z={8601:function(f){f=f.split("T");var h=null;h=null;var m=0,t=0;D.lastIndex=-1;h=D.exec(f[0]);m+=h[3]?parseInt(h[3].slice(0,-1),10):0;M.lastIndex=-1;h=M.exec(f[1]);t+=h[1]?parseInt(h[1].slice(0,-1),10)*3600:0;t+=h[2]?parseInt(h[2].slice(0,-1),10)*60:0;t+=h[3]?parseInt(h[3].slice(0,-1),10):0;return new q(m,t)}},q=COG.Duration=function(f,h){return{days:f?f:0,seconds:h?h:0}};COG.addDuration=function(){for(var f=new q,h=arguments.length;h--;){f.days+=
arguments[h].days;f.seconds+=arguments[h].seconds}if(f.seconds>=86400){f.days+=~~(f.seconds/86400);f.seconds%=86400}return f};COG.formatDuration=function(f){var h,m,t="";if(f.days)t=f.days+" days ";if(f.seconds){f=f.seconds;if(f>=3600){h=~~(f/3600);f-=h*3600}if(f>=60){m=Math.round(f/60);f-=m*60}if(h)t=t+h+(h>1?" hrs ":" hr ")+(m?(m>10?m:"0"+m)+" min ":"");else if(m)t=t+m+" min";else if(f>0)t=t+(f>10?f:"0"+f)+" sec"}return t};COG.parseDuration=function(f,h){var m=h?z[h]:null;if(m)return m(f);COG.Log.warn("Could not find duration parser for specified format: "+
h);return new q}})();COG.ObjectStore=function(){var D={},M={},z="obj_"+(new Date).getTime(),q=0,f=Object.prototype.hasOwnProperty;return{add:function(h,m){var t;m=m?m:"default";if(h&&h.constructor)if(!f.call(h,"id"))h.id=z+ ++q;t=M[m]?M[m]:M[m]=[];D[h.id]=t.length;t[h.length]=h}}};var CANI={};
(function(D){var M=[],z=0,q=false,f=D.register=function(h,m){M.push({section:h,run:m})};D.init=function(h){function m(){if(z<M.length){var H=M[z++];t[H.section]||(t[H.section]={});H.run(t[H.section],m)}else{for(H in t)D[H]=t[H];q=true;h&&h(D)}}var t={};if(q&&h)h(D);else{z=0;m()}};f("canvas",function(h,m){function t(){var r,x=H.getContext("2d");x.save();try{x.translate(50,50);x.beginPath();x.rect(0,0,20,20);r=x.isPointInPath(10,10)}finally{x.restore()}return r}var H=document.createElement("canvas"),
i=typeof FlashCanvas!="undefined",w=typeof G_vmlCanvasManager!="undefnined";H.width=200;H.height=200;h.pipTransformed=i||w?false:t();m()})})(CANI);
INTERACT=function(){function D(p){return function(o,s,ca){(ca?ca:p?document.body:document).addEventListener(o,s,false)}}function M(p){return function(o,s,ca){(ca?ca:p?document.body:document).removeEventListener(o,s,false)}}function z(p,o,s){(s?s:document).attachEvent("on"+p,o)}function q(p,o,s){(s?s:document).detachEvent("on"+p,o)}function f(p,o){return{x:p?p:0,y:o?o:0,count:1}}function h(p,o){r.push(COG.extend({handler:null,checks:{},type:p},o))}function m(p){var o=0,s=0;if(p.offsetParent){do{o+=
p.offsetLeft;s+=p.offsetTop;p=p.offsetParent}while(p)}return{left:o,top:s}}function t(p,o){return{source:p,target:o.target?o.target:o.srcElement}}function H(p,o){for(var s=p.target?p.target:p.srcElement;s&&s!==o&&s.nodeName&&s.nodeName.toUpperCase()!="CANVAS";)s=s.parentNode;return s&&s===o}function i(p,o){return{x:p.x-(o?o.left:0),y:p.y-(o?o.top:0)}}function w(p){if(p.preventDefault){p.preventDefault();p.stopPropagation()}else p.cancelBubble&&p.cancelBubble()}var r=[],x=function(p,o,s){function ca(N,
X,S,G){var K=0,ea=0,u=0;COG.tweenValue(0,N,S,G,function(J){u=K;K=J});COG.tweenValue(0,X,S,G,function(J){R.trigger("pan",K-u,J-ea);ea=J})}s=COG.extend({binder:null,unbinder:null,observable:null},s);for(var R=s.observable,Q=null,da=[],O=[],fa,ma,ia={bind:function(){return R.bind.apply(null,arguments)},pannable:function(N){Q=COG.extend({inertia:true},N);return ia},unbind:function(){R.unbind();for(var N=0;N<da.length;N++)da[N].unbind();return ia}},ua=0;ua<o.length;ua++)da.push(o[ua](p,R,s));R.bind("pointerDown",
function(){O=[];ma=fa=0});R.bind("pointerMove",function(N,X,S,G){if(Q){O[O.length]={ticks:(new Date).getTime(),x:G.x,y:G.y};R.trigger("pan",G.x,G.y)}fa+=G.x?G.x:0;ma+=G.y?G.y:0});R.bind("pointerUp",function(N,X,S){if(Math.abs(fa)>20||Math.abs(ma)>20){if(Q){S=O.length;var G,K;X=0;for(K=O.length;--K>1&&X<50;)X+=O[K].ticks-O[K-1].ticks;if(S-K>1){N=O[S-1].x-O[K].x;G=O[S-1].y-O[K].y;K=Math.sqrt(N*N+G*G)|0;if(K>15){N=O[S-1].x-O[0].x;G=O[S-1].y-O[0].y;K=Math.sqrt(N*N+G*G)|0;S=Math.asin(G/K);X=K*500/X|0;
X=X>300?300:X;ca(Math.cos(N>0?S:Math.PI-S)*X,Math.sin(S)*X,COG.easing("sine.out"),500)}}}}else R.trigger("tap",X,S)});return ia};h("pointer",{handler:function(p,o,s){function ca(u){if(u.pageX&&u.pageY)return f(u.pageX,u.pageY);else{var J=document.documentElement,$=document.body;return f(u.clientX+(J&&J.scrollLeft||$&&$.scrollLeft||0)-(J&&J.clientLeft||$&&$.clientLeft||0),u.clientY+(J&&J.scrollTop||$&&$.scrollTop||0)-(J&&J.clientTop||$&&$.clientTop||0))}}function R(u){if(H(u,p))if(N=fa(u)){var J=ca(u);
p.style.cursor="move";w(u);K=J.x;ea=J.y;X=f(K,ea);o.triggerCustom("pointerDown",t("mouse",u),X,i(X,m(p)))}}function Q(u){var J=ca(u);S=J.x;G=J.y;if(H(u,p))ma(u,N?"pointerMove":"pointerHover")}function da(u){if(N&&fa(u)){N=false;if(H(u,p)){p.style.cursor="default";ma(u,"pointerUp")}}}function O(u){if(H(u,p)){var J;u=u||window.event;if(u.detail)J=u.axis===2?-u.detail*ia:0;else{J=u.wheelDeltaY?u.wheelDeltaY:u.wheelDelta;if(window.opera)J=-J}if(J!==0){var $=f(S,G);o.triggerCustom("zoom",t("mouse",u),
$,i($,m(p)),J/ua,"wheel");w(u);u.returnValue=false}}}function fa(u){u=u||window.event;return(u.which||u.button)==1}function ma(u,J,$,ta,Ca){$=typeof $!="undefined"?$:S;ta=typeof ta!="undefined"?ta:G;var A=$-K,T=ta-ea,F=f($,ta);o.triggerCustom(J,t("mouse",u),F,i(F,m(p)),f(A,T));if(typeof Ca=="undefined"||Ca){K=$;ea=ta}}s=COG.extend({},s);var ia=120,ua=ia*8,N=false,X,S,G,K,ea;s.binder("mousedown",R,false);s.binder("mousemove",Q,false);s.binder("mouseup",da,false);s.binder("dblclick",function(u){COG.info("captured double click");
if(H(u,p)){var J=ca(u);o.triggerCustom("doubleTap",t("mouse",u),J,i(J,m(p)))}},false);s.binder("mousewheel",O,document);s.binder("DOMMouseScroll",O,document);return{unbind:function(){s.unbinder("mousedown",R,false);s.unbinder("mousemove",Q,false);s.unbinder("mouseup",da,false);s.unbinder("mousewheel",O,document);s.unbinder("DOMMouseScroll",O,document)}}},checks:{touch:false}});h("pointer",{handler:function(p,o,s){function ca(A){if(A.count<2)return 0;var T=A.x-A.next.x;A=A.y-A.next.y;return~~Math.sqrt(T*
T+A*A)}function R(A,T,F){T=T?T:0;F=F?F:0;for(var oa={x:A.x-T,y:A.y-F,id:A.id,count:A.count},ga=oa;A.next;){A=A.next;ga=ga.next={x:A.x-T,y:A.y-F,id:A.id}}return oa}function Q(A,T){var F=A[T?T:"touches"],oa,ga;if(F.length===0)return null;ga=oa={x:F[0].pageX,y:F[0].pageY,id:F[0].identifier,count:F.length};for(var pa=1,va=F.length;pa<va;pa++)ga=ga.next={x:F[pa].pageX,y:F[pa].pageY,id:F[pa].identifier};return oa}function da(A){if(H(A,p)){G=m(p);var T=Q(A,"changedTouches"),F=R(T,G.left,G.top);if(!ea){K=
N;o.triggerCustom("pointerDown",t("touch",A),T,F)}ta&&o.triggerCustom("pointerDownMulti",t("touch",A),T,F);ea=Q(A);if(ea.count>1)J=ca(ea);Ca=1;$=R(ea)}}function O(A){if(H(A,p)){A.preventDefault();u=Q(A);if(K==N)K=Math.abs(ea.x-u.x)>ia||Math.abs(ea.y-u.y)>ia?ua:N;if(K!=N){K=u.count>1?S:X;if(K==S)if(ea.count===1){ea=R(u);J=ca(ea)}else{var T=ca(u);if(Math.abs(J-T)<ma)K=X;else{var F;F=u.x;var oa=u.next.x,ga=u.y,pa=u.next.y,va=ga<pa?ga:pa;F={x:(F<oa?F:oa)+(Math.abs(F-oa)>>1),y:va+(Math.abs(ga-pa)>>1)};
T=T/J;oa=T-Ca;o.triggerCustom("zoom",t("touch",A),F,i(F,G),oa,"pinch");Ca=T}}K==X&&o.triggerCustom("pointerMove",t("touch",A),u,R(u,G.left,G.top),f(u.x-$.x,u.y-$.y));ta&&o.triggerCustom("pointerMoveMulti",t("touch",A),u,R(u,G.left,G.top))}$=R(u)}}function fa(A){if(H(A,p)){var T=Q(A,"changedTouches"),F=R(T,G.left,G.top);u=Q(A);if(!u){o.triggerCustom("pointerUp",t("touch",A),T,F);ea=null}ta&&o.triggerCustom("pointerUpMulti",t("touch",A),T,F)}}s=COG.extend({detailed:false,inertia:false},s);var ma=20,
ia=7,ua=0,N=1,X=2,S=3,G,K,ea,u,J,$,ta=s.detailed,Ca=1;s.binder("touchstart",da,false);s.binder("touchmove",O,false);s.binder("touchend",fa,false);COG.info("initialized touch handler");return{unbind:function(){s.unbinder("touchstart",da,false);s.unbinder("touchmove",O,false);s.unbinder("touchend",fa,false)}}},checks:{touch:true}});return{register:h,watch:function(p,o,s){o=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},o);capabilities=COG.extend({touch:"ontouchstart"in
window},s);if(!o.observable){COG.info("creating observable");o.observable=COG.observable({});globalOpts=o}o.binder=o.isIE?z:D(o.bindToBody);o.unbinder=o.isIE?q:M(o.bindToBody);s=o.types;for(var ca=capabilities,R=[],Q=r.length;Q--;){var da=r[Q],O=!s||s.indexOf(da.type)>=0,fa=true;for(var ma in da.checks){var ia=da.checks[ma];COG.info("checking "+ma+" capability. require: "+ia+", capability = "+ca[ma]);fa=fa&&ia===ca[ma]}if(O&&fa)R[R.length]=da.handler}return new x(p,R,o)}}}();var T5={};
(function(D){function M(){return(new Date).getTime()}function z(){for(;Wa.length>0;){var a=Wa.shift();document.location=a}Xa=0}function q(a){for(var e=true,c=ib.length;c--;)e=e&&a!=ib[c];return e}function f(a,e){var c=[];for(var b in e)b&&c.push(b+"="+escape(e[b]));return"tile5://"+a+"/"+(c.length>0?"?"+c.join("&"):"")}function h(a,e){q(a)&&COG.info("would push url: "+f(a,e))}function m(a,e){if(q(a)){Wa.push(f(a,e));Xa||(Xa=setTimeout(z,100))}}function t(a){return function(e,c,b){(b?b:a?document.body:
document).addEventListener(e,c,false)}}function H(a){return function(e,c,b){(b?b:a?document.body:document).removeEventListener(e,c,false)}}function i(a,e,c){(c?c:document).attachEvent("on"+a,e)}function w(a,e,c){(c?c:document).detachEvent("on"+a,e)}function r(){ga={base:{name:"Unknown",bindEvent:t(),unbindEvent:H(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:h,targetFps:null},ie:{name:"MSIE",regex:/msie/i,
bindEvent:i,unbindEvent:w,requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:m,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:m},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:m},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:t(true),unbindEvent:H(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},
bridgeNotify:m},froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:m}};pa=[ga.froyo,ga.android,ga.ipod,ga.iphone,ga.ipad,ga.ie]}function x(){ga||r();if(!va){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var a=0;a<pa.length;a++){var e=pa[a];if(e.regex&&e.regex.test(navigator.userAgent)){va=COG.extend({},ga.base,e);COG.info("PLATFORM DETECTED AS: "+va.name);break}}if(!va){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
va=ga.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return va}function p(){var a=(new Date).getTime(),e=0;clearTimeout(Ka);for(Ka=0;e<Ha.length;){var c=Ha[e],b=Da[c],d=Da[c].image&&(jb||Da[c].image.complete&&Da[c].image.width>0),g=a-b.start;g=d||g>=Cb;if(d){d=b.image;b=b.callbacks;kb[c]=d;for(var l=0;l<b.length;l++)b[l](d,true)}if(g){Ha.splice(e,1);delete Da[c]}else e++}if(Ha.length>0)Ka=setTimeout(p,lb)}function o(a){function e(g){var l=a[g];typeof l!=="undefined"&&b.push(function(y){y[g]=
l})}function c(){b=[];for(var g in a)e(g)}a=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},a);var b=[],d={applyToContext:function(g){for(var l=b.length;l--;)b[l](g)},update:function(g,l){a[g]=l;c()}};c();return d}function s(){for(var a=0,e=arguments.length;e--;){var c=Db[arguments[e].toUpperCase()];if(c)a|=c}return a}function ca(a){a=a?a:(new Date).getTime();
if(a-mb>Eb){for(var e=La.splice(0),c=e.length;c--;)e[c](a);mb=a}La.length&&animFrame(ca)}function R(a){var e=La.length==0;La[La.length]=a;e&&animFrame(ca)}function Q(a,e,c,b,d){d=COG.extend({easing:"sine.out",duration:1E3,progress:null,complete:null,autoInvalidate:true},d);var g=(new Date).getTime(),l=a[e],y=e=="translate",k=d.autoInvalidate,B=c.length&&b.length&&c.length==b.length?c.length:0,V=Array(B),Z=Array(B),I=COG.easing(d.easing),aa=d.duration,C=d.progress,E=function(Y){var U=Y-g;Y=g+aa<=Y;
for(var ha=a.layer?a.layer.view:null,ja,na=B;na--;){ja=I(U,c[na],V[na],aa);Z[na]=y?ja|0:ja}l.apply(a,Z);if(k&&ha)ha.redraw=true;if(C){U=[].concat(Y?b:Z);U.unshift(Y);C.apply(a,U)}if(Y){a.animations--;l.apply(a,b);d.complete&&d.complete.apply(a,b)}else R(E)};if(l&&l.apply&&B>0){aa=aa?aa:DEFAULT_DURATION;for(e=B;e--;)V[e]=b[e]-c[e];a.animations++;R(E)}}function da(a,e){var c,b;if(e&&e.width>0){if(!a.imageOffset)a.imageOffset=A.init(-e.width>>1,-e.height>>1);if(!a.bounds){c=a.xy.x+a.imageOffset.x;b=
a.xy.y+a.imageOffset.y;a.bounds=F.init(c,b,c+e.width,b+e.height)}}}function O(a){wa.call(this,a)}function fa(a,e){e=COG.extend({simplify:false},e);var c=false,b=e.simplify;s("ZOOM");var d=[];e.type=e.fill?"polygon":"line";wa.call(this,e);COG.extend(this,{animatePath:function(){},prep:function(g){return c?g.path(d):null},resync:function(g){var l,y,k,B,V;g.syncXY(a);d=A.floor(b?A.simplify(a):a);for(var Z=d.length;Z--;){g=d[Z].x;l=d[Z].y;B=typeof B=="undefined"||g<B?g:B;V=typeof V=="undefined"||l<V?
l:V;y=typeof y=="undefined"||g>y?g:y;k=typeof k=="undefined"||l>k?l:k}this.updateBounds(F.init(B,V,y,k),true)}});c=a&&a.length>=2}function ma(a,e){e.fill=false;fa.call(this,a,e)}function ia(a){function e(k){(this.imageUrl=k)&&nb(this.imageUrl,function(B,V){l=B;if(V){var Z=y.layer?y.layer.view:null;if(Z)Z.redraw=true}})}a=COG.extend({image:null,imageUrl:null,imageOffset:null},a);var c=null,b=wa.prototype.updateBounds,d,g,l=a.image;wa.call(this,a);var y=COG.extend(this,{changeImage:e,drag:function(k,
B,V,Z){c||(c=A.init(k.startX-this.xy.x,k.startY-this.xy.y));this.xy.x=B-c.x;this.xy.y=V-c.y;if(Z){c=null;if(this.layer)(k=this.layer.view)&&k.syncXY([this.xy],true);this.trigger("dragDrop")}return true},prep:function(k){if(l&&l.width>0){da(this,l);d=this.xy.x+this.imageOffset.x;g=this.xy.y+this.imageOffset.y;return k.image(l,d,g,l.width,l.height)}},updateBounds:function(k,B){b.call(this,k,B);da(this,l)}});l||e(this.imageUrl)}function ua(a){a=COG.extend({imageAnchor:null},a);if(a.imageAnchor)a.imageOffset=
A.invert(a.imageAnchor);ia.call(this,a)}function N(a){a=COG.extend({id:COG.objId("layer"),zindex:0,animated:false,validStates:s("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},a);this.view=null;COG.observable(COG.extend(this,a))}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(function(){a((new Date).getTime())},
1E3/60)}}();var X=Math.abs,S=Math.min,G=Math.max,K=Math.pow,ea=Math.sqrt,u=Math.log,J=Math.round,$=Math.sin,ta=Math.asin,Ca=Math.cos,A=function(){function a(b,d){return c(b.x-d.x,b.y-d.y)}function e(b,d){if(!d)d=b.length;if(d<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var g={edges:Array(d-1),accrued:Array(d-1),total:0},l=0;l<d-1;l++){var y=a(b[l],b[l+1]);g.edges[l]=ea(y.x*y.x+y.y*y.y);g.accrued[l]=g.total+g.edges[l];g.total+=g.edges[l]}return g}function c(b,
d){return{x:b?b:0,y:d?d:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=0,d=0,g=arguments.length;g--;){b+=arguments[g].x;d+=arguments[g].y}return c(b,d)},absSize:function(b){return G(X(b.x),X(b.y))},copy:function(b){return b?c(b.x,b.y):null},diff:a,distance:function(b,d){return e(b,d).total},edges:e,equals:function(b,d){return b.x===d.x&&b.y===d.y},extendBy:function(b,d,g){var l=Ca(d)*g|0;d=$(d)*g|0;return c(b.x-l,b.y-d)},floor:function(b){for(var d=Array(b.length),
g=b.length;g--;)d[g]=c(~~b[g].x,~~b[g].y);return d},getRect:function(b){for(var d,g,l,y,k=b.length;k--;){var B=b[k];d=typeof d==="undefined"||B.x<d?B.x:d;g=typeof g==="undefined"||B.y<g?B.y:g;l=typeof l==="undefined"||B.x>l?B.x:l;y=typeof y==="undefined"||B.y>y?B.y:y}return F.init(d,g,l,y)},init:c,invert:function(b){return c(-b.x,-b.y)},min:function(b,d){return c(b.x<d.x?b.x:d.x,b.y<d.y?b.y:d.y)},max:function(b,d){return c(b.x>d.x?b.x:d.x,b.y>d.y?b.y:d.y)},offset:function(b,d,g){return c(b.x+d,b.y+
(g?g:d))},scale:function(b,d){return c(b.x/d|0,b.y/d|0)},simplify:function(b,d){if(!b)return null;d=d?d:A.VECTOR_SIMPLIFICATION;for(var g=[],l=null,y=b.length;y--;){var k=b[y];if(include=!l||y===0||X(k.x-l.x)+X(k.y-l.y)>d){g.unshift(k);l=k}}return g},theta:function(b,d,g){g=ta((b.y-d.y)/g);return b.x>d.x?g:Math.PI-g},toString:function(b){return b?b.x+", "+b.y:""}}}(),T=function(){return{dotProduct:function(a,e){return a.x*e.x+a.y*e.y}}}(),F=function(){function a(c){return e(c.x1,c.y1,c.x2,c.y2)}function e(c,
b,d,g){c=c?c:0;b=b?b:0;d=typeof d!=="undefined"?d:c;g=typeof g!=="undefined "?g:g;return{x1:c,y1:b,x2:d,y2:g,width:d-c,height:g-b}}return{buffer:function(c,b,d){return A.init(c.x1-b,c.y1-d?d:b,c.x1+b,c.y1+d?d:b)},center:function(c){return A.init(c.x1+(c.width>>1),c.y1+(c.height>>1))},copy:a,diagonalSize:function(c){return ea(c.width*c.width+c.height*c.height)},fromCenter:function(c,b,d,g){d=d>>1;g=g>>1;return e(c-d,b-g,c+d,b+g)},init:e,intersect:function(c,b){var d=G(c.x1,b.x1),g=G(c.y1,b.y1),l=S(c.x2,
b.x2),y=S(c.y2,b.y2);d=e(d,g,l,y);return d.width>0&&d.height>0?d:null},toString:function(c){return c?"["+c.x1+", "+c.y1+", "+c.x2+", "+c.y2+"]":""},union:function(c,b){if(c.width===0||c.height===0)return a(b);else if(b.width===0||b.height===0)return a(c);else{var d=S(c.x1,b.x1),g=S(c.y1,b.y1),l=G(c.x2,b.x2),y=G(c.y2,b.y2);d=e(d,g,l,y);return d.width>0&&d.height>0?d:null}}}}(),oa=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return A.init(a.width>>
1,a.height>>1)},getSize:function(a){return ea(K(a.width,2)+K(a.height,2))},init:function(a,e){a=a?a:0;return{width:a,height:e?e:a}}}}();Hits=function(){return{diffHits:function(a,e){var c=[],b={},d;for(d=e.length;d--;)b[e[d].target.id]=true;for(d=a.length;d--;)b[a[d].target.id]||(c[c.length]=a[d]);return c},init:function(a,e,c,b){return{type:a,x:b.x|0,y:b.y|0,elements:[],absXY:e,relXY:c}},initHit:function(a,e,c){return{type:a,target:e,drag:c}},triggerEvent:function(a,e,c,b){e.triggerCustom(a.type+
(c?c:"Hit"),{hitType:a.type},b?b:a.elements,a.absXY,a.relXY,A.init(a.x,a.y))}}}();var ga=null,pa=[],va=null,Xa=0,Wa=[],ib=["view.wake","tile.loaded"],lb=100,Cb=3E4,kb={},Fb=0;(new Date).getTime();var Da={},Ha=[],jb=typeof FlashCanvas!="undefined",Ka=0,nb=T5.getImage=function(a,e){var c=a&&e?kb[a]:null;if(c&&c&&(jb||c.complete&&c.width>0))e(c);else{if(c=Da[a])c.callbacks.push(e);else{c=new Image;c.id="_ldimg"+ ++Fb;Da[a]={start:(new Date).getTime(),image:c,callbacks:[e]};c.src=a;Ha[Ha.length]=a}Ka||
(Ka=setTimeout(p,lb))}},Gb=T5.newCanvas=function(a,e){var c=document.createElement("canvas");c.width=a?a:0;c.height=e?e:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(c);FlashCanvas.initElement(c)}typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(c);return c},ob=function(){var a={};return{init:function(e,c){var b=a[e];if(!b)throw Error("Unable to locate requested generator: "+e);return new b(c)},register:function(e,c){a[e]=c}}}(),Hb=function(){return{applyStyle:function(){},
applyTransform:function(a,e,c){return{restore:null,x:e,y:c}},checkSize:function(){},hitTest:function(){return false},restore:function(){},save:function(){}}},pb={},qb=D.registerRenderer=function(a,e){pb[a]=e},rb=D.attachRenderer=function(a,e,c,b){a=a.split("/");for(var d=new Hb(e,c,b),g=0;g<a.length;g++){var l=pb[a[g]];if(l)d=new l(e,c,b,d)}return d};qb("canvas",function(a,e,c,b){function d(C,E,Y){if(C.image)k.drawImage(C.image,E,Y);else if(!C.loading){C.loading=true;nb(C.url,function(U){C.image=
U;C.loading=false;k.drawImage(U,C.screenX,C.screenY)})}}c=COG.extend({},c);var g,l,y,k,B,V=0,Z=0,I=null,aa={};if(e){g=a.width=e.offsetWidth;l=a.height=e.offsetHeight;y=Gb(g,l);y.style.cssText="position: absolute; z-index: 1;";k=null;e.appendChild(y)}return COG.extend(b,{interactTarget:y,applyStyle:function(C){var E=Ib(C),Y=E&&k&&k.canvas?aa[k.canvas.id]:null;if(E){aa[k.canvas.id]=C;E.applyToContext(k);return Y}},applyTransform:function(C){if(C.translateX||C.translateY||C.scaling!==1||C.rotatation){k.save();
I={undo:function(){k.restore();I=null},x:C.xy.x,y:C.xy.y};k.translate(C.xy.x-V+C.translateX,C.xy.y-Z+C.translateY);C.rotation!==0&&k.rotate(C.rotation);C.scaling!==1&&k.scale(C.scaling,C.scaling)}return I},arc:function(C,E,Y,U,ha){k.beginPath();k.arc(C-(I?I.x:V),E-(I?I.y:Z),Y,U,ha,false);return{draw:function(){k.fill();k.stroke()}}},drawTiles:function(C){for(var E,Y,U=I?I.x:V,ha=I?I.y:Z,ja=U-256,na=ha-256,Ra=U+g,Ea=ha+l,Fa,Sa,ba=C.length;ba--;){E=C[ba];Y=E.x>=ja&&E.x<=Ra&&E.y>=na&&E.y<=Ea;Fa=E.screenX=
E.x-U;Sa=E.screenY=E.y-ha;Y&&d(E,Fa,Sa)}},image:function(C,E,Y,U,ha){var ja=E-(I?I.x:V),na=Y-(I?I.y:Z);k.beginPath();k.rect(ja,na,U,ha);return{draw:function(){k.drawImage(C,ja,na,U,ha)}}},prepare:function(C){var E,Y=false;E=a.getOffset();var U=a.getScaleFactor(),ha=E.x,ja=E.y;if(k)k.restore();else k=y.getContext("2d");for(E=C.length;E--;)Y=Y||C[E].clip;B=F.init(ha,ja,ha+g,ja+l);B.scaleFactor=U;if(U!==1)B=F.buffer(B,g/U>>1,l/U>>1);V=B.x1-(B.width>>1);Z=B.y1-(B.height>>1);if(k){Y||k.clearRect(0,0,g,
l);k.save();k.scale(U,U)}k.globalCompositeOperation="source-over";return k},path:function(C){var E=true,Y=I?I.x:V,U=I?I.y:Z;k.beginPath();for(var ha=C.length;ha--;){var ja=C[ha].x-Y,na=C[ha].y-U;if(E){k.moveTo(ja,na);E=false}else k.lineTo(ja,na)}return{draw:function(){k.fill();k.stroke()}}},getContext:function(){return k},getDimensions:function(){return{width:g,height:l}},getViewport:function(){return B}})});qb("dom",function(a,e,c,b){var d=typeof e.style["-webkit-transform"]!="undefined",g=null;
g=document.createElement("div");g.id=COG.objId("domImages");g.style.cssText=COG.formatStr("position: absolute; overflow: hidden; width: {0}px; height: {1}px;",e.offsetWidth,e.offsetHeight);e.insertBefore(g,b.interactTarget);var l=COG.extend(b,{drawTiles:function(y){var k,B;k=l.getViewport();for(var V=k.x1,Z=k.y1,I,aa,C=y.length;C--;){k=y[C];B=k.image;I=k.x-V;aa=k.y-Z;if(!B){B=k.image=new Image;B.src=k.url;g.appendChild(B);B.style.cssText="-webkit-user-select: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; position: absolute;"}if(d)B.style["-webkit-transform"]=
"translate3d("+I+"px, "+aa+"px, 0px)";else{B.style.left=I+"px";B.style.top=aa+"px"}B.style.display="block"}}});return l});var sb={},Jb=D.defineStyle=function(a,e){sb[a]=o(e);return a},tb=D.defineStyles=function(a){for(var e in a)Jb(e,a[e])},Ib=D.getStyle=function(a){return sb[a]};D.loadStyles=function(a){COG.jsonp(a,function(e){tb(e)})};tb({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"},waypointsHover:{lineWidth:4,
strokeStyle:"#f00",fillStyle:"#FFF"}});var Db={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},wa=function(a){a=COG.extend({style:null,xy:null,size:null,fill:false,stroke:true,draggable:false,observable:true,properties:{},type:"shape"},a);COG.extend(this,a);this.id=COG.objId(this.type);this.view=this.bounds=null;this.rotation=this.animations=0;this.scaling=1;this.translateY=this.translateX=0;this.observable&&COG.observable(this)};wa.prototype={constructor:wa,animate:function(a,e,c,b){Q(this,
a,e,c,b)},drag:null,prep:function(){},resync:function(a){if(this.xy){a.syncXY([this.xy]);this.size&&this.updateBounds(F.fromCenter(this.xy.x,this.xy.y,this.size,this.size))}},rotate:function(a){this.rotation=a},scale:function(a){this.scaling=a},translate:function(a,e){this.translateX=a;this.translateY=e},updateBounds:function(a,e){this.bounds=a;if(e)this.xy=F.center(this.bounds)}};var Eb=1E3/60|0,La=[],mb=0;O.prototype=COG.extend(wa.prototype,{constructor:O,prep:function(a){return a.arc(this.xy.x,
this.xy.y,this.size>>1,0,Math.PI*2)}});fa.prototype=COG.extend({},wa.prototype,{constructor:fa});ma.prototype=COG.extend({},fa.prototype);ia.prototype=COG.extend({},wa.prototype,{constructor:ia});ua.prototype=COG.extend({},ia.prototype,{constructor:ua});N.prototype={constructor:N,shouldDraw:function(a){return(a&this.validStates)!==0},clip:null,cycle:function(){},draw:function(){},hitGuess:null};var ub=function(a){a=COG.extend({zindex:10},a);var e=[],c=CANI.canvas.pipTransformed,b=COG.extend(new N(a),
{draw:function(d,g,l,y,k){y=d.getViewport();l=y.x1;y=y.y1;for(var B=k?c?k.x-l:k.relXY.x:0,V=k?c?k.y-y:k.relXY.y:0,Z=e.length;Z--;){var I=e[Z],aa=I.style||b.style,C,E=d.applyTransform(I,l,y);if(drawData=I.prep(d,E?E.x:l,E?E.y:y,g)){if(k&&d.hitTest(drawData,B,V)){k.elements.push(Hits.initHit(I.type,I,I.draggable?I.drag:null));C=k.type+"Style";aa=I[C]||b[C]||aa}I=aa?d.applyStyle(aa):null;drawData.draw(l,y,g);I&&d.applyStyle(I)}E&&E.undo&&E.undo()}},getDrawables:function(){return[]},hitGuess:function(d,
g){for(var l=false,y=e.length;!l&&y--;){var k=e[y];if(!(l=l))l=(k=k.bounds)&&d>=k.x1&&d<=k.x2&&g>=k.y1&&g<=k.y2;l=l}return l}});b.bind("refresh",function(d,g,l){e=b.getDrawables(g,l)});return b},vb=function(a){function e(g){for(var l=b.length;l--;)b[l].resync(g);b.sort(function(y,k){var B=k.xy.y-y.xy.y;return B!=0?B:k.xy.x-y.xy.y});g.redraw=true}function c(g,l){e(l)}a=COG.extend({zindex:10},a);var b=[],d=COG.extend(new ub(a),{add:function(g,l){if(g){g.layer=d;var y=d.view;if(y){g.resync(y);y.redraw=
true}if(l)b.unshift(g);else b[b.length]=g}},clear:function(){b=[]},find:function(){return[].concat(b)},getDrawables:function(){return b}});d.bind("parentChange",c);d.bind("resync",c);return d};COG.extend(D,{ex:COG.extend,ticks:M,getConfig:x,userMessage:function(a,e,c){D.trigger("userMessage",a,e,c)},XY:A,XYRect:F,Dimensions:oa,Vector:T,Hits:Hits,Generator:ob,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,viewState:s,View:function(a){function e(j,n,v){xa||Fa(ka-n,la-v)}
function c(j,n,v,L){na(S(G(qa+K(2,L)-1,0.5),2))}function b(){var j=u(qa)/Math.LN2|0;if(j!==0){qa=K(2,j);Ra(Ma+j,Kb,Lb)}P.redraw=true}function d(j,n){var v=P.getViewport(),L=1/qa;return A.init(v?v.x1+j*L:j,v?v.y1+n*L:n)}function g(j,n,v){Ea("doubleTap",n,v,d(v.x,v.y));a.scalable&&na(2,v,a.zoomEasing,null,a.zoomDuration)}function l(j,n,v){xa=null;Y("down",n,v)}function y(j,n,v){Y("hover",n,v)}function k(j,n,v){C(n,v,false)}function B(j,n,v){C(n,v,true)}function V(){clearTimeout(wb);wb=setTimeout(function(){renderer.checkSize()},
250)}function Z(j,n,v){Y("tap",n,v);Ea("tap",n,v,d(v.x,v.y,true))}function I(j,n){n.id=j;n.added=M();n.view=P;n.trigger("parentChange",P,Ta,Mb);ba.push(n);ba.sort(function(v,L){var W=L.zindex-v.zindex;if(W===0)W=L.added-v.added;return W});Aa=ba.length;return n}function aa(){ra&&ra.unbind();if(renderer){ra=INTERACT.watch(renderer.interactTarget);a.pannable&&ra.pannable().bind("pan",e);if(a.scalable){ra.bind("zoom",c);ra.bind("doubleTap",g)}ra.bind("pointerDown",l);ra.bind("pointerMove",k);ra.bind("pointerUp",
B);a.captureHover&&ra.bind("pointerHover",y);ra.bind("tap",Z)}}function C(j,n,v){if(xa){j=d(n.x,n.y);if(xa.drag.call(xa.target,xa,j.x,j.y,v))P.redraw=true;if(v)xa=null}}function E(j){var n;n=false;j=j?j:(new Date).getTime();if(n=j-xb>Nb){P.trigger("enterFrame",j,Ob++);j-yb>Pb&&ja();xb=j}if(n&&P.redraw){n=ka!==Ya||la!==Za;ya=zb|(qa!==1?Ab:0)|(n?$a:0)|(ab?bb:0);cb=(n=(ya&(Ab|$a))!==0)&&(ya&bb)===0;if(renderer.prepare(ba,ya,j,sa)){n=renderer.getViewport();for(var v=Aa;v--;){ya|=ba[v].animated?bb:0;ba[v].cycle(j,
n,ya)}for(v=ba.length;v--;){var L=ba[v];if(L.shouldDraw(ya,n)){var W=L.style?renderer.applyStyle(L.style):null;L.draw(renderer,ya,P,j,sa);W&&renderer.applyStyle(W)}}}if(sa){j=sa?sa.elements:[];if(Na&&Na.type==="hover"){n=Hits.diffHits(Na.elements,j);n.length>0&&Hits.triggerEvent(Na,P,"Out",n)}if(j.length>0){v=sa.x;L=sa.y;for(n=j.length;n--;){W=j[n];var Ba=v,Ga=L,za=W&&W.drag&&(!W.canDrag||W.canDrag(W,Ba,Ga));if(za){xa=W;xa.startX=Ba;xa.startY=Ga}if(za)break}Hits.triggerEvent(sa,P)}Na=j.length>0?COG.extend({},
sa):null;sa=null}Ya=ka;Za=la;P.redraw=false}animFrame(E)}function Y(j,n,v){sa=Hits.init(j,n,v,d(v.x,v.y,true));for(j=Aa;j--;)db=db||(ba[j].hitGuess?ba[j].hitGuess(sa.x,sa.y,ya,P):false);if(db)P.redraw=true}function U(){P.redraw=true}function ha(){var j;if(renderer){j=renderer.getViewport();if(!j){j=renderer.getDimensions();j=F.init(ka,la,ka+j.width,la+j.height)}}return j}function ja(){var j=renderer?renderer.getViewport():null;if(j){if(Ia||Ja)if(j){var n=Ua?ka+Oa:ka,v=Va?la+Pa:la,L=j.width,W=j.height;
if(Ia&&Ia>L)if(n+L>Ia)ka=Ua?ka:Ia-L;else if(n<0)ka=Ua?ka:0;if(Ja&&Ja>W)if(v+W>Ja)la=Va?la:Ja-W;else if(v<0)la=Va?la:0}yb=(new Date).getTime();Ea("refresh",P,j);P.redraw=true}}function na(j,n,v,L,W){if(v)COG.tweenValue(qa,j,v,W,function(Ba,Ga){qa=Ba;if(Ga){var za=J(u(qa)/Math.LN2);qa=K(2,za);L&&L()}b()});else{qa=j;b()}return P}function Ra(j,n,v){j=G(a.minZoom,S(a.maxZoom,j));if(j!==Ma){var L=K(2,j-Ma),W=Oa/L|0,Ba=Pa/L|0;Ma=j;Fa(((n?n:ka+Oa)-W)*L,((v?v:la+Pa)-Ba)*L);Ya=ka;Za=la;Ea("zoomLevelChange",
j);qa=1;ja();P.redraw=true}}function Ea(){for(var j=P.trigger.apply(null,arguments).cancel,n=ba.length;n--;)j=ba[n].trigger.apply(null,arguments).cancel||j;return!j}function Fa(j,n,v,L,W){function Ba(){Ga+=1;if(Ga>=2){ab=false;W&&W()}}var Ga=0,za=eb?A.offset(eb,-Oa,-Pa):null,Qa=fb?A.offset(fb,-Oa,-Pa):null;if(za){j=j<za.x?za.x:j;n=n<za.y?za.y:n}if(Qa){j=j>Qa.x?Qa.x:j;n=n>Qa.y?Qa.y:n}if(v){if((ya&$a)===0){COG.tweenValue(ka,j,v,L,function(gb,hb){ka=gb|0;(hb?Ba:U)();return!cb});COG.tweenValue(la,n,v,
L,function(gb,hb){la=gb|0;(hb?Ba:U)();return!cb});ab=true}}else{ka=j|0;la=n|0;P.redraw=true;W&&W()}}a=COG.extend({id:COG.objId("view"),container:"",captureHover:true,captureDrag:false,fastDraw:false,inertia:true,minRefresh:1E3,pannable:false,clipping:true,scalable:false,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,turbo:false,fps:25,minZoom:1,maxZoom:1,renderer:"canvas",zoomEasing:COG.easing("quad.out"),zoomDuration:300,
zoomLevel:1},a);var Sa={},ba=[],Aa=0,Ta=document.getElementById(a.container),xa=null,Ob=0,Mb=null,Qb=typeof window.attachEvent!="undefined",db=false,Pb=a.minRefresh,ka=0,la=0,Ya=0,Za=0,Ia=null,Ja=null,Ua=false,Va=false,Bb=1,Oa=0,Pa=0,sa=null,cb=false,eb=null,fb=null,yb=0,Na=null,wb=0,qa=1,xb=0,ra=null,ab=false,Nb=1E3/a.fps|0,Kb,Lb,Ma=a.zoomLevel,zb=s("ACTIVE"),$a=s("PAN"),Ab=s("ZOOM"),bb=s("ANIMATING"),ya=zb,P={id:a.id,deviceScaling:Bb,fastDraw:a.fastDraw||x().requireFastDraw,detach:function(){ra&&
ra.unbind()},eachLayer:function(j){for(var n=Aa;n--;)j(ba[n])},getLayer:function(j){for(var n=0;n<Aa;n++)if(ba[n].id===j)return ba[n];return null},getZoomLevel:function(){return Ma},setLayer:function(j,n){for(var v=0;v<Aa;v++)if(ba[v].id===j){ba.splice(v,1);break}if(n){I(j,n);n.trigger("refresh",P,ha())}P.redraw=true;return n},invalidate:U,refresh:ja,resetScale:function(){qa=1},scale:na,setZoomLevel:Ra,syncXY:function(){},triggerAll:Ea,removeLayer:function(j){a:{for(var n=Aa;n--;)if(ba[n].id===j){j=
n;break a}j=-1}if(j>=0&&j<Aa){P.trigger("layerRemoved",ba[j]);ba.splice(j,1);P.redraw=true}Aa=ba.length},getOffset:function(){return A.init(ka,la)},getScaleFactor:function(){return qa},setMaxOffset:function(j,n,v,L){Ia=j;Ja=n;Ua=typeof v!="undefined"?v:false;Va=typeof L!="undefined"?L:false},getViewport:ha,updateOffset:Fa,pan:function(j,n,v,L,W){Fa(ka+j,la+n,v,L,W)}};Bb=x().getScaling();COG.observable(P);P.bind("resync",function(){fb=eb=null});COG.configurable(P,["container","captureHover","captureDrag",
"scalable","pannable","inertia","minZoom","maxZoom","zoom"],COG.paramTweaker(a,null,{container:function(j,n){Ta=document.getElementById(n);renderer=rb(a.renderer,P,Ta);aa()},inertia:aa,captureHover:aa,scalable:aa,pannable:aa}),true);CANI.init(function(j){P.markers=I("markers",new vb({zindex:20}));Sa=j;renderer=rb(a.renderer,P,Ta);aa();Qb?window.attachEvent("onresize",V):window.addEventListener("resize",V,false)});animFrame(E);return P},ViewLayer:N,ImageLayer:function(a,e){function c(y,k){var B=d?
Math.abs(d.x1-k.x1)+Math.abs(d.y1-k.y1):0;if(b&&(!d||B>256))b(y,k,function(V){d=F.copy(k);g=[].concat(V)})}e=COG.extend({imageLoadArgs:{}},e);var b=a?ob.init(a,e).run:null,d=null,g=[],l=COG.extend(new N(e),{draw:function(y){y.drawTiles(g)}});l.bind("refresh",function(y,k,B){c(k,B)});return l},ImageGenerator:function(a){a=COG.extend({relative:false,padding:2},a);a={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(a);return a},Drawable:wa,Marker:O,Poly:fa,
Line:ma,ImageDrawable:ia,ImageMarker:ua,DrawLayer:ub,ShapeLayer:vb});COG.observable(D)})(T5);
