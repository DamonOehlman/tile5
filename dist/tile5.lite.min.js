COG=function(){var j=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,k=0,e={id:"grunt.core",extend:function(){var b=arguments[0]||{},c=1,f=arguments.length,d=false,i,a,g,h;if(typeof b==="boolean"){d=b;b=arguments[1]||{};c=2}if(typeof b!=="object"&&!e.isFunction(b))b={};if(f===c){b=this;--c}for(;c<f;c++)if((i=arguments[c])!=null)for(a in i){g=b[a];h=i[a];if(b!==h)if(d&&h&&(e.isPlainObject(h)||e.isArray(h))){g=g&&(e.isPlainObject(g)||e.isArray(g))?g:e.isArray(h)?[]:{};b[a]=e.extend(d,g,h)}else if(h!==
undefined)b[a]=h}return b},isFunction:function(b){return toString.call(b)==="[object Function]"},isArray:function(b){return toString.call(b)==="[object Array]"},isPlainObject:function(b){if(!b||toString.call(b)!=="[object Object]"||b.nodeType||b.setInterval)return false;if(b.constructor&&!m.call(b,"constructor")&&!m.call(b.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in b);return c===undefined||m.call(b,c)},isEmptyObject:function(b){for(var c in b)return false;return true},isXmlDocument:function(b){return toString.call(b)===
"[object Document]"},contains:function(b,c){var f=b,d=arguments,i=1;if(c&&e.isArray(c)){d=c;i=0}for(i=i;i<d;i++)f=f&&typeof foo[d[i]]!=="undefined";return f},newModule:function(b){b=e.extend({id:null,requires:[],parent:null},b);if(b.parent)b=e.extend({},b.parent,b);return b},toID:function(b){return b.replace(/\s/g,"-")},objId:function(b){return(b?b:"obj")+k++},formatStr:function(b){if(arguments.length<=1)return b;for(var c=arguments.length-2,f=0;f<=c;f++)b=b.replace(RegExp("\\{"+f+"\\}","gi"),arguments[f+
1]);return b},wordExists:function(b,c){var f="";if(c.toString)c=c.toString();for(var d=0;d<c.length;d++)f+=!/\w/.test(c[d])?"\\"+c[d]:c[d];return RegExp("(^|\\s|\\,)"+f+"(\\,|\\s|$)","i").test(b)},parseTemplate:function(b,c){for(var f=j.exec(b);f;){b=b.replace(f[0],COG.XPath.first(f[1],c));j.lastIndex=0;f=j.exec(b)}return b}};return e}();
COG.Log=function(){function j(c,f){var d,i=f&&f.length>0?f[0]:"";for(d=1;f&&d<f.length;d++)i+=" "+(k&&COG.isPlainObject(f[d])?JSON.stringify(f[d]):f[d]);typeof console!=="undefined"&&console[c](i);for(d=0;d<m.length;d++)m[d].call(b,i,c)}var m=[],k=typeof JSON!=="undefined",e=window.console&&window.console.markTimeline,b={id:"grunt.log",getTraceTicks:function(){return e?(new Date).getTime():null},trace:function(c,f){if(e)console.markTimeline(c+(f?": "+(b.getTraceTicks()-f)+"ms":""))},debug:function(){j("debug",
arguments)},info:function(){j("info",arguments)},warn:function(){j("warn",arguments)},error:function(){j("error",arguments)},exception:function(c){b.error(arguments);for(var f in c)b.info("ERROR DETAIL: "+f+": "+c[f])},watch:function(c,f){try{f()}catch(d){b.exception(d,c)}},throwError:function(c){b.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return b}();
(function(){function j(e,b){e[b]||(e[b]=function(c){return e.configure(b,c)})}function m(e){e.gtConfId=COG.objId("configurable");e.gtConfig={};e.gtConfigFns=[];return e.gtConfig}var k={};COG.paramTweaker=function(e,b,c){return function(f,d){if(typeof d!=="undefined"){if(f in e)e[f]=d;c&&f in c&&c[f](f,d)}else return b&&f in b?b[f](f):e[f]}};COG.configurable=function(e,b,c,f){if(e){e.gtConfId||m(e);var d=e.gtConfId,i=e.gtConfig,a=e.gtConfigFns;k[d]=e;a.push(c);for(c=b.length;c--;){i[b[c]]=true;f&&
j(e,b[c])}if(!e.configure)e.configure=function(g,h){if(i[g]){for(var l=a.length;l--;){var r=a[l](g,h);if(typeof r!=="undefined")return r}return k[d]}return null}}}})();
(function(){function j(m,k){var e=m.gtObsHandlers;e[k]||(e[k]=[]);return e[k]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(k,e){var b=COG.objId("callback");j(m,k).unshift({fn:e,id:b});return b};m.trigger=function(k){var e=j(m,k),b={cancel:false,tickCount:(new Date).getTime()},c;if(!e)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(b);for(var f=e.length;f--&&!b.cancel;)e[f].fn.apply(self,c);return b};m.unbind=
function(k,e){for(var b=j(m,k),c=0;b&&c<b.length;c++)if(b[c].id===e){b.splice(c,1);break}return m}}}}})();(function(){var j={},m=[];COG.addPipe=function(k){k("pipe.test",{});m.push(k)};COG.listen=function(k,e){j[k]||(j[k]=[]);e&&j[k].push(e)};COG.say=function(k,e){var b;for(b=m.length;b--;)m[b](k,e);if(j[k])for(b=j[k].length;b--;)j[k][b](e)}})();
COG.Loopage=function(){function j(h){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},h)}function m(h){d.push(h);k()}function k(){i&&clearTimeout(i);i=setTimeout(e,0);g=true}function e(){for(var h,l=(new Date).getTime(),r=f.length;d.length>0;){var u=d.shift();for(h=r;h--;)if(f[h].id===u){f.splice(h,1);break}g=true;r=f.length}if(g){a=b;for(h=r;h--;)a=f[h].frequency<a?f[h].frequency:a}for(h=r;h--;){u=l-f[h].lastTick;if(f[h].lastTick===0||u>=f[h].frequency){f[h].execute(l,
f[h]);f[h].lastTick=l;f[h].single&&f[h].trigger("complete")}}i=r?setTimeout(e,a):0}var b=6E4,c=0,f=[],d=[],i=0,a=b,g=true;return{join:function(h){var l=new j(h);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});f.unshift(l);k();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function j(a){return a<10?"0"+a:a}function m(a){b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(g){var h=d[g];return typeof h==="string"?h:"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function k(a,g){var h,l,r,u,v=c,o,q=g[a];if(q&&typeof q==="object"&&typeof q.toJSON==="function")q=q.toJSON(a);if(typeof i==="function")q=i.call(g,a,q);switch(typeof q){case "string":return m(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);
case "object":if(!q)return"null";c+=f;o=[];if(Object.prototype.toString.apply(q)==="[object Array]"){u=q.length;for(h=0;h<u;h+=1)o[h]=k(h,q)||"null";r=o.length===0?"[]":c?"[\n"+c+o.join(",\n"+c)+"\n"+v+"]":"["+o.join(",")+"]";c=v;return r}if(i&&typeof i==="object"){u=i.length;for(h=0;h<u;h+=1){l=i[h];if(typeof l==="string")if(r=k(l,q))o.push(m(l)+(c?": ":":")+r)}}else for(l in q)if(Object.hasOwnProperty.call(q,l))if(r=k(l,q))o.push(m(l)+(c?": ":":")+r);r=o.length===0?"{}":c?"{\n"+c+o.join(",\n"+c)+
"\n"+v+"}":"{"+o.join(",")+"}";c=v;return r}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+j(this.getUTCMonth()+1)+"-"+j(this.getUTCDate())+"T"+j(this.getUTCHours())+":"+j(this.getUTCMinutes())+":"+j(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,f,d={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,g,h){var l;f=c="";if(typeof h==="number")for(l=0;l<h;l+=1)f+=" ";else if(typeof h==="string")f=h;if((i=g)&&typeof g!=="function"&&(typeof g!=="object"||typeof g.length!=="number"))throw Error("JSON.stringify");return k("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,g){function h(r,u){var v,o,q=r[u];if(q&&typeof q==="object")for(v in q)if(Object.hasOwnProperty.call(q,v)){o=h(q,v);if(o!==undefined)q[v]=o;else delete q[v]}return g.call(r,u,q)}var l;a=String(a);e.lastIndex=0;if(e.test(a))a=a.replace(e,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+a+")");return typeof g==="function"?h({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function j(k,e){var b=k.split("|"),c={};for(var f in e){var d=e[f];c[f]=b.length>d?b[d]:null}return c}var m={JSON:{parse:function(k){return JSON.parse(k)}},PDON:{parse:function(k){var e=null,b=[];k=k.split("\n");for(var c=0;c<k.length;c++){var f=k[c];if(e)b.push(j(f,e));else if(f){e=f.split("|");f={};for(var d=0;d<e.length;d++)f[e[d]]=d;e=f}else e=null}return b}}};COG.parseData=function(k,e){e=e?e.toUpperCase():"JSON";if(!m[e])throw Error("Unsupported data format: "+e);try{return m[e].parse(k)}catch(b){COG.Log.exception(b)}return{}}})();
COG.XPath=function(){function j(b){for(var c=null,f=0;f<m.length;f++)if(c=m[f](b))break;return c}var m=[],k=[null,function(b){return b.numberValue},function(b){return b.stringValue},function(b){return b.booleanValue},null,null,null,null,function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null},function(b){return b.singleNodeValue?b.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var e={SearchResult:function(b){return{toString:function(){var c=
null;if(b){var f=null;if(b.resultType>=0&&b.resultType<k.length)f=k[b.resultType];if(f)c=f(b)}return c?c:""}}},first:function(b,c){var f=e.SearchResult,d;var i=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!i)i=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))d=c.evaluate(b,c,j,i,null);else{COG.Log.warn("attempted xpath expression: "+b+" on a non-xml document");d=null}}catch(a){COG.Log.warn("invalid xpath expression: "+b+" on node: "+c);d=null}return new f(d)},registerResolver:function(b){m.push(b)}};return e}();
COG.Storage=function(){function j(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,k){var e=j(k).getItem(m);return/^(\{|\[).*(\}|\])$/.test(e)?JSON.parse(e):e},set:function(m,k,e){k=jQuery.isArray(k)||jQuery.isPlainObject(k)?JSON.stringify(k):k;j(e).setItem(m,k)},remove:function(m,k){j(k).removeItem(m)}}}();
COG.ParseRules=function(){var j=[];return{add:function(m,k){j.push({regex:m,handler:k})},each:function(m,k,e){function b(){c++;e&&c>=j.length&&e(k)}for(var c=0,f=0;f<j.length;f++){var d=j[f].regex,i=j[f].handler,a=false;if(d){d.lastIndex=-1;if((d=d.exec(m))&&i){a=true;i(d,k,b)&&b()}}a||b()}}}};
(function(){function j(d){var i=[],a=function(h,l){l=COG.isFunction(l)?l():l;i[i.length]=encodeURIComponent(h)+"="+encodeURIComponent(l)};if(COG.isArray(d))for(var g=0;g<d.length;g++)a(d[g].name,d[g].value);else for(g in d)a(g,d[g]);return i.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},k={JSON:["json"],PDON:["pdon.txt"]},e=["TEXT","STREAM"],b=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(d){return d.responseXML},JSON:function(d){return COG.parseData(d.responseText)},
PDON:function(d){return COG.parseData(d.responseText,"PDON")},DEFAULT:function(d){return d.responseText}},f={CONTENT_TYPE:"Content-Type"};COG.xhr=function(d){function i(){if(this.readyState===4){var l=null,r=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(r)if(d.handleResponse)d.handleResponse(this);else{var u=d,v=this.getResponseHeader(f.CONTENT_TYPE),o,q=false;for(o in m)if(v&&v.indexOf(m[o])>=0){q=true;
break}v=!q;for(q=0;q<e.length;q++)v=v||e[q]==o;if(v)b:{v=o;for(var t in k)for(q=0;q<k[t].length;q++)if(RegExp(k[t][q]+"$","i").test(u.url)){o=t;break b}o=v?v:"DEFAULT"}try{l=c[o](this,u)}catch(x){l=c.DEFAULT(this,u)}}else d.error&&d.error(this)}catch(z){COG.Log.exception(z,"PROCESSING AJAX RESPONSE")}r&&l&&d.success&&d.success.call(this,l)}}try{d=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},d);var a=
b.exec(d.url),g=a&&(a[1]&&a[1]!==location.protocol||a[2]!==location.host);if(d.data)d.method="POST";if(d.url){a=null;if(d.xhr)a=d.xhr(d);a||(a=new XMLHttpRequest);a.open(d.method,d.url,d.async);d.data&&a.setRequestHeader("Content-Type",d.contentType);g||a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.onreadystatechange=i;a.send(d.method=="POST"?j(d.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(h){COG.Log.exception(h)}}})();
(function(){function j(b){var c=document.createElement("script"),f=false;c.src=b;c.async=true;c.onload=c.onreadystatechange=function(){if(!f&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};k||(k=document.getElementsByTagName("head")[0]);k.appendChild(c)}var m=0,k,e=this;COG.jsonp=function(b,c,f){b+=b.indexOf("?")>=0?"&":"?";var d="json"+ ++m;e[d]=function(i){c(i);e[d]=null;try{delete e[d]}catch(a){}};
j(b+(f?f:"callback")+"="+d);return d}})();
COG.Touch=function(){function j(w,A){return{x:w.x-A.x,y:w.y-A.y}}function m(w,A){var C=j(w,A);return Math.sqrt(C.x*C.x+C.y*C.y)}function k(w){if(w.count>1)return m(w.touches[0],w.touches[1]);return 0}function e(w,A){var C=w&&w.count>0?w.touches[0]:null;if(C&&A&&A.count>0)return j(C,A.touches[0]);return null}function b(w,A){w.count=A.count;for(var C=a;C--;){w.touches[C].x=A.touches[C].x;w.touches[C].y=A.touches[C].y}}function c(){for(var w={count:0,touches:Array(a)},A=a;A--;)w.touches[A]=i();return w}
function f(w){if(w.preventDefault){w.preventDefault();w.stopPropagation()}else w.cancelBubble&&w.cancelBubble()}function d(w,A,C){if(F){A=A[C?C:"touches"];C=A.length;for(C=w.count=C;C--;){w.touches[C].x=A[C].pageX;w.touches[C].y=A[C].pageY}}else if(A.button===0){w.count=1;w.touches[0].x=A.pageX?A.pageX:A.screenX;w.touches[0].y=A.pageY?A.pageY:A.screenY}else w.count=0}function i(w,A){return{x:w?w:0,y:A?A:0}}var a=10,g=120,h=g*8,l=100,r=250,u=300,v=5,o=0,q=1,t=2,x=7,z=0,G=0,F=undefined,M=function(w){function A(s,
n,p,y){var B=Math.asin((s.y-n.y)/p);p=p*(fa/y)>>0;p=p>Y?Y:p;B=n.x>s.x?B:Math.PI-B;O("pan",Math.cos(B)*-p,Math.sin(B)*p,true)}function C(s,n){var p,y;if(F){p=n-ga;if(p<r){y=m(H.touches[0],s);y>w.inertiaTrigger&&A(H.touches[0],s,y,p)}}else{P.x=s.x;P.y=s.y;COG.Loopage.join({execute:function(B,D){p=B-n;y=m(s,P);if(p<l&&y>w.inertiaTrigger){D.trigger("complete");A(s,P,y,p)}else p>l&&D.trigger("complete")},frequency:10})}}function na(s){var n=0,p=0;if(s.offsetParent){do{n+=s.offsetLeft;p+=s.offsetTop;s=
s.offsetParent}while(s)}return i(n,p)}function K(s){var n=s.count,p=Array(n),y=na(J);for(n=n;n--;)p[n]=i(s.touches[n].x-y.x,s.touches[n].y-y.y);return p}function O(){oa&&oa.trigger.apply(null,arguments)}function ha(s,n){var p=na(J);p=i(n.x-p.x,n.y-p.y);O(s,n,p)}function ia(s){var n=s.target?s.target:s.srcElement;if(ba||n&&n===J){d(H,s);if(H.count!==0){V=null;T.x=0;T.y=0;ja=true;R=false;ga=(new Date).getTime();f(s);n.style.cursor="move";O("inertiaCancel");ca=ga;if(s=H.count>0?H.touches[0]:null){O("touchStart",
s.x,s.y);if(ca-pa<u)if((s=j(H.touches[0],W.touches[0]))&&Math.abs(s.x)<w.maxDistDoubleTap&&Math.abs(s.y)<w.maxDistDoubleTap)R=true;S=o;b(W,H)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function ka(s){var n=s.target?s.target:s.srcElement,p=0;if(ba||n&&n===J){d(Q,s);if(Q.count>0){P.x=Q.touches[0].x;P.y=Q.touches[0].y}if(ja){F&&f(s);if(Q.count>1){H.count===1&&b(H,Q);p=k(H)-k(Q)}if(S===o)if((s=e(Q,H))&&(Math.abs(s.x)>=x||Math.abs(s.y)>=x))S=q;if(S!==o)if(!p||Math.abs(p)<v){if(V=
e(Q,W)){T.x-=V.x;T.y-=V.y;E.x-=V.x;E.y-=V.y}O("pan",E.x,E.y);E.x=0;E.y=0;S=q}else{O("pinchZoom",K(H),K(Q));S=t}b(W,Q)}}}function la(s){var n=s.target?s.target:s.srcElement;if(ja&&(ba||n&&n===J)){d(ma,s,"changedTouches");var p=ma.touches[0];F&&f(s);s=(new Date).getTime();pa=ca;if(S===o){ha("tap",H.touches[0]);U||(U=setTimeout(function(){U=0;R&&ha("doubleTap",H.touches[0])},u+50))}else if(S==q){O("panEnd",T.x,T.y);da&&C(p,s)}else S==t&&O("pinchZoomEnd",K(H),K(W),s-ga);n.style.cursor="default";ja=false}}
function Z(s){var n=s.target?s.target:s.srcElement;if(ba||n&&n===J){if(s.detail){n=-s.detail*g;n=i(s.axis===1?n:0,s.axis===2?n:0)}else n=i(s.wheelDeltaX,s.wheelDeltaY);n=n.y/h;if(P&&n!==0){var p=i(P.x-J.offsetLeft,P.y-J.offsetTop);O("wheelZoom",p,n)}f(s)}}w=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,doubleTapHandler:null,wheelZoomHandler:null},
w);var R=false,U=0,L=T5.getConfig(),H=c(),Q=c(),W=c(),ma=c(),V=null,T=i(),E=i(),S=null,ja=false,ga=0,ea=[],P=i(),da=false,fa,Y,ca=0,pa=0,J=w.element,oa=w.observable,ba=typeof FlashCanvas!=="undefined",qa={supportsTouch:F,addListeners:function(s){ea.push(s)},decoupleListeners:function(s){for(var n=0;s&&n<ea.length;n++)if(ea[n].listenerId===s){ea.splice(n,1);break}},release:function(){L.unbindEvent(F?"touchstart":"mousedown",ia,false);L.unbindEvent(F?"touchmove":"mousemove",ka,false);L.unbindEvent(F?
"touchend":"mouseup",la,false);if(!F){window.removeEventListener("mousewheel",Z,false);window.removeEventListener("DOMMouseScroll",Z,false)}},inertiaEnable:function(s,n){da=true;fa=s;Y=n?Math.min(n.width,n.height):500},inertiaDisable:function(){da=false}};if(typeof F==="undefined")F=T5.getConfig().supportsTouch;L.bindEvent(F?"touchstart":"mousedown",ia,false);L.bindEvent(F?"touchmove":"mousemove",ka,false);L.bindEvent(F?"touchend":"mouseup",la,false);if(!F){L.bindEvent("mousewheel",Z,window);L.bindEvent("DOMMouseScroll",
Z,window)}return qa},X=[];return{capture:function(w,A){if(!w)throw Error("Unable to capture touch of null element");if(!w.id)w.id="touchable_"+z++;var C=X[w.id];if(!C){C=new M(COG.extend({element:w},A));X[w.id]=C}if(A){A.listenerId&&C.decoupleListeners(A.listenerId);A.listenerId=++G;C.addListeners(A)}return C},release:function(w){if(w&&w.id&&X[w.id]){X[w.id].release();delete X[w.id]}}}}();
T5=function(){var j=function(){function c(i,a){return d(i.x-a.x,i.y-a.y)}function f(i,a){if(!a)a=i.length;if(a<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var g={edges:Array(a-1),accrued:Array(a-1),total:0},h=0;h<a-1;h++){var l=c(i[h],i[h+1]);g.edges[h]=Math.sqrt(l.x*l.x+l.y*l.y);g.accrued[h]=g.total+g.edges[h];g.total+=g.edges[h]}return g}function d(i,a){return{x:i?i:0,y:a?a:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var i=
0,a=0,g=arguments.length;g--;){i+=arguments[g].x;a+=arguments[g].y}return d(i,a)},absSize:function(i){return Math.max(Math.abs(i.x),Math.abs(i.y))},copy:function(i){return i?d(i.x,i.y):null},diff:c,distance:function(i,a){return f(i,a).total},edges:f,equals:function(i,a){return i.x===a.x&&i.y===a.y},extendBy:function(i,a,g){return d(i.x-Math.cos(a)*g,i.y-Math.sin(a)*g)},floor:function(i){for(var a=Array(i.length),g=i.length;g--;)a[g]=d(~~i[g].x,~~i[g].y);return a},getRect:function(i){for(var a,g,h,
l,r=i.length;r--;){var u=i[r];a=typeof a==="undefined"||u.x<a?u.x:a;g=typeof g==="undefined"||u.y<g?u.y:g;h=typeof h==="undefined"||u.x>h?u.x:h;l=typeof l==="undefined"||u.y>l?u.y:l}return k.init(a,g,h,l)},init:d,invert:function(i){return d(-i.x,-i.y)},min:function(i,a){return d(i.x<a.x?i.x:a.x,i.y<a.y?i.y:a.y)},max:function(i,a){return d(i.x>a.x?i.x:a.x,i.y>a.y?i.y:a.y)},offset:function(i,a,g){return d(i.x+a,i.y+(g?g:a))},simplify:function(i,a){if(!i)return null;a=a?a:j.VECTOR_SIMPLIFICATION;for(var g=
[],h=null,l=i.length;l--;){var r=i[l];if(include=!h||l===0||Math.abs(r.x-h.x)+Math.abs(r.y-h.y)>a){g.unshift(r);h=r}}return g},theta:function(i,a,g){g=Math.asin((i.y-a.y)/g);return i.x>a.x?g:Math.PI-g}}}(),m=function(){return{dotProduct:function(c,f){return c.x*f.x+c.y*f.y}}}(),k=function(){function c(d){return f(d.x1,d.y1,d.x2,d.y2)}function f(d,i,a,g){d=d?d:0;i=i?i:0;a=typeof a!=="undefined"?a:d;g=typeof g!=="undefined "?g:g;return{x1:d,y1:i,x2:a,y2:g,width:a-d,height:g-i}}return{center:function(d){return j.init(d.x1+
d.width/2,d.y1+d.height/2)},copy:c,diagonalSize:function(d){return Math.sqrt(d.width*d.width+d.height*d.height)},fromCenter:function(d,i,a,g){a=~~(a/2);g=~~(g/2);return f(d-a,i-g,d+a,i+g)},init:f,intersect:function(d,i){var a=f(Math.max(d.x1,i.x1),Math.max(d.y1,i.y1),Math.min(d.x2,i.x2),Math.min(d.y2,i.y2));return a.width>0&&a.height>0?a:null},union:function(d,i){if(d.width===0||d.height===0)return c(i);else if(i.width===0||i.height===0)return c(d);else{var a=f(Math.min(d.x1,i.x1),Math.min(d.y1,i.y1),
Math.max(d.x2,i.x2),Math.max(d.y2,i.y2));return a.width>0&&a.height>0?a:null}}}}(),e=function(){return{getAspectRatio:function(c){return c.height!==0?c.width/c.height:1},getCenter:function(c){return j.init(c.width/2,c.height/2)},getSize:function(c){return Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2))},init:function(c,f){c=c?c:0;return{width:c,height:f?f:c}}}}(),b={ex:COG.extend,ticks:function(){return(new Date).getTime()},userMessage:function(c,f,d){b.trigger("userMessage",c,f,d)},XY:j,XYRect:k,
Vector:function(c,f){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return j.init(c,f)},V:COG.extend(j,m),D:e};COG.observable(b);return b}();
(function(){function j(){for(;u.length>0;){var o=u.shift();document.location=o}r=0}function m(o){for(var q=true,t=v.length;t--;)q=q&&o!=v[t];return q}function k(o,q){var t=[];for(var x in q)x&&t.push(x+"="+escape(q[x]));return"tile5://"+o+"/"+(t.length>0?"?"+t.join("&"):"")}function e(o,q){m(o)&&COG.Log.info("would push url: "+k(o,q))}function b(o,q){if(m(o)){u.push(k(o,q));r||(r=setTimeout(j,100))}}function c(o){return function(q,t,x){(x?x:o?document.body:document).addEventListener(q,t,false)}}function f(o){return function(q,
t,x){(x?x:o?document.body:document).removeEventListener(q,t,false)}}function d(o,q,t){(t?t:document).attachEvent("on"+o,q)}function i(o,q,t){(t?t:document).detachEvent("on"+o,q)}function a(){g={base:{name:"Unknown",bindEvent:c(),unbindEvent:f(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:e,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:d,unbindEvent:i,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:b,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:b},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:b},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:f(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:b},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:b}};h=[g.froyo,g.android,g.ipod,g.iphone,g.ipad,g.ie]}var g=null,h=[],l=null,r=0,u=[],v=["view.wake","tile.loaded"];T5.getConfig=function(){g||a();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var o=0;o<h.length;o++){var q=h[o];if(q.regex&&q.regex.test(navigator.userAgent)){l=T5.ex({},g.base,q);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=g.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var j=[],m={execute:function(k){var e=m.findAction(k);e&&e.execute.apply(e,Array.prototype.slice.call(arguments,1))},findAction:function(k){for(var e=j.length;e--;)if(j[e].id==k)return j[e];return null},getRegisteredActions:function(){return[].concat(j)},getRegisteredActionIds:function(){for(var k=[],e=j.length;e--;)j[e].id&&k.push(j[e].id);return k},registerAction:function(k){k&&k.id&&j.push(k)},Action:function(k){k=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},k);var e={id:k.id,execute:function(){k.execute&&k.execute.apply(this,arguments)},getParam:function(b){return k[b]?k[b]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",e.id,k.title,k.icon)}};k.autoRegister&&m.registerAction(e);return e},Agent:function(k){k=COG.extend({name:"Untitled",translator:null,execute:null},k);var e={getName:function(){return k.name},getParam:function(b){return k[b]},getId:function(){return COG.toID(e.getName())},run:function(b,c){if(k.execute){var f=
k.translator?k.translator(b):b;k.execute.call(e,f,function(d,i){c&&c(d,i,f)})}}};return e},runAgents:function(k,e,b){for(var c=0;c<k.length;c++)k[c].run(e,b)}};return m}();
T5.Resources=function(){var j="",m={},k={getPath:function(e){return/^(file|https?|\/)/.test(e)?e:j+e},setBasePath:function(e){j=e},loadResource:function(e){e=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},e);var b=function(c){e.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){e.callback(c)})};e.cacheable&&m[e.filename]?b(m[e.filename]):COG.xhr({url:k.getPath(e.filename),dataType:e.dataType,success:function(c){if(e.cacheable)m[e.filename]=c;b(c)},error:function(c,f,d){COG.Log.error("error loading resource ["+
e.filename+"], error = "+d)}})},loadSnippet:function(e,b){/\.\w+$/.test(e)||(e+=".html");k.loadResource({filename:"snippets/"+e,callback:b,dataType:"html"})}};return k}();
T5.Images=function(){function j(){if(!r){var o=T5.getConfig().maxImageLoads;r=COG.Loopage.join({execute:function(q,t){if(!o||g.length<o){var x=a.shift();if(x){g[g.length]=x;x.image.onload=k;x.image.src=T5.Resources.getPath(x.url);x.requested=T5.ticks()}else t.trigger("complete")}},frequency:10});r.bind("complete",function(){r=null})}}function m(){u=true;try{var o=h.length/2>>0;if(o>0){h.sort(function(t,x){return t.created-x.created});for(var q=o;q--;)delete c[h[q].url];h.splice(0,o)}}finally{u=false}COG.say("imagecache.cleared")}
function k(){var o=d[this.id],q;if(o&&o.image.complete&&o.image.width>0){o.loaded=true;o.hitCount=1;for(q=g.length;q--;)if(g[q].image.src==this.src){g.splice(q,1);break}if(o.background||o.postProcess||o.drawBackground||o.customDraw)if(o.image){globalImageData=o;q=b(o.realSize?o.realSize.width:o.image.width,o.realSize?o.realSize.height:o.image.height);var t=q.getContext("2d"),x=o.offset?o.offset:T5.XY.init();o.background&&t.drawImage(o.background,0,0);o.drawBackground&&o.drawBackground(t);o.customDraw?
o.customDraw(t,o):t.drawImage(o.image,x.x,x.y);o.postProcess&&o.postProcess(t,o);o.image=q}for(q=o.callbacks.length;q--;)o.callbacks[q]&&o.callbacks[q](this,false);o.callbacks=[];h[h.length]={url:this.src,created:o.requested};delete d[this.id];j()}}function e(o,q,t){var x=c[o];if(x){x.hitCount++;x.image.complete&&x.image.width>0&&q?q(x.image,true):x.callbacks.push(q)}else{x=T5.ex({url:o,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[q]},t);x.image.id="resourceLoaderImage"+
i++;c[o]=x;d[x.image.id]=x;a[a.length]=x;j()}return x}function b(o,q){var t=document.createElement("canvas");t.width=o?o:0;t.height=q?q:0;if(typeof FlashCanvas!=="undefined"){t.id="tmpCanvas"+f++;t.style.cssText="position: absolute; top: -"+(q-1)+"px; left: -"+(o-1)+"px;";document.body.appendChild(t);FlashCanvas.initElement(t)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(t);return t}var c={},f=0,d={},i=0,a=[],g=[],h=[],l=0,r=null,u=false,v={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){g=[]},get:function(o,q,t){var x=null,z=null;u||(x=c[o]);if((z=x?x.image:null)&&(z.getContext||z.complete&&z.width>0))return z;else q&&e(o,q,t);return null},load:e,newCanvas:b,reset:function(){c={}},stats:function(){return{imageLoadingCount:g.length,queuedImageCount:a.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(o){for(var q=false,t=0,x=T5.getConfig();t<g.length;)if(o-g[t].requested>v.loadTimeout*1E3){g.splice(t,1);q=true}else t++;q&&j();if(x&&x.imageCacheMaxSize){l=
h.length*v.avgImageSize/x.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return v}();T5.Generator=function(){var j={};return{init:function(m,k){var e=j[m];if(!e)throw Error("Unable to locate requested generator: "+m);return new e(k)},register:function(m,k){j[m]=k},Template:function(){}}}();
T5.TimeLord=function(){var j=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,k=function(b,c){return{days:b?b:0,seconds:c?c:0}},e={8601:function(b){b=b.split("T");var c=null;c=null;var f=0,d=0;j.lastIndex=-1;c=j.exec(b[0]);f+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(b[1]);d+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;d+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;d+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new k(f,d)}};return{Duration:k,addDuration:function(){for(var b=new k,
c=arguments.length;c--;){b.days+=arguments[c].days;b.seconds+=arguments[c].seconds}if(b.seconds>=86400){b.days+=~~(b.seconds/86400);b.seconds%=86400}return b},parseDuration:function(b,c){var f=c?e[c]:null;if(f)return f(b);COG.Log.warn("Could not find duration parser for specified format: "+c);return new k},formatDuration:function(b){var c,f,d="";if(b.days)d=b.days+" days ";if(b.seconds){b=b.seconds;if(b>=3600){c=~~(b/3600);b-=c*3600}if(b>=60){f=Math.round(b/60);b-=f*60}if(c)d=d+c+(c>1?" hrs ":" hr ")+
(f?(f>10?f:"0"+f)+" min ":"");else if(f)d=d+f+" min";else if(b>0)d=d+(b>10?b:"0"+b)+" sec"}return d}}}();
T5.zoomable=function(j,m){function k(b,c){if(b&&e!==b){e=b;j.triggerAll("zoomLevelChange",e,c)}}m=T5.ex({initial:1,min:0,max:null,zoomAnimation:T5.easing("quad.out")},m);var e=m.initial;T5.ex(j,{getZoomLevel:function(){return e},setZoomLevel:k,zoomIn:function(){j.scale(2,T5.easing("sine.out"))||j.setZoomLevel(e+1)},zoomOut:function(){j.scale(0.5,T5.easing("sine.out"))||j.setZoomLevel(e-1)}});j.bind("scale",function(b,c,f){j.updateOffset(f.x*c,f.y*c);b=Math.log(c)/Math.LN2;COG.Log.info("scale amount = "+
c+", zoom change = "+b+", zooming at ",f);T5.cancelAnimation(function(d){return d.cancelOnInteract});COG.Log.info("new zoom level = "+(e+b));k(e+b,f)});j.bind("doubleTap",function(b,c,f){if(j.scalable()){T5.cancelAnimation(function(d){return d.cancelOnInteract});j.scale(2,T5.XY.init(f.x,f.y))}})};
(function(){var j=Math.PI*2,m=Math.PI/2,k=Math.abs,e=Math.pow,b=Math.sin,c=Math.asin,f=Math.cos,d=1.70158,i={linear:function(a,g,h,l){return h*a/l+g},backin:function(a,g,h,l){return h*(a/=l)*a*((d+1)*a-d)+g},backout:function(a,g,h,l){return h*((a=a/l-1)*a*((d+1)*a+d)+1)+g},backinout:function(a,g,h,l){return(a/=l/2)<1?h/2*a*a*(((d*=1.525)+1)*a-d)+g:h/2*((a-=2)*a*(((d*=1.525)+1)*a+d)+2)+g},bouncein:function(a,g,h,l){return h-i.bounceout(l-a,0,h,l)+g},bounceout:function(a,g,h,l){return(a/=l)<1/2.75?
h*7.5625*a*a+g:a<2/2.75?h*(7.5625*(a-=1.5/2.75)*a+0.75)+g:a<2.5/2.75?h*(7.5625*(a-=2.25/2.75)*a+0.9375)+g:h*(7.5625*(a-=2.625/2.75)*a+0.984375)+g},bounceinout:function(a,g,h,l){return a<l/2?i.bouncein(a*2,0,h,l)/2+g:i.bounceout(a*2-l,0,h,l)/2+h/2+g},cubicin:function(a,g,h,l){return h*(a/=l)*a*a+g},cubicout:function(a,g,h,l){return h*((a=a/l-1)*a*a+1)+g},cubicinout:function(a,g,h,l){if((a/=l/2)<1)return h/2*a*a*a+g;return h/2*((a-=2)*a*a+2)+g},elasticin:function(a,g,h,l,r,u){if(a==0)return g;if((a/=
l)==1)return g+h;u||(u=l*0.3);if(!r||r<k(h)){r=h;h=u/4}else h=u/j*c(h/r);return-(r*e(2,10*(a-=1))*b((a*l-h)*j/u))+g},elasticout:function(a,g,h,l,r,u){var v;if(a==0)return g;if((a/=l)==1)return g+h;u||(u=l*0.3);if(!r||r<k(h)){r=h;v=u/4}else v=u/j*c(h/r);return r*e(2,-10*a)*b((a*l-v)*j/u)+h+g},elasticinout:function(a,g,h,l,r,u){var v;if(a==0)return g;if((a/=l/2)==2)return g+h;u||(u=l*0.3*1.5);if(!r||r<k(h)){r=h;v=u/4}else v=u/j*c(h/r);if(a<1)return-0.5*r*e(2,10*(a-=1))*b((a*l-v)*j/u)+g;return r*e(2,
-10*(a-=1))*b((a*l-v)*j/u)*0.5+h+g},quadin:function(a,g,h,l){return h*(a/=l)*a+g},quadout:function(a,g,h,l){return-h*(a/=l)*(a-2)+g},quadinout:function(a,g,h,l){if((a/=l/2)<1)return h/2*a*a+g;return-h/2*(--a*(a-2)-1)+g},sinein:function(a,g,h,l){return-h*f(a/l*m)+h+g},sineout:function(a,g,h,l){return h*b(a/l*m)+g},sineinout:function(a,g,h,l){return-h/2*(f(Math.PI*a/l)-1)+g}};T5.easing=function(a){return i[a.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(a,g){i[a.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=g}})();
T5.Tween=function(j){j=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},j);var m=T5.ticks(),k=[],e=false,b=0,c=0,f={cancelOnInteract:j.cancelOnInteract,isComplete:function(){return e},triggerComplete:function(d){j.complete&&j.complete(d)},update:function(d){try{var i=j.tweenFn(d-m,b,c,j.duration);if(j.target)j.target[j.property]=i;for(var a=k.length;a--;)k[a](i,void 0);if(e=m+j.duration<=d){if(j.target)j.target[j.property]=
j.tweenFn(j.duration,b,c,j.duration);for(var g=k.length;g--;)k[g](i,true)}}catch(h){COG.Log.exception(h)}},requestUpdates:function(d){k.push(d)}};b=j.target&&j.property&&j.target[j.property]?j.target[j.property]:j.startValue;if(typeof j.endValue!=="undefined")c=j.endValue-b;if(c==0)e=true;T5.wakeTweens();return f};
(function(){function j(b){if(e)return m.length;e=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(b);c++}}finally{e=false}m.length===0&&k.trigger("complete");return m.length}var m=[],k=null,e=false;T5.tweenValue=function(b,c,f,d,i){b=new T5.Tween({startValue:b,endValue:c,tweenFn:f,complete:d,duration:i});m.push(b);return b};T5.tween=function(b,c,f,d,i,a){b=new T5.Tween({target:b,property:c,endValue:f,tweenFn:d,duration:a,complete:i});
m.push(b);return b};T5.tweenVector=function(b,c,f,d,i,a){var g=[];if(b){var h=b.x==c,l=b.y==f;h||g.push(T5.tween(b,"x",c,d,function(){(h=true)&&l&&i()},a));l||g.push(T5.tween(b,"y",f,d,function(){l=true;h&&l&&i()},a))}return g};T5.cancelAnimation=function(b){if(!e){e=true;try{for(var c=0;c<m.length;)if(!b||b(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{e=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!k){k=COG.Loopage.join({execute:j,frequency:20});
k.bind("complete",function(){k=null})}}})();(function(){var j={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,k=arguments.length;k--;){var e=j[arguments[k].toUpperCase()];if(e)m|=e}return m}})();
T5.ViewLayer=function(j){j=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},j);var m=null,k=false,e=false,b=j.supportFastDraw,c=j.id,f=T5.viewState("ACTIVE"),d=j.validStates,i=0,a=0,g=T5.ex({addToView:function(h){h.setLayer(c,g)},shouldDraw:function(h,l,r){return(e||r||i!==l.x1||a!==l.y1)&&(h&d)!==0&&(k?b:true)},clip:null,cycle:function(){},draw:function(){},remove:function(){g.trigger("remove",
g)},changed:function(h){e=true;g.trigger("changed",g);m&&m.trigger("invalidate",h)},getId:function(){return c},setId:function(h){c=h},getParent:function(){return m},setParent:function(h){k=(m=h)?m.fastDraw&&displayState!==f:false;g.trigger("parentChange",m)}},j);COG.observable(g);g.bind("drawComplete",function(h,l){e=false;i=l.x1;a=l.y1});g.bind("resync",function(h,l){if(l.syncXY){g.minXY&&l.syncXY(g.minXY);g.maxXY&&l.syncXY(g.maxXY)}});return g};
T5.View=function(j){function m(n,p,y,B){J=Y;v();if(B&&j.inertia)i(F+p,M+y,j.panAnimationEasing,j.panAnimationDuration);else B||i(F+p,M+y)}function k(){J=fa;R=false;COG.Loopage.join({execute:v,after:50,single:true})}function e(n,p,y){T||(T=[].concat(y));n=oa(T);qa(n);p=ba(n);var B=oa(y);y=qa(B);B=ba(B);f(y);E=n&&p!==0?B/p:1;c()}function b(n,p,y){s.zoom(T5.D.getCenter(K),y)}function c(n){l();var p=T5.XY.init(P-(w.width/(E*2)>>0),da-(w.height/(E*2)>>0)),y=Math.log(E)/Math.LN2>>0;if(E!==1)J=ca;COG.Log.info("scale factor = "+
E+", exp = "+y);if(y!==0){E=Math.pow(2,y);for(n=t.length;n--;)t[n].trigger("scale",E,p);s.trigger("scale",E,p);E=1;T=null;J=fa;n=true}v(n)}function f(n){ka=T5.XY.init(F,M);la=T5.XY.offset(n,F,M)}function d(){clearTimeout(V);V=setTimeout(a,50)}function i(n,p,y,B,D){function I(){N+=1;if(N>=2){k(0,0);D&&D()}}var N=0,$=L?T5.XY.offset(L,-ha,-ia):null,aa=H?T5.XY.offset(H,-ha,-ia):null;if($){n=n<$.x?$.x:n;p=p<$.y?$.y:p}if(aa){n=n>aa.x?aa.x:n;p=p>aa.y?aa.y:p}if(y){if(!R){n=T5.tweenValue(F,n,y,I,B);p=T5.tweenValue(M,
p,y,I,B);n.cancelOnInteract=true;n.requestUpdates(function(ra){F=ra>>0;R=true;v()});p.cancelOnInteract=true;p.requestUpdates(function(ra){M=ra>>0;R=true;v()})}}else{F=n>>0;M=p>>0}}function a(){var n;if(z){COG.Touch.release(z);if(j.autoSize&&z.parentNode){n=z.parentNode.getBoundingClientRect();if(n.height!==0&&n.width!==0){z.height=n.height;z.width=n.width}}try{if(!z.id)z.id=j.id+"_canvas";G=z.getContext("2d")}catch(p){COG.Log.exception(p);throw Error("Could not initialise canvas on specified view element");
}ea=COG.Touch.capture(z,{observable:s});if(K.height!==z.height||K.width!==z.width){K=T5.D.init(z.width,z.height);ha=K.width/2>>0;ia=K.height/2>>0;s.trigger("resize",z.width,z.height);for(n=x;n--;)t[n].trigger("resize",z.width,z.height)}j.inertia&&ea.inertiaEnable(j.panAnimationDuration,K);for(n=x;n--;)t[n].trigger("contextChanged",G);v()}}function g(n,p){p.setId(n);p.added=T5.ticks();p.bind("remove",function(){s.removeLayer(n)});p.trigger("contextChanged",G);p.setParent(s);t.push(p);t.sort(function(y,
B){var D=B.zindex-y.zindex;if(D===0)D=B.added-y.added;return D});x=t.length;return p}function h(){q("idle",s);Z=true;U=0}function l(n){var p=1/E;P=la.x+(F-ka.x);da=la.y+(M-ka.y);if(n)return T5.XYRect.fromCenter(P>>0,da>>0,n.width*p>>0,n.height*p>>0)}function r(n,p,y,B){var D=T5.XYRect.copy(p),I,N=0;y&&G.clearRect(0,0,z.width,z.height);G.save();try{G.globalCompositeOperation="source-over";if(E!==1){D=l(D);G.scale(E,E)}G.translate(-D.x1,-D.y1);H=L=null;G.beginPath();X=false;for(N=x;N--;)if(t[N].clip){t[N].clip(G,
D,n,s,y,B);X=true}G.closePath();X&&G.clip();for(N=x;N--;){I=t[N];var $=I.style,aa=$?T5.Style.apply(G,$):null;if(I.minXY)L=L?T5.XY.min(L,I.minXY):T5.XY.copy(I.minXY);if(I.maxXY)H=H?T5.XY.max(H,I.maxXY):T5.XY.copy(I.maxXY);I.draw(G,D,n,s,y,B);aa&&T5.Style.apply(G,aa)}}finally{G.restore()}if(C){G.globalCompositeOperation="source-over";G.strokeStyle="#f00";G.beginPath();G.moveTo(z.width/2,0);G.lineTo(z.width/2,z.height);G.moveTo(0,z.height/2);G.lineTo(z.width,z.height/2);G.stroke()}q("drawComplete",p,
B);COG.Log.trace("draw complete",B)}function u(n,p){var y=false,B=W?W:R?Y:J,D=!R&&(B===ca||B===Y),I=ma||B===Y||B===ca||T5.isTweening();w=o();if(D){T5.cancelAnimation(function(N){return N.cancelOnInteract});Z=false;if(U!==0){clearTimeout(U);U=0}}for(D=x;D--;){if(t[D].animated)J|=pa;t[D].cycle(n,w,J,I);y=t[D].shouldDraw(J,w,I)||y}I=I||(J&pa)!==0;if(y=y||I||E!==1&&E!==S){r(B,w,I,n);S=E;ma=false}if(!y&&O===0&&!ja){if(!Z&&U===0)U=setTimeout(h,500);p.trigger("complete")}O=0;COG.Log.trace("Completed draw cycle",
n)}function v(n){ma=n?true:false;O+=1;if(!A){A=COG.Loopage.join({execute:u,frequency:ga});A.bind("complete",function(){A=null})}}function o(){return T5.XYRect.init(F,M,F+K.width,M+K.height)}function q(){s.trigger.apply(null,arguments);for(var n=t.length;n--;)t[n].trigger.apply(null,arguments)}j=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,adjustScaleFactor:null,
autoSize:true,tapExtent:10,mask:true,guides:false,fps:25},j);var t=[],x=0,z=document.getElementById(j.container),G=null,F=0,M=0,X=false,w=null,A=null,C=j.guides,na=1,K=T5.D.init(),O=0,ha=0,ia=0,ka=null,la=null,Z=false,R=false,U=0,L=null,H=null,Q=0,W=null,ma=false,V=0,T=null,E=1,S=0,ja=typeof FlashCanvas!=="undefined",ga=~~(1E3/j.fps),ea=null,P,da,fa=T5.viewState("ACTIVE"),Y=T5.viewState("PAN"),ca=T5.viewState("ZOOM"),pa=T5.viewState("ANIMATING"),J=fa,oa=T5.XY.getRect,ba=T5.XYRect.diagonalSize,qa=
T5.XYRect.center,s={id:j.id,deviceScaling:na,fastDraw:j.fastDraw||T5.getConfig().requireFastDraw,getDimensions:function(){return K},getLayer:function(n){for(var p=0;p<x;p++)if(t[p].getId()==n)return t[p];return null},setLayer:function(n,p){for(var y=0;y<x;y++)if(t[y].getId()===n){t.splice(y,1);break}p&&g(n,p);v();return p},eachLayer:function(n){for(var p=x;p--;)n(t[p])},invalidate:v,resize:function(n,p){if(z){j.autoSize=false;z.width=n;z.height=p;a();s.trigger("resize",z.width,z.height)}},scale:function(n,
p,y,B){function D(){E=Math.pow(2,Math.round(Math.log(E)/Math.LN2));B&&B();c(true)}var I=E;p||(p=T5.D.getCenter(K));f(p);if(y)T5.tweenValue(0,n-I,y,D,1E3).requestUpdates(function(N){E=I+N;c()});else{E=n;D()}return s},triggerAll:q,removeLayer:function(n){a:{for(var p=x;p--;)if(t[p].getId()==n){n=p;break a}n=-1}if(n>=0&&n<x){COG.say("layer.removed",{layer:t[n]});t.splice(n,1);v()}x=t.length},stateOverride:function(n){W=n},getOffset:function(){return T5.XY.init(F,M)},getViewRect:o,updateOffset:i,pan:function(n,
p,y,B,D){i(F+n,M+p,y,B,D)},zoom:function(n,p){f(n);R=false;E+=Math.pow(2,p)-1;COG.Log.info("zooming, scale change = "+p+", targetXY = ",n);c()}};na=T5.getConfig().getScaling();s.markers=g("markers",new T5.MarkerLayer);COG.observable(s);s.bind("invalidate",function(n,p){v(p)});if(j.pannable){s.bind("pan",m);s.bind("panEnd",k);s.bind("inertiaCancel",function(){R=false;v()})}if(j.scalable){s.bind("pinchZoom",e);s.bind("wheelZoom",b)}s.bind("tap",function(n,p,y){for(var B=T5.XY.offset(y,F,M),D=t.length;D--;)n.cancel=
n.cancel||t[D].trigger("tap",p,y,B).cancel});s.bind("resync",function(){H=L=null});COG.configurable(s,["inertia","container","rotation","tapExtent","scalable","pannable"],COG.paramTweaker(j,null,{container:function(n,p){z=document.getElementById(p);a()},rotation:function(n,p){Q=p}}),true);a();j.autoSize&&window.addEventListener("resize",d,false);return s};
T5.PathLayer=function(j){j=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},j);var m=false,k=[],e=null,b=[],c=null,f=0,d=[],i=T5.ex(new T5.ViewLayer(j),{getAnimation:function(a,g,h,l){var r="pathAnimation"+f++;d.push(r);return new T5.AnimatedPathLayer({id:r,path:k,zindex:j.zindex+1,easing:a?a:T5.easing("sine.inout"),duration:g?g:5E3,drawIndicator:h,autoCenter:l?l:false})},cycle:function(a,g,h,l){return l},draw:function(a){var g,h=k.length;a.save();try{T5.Style.apply(a,j.style);if(h>0){a.beginPath();
a.moveTo(k[h-1].x,k[h-1].y);for(g=h;g--;)a.lineTo(k[g].x,k[g].y);a.stroke();if(e){a.fillStyle=j.waypointFillStyle;for(g=e.length;g--;){a.beginPath();a.arc(e[g].x,e[g].y,2,0,Math.PI*2,false);a.stroke();a.fill()}}}}finally{a.restore()}m=false},updateCoordinates:function(a,g){b=a;c=g;var h=i.getParent();if(h&&h.syncXY){h.syncXY(b);c&&h.syncXY(c);i.trigger("tidy")}}});i.bind("tidy",function(){k=T5.XY.simplify(b,j.pixelGeneralization);e=T5.XY.simplify(c,j.pixelGeneralization);m=true;i.changed()});return i};
T5.ShapeLayer=function(j){function m(c){for(var f=e.length;f--;)e[f].resync(c);e.sort(function(d,i){var a=i.xy.y-d.xy.y;if(a===0)a=i.xy.x-d.xy.y;return a});b.changed()}function k(c,f){f.syncXY&&m(f)}j=T5.ex({zindex:80},j);var e=[],b=T5.ex(new T5.ViewLayer(j),{add:function(c){e[e.length]=c},each:function(c){for(var f=e.length;f--;)c(e[f])},draw:function(c,f,d){var i=f.x1,a=f.y1,g=f.width;f=f.height;for(var h=e.length;h--;){var l=e[h].style;l=l?T5.Style.apply(c,l):null;e[h].draw(c,i,a,g,f,d);l&&T5.Style.apply(c,
l)}}});b.bind("parentChange",k);b.bind("resync",k);return b};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(j){j=T5.ex({style:null,properties:{}},j);return T5.ex(j,{rect:null,draw:function(){},resync:function(){}})};T5.Arc=function(j,m){m=T5.ex({size:4},m);var k=T5.XY.init(),e=T5.ex(m,{draw:function(b){b.beginPath();b.arc(k.x,k.y,e.size,0,Math.PI*2,false);b.fill();b.stroke()},resync:function(b){b.syncXY([j]);k=T5.XY.floor([j])[0]}});COG.Log.info("created arc = ",j);return e};
T5.Poly=function(j,m){m=T5.ex({fill:false,simplify:false},m);var k=false,e=m.fill,b=m.simplify,c=T5.viewState("ZOOM"),f=[],d=T5.ex(new T5.Shape(m),{draw:function(i,a,g,h,l,r){if(k){a=true;g=(r&c)!==0;i.beginPath();for(r=f.length;r--;){g=f[r].x;h=f[r].y;if(a){i.moveTo(g,h);a=false}else i.lineTo(g,h);g=true}if(g){e&&i.fill();i.stroke()}}},resync:function(i){d.xy=i.syncXY(j);f=T5.XY.floor(b?T5.XY.simplify(j):j)}});k=j&&j.length>=2;return d};
T5.AnimatedPathLayer=function(j){function m(d,i,a){d.fillStyle="#FFFFFF";d.strokeStyle="#222222";d.beginPath();d.arc(a.x,a.y,4,0,Math.PI*2,false);d.stroke();d.fill()}j=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},j);var k=T5.XY.edges(j.path),e,b=null,c=0;T5.tweenValue(0,k.total,j.easing,function(){f.remove()},j.duration).requestUpdates(function(d,i){c=d;i&&f.remove()});var f=T5.ex(new T5.ViewLayer(j),
{cycle:function(){for(var d=0;d<k.accrued.length&&k.accrued[d]<c;)d++;b=null;if(d<j.path.length-1){var i=c-(d>0?k.accrued[d-1]:0),a=j.path[d];e=T5.XY.theta(a,j.path[d+1],k.edges[d]);b=T5.XY.extendBy(a,e,i)}return b},draw:function(d,i){if(b)(j.drawIndicator?j.drawIndicator:m)(d,i,T5.XY.init(b.x,b.y),e)}});return f};
T5.Marker=function(j){function m(i,a,g,h){e=i;b=a;c=g;f=h}j=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null,isNew:true},j);var k=false,e=0,b=0,c=0,f=0,d=T5.ex(j,{isAnimating:function(){return k},draw:function(i,a,g,h,l){if(d.isNew&&j.tweenIn){var r=d.xy.y;d.xy.y=a.y1-20;k=true;T5.tween(d.xy,"y",r,j.tweenIn,function(){d.xy.y=r>>0;k=false},j.animationSpeed?j.animationSpeed:250+Math.random()*500)}d.drawMarker(i,a,d.xy.x,d.xy.y,g,h,l);d.isNew=false},drawMarker:function(i,a,g,h){i.beginPath();
i.arc(g,h,4,0,Math.PI*2,false);i.fill();m(g-4,h-4,8,8)},hitTest:function(i,a){return i>=e&&i<=e+c&&a>=b&&a<=b+f},updateBounds:m});COG.observable(d);return d};
T5.ImageMarker=function(j){j=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},j);var m=j.imageAnchor?T5.XY.invert(j.imageAnchor):null,k=T5.ex(new T5.Marker(j),{drawMarker:function(e,b,c,f){if((b=k.isAnimating()&&k.animatingImage?k.animatingImage:k.image)&&b.width>0){m||(m=T5.XY.init(-b.width>>1,-b.height>>1));var d=k.scale,i=c+~~(m.x*d),a=f+~~(m.y*d),g=~~(b.width*d),h=~~(b.height*d);k.updateBounds(i,a,g,g);if(k.rotation||k.opacity!==
1){e.save();try{e.globalAlpha=k.opacity;e.translate(c,f);e.rotate(k.rotation);e.drawImage(b,m.x*d,m.y*d,g,h)}finally{e.restore()}}else e.drawImage(b,i,a,g,h)}}});if(!k.image)k.image=T5.Images.get(j.imageUrl,function(e){k.image=e});if(!k.animatingImage)k.animatingImage=T5.Images.get(j.animatingImageUrl,function(e){k.animatingImage=e});return k};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(j){function m(){b.changed();b.trigger("markerUpdate",e)}function k(){var c=b.getParent();if(c&&c.syncXY)for(var f=e.length;f--;)c.syncXY([e[f].xy])}j=T5.ex({zindex:100,style:"basic"},j);var e=[],b=T5.ex(new T5.ViewLayer(j),{draw:function(c,f,d,i){for(var a=e.length;a--;)e[a].draw(c,f,d,b,i)},add:function(c){if(c&&typeof c.length!=="undefined")for(var f=c.length;f--;){if(c[f])e[e.length]=c[f]}else if(c)e[e.length]=c;m()},clear:function(c){if(c)for(var f=0;f<e.length;f++)c(e[f])&&
e.splice(f,1);else e=[];m()},each:function(c){if(c)for(var f=e.length;f--;)c(e[f])},find:function(c){for(var f=[],d=e.length;d--;)if(!c||c(e[d]))f[f.length]=e[d];return f}});b.bind("tap",function(c,f,d){for(var i=[],a=d.x,g=d.y,h=e.length;h--;)if(e[h].hitTest(a,g))i[i.length]=e[h];if(i.length>0)c.cancel=b.trigger("markerTap",f,d,i).cancel});b.bind("parentChange",k);b.bind("resync",k);b.bind("changed",k);return b};
T5.ImageLayer=function(j,m){function k(a,g,h){for(g=c.length;g--;){var l=c[g],r=l.x,u=l.y,v=T5.XYRect.init(l.x,l.y,l.x+l.width,l.y+l.height);if(h&&T5.XYRect.intersect(a,v)){v=T5.Images.get(l.url,function(){i.changed()},d);h(v,r,u,l.width,l.height)}}}function e(a){b&&b.run(a,function(g){c=[].concat(g);i.changed()})}m=T5.ex({imageLoadArgs:{}},m);var b=j?T5.Generator.init(j,m):null,c=[],f=T5.XYRect.init(),d=m.imageLoadArgs,i=T5.ex(new T5.ViewLayer(m),{changeGenerator:function(a,g){b=T5.Generator.init(a,
T5.ex({},m,g));b.bindToView(i.getParent());c=null;e(f)},clip:function(a,g,h){k(g,h,function(l,r,u,v,o){l&&a.rect(r,u,v,o)})},cycle:function(a,g){e(g)},draw:function(a,g,h){k(g,h,function(l,r,u,v,o){i.drawImage(a,l,r,u,v,o,g,h)});f=T5.XYRect.copy(g)},drawImage:function(a,g,h,l){g&&a.drawImage(g,h,l,g.width,g.height)}});i.bind("idle",function(){e(f)});i.bind("parentChange",function(a,g){b&&b.bindToView(g)});i.bind("tap",function(a,g,h,l){a=[];var r=l.x,u=l.y,v,o;if(c)for(var q=c.length;q--;){v=c[q];
if(o=r>=v.x&&r<=v.x+v.width&&u>=v.y&&u<=v.y+v.height)a[a.length]=v}a.length>0&&i.trigger("tapImage",a,g,h,l)});return i};
T5.Style=function(){function j(f,d){b[f]=k(d);return f}function m(f){for(var d in f)j(d,f[d])}function k(f){function d(h){var l=f[h];typeof l!=="undefined"&&a.push(function(r){r[h]=l})}function i(){a=[];for(var h in f)d(h)}f=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},f);var a=[],g={applyToContext:function(h){for(var l=a.length;l--;)a[l](h)},update:function(h,
l){f[h]=l;i()}};i();return g}var e={},b={},c={apply:function(f,d){var i=b[d]?b[d]:b.basic,a;if(f&&f.canvas){a=e[f.canvas.id];e[f.canvas.id]=d}i.applyToContext(f);return a},define:j,defineMany:m,get:function(f){return b[f]},init:k,load:function(f){COG.jsonp(f,function(d){T5.resetStyles(d)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return c}();
T5.Tiling=function(){return{tileSize:256,init:function(j,m,k,e,b){return T5.ex({x:j,y:m,width:k,height:e},b)}}}();
T5.TileGenerator=function(j){function m(u,v,o,q){function t(){if(r.initTileCreator){d=true;r.initTileCreator(u,v,o,q)}}r.prepTileCreator?r.prepTileCreator(u,v,o,t):t()}function k(u,v){for(var o=~~((u.x1-c.x)/i),q=~~((u.y1-c.y)/a),t=[],x=-f;x<h;x++)for(var z=-f;z<l;z++){var G=g(o+x,q+z);if(G)t[t.length]=G}v&&v(t);b=T5.XYRect.copy(u)}j=T5.ex({tileWidth:256,tileHeight:256,relative:false,padding:2},j);var e=null,b=null,c=T5.XY.init(),f=j.padding,d=false,i=j.tileWidth,a=j.tileHeight,g=null,h=0,l=0,r={bindToView:function(u){COG.Log.info("initializing generator");
e=u;r.trigger("bindView",u)},getTileCreatorArgs:null,initTileCreator:null,prepTileCreator:null,requireRefresh:function(){return false},reset:function(){g=null;d=false;b=null},run:function(u,v){if(!b||Math.abs(u.x1-b.x1)>i||Math.abs(u.y1-b.y1)>a){if(!g&&!d||r.requireRefresh()){c=j.relative?T5.XY.init(u.x1,u.y1):T5.XY.init();h=Math.ceil(u.width/i)+f;l=Math.ceil(u.height/a)+f;m(i,a,r.getTileCreatorArgs?r.getTileCreatorArgs(e):{},function(o){g=o;d=false;k(u,v)})}g&&k(u,v)}}};COG.observable(r);r.bind("update",
function(){COG.Log.info("captured generator update");b=null});return r};
