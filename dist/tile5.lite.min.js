COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var L=arguments[0]||{},Z,D=1,v=arguments.length;D<v;D++)if((Z=arguments[D])!==null)for(var j in Z){var m=Z[j];if(L!==m)if(m!==undefined)L[j]=m}return L};
(function(){var L=Object.prototype.hasOwnProperty,Z=0,D={};D.toID=function(v){return v.replace(/\s/g,"-")};D.objId=function(v){return(v?v:"obj")+Z++};D.isFunction=function(v){return toString.call(v)==="[object Function]"};D.isArray=function(v){return toString.call(v)==="[object Array]"};D.isPlainObject=function(v){if(!v||toString.call(v)!=="[object Object]"||v.nodeType||v.setInterval)return false;if(v.constructor&&!L.call(v,"constructor")&&!L.call(v.constructor.prototype,"isPrototypeOf"))return false;
var j;for(j in v);return j===undefined||L.call(v,j)};D.isEmptyObject=function(v){for(var j in v)return false;return true};D.isXmlDocument=function(v){return toString.call(v)==="[object Document]"};D.contains=function(v,j){var m=v,w=arguments,A=1;if(j&&module.isArray(j)){w=j;A=0}for(A=A;A<w;A++)m=m&&typeof foo[w[A]]!=="undefined";return m};D.formatStr=function(v){if(arguments.length<=1)return v;for(var j=arguments.length-2,m=0;m<=j;m++)v=v.replace(RegExp("\\{"+m+"\\}","gi"),arguments[m+1]);return v};
D.wordExists=function(v,j){var m="";if(j.toString)j=j.toString();for(var w=0;w<j.length;w++)m+=!/\w/.test(j[w])?"\\"+j[w]:j[w];return RegExp("(^|\\s|\\,)"+m+"(\\,|\\s|$)","i").test(v)};COG.extend(COG,D)})();
(function(){function L(m){return typeof console!=="undefined"?function(){console[m](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var Z=window.console&&window.console.markTimeline,D=L("error"),v=L("info"),j=function(){return Z?function(m,w){console.markTimeline(m+(w?": "+((new Date).getTime()-w)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:L("debug"),info:v,warn:L("warn"),error:D,exception:function(m){if(D)for(var w in m)v("ERROR DETAIL: "+w+
": "+m[w])}})})();
(function(){function L(D,v){var j=D.obsHandlers;j[v]||(j[v]=[]);return j[v]}var Z=0;COG.observable=function(D){if(!D)return null;if(!D.obsHandlers)D.obsHandlers={};if(!(D.bind||D.trigger||D.unbind)){D.bind=function(v,j){var m="callback"+Z++;L(D,v).unshift({fn:j,id:m});return m};D.triggerCustom=function(v,j){var m=L(D,v),w={cancel:false,name:v},A;j&&COG.extend(w,j);if(!m)return null;A=Array.prototype.slice.call(arguments,2);D.eventInterceptor&&D.eventInterceptor(v,w,A);A.unshift(w);for(var h=m.length;h--&&
!w.cancel;)m[h].fn.apply(this,A);return w};D.trigger=function(v){var j=Array.prototype.slice.call(arguments,1);j.splice(0,0,v,null);return D.triggerCustom.apply(this,j)};D.unbind=function(v,j){if(typeof v==="undefined")D.obsHandlers={};else for(var m=L(D,v),w=0;m&&w<m.length;w++)if(m[w].id===j){m.splice(w,1);break}return D}}return D}})();
(function(){function L(j,m){j[m]||(j[m]=function(w){return j.configure(m,w)})}function Z(j){j.gtConfId="configurable"+v++;j.gtConfig={};j.gtConfigFns=[];return j.gtConfig}var D={},v=0;COG.paramTweaker=function(j,m,w){return function(A,h){if(typeof h!=="undefined"){if(A in j)j[A]=h;w&&A in w&&w[A](A,h)}else return m&&A in m?m[A](A):j[A]}};COG.configurable=function(j,m,w,A){if(j){j.gtConfId||Z(j);var h=j.gtConfId,z=j.gtConfig,u=j.gtConfigFns;D[h]=j;u.push(w);for(w=m.length;w--;){z[m[w]]=true;A&&L(j,
m[w])}if(!j.configure)j.configure=function(C,N){if(z[C]){for(var o=u.length;o--;){var s=u[o](C,N);if(typeof s!=="undefined")return s}return D[h]}return null}}}})();
(function(){function L(j){var m=document.createElement("script"),w=false;m.src=j;m.async=true;m.onload=m.onreadystatechange=function(){if(!w&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){w=true;m.onload=m.onreadystatechange=null;m&&m.parentNode&&m.parentNode.removeChild(m)}};D||(D=document.getElementsByTagName("head")[0]);D.appendChild(m)}var Z=0,D,v=this;COG.jsonp=function(j,m,w){j+=j.indexOf("?")>=0?"&":"?";var A="json"+ ++Z;v[A]=function(h){m(h);v[A]=null;try{delete v[A]}catch(z){}};
L(j+(w?w:"callback")+"="+A);return A}})();
(function(){var L=1.70158,Z=Math.PI/2,D=Math.abs,v=Math.pow,j=Math.sin,m=Math.asin,w=Math.cos,A={linear:function(h,z,u,C){return u*h/C+z},backin:function(h,z,u,C){return u*(h/=C)*h*((L+1)*h-L)+z},backout:function(h,z,u,C){return u*((h=h/C-1)*h*((L+1)*h+L)+1)+z},backinout:function(h,z,u,C){return(h/=C/2)<1?u/2*h*h*(((L*=1.525)+1)*h-L)+z:u/2*((h-=2)*h*(((L*=1.525)+1)*h+L)+2)+z},bouncein:function(h,z,u,C){return u-A.bounceout(C-h,0,u,C)+z},bounceout:function(h,z,u,C){return(h/=C)<1/2.75?u*7.5625*h*h+
z:h<2/2.75?u*(7.5625*(h-=1.5/2.75)*h+0.75)+z:h<2.5/2.75?u*(7.5625*(h-=2.25/2.75)*h+0.9375)+z:u*(7.5625*(h-=2.625/2.75)*h+0.984375)+z},bounceinout:function(h,z,u,C){return h<C/2?A.bouncein(h*2,0,u,C)/2+z:A.bounceout(h*2-C,0,u,C)/2+u/2+z},cubicin:function(h,z,u,C){return u*(h/=C)*h*h+z},cubicout:function(h,z,u,C){return u*((h=h/C-1)*h*h+1)+z},cubicinout:function(h,z,u,C){if((h/=C/2)<1)return u/2*h*h*h+z;return u/2*((h-=2)*h*h+2)+z},elasticin:function(h,z,u,C,N,o){if(h==0)return z;if((h/=C)==1)return z+
u;o||(o=C*0.3);if(!N||N<D(u)){N=u;u=o/4}else u=o/TWO_PI*m(u/N);return-(N*v(2,10*(h-=1))*j((h*C-u)*TWO_PI/o))+z},elasticout:function(h,z,u,C,N,o){var s;if(h==0)return z;if((h/=C)==1)return z+u;o||(o=C*0.3);if(!N||N<D(u)){N=u;s=o/4}else s=o/TWO_PI*m(u/N);return N*v(2,-10*h)*j((h*C-s)*TWO_PI/o)+u+z},elasticinout:function(h,z,u,C,N,o){var s;if(h==0)return z;if((h/=C/2)==2)return z+u;o||(o=C*0.3*1.5);if(!N||N<D(u)){N=u;s=o/4}else s=o/TWO_PI*m(u/N);if(h<1)return-0.5*N*v(2,10*(h-=1))*j((h*C-s)*TWO_PI/o)+
z;return N*v(2,-10*(h-=1))*j((h*C-s)*TWO_PI/o)*0.5+u+z},quadin:function(h,z,u,C){return u*(h/=C)*h+z},quadout:function(h,z,u,C){return-u*(h/=C)*(h-2)+z},quadinout:function(h,z,u,C){if((h/=C/2)<1)return u/2*h*h+z;return-u/2*(--h*(h-2)-1)+z},sinein:function(h,z,u,C){return-u*w(h/C*Z)+u+z},sineout:function(h,z,u,C){return u*j(h/C*Z)+z},sineinout:function(h,z,u,C){return-u/2*(w(Math.PI*h/C)-1)+z}};COG.tweenValue=function(h,z,u,C,N){function o(R){var P=R-s,ca=u(P,h,B,C),ba=s+C<=R;R=!ba;if(N){P=N(ca,ba,
P);R=typeof P!="undefined"?P&&R:R}R&&animFrame(o)}var s=(new Date).getTime(),B=z-h;animFrame(o);return{}};COG.easing=function(h){return A[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]};COG.registerEasingType=function(h,z){A[h.replace(/[\-\_\s\.]/g,"").toLowerCase()]=z}})();
(function(){var L=/^P(\d+Y)?(\d+M)?(\d+D)?$/,Z=/^(\d+H)?(\d+M)?(\d+S)?$/,D={8601:function(j){j=j.split("T");var m=null;m=null;var w=0,A=0;L.lastIndex=-1;m=L.exec(j[0]);w+=m[3]?parseInt(m[3].slice(0,-1),10):0;Z.lastIndex=-1;m=Z.exec(j[1]);A+=m[1]?parseInt(m[1].slice(0,-1),10)*3600:0;A+=m[2]?parseInt(m[2].slice(0,-1),10)*60:0;A+=m[3]?parseInt(m[3].slice(0,-1),10):0;return new v(w,A)}},v=COG.Duration=function(j,m){return{days:j?j:0,seconds:m?m:0}};COG.addDuration=function(){for(var j=new v,m=arguments.length;m--;){j.days+=
arguments[m].days;j.seconds+=arguments[m].seconds}if(j.seconds>=86400){j.days+=~~(j.seconds/86400);j.seconds%=86400}return j};COG.formatDuration=function(j){var m,w,A="";if(j.days)A=j.days+" days ";if(j.seconds){j=j.seconds;if(j>=3600){m=~~(j/3600);j-=m*3600}if(j>=60){w=Math.round(j/60);j-=w*60}if(m)A=A+m+(m>1?" hrs ":" hr ")+(w?(w>10?w:"0"+w)+" min ":"");else if(w)A=A+w+" min";else if(j>0)A=A+(j>10?j:"0"+j)+" sec"}return A};COG.parseDuration=function(j,m){var w=m?D[m]:null;if(w)return w(j);COG.Log.warn("Could not find duration parser for specified format: "+
m);return new v}})();
INTERACT=function(){function L(o){return function(s,B,R){(R?R:o?document.body:document).addEventListener(s,B,false)}}function Z(o){return function(s,B,R){(R?R:o?document.body:document).removeEventListener(s,B,false)}}function D(o,s,B){(B?B:document).attachEvent("on"+o,s)}function v(o,s,B){(B?B:document).detachEvent("on"+o,s)}function j(o,s){return{x:o?o:0,y:s?s:0,count:1}}function m(o,s){C.push(COG.extend({handler:null,checks:{},type:o},s))}function w(o){var s=0,B=0;if(o.offsetParent){do{s+=o.offsetLeft;
B+=o.offsetTop;o=o.offsetParent}while(o)}return{x:s,y:B}}function A(o,s){return{source:o,target:s.target?s.target:s.srcElement}}function h(o,s){for(var B=o.target?o.target:o.srcElement;B&&B!==s&&B.nodeName&&B.nodeName.toUpperCase()!="CANVAS";)B=B.parentNode;return B&&B===s}function z(o,s){return{x:o.x-(s?s.x:0),y:o.y-(s?s.y:0)}}function u(o){if(o.preventDefault){o.preventDefault();o.stopPropagation()}else o.cancelBubble&&o.cancelBubble()}var C=[],N=function(o,s,B){function R(H,$,T,K){var S=0,W=0,
p=0;COG.tweenValue(0,H,T,K,function(U){p=S;S=U});COG.tweenValue(0,$,T,K,function(U){P.trigger("pan",S-p,U-W);W=U})}B=COG.extend({binder:null,unbinder:null,observable:null},B);for(var P=B.observable,ca=null,ba=[],na=[],ja,ka,I={bind:function(){return P.bind.apply(null,arguments)},pannable:function(H){ca=COG.extend({inertia:true},H);return I},unbind:function(){P.unbind();for(var H=0;H<ba.length;H++)ba[H].unbind();return I}},va=0;va<s.length;va++)ba.push(s[va](o,P,B));P.bind("pointerDown",function(){na=
[];ka=ja=0});P.bind("pointerMove",function(H,$,T,K){if(ca){na[na.length]={ticks:(new Date).getTime(),x:K.x,y:K.y};P.trigger("pan",K.x,K.y)}ja+=K.x?K.x:0;ka+=K.y?K.y:0});P.bind("pointerUp",function(H,$,T){if(Math.abs(ja)>20||Math.abs(ka)>20){if(ca){H=na;$=H.length;var K;var S=T=0,W,p,U;K=$>0?(new Date).getTime()-H[$-1].ticks:0;var Q;for(Q=H.length;--Q>1&&K<50;)K+=H[Q].ticks-H[Q-1].ticks;K=$-Q;if(K>1){for(;Q<$;Q++){W=H[Q].x-H[Q-1].x;p=H[Q].y-H[Q-1].y;U=H[Q].ticks-H[Q-1].ticks;T+=W/U;S+=p/U}T=Math.min(T/
K*500|0,300);S=Math.min(S/K*500|0,300);R(T,S,COG.easing("quad.out"),500)}}}else P.trigger("tap",$,T)});return I};m("pointer",{handler:function(o,s,B){function R(p){if(h(p,o))if(va=na(p)){o.style.cursor="move";u(p);S=p.pageX?p.pageX:p.screenX;W=p.pageY?p.pageY:p.screenY;H=j(S,W);$=w(o);s.triggerCustom("pointerDown",A("mouse",p),H,z(H,$))}}function P(p){T=p.pageX?p.pageX:p.screenX;K=p.pageY?p.pageY:p.screenY;if(h(p,o))ja(p,va?"pointerMove":"pointerHover")}function ca(p){if(va&&na(p)){va=false;if(h(p,
o)){o.style.cursor="default";ja(p,"pointerUp")}}}function ba(p){if(h(p,o)){var U;p=p||window.event;if(p.detail)U=p.axis===2?-p.detail*ka:0;else{U=p.wheelDeltaY?p.wheelDeltaY:p.wheelDelta;if(window.opera)U=-U}if(U!==0){var Q=j(T,K);s.triggerCustom("zoom",A("mouse",p),Q,z(Q,w(o)),U/I,"wheel");u(p);p.returnValue=false}}}function na(p){p=p||window.event;return(p.which||p.button)==1}function ja(p,U,Q,oa,ra){Q=typeof Q!="undefined"?Q:T;oa=typeof oa!="undefined"?oa:K;var E=Q-S,O=oa-W,M=j(Q,oa);$||($=w(o));
s.triggerCustom(U,A("mouse",p),M,z(M,$),j(E,O));if(typeof ra=="undefined"||ra){S=Q;W=oa}}B=COG.extend({},B);var ka=120,I=ka*8,va=false,H,$,T,K,S,W;B.binder("mousedown",R,false);B.binder("mousemove",P,false);B.binder("mouseup",ca,false);B.binder("dblclick",function(p){COG.info("captured double click");if(h(p,o)){var U=j(p.pageX?p.pageX:p.screenX,p.pageY?p.pageY:p.screenY);COG.info("captured double click + target matched");s.triggerCustom("doubleTap",A("mouse",p),U,z(U,w(o)))}},false);B.binder("mousewheel",
ba,document);B.binder("DOMMouseScroll",ba,document);return{unbind:function(){B.unbinder("mousedown",R,false);B.unbinder("mousemove",P,false);B.unbinder("mouseup",ca,false);B.unbinder("mousewheel",ba,document);B.unbinder("DOMMouseScroll",ba,document)}}},checks:{touch:false}});m("pointer",{handler:function(o,s,B){function R(E){if(E.count<2)return 0;var O=E.x-E.next.x;E=E.y-E.next.y;return~~Math.sqrt(O*O+E*E)}function P(E,O,M){O=O?O:0;M=M?M:0;for(var pa={x:E.x-O,y:E.y-M,id:E.id,count:E.count},sa=pa;E.next;){E=
E.next;sa=sa.next={x:E.x-O,y:E.y-M,id:E.id}}return pa}function ca(E,O){var M=E[O?O:"touches"],pa,sa;if(M.length===0)return null;sa=pa={x:M[0].pageX,y:M[0].pageY,id:M[0].identifier,count:M.length};for(var wa=1,Ka=M.length;wa<Ka;wa++)sa=sa.next={x:M[wa].pageX,y:M[wa].pageY,id:M[wa].identifier};return pa}function ba(E){if(h(E,o)){K=w(o);var O=ca(E,"changedTouches"),M=P(O,K.x,K.y);if(!W){S=H;s.triggerCustom("pointerDown",A("touch",E),O,M)}oa&&s.triggerCustom("pointerDownMulti",A("touch",E),O,M);W=ca(E);
if(W.count>1)U=R(W);ra=1;Q=P(W)}}function na(E){if(h(E,o)){E.preventDefault();p=ca(E);if(S==H)S=Math.abs(W.x-p.x)>I||Math.abs(W.y-p.y)>I?va:H;if(S!=H){S=p.count>1?T:$;if(S==T)if(W.count===1){W=P(p);U=R(W)}else{var O=R(p);if(Math.abs(U-O)<ka)S=$;else{var M;M=p.x;var pa=p.next.x,sa=p.y,wa=p.next.y,Ka=sa<wa?sa:wa;M={x:(M<pa?M:pa)+(Math.abs(M-pa)>>1),y:Ka+(Math.abs(sa-wa)>>1)};O=O/U;pa=O-ra;s.triggerCustom("zoom",A("touch",E),M,z(M,K),pa,"pinch");ra=O}}S==$&&s.triggerCustom("pointerMove",A("touch",E),
p,P(p,K.x,K.y),j(p.x-Q.x,p.y-Q.y));oa&&s.triggerCustom("pointerMoveMulti",A("touch",E),p,P(p,K.x,K.y))}Q=P(p)}}function ja(E){if(h(E,o)){var O=ca(E,"changedTouches"),M=P(O,K.x,K.y);p=ca(E);if(!p){S===H&&s.triggerCustom("tap",A("touch",E),O,M);s.triggerCustom("pointerUp",A("touch",E),O,M);W=null}oa&&s.triggerCustom("pointerUpMulti",A("touch",E),O,M)}}B=COG.extend({detailed:false,inertia:false},B);var ka=20,I=7,va=0,H=1,$=2,T=3,K,S,W,p,U,Q,oa=B.detailed,ra=1;B.binder("touchstart",ba,false);B.binder("touchmove",
na,false);B.binder("touchend",ja,false);COG.info("initialized touch handler");return{unbind:function(){B.unbinder("touchstart",ba,false);B.unbinder("touchmove",na,false);B.unbinder("touchend",ja,false)}}},checks:{touch:true}});return{register:m,watch:function(o,s,B){s=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},s);capabilities=COG.extend({touch:"ontouchstart"in window},B);if(!s.observable){COG.info("creating observable");s.observable=COG.observable({});
globalOpts=s}s.binder=s.isIE?D:L(s.bindToBody);s.unbinder=s.isIE?v:Z(s.bindToBody);B=s.types;for(var R=capabilities,P=[],ca=C.length;ca--;){var ba=C[ca],na=!B||B.indexOf(ba.type)>=0,ja=true;for(var ka in ba.checks){var I=ba.checks[ka];COG.info("checking "+ka+" capability. require: "+I+", capability = "+R[ka]);ja=ja&&I===R[ka]}if(na&&ja)P[P.length]=ba.handler}return new N(o,P,s)}}}();
T5=function(){function L(){return(new Date).getTime()}function Z(){for(;p.length>0;){var b=p.shift();document.location=b}W=0}function D(b){for(var l=true,d=U.length;d--;)l=l&&b!=U[d];return l}function v(b,l){var d=[];for(var a in l)a&&d.push(a+"="+escape(l[a]));return"tile5://"+b+"/"+(d.length>0?"?"+d.join("&"):"")}function j(b,l){D(b)&&COG.info("would push url: "+v(b,l))}function m(b,l){if(D(b)){p.push(v(b,l));W||(W=setTimeout(Z,100))}}function w(b){return function(l,d,a){(a?a:b?document.body:document).addEventListener(l,
d,false)}}function A(b){return function(l,d,a){(a?a:b?document.body:document).removeEventListener(l,d,false)}}function h(b,l,d){(d?d:document).attachEvent("on"+b,l)}function z(b,l,d){(d?d:document).detachEvent("on"+b,l)}function u(){T={base:{name:"Unknown",bindEvent:w(),unbindEvent:A(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:j,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:h,unbindEvent:z,
requireFastDraw:false,targetFps:25},ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:m,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:m},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:m},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:w(true),unbindEvent:A(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:m},
froyo:{name:"Android OS >= 2.2",regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:m}};K=[T.froyo,T.android,T.ipod,T.iphone,T.ipad,T.ie]}function C(){T||u();if(!S){COG.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var b=0;b<K.length;b++){var l=K[b];if(l.regex&&l.regex.test(navigator.userAgent)){S=COG.extend({},T.base,l);COG.info("PLATFORM DETECTED AS: "+S.name);break}}if(!S){COG.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
S=T.base}COG.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return S}function N(){for(var b=0,l=arguments.length;l--;){var d=E[arguments[l].toUpperCase()];if(d)b|=d}return b}window.animFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(){setTimeout(function(){window.callback((new Date).getTime())},1E3/60)}}();var o=Math.abs,s=Math.min,B=Math.max,
R=Math.pow,P=Math.sqrt,ca=Math.log,ba=Math.round,na=Math.sin,ja=Math.asin,ka=Math.cos,I=function(){function b(a,c){return d(a.x-c.x,a.y-c.y)}function l(a,c){if(!c)c=a.length;if(c<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var g={edges:Array(c-1),accrued:Array(c-1),total:0},e=0;e<c-1;e++){var n=b(a[e],a[e+1]);g.edges[e]=P(n.x*n.x+n.y*n.y);g.accrued[e]=g.total+g.edges[e];g.total+=g.edges[e]}return g}function d(a,c){return{x:a?a:0,y:c?c:0}}return{VECTOR_SIMPLIFICATION:3,
SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var a=0,c=0,g=arguments.length;g--;){a+=arguments[g].x;c+=arguments[g].y}return d(a,c)},absSize:function(a){return B(o(a.x),o(a.y))},copy:function(a){return a?d(a.x,a.y):null},diff:b,distance:function(a,c){return l(a,c).total},edges:l,equals:function(a,c){return a.x===c.x&&a.y===c.y},extendBy:function(a,c,g){var e=ka(c)*g;c=na(c)*g;return d(a.x-e,a.y-c)},floor:function(a){for(var c=Array(a.length),g=a.length;g--;)c[g]=d(~~a[g].x,~~a[g].y);return c},
getRect:function(a){for(var c,g,e,n,k=a.length;k--;){var i=a[k];c=typeof c==="undefined"||i.x<c?i.x:c;g=typeof g==="undefined"||i.y<g?i.y:g;e=typeof e==="undefined"||i.x>e?i.x:e;n=typeof n==="undefined"||i.y>n?i.y:n}return H.init(c,g,e,n)},init:d,invert:function(a){return d(-a.x,-a.y)},min:function(a,c){return d(a.x<c.x?a.x:c.x,a.y<c.y?a.y:c.y)},max:function(a,c){return d(a.x>c.x?a.x:c.x,a.y>c.y?a.y:c.y)},offset:function(a,c,g){return d(a.x+c,a.y+(g?g:c))},simplify:function(a,c){if(!a)return null;
c=c?c:I.VECTOR_SIMPLIFICATION;for(var g=[],e=null,n=a.length;n--;){var k=a[n];if(include=!e||n===0||o(k.x-e.x)+o(k.y-e.y)>c){g.unshift(k);e=k}}return g},theta:function(a,c,g){g=ja((a.y-c.y)/g);return a.x>c.x?g:Math.PI-g},toString:function(a){return a.x+", "+a.y}}}(),va=function(){return{dotProduct:function(b,l){return b.x*l.x+b.y*l.y}}}(),H=function(){function b(d){return l(d.x1,d.y1,d.x2,d.y2)}function l(d,a,c,g){d=d?d:0;a=a?a:0;c=typeof c!=="undefined"?c:d;g=typeof g!=="undefined "?g:g;return{x1:d,
y1:a,x2:c,y2:g,width:c-d,height:g-a}}return{center:function(d){return I.init(d.x1+d.width/2,d.y1+d.height/2)},copy:b,diagonalSize:function(d){return P(d.width*d.width+d.height*d.height)},fromCenter:function(d,a,c,g){c=c>>1;g=g>>1;return l(d-c,a-g,d+c,a+g)},init:l,intersect:function(d,a){var c=B(d.x1,a.x1),g=B(d.y1,a.y1),e=s(d.x2,a.x2),n=s(d.y2,a.y2);c=l(c,g,e,n);return c.width>0&&c.height>0?c:null},toString:function(d){return"["+d.x1+", "+d.y1+", "+d.x2+", "+d.y2+"]"},union:function(d,a){if(d.width===
0||d.height===0)return b(a);else if(a.width===0||a.height===0)return b(d);else{var c=s(d.x1,a.x1),g=s(d.y1,a.y1),e=B(d.x2,a.x2),n=B(d.y2,a.y2);c=l(c,g,e,n);return c.width>0&&c.height>0?c:null}}}}(),$=function(){return{getAspectRatio:function(b){return b.height!==0?b.width/b.height:1},getCenter:function(b){return I.init(b.width>>1,b.height>>1)},getSize:function(b){return P(R(b.width,2)+R(b.height,2))},init:function(b,l){b=b?b:0;return{width:b,height:l?l:b}}}}(),T=null,K=[],S=null,W=0,p=[],U=["view.wake",
"tile.loaded"],Q=function(){function b(){var f=C().maxImageLoads;if(!f||k.length<f)if(f=n.shift()){k[k.length]=f;f.image.onload=l;f.image.src=f.url;f.requested=T5.ticks()}}function l(){var f=g[this.id],x;if(f&&f.image.complete&&f.image.width>0){f.loaded=true;f.hitCount=1;for(x=k.length;x--;)if(k[x].image.src==this.src){k.splice(x,1);break}if(f.background||f.postProcess||f.drawBackground||f.customDraw)if(f.image){globalImageData=f;x=a(f.realSize?f.realSize.width:f.image.width,f.realSize?f.realSize.height:
f.image.height);var G=x.getContext("2d"),J=f.offset?f.offset:T5.XY.init();f.background&&G.drawImage(f.background,0,0);f.drawBackground&&f.drawBackground(G);f.customDraw?f.customDraw(G,f):G.drawImage(f.image,J.x,J.y);f.postProcess&&f.postProcess(G,f);f.image=x}for(x=f.callbacks.length;x--;)f.callbacks[x]&&f.callbacks[x](this,false);f.callbacks=[];i[i.length]={url:this.src,created:f.requested};delete g[this.id];b()}}function d(f,x,G){var J=c[f];if(J){J.hitCount++;J.image.complete&&J.image.width>0&&
x?x(J.image,true):J.callbacks.push(x)}else{J=COG.extend({url:f,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[x]},G);J.image.id="resourceLoaderImage"+e++;c[f]=J;g[J.image.id]=J;n[n.length]=J;b()}return J}function a(f,x){var G=document.createElement("canvas");COG.info("creating new canvas");G.width=f?f:0;G.height=x?x:0;if(typeof FlashCanvas!="undefined"){document.body.appendChild(G);FlashCanvas.initElement(G)}return G}var c={},g={},e=0,n=[],k=[],i=[],q={avgImageSize:25,
loadTimeout:10,cancelLoad:function(){var f;for(f=k.length;f--;)delete c[k[f].url];k=[];for(f=n.length;f--;)delete c[n[f].url];n=[]},get:function(f,x,G){var J=null;J=null;if((J=(J=c[f])?J.image:null)&&(J.getContext||J.complete&&J.width>0))return J;else x&&d(f,x,G);return null},load:d,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:k.length,queuedImageCount:n.length,imageCacheFullness:0}}};COG.observable(q);return q}(),oa=function(){var b={};return{init:function(l,d){var a=
b[l];if(!a)throw Error("Unable to locate requested generator: "+l);return new a(d)},register:function(l,d){b[l]=d},Template:function(){}}}(),ra=function(){function b(e,n){c[e]=d(n);return e}function l(e){for(var n in e)b(n,e[n])}function d(e){function n(f){var x=e[f];typeof x!=="undefined"&&i.push(function(G){G[f]=x})}function k(){i=[];for(var f in e)n(f)}e=COG.extend({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,
globalCompositeOperation:undefined},e);var i=[],q={applyToContext:function(f){for(var x=i.length;x--;)i[x](f)},update:function(f,x){e[f]=x;k()}};k();return q}var a={},c={},g={apply:function(e,n){var k=c[n]?c[n]:c.basic,i;if(e&&e.canvas){i=a[e.canvas.id];a[e.canvas.id]=n}k.applyToContext(e);return i},define:b,defineMany:l,get:function(e){return c[e]},init:d,load:function(e){COG.jsonp(e,function(n){l(n)})}};l({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",
fillStyle:"#FFF"}});return g}(),E={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128},O=function(b){b=COG.extend({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:N("ACTIVE","ANIMATING","PAN","ZOOM"),style:null,minXY:null,maxXY:null},b);var l=null,d=false,a=false,c=b.id,g=N("ACTIVE"),e=b.validStates,n=0,k=0,i=COG.extend({addToView:function(q){q.setLayer(c,i)},shouldDraw:function(q){return(q&e)!==0},clip:null,cycle:function(){},draw:function(){},remove:function(){i.trigger("remove",
i)},changed:function(){a=true;l&&l.invalidate()},hitTest:null,getId:function(){return c},setId:function(q){c=q},getParent:function(){return l},setParent:function(q){d=(l=q)?l.fastDraw&&displayState!==g:false;i.trigger("parentChange",l)}},b);COG.observable(i);i.bind("drawComplete",function(q,f){a=false;n=f.x1;k=f.y1});i.bind("resync",function(q,f){if(f.syncXY){i.minXY&&f.syncXY(i.minXY);i.maxXY&&f.syncXY(i.maxXY)}});return i},M=function(b){function l(k,i,q,f){a=k;c=i;g=q;e=f}b=COG.extend({xy:I.init(),
offset:true,tweenIn:null,animationSpeed:null,isNew:true},b);var d=false,a=0,c=0,g=0,e=0,n=COG.extend(b,{isAnimating:function(){return d},draw:function(k,i,q,f,x){if(n.isNew&&b.tweenIn)COG.tweenValue(i.y1-20,n.xy.y,b.tweenIn,b.animationSpeed?b.animationSpeed:250+Math.random()*500,function(G,J){n.xy.y=G|0;d=!J;x.invalidate()});n.drawMarker(k,i,n.xy.x,n.xy.y,q,f,x);n.isNew=false},drawMarker:function(k,i,q,f){k.beginPath();k.arc(q,f,4,0,Math.PI*2,false);k.fill();l(q-4,f-4,8,8)},hitTest:function(k,i){return k>=
a&&k<=a+g&&i>=c&&i<=c+e},updateBounds:l});COG.observable(n);return n},pa=function(b){function l(){d();c.changed();c.trigger("markerUpdate",a)}function d(){var g=c.getParent();if(g&&g.syncXY)for(var e=a.length;e--;)g.syncXY([a[e].xy]);a.sort(function(n,k){var i=k.xy.y-n.xy.y;if(i==0)i=k.xy.x-n.xy.x;return i})}b=COG.extend({zindex:100,style:"basic"},b);var a=[],c=COG.extend(new O(b),{draw:function(g,e,n,k){for(var i=a.length;i--;)a[i].draw(g,e,n,c,k)},add:function(g){if(g&&typeof g.length!=="undefined")for(var e=
g.length;e--;){if(g[e])a[a.length]=g[e]}else if(g)a[a.length]=g;l()},clear:function(g){if(g)for(var e=0;e<a.length;)if(g(a[e]))a.splice(e,1);else e+=1;else a=[];l()},each:function(g){if(g)for(var e=a.length;e--;)g(a[e])},find:function(g){for(var e=[],n=a.length;n--;)if(!g||g(a[n]))e[e.length]=a[n];return e},hitTest:function(g,e){for(var n=[],k=a.length;k--;)if(a[k].hitTest(g,e))n[n.length]={type:"marker",data:a[k]};return n}});c.bind("tap",function(g,e,n,k){var i=[],q=k.x;k=k.y;for(var f=a.length;f--;)if(a[f].hitTest(q,
k))i[i.length]=a[f];if(i.length>0)g.cancel=c.trigger("markerTap",e,n,i).cancel});c.bind("parentChange",d);c.bind("resync",d);return c},sa=function(b){function l(k,i,q){k.fillStyle="#FFFFFF";k.strokeStyle="#222222";k.beginPath();k.arc(q.x,q.y,4,0,Math.PI*2,false);k.stroke();k.fill()}b=COG.extend({path:[],id:COG.objId("pathAni"),easing:COG.easing("sine.inout"),validStates:N("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3},b);var d=I.edges(b.path),a,c=null,g=b.drawIndicator?b.drawIndicator:l,
e=0,n=COG.extend(new O(b),{cycle:function(){for(var k=0;k<d.accrued.length&&d.accrued[k]<e;)k++;c=null;if(k<b.path.length-1){var i=e-(k>0?d.accrued[k-1]:0),q=b.path[k];a=I.theta(q,b.path[k+1],d.edges[k]);c=I.extendBy(q,a,i)}return c},draw:function(k,i){c&&g&&g(k,i,I.init(c.x,c.y),a)}});COG.tweenValue(0,d.total,b.easing,b.duration,function(k,i){e=k;i&&n.remove();n.changed()});return n},wa=function(b){b=COG.extend({style:null,properties:{}},b);return COG.extend(b,{rect:null,draw:function(){},resync:function(){}})},
Ka=function(){return{tileSize:256,init:function(b,l,d,a,c){return COG.extend({x:b,y:l,width:d,height:a},c)}}}(),Va={ex:COG.extend,ticks:L,getConfig:C,userMessage:function(b,l,d){Va.trigger("userMessage",b,l,d)},zoomable:function(b,l){function d(e,n){e=e?B(s(e,g),c):c;if(e!=a){a=e;b.triggerAll("zoomLevelChange",e,n)}}l=COG.extend({initial:1,minZoom:1,maxZoom:16},l);var a=null,c=l.minZoom,g=l.maxZoom;COG.extend(b,{getZoomLevel:function(){return a},setZoomLevel:d});b.bind("scale",function(e,n,k){d(a+
Math.log(n)/Math.LN2,k);b.updateOffset(k.x*n,k.y*n)})},XY:I,XYRect:H,Dimensions:$,Vector:va,D:$,Images:Q,Generator:oa,tween:COG.tween,tweenValue:COG.tweenValue,easing:COG.easing,Tween:COG.Tween,Style:ra,viewState:N,View:function(b){function l(t,r,y,F){ta=Na;Wa(ea-r,fa-y,F?b.panAnimationEasing:null,F?b.panAnimationDuration:null);clearTimeout(hb);hb=setTimeout(d,100)}function d(){ta=Xa;qa()}function a(t,r,y,F){Ya(s(B(aa+R(2,F)-1,0.5),2))}function c(){var t=ca(aa)/Math.LN2>>0;if(t!==0){aa=R(2,t);t=I.init(Oa-
(Ca/aa>>0),Pa-(Da/aa>>0));if(!ga.trigger("scale",aa,t).cancel){for(var r=V.length;r--;)V[r].trigger("scale",aa,t);aa=1;ta=Xa}Za()}qa()}function g(t){t||(t=I.init(Ca,Da));$a=I.init(ea,fa);La=I.offset(t,ea,fa);Oa=La.x;Pa=La.y}function e(t,r){var y,F;F=1/aa;if(aa!==1&&xa){y=xa.x1+t*F;F=xa.y1+r*F}else{y=t+ea;F=r+fa}return I.init(y,F)}function n(t,r,y){Ma("doubleTap",r,y,e(y.x,y.y));b.scalable&&Ya(2,y,b.zoomEasing,null,b.zoomDuration)}function k(t,r,y){ab=null;x(r,y,e(y.x,y.y),"down")}function i(t,r,y){ab=
e(y.x,y.y);x(r,y,ab,"hover")}function q(){clearTimeout(ib);ib=setTimeout(G,250)}function f(t,r,y){x(r,y,e(y.x,y.y),"tap");Ma("tap",r,y,e(y.x,y.y))}function x(t,r,y,F){for(var X=[],ha=ua;ha--;)if(V[ha].hitTest)X=X.concat(V[ha].hitTest(y.x,y.y,ta,ga));X.length>0&&ga.triggerCustom(F+"Hit",{hitType:F},X,t,r,y)}function G(t,r){var y;if(ia){if(b.autoSize&&ia.parentNode){t=ia.parentNode.offsetWidth;r=ia.parentNode.offsetHeight}try{if(!ia.id)ia.id=b.id+"_canvas";Y=ia.getContext("2d")}catch(F){COG.exception(F);
throw Error("Could not initialise canvas on specified view element");}if(t&&r&&(la!==r||ma!==t)){bb=true;ma=t;la=r;Ca=ma>>1;Da=la>>1;ga.trigger("resize",ma,la);for(y=ua;y--;)V[y].trigger("resize",ma,la)}for(y=ua;y--;)V[y].trigger("contextChanged",Y);qa();da()}}function J(t,r){r.setId(t);r.added=L();r.bind("remove",function(){ga.removeLayer(t)});r.trigger("contextChanged",Y);r.setParent(ga);V.push(r);V.sort(function(y,F){var X=F.zindex-y.zindex;if(X===0)X=F.added-y.added;return X});ua=V.length;return r}
function da(){za&&za.unbind();za=INTERACT.watch(ia);b.pannable&&za.pannable().bind("pan",l);if(b.scalable){za.bind("zoom",a);za.bind("doubleTap",n)}if(b.captureHover){za.bind("pointerDown",k);za.bind("pointerHover",i)}za.bind("tap",f)}function Ea(t){var r,y=false;if(cb){if(t-jb>nb){if(aa!==1)ta|=kb;Qa=(r=(ta&(kb|Na))!==0)&&(ta&db)===0;if(bb&&ia){typeof FlashCanvas!="undefined"&&FlashCanvas.initElement(ia);ia.width=ma;ia.height=la;ia.style.width=ma+"px";ia.style.height=la+"px";bb=false}if(Aa||Ba){var F=
Ra?ea+Ca:ea,X=Sa?fa+Da:fa;if(Aa&&Aa>ma)if(F+ma>Aa)ea=Ra?F-Aa>0?ea-Aa:ea:Aa-ma;else if(F<0)ea=Ra?ea+Aa:0;if(Ba&&Ba>la)if(X+la>Ba)fa=Sa?X-Ba>0?fa-Ba:fa:Ba-la;else if(X<0)fa=Sa?fa+Ba:0}Ta=Ua();if(Qa){ob=false;if(eb!==0){clearTimeout(eb);eb=0}}for(F=ua;F--;){if(V[F].animated)ta|=db;V[F].cycle(t,Ta,ta);V[F].shouldDraw(ta,Ta);y=V[F].clip||y}F=ta;X=Ta;r=pb&&y&&!r;var ha;H.center(X);y=0;xa=H.copy(X);xa.scaleFactor=aa;r||Y.clearRect(0,0,ma,la);Y.save();try{Y.globalCompositeOperation="source-over";if(aa!==
1){var Fa=xa,ya=1/aa;Oa=La.x+(ea-$a.x);Pa=La.y+(fa-$a.y);xa=Fa?H.fromCenter(Oa>>0,Pa>>0,Fa.width*ya>>0,Fa.height*ya>>0):void 0;Y.scale(aa,aa)}Y.translate(-xa.x1,-xa.y1);Ha=Ia=null;if(r){Y.beginPath();for(y=ua;y--;)V[y].clip&&V[y].clip(Y,xa,F,ga,t);Y.closePath();Y.clip()}for(y=ua;y--;){ha=V[y];var Ga=ha.style,Ja=Ga?ra.apply(Y,Ga):null;if(ha.minXY)Ia=Ia?I.min(Ia,ha.minXY):I.copy(ha.minXY);if(ha.maxXY)Ha=Ha?I.max(Ha,ha.maxXY):I.copy(ha.maxXY);ha.draw(Y,xa,F,ga,t);Ja&&ra.apply(Y,Ja)}}finally{Y.restore()}if(qb){Y.globalCompositeOperation=
"source-over";Y.strokeStyle="#f00";Y.beginPath();Y.moveTo(Ca,0);Y.lineTo(Ca,la);Y.moveTo(0,Da);Y.lineTo(ma,Da);Y.stroke()}cb=0;Ma("drawComplete",X,t);t-lb>rb&&Za();jb=t}animFrame(Ea)}else fb=false}function qa(){cb+=1;if(!fb){fb=true;animFrame(Ea)}}function Ua(){return H.init(ea,fa,ea+ma,fa+la)}function Za(){lb=(new Date).getTime();Ma("refresh",ga,Ua());qa()}function Ya(t,r,y,F,X){if(y)COG.tweenValue(aa,t,y,X,function(ha,Fa){aa=ha;if(Fa){var ya=ba(ca(aa)/Math.LN2);aa=R(2,ya);F&&F()}g(r);c()});else{aa=
t;g(r);c()}return ga}function Ma(){for(var t=ga.trigger.apply(null,arguments).cancel,r=V.length;r--;)t=V[r].trigger.apply(null,arguments).cancel||t;return!t}function Wa(t,r,y,F,X){function ha(){Fa+=1;if(Fa>=2){d();X&&X()}}var Fa=0,ya=Ia?I.offset(Ia,-Ca,-Da):null,Ga=Ha?I.offset(Ha,-Ca,-Da):null;if(ya){t=t<ya.x?ya.x:t;r=r<ya.y?ya.y:r}if(Ga){t=t>Ga.x?Ga.x:t;r=r>Ga.y?Ga.y:r}if(y){if((ta&Na)===0){COG.tweenValue(ea,t,y,F,function(Ja,gb){ea=Ja|0;(gb?ha:qa)();return!Qa});COG.tweenValue(fa,r,y,F,function(Ja,
gb){fa=Ja|0;(gb?ha:qa)();return!Qa});ta=Na|db}}else{ea=t|0;fa=r|0;qa();X&&X()}}b=COG.extend({id:COG.objId("view"),container:"",captureHover:true,fastDraw:false,inertia:true,idleDelay:100,minRefresh:1E3,pannable:true,clipping:true,scalable:true,panAnimationEasing:COG.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,autoSize:true,tapExtent:10,guides:false,fps:25,zoomEasing:COG.easing("quad.out"),zoomDuration:300},b);var V=[],ua=0,ia=document.getElementById(b.container),Y=null,
sb=typeof window.attachEvent!="undefined",rb=b.minRefresh,ab=null,ea=0,fa=0,Aa=null,Ba=null,Ra=false,Sa=false,pb=b.clipping,Ta=null,fb=false,xa,qb=b.guides,mb=1,Ca=0,Da=0,$a=null,La=null,Qa=false,ob=false,eb=0,hb=0,Ia=null,Ha=null,lb=0,tb=0,ib=0,aa=1,jb=0,bb=false,za=null,la,ma,nb=1E3/b.fps|0,cb=0,Oa,Pa,Xa=N("ACTIVE"),Na=N("PAN"),kb=N("ZOOM"),db=N("ANIMATING"),ta=Xa,ga={id:b.id,deviceScaling:mb,fastDraw:b.fastDraw||C().requireFastDraw,getDimensions:function(){return $.init(ma,la)},getLayer:function(t){for(var r=
0;r<ua;r++)if(V[r].getId()==t)return V[r];return null},setLayer:function(t,r){for(var y=0;y<ua;y++)if(V[y].getId()===t){V.splice(y,1);break}if(r){J(t,r);r.trigger("refresh",ga,Ua())}qa();return r},eachLayer:function(t){for(var r=ua;r--;)t(V[r])},invalidate:qa,refresh:Za,resetScale:function(){aa=1},resize:function(t,r){if(ia){b.autoSize=false;if(ma!==t||la!==r)G(t,r)}},scale:Ya,triggerAll:Ma,removeLayer:function(t){a:{for(var r=ua;r--;)if(V[r].getId()==t){t=r;break a}t=-1}if(t>=0&&t<ua){ga.trigger("layerRemoved",
V[t]);V.splice(t,1);qa()}ua=V.length},getOffset:function(){return I.init(ea,fa)},setMaxOffset:function(t,r,y,F){Aa=t;Ba=r;Ra=typeof y!="undefined"?y:false;Sa=typeof F!="undefined"?F:false},getViewRect:Ua,updateOffset:Wa,pan:function(t,r,y,F,X){Wa(ea+t,fa+r,y,F,X)}};mb=C().getScaling();ga.markers=J("markers",new pa);COG.observable(ga);ga.bind("invalidate",function(){qa()});ga.bind("resync",function(){Ha=Ia=null});COG.configurable(ga,["inertia","container","rotation","tapExtent","scalable","pannable"],
COG.paramTweaker(b,null,{container:function(t,r){ia=document.getElementById(r);G()},rotation:function(t,r){tb=r},scalable:da,pannable:da}),true);G();if(b.autoSize)sb?window.attachEvent("onresize",q):window.addEventListener("resize",q,false);return ga},ViewLayer:O,ImageLayer:function(b,l){function d(i,q,f){for(q=e.length;q--;){var x=e[q],G=x.x,J=x.y,da=H.init(x.x,x.y,x.x+x.width,x.y+x.height);if(f&&H.intersect(i,da))(da=Q.get(x.url,function(){k.changed()},n))&&f(da,G,J,x.width,x.height)}}function a(i){var q=
++g,f=k.getParent();c&&c.run(f,i,function(x){if(q==g){e=[].concat(x);f.invalidate()}})}l=COG.extend({imageLoadArgs:{}},l);var c=b?oa.init(b,l):null,g=0,e=[],n=l.imageLoadArgs,k=COG.extend(new O(l),{changeGenerator:function(i,q){c=oa.init(i,COG.extend({},l,q));e=null;a(k.getParent().getViewRect())},clip:function(i,q,f){d(q,f,function(x,G,J,da,Ea){i.rect(G,J,da,Ea)})},draw:function(i,q,f){d(q,f,function(x,G,J,da,Ea){k.drawImage(i,x,G,J,da,Ea,q,f)})},drawImage:function(i,q,f,x){q&&i.drawImage(q,f,x,
q.width,q.height)}});k.bind("refresh",function(i,q,f){a(f)});k.bind("tap",function(i,q,f,x){i=[];var G=x.x,J=x.y,da,Ea;if(e)for(var qa=e.length;qa--;){da=e[qa];if(Ea=G>=da.x&&G<=da.x+da.width&&J>=da.y&&J<=da.y+da.height)i[i.length]=da}i.length>0&&k.trigger("tapImage",i,q,f,x)});return k},ImageGenerator:function(b){b=COG.extend({relative:false,padding:2},b);b={run:function(){COG.warn("running base generator - this should be overriden")}};COG.observable(b);return b},Marker:M,ImageMarker:function(b){b=
COG.extend({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},b);var l=b.imageAnchor?T5.XY.invert(b.imageAnchor):null,d=COG.extend(new M(b),{changeImage:function(a){d.image=Q.get(a,function(c){d.image=c})},drawMarker:function(a,c,g,e){if((c=d.isAnimating()&&d.animatingImage?d.animatingImage:d.image)&&c.width>0){l||(l=I.init(-c.width>>1,-c.height>>1));var n=d.scale,k=g+~~(l.x*n),i=e+~~(l.y*n),q=~~(c.width*n),f=~~(c.height*n);d.updateBounds(k,
i,q,q);if(d.rotation||d.opacity!==1){a.save();try{a.globalAlpha=d.opacity;a.translate(g,e);a.rotate(d.rotation);a.drawImage(c,l.x*n,l.y*n,q,f)}finally{a.restore()}}else a.drawImage(c,k,i,q,f)}}});if(!d.image)d.image=Q.get(b.imageUrl,function(a){d.image=a});if(!d.animatingImage)d.animatingImage=Q.get(b.animatingImageUrl,function(a){d.animatingImage=a});return d},MarkerLayer:pa,PathLayer:function(b){function l(){var i=k.getParent();if(i&&i.syncXY){i.syncXY(c);g&&i.syncXY(g);k.trigger("tidy")}}b=COG.extend({style:"waypoints",
pixelGeneralization:8,zindex:50},b);var d=[],a=null,c=[],g=null,e=0,n=[],k=COG.extend(new O(b),{getAnimation:function(i,q,f,x){var G="pathAnimation"+e++;n.push(G);return new sa({id:G,path:d,zindex:b.zindex+1,easing:i?i:COG.easing("sine.inout"),duration:q?q:5E3,drawIndicator:f,autoCenter:x?x:false})},draw:function(i){var q,f=d.length;i.save();try{ra.apply(i,b.style);if(f>0){i.beginPath();i.moveTo(d[f-1].x,d[f-1].y);for(q=f;q--;)i.lineTo(d[q].x,d[q].y);i.stroke();if(a){i.fillStyle=b.waypointFillStyle;
for(q=a.length;q--;){i.beginPath();i.arc(a[q].x,a[q].y,2,0,Math.PI*2,false);i.stroke();i.fill()}}}}finally{i.restore()}},updateCoordinates:function(i,q){c=i;g=q;l()}});k.bind("tidy",function(){d=I.simplify(c,b.pixelGeneralization);a=I.simplify(g,b.pixelGeneralization);k.changed(true)});k.bind("resync",l);return k},AnimatedPathLayer:sa,Shape:wa,Arc:function(b,l){l=COG.extend({size:4},l);var d=I.init(),a=COG.extend(l,{draw:function(c){c.beginPath();c.arc(d.x,d.y,a.size,0,Math.PI*2,false);c.fill();c.stroke()},
resync:function(c){c.syncXY([b]);d=I.floor([b])[0]}});COG.info("created arc = ",b);return a},Poly:function(b,l){l=COG.extend({fill:false,simplify:false},l);var d=false,a=l.fill,c=l.simplify,g=N("ZOOM"),e=[],n=COG.extend(new wa(l),{draw:function(k,i,q,f,x,G){if(d){i=true;q=(G&g)!==0;k.beginPath();for(G=e.length;G--;){q=e[G].x;f=e[G].y;if(i){k.moveTo(q,f);i=false}else k.lineTo(q,f);q=true}if(q){a&&k.fill();k.stroke()}}},resync:function(k){n.xy=k.syncXY(b);e=I.floor(c?I.simplify(b):b)}});d=b&&b.length>=
2;return n},ShapeLayer:function(b){function l(g){for(var e=a.length;e--;)a[e].resync(g);a.sort(function(n,k){var i=k.xy.y-n.xy.y;if(i===0)i=k.xy.x-n.xy.y;return i});c.changed()}function d(g,e){e.syncXY&&l(e)}b=COG.extend({zindex:80},b);var a=[],c=COG.extend(new O(b),{add:function(g){a[a.length]=g},each:function(g){for(var e=a.length;e--;)g(a[e])},draw:function(g,e,n){var k=e.x1,i=e.y1,q=e.width;e=e.height;for(var f=a.length;f--;){var x=a[f].style;x=x?ra.apply(g,x):null;a[f].draw(g,k,i,q,e,n);x&&ra.apply(g,
x)}}});c.bind("parentChange",d);c.bind("resync",d);return c},Tiling:Ka};COG.observable(Va);return Va}();
