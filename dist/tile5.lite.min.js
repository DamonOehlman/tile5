COG=function(){var h=/\$\{(.*?)\}/ig,m=Object.prototype.hasOwnProperty,i=0,f={id:"grunt.core",extend:function(){var a=arguments[0]||{},c=1,e=arguments.length,b=false,k,d,j,g;if(typeof a==="boolean"){b=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!f.isFunction(a))a={};if(e===c){a=this;--c}for(;c<e;c++)if((k=arguments[c])!=null)for(d in k){j=a[d];g=k[d];if(a!==g)if(b&&g&&(f.isPlainObject(g)||f.isArray(g))){j=j&&(f.isPlainObject(j)||f.isArray(j))?j:f.isArray(g)?[]:{};a[d]=f.extend(b,j,g)}else if(g!==
undefined)a[d]=g}return a},isFunction:function(a){return toString.call(a)==="[object Function]"},isArray:function(a){return toString.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||toString.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return false;var c;for(c in a);return c===undefined||m.call(a,c)},isEmptyObject:function(a){for(var c in a)return false;return true},isXmlDocument:function(a){return toString.call(a)===
"[object Document]"},contains:function(a,c){var e=a,b=arguments,k=1;if(c&&f.isArray(c)){b=c;k=0}for(k=k;k<b;k++)e=e&&typeof foo[b[k]]!=="undefined";return e},newModule:function(a){a=f.extend({id:null,requires:[],parent:null},a);if(a.parent)a=f.extend({},a.parent,a);return a},toID:function(a){return a.replace(/\s/g,"-")},objId:function(a){return(a?a:"obj")+i++},formatStr:function(a){if(arguments.length<=1)return a;for(var c=arguments.length-2,e=0;e<=c;e++)a=a.replace(RegExp("\\{"+e+"\\}","gi"),arguments[e+
1]);return a},wordExists:function(a,c){var e="";if(c.toString)c=c.toString();for(var b=0;b<c.length;b++)e+=!/\w/.test(c[b])?"\\"+c[b]:c[b];return RegExp("(^|\\s|\\,)"+e+"(\\,|\\s|$)","i").test(a)},parseTemplate:function(a,c){for(var e=h.exec(a);e;){a=a.replace(e[0],COG.XPath.first(e[1],c));h.lastIndex=0;e=h.exec(a)}return a}};return f}();
COG.Log=function(){function h(c,e){var b,k=e&&e.length>0?e[0]:"";for(b=1;e&&b<e.length;b++)k+=" "+(i&&COG.isPlainObject(e[b])?JSON.stringify(e[b]):e[b]);typeof console!=="undefined"&&console[c](k);for(b=0;b<m.length;b++)m[b].call(a,k,c)}var m=[],i=typeof JSON!=="undefined",f=window.console&&window.console.markTimeline,a={id:"grunt.log",getTraceTicks:function(){return f?(new Date).getTime():null},trace:function(c,e){if(f)console.markTimeline(c+(e?": "+(a.getTraceTicks()-e)+"ms":""))},debug:function(){h("debug",
arguments)},info:function(){h("info",arguments)},warn:function(){h("warn",arguments)},error:function(){h("error",arguments)},exception:function(c){a.error(arguments);for(var e in c)a.info("ERROR DETAIL: "+e+": "+c[e])},watch:function(c,e){try{e()}catch(b){a.exception(b,c)}},throwError:function(c){a.error(c);throw Error(c);},requestUpdates:function(c){m.push(c)}};return a}();
(function(){function h(f,a){f[a]||(f[a]=function(c){return f.configure(a,c)})}function m(f){f.gtConfId=COG.objId("configurable");f.gtConfig={};f.gtConfigFns=[];return f.gtConfig}var i={};COG.paramTweaker=function(f,a,c){return function(e,b){if(typeof b!=="undefined"){if(e in f)f[e]=b;c&&e in c&&c[e](e,b)}else return a&&e in a?a[e](e):f[e]}};COG.configurable=function(f,a,c,e){if(f){f.gtConfId||m(f);var b=f.gtConfId,k=f.gtConfig,d=f.gtConfigFns;i[b]=f;d.push(c);for(c=a.length;c--;){k[a[c]]=true;e&&
h(f,a[c])}if(!f.configure)f.configure=function(j,g){if(k[j]){for(var l=d.length;l--;){var n=d[l](j,g);if(typeof n!=="undefined")return n}return i[b]}return null}}}})();
(function(){function h(m,i){var f=m.gtObsHandlers;f[i]||(f[i]=[]);return f[i]}COG.observable=function(m){if(m){if(!m.gtObsHandlers)m.gtObsHandlers={};if(!(m.bind||m.trigger||m.unbind)){m.bind=function(i,f){var a=COG.objId("callback");h(m,i).unshift({fn:f,id:a});return a};m.trigger=function(i){var f=h(m,i),a={cancel:false,tickCount:(new Date).getTime()},c;if(!f)return null;c=Array.prototype.slice.call(arguments,1);c.unshift(a);for(var e=f.length;e--&&!a.cancel;)f[e].fn.apply(self,c);return a};m.unbind=
function(i,f){for(var a=h(m,i),c=0;a&&c<a.length;c++)if(a[c].id===f){a.splice(c,1);break}return m}}}}})();(function(){var h={},m=[];COG.addPipe=function(i){i("pipe.test",{});m.push(i)};COG.listen=function(i,f){h[i]||(h[i]=[]);f&&h[i].push(f)};COG.say=function(i,f){var a;for(a=m.length;a--;)m[a](i,f);if(h[i])for(a=h[i].length;a--;)h[i][a](f)}})();
COG.Loopage=function(){function h(g){return COG.extend({id:c++,frequency:0,after:0,single:false,lastTick:0,execute:function(){}},g)}function m(g){b.push(g);i()}function i(){k&&clearTimeout(k);k=setTimeout(f,0);j=true}function f(){for(var g,l=(new Date).getTime(),n=e.length;b.length>0;){var w=b.shift();for(g=n;g--;)if(e[g].id===w){e.splice(g,1);break}j=true;n=e.length}if(j){d=a;for(g=n;g--;)d=e[g].frequency<d?e[g].frequency:d}for(g=n;g--;){w=l-e[g].lastTick;if(e[g].lastTick===0||w>=e[g].frequency){e[g].execute(l,
e[g]);e[g].lastTick=l;e[g].single&&e[g].trigger("complete")}}k=n?setTimeout(f,d):0}var a=6E4,c=0,e=[],b=[],k=0,d=a,j=true;return{join:function(g){var l=new h(g);if(l.after>0)l.lastTick=(new Date).getTime()+l.after;COG.observable(l);l.bind("complete",function(){m(l.id)});e.unshift(l);i();return l},leave:m}}();if(!this.JSON)this.JSON={};
(function(){function h(d){return d<10?"0"+d:d}function m(d){a.lastIndex=0;return a.test(d)?'"'+d.replace(a,function(j){var g=b[j];return typeof g==="string"?g:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function i(d,j){var g,l,n,w,y=c,o,p=j[d];if(p&&typeof p==="object"&&typeof p.toJSON==="function")p=p.toJSON(d);if(typeof k==="function")p=k.call(j,d,p);switch(typeof p){case "string":return m(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";c+=e;o=[];if(Object.prototype.toString.apply(p)==="[object Array]"){w=p.length;for(g=0;g<w;g+=1)o[g]=i(g,p)||"null";n=o.length===0?"[]":c?"[\n"+c+o.join(",\n"+c)+"\n"+y+"]":"["+o.join(",")+"]";c=y;return n}if(k&&typeof k==="object"){w=k.length;for(g=0;g<w;g+=1){l=k[g];if(typeof l==="string")if(n=i(l,p))o.push(m(l)+(c?": ":":")+n)}}else for(l in p)if(Object.hasOwnProperty.call(p,l))if(n=i(l,p))o.push(m(l)+(c?": ":":")+n);n=o.length===0?"{}":c?"{\n"+c+o.join(",\n"+c)+
"\n"+y+"}":"{"+o.join(",")+"}";c=y;return n}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,e,b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(d,j,g){var l;e=c="";if(typeof g==="number")for(l=0;l<g;l+=1)e+=" ";else if(typeof g==="string")e=g;if((k=j)&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number"))throw Error("JSON.stringify");return i("",
{"":d})};if(typeof JSON.parse!=="function")JSON.parse=function(d,j){function g(n,w){var y,o,p=n[w];if(p&&typeof p==="object")for(y in p)if(Object.hasOwnProperty.call(p,y)){o=g(p,y);if(o!==undefined)p[y]=o;else delete p[y]}return j.call(n,w,p)}var l;d=String(d);f.lastIndex=0;if(f.test(d))d=d.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=eval("("+d+")");return typeof j==="function"?g({"":l},""):l}throw new SyntaxError("JSON.parse");}})();
(function(){function h(i,f){var a=i.split("|"),c={};for(var e in f){var b=f[e];c[e]=a.length>b?a[b]:null}return c}var m={JSON:{parse:function(i){return JSON.parse(i)}},PDON:{parse:function(i){var f=null,a=[];i=i.split("\n");for(var c=0;c<i.length;c++){var e=i[c];if(f)a.push(h(e,f));else if(e){f=e.split("|");e={};for(var b=0;b<f.length;b++)e[f[b]]=b;f=e}else f=null}return a}}};COG.parseData=function(i,f){f=f?f.toUpperCase():"JSON";if(!m[f])throw Error("Unsupported data format: "+f);try{return m[f].parse(i)}catch(a){COG.Log.exception(a)}return{}}})();
COG.XPath=function(){function h(a){for(var c=null,e=0;e<m.length;e++)if(c=m[e](a))break;return c}var m=[],i=[null,function(a){return a.numberValue},function(a){return a.stringValue},function(a){return a.booleanValue},null,null,null,null,function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null},function(a){return a.singleNodeValue?a.singleNodeValue.textContent:null}];typeof XPathResult!=="undefined"||COG.Log.warn("No XPATH support");var f={SearchResult:function(a){return{toString:function(){var c=
null;if(a){var e=null;if(a.resultType>=0&&a.resultType<i.length)e=i[a.resultType];if(e)c=e(a)}return c?c:""}}},first:function(a,c){var e=f.SearchResult,b;var k=XPathResult.FIRST_ORDERED_NODE_TYPE;if(!k)k=XPathResult.ANY_TYPE;try{if(COG.isXmlDocument(c))b=c.evaluate(a,c,h,k,null);else{COG.Log.warn("attempted xpath expression: "+a+" on a non-xml document");b=null}}catch(d){COG.Log.warn("invalid xpath expression: "+a+" on node: "+c);b=null}return new e(b)},registerResolver:function(a){m.push(a)}};return f}();
COG.Storage=function(){function h(m){if(m&&m=="session")return sessionStorage;return localStorage}return{get:function(m,i){var f=h(i).getItem(m);return/^(\{|\[).*(\}|\])$/.test(f)?JSON.parse(f):f},set:function(m,i,f){i=jQuery.isArray(i)||jQuery.isPlainObject(i)?JSON.stringify(i):i;h(f).setItem(m,i)},remove:function(m,i){h(i).removeItem(m)}}}();
COG.ParseRules=function(){var h=[];return{add:function(m,i){h.push({regex:m,handler:i})},each:function(m,i,f){function a(){c++;f&&c>=h.length&&f(i)}for(var c=0,e=0;e<h.length;e++){var b=h[e].regex,k=h[e].handler,d=false;if(b){b.lastIndex=-1;if((b=b.exec(m))&&k){d=true;k(b,i,a)&&a()}}d||a()}}}};
(function(){function h(b){var k=[],d=function(g,l){l=COG.isFunction(l)?l():l;k[k.length]=encodeURIComponent(g)+"="+encodeURIComponent(l)};if(COG.isArray(b))for(var j=0;j<b.length;j++)d(b[j].name,b[j].value);else for(j in b)d(j,b[j]);return k.join("&").replace(/%20/g,"+")}var m={HTML:"text/html",XML:"text/xml",TEXT:"text/plain",STREAM:"application/octet-stream"},i={JSON:["json"],PDON:["pdon.txt"]},f=["TEXT","STREAM"],a=/^(\w+:)?\/\/([^\/?#]+)/,c={XML:function(b){return b.responseXML},JSON:function(b){return COG.parseData(b.responseText)},
PDON:function(b){return COG.parseData(b.responseText,"PDON")},DEFAULT:function(b){return b.responseText}},e={CONTENT_TYPE:"Content-Type"};COG.xhr=function(b){function k(){if(this.readyState===4){var l=null,n=!this.status&&location.protocol==="file:"||this.status>=200&&this.status<300||this.status===304||this.status===1223||this.status===0;try{if(n)if(b.handleResponse)b.handleResponse(this);else{var w=b,y=this.getResponseHeader(e.CONTENT_TYPE),o,p=false;for(o in m)if(y&&y.indexOf(m[o])>=0){p=true;
break}y=!p;for(p=0;p<f.length;p++)y=y||f[p]==o;if(y)b:{y=o;for(var v in i)for(p=0;p<i[v].length;p++)if(RegExp(i[v][p]+"$","i").test(w.url)){o=v;break b}o=y?y:"DEFAULT"}try{l=c[o](this,w)}catch(s){l=c.DEFAULT(this,w)}}else b.error&&b.error(this)}catch(H){COG.Log.exception(H,"PROCESSING AJAX RESPONSE")}n&&l&&b.success&&b.success.call(this,l)}}try{b=COG.extend({method:"GET",data:null,url:null,async:true,success:null,handleResponse:null,error:null,contentType:"application/x-www-form-urlencoded"},b);var d=
a.exec(b.url),j=d&&(d[1]&&d[1]!==location.protocol||d[2]!==location.host);if(b.data)b.method="POST";if(b.url){d=null;if(b.xhr)d=b.xhr(b);d||(d=new XMLHttpRequest);d.open(b.method,b.url,b.async);b.data&&d.setRequestHeader("Content-Type",b.contentType);j||d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.onreadystatechange=k;d.send(b.method=="POST"?h(b.data):null)}else COG.Log.warn("ajax request issued with no url - that ain't going to work...")}catch(g){COG.Log.exception(g)}}})();
(function(){function h(a){var c=document.createElement("script"),e=false;c.src=a;c.async=true;c.onload=c.onreadystatechange=function(){if(!e&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){e=true;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};i||(i=document.getElementsByTagName("head")[0]);i.appendChild(c)}var m=0,i,f=this;COG.jsonp=function(a,c,e){a+=a.indexOf("?")>=0?"&":"?";var b="json"+ ++m;f[b]=function(k){c(k);f[b]=null;try{delete f[b]}catch(d){}};
h(a+(e?e:"callback")+"="+b);return b}})();
COG.Touch=function(){function h(u,B){return{x:u.x-B.x,y:u.y-B.y}}function m(u,B){var D=h(u,B);return Math.sqrt(D.x*D.x+D.y*D.y)}function i(u){if(u.count>1)return m(u.touches[0],u.touches[1]);return 0}function f(u,B){var D=u&&u.count>0?u.touches[0]:null;if(D&&B&&B.count>0)return h(D,B.touches[0]);return null}function a(u,B){u.count=B.count;for(var D=d;D--;){u.touches[D].x=B.touches[D].x;u.touches[D].y=B.touches[D].y}}function c(){for(var u={count:0,touches:Array(d)},B=d;B--;)u.touches[B]=k();return u}
function e(u){if(u.preventDefault){u.preventDefault();u.stopPropagation()}else u.cancelBubble&&u.cancelBubble()}function b(u,B,D){if(C){B=B[D?D:"touches"];D=B.length;for(D=u.count=D;D--;){u.touches[D].x=B[D].pageX;u.touches[D].y=B[D].pageY}}else if(B.button===0){u.count=1;u.touches[0].x=B.pageX?B.pageX:B.screenX;u.touches[0].y=B.pageY?B.pageY:B.screenY}else u.count=0}function k(u,B){return{x:u?u:0,y:B?B:0}}var d=10,j=120,g=100,l=250,n=300,w=5,y=0,o=1,p=2,v=7,s=0,H=0,C=undefined,ha=function(u){function B(t,
z,x,q){var r=Math.asin((t.y-z.y)/x);x=x*(qa/q)>>0;x=x>ia?ia:x;r=z.x>t.x?r:Math.PI-r;W("pan",Math.cos(r)*-x,Math.sin(r)*x,true)}function D(t,z){var x,q;if(C){x=z-ca;if(x<l){q=m(K.touches[0],t);q>u.inertiaTrigger&&B(K.touches[0],t,q,x)}}else{N.x=t.x;N.y=t.y;COG.Loopage.join({execute:function(r,A){x=r-z;q=m(t,N);if(x<g&&q>u.inertiaTrigger){A.trigger("complete");B(t,N,q,x)}else x>g&&A.trigger("complete")},frequency:10})}}function ja(t){var z=0,x=0;if(t.offsetParent){do{z+=t.offsetLeft;x+=t.offsetTop;
t=t.offsetParent}while(t)}return k(z,x)}function $(t){var z=t.count,x=Array(z),q=ja(P);for(z=z;z--;)x[z]=k(t.touches[z].x-q.x,t.touches[z].y-q.y);return x}function W(){oa&&oa.trigger.apply(null,arguments)}function L(t,z){var x=ja(P);x=k(z.x-x.x,z.y-x.y);W(t,z,x)}function ka(t){var z=t.target?t.target:t.srcElement;if(Q||z&&z===P){b(K,t);if(K.count!==0){X=null;Y.x=0;Y.y=0;ea=true;Z=false;ca=(new Date).getTime();e(t);z.style.cursor="move";W("inertiaCancel");fa=ca;if(t=K.count>0?K.touches[0]:null){W("touchStart",
t.x,t.y);if(fa-ga<n)if((t=h(K.touches[0],S.touches[0]))&&Math.abs(t.x)<u.maxDistDoubleTap&&Math.abs(t.y)<u.maxDistDoubleTap)Z=true;E=y;a(S,K)}else COG.Log.warn("Touch start fired, but no touch vector found")}}}function I(t){var z=t.target?t.target:t.srcElement,x=0;if(Q||z&&z===P){b(O,t);if(O.count>0){N.x=O.touches[0].x;N.y=O.touches[0].y}if(ea){C&&e(t);if(O.count>1){K.count===1&&a(K,O);x=i(K)-i(O)}if(E===y)if((t=f(O,K))&&(Math.abs(t.x)>=v||Math.abs(t.y)>=v))E=o;if(E!==y)if(!x||Math.abs(x)<w){if(X=
f(O,S)){Y.x-=X.x;Y.y-=X.y;aa.x-=X.x;aa.y-=X.y}W("pan",aa.x,aa.y);aa.x=0;aa.y=0;E=o}else{W("pinchZoom",$(K),$(O));E=p}a(S,O)}}}function la(t){var z=t.target?t.target:t.srcElement;if(ea&&(Q||z&&z===P)){b(ma,t,"changedTouches");var x=ma.touches[0];C&&e(t);t=(new Date).getTime();ga=fa;if(E===y){L("tap",K.touches[0]);na||(na=setTimeout(function(){na=0;Z&&L("doubleTap",K.touches[0])},n+50))}else if(E==o){W("panEnd",Y.x,Y.y);pa&&D(x,t)}else E==p&&W("pinchZoomEnd",$(K),$(S),t-ca);z.style.cursor="default";
ea=false}}function U(t){var z=t.target?t.target:t.srcElement;if(Q||z&&z===P){if(t.detail){z=-t.detail*j;z=k(t.axis===1?z:0,t.axis===2?z:0)}else z=k(t.wheelDeltaX,t.wheelDeltaY);var x=z.y!==0?Math.abs(z.y/j):0;if(N&&x!==0){var q=k(N.x-P.offsetLeft,N.y-P.offsetTop);W("wheelZoom",q,Math.pow(2,z.y>0?x:-x))}e(t)}}u=COG.extend({element:null,observable:null,inertiaTrigger:20,maxDistDoubleTap:20,touchStartHandler:null,moveHandler:null,moveEndHandler:null,pinchZoomHandler:null,pinchZoomEndHandler:null,tapHandler:null,
doubleTapHandler:null,wheelZoomHandler:null},u);var Z=false,na=0,T=T5.getConfig(),K=c(),O=c(),S=c(),ma=c(),X=null,Y=k(),aa=k(),E=null,ea=false,ca=0,ba=[],N=k(),pa=false,qa,ia,fa=0,ga=0,P=u.element,oa=u.observable,Q=typeof FlashCanvas!=="undefined",ra={supportsTouch:C,addListeners:function(t){ba.push(t)},decoupleListeners:function(t){for(var z=0;t&&z<ba.length;z++)if(ba[z].listenerId===t){ba.splice(z,1);break}},release:function(){T.unbindEvent(C?"touchstart":"mousedown",ka,false);T.unbindEvent(C?"touchmove":
"mousemove",I,false);T.unbindEvent(C?"touchend":"mouseup",la,false);if(!C){window.removeEventListener("mousewheel",U,false);window.removeEventListener("DOMMouseScroll",U,false)}},inertiaEnable:function(t,z){pa=true;qa=t;ia=z?Math.min(z.width,z.height):500},inertiaDisable:function(){pa=false}};if(typeof C==="undefined")C=T5.getConfig().supportsTouch;T.bindEvent(C?"touchstart":"mousedown",ka,false);T.bindEvent(C?"touchmove":"mousemove",I,false);T.bindEvent(C?"touchend":"mouseup",la,false);if(!C){T.bindEvent("mousewheel",
U,window);T.bindEvent("DOMMouseScroll",U,window)}return ra},M=[];return{capture:function(u,B){if(!u)throw Error("Unable to capture touch of null element");if(!u.id)u.id="touchable_"+s++;var D=M[u.id];if(!D){D=new ha(COG.extend({element:u},B));M[u.id]=D}if(B){B.listenerId&&D.decoupleListeners(B.listenerId);B.listenerId=++H;D.addListeners(B)}return D},release:function(u){if(u&&u.id&&M[u.id]){M[u.id].release();delete M[u.id]}}}}();
T5=function(){var h=function(){function a(b,k){return e(b.x-k.x,b.y-k.y)}function c(b,k){if(!k)k=b.length;if(k<=1)throw Error("Cannot determine edge distances for a vector array of only one vector");for(var d={edges:Array(k-1),accrued:Array(k-1),total:0},j=0;j<k-1;j++){var g=a(b[j],b[j+1]);d.edges[j]=Math.sqrt(g.x*g.x+g.y*g.y);d.accrued[j]=d.total+d.edges[j];d.total+=d.edges[j]}return d}function e(b,k){return{x:b?b:0,y:k?k:0}}return{VECTOR_SIMPLIFICATION:3,SIMPLIFICATION_MIN_VECTORS:25,add:function(){for(var b=
0,k=0,d=arguments.length;d--;){b+=arguments[d].x;k+=arguments[d].y}return e(b,k)},absSize:function(b){return Math.max(Math.abs(b.x),Math.abs(b.y))},copy:function(b){return b?e(b.x,b.y):null},diff:a,distance:function(b,k){return c(b,k).total},edges:c,equals:function(b,k){return b.x===k.x&&b.y===k.y},extendBy:function(b,k,d){return e(b.x-Math.cos(k)*d,b.y-Math.sin(k)*d)},floor:function(b){for(var k=Array(b.length),d=b.length;d--;)k[d]=e(~~b[d].x,~~b[d].y);return k},getRect:function(b){for(var k,d,j,
g,l=b.length;l--;){var n=b[l];k=typeof k==="undefined"||n.x<k?n.x:k;d=typeof d==="undefined"||n.y<d?n.y:d;j=typeof j==="undefined"||n.x>j?n.x:j;g=typeof g==="undefined"||n.y>g?n.y:g}return i.init(k,d,g,g)},init:e,invert:function(b){return e(-b.x,-b.y)},offset:function(b,k,d){return e(b.x+k,b.y+(d?d:k))},simplify:function(b,k){if(!b)return null;k=k?k:h.VECTOR_SIMPLIFICATION;for(var d=[],j=null,g=b.length;g--;){var l=b[g];if(include=!j||g===0||Math.abs(l.x-j.x)+Math.abs(l.y-j.y)>k){d.unshift(l);j=l}}return d},
theta:function(b,k,d){d=Math.asin((b.y-k.y)/d);return b.x>k.x?d:Math.PI-d}}}(),m=function(){return{dotProduct:function(a,c){return a.x*c.x+a.y*c.y}}}(),i=function(){function a(c,e,b,k){c=c?c:0;e=e?e:0;b=typeof b!=="undefined"?b:c;k=typeof k!=="undefined "?k:k;return{x1:c,y1:e,x2:b,y2:k,width:b-c,height:k-e}}return{center:function(c){return h.init(c.x1+c.width/2,c.y1+c.height/2)},copy:function(c){return a(c.x1,c.y1,c.x2,c.y2)},diagonalSize:function(c){return Math.sqrt(c.width*c.width+c.height*c.height)},
fromCenter:function(c,e,b,k){b=~~(b/2);k=~~(k/2);return a(c-b,e-k,c+b,e+k)},init:a,intersect:function(c,e){var b=a(Math.max(c.x1,e.x1),Math.max(c.y1,e.y1),Math.min(c.x2,e.x2),Math.min(c.y2,e.y2));return b.width>0&&b.height>0?b:null}}}(),f=function(){return{getAspectRatio:function(a){return a.height!==0?a.width/a.height:1},getCenter:function(a){return h.init(a.width/2,a.height/2)},getSize:function(a){return Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2))},init:function(a,c){a=a?a:0;return{width:a,
height:c?c:a}}}}();return{ex:COG.extend,ticks:function(){return(new Date).getTime()},XY:h,XYRect:i,Vector:function(a,c){COG.Log.warn("The T5.Vector class has been deprecated, please use T5.XY.init instead");return h.init(a,c)},V:COG.extend(h,m),D:f}}();
(function(){function h(){for(;w.length>0;){var o=w.shift();document.location=o}n=0}function m(o){for(var p=true,v=y.length;v--;)p=p&&o!=y[v];return p}function i(o,p){var v=[];for(var s in p)s&&v.push(s+"="+escape(p[s]));return"tile5://"+o+"/"+(v.length>0?"?"+v.join("&"):"")}function f(o,p){m(o)&&COG.Log.info("would push url: "+i(o,p))}function a(o,p){if(m(o)){w.push(i(o,p));n||(n=setTimeout(h,100))}}function c(o){return function(p,v,s){(s?s:o?document.body:document).addEventListener(p,v,false)}}function e(o){return function(p,
v,s){(s?s:o?document.body:document).removeEventListener(p,v,false)}}function b(o,p,v){(v?v:document).attachEvent("on"+o,p)}function k(o,p,v){(v?v:document).detachEvent("on"+o,p)}function d(){j={base:{name:"Unknown",bindEvent:c(),unbindEvent:e(),supportsTouch:"ontouchstart"in window,imageCacheMaxSize:null,getScaling:function(){return 1},maxImageLoads:null,requireFastDraw:false,bridgeNotify:f,targetFps:null},ie:{name:"MSIE",regex:/msie/i,bindEvent:b,unbindEvent:k,requireFastDraw:false,targetFps:25},
ipod:{name:"iPod Touch",regex:/ipod/i,imageCacheMaxSize:6144,maxImageLoads:4,requireFastDraw:false,bridgeNotify:a,targetFps:25},iphone:{name:"iPhone",regex:/iphone/i,imageCacheMaxSize:6144,maxImageLoads:4,bridgeNotify:a},ipad:{name:"iPad",regex:/ipad/i,imageCacheMaxSize:6144,bridgeNotify:a},android:{name:"Android OS <= 2.1",regex:/android/i,bindEvent:c(true),unbindEvent:e(true),supportsTouch:true,getScaling:function(){return 1/window.devicePixelRatio},bridgeNotify:a},froyo:{name:"Android OS >= 2.2",
regex:/froyo/i,eventTarget:document.body,supportsTouch:true,bridgeNotify:a}};g=[j.froyo,j.android,j.ipod,j.iphone,j.ipad,j.ie]}var j=null,g=[],l=null,n=0,w=[],y=["view.wake","tile.loaded"];T5.getConfig=function(){j||d();if(!l){COG.Log.info("ATTEMPTING TO DETECT PLATFORM: UserAgent = "+navigator.userAgent);for(var o=0;o<g.length;o++){var p=g[o];if(p.regex&&p.regex.test(navigator.userAgent)){l=T5.ex({},j.base,p);COG.Log.info("PLATFORM DETECTED AS: "+l.name);break}}if(!l){COG.Log.warn("UNABLE TO DETECT PLATFORM, REVERTING TO BASE CONFIGURATION");
l=j.base}COG.Log.info("CURRENT DEVICE PIXEL RATIO = "+window.devicePixelRatio)}return l}})();
T5.Dispatcher=function(){var h=[],m={execute:function(i){var f=m.findAction(i);f&&f.execute.apply(f,Array.prototype.slice.call(arguments,1))},findAction:function(i){for(var f=h.length;f--;)if(h[f].id==i)return h[f];return null},getRegisteredActions:function(){return[].concat(h)},getRegisteredActionIds:function(){for(var i=[],f=h.length;f--;)h[f].id&&i.push(h[f].id);return i},registerAction:function(i){i&&i.id&&h.push(i)},Action:function(i){i=T5.ex({autoRegister:true,id:"",title:"",icon:"",hidden:false,
execute:null},i);var f={id:i.id,execute:function(){i.execute&&i.execute.apply(this,arguments)},getParam:function(a){return i[a]?i[a]:""},toString:function(){return COG.formatStr("{0} [title = {1}, icon = {2}]",f.id,i.title,i.icon)}};i.autoRegister&&m.registerAction(f);return f},Agent:function(i){i=COG.extend({name:"Untitled",translator:null,execute:null},i);var f={getName:function(){return i.name},getParam:function(a){return i[a]},getId:function(){return COG.toID(f.getName())},run:function(a,c){if(i.execute){var e=
i.translator?i.translator(a):a;i.execute.call(f,e,function(b,k){c&&c(b,k,e)})}}};return f},runAgents:function(i,f,a){for(var c=0;c<i.length;c++)i[c].run(f,a)}};return m}();
T5.Resources=function(){var h="",m={},i={getPath:function(f){return/^(file|https?|\/)/.test(f)?f:h+f},setBasePath:function(f){h=f},loadResource:function(f){f=T5.ex({filename:"",cacheable:true,dataType:null,callback:null},f);var a=function(c){f.callback&&COG.Log.watch("CALLING RESOURCE CALLBACK",function(){f.callback(c)})};f.cacheable&&m[f.filename]?a(m[f.filename]):COG.xhr({url:i.getPath(f.filename),dataType:f.dataType,success:function(c){if(f.cacheable)m[f.filename]=c;a(c)},error:function(c,e,b){COG.Log.error("error loading resource ["+
f.filename+"], error = "+b)}})},loadSnippet:function(f,a){/\.\w+$/.test(f)||(f+=".html");i.loadResource({filename:"snippets/"+f,callback:a,dataType:"html"})}};return i}();
T5.Images=function(){function h(){if(!n){var o=T5.getConfig().maxImageLoads;n=COG.Loopage.join({execute:function(p,v){if(!o||j.length<o){var s=d.shift();if(s){j[j.length]=s;s.image.onload=i;s.image.src=T5.Resources.getPath(s.url);s.requested=T5.ticks()}else v.trigger("complete")}},frequency:10});n.bind("complete",function(){n=null})}}function m(){w=true;try{var o=g.length/2>>0;if(o>0){g.sort(function(v,s){return v.created-s.created});for(var p=o;p--;)delete c[g[p].url];g.splice(0,o)}}finally{w=false}COG.say("imagecache.cleared")}
function i(){var o=b[this.id],p;if(o&&o.image.complete&&o.image.width>0){o.loaded=true;o.hitCount=1;for(p=j.length;p--;)if(j[p].image.src==this.src){j.splice(p,1);break}if(o.background||o.postProcess||o.drawBackground||o.customDraw)if(o.image){globalImageData=o;p=a(o.realSize?o.realSize.width:o.image.width,o.realSize?o.realSize.height:o.image.height);var v=p.getContext("2d"),s=o.offset?o.offset:T5.XY.init();o.background&&v.drawImage(o.background,0,0);o.drawBackground&&o.drawBackground(v);o.customDraw?
o.customDraw(v,o):v.drawImage(o.image,s.x,s.y);o.postProcess&&o.postProcess(v,o);o.image=p}for(p=o.callbacks.length;p--;)o.callbacks[p]&&o.callbacks[p](this,false);o.callbacks=[];g[g.length]={url:this.src,created:o.requested};delete b[this.id];h()}}function f(o,p,v){var s=c[o];if(s){s.hitCount++;s.image.complete&&s.image.width>0&&p?p(s.image,true):s.callbacks.push(p)}else{s=T5.ex({url:o,image:new Image,loaded:false,created:T5.ticks(),requested:null,hitCount:0,callbacks:[p]},v);s.image.id="resourceLoaderImage"+
k++;c[o]=s;b[s.image.id]=s;d[d.length]=s;h()}return s}function a(o,p){var v=document.createElement("canvas");v.width=o?o:0;v.height=p?p:0;if(typeof FlashCanvas!=="undefined"){v.id="tmpCanvas"+e++;v.style.cssText="position: absolute; top: -"+(p-1)+"px; left: -"+(o-1)+"px;";document.body.appendChild(v);FlashCanvas.initElement(v)}typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager.initElement(v);return v}var c={},e=0,b={},k=0,d=[],j=[],g=[],l=0,n=null,w=false,y={avgImageSize:25,loadTimeout:10,
cancelLoad:function(){j=[]},get:function(o,p,v){var s=null,H=null;w||(s=c[o]);if((H=s?s.image:null)&&(H.getContext||H.complete&&H.width>0))return H;else p&&f(o,p,v);return null},load:f,newCanvas:a,reset:function(){c={}},stats:function(){return{imageLoadingCount:j.length,queuedImageCount:d.length,imageCacheFullness:l}}};COG.Loopage.join({execute:function(o){for(var p=false,v=0,s=T5.getConfig();v<j.length;)if(o-j[v].requested>y.loadTimeout*1E3){j.splice(v,1);p=true}else v++;p&&h();if(s&&s.imageCacheMaxSize){l=
g.length*y.avgImageSize/s.imageCacheMaxSize;l>=1&&m()}},frequency:2E4});return y}();T5.Generator=function(){var h={};return{init:function(m,i){var f=h[m];if(!f)throw Error("Unable to locate requested generator: "+m);return new f(i)},register:function(m,i){h[m]=i},Template:function(){}}}();
T5.TimeLord=function(){var h=/^P(\d+Y)?(\d+M)?(\d+D)?$/,m=/^(\d+H)?(\d+M)?(\d+S)?$/,i=function(a,c){return{days:a?a:0,seconds:c?c:0}},f={8601:function(a){a=a.split("T");var c=null;c=null;var e=0,b=0;h.lastIndex=-1;c=h.exec(a[0]);e+=c[3]?parseInt(c[3].slice(0,-1),10):0;m.lastIndex=-1;c=m.exec(a[1]);b+=c[1]?parseInt(c[1].slice(0,-1),10)*3600:0;b+=c[2]?parseInt(c[2].slice(0,-1),10)*60:0;b+=c[3]?parseInt(c[3].slice(0,-1),10):0;return new i(e,b)}};return{Duration:i,addDuration:function(){for(var a=new i,
c=arguments.length;c--;){a.days+=arguments[c].days;a.seconds+=arguments[c].seconds}if(a.seconds>=86400){a.days+=~~(a.seconds/86400);a.seconds%=86400}return a},parseDuration:function(a,c){var e=c?f[c]:null;if(e)return e(a);COG.Log.warn("Could not find duration parser for specified format: "+c);return new i},formatDuration:function(a){var c,e,b="";if(a.days)b=a.days+" days ";if(a.seconds){a=a.seconds;if(a>=3600){c=~~(a/3600);a-=c*3600}if(a>=60){e=Math.round(a/60);a-=e*60}if(c)b=b+c+(c>1?" hrs ":" hr ")+
(e?(e>10?e:"0"+e)+" min ":"");else if(e)b=b+e+" min";else if(a>0)b=b+(a>10?a:"0"+a)+" sec"}return b}}}();
(function(){var h=Math.PI*2,m=Math.PI/2,i=Math.abs,f=Math.pow,a=Math.sin,c=Math.asin,e=Math.cos,b=1.70158,k={linear:function(d,j,g,l){return g*d/l+j},backin:function(d,j,g,l){return g*(d/=l)*d*((b+1)*d-b)+j},backout:function(d,j,g,l){return g*((d=d/l-1)*d*((b+1)*d+b)+1)+j},backinout:function(d,j,g,l){return(d/=l/2)<1?g/2*d*d*(((b*=1.525)+1)*d-b)+j:g/2*((d-=2)*d*(((b*=1.525)+1)*d+b)+2)+j},bouncein:function(d,j,g,l){return g-k.bounceout(l-d,0,g,l)+j},bounceout:function(d,j,g,l){return(d/=l)<1/2.75?
g*7.5625*d*d+j:d<2/2.75?g*(7.5625*(d-=1.5/2.75)*d+0.75)+j:d<2.5/2.75?g*(7.5625*(d-=2.25/2.75)*d+0.9375)+j:g*(7.5625*(d-=2.625/2.75)*d+0.984375)+j},bounceinout:function(d,j,g,l){return d<l/2?k.bouncein(d*2,0,g,l)/2+j:k.bounceout(d*2-l,0,g,l)/2+g/2+j},cubicin:function(d,j,g,l){return g*(d/=l)*d*d+j},cubicout:function(d,j,g,l){return g*((d=d/l-1)*d*d+1)+j},cubicinout:function(d,j,g,l){if((d/=l/2)<1)return g/2*d*d*d+j;return g/2*((d-=2)*d*d+2)+j},elasticin:function(d,j,g,l,n,w){if(d==0)return j;if((d/=
l)==1)return j+g;w||(w=l*0.3);if(!n||n<i(g)){n=g;g=w/4}else g=w/h*c(g/n);return-(n*f(2,10*(d-=1))*a((d*l-g)*h/w))+j},elasticout:function(d,j,g,l,n,w){var y;if(d==0)return j;if((d/=l)==1)return j+g;w||(w=l*0.3);if(!n||n<i(g)){n=g;y=w/4}else y=w/h*c(g/n);return n*f(2,-10*d)*a((d*l-y)*h/w)+g+j},elasticinout:function(d,j,g,l,n,w){var y;if(d==0)return j;if((d/=l/2)==2)return j+g;w||(w=l*0.3*1.5);if(!n||n<i(g)){n=g;y=w/4}else y=w/h*c(g/n);if(d<1)return-0.5*n*f(2,10*(d-=1))*a((d*l-y)*h/w)+j;return n*f(2,
-10*(d-=1))*a((d*l-y)*h/w)*0.5+g+j},quadin:function(d,j,g,l){return g*(d/=l)*d+j},quadout:function(d,j,g,l){return-g*(d/=l)*(d-2)+j},quadinout:function(d,j,g,l){if((d/=l/2)<1)return g/2*d*d+j;return-g/2*(--d*(d-2)-1)+j},sinein:function(d,j,g,l){return-g*e(d/l*m)+g+j},sineout:function(d,j,g,l){return g*a(d/l*m)+j},sineinout:function(d,j,g,l){return-g/2*(e(Math.PI*d/l)-1)+j}};T5.easing=function(d){return k[d.replace(/[\-\_\s\.]/g,"").toLowerCase()]};T5.registerEasingType=function(d,j){k[d.replace(/[\-\_\s\.]/g,
"").toLowerCase()]=j}})();
T5.Tween=function(h){h=T5.ex({target:null,property:null,startValue:0,endValue:null,duration:2E3,tweenFn:T5.easing("sine.out"),complete:null,cancelOnInteract:false},h);var m=T5.ticks(),i=[],f=false,a=0,c=0,e={cancelOnInteract:h.cancelOnInteract,isComplete:function(){return f},triggerComplete:function(b){h.complete&&h.complete(b)},update:function(b){try{var k=h.tweenFn(b-m,a,c,h.duration);if(h.target)h.target[h.property]=k;for(var d=i.length;d--;)i[d](k,void 0);if(f=m+h.duration<=b){if(h.target)h.target[h.property]=
h.tweenFn(h.duration,a,c,h.duration);for(var j=i.length;j--;)i[j](k,true)}}catch(g){COG.Log.exception(g)}},requestUpdates:function(b){i.push(b)}};a=h.target&&h.property&&h.target[h.property]?h.target[h.property]:h.startValue;if(typeof h.endValue!=="undefined")c=h.endValue-a;if(c==0)f=true;T5.wakeTweens();return e};
(function(){function h(a){if(f)return m.length;f=true;try{for(var c=0;c<m.length;)if(m[c].isComplete()){m[c].triggerComplete(false);m.splice(c,1)}else{m[c].update(a);c++}}finally{f=false}m.length===0&&i.trigger("complete");return m.length}var m=[],i=null,f=false;T5.tweenValue=function(a,c,e,b,k){a=new T5.Tween({startValue:a,endValue:c,tweenFn:e,complete:b,duration:k});m.push(a);return a};T5.tween=function(a,c,e,b,k,d){a=new T5.Tween({target:a,property:c,endValue:e,tweenFn:b,duration:d,complete:k});
m.push(a);return a};T5.tweenVector=function(a,c,e,b,k,d){var j=[];if(a){var g=a.x==c,l=a.y==e;g||j.push(T5.tween(a,"x",c,b,function(){(g=true)&&l&&k()},d));l||j.push(T5.tween(a,"y",e,b,function(){l=true;g&&l&&k()},d))}return j};T5.cancelAnimation=function(a){if(!f){f=true;try{for(var c=0;c<m.length;)if(!a||a(m[c])){m[c].triggerComplete(true);m.splice(c,1)}else c++}finally{f=false}}};T5.isTweening=function(){return m.length>0};T5.wakeTweens=function(){if(!i){i=COG.Loopage.join({execute:h,frequency:20});
i.bind("complete",function(){i=null})}}})();(function(){var h={NONE:0,ACTIVE:1,ANIMATING:4,PAN:8,ZOOM:16,FREEZE:128};T5.viewState=function(){for(var m=0,i=arguments.length;i--;){var f=h[arguments[i].toUpperCase()];if(f)m|=f}return m}})();
T5.ViewLayer=function(h){h=T5.ex({id:"",zindex:0,supportFastDraw:false,animated:false,validStates:T5.viewState("ACTIVE","ANIMATING","PAN","ZOOM"),style:null},h);var m=null,i=false,f=false,a=h.supportFastDraw,c=h.id,e=T5.viewState("ACTIVE"),b=h.validStates,k=0,d=0,j=T5.ex({addToView:function(g){g.setLayer(c,j)},shouldDraw:function(g,l,n){g=(g&b)!==0&&(i?a:true);return g=f||n||k!==l.x||d!==l.y},cycle:function(){},draw:function(){},remove:function(){j.trigger("remove",j)},changed:function(){f=true;j.trigger("changed",
j);m&&m.trigger("invalidate")},getId:function(){return c},setId:function(g){c=g},getParent:function(){return m},setParent:function(g){i=(m=g)?m.fastDraw&&displayState!==e:false;j.trigger("parentChange",m)}},h);COG.observable(j);j.bind("drawComplete",function(g,l){f=false;k=l.x;d=l.y});return j};
T5.View=function(h){function m(q,r,A,F){Q=ga;v();if(F&&h.inertia){U=true;d(M+r,u+A,h.panAnimationEasing,h.panAnimationDuration)}else F||d(M+r,u+A)}function i(){Q=fa;U=false;COG.Loopage.join({execute:v,after:50,single:true})}function f(q,r){S=ra(q);ma=ra(r);var A=t(S),F=t(ma);N=z(S);I=z(ma);E=S&&A!==0?F/A:1}function a(q,r,A){f(r,A);if(O=E!==1){Q=P;v()}}function c(q,r,A,F){f(r,A);if(h.adjustScaleFactor){E=h.adjustScaleFactor(E);COG.Log.info("scale factor adjusted to: "+E)}if(F<h.pinchZoomAnimateTrigger){l(ca,
E,N,n(),T5.easing("sine.out"),function(){b();E=1},300);E=ca}else{b();E=1}}function e(q,r,A){x.zoom(r,Math.min(Math.pow(2,Math.round(Math.log(A))),8),500)}function b(){var q=S?n():I;E=Math.round(E*10)/10;O=false;for(var r=s.length;r--;)s[r].trigger("scale",E,q);x.trigger("scale",E,q);Q=fa;v()}function k(){clearTimeout(aa);aa=setTimeout(j,50)}function d(q,r,A,F,G){function J(){R+=1;if(R>=2){i(0,0);G&&G()}}var R=0;if(A){q=T5.tweenValue(M,q,A,J,F);r=T5.tweenValue(u,r,A,J,F);q.cancelOnInteract=true;q.requestUpdates(function(V){M=
V;U=true;v()});r.cancelOnInteract=true;r.requestUpdates(function(V){u=V;U=true;v()})}else{M=q;u=r}}function j(){var q;if(C){COG.Touch.release(C);if(h.autoSize&&C.parentNode){q=C.parentNode.getBoundingClientRect();if(q.height!==0&&q.width!==0){C.height=q.height;C.width=q.width}}try{if(!C.id)C.id=h.id+"_canvas";ha=C.getContext("2d");ha.clearRect(0,0,C.width,C.height)}catch(r){COG.Log.exception(r);throw Error("Could not initialise canvas on specified view element");}ia=COG.Touch.capture(C,{observable:x});
if(L.height!==C.height||L.width!==C.width){L=T5.D.init(C.width,C.height);x.trigger("resize",C.width,C.height);for(q=H;q--;)s[q].trigger("resize",C.width,C.height)}h.inertia&&ia.inertiaEnable(h.panAnimationDuration,L);for(q=H;q--;)s[q].trigger("contextChanged",ha);p()}}function g(q,r){r.setId(q);r.added=T5.ticks();r.bind("remove",function(){x.removeLayer(q)});r.trigger("contextChanged",ha);r.setParent(x);s.push(r);s.sort(function(A,F){var G=F.zindex-A.zindex;if(G===0)G=F.added-A.added;return G});H=
s.length;return r}function l(q,r,A,F,G,J,R){function V(){J&&J();b();E=1;ba=null}O=true;N=T5.XY.offset(A,D.x1,D.y1);I=T5.XY.offset(F,D.x1,D.y1);S=null;COG.Log.info("zoom from: ",N);COG.Log.info("zoom to:   ",I);if(G)T5.tweenValue(0,r-q,G,V,R?R:1E3).requestUpdates(function(da){ba=da/(r-q);E=q+da;Q=P;v();x.trigger("animate")});else{E=r;V()}}function n(){var q=T5.D.getCenter(L),r=T5.XY.distance([I,q]);q=T5.XY.theta(I,q,r);var A=T5.XY.diff(N,I);q=T5.XY.extendBy(I,q,r/E);q.x+=A.x;q.y+=A.y;return q}function w(){x.trigger("idle",
x);la=true;Z=0}function y(q,r,A,F,G){var J=(r&P)!==0,R=T5.XYRect.copy(A),V=0;q.clearRect(0,0,C.width,C.height);if(ja||J)ja=false;if(J){T5.D.getCenter(L);var da=(ba?ba:1)/2,sa=T5.XY.diff(N,I);if(S){T.x=I.x+sa.x;T.y=I.y+sa.y}else{T.x=I.x-sa.x*da;T.y=I.y-sa.y*da}}q.save();try{ca=E;if(J){J=1/E;da=(J-0.5)/0.5;R=T5.XYRect.fromCenter(I.x-(I.x-M)*da,I.y-(I.y-u)*da,~~(R.width*J),~~(R.height*J));q.scale(E,E)}q.translate(-R.x1,-R.y1);for(V=H;V--;)if(s[V].shouldDraw(r,A,F)){var ta=s[V].style,ua=ta?T5.Style.apply(q,
ta):null;s[V].draw(q,R,r,x,F,G);ua&&T5.Style.apply(q,ua);s[V].trigger("drawComplete",R,G)}}finally{q.restore()}x.trigger("drawComplete",A,G);COG.Log.trace("draw complete",G)}function o(q,r){var A=false,F=X?X:U?ga:Q,G=!U&&(F===P||F===ga),J=Y||F===ga||F===P||T5.isTweening();B=T5.XY.init(M>>0,u>>0);D=T5.XYRect.fromCenter(B.x,B.y,L.width,L.height);if(G){T5.cancelAnimation(function(R){return R.cancelOnInteract});la=false;if(Z!==0){clearTimeout(Z);Z=0}}for(G=H;G--;){if(s[G].animated)Q|=oa;A=s[G].cycle(q,
D,Q,J)||A}J=J||(Q&oa)!==0;if(A=A||J||E!==1&&E!==ea){y(ha,F,D,J,q);ea=E;Y=false}if(!A&&ka===0&&!pa){if(!la&&Z===0)Z=setTimeout(w,500);r.trigger("complete")}ka=0;COG.Log.trace("Completed draw cycle",q)}function p(){Y=true;v()}function v(){ka+=1;if(!$){$=COG.Loopage.join({execute:o,frequency:qa});$.bind("complete",function(){$=null})}}h=T5.ex({id:COG.objId("view"),container:"",fastDraw:false,inertia:true,pannable:true,scalable:true,panAnimationEasing:T5.easing("sine.out"),panAnimationDuration:750,pinchZoomAnimateTrigger:400,
adjustScaleFactor:null,autoSize:true,tapExtent:10,fps:25},h);var s=[],H=0,C=document.getElementById(h.container),ha=null,M=0,u=0,B=null,D=null,ja=false,$=null,W=1,L=T5.D.init(),ka=0,I=null,la=false,U=false,Z=0,na=0,T=T5.XY.init(),K=0,O=false,S=null,ma=null,X=null,Y=false,aa=0,E=1,ea=0,ca=1,ba=null,N=null,pa=typeof FlashCanvas!=="undefined",qa=~~(1E3/h.fps),ia=null,fa=T5.viewState("ACTIVE"),ga=T5.viewState("PAN"),P=T5.viewState("ZOOM"),oa=T5.viewState("ANIMATING"),Q=fa,ra=T5.XY.getRect,t=T5.XYRect.diagonalSize,
z=T5.XYRect.center,x={id:h.id,deviceScaling:W,fastDraw:h.fastDraw||T5.getConfig().requireFastDraw,animate:function(q,r,A,F,G){l(E,q,r,A,F,G)},centerOn:function(q){M=q.x-C.width/2;u=q.y-C.height/2},getDimensions:function(){return L},getZoomCenter:function(){return T},getLayer:function(q){for(var r=0;r<H;r++)if(s[r].getId()==q)return s[r];return null},setLayer:function(q,r){for(var A=0;A<H;A++)if(s[A].getId()===q){s.splice(A,1);break}r&&g(q,r);p();return r},eachLayer:function(q){for(var r=H;r--;)q(s[r])},
clearBackground:function(){COG.Log.info("CALL OF DEPRECATED METHOD CLEAR BACKGROUND");ja=true;p()},invalidate:p,resize:function(q,r){if(C){h.autoSize=false;C.width=q;C.height=r;j();x.trigger("resize",C.width,C.height)}},scale:function(q,r,A,F,G){F||(F=T5.D.getCenter(L));G||(G=T5.D.getCenter(L));x.animate(q,F,G,r,A);return x},triggerAll:function(){x.trigger.apply(null,arguments);for(var q=s.length;q--;)s[q].trigger.apply(null,arguments)},removeLayer:function(q){a:{for(var r=H;r--;)if(s[r].getId()==
q){q=r;break a}q=-1}if(q>=0&&q<H){COG.say("layer.removed",{layer:s[q]});s.splice(q,1);p()}H=s.length},stateOverride:function(q){X=q},getOffset:function(){return B?B:T5.XY.init(M,u)},getViewRect:function(){return D?D:T5.XYRect.fromCenter(M,u,L.width,L.height)},updateOffset:d,pan:function(q,r,A,F,G){d(M+q,u+r,A,F,G)},zoom:function(q,r,A){U=false;E=r;O=E!==1;N=T5.D.getCenter(L);I=T5.XY.offset(E>1?T5.XY.copy(q):T5.D.getCenter(L),D.x1,D.y1);S=null;clearTimeout(na);if(O){Q=P;v();if(A)na=setTimeout(function(){b();
E=1},parseInt(A,10))}}};W=T5.getConfig().getScaling();x.markers=g("markers",new T5.MarkerLayer);COG.observable(x);x.bind("wake",v);x.bind("invalidate",p);if(h.pannable){x.bind("pan",m);x.bind("panEnd",i);x.bind("inertiaCancel",function(){U=false;v()})}if(h.scalable){x.bind("pinchZoom",a);x.bind("pinchZoomEnd",c);x.bind("wheelZoom",e)}x.bind("tap",function(q,r,A){for(var F=T5.XY.offset(A,M,u),G=s.length;G--;)q.cancel=q.cancel||s[G].trigger("tap",r,A,F).cancel});COG.configurable(x,["inertia","container",
"rotation","tapExtent","scalable","pannable"],COG.paramTweaker(h,null,{container:function(q,r){C=document.getElementById(r);j()},rotation:function(q,r){K=r}}),true);j();h.autoSize&&window.addEventListener("resize",k,false);return x};
T5.PathLayer=function(h){h=T5.ex({style:"waypoints",pixelGeneralization:8,zindex:50},h);var m=false,i=[],f=null,a=[],c=null,e=0,b=[],k=T5.ex(new T5.ViewLayer(h),{getAnimation:function(d,j,g,l){var n="pathAnimation"+e++;b.push(n);return new T5.AnimatedPathLayer({id:n,path:i,zindex:h.zindex+1,easing:d?d:T5.easing("sine.inout"),duration:j?j:5E3,drawIndicator:g,autoCenter:l?l:false})},cycle:function(d,j,g,l){return l},draw:function(d){var j,g=i.length;d.save();try{T5.Style.apply(d,h.style);if(g>0){d.beginPath();
d.moveTo(i[g-1].x,i[g-1].y);for(j=g;j--;)d.lineTo(i[j].x,i[j].y);d.stroke();if(f){d.fillStyle=h.waypointFillStyle;for(j=f.length;j--;){d.beginPath();d.arc(f[j].x,f[j].y,2,0,Math.PI*2,false);d.stroke();d.fill()}}}}finally{d.restore()}m=false},updateCoordinates:function(d,j){a=d;c=j;var g=k.getParent();if(g&&g.syncXY){g.syncXY(a);c&&g.syncXY(c);k.trigger("tidy")}}});k.bind("tidy",function(){i=T5.XY.simplify(a,h.pixelGeneralization);f=T5.XY.simplify(c,h.pixelGeneralization);m=true;k.changed()});return k};
T5.ShapeLayer=function(h){function m(e){for(var b=f.length;b--;)f[b].resync(e);f.sort(function(k,d){var j=d.xy.y-k.xy.y;if(j===0)j=d.xy.x-k.xy.y;return j});a=true;c.changed()}function i(e,b){b.syncXY&&m(b)}h=T5.ex({zindex:80},h);var f=[],a=false,c=T5.ex(new T5.ViewLayer(h),{add:function(e){f[f.length]=e},each:function(e){for(var b=f.length;b--;)e(f[b])},cycle:function(){return a},draw:function(e,b,k){var d=b.x1,j=b.y1,g=b.width;b=b.height;for(var l=f.length;l--;){var n=f[l].style;n=n?T5.Style.apply(e,
n):null;f[l].draw(e,d,j,g,b,k);n&&T5.Style.apply(e,n)}a=false}});c.bind("parentChange",i);c.bind("resync",i);return c};T5.PolyLayer=T5.ShapeLayer;T5.Shape=function(h){h=T5.ex({style:null,properties:{}},h);return T5.ex(h,{rect:null,draw:function(){},resync:function(){}})};
T5.Arc=function(h,m){m=T5.ex({size:4},m);var i=T5.XY.init(),f=T5.ex(m,{draw:function(a){a.beginPath();a.arc(i.x,i.y,f.size,0,Math.PI*2,false);a.fill();a.stroke()},resync:function(a){a.syncXY([h]);i=T5.XY.floor([h])[0]}});COG.Log.info("created arc = ",h);return f};
T5.Poly=function(h,m){m=T5.ex({fill:false,simplify:false},m);var i=false,f=m.fill,a=m.simplify,c=T5.viewState("ZOOM"),e=[],b=T5.ex(new T5.Shape(m),{draw:function(k,d,j,g,l,n){if(i){d=true;j=(n&c)!==0;k.beginPath();for(n=e.length;n--;){j=e[n].x;g=e[n].y;if(d){k.moveTo(j,g);d=false}else k.lineTo(j,g);j=true}if(j){f&&k.fill();k.stroke()}}},resync:function(k){b.xy=k.syncXY(h);e=T5.XY.floor(a?T5.XY.simplify(h):h)}});i=h&&h.length>=2;return b};
T5.AnimatedPathLayer=function(h){function m(b,k,d){b.fillStyle="#FFFFFF";b.strokeStyle="#222222";b.beginPath();b.arc(d.x,d.y,4,0,Math.PI*2,false);b.stroke();b.fill()}h=T5.ex({path:[],id:COG.objId("pathAni"),easing:T5.easing("sine.inout"),validStates:T5.viewState("ACTIVE","PAN","ZOOM"),drawIndicator:null,duration:2E3,autoCenter:false},h);var i=T5.XY.edges(h.path),f,a=null,c=0;T5.tweenValue(0,i.total,h.easing,function(){e.remove()},h.duration).requestUpdates(function(b,k){c=b;k&&e.remove()});var e=
T5.ex(new T5.ViewLayer(h),{cycle:function(){for(var b=0;b<i.accrued.length&&i.accrued[b]<c;)b++;a=null;if(b<h.path.length-1){var k=c-(b>0?i.accrued[b-1]:0),d=h.path[b];f=T5.XY.theta(d,h.path[b+1],i.edges[b]);a=T5.XY.extendBy(d,f,k);if(h.autoCenter)(b=e.getParent())&&b.centerOn(a)}return a},draw:function(b,k){if(a)(h.drawIndicator?h.drawIndicator:m)(b,k,T5.XY.init(a.x,a.y),f)}});return e};
T5.Marker=function(h){function m(k,d,j,g){f=k;a=d;c=j;e=g}h=T5.ex({xy:T5.XY.init(),offset:true,tweenIn:null,animationSpeed:null},h);var i=false,f=0,a=0,c=0,e=0,b=T5.ex(h,{isNew:true,isAnimating:function(){return i},draw:function(k,d,j,g,l){if(b.isNew&&h.tweenIn){var n=b.xy.y;b.xy.y=d.y1-20;i=true;T5.tween(b.xy,"y",n,h.tweenIn,function(){b.xy.y=n;i=false},h.animationSpeed?h.animationSpeed:250+Math.random()*500)}b.drawMarker(k,d,b.xy.x,b.xy.y,j,g,l);b.isNew=false},drawMarker:function(k,d,j,g){k.beginPath();
k.arc(j,g,4,0,Math.PI*2,false);k.fill();m(j-4,g-4,8,8)},hitTest:function(k,d){return k>=f&&k<=f+c&&d>=a&&d<=a+e},updateBounds:m});COG.observable(b);return b};
T5.ImageMarker=function(h){h=T5.ex({image:null,imageUrl:null,animatingImage:null,animatingImageUrl:null,imageAnchor:null,rotation:0,scale:1,opacity:1},h);var m=h.imageAnchor?T5.XY.invert(h.imageAnchor):null,i=T5.ex(new T5.Marker(h),{drawMarker:function(f,a,c,e){if((a=i.isAnimating()&&i.animatingImage?i.animatingImage:i.image)&&a.complete&&a.width>0){m||(m=T5.XY.init(-a.width>>1,-a.height>>1));var b=i.scale,k=c+~~(m.x*b),d=e+~~(m.y*b),j=~~(a.width*b),g=~~(a.height*b);i.updateBounds(k,d,j,j);if(i.rotation||
i.opacity!==1){f.save();try{f.globalAlpha=i.opacity;f.translate(c,e);f.rotate(i.rotation);f.drawImage(a,m.x*b,m.y*b,j,g)}finally{f.restore()}}else f.drawImage(a,k,d,j,g)}}});if(!i.image)i.image=T5.Images.get(h.imageUrl,function(f){COG.Log.info("updating marker image to: "+f.src);i.image=f});if(!i.animatingImage)i.animatingImage=T5.Images.get(h.animatingImageUrl,function(f){i.animatingImage=f});return i};T5.Annotation=T5.Marker;T5.ImageAnnotation=T5.ImageMarker;
T5.MarkerLayer=function(h){function m(){c.changed();c.trigger("markerUpdate",f)}function i(){var e=c.getParent();if(e&&e.syncXY)for(var b=f.length;b--;)e.syncXY([f[b].xy])}h=T5.ex({zindex:100,style:"basic"},h);var f=[],a=false,c=T5.ex(new T5.ViewLayer(h),{cycle:function(){return a},draw:function(e,b,k,d){a=false;for(var j=f.length;j--;){f[j].draw(e,b,k,c,d);a=a||f[j].isAnimating()}return a?1:0},add:function(e){if(e&&typeof e.length!=="undefined")for(var b=e.length;b--;){if(e[b])f[f.length]=e[b]}else if(e)f[f.length]=
e;m()},clear:function(e){if(e)for(var b=0;b<f.length;b++)e(f[b])&&f.splice(b,1);else f=[];m()},find:function(e){for(var b=[],k=f.length;k--;)if(!e||e(f[k]))b[b.length]=f[k];return b}});c.bind("tap",function(e,b,k){for(var d=[],j=k.x,g=k.y,l=f.length;l--;)if(f[l].hitTest(j,g))d[d.length]=f[l];if(d.length>0)e.cancel=c.trigger("markerTap",b,k,d).cancel});c.bind("parentChange",i);c.bind("changed",i);return c};
T5.ImageLayer=function(h,m){function i(l){var n=[];c.run(l,function(w){e=w;for(w=e.length;w--;)e[w]||(n[n.length]=w);for(w=0;w<n.length;w++)e.splice(n[w],1);(w=g.getParent())&&w.trigger("invalidate")});k=T5.XYRect.copy(l)}function f(){var l=g.getParent();l&&l.trigger("invalidate")}function a(){i(b)}m=T5.ex({imageLoadArgs:{}},m);var c=T5.Generator.init(h,m),e=null,b=T5.XYRect.init(),k=T5.XYRect.init(),d=m.imageLoadArgs,j=T5.viewState("ZOOM"),g=T5.ex(new T5.ViewLayer(m),{cycle:function(l,n){(Math.abs(n.x1-
k.x1)>n.width||Math.abs(n.y1-k.y1)>n.height)&&i(n)},draw:function(l,n,w){l.save();try{l.strokeStyle="#555";l.beginPath();if(e)for(var y=e.length;y--;){var o=e[y].x,p=e[y].y,v=T5.XYRect.init(e[y].x,e[y].y,e[y].x+e[y].width,e[y].y+e[y].height);T5.XYRect.intersect(n,v)&&g.drawImage(l,n,o,p,e[y],w)}l.clip()}finally{l.restore()}b=T5.XYRect.copy(n)},drawImage:function(l,n,w,y,o,p){if(n=T5.Images.get(o.url,(p&j)===0?f:null,d)){l.rect(w,y,o.width,o.height);l.drawImage(n,w,y,n.width,n.height)}}});g.bind("parentChange",
function(l,n){c.bindToView(n);n.bind("idle",a)});return g};
T5.Style=function(){function h(e,b){a[e]=i(b);return e}function m(e){for(var b in e)h(b,e[b])}function i(e){function b(g){var l=e[g];typeof l!=="undefined"&&k.push(function(n){n[g]=l})}e=T5.ex({lineWidth:undefined,lineCap:undefined,lineJoin:undefined,miterLimit:undefined,lineStyle:undefined,fillStyle:undefined,globalAlpha:undefined,globalCompositeOperation:undefined},e);var k=[],d={applyToContext:function(g){for(var l=k.length;l--;)k[l](g)}};for(var j in e)b(j);return d}var f={},a={},c={apply:function(e,
b){var k=a[b]?a[b]:a.basic,d;if(e&&e.canvas){d=f[e.canvas.id];f[e.canvas.id]=b}k.applyToContext(e);return d},define:h,defineMany:m,init:i,load:function(e){COG.jsonp(e,function(b){T5.resetStyles(b)})}};m({basic:{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"},waypoints:{lineWidth:4,strokeStyle:"rgba(0, 51, 119, 0.9)",fillStyle:"#FFF"}});return c}();T5.Tiling=function(){return{tileSize:256,init:function(h,m,i,f,a){return T5.ex({x:h,y:m,width:i,height:f},a)}}}();
T5.TileGenerator=function(h){function m(l,n){for(var w=~~((l.x1-a.x)/e),y=~~((l.y1-a.y)/b),o=[],p=-d;p<d;p++)for(var v=-j;v<j;v++)o[o.length]=k(w+p,y+v);n&&n(o);f=T5.XYRect.copy(l)}h=T5.ex({tileWidth:256,tileHeight:256},h);var i=null,f=null,a=T5.XY.init(),c=false,e=h.tileWidth,b=h.tileHeight,k=null,d=0,j=0,g={bindToView:function(l){COG.Log.info("initializing generator");i=l;g.trigger("bindView",l)},getTileCreatorArgs:null,initTileCreator:null,requireRefresh:function(){return false},reset:function(){k=
null;c=false},run:function(l,n){if(!f||Math.abs(l.x1-f.x1)>e||Math.abs(l.y1-f.y1)>b){if(!k&&!c||g.requireRefresh()){COG.Log.info("generating tiles, view rect = ",l);a=T5.XY.init(l.x1,l.y1);d=Math.ceil(l.width/e)+1;j=Math.ceil(l.height/b)+1;if(g.initTileCreator){c=true;g.initTileCreator(b,e,g.getTileCreatorArgs?g.getTileCreatorArgs(i):{},function(w){k=w;c=false;m(l,n)})}}k&&m(l,n)}}};COG.observable(g);return g};
